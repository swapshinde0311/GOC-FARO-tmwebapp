"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[6116],{96116:(e,t,a)=>{a.r(t),a.d(t,{default:()=>B});var s=a(65043),o=a(40854),i=a.n(o),l=a(97508),n=a(53536),r=a.n(n),c=a(69062),d=a(72067),u=a(65187),h=a(40252),y=a(14159),g=(a(92342),a(11981)),m=a(46100),b=a(44192),p=a(80312),D=a(28882),A=a(72711),C=a(67907),f=a(78374),E=a(35861),v=a(70579);function S(e){let{bayAllocationQueueData:t,bayAllocationPointName:a,bayAllocationMonitoringData:s,handleCellParameterDataEdit:o,createGenerateConfig:i,handleCellPointDataEdit:l,handleBaySelectionChange:n,selectedbays:r,onFieldChange:c,bayAllocationValidationErrors:d,saveEnabled:u}=e;const h=e=>(0,v.jsx)(A.Input,{fluid:!0,value:t[e.rowIndex][e.field],onChange:t=>o(t,e),reserveSpace:!1}),y=e=>(0,v.jsx)(A.Input,{fluid:!0,value:a[e.rowIndex][e.field],onChange:t=>l(t,e),reserveSpace:!1,indicator:"required"}),g=e=>{const t=e;return"number"===typeof t?t.toLocaleString():t};return(0,v.jsx)(C.TranslationConsumer,{children:(e,o)=>(0,v.jsxs)("div",{className:"detailsContainer",children:[(0,v.jsxs)("div",{className:"row",children:[(0,v.jsx)("div",{className:"col-12 col-md-6 col-lg-4 ",children:(0,v.jsx)(A.Input,{fluid:!0,value:s[0].MonitoringRate,indicator:"required",label:e("BaySCADA_MonitoringRate"),reserveSpace:!1,onChange:e=>c("MonitoringRate",e),error:e(d.MonitoringRate)})}),(0,v.jsxs)("div",{className:"col-12 col-md-6 col-lg-4",children:[(0,v.jsx)("div",{class:"ui input-label",style:{marginLeft:"14.6rem"},children:(0,v.jsx)("span",{className:"input-label-message",children:e("BaySCADA_Enabled")})}),(0,v.jsx)("div",{className:"input-wrap ",style:{marginLeft:"14.8rem",marginTop:"0.7rem"},children:(0,v.jsx)(A.Checkbox,{field:"IsEnabled",onChange:e=>c("IsEnabled",e),checked:null===s[0].IsEnabled?"":s[0].IsEnabled},"IsEnabled")})]}),(0,v.jsxs)("div",{className:"col-6 col-md-6 col-lg-6 pb-0 detailsTable",children:[(0,v.jsx)("span",{style:{fontWeight:"bold"},children:e("BaySCADA_Data_Parameter")}),(0,v.jsx)("div",{style:{marginBottom:"10px"}}),(0,v.jsxs)(f.bQ,{data:t,scrollable:!0,scrollHeight:"350px",children:[(0,v.jsx)(f.bQ.Column,{className:"compColHeight",field:"AttributeName",header:e("CompartmentAttributeName")},"AttributeName"),(0,v.jsx)(f.bQ.Column,{className:"compColHeight",field:"ParameterName",renderer:e=>g(e.rowData.ParameterName),renderer:h,header:e("AtgConfigure_ParameterName")},"ParameterName")]})]}),(0,v.jsxs)("div",{className:"col-6 col-md-6 col-lg-6 pb-0",children:[(0,v.jsx)("span",{style:{fontWeight:"bold"},children:e("BaySCADA_Bay_Point")}),(0,v.jsx)("div",{style:{marginBottom:"10px"}}),(0,v.jsxs)(f.bQ,{data:a,selectionMode:"multiple",scrollable:!0,scrollHeight:"320px",selection:r,onSelectionChange:n,children:[(0,v.jsx)(f.bQ.Column,{className:"compColHeight",field:"BayCode",header:e("BaySCADA_BayGV_BayCode")},"BayCode"),(0,v.jsx)(f.bQ.Column,{className:"compColHeight",field:"BayName",header:e("BaySCADA_BayGV_BayName")},"BayName"),(0,v.jsx)(f.bQ.Column,{className:"compColHeight",field:"PointName",renderer:e=>g(e.rowData.PointName),renderer:y,header:(0,E.i7)(e("AtgConfigure_PointName"))},"PointName")]})]})]}),(0,v.jsx)("div",{className:"row",children:(0,v.jsx)("div",{className:"col col-md-8 col-lg-9 col col-xl-12",style:{textAlign:"right"},children:(0,v.jsx)(A.Button,{type:"primary",onClick:i,disabled:!u,content:e("BaySCADA_Generate")})})})]})})}S.defaultProps={isEnterpriseNode:!1};var N=a(62900);class x extends s.Component{constructor(){super(...arguments),this.state={bayAllocationQueueData:[],bayAllocationMonitoringData:[],bayAllocationPointName:[],isReadyToRender:!1,saveEnabled:!0,IsEnabled:"",selectedbays:[],bayAllocationValidationErrors:c.Th(b.RY),showAuthenticationLayout:!1,tempScadaBayMasterConfig:{}},this.handleCellParameterDataEdit=(e,t)=>{try{let a=r().cloneDeep(this.state.bayAllocationQueueData);a[t.rowIndex][t.field]=e,this.setState({bayAllocationQueueData:a})}catch(a){console.log("BayDetailsComposite:Error occured on handleCellDataEdit",a)}},this.handleCellPointDataEdit=(e,t)=>{try{let a=r().cloneDeep(this.state.bayAllocationPointName),s=this.state.selectedbays,o=s.find((e=>e.BayCode===t.rowData.BayCode));s.length>0&&void 0!==o&&(o.PointName=e),a[t.rowIndex][t.field]=e,this.setState({bayAllocationPointName:a})}catch(a){console.log("BayDetailsComposite:Error occured on handleCellDataEdit",a)}},this.handleBaySelectionChange=e=>{this.setState({selectedbays:e})},this.handleChange=(e,t)=>{try{const a=r().cloneDeep(this.state.bayAllocationMonitoringData);a[0][e]=t,this.setState({bayAllocationMonitoringData:a})}catch(a){console.log("TruckReceiptDetailsComposite:Error occured on handleChange",a)}},this.saveScadaConfig=()=>{try{this.setState({saveEnabled:!1});let e=r().cloneDeep(this.state.tempScadaBayMasterConfig);this.createGenerateConfig(e)}catch(e){console.log("Save Scada Config Composite : Error in saveScadaConfig")}},this.handleSave=()=>{this.handleAuthenticationClose();try{let e=this.fillDetails();if(this.validateSave()){let t=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showAuthenticationLayout:t,tempScadaBayMasterConfig:e},(()=>{!1===t&&this.saveScadaConfig()}))}else this.setState({saveEnabled:!0})}catch(e){console.log("BayallocationscadaDetailsComposite:Error occured on handleSave",e)}},this.createGenerateConfig=e=>{this.handleAuthenticationClose();let t=r().cloneDeep(this.state.bayAllocationQueueData),a=r().cloneDeep(this.state.bayAllocationMonitoringData),s=r().cloneDeep(this.state.bayAllocationPointName);var o={messageType:"critical",message:"BayAllocation_SavedStatus",messageResultDetails:[{keyFields:[],keyValues:[],isSuccess:!1,errorMessage:""}]},l={Entity:e};i()(d.xry,c.tW(l,this.props.tokenDetails.tokenInfo)).then((e=>{var i=e.data;o.messageType=i.IsSuccess?"success":"critical",o.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess?this.setState({bayAllocationQueueData:t,bayAllocationMonitoringData:a,bayAllocationPointName:s},(()=>{this.getBayAllocationPointNameConfigurations(),this.getBayAllocationQueueDataConfigurations()})):(o.messageResultDetails[0].errorMessage=i.ErrorList[0],this.setState({saveEnabled:c.ab(this.props.userDetails.EntityResult.FunctionsList,p.i.add,p.nk)}),console.log("Error in updatePipelineReceipt:",i.ErrorList)),(0,y.toast)((0,v.jsx)(u.A,{children:(0,v.jsx)(g.A,{notificationMessage:o})}),{autoClose:"success"===o.messageType&&1e4})})).catch((e=>{this.setState({saveEnabled:!0}),o.messageResultDetails[0].errorMessage=e,(0,y.toast)((0,v.jsx)(u.A,{children:(0,v.jsx)(g.A,{notificationMessage:o})}),{autoClose:"success"===o.messageType&&1e4})})),this.setState({bayAllocationQueueData:this.state.bayAllocationQueueData})},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentDidMount(){try{c.pJ(this.props.userDetails.EntityResult.IsArchived),this.setState({saveEnabled:c.ab(this.props.userDetails.EntityResult.FunctionsList,p.i.add,p.nk)}),this.getBayAllocationQueueDataConfigurations(),this.getBayAllocationPointNameConfigurations()}catch(e){console.log("SlotConfigurationDetail:Error occurred on ",e)}}getBayAllocationQueueDataConfigurations(){try{i()(d.Ahb,c.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(t.IsSuccess){if(null!==t.EntityResult){let e=r().cloneDeep(m.E6);e=t.EntityResult.AtgParameterConfiguration;let a=t.EntityResult.Table1;null!==a&&a.forEach((e=>{e.MonitoringRate=0===e.MonitoringRate?"":Number.isInteger(e.MonitoringRate)?Math.round(e.MonitoringRate):e.MonitoringRate})),console.log("bayAllocationQueueData",e),this.setState({isReadyToRender:!0,bayAllocationQueueData:e,bayAllocationMonitoringData:a,saveEnabled:c.ab(this.props.userDetails.EntityResult.FunctionsList,p.i.add,p.nk)})}}else console.log("Error in getBayAllocationQueueDataConfigurations:",t.ErrorList)}))}catch(e){console.log("getBayAllocationQueueDataConfigurations:Error occured on getBayAllocationQueueDataConfigurationsList",e)}}getBayAllocationPointNameConfigurations(){try{i()(d.$Zz,c.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(t.IsSuccess){if(null!==t.EntityResult&&!0===t.IsSuccess){let e=r().cloneDeep(m.qA);e=r().cloneDeep(t.EntityResult.Table);let s=r().cloneDeep(t.EntityResult.Table),o=(r().cloneDeep(this.state.selectedbays),[]);var a=s.filter((e=>""!==e.PointName));o.push(a),this.setState({isReadyToRender:!0,bayAllocationPointName:e,selectedbays:o[0],saveEnabled:c.ab(this.props.userDetails.EntityResult.FunctionsList,p.i.add,p.nk)})}}else this.setState({bayAllocationPointName:r().cloneDeep(m.qA),selectedbays:r().cloneDeep(this.state.selectedbays)}),console.log("Error in bayAllocationPointNameConfigurations:",t.ErrorList)}))}catch(e){console.log("bayAllocationPointNameConfigurations:Error occured on getBayAllocationQueueDataConfigurationsList",e)}}fillDetails(){let e={IsEnabled:"",MasterConfigurationInfo:[],ScadaBayList:[],ScanPeriod:""};try{let t=[],a=r().cloneDeep(this.state.bayAllocationQueueData),s=r().cloneDeep(this.state.bayAllocationMonitoringData),o=r().cloneDeep(this.state.bayAllocationPointName);e.IsEnabled=s[0].IsEnabled,e.ScanPeriod=s[0].MonitoringRate;let i=[];a.length>0&&Array.isArray(a)&&a.forEach((e=>{t.push({AttributeName:e.AttributeName,ParameterName:e.ParameterName})})),o.length>0&&Array.isArray(o)&&o.forEach((e=>{let t=r().cloneDeep(this.state.selectedbays).find((t=>t.BayCode===e.BayCode));""!==e.PointName&&void 0!==t?i.push({Code:e.BayCode,PointName:e.PointName}):i.push({Code:e.BayCode,PointName:""})})),e.ScadaBayList=i,e.MasterConfigurationInfo=t}catch(t){console.log("ATGInterfaceDetailsComposite:Error occured on fillAttributeDetails",t)}return e}validateSave(){try{var e=r().cloneDeep(this.state.bayAllocationValidationErrors);let a=r().cloneDeep(this.state.bayAllocationMonitoringData),s=r().cloneDeep(this.state.bayAllocationPointName),o=r().cloneDeep(this.state.bayAllocationQueueData),i=r().cloneDeep(this.state.selectedbays),l={messageType:"critical",message:"BayAllocation_FailurStatus",messageResultDetails:[]};Object.keys(b.RY).forEach((function(t){e[t]=c.jr(b.RY[t],a[0][t])})),""!==a[0].MonitoringRate&&null!==a[0].MonitoringRate&&void 0!==a[0].MonitoringRate||(e.MonitoringRate="Bay_SCADA_InvalidMonitoringRate"),o.length>0&&o.forEach((e=>{D.nm.forEach((t=>{let a="";void 0!==t.validator&&(a=c.jr(t.validator,e[t.field])),""!==a&&l.messageResultDetails.push({keyFields:[t.displayName],keyValues:[e[t.field]],isSuccess:!1,errorMessage:a})}))})),s.length>0&&s.forEach((e=>{D.aS.forEach((t=>{let a="";void 0!==t.validator&&(a=c.jr(t.validator,e[t.field])),""!==a&&l.messageResultDetails.push({keyFields:[t.displayName],keyValues:[e[t.field]],isSuccess:!1,errorMessage:a})}))})),i.map((e=>{""===e.PointName&&l.messageResultDetails.push({keyFields:["selectedbays"],keyValues:[e.BayCode],isSuccess:!1,errorMessage:"DeviceInfo_PointNameRequired"})})),this.setState({bayAllocationValidationErrors:e});var t=!0;return t&&(t=Object.values(e).every((function(e){return""===e}))),l.messageResultDetails.length>0?((0,y.toast)((0,v.jsx)(u.A,{children:(0,v.jsx)(g.A,{notificationMessage:l})}),{autoClose:"success"===l.messageType&&1e4}),!1):t}catch(a){console.log("Error while Validate Save",a)}}render(){return this.state.isReadyToRender?(0,v.jsxs)("div",{children:[(0,v.jsx)(u.A,{children:(0,v.jsx)(S,{bayAllocationQueueData:this.state.bayAllocationQueueData,bayAllocationPointName:this.state.bayAllocationPointName,bayAllocationMonitoringData:this.state.bayAllocationMonitoringData,handleCellParameterDataEdit:this.handleCellParameterDataEdit,handleCellPointDataEdit:this.handleCellPointDataEdit,createGenerateConfig:this.handleSave,handleBaySelectionChange:this.handleBaySelectionChange,selectedbays:this.state.selectedbays,onFieldChange:this.handleChange,bayAllocationValidationErrors:this.state.bayAllocationValidationErrors,saveEnabled:this.state.saveEnabled})}),this.state.showAuthenticationLayout?(0,v.jsx)(N.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:p.i.add,functionGroup:p.nk,handleOperation:this.saveScadaConfig,handleClose:this.handleAuthenticationClose}):null]}):(0,v.jsx)(h.A,{message:"Loading"})}}const B=(0,l.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(x)},35861:(e,t,a)=>{a.d(t,{F1:()=>n,i7:()=>r,r4:()=>l});var s=a(86178),o=a.n(s),i=(a(15660),a(65043),a(70579));function l(e,t){if(Array.isArray(e)){0===e.filter((e=>e.text===t)).length&&e.unshift({value:null,text:t})}return e}function n(){let e=window.navigator.userLanguage||window.navigator.language;return o().locale(e),o().localeData().longDateFormat("L")}function r(e){return(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{children:e}),(0,i.jsx)("div",{class:"ui red circular empty label badge  circle-padding"})]})}}}]);
//# sourceMappingURL=6116.fea94d23.chunk.js.map