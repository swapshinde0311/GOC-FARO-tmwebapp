"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[3418,3235],{53418:(e,t,i)=>{i.r(t),i.d(t,{default:()=>T});var s=i(65043),a=i(40854),o=i.n(a),n=i(97508),l=i(53536),c=i.n(l),r=i(69062),d=i(93779),u=i(72067),h=i(9256),p=i(7523),S=i(65187),m=i(40252),R=i(43503),y=i(46100),E=i(44192),D=i(72711),v=i(67907),g=i(78374),C=i(35861),b=i(70579);function j(e){let{modReportSchedule:t,modReconciliationSchedules:i,validationErrors:s,columnDetails:a,onFieldChange:o,onRowClick:n,addNewSchedule:l}=e;const[c]=(0,v.useTranslation)();return(0,b.jsx)("div",{className:"detailsContainer",children:(0,b.jsxs)("div",{className:"row",children:[(0,b.jsxs)("div",{className:"col-6 col-md-6 col-lg-6 pb-0",children:[(0,b.jsx)("br",{}),null!==i&&void 0!==i?(0,b.jsxs)(g.bQ,{data:i,reorderableColumns:!0,resizableColumns:!0,searchPlaceholder:c("LoadingDetailsView_SearchGrid"),onCellClick:e=>n(e.rowData),children:[(0,b.jsx)(g.bQ.ActionBar,{}),a.map((function(e){return(0,b.jsx)(g.bQ.Column,{initialWidth:e.Width,field:e.Name,header:c(e.Name),renderer:t=>function(e,t){const{value:i,field:s}=e;return"boolean"===typeof i||"Active"===s?i?(0,b.jsx)(D.Icon,{name:"check",size:"small",color:"green"}):(0,b.jsx)(D.Icon,{name:"close",size:"small",color:"red"}):""===i||null===i||void 0===i?i:void 0!==t&&null!==t&&void 0!==t.DataType&&"DateTime"===t.DataType?new Date(i).toLocaleDateString()+" "+new Date(i).toLocaleTimeString():void 0!==t&&null!==t&&void 0!==t.DataType&&"Date"===t.DataType?new Date(i).toLocaleDateString():i}(t,e)},e.Name)}))]}):""]}),(0,b.jsxs)("div",{className:"col-6 col-md-6 col-lg-6",children:[(0,b.jsx)("span",{children:""!==t.EntityTypeCode||!0===l?(0,b.jsx)("h5",{children:function(e){let i="";return i=l?c("ReconciliationSchedule_AddFolioSchedule"):e.IsRecurrent?e.IsEOD?t.EntityTypeCode+"-"+c("ReconciliationSchedule_Schedule_EOD"):t.EntityTypeCode+"-"+c("ReconciliationSchedule_Schedule_EOS"):t.EntityTypeCode+"-"+t.ScheduleName,i}(t)}):""}),""!==t.EntityTypeCode||!0===l?(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{className:"col-12 col-md-6 col-lg-5",children:(0,b.jsx)(D.Input,{fluid:!0,value:t.ScheduleName,disabled:!1===l||!0===t.IsRecurrent,label:c("ReconciliationSchedule_FolioName"),error:c(s.ScheduleName),reserveSpace:!1,onChange:e=>o("ScheduleName",e),indicator:!0===l&&!1===t.IsRecurrent&&"required"})}),(0,b.jsxs)("div",{className:"col-12 col-md-6 col-lg-5",children:[(0,b.jsx)(D.InputLabel,{label:c("ReconciliationSchedule_Entity"),indicator:!0===l&&!1===t.IsRecurrent&&"required"}),(0,b.jsx)(D.Radio,{label:c("Reconciliation_Tank"),name:"RadioGroup",error:c(s.EntityTypeCode),disabled:!1===l,checked:"tank"===t.EntityTypeCode.toLowerCase(),onChange:()=>o("EntityTypeCode","Tank")}),(0,b.jsx)(D.Radio,{label:c("Reconcillation_Meter"),name:"RadioGroup",error:c(s.EntityTypeCode),disabled:!1===l,onChange:()=>o("EntityTypeCode","Meter"),checked:"meter"===t.EntityTypeCode.toLowerCase()})]})]}),(0,b.jsx)("div",{className:"row",children:(0,b.jsxs)("div",{className:"col-12 col-md-12 col-lg-12",children:[(0,b.jsx)(D.InputLabel,{label:c("ReconciliationSchedule_Schedule"),indicator:!0===l&&!1===t.IsRecurrent&&"required"}),(0,b.jsx)(D.Radio,{label:c("ReconciliationSchedule_Recurrent"),name:"OccuranceGroup",error:c(s.ScheduleType),disabled:!1===l,onChange:()=>o("IsRecurrent",!0),checked:"true"===t.IsRecurrent.toString().toLowerCase()}),(0,b.jsx)(D.Radio,{label:c("ReconciliationSchedule_OneTime"),name:"OccuranceGroup",onChange:()=>o("IsRecurrent",!1),checked:"false"===t.IsRecurrent.toString().toLowerCase(),disabled:!1===l}),(0,b.jsx)(D.Checkbox,{onChange:()=>o("IsEOD",!0),checked:"true"===t.IsEOD.toString().toLowerCase(),disabled:!1===l||!1===t.IsRecurrent,label:c("ReconciliationSchedule_Schedule_EOD")}),(0,b.jsx)(D.Checkbox,{onChange:()=>o("IsEOS",!0),checked:"true"===t.IsEOS.toString().toLowerCase(),disabled:!1===l||!1===t.IsRecurrent,label:c("ReconciliationSchedule_Schedule_EOS")})]})}),(0,b.jsx)("div",{className:"row",children:(0,b.jsx)("div",{className:"col-12 col-md-12 col-lg-8",children:(0,b.jsx)(D.DatePicker,{fluid:!0,value:null==t.StartDateTime?"":new Date(t.StartDateTime),label:c("ReconciliationSchedule_OneTime_Start"),disablePast:!1,type:"datetime",indicator:!0===l&&!1===t.IsRecurrent&&"required",error:c(s.StartDateTime),onChange:e=>o("StartDateTime",e),displayFormat:(0,C.F1)(),minuteStep:1,reserveSpace:!1,disabled:!0!==l||!1!==t.IsRecurrent})})}),(0,b.jsx)("div",{className:"row",children:(0,b.jsx)("div",{className:"col-12 col-md-12 col-lg-8",children:(0,b.jsx)(D.DatePicker,{fluid:!0,value:null==t.EndDateTime?"":new Date(t.EndDateTime),label:c("ReconciliationSchedule_OneTime_End"),disablePast:!1,error:c(s.EndDateTime),type:"datetime",indicator:!0===l&&!1===t.IsRecurrent&&"required",onChange:e=>o("EndDateTime",e),displayFormat:(0,C.F1)(),minuteStep:1,reserveSpace:!1,disabled:!0!==l||!1!==t.IsRecurrent})})})]}):""]})]})})}var x=i(80312),N=i(62900);class I extends s.Component{constructor(){super(...arguments),this.state={reportSchedule:{},modReportSchedule:{},saveEnabled:!1,isDeleteEnabled:!1,isReadyToRender:!1,modReconciliationSchedules:[],validationErrors:r.Th(E.GX),addNewSchedule:!1,showAuthenticationLayout:!1,tempReportSchedule:{}},this.handleRowClick=e=>{try{var t=[{key:d.zf,value:e.ScheduleName},{key:d.EW,value:e.EntityCode}],i={reconciliationCode:e.ScheduleName,keyDataCode:d.zf,KeyCodes:t};o()(u.VNv,r.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{var i=t.data;if(!0===i.IsSuccess){let t=c().cloneDeep(i.EntityResult);t.ScheduleName=e.ScheduleName,this.props.onScheduleSelect(t),this.setState({addNewSchedule:!1,isReadyToRender:!0,reportSchedule:c().cloneDeep(i.EntityResult),modReportSchedule:c().cloneDeep(i.EntityResult),saveEnabled:!1})}else this.setState({reportSchedule:c().cloneDeep(y._9),modReportSchedule:c().cloneDeep(y._9),isReadyToRender:!0}),console.log("Error in get ReconciliationReport:",i.ErrorList)})).catch((t=>{console.log("Error while get ReconciliationReport:",t,e)}))}catch(s){console.log("CarrierCompanyComposite:Error occured on Row click",s)}},this.handleChange=(e,t)=>{try{const i=c().cloneDeep(this.state.modReportSchedule);"IsEOD"===e?i.IsEOD=!i.IsEOD:"IsEOS"===e?i.IsEOS=!i.IsEOS:"IsRecurrent"===e&&!1===t?(i.IsEOD=!1,i.IsEOS=!1,i[e]=t):"IsRecurrent"===e&&!0===t?(i.ScheduleName="",i[e]=t):i[e]=t;const s={...this.state.validationErrors};void 0!==E.GX[e]&&(s[e]=r.jr(E.GX[e],t)),this.setState({validationErrors:s,modReportSchedule:i})}catch(i){console.log("ProductReconciliationScheduleDetailsComposite:Error occured on handleChange",i)}},this.handleReset=()=>{try{const{validationErrors:e}={...this.state};this.getReconciliationSchedules(),Object.keys(e).forEach((function(t){e[t]=""})),this.props.onUnScheduleSelect(null),this.setState({reportSchedule:c().cloneDeep(y._9),modReportSchedule:c().cloneDeep(y._9)})}catch(e){console.log("ProductReconciliationScheduleDetailsComposite:Error occured on handleReset",e)}},this.addProductReconciliationSchedule=()=>{try{this.handleAuthenticationClose(),this.setState({saveEnabled:!1});let e=c().cloneDeep(this.state.tempReportSchedule);if(!1===e.IsRecurrent){let t=this.prepareReconciliationReportDetails(e);t.Status=p.ZS.Open,this.CreateOneTimeReconciliationSchedule(t)}else e.Active=!0,this.CreateRecurrenceSchedule(e)}catch(e){console.log("ProductReconciliation Details Composite : Error in addProductReconciliationSchedule")}},this.handleSave=()=>{try{let e=c().cloneDeep(this.state.modReportSchedule);if(this.validateSave(e)){let t=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,i=c().cloneDeep(e);this.setState({showAuthenticationLayout:t,tempReportSchedule:i},(()=>{!1===t&&this.addProductReconciliationSchedule()}))}else this.setState({saveEnabled:!0})}catch(e){console.log("ProductReconciliationScheduleDetailsComposite:Error occured on handleSave",e)}},this.prepareReconciliationReportDetails=e=>{let t=c().cloneDeep(y.Pq);try{t.ReconciliationCode=e.ScheduleName,t.EntityTypeCode=e.EntityTypeCode,t.StartDate=e.StartDateTime,t.EndDate=e.EndDateTime,t.LastUpdatedTime=new Date,t.LastUpdatedBy=this.props.userDetails.EntityResult.Firstname+" "+this.props.userDetails.EntityResult.LastName}catch(i){console.log("ProductReconciliationReportComposite:Error occured on prepareReconciliationReportDetails",i)}return t},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentDidMount(){try{r.pJ(this.props.userDetails.EntityResult.IsArchived),this.getReconciliationSchedules(),this.setState({reportSchedule:c().cloneDeep(y._9),modReportSchedule:c().cloneDeep(y._9)})}catch(e){console.log("ProductReconciliationScheduleDetailsComposite:Error occured on componentDidMount",e)}}componentWillReceiveProps(e){try{!0===e.refreshScheduleUIRequired&&this.handleReset(),!0===e.addSchedule&&(this.handleReset(),this.setState({addNewSchedule:!0,saveEnabled:r.ab(this.props.userDetails.EntityResult.FunctionsList,x.i.view,x.y_)}))}catch(t){console.log("ProductReconciliationScheduleDetailsComposite:Error occured on componentWillReceiveProps",t)}}getReconciliationSchedules(){o()(u.$If,r.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({modReconciliationSchedules:t.EntityResult,isReadyToRender:!0}):(this.setState({modReconciliationSchedules:[],isReadyToRender:!0}),console.log("Error in GetReconciliationScheduleList:",t.ErrorList))})).catch((e=>{this.setState({modReconciliationSchedules:[],isReadyToRender:!0}),console.log("Error while getting GetReconciliationScheduleList:",e)}))}validateSave(e){const t={...this.state.validationErrors};Object.keys(E.GX).forEach((function(i){void 0!==e[i]&&(t[i]=r.jr(E.GX[i],e[i]))})),""===e.EntityTypeCode?t.ScheduleName="ReconciliationSchedule_EntityMandatory":""===e.IsRecurrent?t.ScheduleName="ReconciliationSchedule_ScheduleMandatory":!0===e.IsRecurrent&&!1===e.IsEOS&&!1===e.IsEOD?t.ScheduleName="ReconciliationSchedule_EODEOSMandatory":""!==e.IsRecurrent&&!1!==e.IsRecurrent||""!==e.ScheduleName||(t.ScheduleName="ReconciliationSchedule_FolioNameMandatory"),!1===e.IsRecurrent&&null===e.StartDateTime&&(t.StartDateTime="ReconciliationSchedule_StartDateMandatory"),!1===e.IsRecurrent&&null===e.EndDateTime&&(t.EndDateTime="ReconciliationSchedule_EndDateMandatory"),this.setState({validationErrors:t});var i=!0;return i&&(i=Object.values(t).every((function(e){return""===e}))),i}CreateRecurrenceSchedule(e){let t=[{key:d.zf,value:e.ScheduleName}],i={keyDataCode:d.zf,KeyCodes:t,Entity:e},s={messageType:"critical",message:"ReconciliationSchedule_SavedMsg",messageResultDetails:[{keyFields:["ReconciliationSchedule_Entity"],keyValues:[e.EntityTypeCode],isSuccess:!1,errorMessage:""}]};o()(u.u1j,r.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{let i=t.data;s.messageType=i.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess?(this.setState({saveEnabled:!1,addNewSchedule:!1}),this.getReconciliationSchedules()):(s.messageResultDetails[0].errorMessage=i.ErrorList[0],this.setState({saveEnabled:r.ab(this.props.userDetails.EntityResult.FunctionsList,x.i.add,x.y_)}),console.log("Error in Add ReconciliationReport:",i.ErrorList)),this.props.onSaved(e,"add",s)})).catch((t=>{this.setState({saveEnabled:r.ab(this.props.userDetails.EntityResult.FunctionsList,x.i.modify,x.y_)}),s.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"add",s)}))}CreateOneTimeReconciliationSchedule(e){let t=[{key:d.zf,value:e.Code}],i={keyDataCode:d.zf,KeyCodes:t,Entity:e},s={messageType:"critical",message:"ReconciliationSchedule_SavedMsg",messageResultDetails:[{keyFields:["ReconciliationReportDetail_RcCode"],keyValues:[e.ReconciliationCode],isSuccess:!1,errorMessage:""}]};o()(u.CJd,r.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{let i=t.data;s.messageType=i.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess?(this.setState({saveEnabled:!1,addNewSchedule:!1}),this.getReconciliationSchedules()):(s.messageResultDetails[0].errorMessage=i.ErrorList[0],this.setState({saveEnabled:r.ab(this.props.userDetails.EntityResult.FunctionsList,x.i.add,x.y_)}),console.log("Error in Add ReconciliationReport:",i.ErrorList)),this.props.onSaved(e,"add",s)})).catch((t=>{this.setState({saveEnabled:r.ab(this.props.userDetails.EntityResult.FunctionsList,x.i.modify,x.y_)}),s.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"add",s)}))}render(){return this.state.isReadyToRender?(0,b.jsxs)("div",{children:[(0,b.jsx)(S.A,{children:(0,b.jsx)(v.TranslationConsumer,{children:e=>(0,b.jsx)(R.A,{entityCode:e("ReconciliationSchedule_Title")})})}),(0,b.jsx)(S.A,{children:(0,b.jsx)(j,{modReportSchedule:this.state.modReportSchedule,modReconciliationSchedules:null!=this.state.modReconciliationSchedules?this.state.modReconciliationSchedules.Table:null,validationErrors:this.state.validationErrors,columnDetails:null!=this.state.modReconciliationSchedules?this.state.modReconciliationSchedules.Column:null,onFieldChange:this.handleChange,onRowClick:this.handleRowClick,addNewSchedule:this.state.addNewSchedule})}),(0,b.jsx)(S.A,{children:(0,b.jsx)(h.q,{handleBack:this.props.onBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.saveEnabled})}),this.state.showAuthenticationLayout?(0,b.jsx)(N.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:x.i.add,functionGroup:x.y_,handleOperation:this.addProductReconciliationSchedule,handleClose:this.handleAuthenticationClose}):null]}):(0,b.jsx)(m.A,{message:"Loading"})}}const T=(0,n.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(I)},43503:(e,t,i)=>{i.d(t,{A:()=>l});i(65043);var s=i(67907),a=i(72711),o=i(70579);function n(e){let{entityCode:t,newEntityName:i,popUpContents:n}=e;return(0,o.jsx)(s.TranslationConsumer,{children:e=>(0,o.jsx)("div",{className:"headerContainer",children:(0,o.jsxs)("div",{className:"row headerSpacing",children:[(0,o.jsx)("div",{className:"col paddingHeaderItemLeft",children:(0,o.jsx)("span",{style:{margin:"auto"},className:"headerLabel",children:""===t||void 0===t?e(i):t})}),""!==t&&void 0!==t&&n.length>0?(0,o.jsx)("div",{className:"headerItemRight",children:(0,o.jsx)(a.Popup,{element:(0,o.jsxs)("div",{children:[e(n[0].fieldName)+" ",":"," "+n[0].fieldValue,(0,o.jsx)(a.Icon,{style:{marginLeft:"10px"},root:"common",name:"caret-down",size:"small"})]}),position:"bottom left",children:(0,o.jsx)(a.List,{className:"detailsHeaderPopUp",children:n.map((t=>(0,o.jsxs)(a.List.Content,{className:"detailsHeaderPopUpListPadding",children:[e(t.fieldName)+" ",":"," "+t.fieldValue]},"content.fieldName")))})})}):""]})})})}n.defaultProps={entityCode:"",newEntityName:"",popUpContents:[]};const l=n},9256:(e,t,i)=>{i.d(t,{q:()=>n});i(65043);var s=i(72711),a=i(67907),o=i(70579);function n(e){let{handleBack:t,handleSave:i,handleReset:n,saveEnabled:l}=e;return(0,o.jsx)(a.TranslationConsumer,{children:e=>(0,o.jsxs)("div",{className:"row userActionPosition",children:[(0,o.jsx)("div",{className:"col-12 col-md-3 col-lg-4",children:(0,o.jsx)(s.Button,{className:"backButton",onClick:t,content:e("Back")})}),(0,o.jsx)("div",{className:"col-12 col-md-9 col-lg-8",children:(0,o.jsxs)("div",{style:{float:"right"},children:[(0,o.jsx)(s.Button,{content:e("LookUpData_btnReset"),className:"cancelButton",onClick:n}),(0,o.jsx)(s.Button,{content:e("Save"),disabled:!l,onClick:i})]})})]})})}n.defaultProps={saveEnabled:!1}},35861:(e,t,i)=>{i.d(t,{F1:()=>l,i7:()=>c,r4:()=>n});var s=i(86178),a=i.n(s),o=(i(15660),i(65043),i(70579));function n(e,t){if(Array.isArray(e)){0===e.filter((e=>e.text===t)).length&&e.unshift({value:null,text:t})}return e}function l(){let e=window.navigator.userLanguage||window.navigator.language;return a().locale(e),a().localeData().longDateFormat("L")}function c(e){return(0,o.jsxs)("div",{children:[(0,o.jsx)("span",{children:e}),(0,o.jsx)("div",{class:"ui red circular empty label badge  circle-padding"})]})}}}]);
//# sourceMappingURL=3418.4c18fd3b.chunk.js.map