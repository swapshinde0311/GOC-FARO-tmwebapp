"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[6094],{96094:(e,t,s)=>{s.r(t),s.d(t,{default:()=>y});var r=s(72711),a=s(65043),i=(s(63973),s(70579));const l=e=>{const{size:t,progress:s,strokeWidth:r,circleOneStroke:a}=e,l=t/2,o=t/2-r/2;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("svg",{className:"svg",width:t,height:t,children:[(0,i.jsx)("circle",{className:"svg-circle-bg",stroke:a,cx:l,cy:l,r:o,strokeWidth:r}),(0,i.jsx)("text",{x:"".concat(l),y:"".concat(l+10),className:"svg-circle-text",children:s})]})})};var o=s(53536),n=s.n(o),c=s(65187),d=s(78374),h=s(67907),p=s(39424),m=s(40854),T=s.n(m),u=s(72067),x=s(69062),g=s(14159),I=s(11981),P=s(80297);const C=window.runConfig.mapOptions;class f extends a.Component{constructor(){super(...arguments),this.state={selectedMOT:"",expandedRows:[],kpiList:[]},this.startRefreshTimer=()=>{let e=5;void 0!==C.refreshMinutes&&C.refreshMinutes>0&&(e=C.refreshMinutes),this.refreshTimer=setInterval((()=>{console.log("Details Refreshing started "+e+new Date),this.getKPIList()}),60*e*1e3)},this.stopRefreshTimer=()=>{null!==this.refreshTimer&&(clearInterval(this.refreshTimer),console.log("Details Refreshing stopped "+new Date))},this.handleMOTClick=e=>{this.setState({selectedMOT:e===this.state.selectedMOT?"":e})}}componentDidMount(){try{this.getKPIList(),this.startRefreshTimer()}catch(e){console.log("EnDashboarDetailsComposite:Error occured on ComponentDidMount",e)}}componentWillUnmount(){this.stopRefreshTimer()}getKPIList(){var e={message:"",messageType:"critical",messageResultDetails:[]};let t={PageName:p.Hk,InputParameters:[{key:"TerminalCode",value:this.props.selectedTerminal.TerminalCode}]};T()(u.dxq,x.tW(t,null)).then((t=>{var s=t.data;!0===s.IsSuccess?this.setState({kpiList:s.EntityResult.ListKPIDetails}):(this.setState({kpiList:[]}),console.log("Error in Dashboard KPIList:",s.ErrorList),e.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:s.ErrorList[0]})),e.messageResultDetails.length>0&&(0,g.toast)((0,i.jsx)(c.A,{children:(0,i.jsx)(I.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})})).catch((e=>{console.log("Error while getting Dashboard KPIList:",e)}))}getTPIList(){let e=this.state.selectedMOT,t=this.props.selectedTerminal,s=[],a=this.props.tpiList.filter((e=>e.Key===t.TerminalCode));try{if(a.length>0&&Array.isArray(a[0].Value.MoTTPIDetails)){let t=[];""!==e?t=a[0].Value.MoTTPIDetails.filter((t=>t.Key===e)):(t=[{Key:"Terminal",Value:[]}],a[0].Value.MoTTPIDetails.forEach((e=>{t[0].Value=t[0].Value.concat(e.Value)}))),t.length>0&&Array.isArray(t[0].Value)&&t[0].Value.length>0&&t[0].Value.forEach((e=>{if("SingleValue"===e.ParentTPIDetails.ChartType){let t=n().cloneDeep(e.ParentTPIDetails);t.childTPIs=n().cloneDeep(e.ChildTPIDetails),s.push(t)}}))}}catch(l){console.log("error in format TPIs at DashboardDetails.getTPIList",l)}return(0,i.jsx)(c.A,{children:(0,i.jsx)(h.TranslationConsumer,{children:e=>(0,i.jsxs)(d.bQ,{data:s,reorderableColumns:!0,resizableColumns:!0,expandedRows:this.state.expandedRows,rowExpansionTemplate:this.rowExpansionTemplate,children:[(0,i.jsx)(d.bQ.Column,{initialWidth:"20%",field:"TPICategory",header:e("tpi_Category"),sortable:!0,renderer:t=>e("tpi_"+t.rowData.TPICategory)},"TPICategory"),(0,i.jsx)(d.bQ.Column,{initialWidth:"20%",header:e("tpi_Name"),renderer:t=>{let s=JSON.parse(t.rowData.JSONFormat);return e("tpi_"+s.reflocalekey+"_name")}},"TPIName"),(0,i.jsx)(d.bQ.Column,{header:e("tpi_Formula"),renderer:e=>{let t=JSON.parse(e.rowData.JSONFormat).item.formulaCol,s=e.rowData.TPIData[0];return null===s[t]?"---":(0,i.jsx)("span",{children:s[t]})}},"Formula"),(0,i.jsx)(d.bQ.Column,{initialWidth:"12%",header:e("tpi_Value"),renderer:e=>{let t=JSON.parse(e.rowData.JSONFormat),s=t.item.tpiValueCol,r=t.item.unit,a=e.rowData.TPIData[0];return null===a[s]?"---":(0,i.jsxs)("span",{children:[a[s]," ",r]})}},"TPIValue"),(0,i.jsx)(d.bQ.Column,{initialWidth:"10%",field:"TPIValue",header:e("tpi_Index"),sortable:!0,renderer:e=>{let t=JSON.parse(e.rowData.JSONFormat),s=t.item.tpiValueCol,r=e.rowData.TPIData[0],a=t.item.categories,l=this.getTPIColorCode(a,"tpiValue",r[s]);return(0,i.jsx)("span",{style:{color:l},children:e.rowData.TPIValue})}},"TPIIndex"),(0,i.jsx)(d.bQ.Column,{initialWidth:"5px",renderer:e=>{if(e.rowData.childTPIs.length>0){const t=this.state.expandedRows.findIndex((t=>t.TransportationType===e.rowData.TransportationType&&t.TPIName===e.rowData.TPIName))>=0;return(0,i.jsx)("div",{onClick:()=>this.toggleExpand(e.rowData,t),children:(0,i.jsx)(r.Icon,{root:"common",name:t?"caret-down":"caret-right"})})}return""}})]})})})}getTPIColorCode(e,t,s){let r="";try{let a=null===s?0:s;if(Array.isArray(e))for(const s of e)if(a>=s[t]){r=s.color;break}}catch(a){console.log("DashboardDetails-GetColor-Error:",a)}return r}rowExpansionTemplate(e){return(0,i.jsxs)("div",{children:["childTPIS: ",e.childTPIs.length]})}toggleExpand(e,t){let s=this.state.expandedRows;if(t){let t=s.findIndex((t=>t.TransportationType===e.TransportationType&&t.TPIName===e.TPIName));s.splice(t,1)}else s.push(e);this.setState({expandedRows:s})}getTransportationTPIIndexes(){let e=this.props.selectedTerminal,t=[];try{let s=this.props.tpiList.filter((t=>t.Key===e.TerminalCode));s.length>0&&Array.isArray(s[0].Value.MoTTPIIndex)&&s[0].Value.MoTTPIIndex.forEach((s=>{let r=JSON.parse(e.TerminalConfig).TPIConfig[s.Key],a=s.Key.toLowerCase();a="icon-"+a.charAt(0).toUpperCase()+a.slice(1);let o="tpiMotPane",n="tpiMOTType";s.Key===this.state.selectedMOT&&(o="tpiSelectedMotPane",n="selectedtpiMOTType"),t.push((0,i.jsx)("div",{className:"col-12 col-md-6 col-lg-4 col-xl-3",children:(0,i.jsx)(c.A,{children:(0,i.jsx)(h.TranslationConsumer,{children:e=>(0,i.jsxs)("div",{className:o,children:[(0,i.jsxs)("div",{style:{display:"flex",padding:"8px",paddingBottom:"0px",borderBottom:"1.5px solid #f0f0f0"},children:[(0,i.jsx)("div",{children:(0,i.jsx)("span",{className:a+" "+n+" font24"})}),(0,i.jsx)("div",{children:(0,i.jsx)("span",{className:n,children:e(s.Key)})})]}),(0,i.jsx)("div",{style:{height:"100px",cursor:"pointer"},onClick:()=>this.handleMOTClick(s.Key),children:(0,i.jsx)(l,{progress:s.Value,size:95,strokeWidth:5,circleOneStroke:this.getTPIColorCode(r,"tpiIndex",s.Value)})})]})})})}))}))}catch(s){console.log("error in DashboardDetails- getTransportationTPIIndexes",s)}return t}render(){return(0,i.jsx)(c.A,{children:(0,i.jsx)(h.TranslationConsumer,{children:e=>(0,i.jsxs)("div",{style:{marginTop:"10px"},children:[(0,i.jsxs)("div",{className:" ui breadcrumb",children:[(0,i.jsx)("div",{className:"section",style:{cursor:"pointer"},onClick:()=>this.props.onBackClick(1),children:(0,i.jsx)(r.Icon,{root:"common",name:"caret-left",className:"caretLeft"})}),(0,i.jsx)("div",{className:"section pl-1",children:(0,i.jsx)("span",{children:e("tpi_Benchmarking")+" - "+this.props.selectedTerminal.TerminalCode})})]}),(0,i.jsx)(c.A,{children:(0,i.jsx)(P.A,{kpiList:this.state.kpiList})}),(0,i.jsx)("div",{className:"row",children:this.getTransportationTPIIndexes()}),(0,i.jsx)("div",{children:this.getTPIList()})]})})})}}const y=f}}]);
//# sourceMappingURL=6094.d28687c9.chunk.js.map