"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[3253,5841,8222],{16645:(e,t,s)=>{s.r(t),s.d(t,{default:()=>b});var i=s(65043),o=s(66554),a=s(40854),l=s.n(a),r=s(72067),n=s(7523),h=s(14159),d=(s(92342),s(97508)),c=(s(63973),s(11981)),u=s(69062),p=s(65187),y=s(93779),m=s(80312),E=s(23602),R=s(78278),S=s(40252),D=s(15821),A=s(62900),C=s(70579);class g extends i.Component{constructor(){super(...arguments),this.state={isDetails:"false",isReadyToRender:!1,isDetailsModified:"false",operationsVisibilty:{add:!1,delete:!1,shareholder:!1},selectedRow:{},selectedItems:[],data:{},isEnable:!0,allocationType:"",showAuthenticationLayout:!1},this.componentName="ShareholderAllocationComponent",this.componentWillUnmount=()=>{u.D6(this.componentName+"GridState"),window.removeEventListener("beforeunload",(()=>u.D6(this.componentName+"GridState")))},this.handleAdd=()=>{try{var{operationsVisibilty:e}={...this.state};e.delete=!1,e.add=!1,e.shareholder=!1,this.setState({isDetails:"true",selectedRow:{},operationsVisibilty:e})}catch(t){console.log("ShareholderAllocationComposite:Error occured on handleAdd",t)}},this.handleDelete=()=>{try{this.handleAuthenticationClose();var{operationsVisibilty:e}={...this.state};e.delete=!1,this.setState({operationsVisibilty:e});for(var t=[],s=0;s<this.state.selectedItems.length;s++){var i=this.props.userDetails.EntityResult.PrimaryShareholder,o=this.state.selectedItems[s].Common_Code,a={keyDataCode:0,ShareHolderCode:i,KeyCodes:[{Key:y.EW,Value:n.CY.SHAREHOLDER},{Key:y.f,Value:o}]};t.push(a)}l()(r.Rkh,u.tW(t,this.props.tokenDetails.tokenInfo)).then((t=>{console.log(t.data);var s=t.data,i=s.isSuccess;null!==s.ResultDataList&&void 0!==s.ResultDataList&&(i=s.ResultDataList.filter((function(e){return!e.IsSuccess})).length!==s.ResultDataList.length);var o=u.Cy(s,"ShareholderAllocation_DeletionStatus",["EntityCode"]);i?(this.setState({isReadyToRender:!1}),this.getShareholderAllocationList(this.props.userDetails.EntityResult.PrimaryShareholder),e.delete=!1,this.setState({selectedItems:[],operationsVisibilty:e,selectedRow:{}})):(e.delete=!0,this.setState({operationsVisibilty:e})),o.messageResultDetails.forEach((e=>{e.keyFields.length>0&&(e.keyFields[0]="ShareholderDetails_Code")})),(0,h.toast)((0,C.jsx)(p.A,{children:(0,C.jsx)(c.A,{notificationMessage:o})}),{autoClose:"success"===o.messageType&&1e4})})).catch((e=>{throw e}))}catch(d){console.log("ShareholderAllocationComposite:Error occured on handleDelete",d)}},this.handleRowClick=e=>{try{var{operationsVisibilty:t}={...this.state};t.add=u.ab(this.props.userDetails.EntityResult.FunctionsList,m.i.add,m.uy),t.delete=u.ab(this.props.userDetails.EntityResult.FunctionsList,m.i.remove,m.uy),t.shareholder=!1,this.setState({isDetails:"true",selectedRow:e,selectedItems:[e],operationsVisibilty:t})}catch(s){console.log("ShareholderAllocationComposite:Error occured on handleRowClick",s)}},this.handleSelection=e=>{try{var{operationsVisibilty:t}={...this.state};t.delete=e.length>0&&u.ab(this.props.userDetails.EntityResult.FunctionsList,m.i.remove,m.uy),this.setState({selectedItems:e,operationsVisibilty:t})}catch(s){console.log("ShareholderAllocationComposite:Error occured on handleSelection",s)}},this.savedEvent=(e,t,s)=>{try{var{operationsVisibilty:i}={...this.state};if(null===s)i.add=u.ab(this.props.userDetails.EntityResult.FunctionsList,m.i.add,m.uy),i.delete=u.ab(this.props.userDetails.EntityResult.FunctionsList,m.i.remove,m.uy),this.setState({isDetailsModified:"true",operationsVisibilty:i});else{if("success"===s.messageType&&(i.add=!0,i.delete=!0,this.setState({isDetailsModified:"true",operationsVisibilty:i})),"success"===s.messageType&&"add"===t){var o=[{Common_Code:e.EntityCode}];this.setState({selectedItems:o})}(0,h.toast)((0,C.jsx)(p.A,{children:(0,C.jsx)(c.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4})}}catch(a){console.log("ShareholderAllocationComposite:Error occured on savedEvent",a)}},this.handleBack=()=>{try{var{operationsVisibilty:e}={...this.state};e.add=u.ab(this.props.userDetails.EntityResult.FunctionsList,m.i.add,m.uy),e.delete=!1,this.setState({isDetails:!1,selectedRow:{},selectedItems:[],isReadyToRender:!1}),this.getShareholderAllocationList(this.props.userDetails.EntityResult.PrimaryShareholder),this.getKPIList()}catch(t){console.log("ShareholderComposite:Error occured on Back click",t)}},this.authenticateDelete=()=>{try{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showAuthenticationLayout:e}),!1===e&&this.handleDelete()}catch(e){console.log("ShareholderAllocation Composite : Error in authenticateDelete")}},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentDidMount(){try{u.pJ(this.props.userDetails.EntityResult.IsArchived),this.getLookUpData()}catch(e){console.log("ShareholderAllocationComposite:Error occured on ComponentDidMount",e)}window.addEventListener("beforeunload",(()=>u.D6(this.componentName+"GridState")))}getLookUpData(){l()(r.xAA+"?LookUpTypeCode=ProductAllocation",u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){let e=!0,i=t.EntityResult.AllocationEntity.toUpperCase();if(t.EntityResult.AllocationEntity.toUpperCase()===n.CY.CUSTOMER_AND_SHAREHOLDER&&(i=n.CY.SHAREHOLDER),t.EntityResult.AllocationEntity.toUpperCase()!==n.CY.SHAREHOLDER&&t.EntityResult.AllocationEntity.toUpperCase()!==n.CY.CUSTOMER_AND_SHAREHOLDER&&(e=!1),e&&"FALSE"===t.EntityResult.EnableProductAllocation.toUpperCase()&&(e=!1),this.setState({lookUpData:t.EntityResult,isEnable:e}),e){var{operationsVisibilty:s}={...this.state};s.add=u.ab(this.props.userDetails.EntityResult.FunctionsList,m.i.add,m.uy),this.setState({operationsVisibilty:s,allocationType:i},(()=>{this.getShareholderAllocationList(this.props.userDetails.EntityResult.PrimaryShareholder)}))}}else console.log("Error in getLookUpData: ",t.ErrorList)})).catch((e=>{console.log("ShareholderAllocationComposite: Error occurred on getLookUpData",e)}))}getShareholderAllocationList(e){try{l()(r.Ekm+"?ShareholderCode="+e+"&allocationType="+m.uy,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({data:t.EntityResult,isReadyToRender:!0}):(this.setState({data:[],isReadyToRender:!0}),console.log("Error in getShareholderAllocationList:",t.ErrorList))})).catch((e=>{this.setState({data:[],isReadyToRender:!0}),console.log("Error while getting Shareholder allocation List:",e)}))}catch(t){console.log("Error while getting Shareholder allocation List:",t)}}render(){return(0,C.jsxs)("div",{children:[(0,C.jsx)(p.A,{children:(0,C.jsx)(o.$,{operationsVisibilty:this.state.operationsVisibilty,breadcrumbItem:this.props.activeItem,onDelete:this.authenticateDelete,onAdd:this.handleAdd,shrVisible:!1,handleBreadCrumbClick:this.props.handleBreadCrumbClick})}),"true"===this.state.isDetails?(0,C.jsx)(p.A,{children:(0,C.jsx)(R.default,{selectedRow:this.state.selectedRow,onBack:this.handleBack,onSaved:this.savedEvent,allocationType:this.state.allocationType},"ShareholderAllocationDetails")}):this.state.isReadyToRender?(0,C.jsx)("div",{children:(0,C.jsx)(p.A,{children:(0,C.jsx)(E.P,{tableData:this.state.data.Table,columnDetails:this.state.data.Column,pageSize:this.props.userDetails.EntityResult.PageAttibutes.WebPortalListPageSize,exportRequired:!0,exportFileName:"ShareholderAllocationList",columnPickerRequired:!0,terminalsToShow:this.props.userDetails.EntityResult.PageAttibutes.NoOfTerminalsToShow,selectionRequired:!0,columnGroupingRequired:!0,onSelectionChange:this.handleSelection,onRowClick:this.handleRowClick,parentComponent:this.componentName})})}):(0,C.jsx)(C.Fragment,{children:this.state.isEnable?(0,C.jsx)(S.A,{message:"Loading"}):(0,C.jsx)(D.default,{errorMessage:"ProductAllocation_Enable"})}),(0,C.jsx)(p.A,{children:(0,C.jsx)(h.ToastContainer,{hideProgressBar:!0,closeOnClick:!1,closeButton:!0,newestOnTop:!0,position:"bottom-right",toastClassName:"toast-notification-wrap"})}),this.state.showAuthenticationLayout?(0,C.jsx)(A.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:m.i.remove,functionGroup:m.uy,handleClose:this.handleAuthenticationClose,handleOperation:this.handleDelete}):null]})}}const b=(0,d.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(g)}}]);
//# sourceMappingURL=3253.919790ee.chunk.js.map