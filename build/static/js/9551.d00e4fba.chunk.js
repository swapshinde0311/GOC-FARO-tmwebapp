"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[9551,9158,6001,6777,8382,735,3116,3920,3235,5973,8354],{40510:(e,t,i)=>{i.d(t,{A:()=>n});var s=i(65043),o=i(80297),a=i(65187),r=i(67907),l=i(70579);function n(e){let{KPIList:t,pageName:i,rowHeight:n,widgetHeight:d,isDraggable:c,isResizable:u,kpiDisplayTopBreakpoint:h}=e;const[p,m]=(0,s.useState)(1),C=s.useRef(null),E=()=>{let e=window.pageYOffset,t=p;if(C.current&&C.current.getBoundingClientRect().top<h)t=0;else{if(0!==e)return;t=1}m(t)};return(0,s.useEffect)((()=>{"undefined"!==typeof window&&window.addEventListener("scroll",E)})),(0,s.useEffect)((()=>()=>{window.removeEventListener("scroll",E)}),[]),(0,l.jsx)("div",{ref:C,children:1===p?(0,l.jsx)(r.TranslationConsumer,{children:e=>(0,l.jsx)("div",{style:{marginTop:"6px"},children:(0,l.jsx)(a.A,{children:(0,l.jsx)(o.A,{kpiList:t,isDraggable:c,isResizable:u,rowHeight:n,widgetHeight:d,pageName:i})})})}):""})}n.defaultProps={kpiDisplayTopBreakpoint:100}},89551:(e,t,i)=>{i.r(t),i.d(t,{default:()=>O});var s=i(65043),o=i(46100),a=i(93779),r=i(72067),l=i(97508),n=i(53536),d=i.n(n),c=i(40854),u=i.n(c),h=i(69062),p=i(65187),m=i(40252),C=i(9256),E=i(43503),P=i(72711),A=i(67907),g=i(78374),y=i(24904),v=i(85800),S=i(35861),D=i(70579);function I(e){let{finishedProduct:t,modFinishedProduct:i,validationErrors:s,additiveDetails:o,baseProductDetails:a,selectedColor:r,listOptions:l,modAssociations:n,expandedRows:d,selectedAssociationRows:c,onColorPickerChange:u,onColorPickerClose:h,onApplyColor:m,onChangeColor:C,toggleExpand:E,handleAddAssociation:I,handleDeleteAssociation:T,handleAddAdditive:N,handleDeleteAdditive:f,handleRowSelectionChange:R,handleCellDataEdit:b,onFieldChange:L,onAllTerminalsChange:x,onActiveStatusChange:F,colorPickerState:O,onHexValueChange:j,isValidHex:M,isEnterpriseNode:w,isDCHEnabled:k,isValidShareholderSysExtCode:H,modAttributeMetaDataList:_,attributeValidationErrors:V,onAttributeDataChange:B,hazardousEnabled:Q}=e;const U=(e,t)=>{let i=[];return i=e.find((e=>e.TerminalCode===t)),i.attributeValidationErrors},[q]=(0,A.useTranslation)(),G=e=>{const t=d.findIndex((t=>t.SeqNumber===e.rowData.SeqNumber))>=0;return(0,D.jsxs)("div",{onClick:()=>E(e.rowData,t),className:"compartmentIcon gridButtonFontColor",children:[(0,D.jsx)("span",{children:q(t?"Hide_Additives":"View_Additives")}),(0,D.jsx)(P.Icon,{root:"common",name:t?"caret-up":"caret-down",className:"margin_l10"})]})},W=e=>(0,D.jsxs)("div",{onClick:()=>f(e.rowData),className:"compartmentIcon gridButtonFontColor",children:[(0,D.jsx)("span",{children:q("FinishedProductList_Delete")}),(0,D.jsx)(P.Icon,{root:"common",name:"delete",className:"margin_l10"})]});function z(e){return Array.isArray(e.addtiveAssociations)&&e.addtiveAssociations.length>0?(0,D.jsx)("div",{className:"childTable ChildGridViewAllShipmentLoadingDetails",children:(0,D.jsxs)(g.bQ,{data:e.addtiveAssociations,children:[(0,D.jsx)(g.bQ.Column,{className:"expandedchildColumn",initialWidth:"10px"}),(0,D.jsx)(g.bQ.Column,{className:"compColHeight",field:"AdditiveCode",header:q("UnmatchedLocalTrans_Additive"),editable:!0,editFieldType:"text",customEditRenderer:Y},"AdditiveCode"),(0,D.jsx)(g.bQ.Column,{className:"compColHeight",field:"Quantity",header:q("FinishedProductInfo_Quantity"),editable:!0,editFieldType:"text",customEditRenderer:J},"Quantity"),(0,D.jsx)(g.bQ.Column,{className:"compColHeight",initialWidth:"200px",header:(0,D.jsxs)("div",{onClick:()=>N(e),className:"compartmentIcon gridButtonFontColor",children:[(0,D.jsx)("span",{children:q("FinishedProduct_Add_Additive")}),(0,D.jsx)(P.Icon,{root:"common",name:"badge-plus",size:"small",className:"margin_l10"})]}),renderer:W})]})}):(0,D.jsxs)("div",{className:"compartmentIcon",children:[(0,D.jsx)("div",{className:"gridButtonAlignLeft",children:q("CustomerInventory_NoRecordsFound")}),(0,D.jsxs)("div",{onClick:()=>N(e),className:"gridButtonFontColor",children:[(0,D.jsx)("span",{children:q("FinishedProduct_Add_Additive")}),(0,D.jsx)(P.Icon,{root:"common",name:"badge-plus",size:"small",className:"margin_l10 margin_r30"})]})]})}const K=e=>{let t=[];return"ALLPROD"===i.ProductType?Object.keys(a).forEach((e=>{void 0!==a[e]&&Array.isArray(a[e])&&a[e].forEach((e=>t.push({text:e,value:e})))})):(void 0!==a[i.ProductType]&&Array.isArray(a[i.ProductType])&&a[i.ProductType].forEach((e=>t.push({text:e,value:e}))),void 0!==a.ALLPROD&&Array.isArray(a.ALLPROD)&&a.ALLPROD.forEach((e=>t.push({text:e,value:e})))),(0,D.jsx)(P.Select,{className:"selectDropwdown",placeholder:"Select",value:n[e.rowIndex][e.field],fluid:!0,options:t,onChange:t=>b(t,e),indicator:"required",reserveSpace:!1,search:!0})},Y=e=>{try{let t=[],s=0;s=n.findIndex((t=>t.SeqNumber===e.rowData.baseSeqNumber));let r="";return Object.keys(a).forEach((t=>{a[t].findIndex((t=>t===e.rowData.BaseProductCode))>=0&&(r=t)})),"ALLPROD"===r?"ALLPROD"===i.ProductType?Object.keys(o).forEach((e=>{void 0!==o[e]&&Array.isArray(o[e])&&o[e].forEach((e=>t.push({text:e,value:e})))})):(void 0!==o[i.ProductType]&&Array.isArray(o[i.ProductType])&&o[i.ProductType].forEach((e=>t.push({text:e,value:e}))),void 0!==o.ALLPROD&&Array.isArray(o.ALLPROD)&&o.ALLPROD.forEach((e=>t.push({text:e,value:e})))):(void 0!==o[r]&&Array.isArray(o[r])&&o[r].forEach((e=>t.push({text:e,value:e}))),void 0!==o.ALLPROD&&Array.isArray(o.ALLPROD)&&o.ALLPROD.forEach((e=>t.push({text:e,value:e})))),(0,D.jsx)(P.Select,{className:"selectDropwdown",placeholder:"Select",value:n[s].addtiveAssociations[e.rowIndex][e.field],fluid:!0,options:t,onChange:t=>b(t,e),indicator:"required",reserveSpace:!1,search:!0})}catch(t){console.log("FinishedProductDetails:Error occured on handleAdvDropdownEdit",t)}},J=e=>{let t=0;return null!==e.rowData.AdditiveCode&&(t=n.findIndex((t=>t.BaseProductCode===e.rowData.BaseProductCode))),(0,D.jsx)(P.Input,{fluid:!0,value:null===e.rowData.AdditiveCode?n[e.rowIndex][e.field]:n[t].addtiveAssociations[e.rowIndex][e.field],onChange:t=>b(t,e),reserveSpace:!1})};return(0,D.jsx)(A.TranslationConsumer,{children:e=>(0,D.jsxs)("div",{className:"detailsContainer",children:[(0,D.jsxs)("div",{className:"row",children:[(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,D.jsx)(P.Input,{fluid:!0,value:i.Code,indicator:"required",disabled:""!==t.Code,onChange:e=>L("Code",e),label:e("FinishedProductList_Code"),error:e(s.Code),reserveSpace:!1})}),(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,D.jsx)(P.Input,{fluid:!0,value:i.Name,onChange:e=>L("Name",e),indicator:"required",label:e("FinishedProductList_Name"),error:e(s.Name),reserveSpace:!1})}),(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,D.jsx)(P.Input,{fluid:!0,value:null===i.AliasName?"":i.AliasName,onChange:e=>L("AliasName",e),label:e("FinishedProductList_AliasName"),reserveSpace:!1,error:e(s.AliasName)})}),(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,D.jsx)(P.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("FinishedProductList_ProductType"),value:i.ProductType,options:l.productTypeOptions,onChange:e=>L("ProductType",e),indicator:"required",error:e(s.ProductType),reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage")})}),(0,D.jsxs)("div",{className:"col-12 col-md-6 col-lg-4",children:[(0,D.jsx)(P.Input,{fluid:!0,className:"color-picker-input ".concat(r&&"#ffffff"!==r?"color-selected":""),label:e("FinishedProdut_colorCode"),onFocus:()=>u(),value:null===i.Color?"":i.Color,style:{backgroundColor:r},reserveSpace:!1,error:M?"":e(s.Color),onChange:e=>j(e)}),O?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(P.ColorPicker,{onApply:()=>m({hex:r}),onChange:e=>C(e),value:r}),(0,D.jsx)(P.Button,{type:"primary",iconRoot:"common",icon:"close",className:"color-picker-close",content:"",onClick:()=>h(),iconPosition:"left"})]}):""]}),(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,D.jsx)(P.Input,{fluid:!0,value:null===i.Description?"":i.Description,onChange:e=>L("Description",e),label:e("FinishedProductList_Description"),reserveSpace:!1,error:e(s.Description)})}),(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4 checkboxSelect",children:(0,D.jsx)(P.Checkbox,{label:e("BaseProductInfo_ExportGrade"),checked:i.ExportGrade,disabled:!1,onChange:e=>L("ExportGrade",e)})}),(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,D.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,D.jsx)("div",{style:{width:"48%"},children:(0,D.jsx)(P.Input,{fluid:!0,value:null===i.Density?"":i.Density.toLocaleString(),disabled:!i.ExportGrade,indicator:i.ExportGrade?"required":"",onChange:e=>L("Density",e),label:e("BaseProductInfo_Density"),error:i.ExportGrade?e(s.Density):"",reserveSpace:!1})})," ",(0,D.jsx)("div",{style:{width:"48%"},children:(0,D.jsx)(P.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("BaseProductInfox_UOM"),value:i.DensityUOM,options:l.densityUOMOptions,disabled:!i.ExportGrade,onChange:e=>L("DensityUOM",e),indicator:i.ExportGrade?"required":"",reserveSpace:!1,search:!0,noResultsMessage:e("noResultsMessage"),error:i.ExportGrade?e(s.DensityUOM):""})})]})}),k&&H?(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,D.jsx)(P.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("FP_ProdFamily"),value:i.ProductFamilyCode,options:l.prodFamilyOptions,onChange:e=>L("ProductFamilyCode",e),indicator:"required",reserveSpace:!1,search:!0,noResultsMessage:e("noResultsMessage"),error:e(s.ProductFamilyCode)})}):"",Q?(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,D.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,D.jsx)("div",{style:{width:"48%"},children:(0,D.jsx)(P.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("FP_HazardousCategory"),value:null===i.HazardousCategory?"":i.HazardousCategory,options:(0,S.r4)(l.hazardousProductCategoryOptions,e("Common_Select")),onChange:e=>L("HazardousCategory",e),reserveSpace:!1,search:!0,noResultsMessage:e("noResultsMessage"),error:e(s.HazardousCategory)})}),(0,D.jsx)("div",{style:{width:"48%"},children:(0,D.jsx)(P.Input,{fluid:!0,label:e("FP_SFLPercentage"),value:null===i.SFLPercent?"":i.SFLPercent.toLocaleString(),reserveSpace:!1,onChange:e=>L("SFLPercent",e),error:e(s.SFLPercent),indicator:null!==i.HazardousCategory&&""!==i.HazardousCategory?"required":""})})]})}):"",Q?(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,D.jsx)(P.Input,{fluid:!0,label:e("FP_HazardousNumber"),value:null===i.HazardousNumber?"":i.HazardousNumber,reserveSpace:!1,onChange:e=>L("HazardousNumber",e),error:e(s.HazardousNumber)})}):"",(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,D.jsx)(P.Input,{fluid:!0,value:null===i.ToleranceQuantity?"":i.ToleranceQuantity.toLocaleString(),label:e("FinishedProductInfo_ToleranceQuantityRoad"),reserveSpace:!1,onChange:e=>L("ToleranceQuantity",e),error:e(s.ToleranceQuantity)})}),(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,D.jsx)(P.Input,{fluid:!0,value:null===i.ToleranceQuantityForMarine?"":i.ToleranceQuantityForMarine.toLocaleString(),label:e("FinishedProductInfo_ToleranceQuantityMarine"),reserveSpace:!1,onChange:e=>L("ToleranceQuantityForMarine",e),error:e(s.ToleranceQuantityForMarine)})}),(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,D.jsx)(P.Input,{fluid:!0,value:null===i.ToleranceQuantityForRail?"":i.ToleranceQuantityForRail.toLocaleString(),label:e("FinishedProductInfo_ToleranceQuantityRail"),reserveSpace:!1,onChange:e=>L("ToleranceQuantityForRail",e),error:e(s.ToleranceQuantityForRail)})}),(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,D.jsx)(P.Input,{fluid:!0,value:null===i.ToleranceQuantityForPipeline?"":i.ToleranceQuantityForPipeline.toLocaleString(),label:e("FinishedProductInfo_ToleranceQuantityPipeline"),reserveSpace:!1,onChange:e=>L("ToleranceQuantityForPipeline",e),error:e(s.ToleranceQuantityForPipeline)})}),(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,D.jsx)(P.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("ProductType_ToleranceQuantityUOM"),value:i.ToleranceQuantityUOM,options:l.volumeUOMOptions,onChange:e=>L("ToleranceQuantityUOM",e),reserveSpace:!1,search:!0,noResultsMessage:e("noResultsMessage"),error:e(s.ToleranceQuantityUOM)})}),(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,D.jsx)(P.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("Cust_Status"),value:i.Active,options:[{text:e("ViewShipment_Ok"),value:!0},{text:e("ViewShipmentStatus_Inactive"),value:!1}],onChange:e=>F(e),reserveSpace:!1})}),(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,D.jsx)(P.Input,{fluid:!0,value:null===i.Remarks?"":i.Remarks,label:e("Cust_Remarks"),onChange:e=>L("Remarks",e),reserveSpace:!1,indicator:i.Active!==t.Active?"required":"",error:e(s.Remarks)})}),w?(0,D.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,D.jsx)(y.y,{terminalList:l.terminalCodes,selectedTerminal:i.TerminalCodes,error:"",onFieldChange:L,onCheckChange:x})}):""]}),(0,D.jsxs)("div",{className:"row",children:[(0,D.jsxs)("div",{className:"col-12 col-md-6 col-lg-4",children:[(0,D.jsx)("p",{children:e("FP_CaptureLoadingDetails")}),(0,D.jsx)(P.Radio,{label:e("ViewMarineUnloadingDetails_BCUCode"),checked:!i.WeighBridgeWeighingRequired,onChange:()=>L("WeighBridgeWeighingRequired",!1)}),(0,D.jsx)(P.Radio,{label:e("FP_weighBridge"),checked:!!i.WeighBridgeWeighingRequired,onChange:()=>L("WeighBridgeWeighingRequired",!0)})]}),(0,D.jsxs)("div",{className:"col-12 col-md-6 col-lg-4",children:[(0,D.jsx)("p",{children:e("FP_MeasurementType")}),(0,D.jsx)(P.Radio,{label:e("LoadType_Volumetric"),checked:!i.WeighingRequired,onChange:()=>L("WeighingRequired",!1),disabled:!!i.WeighBridgeWeighingRequired}),(0,D.jsx)(P.Radio,{label:e("FB_weighBased"),checked:!!i.WeighingRequired,onChange:()=>L("WeighingRequired",!0)})]})]}),_.length>0?_.map((t=>(0,D.jsx)(p.A,{children:(0,D.jsx)(P.Accordion,{children:(0,D.jsx)(P.Accordion.Content,{className:"attributeAccordian",title:w?t.TerminalCode+" - "+e("Attributes_Header"):e("Attributes_Header"),children:(0,D.jsx)(v.n,{selectedAttributeList:t.attributeMetaDataList,handleCellDataEdit:B,attributeValidationErrors:U(V,t.TerminalCode)})})})}))):null,(0,D.jsx)("div",{className:"row",children:(0,D.jsx)("div",{className:"col-12 detailsTable havingchildTable",children:(0,D.jsxs)(g.bQ,{data:n,rowExpansionTemplate:z,expandedRows:d,scrollable:!0,scrollHeight:"320px",selectionMode:"multiple",selection:c,onSelectionChange:R,children:[(0,D.jsx)(g.bQ.Column,{className:"compColHeight",field:"BaseProductCode",header:e("FinishedProductInfo_BaseProduct"),editable:!0,editFieldType:"text",customEditRenderer:K},"BaseProductCode"),(0,D.jsx)(g.bQ.Column,{className:"compColHeight",field:"Quantity",header:e("FinishedProductInfo_Quantity"),editable:!0,editFieldType:"text",customEditRenderer:J},"Quantity"),(0,D.jsx)(g.bQ.Column,{className:"expandedColumn",initialWidth:"200px",field:"BaseProductCode",header:(0,D.jsxs)("div",{className:"compartmentIconContainer gridButtonFontColor",children:[(0,D.jsxs)("div",{onClick:I,className:"compartmentIcon",children:[(0,D.jsx)("div",{children:(0,D.jsx)("h5",{className:"font14",children:e("FinishedProductInfo_Add")})}),(0,D.jsx)("div",{className:"margin_l10",children:(0,D.jsx)(P.Icon,{root:"common",name:"badge-plus",size:"small"})})]}),(0,D.jsxs)("div",{onClick:T,className:"compartmentIcon",children:[(0,D.jsx)("div",{className:"margin_l10",children:(0,D.jsx)("h5",{className:"font14",children:e("FinishedProductList_Delete")})}),(0,D.jsx)("div",{className:"margin_l10",children:(0,D.jsx)(P.Icon,{root:"common",name:"delete",size:"small"})})]})]}),renderer:G})]})})})]})})}I.defaultProps={listOptions:{productTypeOptions:[],densityUOMOptions:[],volumeUOMOptions:[],terminalCodes:[],prodFamilyOptions:[],hazardousProductCategoryOptions:[]},modAssociations:[],isEnterpriseNode:!1,isDCHEnabled:!1,isValidShareholderSysExtCode:!1,hazardousEnabled:!1};var T=i(80312),N=i(44192),f=i(28882),R=i(15417),b=i(40510),L=i(39424),x=i(62900);class F extends s.Component{constructor(){var e;super(...arguments),e=this,this.state={finishedProduct:{},baseProductDetails:{},additiveDetails:{},modFinishedProduct:{},appliedColor:"",selColor:"",modAssociations:[],validationErrors:h.Th(N.O8),isReadyToRender:!1,saveEnabled:!1,showColorPicker:!1,isValidHex:!0,productTypeOptions:[],densityUOMOptions:[],volumeUOMOptions:[],expandedRows:[],selectedAssociationRows:[],prodFamilyOptions:[],isValidShareholderSysExtCode:!1,attributeMetaDataList:[],modAttributeMetaDataList:[],attributeValidationErrors:[],finishedProductKPIList:[],hazardousEnabled:!1,hazardousProductCategoryOptions:[],showAuthenticationLayout:!1,tempFinishedProduct:{}},this.handleChange=(e,t)=>{try{const i=d().cloneDeep(this.state.modFinishedProduct);"WeighBridgeWeighingRequired"===e&&!0===t&&(i.WeighingRequired=!0),i[e]=t,"ProductType"===e&&this.handleProductTypeChange(t);const s={...this.state.validationErrors};void 0!==N.O8[e]&&(s[e]=h.jr(N.O8[e],t)),this.setState({validationErrors:s,modFinishedProduct:i}),"TerminalCodes"===e&&this.terminalSelectionChange(t)}catch(i){console.log("FinishedProductDetailsComposite:Error occured on handleChange",i)}},this.handleProductTypeChange=e=>{try{var t=d().cloneDeep(this.state.modAssociations);const s=d().cloneDeep(this.state.baseProductDetails);if("ALLPROD"!==e&&void 0!==s&&null!==s){var i=s[e];void 0!==i&&null!==i||(i=[]),(s.ALLPROD||[]).forEach((e=>{i.push(e)})),t=t.filter((e=>i.indexOf(e.BaseProductCode)>=0))}this.setState({modAssociations:t})}catch(s){console.log("FinishedProductDetailsComposite : Error in handleProductTypeChange")}},this.handleReset=()=>{try{let i=[];i=""===this.state.finishedProduct.Code?[]:this.getFinishedProductAssociations(this.state.finishedProduct.FinishedProductItems);var e=d().cloneDeep(this.state.finishedProduct);let s="";if(null!==this.state.finishedProduct.Color&&""!==this.state.finishedProduct.Color&&(s="#"+this.state.finishedProduct.Color),e.Color=s,this.setState({modFinishedProduct:e,validationErrors:[],modAssociations:i,modAttributeMetaDataList:[],selColor:s,appliedColor:s,showColorPicker:!1,isValidHex:!0},(()=>{this.props.userDetails.EntityResult.IsEnterpriseNode?(this.terminalSelectionChange(e.TerminalCodes),this.handleResetAttributeValidationError()):(this.localNodeAttribute(),this.handleResetAttributeValidationError())})),""===this.state.finishedProduct.Code){var t=this.state.terminalCodes;t=[],this.setState({terminalCodes:t})}}catch(i){console.log("FinishedProductDetailsComposite:Error occured on handleReset",i)}},this.saveFinishProduct=()=>{try{this.setState({saveEnabled:!1});let e=d().cloneDeep(this.state.tempFinishedProduct),t=h.pI(this.state.modAttributeMetaDataList);e=this.convertStringtoDecimal(e,t),""===this.state.finishedProduct.Code?this.createFinishedProduct(e):this.updateFinishedProduct(e)}catch(e){console.log("BaseProductDetailsComposite : Error in saveFinishProduct")}},this.handleSave=()=>{try{let e=d().cloneDeep(this.state.modFinishedProduct),t="";e.FinishedProductItems=this.fillDetails(this.state.modAssociations),null!==e.Color&&""!==e.Color?(t=d().cloneDeep(e.Color),e.Color=e.Color.substring(1)):e.Color="";let i=h.pI(this.state.modAttributeMetaDataList);if(this.validateSave(e,i)){e=this.convertStringtoDecimal(e,i);let t=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,s=d().cloneDeep(e);this.setState({showAuthenticationLayout:t,tempFinishedProduct:s},(()=>{!1===t&&this.saveFinishProduct()}))}else null!==e.Color&&""!==e.Color?e.Color=t:e.Color="",this.setState({modFinishedProduct:e})}catch(e){console.log("FinishedProductDetailsComposite:Error occured on handleSave",e)}},this.handleActiveStatusChange=e=>{try{let t=d().cloneDeep(this.state.modFinishedProduct);t.Active=e,t.Active!==this.state.finishedProduct.Active&&(t.Remarks=""),this.setState({modFinishedProduct:t})}catch(t){console.log(t)}},this.handleHexValueChange=e=>{try{let i=d().cloneDeep(this.state.modFinishedProduct);var t=d().cloneDeep(this.state.validationErrors);i.Color=e,this.setState({modFinishedProduct:i});let s=/^#[0-9A-Fa-f]{6}$/.test(e);s?this.setState({selColor:e}):(void 0===e&&""===e||""===i.Color&&void 0===i.Color||(t.Color="FP_Color_hex"),this.setState({selColor:"#ffffff"})),this.setState({validationErrors:t,isValidHex:s})}catch(i){console.log(i)}},this.assignColor=e=>{if(null!==e&&""!==e){var t="#"+e,i=d().cloneDeep(this.state.modFinishedProduct);i.Color=t,this.setState({selColor:t,modFinishedProduct:i,appliedColor:t})}else this.setState({selColor:"",appliedColor:t})},this.handleRowSelectionChange=e=>{this.setState({selectedAssociationRows:e})},this.handleColorPicker=()=>{try{this.setState({showColorPicker:!0,isValidHex:!0})}catch(e){console.log("FinishedProductDetailsProject:Error occured on handleColorPicker",e)}},this.handleColorPickerClose=()=>{var e=d().cloneDeep(this.state.modFinishedProduct);try{e.Color=void 0!==this.state.appliedColor?this.state.appliedColor:"",this.setState({showColorPicker:!1,selColor:void 0!==this.state.appliedColor?this.state.appliedColor:"",modFinishedProduct:e,isValidHex:!0})}catch(t){console.log("FinishedProductDetailsProject:Error occured on handleColorPickerClose",t)}},this.handleApplyColor=e=>{if(this.state.isValidHex){var t=d().cloneDeep(this.state.modFinishedProduct);t.Color=e.hex,this.setState({appliedColor:e.hex,showColorPicker:!1,selColor:e.hex,modFinishedProduct:t})}},this.handleOnColorChange=e=>{var t=d().cloneDeep(this.state.modFinishedProduct);t.Color=e.hex,this.setState({selColor:e.hex,modFinishedProduct:t,isValidHex:!0})},this.handleAddAssociation=()=>{if(!this.props.userDetails.EntityResult.IsArchived){if(this.state.saveEnabled&&null!==this.state.modFinishedProduct.ProductType)try{let e=d().cloneDeep(this.state.modAssociations),t={AdditiveCode:null,BaseProductCode:null,FinishedProductCode:this.state.modFinishedProduct.Code,Quantity:"1",SequenceNumber:null,Version:"1",addtiveAssociations:[]};t.SeqNumber=h.Mz(e),e.push(t),this.setState({modAssociations:e,selectedAssociationRows:[]})}catch(e){console.log("FinishedProductDetailsComposite:Error occured on handleAddAssociation",e)}}},this.handleDeleteAssociation=()=>{if(!this.props.userDetails.EntityResult.IsArchived){if(this.state.saveEnabled)try{if(null!=this.state.selectedAssociationRows&&this.state.selectedAssociationRows.length>0&&this.state.modAssociations.length>0){let e=d().cloneDeep(this.state.modAssociations);this.state.selectedAssociationRows.forEach((t=>{e=e.filter((e=>e.SeqNumber!==t.SeqNumber))})),e=h.su(e),e=h.Q3(e),e.forEach((e=>{e.addtiveAssociations.forEach((t=>{t.baseSeqNumber=e.SeqNumber}))})),this.setState({modAssociations:e})}this.setState({selectedAssociationRows:[]})}catch(e){console.log("FinishedProductDetailsComposite:Error occured on handleDeleteAssociation",e)}}},this.handleAddAdditive=e=>{if(!this.props.userDetails.EntityResult.IsArchived)try{if(d().cloneDeep(this.state.saveEnabled)){let t={AdditiveCode:"",BaseProductCode:e.BaseProductCode,FinishedProductCode:e.FinishedProductCode,Quantity:"1",SequenceNumber:"0",Version:"0"},i=d().cloneDeep(this.state.modAssociations),s=i.findIndex((t=>t.BaseProductCode===e.BaseProductCode&&t.SeqNumber===e.SeqNumber));s>=0&&null!==i[s].BaseProductCode&&""!==i[s].BaseProductCode&&void 0!==i[s].BaseProductCode&&(t.baseSeqNumber=i[s].SeqNumber,t.SeqNumber=h.Mz(i[s].addtiveAssociations),i[s].addtiveAssociations.push(t),this.toggleExpand(i[s],!0,!0)),this.setState({modAssociations:i,selectedAssociationRows:[]})}}catch(t){console.log("FinishedProductDetailsComposite:Error occured on handleAddAdditive",t)}},this.handleAllTerminalsChange=e=>{try{var t=[...this.props.terminalCodes],i=d().cloneDeep(this.state.modFinishedProduct);i.TerminalCodes=e?[...t]:[],this.setState({modFinishedProduct:i}),this.terminalSelectionChange(i.TerminalCodes)}catch(s){console.log("FinishedProductDetailsComposite:Error occured on handleAllTerminasChange",s)}},this.handleDeleteAdditive=e=>{if(!this.props.userDetails.EntityResult.IsArchived){if(this.state.saveEnabled)try{let t=d().cloneDeep(this.state.modAssociations),i=t.findIndex((t=>t.BaseProductCode===e.BaseProductCode&&t.SeqNumber===e.baseSeqNumber));i>=0&&(t[i].addtiveAssociations=t[i].addtiveAssociations.filter((t=>t.SeqNumber!==e.SeqNumber)),this.toggleExpand(t[i],!0,!0)),this.setState({modAssociations:t})}catch(t){console.log("FinishedProductDetailsComposite:Error occured on handleDeleteAdditive",t)}}},this.handleCellDataEdit=(e,t)=>{let i=d().cloneDeep(this.state.modAssociations),s={};if("AdditiveCode"===t.field||null!==t.rowData.AdditiveCode){let o=i.findIndex((e=>e.BaseProductCode===t.rowData.BaseProductCode&&e.SeqNumber===t.rowData.baseSeqNumber));i[o].addtiveAssociations[t.rowIndex][t.field]=e,s=i[o]}else i[t.rowIndex][t.field]=e,"BaseProductCode"===t.field&&(i[t.rowIndex].addtiveAssociations=[]),s=i[t.rowIndex];this.setState({modAssociations:i}),this.toggleExpand(s,!0,!0)},this.handleAttributeDataChange=(e,t)=>{try{let i=[],s=d().cloneDeep(this.state.modAttributeMetaDataList),o=s.filter((t=>t.TerminalCode===e.TerminalCode));o.length>0&&Array.isArray(o[0].attributeMetaDataList)&&(i=o[0].attributeMetaDataList.filter((t=>t.Code===e.Code))),i.length>0&&(i[0].DefaultValue=t);const a=d().cloneDeep(this.state.attributeValidationErrors);a.forEach((i=>{i.TerminalCode===e.TerminalCode&&(i.attributeValidationErrors[e.Code]=h.I5(e,t))})),this.setState({attributeValidationErrors:a,modAttributeMetaDataList:s})}catch(i){console.log("FinishedProductDetailsComposite:Error occured on handleAttributeDataChange",i)}},this.toggleExpand=function(t,i){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=d().cloneDeep(e.state.expandedRows),a=o.findIndex((e=>e.SeqNumber===t.SeqNumber));i?s&&a>=0?(o.splice(a,1),o.push(t)):o.splice(a,1):a>=0?o=o.filter((e=>e.BaseProductCode!==t.BaseProductCode&&e.SeqNumber!==t.SeqNumber)):o.push(t),e.setState({expandedRows:o})},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentWillReceiveProps(e){try{""!==this.state.finishedProduct.Code&&void 0===e.selectedRow.Common_Code&&this.props.tokenDetails.tokenInfo===e.tokenDetails.tokenInfo&&this.getFinishedProduct(e.selectedRow)}catch(t){console.log("FinishedProductDetailsComposite:Error occured on componentWillReceiveProps",t)}}localNodeAttribute(){try{var e=d().cloneDeep(this.state.attributeMetaDataList);Array.isArray(e.finishedproduct)&&e.finishedproduct.length>0&&this.terminalSelectionChange([e.finishedproduct[0].TerminalCode])}catch(t){console.log("DriverDetailsComposite:Error occured on localNodeAttribute",t)}}getAttributes(e){try{u()(r.fKH,h.tW([R.n7],this.props.tokenDetails.tokenInfo)).then((t=>{var i=t.data;!0===i.IsSuccess?this.setState({attributeMetaDataList:d().cloneDeep(i.EntityResult),attributeValidationErrors:h.Fl(i.EntityResult.finishedproduct)},(()=>this.getFinishedProduct(e))):console.log("Error in getAttributes:")}))}catch(t){console.log("Error while getAttributes:",t)}}componentDidMount(){try{h.pJ(this.props.userDetails.EntityResult.IsArchived),this.props.userDetails.EntityResult.IsDCHEnabled&&(this.GetProdFamilyList(),this.getShareholderDetail(this.props.selectedShareholder)),this.getHazardousLookup(),this.getBaseProductList(),this.getAdditivesList(),this.getAttributes(this.props.selectedRow),this.getProductTypes(),this.GetUOMList()}catch(e){console.log("FinishedProductDetailsComposite:Error occured on componentDidMount",e)}}terminalSelectionChange(e){try{let o=[];var t=[],i=[];t=d().cloneDeep(this.state.attributeMetaDataList),i=d().cloneDeep(this.state.modAttributeMetaDataList);const a=d().cloneDeep(this.state.attributeValidationErrors);var s=d().cloneDeep(this.state.modFinishedProduct);e.forEach((e=>{var a=i.find((t=>t.TerminalCode===e));void 0===a?t.finishedproduct.forEach((function(t){if(t.TerminalCode===e){var i=s.Attributes.find((t=>t.TerminalCode===e));void 0!==i&&t.attributeMetaDataList.forEach((function(e){var t=i.ListOfAttributeData.find((t=>t.AttributeCode===e.Code));void 0!==t&&(e.DefaultValue=t.AttributeValue)})),o.push(t)}})):o.push(a)})),i=[],i=o,i=h.nQ(i),a.forEach((t=>{void 0===e.find((e=>t.TerminalCode===e))&&Object.keys(t.attributeValidationErrors).forEach((e=>t.attributeValidationErrors[e]=""))})),this.setState({modAttributeMetaDataList:i,attributeValidationErrors:a})}catch(o){console.log("FinishedProductDetailsComposite:Error occured on terminalSelectionChange",o)}}getShareholderDetail(e){var t=[{key:a.FR,value:e}],i={ShareHolderCode:e,keyDataCode:a.FR,KeyCodes:t};u()(r.a6J,h.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({isValidShareholderSysExtCode:t.EntityResult.ExternalSystemCode>1}):(this.setState({isValidShareholderSysExtCode:!1}),console.log("Error in GetDestination:",t.ErrorList))})).catch((t=>{console.log("Error while getting Shareholder detail:",t,e)}))}createFinishedProduct(e){let t=[{key:a.xf,value:e.Code}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:a.xf,KeyCodes:t,Entity:e},s={messageType:"critical",message:"FinishedProduct_SavedStatus",messageResultDetails:[{keyFields:["FinishedProductList_Code"],keyValues:[e.Code],isSuccess:!1,errorMessage:""}]};u()(r.yfQ,h.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{let i=t.data;s.messageType=i.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess?this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,T.i.modify,T.AE),expandedRows:[],showAuthenticationLayout:!1},(()=>this.getFinishedProduct({Common_Code:e.Code}))):(s.messageResultDetails[0].errorMessage=i.ErrorList[0],e.Color="#"+e.Color,this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,T.i.add,T.AE,e),showAuthenticationLayout:!1}),console.log("Error in CreateFinishedProduct:",i.ErrorList)),this.props.onSaved(e,"add",s)})).catch((t=>{e.Color="#"+e.Color,this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,T.i.add,T.AE,e),showAuthenticationLayout:!1}),s.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"add",s)}))}fillDetails(e){let t=[];try{Array.isArray(e)&&e.forEach((e=>{(null!==e.BaseProductCode&&""!==e.BaseProductCode||null!==e.Quantity&&""!==e.Quantity)&&t.push({AdditiveCode:e.AdditiveCode,BaseProductCode:e.BaseProductCode,FinishedProductCode:this.state.modFinishedProduct.Code,Quantity:e.Quantity,SequenceNumber:e.SeqNumber,Version:e.Version}),Array.isArray(e.addtiveAssociations)&&e.addtiveAssociations.forEach((e=>{(null!==e.AdditiveCode&&""!==e.AdditiveCode||null!==e.Quantity&&""!==e.Quantity)&&t.push({AdditiveCode:e.AdditiveCode,BaseProductCode:e.BaseProductCode,FinishedProductCode:this.state.modFinishedProduct.Code,Quantity:e.Quantity,SequenceNumber:e.SequenceNumber,Version:e.Version})}))}))}catch(i){console.log("Error while making Finished Product body:",i)}return t}convertStringtoDecimal(e,t){try{return null!==e.Density&&""!==e.Density&&(e.Density=h.bo(e.Density)),null!==e.ToleranceQuantity&&""!==e.ToleranceQuantity&&(e.ToleranceQuantity=h.bo(e.ToleranceQuantity)),null!==e.ToleranceQuantityForMarine&&""!==e.ToleranceQuantityForMarine&&(e.ToleranceQuantityForMarine=h.bo(e.ToleranceQuantityForMarine)),null!==e.ToleranceQuantityForPipeline&&""!==e.ToleranceQuantityForPipeline&&(e.ToleranceQuantityForPipeline=h.bo(e.ToleranceQuantityForPipeline)),null!==e.ToleranceQuantityForRail&&""!==e.ToleranceQuantityForRail&&(e.ToleranceQuantityForRail=h.bo(e.ToleranceQuantityForRail)),this.state.hazardousEnabled&&null!==e.SFLPercent&&""!==e.SFLPercent&&(e.SFLPercent=h.bo(e.SFLPercent)),t=h.SC(t),e.Attributes=h.Gh(t),e}catch(i){console.log("convertStringtoDecimal error finishedProduct details",i)}}getProductTypes(){u()(r.YG_,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){var i=h.Zj(t.EntityResult);this.setState({productTypeOptions:i})}}else console.log("Error in getProductTypes:",t.ErrorList)})).catch((e=>{console.log("Error while getting getProductTypes:",e)}))}updateFinishedProduct(e){let t=[{key:a.xf,value:e.Code}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:a.xf,KeyCodes:t,Entity:e},s={messageType:"critical",message:"FinishedProduct_SavedStatus",messageResultDetails:[{keyFields:["FinishedProductList_Code"],keyValues:[e.Code],isSuccess:!1,errorMessage:""}]};u()(r.hQC,h.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{let i=t.data;s.messageType=i.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess?this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,T.i.modify,T.AE),showAuthenticationLayout:!1,expandedRows:[]},(()=>this.getFinishedProduct({Common_Code:e.Code}))):(s.messageResultDetails[0].errorMessage=i.ErrorList[0],e.Color="#"+e.Color,this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,T.i.add,T.AE,e),showAuthenticationLayout:!1}),console.log("Error in UpdateFinishedProduct Update:",i.ErrorList)),this.props.onSaved(e,"add",s)})).catch((t=>{e.Color="#"+e.Color,this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,T.i.add,T.AE,e),showAuthenticationLayout:!1}),s.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"add",s)}))}validateSave(e,t){try{var i=d().cloneDeep(this.state.validationErrors);Object.keys(N.O8).forEach((function(t){i[t]=h.jr(N.O8[t],e[t])})),e.Active!==this.state.finishedProduct.Active&&(null!==e.Remarks&&""!==e.Remarks||(i.Remarks="Receipt_RemarksRequired")),this.state.hazardousEnabled&&null!==e.HazardousCategory&&""!==e.HazardousCategory&&(""!==e.SFLPercent&&null!==e.SFLPercent||(i.SFLPercent="Common_InvalidValue")),(""!==e.ToleranceQuantity&&null!==e.ToleranceQuantity||""!==e.ToleranceQuantityForMarine&&null!==e.ToleranceQuantityForMarine||""!==e.ToleranceQuantityForPipeline&&null!==e.ToleranceQuantityForPipeline||""!==e.ToleranceQuantityForRail&&null!==e.ToleranceQuantityForRail)&&(null!==e.ToleranceQuantityUOM&&""!==e.ToleranceQuantityUOM||(i.ToleranceQuantityUOM="ERRMSG_FP_TOLERANCEQTYUOM_REQUIRED")),e.ExportGrade&&(null!==e.Density&&""!==e.Density||(i.Density="DENSITY_EMPTY_X"),null!==e.DensityUOM&&""!==e.DensityUOM||(i.DensityUOM="BSI_PRODUCTDENSITY_DENSITYUOM_MANDATORY_FOR_EXPORTGRADE_FP")),this.state.isValidShareholderSysExtCode&&this.props.userDetails.EntityResult.IsDCHEnabled&&(null!==e.ProductFamilyCode&&""!==e.ProductFamilyCode||(i.ProductFamilyCode="FP_ProdFamily_required"));let a={messageType:"critical",message:"FinishedProduct_SavedStatus",messageResultDetails:[]};if([...new Set(e.FinishedProductItems.map((e=>e.BaseProductCode)))].length!==e.FinishedProductItems.filter((e=>null===e.AdditiveCode)).length)return a.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"Duplicate_FP_BP_Details"}),this.props.onSaved(this.state.modFinishedProduct,"update",a),!1;let r=[];if(e.FinishedProductItems.forEach((e=>{if(null!==e.AdditiveCode&&""!==e.AdditiveCode){r.findIndex((t=>e.AdditiveCode===t.Code&&e.BaseProductCode===t.BCode))<0&&r.push({Code:e.AdditiveCode,BCode:e.BaseProductCode})}})),r.length!==e.FinishedProductItems.filter((e=>null!==e.AdditiveCode&&""!==e.AdditiveCode)).length)return a.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"Duplicate_FP_Addv_Details"}),this.props.onSaved(this.state.modFinishedProduct,"update",a),!1;Array.isArray(e.FinishedProductItems)&&e.FinishedProductItems.length>0?e.FinishedProductItems.forEach((e=>{f.Ws.forEach((t=>{let i="";void 0!==t.validator&&(i=h.jr(t.validator,e[t.field])),""!==i&&"AdditiveCode"===t.field&&null===e[t.field]&&(i=""),""!==i&&a.messageResultDetails.push({keyFields:null===e.AdditiveCode?["FinishedProductInfo_BaseProduct",t.displayName]:["FinishedProductInfo_BaseProduct","UnmatchedLocalTrans_Additive",t.displayName],keyValues:null===e.AdditiveCode?[e.BaseProductCode,e[t.field]]:[e.BaseProductCode,e.AdditiveCode,e[t.field]],isSuccess:!1,errorMessage:i})}))})):a.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"BP_Associtaion_Required"});var s=d().cloneDeep(this.state.attributeValidationErrors);t.forEach((e=>{s.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.attributeMetaDataList.forEach((e=>{t.attributeValidationErrors[e.Code]=h.I5(e,e.DefaultValue)}))}))})),this.setState({validationErrors:i,attributeValidationErrors:s});var o=!0;return s.forEach((e=>{if(!o)return o;o=Object.values(e.attributeValidationErrors).every((function(e){return""===e}))})),o&&(o=Object.values(i).every((function(e){return""===e}))),a.messageResultDetails.length>0?(this.props.onSaved(this.state.modFinishedProduct,"update",a),!1):o}catch(a){console.log("FinishedProductDetailsComposite:Error occured on ValidateSave",a)}}GetProdFamilyList(){u()(r.sQl+this.props.selectedShareholder,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){let e=[];void 0!==t.EntityResult&&null!==t.EntityResult&&(e=h.JT(t.EntityResult)),this.setState({prodFamilyOptions:e})}}else console.log("Error in GetProdFamilyList:",t.ErrorList)})).catch((e=>{console.log("Error while getting GetProdFamilyList:",e)}))}GetUOMList(){u()(r.WFM,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){let e=[],i=[];if(Array.isArray(t.EntityResult.DENSITY)&&(e=h.Zj(t.EntityResult.DENSITY)),Array.isArray(t.EntityResult.VOLUME)&&(i=h.Zj(t.EntityResult.VOLUME)),Array.isArray(t.EntityResult.MASS)){h.Zj(t.EntityResult.MASS).forEach((e=>i.push(e)))}this.setState({volumeUOMOptions:i,densityUOMOptions:e})}}else console.log("Error in GetUOMList:",t.ErrorList)})).catch((e=>{console.log("Error while getting GetUOMList:",e)}))}getFinishedProductAssociations(e){if(Array.isArray(e)&&e.length>0){let t=e.filter((e=>null===e.AdditiveCode));return t=h.Q3(d().cloneDeep(t)),t.sort(((e,t)=>e.SequenceNumber>t.SequenceNumber?1:e.SequenceNumber<t.SequenceNumber?-1:0)),t.forEach((t=>{t.addtiveAssociations=e.filter((e=>e.BaseProductCode===t.BaseProductCode&&null!==e.AdditiveCode)),t.addtiveAssociations=h.Q3(d().cloneDeep(t.addtiveAssociations)),t.addtiveAssociations.sort(((e,t)=>e.SeqNumber>t.SeqNumber?1:e.SeqNumber<t.SeqNumber?-1:0)),t.addtiveAssociations.forEach((e=>e.baseSeqNumber=t.SeqNumber))})),t}return[]}getHazardousLookup(){try{u()(r.xAA+"?LookUpTypeCode=HazardousMaterial",h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess&&t.EntityResult.RoadEnabled&&"true"===t.EntityResult.RoadEnabled.toLowerCase()&&(this.setState({hazardousEnabled:!0}),this.getHazardousCategories())}))}catch(e){console.log("FInishedProductDetailsComposite:Error occured on getHazardousLookup",e)}}getHazardousCategories(){u()(r.nWp,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){let e=h.Zj(t.EntityResult);this.setState({hazardousProductCategoryOptions:e})}}else console.log("Error in getHazardousCategories:",t.ErrorList)}))}catch(e){console.log("FInishedProductDetailsComposite:Error occured on getHazardousCategories",e)}getFinishedProduct(e){if(o.TO.Shareholdercode=this.props.selectedShareholder,o.TO.TerminalCodes=1===this.props.terminalCodes.length?[...this.props.terminalCodes]:[],void 0!==e.Common_Code){var t=[{key:a.xf,value:e.Common_Code}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:a.xf,KeyCodes:t};u()(r.cfM,h.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?(this.setState({isReadyToRender:!0,finishedProduct:d().cloneDeep(t.EntityResult),modFinishedProduct:d().cloneDeep(t.EntityResult),modAssociations:this.getFinishedProductAssociations(t.EntityResult.FinishedProductItems),saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,T.i.modify,T.AE)},(()=>{this.getKPIList(this.props.selectedShareholder,t.EntityResult.Code),this.props.userDetails.EntityResult.IsEnterpriseNode?this.terminalSelectionChange(t.EntityResult.TerminalCodes):this.localNodeAttribute()})),null!==t.EntityResult&&void 0!==t.EntityResult&&this.assignColor(t.EntityResult.Color)):(this.setState({finishedProduct:d().cloneDeep(o.TO),modFinishedProduct:d().cloneDeep(o.TO),modAssociations:[],isReadyToRender:!0,selColor:""}),console.log("Error in GetFinishedProduct:",t.ErrorList))})).catch((t=>{console.log("Error while getting Finished Product:",t,e)}))}else this.setState({finishedProduct:d().cloneDeep(o.TO),modFinishedProduct:d().cloneDeep(o.TO),modAttributeMetaDataList:[],isReadyToRender:!0,modAssociations:[],finishedProductKPIList:[],saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,T.i.add,T.AE),selColor:"",appliedColor:""},(()=>{!1===this.props.userDetails.EntityResult.IsEnterpriseNode&&this.localNodeAttribute()}))}handleResetAttributeValidationError(){try{var e=d().cloneDeep(this.state.attributeMetaDataList);this.setState({attributeValidationErrors:h.Fl(e.finishedproduct)})}catch(t){console.log("handleAttributeValidationError:Error occured on handleReset",t)}}getBaseProductList(){u()(r.mD_,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&void 0!==t.EntityResult){let e=t.EntityResult;this.setState({baseProductDetails:e})}}else console.log("Error in getBaseProductList:",t.ErrorList)})).catch((e=>{console.log("Error while getting Base Product List:",e)}))}getAdditivesList(){u()(r.Oyd,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&void 0!==t.EntityResult){let e=t.EntityResult;this.setState({additiveDetails:e})}}else console.log("Error in getAdditivesList:",t.ErrorList)})).catch((e=>{console.log("Error while getting Additives List:",e)}))}getKPIList(e,t){if(!0===h.ab(this.props.userDetails.EntityResult.FunctionsList,T.i.view,T.bL)){let i={PageName:L.zm,InputParameters:[{key:"ShareholderCode",value:e},{key:"FinishedProductCode",value:t}]};u()(r.dxq,h.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({finishedProductKPIList:t.EntityResult.ListKPIDetails}):(this.setState({finishedProductKPIList:[]}),console.log("Error in finished products KPIList:",t.ErrorList))})).catch((e=>{console.log("Error while getting Finished Products KPIList:",e)}))}}render(){const e=[{fieldName:"DriverInfo_LastUpdated",fieldValue:new Date(this.state.modFinishedProduct.LastUpdatedTime).toLocaleDateString()+" "+new Date(this.state.modFinishedProduct.LastUpdatedTime).toLocaleTimeString()},{fieldName:"DriverInfo_LastActive",fieldValue:void 0!==this.state.modFinishedProduct.LastActiveTime&&null!==this.state.modFinishedProduct.LastActiveTime?new Date(this.state.modFinishedProduct.LastActiveTime).toLocaleDateString()+" "+new Date(this.state.modFinishedProduct.LastActiveTime).toLocaleTimeString():""},{fieldName:"DriverInfo_CreatedTime",fieldValue:new Date(this.state.modFinishedProduct.CreatedTime).toLocaleDateString()+" "+new Date(this.state.modFinishedProduct.CreatedTime).toLocaleTimeString()}];return this.state.isReadyToRender?(0,D.jsxs)("div",{children:[(0,D.jsx)(p.A,{children:(0,D.jsx)(E.A,{entityCode:this.state.finishedProduct.Code,newEntityName:"FinishedProductInfo_NewProduct",popUpContents:e})}),(0,D.jsx)(b.A,{KPIList:this.state.finishedProductKPIList,children:" "}),(0,D.jsx)(p.A,{children:(0,D.jsx)(I,{finishedProduct:this.state.finishedProduct,modFinishedProduct:this.state.modFinishedProduct,validationErrors:this.state.validationErrors,additiveDetails:this.state.additiveDetails,baseProductDetails:this.state.baseProductDetails,selectedColor:this.state.selColor,listOptions:{productTypeOptions:this.state.productTypeOptions,densityUOMOptions:this.state.densityUOMOptions,volumeUOMOptions:this.state.volumeUOMOptions,terminalCodes:this.props.terminalCodes,prodFamilyOptions:this.state.prodFamilyOptions,hazardousProductCategoryOptions:this.state.hazardousProductCategoryOptions},attributeValidationErrors:this.state.attributeValidationErrors,modAttributeMetaDataList:this.state.modAttributeMetaDataList,attributeMetaDataList:this.state.attributeMetaDataList,modAssociations:this.state.modAssociations,expandedRows:this.state.expandedRows,selectedAssociationRows:this.state.selectedAssociationRows,onAttributeDataChange:this.handleAttributeDataChange,onColorPickerChange:this.handleColorPicker,onColorPickerClose:this.handleColorPickerClose,onApplyColor:this.handleApplyColor,onChangeColor:this.handleOnColorChange,toggleExpand:this.toggleExpand,handleAddAdditive:this.handleAddAdditive,handleAddAssociation:this.handleAddAssociation,handleDeleteAssociation:this.handleDeleteAssociation,handleDeleteAdditive:this.handleDeleteAdditive,handleRowSelectionChange:this.handleRowSelectionChange,handleCellDataEdit:this.handleCellDataEdit,onFieldChange:this.handleChange,onAllTerminalsChange:this.handleAllTerminalsChange,onActiveStatusChange:this.handleActiveStatusChange,onHexValueChange:this.handleHexValueChange,colorPickerState:this.state.showColorPicker,isValidHex:this.state.isValidHex,isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,isDCHEnabled:this.props.userDetails.EntityResult.IsDCHEnabled,isValidShareholderSysExtCode:this.state.isValidShareholderSysExtCode,hazardousEnabled:this.state.hazardousEnabled})}),(0,D.jsx)(p.A,{children:(0,D.jsx)(C.q,{handleBack:this.props.onBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.saveEnabled})}),this.state.showAuthenticationLayout?(0,D.jsx)(x.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:""===this.state.finishedProduct.Code?T.i.add:T.i.modify,functionGroup:T.AE,handleOperation:this.saveFinishProduct,handleClose:this.handleAuthenticationClose}):null]}):(0,D.jsx)(m.A,{message:"Loading"})}}const O=(0,l.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(F)},24904:(e,t,i)=>{i.d(t,{y:()=>l});i(65043);var s=i(67907),o=i(72711),a=i(69062),r=i(70579);function l(e){let{terminalList:t,selectedTerminal:i,validationError:l,onFieldChange:n,onCheckChange:d}=e;return null===i&&(i=[]),(0,r.jsx)(s.TranslationConsumer,{children:e=>(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)("div",{style:{width:"80%"},children:(0,r.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("TerminalCodes"),value:i,multiple:!0,options:a.Zj(t),onChange:e=>n("TerminalCodes",e),error:e(l),disabled:0===t.length,reserveSpace:!1})}),(0,r.jsx)("div",{className:"ddlSelectAll",children:(0,r.jsx)(o.Checkbox,{label:e("Common_All"),checked:Array.isArray(i)&&i.length===t.length,onChange:e=>d(e)})})]})})}l.defaultProps={terminalList:[],selectedTerminal:[],validationError:""}},43503:(e,t,i)=>{i.d(t,{A:()=>l});i(65043);var s=i(67907),o=i(72711),a=i(70579);function r(e){let{entityCode:t,newEntityName:i,popUpContents:r}=e;return(0,a.jsx)(s.TranslationConsumer,{children:e=>(0,a.jsx)("div",{className:"headerContainer",children:(0,a.jsxs)("div",{className:"row headerSpacing",children:[(0,a.jsx)("div",{className:"col paddingHeaderItemLeft",children:(0,a.jsx)("span",{style:{margin:"auto"},className:"headerLabel",children:""===t||void 0===t?e(i):t})}),""!==t&&void 0!==t&&r.length>0?(0,a.jsx)("div",{className:"headerItemRight",children:(0,a.jsx)(o.Popup,{element:(0,a.jsxs)("div",{children:[e(r[0].fieldName)+" ",":"," "+r[0].fieldValue,(0,a.jsx)(o.Icon,{style:{marginLeft:"10px"},root:"common",name:"caret-down",size:"small"})]}),position:"bottom left",children:(0,a.jsx)(o.List,{className:"detailsHeaderPopUp",children:r.map((t=>(0,a.jsxs)(o.List.Content,{className:"detailsHeaderPopUpListPadding",children:[e(t.fieldName)+" ",":"," "+t.fieldValue]},"content.fieldName")))})})}):""]})})})}r.defaultProps={entityCode:"",newEntityName:"",popUpContents:[]};const l=r},9256:(e,t,i)=>{i.d(t,{q:()=>r});i(65043);var s=i(72711),o=i(67907),a=i(70579);function r(e){let{handleBack:t,handleSave:i,handleReset:r,saveEnabled:l}=e;return(0,a.jsx)(o.TranslationConsumer,{children:e=>(0,a.jsxs)("div",{className:"row userActionPosition",children:[(0,a.jsx)("div",{className:"col-12 col-md-3 col-lg-4",children:(0,a.jsx)(s.Button,{className:"backButton",onClick:t,content:e("Back")})}),(0,a.jsx)("div",{className:"col-12 col-md-9 col-lg-8",children:(0,a.jsxs)("div",{style:{float:"right"},children:[(0,a.jsx)(s.Button,{content:e("LookUpData_btnReset"),className:"cancelButton",onClick:r}),(0,a.jsx)(s.Button,{content:e("Save"),disabled:!l,onClick:i})]})})]})})}r.defaultProps={saveEnabled:!1}},85800:(e,t,i)=>{i.d(t,{n:()=>n});i(65043);var s=i(72711),o=i(67907),a=i(7523),r=i(35861),l=i(70579);function n(e){let{selectedAttributeList:t,handleCellDataEdit:i,attributeValidationErrors:n}=e;const d=e=>{if("0000-00-00"===e.DefaultValue)return c(e,new Date),new Date;var t=e.DefaultValue.split("-");return new Date(t[0],t[1]-1,t[2])},c=(e,t)=>{var s=new Date(t);t=s.getFullYear()+"-"+("0"+(s.getMonth()+1)).slice(-2)+"-"+("0"+s.getDate()).slice(-2),i(e,t)};return(0,l.jsx)(o.TranslationConsumer,{children:e=>(0,l.jsx)("div",{className:"row",children:(0,l.jsx)("div",{className:"col-md-12 attributeDetails-wrap",children:(0,l.jsx)("div",{className:"row",children:t.map((t=>t.DataType.toLowerCase()===a.pe.STRING.toLowerCase()&&!0===t.IsVisible?(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(s.Input,{fluid:!0,label:e(t.DisplayName),value:null===t.DefaultValue?"":t.DefaultValue,indicator:!0===t.IsMandatory?"required":null,disabled:!0===t.IsReadonly,onChange:e=>i(t,e),error:e(n[t.Code]),reserveSpace:!1})}):t.DataType.toLowerCase()!==a.pe.INT.toLowerCase()&&t.DataType.toLowerCase()!==a.pe.LONG.toLowerCase()||!0!==t.IsVisible?t.DataType.toLowerCase()!==a.pe.FLOAT.toLowerCase()&&t.DataType.toLowerCase()!==a.pe.DOUBLE.toLowerCase()||!0!==t.IsVisible?t.DataType.toLowerCase()===a.pe.BOOL.toLowerCase()&&!0===t.IsVisible?(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(s.Checkbox,{className:"deviceCheckBox customDeviceCheckBox",label:e(t.DisplayName),checked:null===t.DefaultValue?"":"true"===t.DefaultValue.toString().toLowerCase(),disabled:!0===t.IsReadonly,onChange:e=>i(t,e)})}):t.DataType.toLowerCase()===a.pe.DATETIME.toLowerCase()&&!0===t.IsVisible?(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(s.DatePicker,{fluid:!0,value:null===t.DefaultValue||""===t.DefaultValue?"":d(t),label:e(t.DisplayName),displayFormat:(0,r.F1)(),showYearSelector:"true",indicator:!0===t.IsMandatory?"required":null,disabled:!0===t.IsReadonly,onChange:e=>c(t,e),onTextChange:e=>{c(t,e)},error:e(n[t.Code]),reserveSpace:!1})}):null:(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(s.Input,{fluid:!0,label:e(t.DisplayName),value:null===t.DefaultValue||""===t.DefaultValue?"":t.DefaultValue.toLocaleString(),indicator:!0===t.IsMandatory?"required":null,disabled:!0===t.IsReadonly,onChange:e=>i(t,e),error:e(n[t.Code]),reserveSpace:!1})}):(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(s.Input,{fluid:!0,label:e(t.DisplayName),value:null===t.DefaultValue?"":t.DefaultValue,indicator:!0===t.IsMandatory?"required":null,disabled:!0===t.IsReadonly,onChange:e=>i(t,e),error:e(n[t.Code]),reserveSpace:!1})})))})})})})}},15417:(e,t,i)=>{i.d(t,{$7:()=>L,AN:()=>ie,AU:()=>f,Ak:()=>Ue,Ao:()=>s,B6:()=>K,C4:()=>ke,CG:()=>J,Ct:()=>W,Cw:()=>M,EY:()=>T,G$:()=>Ke,G6:()=>Xe,GF:()=>pe,GJ:()=>j,Gj:()=>ue,Gl:()=>ae,H9:()=>ze,HB:()=>Ne,HP:()=>I,Hr:()=>Te,II:()=>ot,IQ:()=>y,Jr:()=>Q,Jx:()=>ge,Ki:()=>te,LP:()=>oe,Lv:()=>a,MK:()=>P,MX:()=>ee,Mx:()=>G,N4:()=>Oe,NH:()=>Ae,OF:()=>Ze,Ps:()=>H,Q7:()=>We,QY:()=>k,SF:()=>r,Sq:()=>De,Sw:()=>le,TQ:()=>$,U7:()=>N,UH:()=>E,UO:()=>re,V_:()=>be,Vy:()=>_e,W9:()=>de,WN:()=>g,Wr:()=>o,Ww:()=>X,XP:()=>Re,Xk:()=>z,Yb:()=>Se,Yy:()=>m,Z2:()=>je,ZN:()=>x,ZO:()=>ve,Zu:()=>Qe,_G:()=>q,_N:()=>u,_u:()=>ce,ad:()=>ne,al:()=>ye,ao:()=>_,bK:()=>U,bN:()=>A,cf:()=>F,dO:()=>Le,dU:()=>p,dv:()=>l,eE:()=>Y,g:()=>D,gG:()=>n,gS:()=>fe,gT:()=>it,gW:()=>Z,gZ:()=>$e,go:()=>R,gp:()=>V,hq:()=>Fe,i6:()=>et,ip:()=>he,k9:()=>C,kI:()=>v,l4:()=>Me,l5:()=>S,lA:()=>O,lU:()=>Je,mD:()=>Ve,mY:()=>w,mq:()=>d,n$:()=>st,n7:()=>h,nZ:()=>xe,rA:()=>we,s$:()=>He,s8:()=>Be,se:()=>Pe,tA:()=>Ie,vK:()=>tt,vs:()=>Ee,w2:()=>Ye,w4:()=>Ce,wT:()=>c,wY:()=>b,wf:()=>me,wk:()=>se,xW:()=>B,yM:()=>qe,yO:()=>Ge});const s="driver",o="carriercompany",a="shareholder",r="baseProduct",l="TRAILER",n="TRAILERCOMPARTMENT",d="terminal",c="customer",u="destination",h="finishedproduct",p="tank",m="marine_vessel",C="marine_trailercompartment",E="supplier",P="vehicle",A="vehicletrailer",g="originterminal",y="bay",v="loadingArm",S="cardreader",D="vehicleprimemover",I="meter",T="SHIPMENT",N="SHIPMENTCOMPARTMENT",f="SHIPMENTDESTINATIONCOMPARTMENT",R="SHIPMENTDETAILS",b="SHIPMENTTRAILERWEIGHBRIDGE",L="SHIPMENTTRAILER",x="SHIPMENTSTATUSTIME",F="MARINEDISPATCH",O="MARINEDISPATCHCOMPARTMENTDETAIL",j="railwagon",M="primemover",w="bcu",k="RAILRECEIPTPLAN",H="RAILRECEIPTWAGONDETAILPLAN",_="RAILUNLOADINGDETAILSFP",V="RAILUNLOADINGDETAILSBP",B="RAILUNLOADINGDETAILSADDITIVE",Q="RAILDISPATCHPLAN",U="RAILDISPATCHITEM",q="RAILDISPATCHSTATUSCHANGE",G="RAILDISPATCHWAGON",W="RAILDISPATCHWAGONDETAILPLAN",z="RAILDISPATCHWAGONWEIGHBRIDGE",K="RAILDISPATCHWAGONCOMPARTMENT",Y="RAILLOADINGDETAILSFP",J="RAILLOADINGDETAILSBP",Z="RAILLOADINGDETAILSADDITIVE",X="marineReceipt",$="UNACCOUNTEDMETERTRANSACTION",ee="UNACCOUNTEDTANKTRANSACTION",te="marineLoadingDetailsFP",ie="marineLoadingDetailsAdditive",se="marineLoadingDetailsBP",oe="marineReceiptCompartmentDetail",ae="marineUnloadingDetailsFP",re="marineUnloadingDetailsBP",le="accessCard",ne="LOADINGDETAILSFP",de="LOADINGDETAILSBP",ce="LOADINGDETAILSADDITIVE",ue="MARINERECEIPTSTATUSTIME",he="MARINEDISPATCHSTATUSTIME",pe="RECEIPT",me="UNLOADINGTRANSACTIONS",Ce="ORDER",Ee="ORDERITEM",Pe="CONTRACT",Ae="CONTRACT_ITEM",ge="RECEIPTORIGINTERMINALCOMPARTMENT",ye="GeneralTMUser_CAPTAIN",ve="weighbridge",Se="deu",De="GeneralTMUser_STAFF",Ie="GeneralTMUser_VISITOR",Te="PIPELINEHEADER",Ne="SEALMASTER",fe="PIPELINERECEIPT",Re="ROADSHIPMENTSLOTINFO",be="ROADRECEIPTSLOTINFO",Le="MARINESHIPMENTSLOTINFO",xe="MARINERECEIPTSLOTINFO",Fe="PIPELINEDISPATCH",Oe="PIPELINETRANSACTIONS",je="PIPELINEDISPATCHSTATUSTIME",Me="PIPELINERECEIPTSTATUSTIME",we="PROCESSCONFIG",ke="PRODUCTALLOCATIONITEM",He="HSEINSPECTIONSHIPMENTRIGIDTRUCK",_e="HSEINSPECTIONSHIPMENTTRAILER",Ve="HSEINSPECTIONSHIPMENTPRIMEMOVER",Be="HSEINSPECTIONSHIPMENTNONFILLINGVEHICLE",Qe="HSEINSPECTIONMARINESHIPMENTBARGE",Ue="HSEINSPECTIONMARINESHIPMENTSHIP",qe="HSEINSPECTIONSHIPMENTRAILWAGON",Ge="HSEINSPECTIONSHIPMENTPIPELINE",We="HSEINSPECTIONRECEIPTRIGIDTRUCK",ze="HSEINSPECTIONRECEIPTTRAILER",Ke="HSEINSPECTIONRECEIPTPRIMEMOVER",Ye="HSEINSPECTIONRECEIPTNONFILLINGVEHICLE",Je="HSEINSPECTIONMARINERECEIPTBARGE",Ze="HSEINSPECTIONMARINERECEIPTSHIP",Xe="HSEINSPECTIONRECEIPTRAILWAGON",$e="HSEINSPECTIONRECEIPTPIPELINE",et="SHAREHOLDERAGREEMENT",tt="COATEMPLATE",it="COAMANAGEMENT",st="COACUSTOMER",ot="COAASSIGNMENT"},35861:(e,t,i)=>{i.d(t,{F1:()=>l,i7:()=>n,r4:()=>r});var s=i(86178),o=i.n(s),a=(i(15660),i(65043),i(70579));function r(e,t){if(Array.isArray(e)){0===e.filter((e=>e.text===t)).length&&e.unshift({value:null,text:t})}return e}function l(){let e=window.navigator.userLanguage||window.navigator.language;return o().locale(e),o().localeData().longDateFormat("L")}function n(e){return(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{children:e}),(0,a.jsx)("div",{class:"ui red circular empty label badge  circle-padding"})]})}}}]);
//# sourceMappingURL=9551.d00e4fba.chunk.js.map