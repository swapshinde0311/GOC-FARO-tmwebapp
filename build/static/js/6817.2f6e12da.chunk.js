(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[6817,8149,5841,8222],{66554:(e,t,i)=>{"use strict";i.d(t,{$:()=>c});var a=i(65043),s=i(72711),o=i(67907),r=i(65187),n=i(69062),l=i(70579);function d(e){let{operationsVisibilty:t,breadcrumbItem:i,shareholders:d,selectedShareholder:c,onShareholderChange:h,onDelete:u,onAdd:p,popUpContent:m,shrVisible:C,handleBreadCrumbClick:g,addVisible:R,deleteVisible:S}=e;const[y,T]=(0,a.useState)(!1),[D,E]=(0,a.useState)(!1);function A(){t.add&&(m.length>0?E(!1===D):p())}return(0,l.jsxs)("div",{className:"row",style:{alignItems:"flex-start",padding:"0px"},children:[(0,l.jsx)("div",{className:"col-9 col-sm-9 col-md-9 col-lg-10 col-xl-10",style:{padding:"0px"},children:(0,l.jsxs)("div",{className:"row",style:{marginTop:"10px",alignItems:""},children:[(0,l.jsx)("div",{className:"col-12 col-sm-12 col-md-12 col-lg-6 col-xl-8",children:(0,l.jsxs)(r.A,{children:[" ",(0,l.jsx)(o.TranslationConsumer,{children:e=>(0,l.jsxs)(s.Breadcrumb,{children:[i.parents.map((t=>(0,l.jsx)(s.Breadcrumb.Item,{onClick:()=>{void 0!==g&&null!==g&&g(t.itemCode,i.parents)},children:e(t.localizedKey)},t.itemCode))),(0,l.jsx)(s.Breadcrumb.Item,{children:e(i.localizedKey)},i.itemCode)]})})]})}),(0,l.jsx)("div",{className:"col-12 col-sm-12 col-md-12 col-lg-6 col-xl-4",children:(0,l.jsx)(o.TranslationConsumer,{children:e=>(0,l.jsx)("div",{className:"compartmentIcon",style:{justifyContent:"flex-start"},children:!1===C?"":(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{children:(0,l.jsxs)("h4",{className:"shrText",children:[e("Common_Shareholder"),":"]})}),(0,l.jsx)("div",{className:"opSelect",children:(0,l.jsx)(s.Select,{placeholder:e("Common_Shareholder"),value:c,disabled:!t.shareholder,options:n.Zj(d),onChange:e=>h(e)})})]})})})}),(0,l.jsx)(o.TranslationConsumer,{children:e=>(0,l.jsxs)(s.Modal,{open:y,size:"small",children:[(0,l.jsx)(s.Modal.Content,{children:(0,l.jsx)("div",{children:(0,l.jsx)("b",{children:e("Confirm_Delete")})})}),(0,l.jsxs)(s.Modal.Footer,{children:[(0,l.jsx)(s.Button,{type:"secondary",content:e("Cancel"),onClick:()=>T(!1)}),(0,l.jsx)(s.Button,{type:"primary",content:e("PipelineDispatch_BtnSubmit"),onClick:()=>{T(!1),u()}})]})]})})]})}),(0,l.jsx)("div",{className:"col-3 col-sm-3 col-md-3 col-lg-2 col-xl-2",children:(0,l.jsxs)("div",{style:{float:"right",display:"inline-block",marginTop:"10px"},children:[R?(0,l.jsx)(s.Popup,{position:"bottom right",className:"popup-theme-wrap",element:(0,l.jsx)("div",{className:(t.add?"iconCircle ":"iconCircleDisable ")+"iconblock",onClick:A,children:(0,l.jsx)(s.Icon,{root:"common",name:"badge-plus",size:"small",color:"white"})}),on:"click",open:D,children:(0,l.jsx)("div",{onMouseLeave:()=>E(!1),children:(0,l.jsx)(o.TranslationConsumer,{children:e=>(0,l.jsx)(s.VerticalMenu,{children:(0,l.jsxs)(s.VerticalMenu,{children:[(0,l.jsx)(s.VerticalMenu.Header,{children:e("Common_Create")}),m.map((t=>(0,l.jsx)(s.VerticalMenu.Item,{onClick:()=>{return e=t.fieldName,E(!1),void p(e);var e},children:e(t.fieldValue)})))]})})})})}):"",S?(0,l.jsx)("div",{style:{marginLeft:"10px"},onClick:()=>{t.delete&&T(!0)},className:(t.delete?"iconCircle ":"iconCircleDisable ")+"iconblock",children:(0,l.jsx)(s.Icon,{root:"common",name:"delete",size:"small",color:"white"})}):""]})})]})}d.defaultProps={operationsVisibilty:{add:!1,delete:!1,shareholder:!1},breadcrumbItem:{itemName:"",itemCode:"",localizedKey:"",itemProps:{},parents:[],isComponent:!1},shareholders:[],selectedShareholder:"",popUpContent:[],shrVisible:!0,addVisible:!0,deleteVisible:!0};i(38726);function c(e){let{operationsVisibilty:t,breadcrumbItem:i,shareholders:a,selectedShareholder:s,onShareholderChange:o,onDelete:r,onAdd:n,popUpContent:c,shrVisible:h,handleBreadCrumbClick:u,addVisible:p,deleteVisible:m}=e;return(0,l.jsx)(d,{operationsVisibilty:t,breadcrumbItem:i,shareholders:a,selectedShareholder:s,onShareholderChange:o,onDelete:r,onAdd:n,popUpContent:c,shrVisible:h,handleBreadCrumbClick:u,addVisible:p,deleteVisible:m})}},62900:(e,t,i)=>{"use strict";i.d(t,{A:()=>S});var a=i(65043),s=i(67907),o=i(72711),r=i(72067),n=i(69062),l=i(97508),d=i(44192),c=i(40854),h=i.n(c),u=i(53536),p=i.n(u),m=i(86111),C=i.n(m),g=i(70579);class R extends a.Component{constructor(){super(...arguments),this.state={isPasswordRequired:!1,Password:"",validationErrors:n.Th(d.Qh),authenticationResponse:"",btnAuthenticateEnabled:!0},this.onFieldChange=(e,t)=>{this.setState({Password:t});const i=p().cloneDeep(this.state.validationErrors);void 0!==d.Qh[e]&&(i[e]=n.jr(d.Qh[e],t),this.setState({validationErrors:i,authenticationResponse:""}))},this.validatePassword=e=>{this.setState({btnAuthenticateEnabled:!1});const t={...this.state.validationErrors};null!==e&&""!==e||(t.Password="UserValidationForm_ReqfldValPassword"),this.setState({validationErrors:t});var i=!0;return i&&(i=Object.values(t).every((function(e){return""===e}))),i},this.onCloseClick=()=>{this.setState({isPasswordRequired:!1,authenticationResponse:"",btnAuthenticateEnabled:!0},(()=>this.props.handleClose()))},this.AuthenticateUser=()=>{if(this.validatePassword(this.state.Password)){this.setState({authenticationResponse:""});try{var e=this.state.Password,t=this.props.Username,i=C().lib.WordArray.random(16),a=C().PBKDF2(t,i,{keySize:8,iterations:100}),s=C().lib.WordArray.random(16),o=C().AES.encrypt(e,a,{iv:s,padding:C().pad.Pkcs7,mode:C().mode.CBC}),l=i.toString()+s.toString()+o.toString();h()(r.KrY+"?encryptedPassword="+encodeURIComponent(l),n.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess&&"true"===t.EntityResult.toLowerCase()?(this.setState({isPasswordRequired:!1}),this.props.handleOperation()):this.setState({authenticationResponse:t.ErrorList[0],btnAuthenticateEnabled:!0})})).catch((e=>{this.setState({authenticationResponse:e,btnAuthenticateEnabled:!0})}))}catch(d){this.setState({authenticationResponse:d,btnAuthenticateEnabled:!0})}}else this.setState({btnAuthenticateEnabled:!0})}}componentDidMount(){try{this.IsPasswordRequired()}catch(e){console.log("BaseProductDetailsComposite:Error occured on componentDidMount",e)}}IsPasswordRequired(){try{let e=n.Hp(this.props.userDetails.EntityResult.roleFunctionInfo,this.props.functionName,this.props.functionGroup);this.setState({isPasswordRequired:e}),!1===e&&this.props.handleOperation()}catch(e){console.log("Error in IsPasswordRequired method:",e)}}render(){return(0,g.jsx)("div",{children:!0===this.state.isPasswordRequired?(0,g.jsx)(s.TranslationConsumer,{children:e=>(0,g.jsxs)(o.Modal,{open:!0,size:"mini",children:[(0,g.jsxs)(o.Modal.Content,{children:[(0,g.jsxs)("div",{className:"row",children:[(0,g.jsx)("div",{className:"col col-lg-8",style:{marginLeft:"10px"},children:(0,g.jsx)("h4",{children:e("User_Authentication")})}),(0,g.jsx)("div",{className:"col-12 col-lg-3",style:{textAlign:"right"},onClick:this.onCloseClick,children:(0,g.jsx)(o.Icon,{root:"common",name:"close"})})]}),(0,g.jsxs)("div",{style:{display:"flex",flexWrap:"wrap"},children:[(0,g.jsx)("div",{className:"col col-lg-12",children:(0,g.jsx)("label",{children:(0,g.jsxs)("h5",{children:[e("UserValidation_Form_AccountName"),":",this.props.Username]})})}),(0,g.jsx)("div",{className:"col col-lg-12",children:(0,g.jsx)(o.Input,{fluid:!0,type:"password",disablePasswordToggle:!1,value:this.state.Password,indicator:"required",onChange:e=>this.onFieldChange("Password",e),label:e("AccessCardInfo_x_Pwd"),error:e(this.state.validationErrors.Password),reserveSpace:!1})})]})]}),(0,g.jsxs)(o.Modal.Footer,{children:[(0,g.jsx)("span",{className:"ui error-message autherrormsg",children:e(this.state.authenticationResponse)}),(0,g.jsx)(o.Button,{type:"primary",disabled:!this.state.btnAuthenticateEnabled,content:e("UserValidationForm_Authentication"),onClick:this.AuthenticateUser})]})]})}):null})}}const S=(0,l.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(R)},19380:(e,t,i)=>{"use strict";i.d(t,{A:()=>D});var a=i(65043),s=i(728),o=i(62672),r=i(27976),n=i(44063),l=i(39078),d=i(48546),c=i(82967),h=i(11201),u=i(43439),p=(i(60663),i(48385)),m=i(72711),C=i(67907),g=i(65187),R=i(53536),S=(i(90837),i(70579));const y=e=>{const[t,i]=(0,a.useState)(null),[y]=(0,C.useTranslation)(),T=t=>new s.CollectionView(e.sourceData,{pageSize:t}),[D,E]=(0,a.useState)(T(e.rowsPerPage)),A=a.createRef(),f=a.createRef(),v=a.createRef(),P=a.createRef(),b=a.useRef(),L=a.useRef(e.selectionRequired?[]:null);let x=null;const I=t=>{try{if(M(),e.onRowClick&&t.addEventListener(t.hostElement,"click",(i=>{let a=t.hitTest(i);if(a.target.closest(".wj-cell")&&![...a.target.closest(".wj-cell").classList].includes("wj-group")&&a.cellType===o.CellType.Cell){const i=t.rows[a.row].dataItem;e.onRowClick(i)}})),t.selectionMode=s.asEnum("None",o.SelectionMode),t.select(-1,-1),i(t),e.selectionRequired){x=new h.Selector(t,{itemChecked:(i,a)=>{e.singleSelection&&t.rows.filter((e=>e.isSelected&&1===L.current.filter((t=>R.isEqual(t,e.dataItem))).length)).forEach((e=>{e.isSelected=!1})),e.onSelectionHandle(t.rows.filter((e=>e.isSelected)).map((e=>e.dataItem)))},showCheckAll:!e.singleSelection});let i=x.column.grid;x.column=i.rowHeaders.columns[0],i.headersVisibility=o.HeadersVisibility.All,i.selectionMode=s.asEnum("None",o.SelectionMode)}}catch(a){console.log("Error in gridInitialized: "+a)}};(0,a.useEffect)((()=>{try{if(null!=A){let e=A.current.control;f.current.control.grid=e}E(T(e.rowsPerPage))}catch(t){console.log("Error in grid update:",t)}}),[e.sourceData]),(0,a.useEffect)((()=>{try{t&&e.selectionRequired&&(L.current.length=0,L.current.push(...e.selectedItems),t.rows.forEach((t=>{1===e.selectedItems.filter((e=>R.isEqual(e,t.dataItem))).length?t.isSelected=!0:t.isSelected=!1})),t.refresh())}catch(i){console.log("Error in pre-selecting rows:",i)}}),[e.selectedItems]),(0,a.useEffect)((()=>{try{if(localStorage.getItem(e.parentComponent+"GridState")&&"null"!==localStorage.getItem(e.parentComponent+"GridState")&&t){let a=JSON.parse(localStorage.getItem(e.parentComponent+"GridState")),o=t;o.columns.forEach((e=>{let t=a.columns.filter((t=>t.binding===e.binding));e.visible=t.length>0?t[0].visible:e.visible})),v.current.control.filterDefinition=a.filterDefinition,o.collectionView.deferUpdate((()=>{o.collectionView.sortDescriptions.clear();for(let e=0;e<a.sortDescriptions.length;e++){let t=a.sortDescriptions[e];o.collectionView.sortDescriptions.push(new s.SortDescription(t.property,t.ascending))}}));for(let e=0;e<a.groupDescriptions.length;e++)o.collectionView.groupDescriptions.push(new s.PropertyGroupDescription(a.groupDescriptions[e])),o.columns.filter((t=>t.binding===a.groupDescriptions[e]))[0].visible=!1;if(sessionStorage.getItem(e.parentComponent+"GridState")&&"null"!==sessionStorage.getItem(e.parentComponent+"GridState")){let t=JSON.parse(sessionStorage.getItem(e.parentComponent+"GridState"));o.collectionView.moveToPage(o.collectionView.pageCount-1>=t.pageIndex?t.pageIndex:o.collectionView.pageCount-1),f&&(f.current.control.text=t.searchText)}i(o),t.refresh()}}catch(a){console.log("Error in restoring local storage settings: ",a)}}),[D]),(0,a.useEffect)((()=>{try{t&&b.current&&e.columnPickerRequired&&(b.current.itemsSource=t.columns,b.current.checkedMemberPath="visible",b.current.displayMemberPath="header",b.current.lostFocus.addHandler((()=>{(0,s.hidePopup)(b.current.hostElement)})))}catch(i){console.log("Error in initializing column picker properties:",i)}}),[b.current]),(0,a.useEffect)((()=>()=>{e.columnPickerRequired&&b.current&&(0,s.hidePopup)(b.current.hostElement)}),[]);const w=()=>{try{let a=t;a.itemsSource.pageSize=e.sourceData.length,i(a),u.FlexGridXlsxConverter.saveAsync(t,{includeColumnHeaders:!0,includeCellStyles:!1,formatItem:null},e.exportFileName),a.itemsSource.pageSize=e.rowsPerPage,i(a)}catch(a){console.log("Error in export grid to excel:",a)}},N=(t,i)=>{if(void 0!==i&&null!==i){if("boolean"===typeof t||"Active"===i.Name)return t?(0,S.jsx)(m.Icon,{name:"check",size:"small",color:"green"}):(0,S.jsx)(m.Icon,{name:"close",size:"small",color:"red"});if(""===t||null===t||void 0===t)return t;if(("TerminalCodes"===i.Name||"1"===i.PopOver)&&null!==t)return(a=t).split(",").length>e.terminalsToShow?(0,S.jsx)(m.Popup,{className:"popup-theme-wrap",on:"hover",element:a.split(",").length,children:(0,S.jsx)(m.Card,{children:(0,S.jsx)(m.Card.Content,{children:a})})}):a;if(void 0!==i.DataType&&"DateTime"===i.DataType)return new Date(t).toLocaleDateString()+" "+new Date(t).toLocaleTimeString();if(void 0!==i.DataType&&"Date"===i.DataType)return new Date(t).toLocaleDateString();if(void 0!==i.DataType&&"Time"===i.DataType)return new Date(t).toLocaleTimeString()}var a;return t},j=()=>{try{if(t&&v.current){let i={columns:t.columns.map((e=>({binding:e.binding,visible:e.visible}))),filterDefinition:v.current.control.filterDefinition,sortDescriptions:t.collectionView.sortDescriptions.map((e=>({property:e.property,ascending:e.ascending}))),groupDescriptions:t.collectionView.groupDescriptions.map((e=>e.propertyName?e.propertyName:null))};if(t.collectionView.groupDescriptions&&t.collectionView.groupDescriptions.length>0){[...document.getElementsByClassName("wj-column-selector-group")].forEach((e=>{e.parentNode.parentNode.classList.add("wj-grouped-checkbox")}))}let a={pageIndex:t.collectionView.pageIndex,searchText:f.current.control.text};localStorage.setItem(e.parentComponent+"GridState",JSON.stringify(i)),sessionStorage.setItem(e.parentComponent+"GridState",JSON.stringify(a))}}catch(i){console.log("Error in saving grid state")}},M=()=>{let e=s.culture.FlexGridFilter,t=l.Operator;s.culture.FlexGridFilter.header=y("WijmoGridFilterHeader"),s.culture.FlexGridFilter.ascending="\u2191 "+y("WijmoGridFilterAscending"),s.culture.FlexGridFilter.descending="\u2193 "+y("WijmoGridFilterDescending"),s.culture.FlexGridFilter.apply=y("RoleAdminEdit_Apply"),s.culture.FlexGridFilter.clear=y("OrderCreate_btnClear"),s.culture.FlexGridFilter.conditions=y("WijmoGridFilterCondition"),s.culture.FlexGridFilter.values=y("WijmoGridFilterValue"),s.culture.FlexGridFilter.search=y("LoadingDetailsView_SearchGrid"),s.culture.FlexGridFilter.selectAll=y("WijmoGridFilterSelectAll"),s.culture.FlexGridFilter.and=y("WijmoGridFilterAnd"),s.culture.FlexGridFilter.or=y("WijmoGridFilterOr"),s.culture.FlexGridFilter.cancel=y("AccessCardInfo_Cancel"),e.stringOperators=[{name:y("WijmoGridFilterUnset"),op:null},{name:y("WijmoGridFilterEqual"),op:t.EQ},{name:y("WijmoGridFilterNotEqual"),op:t.NE},{name:y("WijmoGridFilterBeginsWith"),op:t.BW},{name:y("WijmoGridFilterEndsWith"),op:t.EW},{name:y("WijmoGridFilterContains"),op:t.CT},{name:y("WijmoGridFilterDoesNotContain"),op:t.NC}],e.numberOperators=[{name:y("WijmoGridFilterUnset"),op:null},{name:y("WijmoGridFilterEqual"),op:t.EQ},{name:y("WijmoGridFilterNotEqual"),op:t.NE},{name:y("WijmoGridFilterGreaterThan"),op:t.GT},{name:y("WijmoGridFilterLessThan"),op:t.LT},{name:y("WijmoGridFilterGreaterThanOrEqual"),op:t.GE},{name:y("WijmoGridFilterLessThanOrEqual"),op:t.LE}],e.dateOperators=[{name:y("WijmoGridFilterUnset"),op:null},{name:y("WijmoGridFilterEqual"),op:t.EQ},{name:y("WijmoGridFilterDateEarlierThan"),op:t.LT},{name:y("WijmoGridFilterDateLaterThan"),op:t.GT}],e.booleanOperators=[{name:y("WijmoGridFilterUnset"),op:null},{name:y("WijmoGridFilterEqual"),op:t.EQ},{name:y("WijmoGridFilterNotEqual"),op:t.NE}]},F=e=>{try{if(window.screen.width<1024&&e.WidthPx&&""!==e.WidthPx)return parseInt(e.WidthPx)}catch(t){console.log("Error in width:",t)}return e.WidthPercentage.includes("*")?e.WidthPercentage:parseInt(e.WidthPercentage)};return(0,S.jsx)("div",{className:"pl-1",children:(0,S.jsx)(g.A,{children:(0,S.jsx)(C.TranslationConsumer,{children:i=>(0,S.jsxs)(a.Fragment,{children:[(0,S.jsxs)("div",{className:"row pl-0",children:[(0,S.jsx)("div",{className:"col-10 col-sm-12 col-md-5 col-lg-6",children:(0,S.jsx)(d.q,{class:"ui single-input",ref:f,placeholder:i("LoadingDetailsView_SearchGrid")})}),(0,S.jsx)("div",{className:"col-10 col-sm-12 col-md-7 col-lg-6",children:(0,S.jsxs)("div",{style:{float:"right"},children:[e.columnPickerRequired?(0,S.jsxs)(m.Button,{id:"colPicker",actionType:"button",type:"primary",onClick:e=>(e=>{try{let i=b.current.hostElement;i.offsetHeight?((0,s.hidePopup)(i,!0,!0),t.focus()):((0,s.showPopup)(i,e.target,s.PopupPosition.Below,!0,!1),b.current.focus()),b.current.focus(),e.preventDefault()}catch(i){console.log("Error in Column Picker click event:",i)}})(e),children:[(0,S.jsx)("div",{style:{display:"inline-block"},children:i("WijmoGridColumnPicker")}),(0,S.jsx)("div",{style:{display:"inline-block"},children:(0,S.jsx)(m.Icon,{name:"caret-down",className:"btnIcon",size:"small"})})]}):null,e.exportRequired?(0,S.jsxs)(m.Button,{actionType:"button",type:"primary",className:"mt-3 mt-md-0",onClick:w,children:[(0,S.jsx)("div",{style:{display:"inline-block"},children:i("WijmoGridExport")}),(0,S.jsx)("div",{style:{display:"inline-block",marginLeft:"0.2rem"},children:(0,S.jsx)("span",{className:"icon-Xls",style:{fontSize:"17px",position:"absolute",top:"3px"}})})]}):null]})})]}),(0,S.jsxs)("div",{className:"tableScroll",children:[e.columnGroupingRequired?(0,S.jsx)(p.u,{className:"group-panel",grid:t,placeholder:i("WijmoGridGroupPanelPlaceholder")}):null,(0,S.jsx)(g.A,{children:(0,S.jsxs)(r.MC,{ref:A,autoGenerateColumns:!1,alternatingRowStep:0,autoRowHeights:!0,headersVisibility:"Column",itemsSource:D,selectionMode:s.asEnum("None",o.SelectionMode),initialized:I,virtualizationThreshold:[0,1e4],onUpdatedView:j,children:[(0,S.jsx)(n.M,{ref:v}),e.columns.map((t=>(0,S.jsx)(r.aK,{header:i(t.Name),binding:t.Name,width:F(t),minWidth:100,isReadOnly:!0,wordWrap:!0,align:"left",children:(0,S.jsx)(r.Gw,{cellType:"Cell",template:i=>(0,S.jsx)("span",{style:null!=e.conditionalRowStyleCheck&&e.conditionalRowStyleCheck(i.item)?{...e.conditionalRowStyles}:null,children:N(i.item[t.Name],t)})})},t.Name)))]})}),e.columnPickerRequired?(0,S.jsx)("div",{className:"column-picker-div",children:(0,S.jsx)(c.qF,{className:"column-picker",initialized:t=>(t=>{e.columnPickerRequired&&(b.current=t)})(t)})}):null]}),(0,S.jsx)("div",{className:"row",children:(0,S.jsx)(c.Ne,{ref:P,className:"ml-auto mr-auto mt-3",headerFormat:i("WijmoGridPagingTemplate"),byPage:!0,cv:D})})]})})})})};y.defaultProps={sourceData:[],columns:[],exportRequired:!0,exportFileName:"Grid.xlsx",selectionRequired:!1,columnPickerRequired:!1,columnGroupingRequired:!1,rowsPerPage:10,terminalsToShow:2,singleSelection:!1,selectedItems:[]};const T=y,D=e=>(0,S.jsx)(T,{sourceData:e.data,columns:e.columns,exportRequired:e.exportRequired,exportFileName:e.exportFileName,columnPickerRequired:e.columnPickerRequired,selectionRequired:e.selectionRequired,columnGroupingRequired:e.columnGroupingRequired,conditionalRowStyleCheck:e.conditionalRowStyleCheck,conditionalRowStyles:e.conditionalRowStyles,rowsPerPage:e.rowsPerPage,onSelectionHandle:e.onSelectionHandle,onRowClick:e.onRowClick,parentComponent:e.parentComponent,terminalsToShow:e.terminalsToShow,singleSelection:e.singleSelection,selectedItems:e.selectedItems})},88319:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>A});var a=i(65043),s=i(78374),o=i(67907),r=i(72711),n=i(40854),l=i.n(n),d=i(7523),c=i(72067),h=i(69062),u=i(50805),p=i(9966),m=i(97508),C=i(53536),g=i.n(C),R=i(93779),S=i(45127),y=i(728),T=i(15417),D=i(70579);y.setLicenseKey(d.yQ);class E extends a.Component{constructor(){super(...arguments),this.state={receiptViewAuditTrailData:[],modReceiptViewAuditTrailData:[],auditTrailAttributeMetaDataList:[],Attributes:[]},this.handlePrint=()=>{try{this.setState({openPrint:!0},(()=>{}))}catch(e){console.log("MarineReceiptViewAuditTrailDetailsComposite:Error occured on handlePrint",e)}}}getReceiptViewAuditTrail(e){if(void 0===e)return void this.setState({receiptViewAuditTrailData:[],modReceiptViewAuditTrailData:[]});let t=[{key:R.eT,value:e}];let i={ReceiptCode:e,TmWebApiRequest:{ShareHolderCode:this.props.shareholderCode,KeyCodes:t}};l()(c.Ivq,h.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({receiptViewAuditTrailData:g().cloneDeep(t.EntityResult),modReceiptViewAuditTrailData:g().cloneDeep(t.EntityResult)}):this.setState({receiptViewAuditTrailData:[],modReceiptViewAuditTrailData:[]});var i=g().cloneDeep(this.state.modReceiptViewAuditTrailData),a=g().cloneDeep(this.state.receiptViewAuditTrailData);for(let s=0;s<i.length;s++){let e=i[s].ReceiptStatus;e===d.a$.AUTO_UNLOADED?e=d.PH.AUTO_LOADED:e===d.a$.CHECKED_IN?e=d.PH.CHECKED_IN:e===d.a$.CLOSED?e=d.PH.CLOSED:e===d.a$.INTERRUPTED?e=d.PH.INTERRUPTED:e===d.a$.UNLOADING?e=d.PH.UNLOADING:e===d.a$.MANUALLY_UNLOADED?e=d.PH.MANUALLY_UNLOADED:e===d.a$.PARTIALLY_UNLOADED?e=d.PH.PARTIALLY_UNLOADED:e===d.a$.QUEUED?e=d.PH.QUEUED:e===d.a$.READY?e=d.PH.READY:e===d.a$.DE_QUEUED?e=d.PH.DE_QUEUED:e===d.a$.WEIGHED_IN?e=d.PH.WEIGHED_IN:e===d.a$.WEIGHED_OUT?e=d.PH.WEIGHED_OUT:e===d.a$.USER_DEFINED?e=d.PH.USER_DEFINED:e===d.a$.ASSIGNED?e=d.PH.ASSIGNED:e===d.a$.CANCELLED?e=d.PH.CANCELLED:e===d.a$.EXPIRED?e=d.PH.EXPIRED:e===d.a$.REJECTED&&(e=d.PH.REJECTED);let t=g().cloneDeep(this.state.auditTrailAttributeMetaDataList);for(let i=0;i<a.length;i++)a[i].AttributesforUI=this.formReadonlyCompAttributes(a[i].Attributes,t);let o=a.length>0?a[0].AttributesforUI:[];i[s].ReceiptStatus=e,i[s].UpdatedTime=new Date(i[s].UpdatedTime).toLocaleDateString()+" "+new Date(i[s].UpdatedTime).toLocaleTimeString(),this.setState({modReceiptViewAuditTrailData:i,Attributes:o,receiptViewAuditTrailData:a})}})).catch((e=>{console.log("Error while getting MarineReceiptViewAuditTrail:",e)}))}formReadonlyCompAttributes(e,t){let i=[];return null!==t&&void 0!==t&&t.length>0&&t.forEach((e=>{e.attributeMetaDataList.forEach((e=>{i.push({AttributeCode:e.Code,AttributeName:e.DisplayName?e.DisplayName:e.Code,AttributeValue:e.DefaultValue,TerminalCode:e.TerminalCode,IsMandatory:e.IsMandatory,DataType:e.DataType,IsReadonly:e.IsReadonly,MinValue:e.MinValue,MaxValue:e.MaxValue,ValidationFormat:e.ValidationFormat,compSequenceNo:""})}))})),null!==e&&void 0!==e&&e.length>0&&e.forEach((e=>{i.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.ListOfAttributeData.forEach((e=>{t.AttributeCode===e.AttributeCode&&(t.AttributeValue=e.AttributeValue)}))}))})),i}getAttributes(){try{l()(c.fKH,h.tW([T.ip],this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({auditTrailAttributeMetaDataList:g().cloneDeep(t.EntityResult.MARINEDISPATCHSTATUSTIME)},(()=>{this.getReceiptViewAuditTrail(this.props.selectedRow.Common_Code)})):console.log("Error in getAttributes:")}))}catch(e){console.log("Error while getAttributes:",e)}}componentDidMount(){try{this.getAttributes(),h.pJ(this.props.userDetails.EntityResult.IsArchived)}catch(e){console.log("RailReceiptViewAuditTrailDetailsComposite:Error occured on componentDidMount",e)}}printTable(){let e=window.document.getElementById("printTable").innerHTML;const t=window.document.createElement("IFRAME");let i=null;window.document.body.appendChild(t),i=t.contentWindow.document;const a=e.substring(0,e.indexOf("<table")+6),s=e.substring(e.indexOf("<table")+6,e.length);e=a+' border="1" cellspacing="0"'+s,e=e.replace('<tfoot class="p-datatable-tfoot">',""),e=e.replace('<tr><td class="compColHeight"></td><td class="compColHeight"></td><td class="compColHeight"></td><td class="compColHeight"></td><td class="compColHeight"></td><td class="compColHeight"></td></tr>',""),i.write(e),console.info(e),i.close(),t.contentWindow.focus(),t.contentWindow.print(),setTimeout((()=>{document.body.removeChild(t)}),2e3)}render(){const e=e=>0===e&&null!==e?d.PH.COMPLETED.toLocaleString():1===e&&null!==e?d.PH.EMPTY.toLocaleString():2===e&&null!==e?d.PH.FORCE_COMPLETED.toLocaleString():3===e&&null!==e?d.PH.INTERRUPTED.toLocaleString():4===e&&null!==e?d.PH.OVER_UNLOADED.toLocaleString():5===e&&null!==e?d.PH.PART_UNLOADED.toLocaleString():6===e&&null!==e?d.PH.UNLOAD_NOTSTARTED.toLocaleString():7===e&&null!==e?d.PH.UNLOADING.toLocaleString():e,t=e=>{const t=e.rowData.AttributesforUI.filter((t=>t.AttributeName===e.name))[0];return t.DataType.toLowerCase()===d.pe.STRING.toLowerCase()||t.DataType.toLowerCase()===d.pe.INT.toLowerCase()||t.DataType.toLowerCase()===d.pe.LONG.toLowerCase()||t.DataType.toLowerCase()===d.pe.FLOAT.toLowerCase()?(0,D.jsx)("label",{children:t.AttributeValue}):t.DataType.toLowerCase()===d.pe.BOOL.toLowerCase()?(0,D.jsx)(r.Checkbox,{checked:"true"===t.AttributeValue.toString().toLowerCase(),disabled:!0}):(0,D.jsx)("label",{children:new Date(t.AttributeValue).toLocaleDateString()})},i=(e,t)=>(t.cls=null,e.fontSize="7px",t.val===d.PH.AUTO_LOADED?t.text=d.a$.AUTO_LOADED:t.val===d.PH.CHECKED_IN?t.text=d.a$.CHECKED_IN:t.val===d.PH.CLOSED?t.text=d.a$.CLOSED:t.val===d.PH.INTERRUPTED?t.text=d.a$.INTERRUPTED:t.val===d.PH.UNLOADING?t.text=d.a$.UNLOADING:t.val===d.PH.MANUALLY_UNLOADED?t.text=d.a$.MANUALLY_UNLOADED:t.val===d.PH.PARTIALLY_UNLOADED?t.text=d.a$.PARTIALLY_UNLOADED:t.val===d.PH.QUEUED?t.text=d.a$.QUEUED:t.val===d.PH.READY?t.text=d.a$.READY:t.val===d.PH.DE_QUEUED?t.text=d.a$.DE_QUEUED:t.val===d.PH.WEIGHED_IN?t.text=d.a$.WEIGHED_IN:t.val===d.PH.WEIGHED_OUT?t.text=d.a$.WEIGHED_OUT:t.val===d.PH.USER_DEFINED?t.text=d.a$.USER_DEFINED:t.val===d.PH.ASSIGNED?t.text=d.a$.ASSIGNED:t.val===d.PH.CANCELLED?t.text=d.a$.CANCELLED:t.val===d.PH.EXPIRED?t.text=d.a$.EXPIRED:t.val===d.PH.REJECTED&&(t.text=d.a$.REJECTED),t);return(0,D.jsx)(o.TranslationConsumer,{children:a=>(0,D.jsxs)("div",{children:[(0,D.jsxs)(r.Modal,{onClose:()=>this.setState({openPrint:!1}),size:"large",open:this.state.openPrint,className:"marineModalPrint",closeOnDimmerClick:!1,children:[(0,D.jsx)(r.Modal.Content,{children:(0,D.jsxs)("div",{id:"printTable",children:[(0,D.jsx)("div",{className:"ViewAuditTrailDetailsPrint",children:(0,D.jsx)("b",{children:a("ViewAuditTrail_ViewAuditTrailForReceipt")+" : "+this.props.selectedRow.Common_Code})}),(0,D.jsx)("div",{className:"col-md-10 container-fluid",children:(0,D.jsxs)(S.IO,{itemsSource:this.state.modReceiptViewAuditTrailData,chartType:"Line",bindingX:"UpdatedTime",palette:["red"],style:{width:"100%",height:"450px"},children:[(0,D.jsx)(S.tN,{position:"Bottom"}),(0,D.jsx)(S.vc,{wjProperty:"axisY",majorUnit:1,max:16,min:0,itemFormatter:i,axisLine:!0}),(0,D.jsx)(S.t3,{binding:"ReceiptStatus",name:"ReceiptStatus"})]})}),(0,D.jsx)("div",{className:"col-12 detailsTable",children:(0,D.jsxs)(s.bQ,{data:this.state.receiptViewAuditTrailData,scrollable:!0,value:"",children:[(0,D.jsx)(s.bQ.Column,{className:"compColHeight",field:"ReceiptCode",header:a("Receipt_Code"),editable:!1,editFieldType:"text"},"ReceiptCode"),(0,D.jsx)(s.bQ.Column,{className:"compColHeight",field:"ReceiptStatus",header:a("ReceiptStatus"),editable:!1,renderer:t=>e(t.rowData.ReceiptStatus),editFieldType:"text"},"ReceiptStatus"),(0,D.jsx)(s.bQ.Column,{className:"compColHeight",field:"TrailerCode",header:a("Rail_Wagon_Code"),editable:!1,editFieldType:"text"},"TrailerCode"),(0,D.jsx)(s.bQ.Column,{className:"compColHeight",field:"CarrierCompanyCode",header:a("Carrier_Company_Code"),editable:!1,editFieldType:"text"},"CarrierCompanyCode"),(0,D.jsx)(s.bQ.Column,{className:"compColHeight",field:"ReceiptCompartmentStatus",renderer:e=>null===e.value?"":h.cd(d.vy,e.value),header:a("ReceiptCompartmentStatus"),editable:!1,editFieldType:"text"},"ReceiptCompartmentStatus"),(0,D.jsx)(s.bQ.Column,{className:"compColHeight",field:"UserPIN",header:a("PIN"),editable:!1,editFieldType:"text"},"UserPIN"),(0,D.jsx)(s.bQ.Column,{className:"compColHeight",field:"UpdatedTime",renderer:e=>new Date(e.value).toLocaleString(),header:a("SAAuditTrial_UpdatedTime"),editable:!1,editFieldType:"text"},"UpdatedTime"),(0,D.jsx)(s.bQ.Column,{className:"compColHeight",field:"OfficerName",header:a("ViewAuditTrail_OfficerName"),editable:!1,editFieldType:"text"},"OfficerName"),this.state.Attributes.map((e=>(0,D.jsx)(s.bQ.Column,{className:"compColHeight",header:a(e.AttributeName),editable:!1,renderer:t})))]})})]})}),(0,D.jsxs)(r.Modal.Footer,{children:[(0,D.jsx)(r.Button,{type:"primary",size:"small",content:a("EOD_Print"),onClick:()=>{this.printTable()}}),(0,D.jsx)(r.Button,{type:"primary",size:"small",content:a("MarineEOD_Close"),onClick:()=>{this.setState({openPrint:!1})}})]})]}),(0,D.jsxs)("div",{className:"detailsContainer",children:[(0,D.jsx)("div",{className:"row",children:(0,D.jsx)("div",{className:"col-12 ",children:(0,D.jsx)("h3",{children:a("ViewAuditTrail_ViewAuditTrailForReceipt")+" : "+this.props.selectedRow.Common_Code})})}),(0,D.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,D.jsx)("div",{className:"col-12 detailsTable container-fluid",children:(0,D.jsxs)(S.IO,{itemsSource:this.state.modReceiptViewAuditTrailData,chartType:"Line",bindingX:"UpdatedTime",palette:["red"],style:{width:"100%",minWidth:"800px",height:"450px"},children:[(0,D.jsx)(S.tN,{position:"Bottom"}),(0,D.jsx)(S.vc,{wjProperty:"axisY",majorUnit:1,max:16,min:0,itemFormatter:i,axisLine:!0}),(0,D.jsx)(S.t3,{binding:"ReceiptStatus",name:"ReceiptStatus"})]})})}),(0,D.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,D.jsx)("div",{className:"col-12 detailsTable",children:(0,D.jsxs)(s.bQ,{data:this.state.receiptViewAuditTrailData,scrollable:!0,value:"",children:[(0,D.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"ReceiptCode",header:a("Receipt_Code"),editable:!1,editFieldType:"text"},"ReceiptCode"),(0,D.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"ReceiptStatus",header:a("ReceiptStatus"),editable:!1,renderer:t=>e(t.rowData.ReceiptStatus),editFieldType:"text"},"ReceiptStatus"),(0,D.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"TrailerCode",header:a("Rail_Wagon_Code"),editable:!1,editFieldType:"text"},"TrailerCode"),(0,D.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"CarrierCompanyCode",header:a("Carrier_Company_Code"),editable:!1,editFieldType:"text"},"CarrierCompanyCode"),(0,D.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"ReceiptCompartmentStatus",renderer:e=>null===e.value?"":h.cd(d.vy,e.value),header:a("ReceiptCompartmentStatus"),editable:!1,editFieldType:"text"},"ReceiptCompartmentStatus"),(0,D.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"UserPIN",header:a("PIN"),editable:!1,editFieldType:"text"},"UserPIN"),(0,D.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"UpdatedTime",renderer:e=>new Date(e.value).toLocaleString(),header:a("SAAuditTrial_UpdatedTime"),editable:!1,editFieldType:"text"},"UpdatedTime"),(0,D.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"OfficerName",header:a("ViewAuditTrail_OfficerName"),editable:!1,editFieldType:"text"},"OfficerName"),this.state.Attributes.map((e=>(0,D.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",header:a(e.AttributeName),editable:!1,renderer:t})))]})})}),(0,D.jsxs)("div",{className:"row",children:[(0,D.jsx)("div",{className:"col-12 col-sm-6 col-lg-8",children:(0,D.jsx)(r.Button,{className:"backButton",onClick:this.props.handleBack,content:a("Back")})}),(0,D.jsx)("div",{className:"col-12 col-sm-6 col-lg-4",style:{textAlign:"right"},children:(0,D.jsx)(r.Button,{className:"printButton",onClick:this.handlePrint,content:a("ViewEAAuditTrail_PrintAuditTrail")})})]})]})]})})}}const A=(0,m.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})),(e=>({userActions:(0,u.zH)(p,e)})))(E)},24649:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>X});var a=i(65043),s=i(66554),o=i(19380),r=i(70579);function n(e){let{tableData:t,columnDetails:i,pageSize:a,exportRequired:s,exportFileName:n,columnPickerRequired:l,columnGroupingRequired:d,selectionRequired:c,terminalsToShow:h,selectedItems:u,onSelectionChange:p,onRowClick:m,parentComponent:C}=e;return(0,r.jsx)(o.A,{data:t,columns:i,rowsPerPage:a,exportRequired:s,exportFileName:n,columnPickerRequired:l,columnGroupingRequired:d,selectionRequired:c,selectedItems:u,onSelectionHandle:p,onRowClick:m,parentComponent:C,terminalsToShow:h})}var l=i(66444),d=i(67907),c=i(72711),h=i(46100),u=i(69062),p=i(65187),m=i(85800),C=i(35861);function g(e){let{modLoadingDataInfo:t,IsManEntryEnabled:i,listOptions:a,validationErrors:s,onFieldChange:o,onTankSearchChange:n,onMeterSearchChange:l,onTabChange:h,tabActiveIndex:u,isEnterpriseNode:g,selectedFPAttributeList:R,selectedBPAttributeList:S,selectedAddAttributeList:y,handleAttributeCellDataEdit:T,attributeAddValidationErrors:D,attributeBPValidationErrors:E,attributeFPValidationErrors:A,onDateTextChange:f}=e;const[v]=(0,d.useTranslation)(),P=(e,t)=>{let i=[];return i=e.find((e=>e.TerminalCode===t)),i.attributeValidationErrors},b=(e,i,d)=>{let h,u;return i?(h=v("BaseProductInfo_Additive")+" - "+t.ArrTransactionAdditive[e].AdditiveProductCode+" ("+v("BPCode")+" - "+t.ArrTransactionAdditive[e].BaseProductCode+")",u="ArrTransactionAdditive"):(h=v("BPCode")+" - "+t.ArrTransactionBP[e].BaseProductCode,u="ArrTransactionBP"),(0,r.jsxs)(c.Tab.Pane,{title:h,children:[(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,indicator:"required",value:t[u][e].GrossQuantity,label:v("GrossQuantity"),onChange:t=>o("GrossQuantity",t,{type:u,index:e}),error:v(s.product[d].GrossQuantity),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t[u][e].NetQuantity,label:v("NetQuantity"),onChange:t=>o("NetQuantity",t,{type:u,index:e}),error:v(s.product[d].NetQuantity),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t[u][e].Temperature,label:v("Temperature"),onChange:t=>o("Temperature",t,{type:u,index:e}),error:v(s.product[d].Temperature),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Select,{fluid:!0,placeholder:v("Common_Select"),label:v("MarineDispatchManualEntry_TemperatureUOM"),value:t[u][e].TemperatureUOM,options:a.temperatureUOMs,onChange:t=>o("TemperatureUOM",t,{type:u,index:e}),reserveSpace:!1,noResultsMessage:v("noResultsMessage")})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t[u][e].ProductDensity,label:v("Density"),onChange:t=>o("ProductDensity",t,{type:u,index:e}),error:v(s.product[d].ProductDensity),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Select,{fluid:!0,placeholder:v("Common_Select"),label:v("BCU_DensityUOM"),value:t[u][e].ProductDensityUOM,options:a.densityUOMs,onChange:t=>o("ProductDensityUOM",t,{type:u,index:e}),reserveSpace:!1,noResultsMessage:v("noResultsMessage")})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Select,{fluid:!0,placeholder:v("Common_Select"),label:v("MeterCode"),value:t[u][e].MeterCode,options:(0,C.r4)(a.meterCodes,v("Common_Select")),onChange:t=>o("MeterCode",t,{type:u,index:e}),search:!0,reserveSpace:!1,noResultsMessage:v("noResultsMessage"),onSearch:l})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Select,{fluid:!0,placeholder:v("Common_Select"),label:v("TankCode"),value:t[u][e].TankCode,options:(0,C.r4)(a.tankCodes,v("Common_Select")),onChange:t=>o("TankCode",t,{type:u,index:e}),search:!0,reserveSpace:!1,noResultsMessage:v("noResultsMessage"),onSearch:n})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t[u][e].StartTotalizer,label:v("StartTotalizer"),onChange:t=>o("StartTotalizer",t,{type:u,index:e}),error:v(s.product[d].StartTotalizer),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t[u][e].EndTotalizer,label:v("EndTotalizer"),onChange:t=>o("EndTotalizer",t,{type:u,index:e}),error:v(s.product[d].EndTotalizer),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t[u][e].NetStartTotalizer,label:v("MarineReceiptManualEntry_NetStartTotalizer"),onChange:t=>o("NetStartTotalizer",t,{type:u,index:e}),error:v(s.product[d].NetStartTotalizer),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t[u][e].NetEndTotalizer,label:v("MarineReceiptManualEntry_NetEndTotalizer"),onChange:t=>o("NetEndTotalizer",t,{type:u,index:e}),error:v(s.product[d].NetEndTotalizer),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t[u][e].CalculatedGross,label:v("LoadingDetailsEntry_CalculatedGross"),onChange:t=>o("CalculatedGross",t,{type:u,index:e}),error:v(s.product[d].CalculatedGross),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t[u][e].CalculatedNet,label:v("LoadingDetailsEntry_CalculatedNet"),onChange:t=>o("CalculatedNet",t,{type:u,index:e}),error:v(s.product[d].CalculatedNet),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Select,{fluid:!0,placeholder:v("Common_Select"),label:v("LoadingDetails_CalculatedValueUOM"),value:t[u][e].CalculatedValueUOM,multiple:!1,options:a.quantityUOMs,onChange:t=>o("CalculatedValueUOM",t,{type:u,index:e}),reserveSpace:!1,noResultsMessage:v("noResultsMessage")})})]}),i?(0,r.jsx)(r.Fragment,{children:y.length>0&&y[e].length>0?y[e].map((t=>(0,r.jsx)(p.A,{children:(0,r.jsx)(c.Accordion,{children:(0,r.jsx)(c.Accordion.Content,{className:"attributeAccordian",title:g?t.TerminalCode+" - "+v("Attributes_Header"):v("Attributes_Header"),children:(0,r.jsx)(m.n,{selectedAttributeList:t.attributeMetaDataList,handleCellDataEdit:(t,i)=>T(t,i,{type:u,index:e}),attributeValidationErrors:P(D,t.TerminalCode)})})})}))):null}):(0,r.jsx)(r.Fragment,{children:S.length>0&&S[e].length>0?S[e].map((t=>(0,r.jsx)(p.A,{children:(0,r.jsx)(c.Accordion,{children:(0,r.jsx)(c.Accordion.Content,{className:"attributeAccordian",title:g?t.TerminalCode+" - "+v("Attributes_Header"):v("Attributes_Header"),children:(0,r.jsx)(m.n,{selectedAttributeList:t.attributeMetaDataList,handleCellDataEdit:(t,i)=>T(t,i,{type:u,index:e}),attributeValidationErrors:P(E,t.TerminalCode)})})})}))):null})]})},L=[];let x=1;for(let r=0;r<t.ArrTransactionBP.length;r++)L.push(b(r,!1,x)),x+=1;for(let r=0;r<t.ArrTransactionAdditive.length;r++)L.push(b(r,!0,x)),x+=1;return(0,r.jsx)(d.TranslationConsumer,{children:e=>(0,r.jsxs)("div",{className:"detailsContainer",children:[(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t.CommonInfo.ReceiptCode,disabled:!0,label:e("Receipt_Code"),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t.CommonInfo.CarrierCode,disabled:!0,label:e("Entity_Carrier_Code"),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Select,{fluid:!0,indicator:"required",disabled:i,placeholder:e("Common_Select"),label:e("Rail_Receipt_Wagon"),value:t.CommonInfo.TrailerCode,options:a.wagonCodes,onChange:e=>o("TrailerCode",e),reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Select,{fluid:!0,indicator:"required",placeholder:e("Common_Select"),label:e("RailDispatchManualEntry_Cluster"),value:t.CommonInfo.BayCode,onChange:e=>o("BayCode",e),options:a.clusterCodes,error:e(s.bayCode),reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("BCU_Code"),value:t.CommonInfo.BCUCode,onChange:e=>o("BCUCode",e),options:a.BCUCodes,reserveSpace:!1,indicator:"required",error:e(s.BCUCode),noResultsMessage:e("noResultsMessage")})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("UnloadingDetailsEntry_LoadingArm"),value:t.TransactionFPinfo.ArmCode,onChange:e=>o("ArmCode",e,{type:"TransactionFPinfo"}),options:a.loadingArmCodes,reserveSpace:!1,indicator:"required",error:e(s.LoadingArm),noResultsMessage:e("noResultsMessage")})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t.TransactionFPinfo.FinishedProductCode,label:e("RailDispatchManualEntry_FinishedProduct"),reserveSpace:!1,disabled:i})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t.TransactionFPinfo.TransactionID,label:e("UnloadingDetailsEntry_TransactionNo"),onChange:e=>o("TransactionID",e,{type:"TransactionFPinfo"}),error:e(s.common.TransactionID),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.DatePicker,{fluid:!0,value:t.TransactionFPinfo.StartTime,label:e("LoadingDetailsEntry_loadStartTime"),onChange:e=>o("StartTime",e,{type:"TransactionFPinfo"}),type:"datetime",disablePast:!1,disableFuture:!0,indicator:"required",reserveSpace:!1,minuteStep:5,showYearSelector:!0,displayFormat:(0,C.F1)(),onTextChange:(e,t)=>{f("StartTime",e,t)},error:e(s.common.StartTime)})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.DatePicker,{fluid:!0,value:t.TransactionFPinfo.EndTime,label:e("LoadingDetailsEntry_loadEndTime"),onChange:e=>o("EndTime",e,{type:"TransactionFPinfo"}),type:"datetime",disablePast:!1,disableFuture:!0,indicator:"required",reserveSpace:!1,minuteStep:5,showYearSelector:!0,onTextChange:(e,t)=>{f("EndTime",e,t)},error:e(s.common.EndTime)})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("LoadingDetailsEntry_QuantityUOM"),value:t.TransactionFPinfo.QuantityUOM,multiple:!1,indicator:"required",options:a.quantityUOMs,reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t.TransactionFPinfo.Remarks,label:e("LoadingDetails_Remarks"),onChange:e=>o("Remarks",e,{type:"TransactionFPinfo"}),error:e(s.Remarks),reserveSpace:!1})})]}),(0,r.jsx)("div",{className:"shipmentTabAlignment",children:(0,r.jsxs)(c.Tab,{activeIndex:u,onTabChange:h,children:[(0,r.jsxs)(c.Tab.Pane,{title:""===t.TransactionFPinfo.FinishedProductCode?e("FinishedProduct"):e("FinishedProduct")+"-"+t.TransactionFPinfo.FinishedProductCode,children:[(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,indicator:"required",value:t.TransactionFPinfo.GrossQuantity,label:e("Reconciliation_Quantity"),onChange:e=>o("GrossQuantity",e,{type:"TransactionFPinfo"}),error:e(s.product[0].GrossQuantity),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t.TransactionFPinfo.NetQuantity,label:e("NetQuantity"),onChange:e=>o("NetQuantity",e,{type:"TransactionFPinfo"}),error:e(s.product[0].NetQuantity),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t.TransactionFPinfo.Temperature,label:e("LoadingDetails_Temperature"),onChange:e=>o("Temperature",e,{type:"TransactionFPinfo"}),error:e(s.product[0].Temperature),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("BCU_TemperatureUOM"),value:t.TransactionFPinfo.TemperatureUOM,options:a.temperatureUOMs,onChange:e=>o("TemperatureUOM",e,{type:"TransactionFPinfo"}),reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t.TransactionFPinfo.ProductDensity,label:e("BaseProductInfo_Density"),onChange:e=>o("ProductDensity",e,{type:"TransactionFPinfo"}),error:e(s.product[0].ProductDensity),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("Reconciliation_DensityUOM"),value:t.TransactionFPinfo.ProductDensityUOM,options:a.densityUOMs,onChange:e=>o("ProductDensityUOM",e,{type:"TransactionFPinfo"}),reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("MeterCode"),value:t.TransactionFPinfo.MeterCode,options:(0,C.r4)(a.meterCodes,e("Common_Select")),onChange:e=>o("MeterCode",e,{type:"TransactionFPinfo"}),search:!0,reserveSpace:!1,noResultsMessage:e("noResultsMessage"),onSearch:l})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("TankCode"),value:t.TransactionFPinfo.TankCode,options:(0,C.r4)(a.tankCodes,e("Common_Select")),onChange:e=>o("TankCode",e,{type:"TransactionFPinfo"}),search:!0,reserveSpace:!1,noResultsMessage:e("noResultsMessage"),onSearch:n})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t.TransactionFPinfo.StartTotalizer,onChange:e=>o("StartTotalizer",e,{type:"TransactionFPinfo"}),error:e(s.product[0].StartTotalizer),label:e("StartTotalizer"),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t.TransactionFPinfo.EndTotalizer,label:e("EndTotalizer"),onChange:e=>o("EndTotalizer",e,{type:"TransactionFPinfo"}),error:e(s.product[0].EndTotalizer),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t.TransactionFPinfo.NetStartTotalizer,label:e("ViewRailLoadingDetails_netstarttotalizer"),onChange:e=>o("NetStartTotalizer",e,{type:"TransactionFPinfo"}),error:e(s.product[0].NetStartTotalizer),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t.TransactionFPinfo.NetEndTotalizer,label:e("ViewRailLoadingDetails_netendtotalizer"),onChange:e=>o("NetEndTotalizer",e,{type:"TransactionFPinfo"}),error:e(s.product[0].NetEndTotalizer),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t.TransactionFPinfo.CalculatedGross,label:e("LoadingDetails_CalculatedGross"),onChange:e=>o("CalculatedGross",e,{type:"TransactionFPinfo"}),error:e(s.product[0].CalculatedGross),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,value:t.TransactionFPinfo.CalculatedNet,label:e("LoadingDetails_CalculatedNet"),onChange:e=>o("CalculatedNet",e,{type:"TransactionFPinfo"}),error:e(s.product[0].CalculatedNet),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("LoadingDetails_CalculatedValueUOM"),value:t.TransactionFPinfo.CalculatedValueUOM,options:a.quantityUOMs,onChange:e=>o("CalculatedValueUOM",e,{type:"TransactionFPinfo"}),reserveSpace:!1,noResultsMessage:e("noResultsMessage")})})]}),R.length>0?R.map((t=>(0,r.jsx)(p.A,{children:(0,r.jsx)(c.Accordion,{children:(0,r.jsx)(c.Accordion.Content,{className:"attributeAccordian",title:g?t.TerminalCode+" - "+e("Attributes_Header"):e("Attributes_Header"),children:(0,r.jsx)(m.n,{selectedAttributeList:t.attributeMetaDataList,handleCellDataEdit:(e,t)=>T(e,t,{type:"TransactionFPinfo",index:0}),attributeValidationErrors:P(A,t.TerminalCode)})})})}))):null]}),L]})})]})})}var R=i(72067),S=i(9256),y=i(40854),T=i.n(y),D=i(7523),E=i(9966),A=i(50805),f=i(97508),v=(i(38726),i(93779)),P=i(53536),b=i.n(P),L=i(40252),x=i(44192),I=i(15417),w=i(80312),N=i(62900);class j extends a.Component{constructor(){var e;super(...arguments),e=this,this.state={loadingDataInfo:{},modLoadingDataInfo:{},tabActiveIndex:0,manualEntryTabActiveIndex:0,SaveEnabled:!0,railReceipt:{},modRailReceipt:{},modRailWagon:{},modWagonDetails:[],modRailReceiptCompartmentPlanList:[],isReadyToRender:!1,shareholders:this.getShareholders(),selectedWagonRow:[],manualEntryValidationDict:{},selectedShareholder:"",clusterCodeOptions:[],clusterBCUOptions:[],BCUCodeOptions:[],loadingArmCodeOptions:[],loadingArmCodes:[],quantityUOMOptions:[],densityUOMOptions:[],temperatureUOMOptions:[],meterCodeOptions:[],meterCodeSearchOptions:[],tankCodeOptions:[],tankCodeSearchOptions:[],wagonCodeOptions:[],openManualEntryWarn:!1,IsManEntryEnabled:!1,isEnterpriseNode:!1,loadingArmCodeList:[],attributeMetaDataList:[],attributeFPMetaDataList:[],attributeBPMetaDataList:[],attributeAddMetaDataList:[],selectedFPAttributeList:[],selectedBPAttributeList:[],selectedAddAttributeList:[],attributeAddValidationErrors:[],attributeFPValidationErrors:[],attributeBPValidationErrors:[],showAuthenticationLayout:!1,tempUnLoadingDetails:{}},this.handleshareholderChange=e=>{try{this.getTerminalsList(e)}catch(t){console.log("RailReceiptManualEntryComposite:Error occured on handleshareholderChange",t)}},this.handleCompartmentManualEntryChange=function(t,i){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{if("TrailerCode"===t)return void e.preprocessManualEntryData(i);const s=b().cloneDeep(e.state.modLoadingDataInfo),o=b().cloneDeep(e.state.clusterBCUOptions);void 0!==a.type?void 0!==a.index?s[a.type][a.index][t]=i:s[a.type][t]=i:s.CommonInfo[t]=i;let r=!1;if("BayCode"===t){let t=u.Zj(o[i]);e.setState({BCUCodeOptions:u.Zj(o[i])}),1===t.length&&(r=!0,s.CommonInfo.BCUCode=o[i][0],e.getDefaultUOMs(s.CommonInfo.BCUCode))}else"BCUCode"===t&&(r=!0,e.getDefaultUOMs(s.CommonInfo.BCUCode));e.setState({modLoadingDataInfo:s}),r&&e.getLoadingArms(s.CommonInfo.BCUCode,(t=>{const i=[];if(Array.isArray(t)){for(let e of t)i.push(e);1===i.length&&(s.TransactionFPinfo.ArmCode=i[0],e.GetMetersForLA(s.CommonInfo.BCUCode,i[0]),e.setState({modLoadingDataInfo:s,loadingArmCodeOptions:u.Zj(i)}))}e.setState({loadingArmCodeOptions:u.Zj(i)})}))}catch(s){console.log("RailReceiptDetailsComposite: Error occurred on handleCompartmentManualEntryChange",s)}},this.handleCompartmentManualEntryReset=()=>{try{const e=b().cloneDeep(this.state.loadingDataInfo);this.setState({modLoadingDataInfo:e,manualEntryValidationDict:this.initialManualEntryValidationErrors(e)}),console.log("handleCompartmentManualEntryReset")}catch(e){console.log("RailReceiptDetailsComposite:Error occurred on handleReset",e)}},this.handleCompartmentManualEntrySave=()=>{try{let e=this.fillDetails(),t=[];this.state.selectedFPAttributeList.length>0&&(t=u.pI(this.state.selectedFPAttributeList));let i=[];this.state.selectedBPAttributeList.length>0&&this.state.selectedBPAttributeList.forEach((e=>{e=u.pI(e),i.push(e)}));let a=[];if(this.state.selectedAddAttributeList.length>0&&this.state.selectedAddAttributeList.forEach((e=>{e=u.pI(e),a.push(e)})),this.validateManualEntry(e,t,i,a)){e=this.fillAttributeDetails(e,t,i,a),e.TransactionFPinfo.GrossQuantity=u.bo(e.TransactionFPinfo.GrossQuantity),e.TransactionFPinfo.NetQuantity=u.bo(e.TransactionFPinfo.NetQuantity),e.TransactionFPinfo.Temperature=u.bo(e.TransactionFPinfo.Temperature),e.TransactionFPinfo.ProductDensity=u.bo(e.TransactionFPinfo.ProductDensity),e.TransactionFPinfo.StartTotalizer=u.bo(e.TransactionFPinfo.StartTotalizer),e.TransactionFPinfo.EndTotalizer=u.bo(e.TransactionFPinfo.EndTotalizer),e.TransactionFPinfo.NetStartTotalizer=u.bo(e.TransactionFPinfo.NetStartTotalizer),e.TransactionFPinfo.NetEndTotalizer=u.bo(e.TransactionFPinfo.NetEndTotalizer),e.TransactionFPinfo.CalculatedGross=u.bo(e.TransactionFPinfo.CalculatedGross),e.TransactionFPinfo.CalculatedNet=u.bo(e.TransactionFPinfo.CalculatedNet);for(let t in e.ArrTransactionBP)e.ArrTransactionBP[t].StartTime=e.TransactionFPinfo.StartTime,e.ArrTransactionBP[t].EndTime=e.TransactionFPinfo.EndTime,e.ArrTransactionBP[t].ArmCode=e.TransactionFPinfo.ArmCode,e.ArrTransactionBP[t].QuantityUOM=e.TransactionFPinfo.QuantityUOM,e.ArrTransactionBP[t].TransactionID=e.TransactionFPinfo.TransactionID,e.ArrTransactionBP[t].FinishedProductCode=e.TransactionFPinfo.FinishedProductCode,e.ArrTransactionBP[t].GrossQuantity=u.bo(e.ArrTransactionBP[t].GrossQuantity),e.ArrTransactionBP[t].NetQuantity=u.bo(e.ArrTransactionBP[t].NetQuantity),e.ArrTransactionBP[t].Temperature=u.bo(e.ArrTransactionBP[t].Temperature),e.ArrTransactionBP[t].ProductDensity=u.bo(e.ArrTransactionBP[t].ProductDensity),e.ArrTransactionBP[t].StartTotalizer=u.bo(e.ArrTransactionBP[t].StartTotalizer),e.ArrTransactionBP[t].EndTotalizer=u.bo(e.ArrTransactionBP[t].EndTotalizer),e.ArrTransactionBP[t].NetStartTotalizer=u.bo(e.ArrTransactionBP[t].NetStartTotalizer),e.ArrTransactionBP[t].NetEndTotalizer=u.bo(e.ArrTransactionBP[t].NetEndTotalizer),e.ArrTransactionBP[t].CalculatedGross=u.bo(e.ArrTransactionBP[t].CalculatedGross),e.ArrTransactionBP[t].CalculatedNet=u.bo(e.ArrTransactionBP[t].CalculatedNet);for(let t in e.ArrTransactionAdditive)e.ArrTransactionAdditive[t].StartTime=e.TransactionFPinfo.StartTime,e.ArrTransactionAdditive[t].EndTime=e.TransactionFPinfo.EndTime,e.ArrTransactionAdditive[t].ArmCode=e.TransactionFPinfo.ArmCode,e.ArrTransactionAdditive[t].QuantityUOM=e.TransactionFPinfo.QuantityUOM,e.ArrTransactionAdditive[t].TransactionID=e.TransactionFPinfo.TransactionID,e.ArrTransactionAdditive[t].FinishedProductCode=e.TransactionFPinfo.FinishedProductCode,e.ArrTransactionAdditive[t].GrossQuantity=u.bo(e.ArrTransactionAdditive[t].GrossQuantity),e.ArrTransactionAdditive[t].NetQuantity=u.bo(e.ArrTransactionAdditive[t].NetQuantity),e.ArrTransactionAdditive[t].Temperature=u.bo(e.ArrTransactionAdditive[t].Temperature),e.ArrTransactionAdditive[t].ProductDensity=u.bo(e.ArrTransactionAdditive[t].ProductDensity),e.ArrTransactionAdditive[t].StartTotalizer=u.bo(e.ArrTransactionAdditive[t].StartTotalizer),e.ArrTransactionAdditive[t].EndTotalizer=u.bo(e.ArrTransactionAdditive[t].EndTotalizer),e.ArrTransactionAdditive[t].NetStartTotalizer=u.bo(e.ArrTransactionAdditive[t].NetStartTotalizer),e.ArrTransactionAdditive[t].NetEndTotalizer=u.bo(e.ArrTransactionAdditive[t].NetEndTotalizer),e.ArrTransactionAdditive[t].CalculatedGross=u.bo(e.ArrTransactionAdditive[t].CalculatedGross),e.ArrTransactionAdditive[t].CalculatedNet=u.bo(e.ArrTransactionAdditive[t].CalculatedNet);let s=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,o=b().cloneDeep(e);this.setState({showAuthenticationLayout:s,tempUnLoadingDetails:o},(()=>{!1===s&&this.saveManualEntry()}))}else this.setState({SaveEnabled:!0})}catch(e){console.log("RailReceiptDetailsComposite:Error occurred on handleSave",e)}},this.saveManualEntry=()=>{this.handleAuthenticationClose(),this.setState({SaveEnabled:!1});let e=b().cloneDeep(this.state.tempUnLoadingDetails);const t=[{key:v.eT,value:e.CommonInfo.ReceiptCode}],i={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:v.eT,KeyCodes:t,Entity:[e]},a={messageType:"critical",message:"ViewRailReceiptManualEntry_status",messageResultDetails:[{keyFields:["ViewRailReceiptDetails_ReceiptCode"],keyValues:[e.CommonInfo.ReceiptCode],isSuccess:!1,errorMessage:""}]};T()(R.LyZ,u.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;a.messageType=t.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.setState({SaveEnabled:!0}):(this.setState({SaveEnabled:!0}),a.messageResultDetails[0].errorMessage=t.ErrorList[0]),this.props.onSaved(this.state.modRailReceipt,"update",a)})).catch((t=>{this.setState({SaveEnabled:!0}),a.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"modify",a)}))},this.handleTankSearchChange=e=>{try{let t=this.state.tankCodeOptions.filter((t=>t.value.toLowerCase().includes(e.toLowerCase())));t.length>D.bM&&(t=t.slice(0,D.bM)),this.setState({tankCodeSearchOptions:t})}catch(t){console.log("LeakageManualEntryDetailsComposite: Error occurred on handleRouteSearchChange",t)}},this.handleMeterSearchChange=e=>{try{let t=this.state.meterCodeOptions.filter((t=>t.value.toLowerCase().includes(e.toLowerCase())));t.length>D.bM&&(t=t.slice(0,D.bM)),this.setState({meterCodeSearchOptions:t})}catch(t){console.log("LeakageManualEntryDetailsComposite: Error occurred on handleMeterSearchChange",t)}},this.handleManualEntryTabChange=e=>{try{this.setState({manualEntryTabActiveIndex:e})}catch(t){console.log("RailReceiptDetailsComposite: Error occurred on handleManualEntryTabChange",t)}},this.handleAttributeCellDataEdit=function(t,i){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{if(t.DefaultValue=i,"TransactionFPinfo"===a.type){const a=b().cloneDeep(e.state.attributeFPValidationErrors);a.forEach((e=>{e.TerminalCode===t.TerminalCode&&(e.attributeValidationErrors[t.Code]=u.I5(t,i))})),e.setState({attributeFPValidationErrors:a})}else if("ArrTransactionBP"===a.type){const a=b().cloneDeep(e.state.attributeBPValidationErrors);a.forEach((e=>{e.TerminalCode===t.TerminalCode&&(e.attributeValidationErrors[t.Code]=u.I5(t,i))})),e.setState({attributeBPValidationErrors:a})}else{const a=b().cloneDeep(e.state.attributeAddValidationErrors);a.forEach((e=>{e.TerminalCode===t.TerminalCode&&(e.attributeValidationErrors[t.Code]=u.I5(t,i))})),e.setState({attributeAddValidationErrors:a})}}catch(s){console.log("RailReceiptManualEntryDetailsComposite:Error occured on handleAttributeCellDataEdit",s)}},this.handleDateTextChange=(e,t,i)=>{try{var a=b().cloneDeep(this.state.manualEntryValidationDict),s=b().cloneDeep(this.state.modLoadingDataInfo);a.common[e]=i,s.TransactionFPinfo[e]=t,this.setState({manualEntryValidationDict:a,modLoadingDataInfo:s})}catch(i){console.log("TruckShipmentManualEntryDetailsComposite:Error occured on handleDateTextChange",i)}},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentWillReceiveProps(e){try{void 0===e.selectedWagonRow.TrailerCode&&this.getRailWagon(e.selectedWagonRow),this.getRailReceipt(e.selectedRow)}catch(t){console.log("RailReceiptManualEntryComposite:Error occured on componentWillReceiveProps",t)}}getFinishedProductCodes(){T()(R.Ypw+"?ShareholderCode=&TransportationType="+D.LY.RAIL,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){const e=t.EntityResult;this.setState({finishedProductOptions:e})}}else console.log("Error in GetFinishedProductCodes:",t.ErrorList)})).catch((e=>{console.log("Error while GetFinishedProductCodes List:",e)}))}componentDidMount(){try{u.pJ(this.props.userDetails.EntityResult.IsArchived),this.getUOMs(),this.getTankCode(this.props.selectedShareholder),this.getMeterCode(),this.getRailReceipt(this.props.selectedRow),this.getRailBayAndBcuList()}catch(e){console.log("RailReceiptManualEntryComposite:Error occured on componentDidMount",e)}}getTankCode(e){T()(R.Ibp+"?ShareholderCode="+e,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){const e=u.Zj(t.EntityResult);let i=b().cloneDeep(e);i.length>D.bM&&(i=i.slice(0,D.bM)),this.setState({tankCodeOptions:e,tankCodeSearchOptions:i})}}else console.log("Error in getTankCode:",t.ErrorList)})).catch((e=>{console.log("Error in getTankCode:",e)}))}getMeterCode(){T()(R.ndF,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){const e=u.Zj(t.EntityResult);let i=b().cloneDeep(e);i.length>D.bM&&(i=i.slice(0,D.bM)),this.setState({meterCodeOptions:e,meterCodeSearchOptions:i})}}else console.log("Error in getMeterCode:",t.ErrorList)})).catch((e=>{console.log("Error in getMeterCode:",e)}))}getRailBayAndBcuList(){T()(R.mGx,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){const e={},i=[];if(Array.isArray(t.EntityResult.Table)&&t.EntityResult.Table.length>0)for(let a of t.EntityResult.Table)e[a.Code]=[],i.push(a.Code);if(Array.isArray(t.EntityResult.Table1)&&t.EntityResult.Table1.length>0)for(let a of t.EntityResult.Table1)void 0!==e[a.locationCode]&&e[a.locationCode].push(a.Code);this.setState({clusterBCUOptions:e,clusterCodeOptions:u.Zj(i)})}else console.log("Error in getRailBayAndBcuList:",t.ErrorList)})).catch((e=>{console.log("Error in getRailBayAndBcuList:",e)}))}getLoadingArms(e,t){T()(R.W$W+"?bcuCode="+e,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const i=e.data;!0===i.IsSuccess?t(i.EntityResult):console.log("Error in getLoadingArms:",i.ErrorList)})).catch((e=>{console.log("Error in getLoadingArms:",e)}))}getRailReceipt(e){var t=this.getTransportationType();h.cE.TransportationType=t;const i={CommonInfo:b().cloneDeep(h.BG),TransactionFPinfo:b().cloneDeep(h.Vp),ArrTransactionBP:[],ArrTransactionAdditive:[],IsLocalLoaded:!1};if(void 0!==e.Common_Code){var a=[{key:v.eT,value:e.Common_Code},{key:v.v6,value:t}],s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:v.eT,KeyCodes:a};T()(R.ffd,u.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){i.CommonInfo.LoadingType=u.cd(D.xT,1),i.CommonInfo.TransactionType="RECEIPT",i.CommonInfo.TransportationType=D.LY.RAIL,i.CommonInfo.ReceiptCode=t.EntityResult.ReceiptCode,i.CommonInfo.IsBonded=t.EntityResult.IsBonded;const e=this.getWagonDetailsFromReceipt(t.EntityResult);this.setState({isReadyToRender:!1,railReceipt:t.EntityResult,modRailReceipt:b().cloneDeep(t.EntityResult),modWagonDetails:e,loadingDataInfo:b().cloneDeep(i),saveEnabled:!0}),this.handleManualEntry(e)}else this.setState({railReceipt:b().cloneDeep(h.cE),modRailReceipt:b().cloneDeep(h.cE),loadingDataInfo:b().cloneDeep(i),isReadyToRender:!0}),console.log("Error in GetCarrier:",t.ErrorList)})).catch((e=>{console.log("Error while getting RailReceipt:",e)}))}else this.setState({railReceipt:b().cloneDeep(h.cE),modRailReceipt:b().cloneDeep(h.cE),loadingDataInfo:b().cloneDeep(i),isReadyToRender:!0,tabActiveIndex:0})}getTransportationType(){var e=D.LY.RAIL;const{genericProps:t}=this.props;return void 0!==t&&void 0!==t.transportationType&&(e=t.transportationType),e}getShareholders(){return u.Zj(this.props.userDetails.EntityResult.ShareholderList)}checkManualEntryEnabled(e){var t="";for(let i of e)if(t=i.TrailerCode,i.ReceiptCompartmentStatus===D.vy.UNLOAD_NOTSTARTED||i.ReceiptCompartmentStatus===D.vy.PART_UNLOADED||i.ReceiptCompartmentStatus===D.vy.INTERRUPTED)return i.TrailerCode;return this.setState({openManualEntryWarn:!0,IsManEntryEnabled:!0,SaveEnabled:!1}),t}getTankCodeSearchOptions(){let e=b().cloneDeep(this.state.tankCodeSearchOptions);return e}getMeterCodeSearchOptions(){let e=b().cloneDeep(this.state.meterCodeSearchOptions);return e}getUOMs(){T()(R.WFM,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){if(Array.isArray(t.EntityResult.VOLUME)&&Array.isArray(t.EntityResult.MASS)){const e=[];t.EntityResult.VOLUME.forEach((t=>{e.push(t)})),t.EntityResult.MASS.forEach((t=>{e.push(t)})),this.setState({quantityUOMOptions:u.Zj(e)})}if(Array.isArray(t.EntityResult.DENSITY)){const e=[];t.EntityResult.DENSITY.forEach((t=>{e.push(t)})),this.setState({densityUOMOptions:u.Zj(e)})}if(Array.isArray(t.EntityResult.TEMPERATURE)){const e=[];t.EntityResult.TEMPERATURE.forEach((t=>{e.push(t)})),this.setState({temperatureUOMOptions:u.Zj(e)})}}}else console.log("Error in GetUOMList:",t.ErrorList)})).catch((e=>{console.log("Error in GetUOMList:",e)}))}getRailReceiptCompartmentPlanListFromReceipt(e){let t=[];return Array.isArray(e.RailMarineReceiptCompartmentPlanList)&&e.RailMarineReceiptCompartmentPlanList.forEach((e=>{t.push({ReceiptCode:e.ReceiptCode,CarrierCompanyCode:e.CarrierCompanyCode,SequenceNo:e.SequenceNo,ReceiptCompartmentStatus:(0,u.cd)(D.vy,e.ReceiptCompartmentStatus),AdjustedPlanQuantity:e.AdjustedPlanQuantity,NetUnLoadedQuantity:e.NetUnLoadedQuantity,UnloadedQuantity:e.UnloadedQuantity,UnloadedQuantityUOM:e.UnloadedQuantityUOM,PurgingRequired:e.PurgingRequired,PurgingCompleted:e.PurgingCompleted,AssociatedOrderItems:e.AssociatedOrderItems,IsTransloading:e.IsTransloading,ShareholderCode:e.ShareholderCode,FinishedProductCode:e.FinishedProductCode,CompartmentCode:e.CompartmentCode,TrailerCode:e.TrailerCode,PlannedQuantity:e.PlannedQuantity,PlanQuantityUOM:e.PlanQuantityUOM,CompartmentSeqNoInVehicle:e.CompartmentSeqNoInVehicle,Attributes:e.Attributes,AssociatedContractItems:e.AssociatedContractItems,ReceiptCompartmentTanks:e.ReceiptCompartmentTanks})})),t}getWagonDetailsFromReceipt(e){const t=[],i=[];return Array.isArray(e.RailMarineReceiptCompartmentPlanList)&&e.RailMarineReceiptCompartmentPlanList.forEach((e=>{e.ReceiptCompartmentStatus!==D.vy.EMPTY&&e.ReceiptCompartmentStatus!==D.vy.PART_UNLOADED&&e.ReceiptCompartmentStatus!==D.vy.INTERRUPTED&&e.ReceiptCompartmentStatus!==D.vy.UNLOAD_NOTSTARTED||i.push(e.TrailerCode);let a={ReceiptCode:e.ReceiptCode,TrailerCode:e.TrailerCode,CarrierCompanyCode:e.CarrierCompanyCode,FinishedProductCode:e.FinishedProductCode,ReceiptCompartmentStatus:e.ReceiptCompartmentStatus,PlannedQuantity:null!==e.PlannedQuantity&&""!==e.PlannedQuantity?e.PlannedQuantity.toLocaleString()+(e.PlanQuantityUOM?" "+e.PlanQuantityUOM:""):"",UnloadedQuantity:null!==e.UnloadedQuantity&&""!==e.UnloadedQuantity?e.UnloadedQuantity.toLocaleString()+(e.UnloadedQuantityUOM?" "+e.UnloadedQuantityUOM:""):"",ForceComplete:!1};t.push(a)})),this.setState({wagonCodeOptions:u.Zj(i)}),t}getFinishedProduct(e,t,i){var a=[{key:v.xf,value:e}],s={ShareHolderCode:t,keyDataCode:v.xf,KeyCodes:a};T()(R.cfM,u.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;t.IsSuccess?i(t.EntityResult):console.log("Error in getFinishedProduct:",t.ErrorList)})).catch((e=>{console.log("Error while getting Finished Product:",e)}))}preprocessManualEntryData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},i=null,a=null;for(let s of this.state.modRailReceipt.RailMarineReceiptCompartmentPlanList)if(s.TrailerCode===e){i=s;break}for(let s of this.state.modRailReceipt.RailMarineReceiptCompartmentDetailPlanList)if(s.TrailerCode===e){a=s;break}if(null!==i&&null!==a){if(!i.FinishedProductCode){const t={messageType:"critical",message:"ViewRailReceiptManualEntry_status",messageResultDetails:[{keyFields:["Rail_Receipt_Wagon"],keyValues:[e],isSuccess:!1,errorMessage:"RailReceiptManualEntry_ProductNotAssigned"}]};return void this.props.onNotify(t)}const a=b().cloneDeep(this.state.loadingDataInfo);a.CommonInfo.TrailerCode=e,a.CommonInfo.CarrierCode=i.CarrierCompanyCode,a.TransactionFPinfo.FinishedProductCode=i.FinishedProductCode,a.TransactionFPinfo.QuantityUOM=this.state.modRailReceipt.QuantityUOM,a.TransactionFPinfo.Attributes=[],a.TransactionFPinfo.StartTime=new Date,a.TransactionFPinfo.EndTime=new Date,this.getFinishedProduct(i.FinishedProductCode,i.ShareholderCode,(e=>{if(a.ArrTransactionBP=[],a.ArrTransactionAdditive=[],Array.isArray(e.FinishedProductItems)&&e.FinishedProductItems.length>0)for(let t of e.FinishedProductItems){const e=b().cloneDeep(h.Vp);e.FinishedProductCode=t.FinishedProductCode,e.BaseProductCode=t.BaseProductCode,e.AdditiveProductCode=t.AdditiveCode,e.Attributes=[],null!==t.AdditiveCode&&""!==t.AdditiveCode?a.ArrTransactionAdditive.push(e):a.ArrTransactionBP.push(e)}this.setState({loadingDataInfo:a,isReadyToRender:!0,modLoadingDataInfo:b().cloneDeep(a),manualEntryValidationDict:this.initialManualEntryValidationErrors(a)},(()=>this.getAttributes())),t()}))}}getDefaultUOMs(e){let t="",i="";if(""!==e&&void 0!==e)try{var a=[{key:v.wX,value:e}],s={ShareHolderCode:"",keyDataCode:v.wX,KeyCodes:a};T()(R.T1y,u.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{let a=e.data;if(!0===a.IsSuccess){let e=a.EntityResult;i=e.TemperatureUOM,t=e.DensityUOM;let s=b().cloneDeep(this.state.modLoadingDataInfo);s.TransactionFPinfo.TemperatureUOM=i,s.TransactionFPinfo.ProductDensityUOM=t,s.ArrTransactionAdditive.map((e=>{e.TemperatureUOM=i,e.ProductDensityUOM=t})),s.ArrTransactionBP.map((e=>{e.TemperatureUOM=i,e.ProductDensityUOM=t})),this.setState({modLoadingDataInfo:s})}}))}catch(o){console.log("TruckShipmentManualEntryDetailsComposite:Error while getting getBCUDeviceDetails")}}GetMetersForLA(e,t){try{var i=[{key:v.Dm,value:D.Dm.RAIL_BCUVIEW},{key:v.wX,value:e},{key:v.uw,value:this.state.modRailReceipt.ActualTerminalCode}],a={ShareHolderCode:"",keyDataCode:v.Dm,KeyCodes:i};T()(R._xh,u.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{var i=e.data;if(!0===i.IsSuccess&&Array.isArray(i.EntityResult)&&i.EntityResult.length>0){let e=i.EntityResult[0].AssociatedArmsList.find((e=>e.Code===t));if(null!==e){let t=b().cloneDeep(this.state.modLoadingDataInfo),i=[],a=[];i=e.AssociatedMeterList.find((e=>"MAINLINE"===e.MeterLineType)),a=e.AssociatedMeterList.find((e=>"ADDITIVE"===e.MeterLineType));let s="",o="";1===i.MeterList.length&&(s=i.MeterList[0].Code),1===a.MeterList.length&&(o=a.MeterList[0].Code),""!==s&&t.ArrTransactionBP.map((e=>{e.MeterCode=s})),""!==o&&t.ArrTransactionAdditive.map((e=>{e.MeterCode=o})),this.setState({modLoadingDataInfo:t})}}}))}catch(s){console.log("SiteTreeView:Error occured in GetMetersForLA",s)}}initialManualEntryValidationErrors(e){const t={},i={};for(let s in x.Bg)"BayCode"!==s&&"BCUCode"!==s&&"LoadingArm"!==s&&("TransactionID"===s||"StartTime"===s||"EndTime"===s||"Remarks"===s?t[s]="":i[s]="");const a={bayCode:"",BCUCode:"",LoadingArm:"",common:t,product:[i]};for(let s=0;s<e.ArrTransactionBP.length;s++)a.product.push(b().cloneDeep(i));for(let s=0;s<e.ArrTransactionAdditive.length;s++)a.product.push(b().cloneDeep(i));return a}handleManualEntry(e){try{if(e.length>0){const t=this.checkManualEntryEnabled(e);this.preprocessManualEntryData(t)}}catch(t){console.log("RailReceiptDetailsComposite: Error occurred on handleManualEntry",t)}}fillDetails(){try{let e=b().cloneDeep(this.state.modLoadingDataInfo);null!==e.TransactionFPinfo.GrossQuantity&&""!==e.TransactionFPinfo.GrossQuantity&&(e.TransactionFPinfo.GrossQuantity=e.TransactionFPinfo.GrossQuantity.toLocaleString()),null!==e.TransactionFPinfo.NetQuantity&&""!==e.TransactionFPinfo.NetQuantity&&(e.TransactionFPinfo.NetQuantity=e.TransactionFPinfo.NetQuantity.toLocaleString()),null!==e.TransactionFPinfo.Temperature&&""!==e.TransactionFPinfo.Temperature&&(e.TransactionFPinfo.Temperature=e.TransactionFPinfo.Temperature.toLocaleString()),null!==e.TransactionFPinfo.ProductDensity&&""!==e.TransactionFPinfo.ProductDensity&&(e.TransactionFPinfo.ProductDensity=e.TransactionFPinfo.ProductDensity.toLocaleString()),null!==e.TransactionFPinfo.StartTotalizer&&""!==e.TransactionFPinfo.StartTotalizer&&(e.TransactionFPinfo.StartTotalizer=e.TransactionFPinfo.StartTotalizer.toLocaleString()),null!==e.TransactionFPinfo.EndTotalizer&&""!==e.TransactionFPinfo.EndTotalizer&&(e.TransactionFPinfo.EndTotalizer=e.TransactionFPinfo.EndTotalizer.toLocaleString()),null!==e.TransactionFPinfo.NetStartTotalizer&&""!==e.TransactionFPinfo.NetStartTotalizer&&(e.TransactionFPinfo.NetStartTotalizer=e.TransactionFPinfo.NetStartTotalizer.toLocaleString()),null!==e.TransactionFPinfo.StartTotalizer&&""!==e.TransactionFPinfo.StartTotalizer&&(e.TransactionFPinfo.StartTotalizer=e.TransactionFPinfo.StartTotalizer.toLocaleString()),null!==e.TransactionFPinfo.NetEndTotalizer&&""!==e.TransactionFPinfo.NetEndTotalizer&&(e.TransactionFPinfo.NetEndTotalizer=e.TransactionFPinfo.NetEndTotalizer.toLocaleString()),null!==e.TransactionFPinfo.CalculatedGross&&""!==e.TransactionFPinfo.CalculatedGross&&(e.TransactionFPinfo.CalculatedGross=e.TransactionFPinfo.CalculatedGross.toLocaleString()),null!==e.TransactionFPinfo.CalculatedNet&&""!==e.TransactionFPinfo.CalculatedNet&&(e.TransactionFPinfo.CalculatedNet=e.TransactionFPinfo.CalculatedNet.toLocaleString());let t=0;return e.ArrTransactionBP.forEach((i=>{null!==i.GrossQuantity&&""!==i.GrossQuantity&&(e.ArrTransactionBP[t].GrossQuantity=i.GrossQuantity.toLocaleString()),null!==i.NetQuantity&&""!==i.NetQuantity&&(e.ArrTransactionBP[t].NetQuantity=i.NetQuantity.toLocaleString()),null!==i.Temperature&&""!==i.Temperature&&(e.ArrTransactionBP[t].Temperature=i.Temperature.toLocaleString()),null!==i.ProductDensity&&""!==i.ProductDensity&&(e.ArrTransactionBP[t].ProductDensity=i.ProductDensity.toLocaleString()),null!==i.StartTotalizer&&""!==i.StartTotalizer&&(e.ArrTransactionBP[t].StartTotalizer=i.StartTotalizer.toLocaleString()),null!==i.EndTotalizer&&""!==i.EndTotalizer&&(e.ArrTransactionBP[t].EndTotalizer=i.EndTotalizer.toLocaleString()),null!==i.NetStartTotalizer&&""!==i.NetStartTotalizer&&(e.ArrTransactionBP[t].NetStartTotalizer=i.NetStartTotalizer.toLocaleString()),null!==i.NetEndTotalizer&&""!==i.NetEndTotalizer&&(e.ArrTransactionBP[t].NetEndTotalizer=i.NetEndTotalizer.toLocaleString()),null!==i.CalculatedGross&&""!==i.CalculatedGross&&(e.ArrTransactionBP[t].CalculatedGross=i.CalculatedGross.toLocaleString()),null!==i.CalculatedNet&&""!==i.CalculatedNet&&(e.ArrTransactionBP[t].CalculatedNet=i.CalculatedNet.toLocaleString())})),this.setState({modLoadingDataInfo:e}),e}catch(e){console.log("RailReceiptRecordWeightDetailsComposite:Error occured on fillDetails",e)}}validateManualEntry(e,t,i,a){const s=b().cloneDeep(this.state.manualEntryValidationDict);let o,r=!0;s.bayCode=u.jr(x.Bg.BayCode,e.CommonInfo.BayCode),s.BCUCode=u.jr(x.Bg.BCUCode,e.CommonInfo.BCUCode),s.LoadingArm=u.jr(x.Bg.LoadingArm,e.TransactionFPinfo.ArmCode),""!==s.bayCode&&(r=!1),""!==s.BCUCode&&(r=!1),""!==s.LoadingArm&&(r=!1);for(let h in s.common)s.common[h]=u.jr(x.Bg[h],e.TransactionFPinfo[h]),""!==s.common[h]&&(r=!1);e.TransactionFPinfo.StartTime>=e.TransactionFPinfo.EndTime&&(s.common.StartTime="MarineReceiptManualEntry_ErrorUnloadTime",r=!1);let n=0;for(let h in s.product[n])s.product[n][h]=u.jr(x.Bg[h],e.TransactionFPinfo[h]),""!==s.product[n][h]&&(r=!1,void 0===o&&(o=n));for(let h of e.ArrTransactionBP){n+=1;for(let e in s.product[n])s.product[n][e]=u.jr(x.Bg[e],h[e]),""!==s.product[n][e]&&(r=!1,void 0===o&&(o=n))}for(let h of e.ArrTransactionAdditive){n+=1;for(let e in s.product[n])s.product[n][e]=u.jr(x.Bg[e],h[e]),""!==s.product[n][e]&&(r=!1,void 0===o&&(o=n))}void 0!==o&&this.handleManualEntryTabChange(o);var l=b().cloneDeep(this.state.attributeFPValidationErrors);t.forEach((e=>{l.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.attributeMetaDataList.forEach((e=>{t.attributeValidationErrors[e.Code]=u.I5(e,e.DefaultValue)}))}))}));var d=b().cloneDeep(this.state.attributeBPValidationErrors);i.forEach((e=>{e.forEach((e=>{d.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.attributeMetaDataList.forEach((e=>{t.attributeValidationErrors[e.Code]=u.I5(e,e.DefaultValue)}))}))}))}));var c=b().cloneDeep(this.state.attributeAddValidationErrors);return a.forEach((e=>{e.forEach((e=>{c.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.attributeMetaDataList.forEach((e=>{t.attributeValidationErrors[e.Code]=u.I5(e,e.DefaultValue)}))}))}))})),this.setState({attributeFPValidationErrors:l,attributeBPValidationErrors:d,attributeAddValidationErrors:c}),this.setState({manualEntryValidationDict:s}),r}getAttributes(){try{T()(R.fKH,u.tW([I.ao,I.gp,I.xW],this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({attributeMetaDataList:b().cloneDeep(t.EntityResult),attributeFPValidationErrors:u.Fl(t.EntityResult.RAILUNLOADINGDETAILSFP),attributeBPValidationErrors:u.Fl(t.EntityResult.RAILUNLOADINGDETAILSBP),attributeAddValidationErrors:u.Fl(t.EntityResult.RAILUNLOADINGDETAILSADDITIVE)},(()=>{this.props.IsEnterpriseNode?(this.terminalFPSelectionChange([]),this.terminalBPSelectionChange([]),this.terminalAddSelectionChange([])):this.localNodeAttribute()})):console.log("Error in getAttributes:")}))}catch(e){console.log("Error while getAttributes:",e)}}fillAttributeDetails(e,t,i,a){try{t=u.SC(t),i.length>0&&i.forEach((e=>{e=u.SC(e)})),a.length>0&&a.forEach((e=>{e=u.SC(e)})),e.Attributes=[],t.forEach((t=>{let i={ListOfAttributeData:[]};i.TerminalCode=t.TerminalCode,t.attributeMetaDataList.forEach((e=>{i.ListOfAttributeData.push({AttributeCode:e.Code,AttributeValue:e.DefaultValue})})),e.TransactionFPinfo.Attributes.push(i)}));for(let t=0;t<i.length;t++){i[t].forEach((i=>{let a={ListOfAttributeData:[]};a.TerminalCode=i.TerminalCode,i.attributeMetaDataList.forEach((e=>{a.ListOfAttributeData.push({AttributeCode:e.Code,AttributeValue:e.DefaultValue})})),e.ArrTransactionBP[t].Attributes.push(a)}))}for(let t=0;t<a.length;t++){a[t].forEach((i=>{let a={ListOfAttributeData:[]};a.TerminalCode=i.TerminalCode,i.attributeMetaDataList.forEach((e=>{a.ListOfAttributeData.push({AttributeCode:e.Code,AttributeValue:e.DefaultValue})})),e.ArrTransactionAdditive[t].Attributes.push(a)}))}return this.setState({modLoadingDataInfo:e}),e}catch(s){console.log("TankDetailsComposite:Error occured on fillAttributeDetails",s)}}terminalFPSelectionChange(e){try{if(void 0!==e&&null!==e){let s=[];var t=[],i=[];t=b().cloneDeep(this.state.attributeMetaDataList),i=b().cloneDeep(this.state.selectedFPAttributeList);const o=b().cloneDeep(this.state.attributeFPValidationErrors);var a=b().cloneDeep(this.state.modLoadingDataInfo);e.forEach((e=>{var o=i.find((t=>t.TerminalCode===e));void 0===o?t.RAILUNLOADINGDETAILSFP.forEach((function(t){if(t.TerminalCode===e){var i=a.TransactionFPinfo.Attributes.find((t=>t.TerminalCode===e));void 0!==i&&t.attributeMetaDataList.forEach((function(e){var t=i.ListOfAttributeData.find((t=>t.AttributeCode===e.Code));void 0!==t&&(e.DefaultValue=t.AttributeValue)})),s.push(t)}})):s.push(o)})),i=[],i=s,i=u.nQ(i),o.forEach((t=>{void 0===e.find((e=>t.TerminalCode===e))&&Object.keys(t.attributeValidationErrors).forEach((e=>t.attributeValidationErrors[e]=""))})),this.setState({selectedFPAttributeList:i,attributeFPValidationErrors:o})}}catch(s){console.log("RailReceiptManualEntryComposite:Error occured on terminalFPSelectionChange",s)}}terminalBPSelectionChange(e){try{if(void 0!==e&&null!==e){let s=[];var t=[],i=[];t=b().cloneDeep(this.state.attributeMetaDataList),i=b().cloneDeep(this.state.selectedBPAttributeList);const o=b().cloneDeep(this.state.attributeBPValidationErrors);var a=b().cloneDeep(this.state.modLoadingDataInfo);e.forEach((e=>{var o=i.find((t=>t.TerminalCode===e));if(void 0===o)for(let i of a.ArrTransactionBP){let a=[];t.RAILUNLOADINGDETAILSBP.forEach((function(t){if(t.TerminalCode===e){var s=i.Attributes.find((t=>t.TerminalCode===e));void 0!==s&&t.attributeMetaDataList.forEach((function(e){var t=s.ListOfAttributeData.find((t=>t.AttributeCode===e.Code));void 0!==t&&(e.DefaultValue=t.AttributeValue)})),a.push(b().cloneDeep(t))}})),s.push(a)}else s.push(o)})),i=[],i=s,s.forEach((e=>{e=u.nQ(e)})),o.forEach((t=>{void 0===e.find((e=>t.TerminalCode===e))&&Object.keys(t.attributeBPValidationErrors).forEach((e=>t.attributeBPValidationErrors[e]=""))})),this.setState({selectedBPAttributeList:i,attributeBPValidationErrors:o})}}catch(s){console.log("RailReceiptManualEntryComposite:Error occured on terminalBPSelectionChange",s)}}terminalAddSelectionChange(e){try{if(void 0!==e&&null!==e){let s=[],o=[];var t=[],i=[];t=b().cloneDeep(this.state.attributeMetaDataList),i=b().cloneDeep(this.state.selectedAddAttributeList);const r=b().cloneDeep(this.state.attributeAddValidationErrors);var a=b().cloneDeep(this.state.modLoadingDataInfo);e.forEach((e=>{var r=i.find((t=>t.TerminalCode===e));if(void 0===r)for(let i of a.ArrTransactionAdditive)t.RAILUNLOADINGDETAILSADDITIVE.forEach((function(t){if(t.TerminalCode===e){var a=i.Attributes.find((t=>t.TerminalCode===e));void 0!==a&&t.attributeMetaDataList.forEach((function(e){var t=a.ListOfAttributeData.find((t=>t.AttributeCode===e.Code));void 0!==t&&(e.DefaultValue=t.AttributeValue)})),o.push(b().cloneDeep(t))}})),s.push(o);else o.push(r)})),i=[],i=s,s.forEach((e=>{e=u.nQ(e)})),r.forEach((t=>{void 0===e.find((e=>t.TerminalCode===e))&&Object.keys(t.attributeAddValidationErrors).forEach((e=>t.attributeAddValidationErrors[e]=""))})),this.setState({selectedAddAttributeList:i,attributeAddValidationErrors:r})}}catch(s){console.log("RailReceiptManualEntryComposite:Error occured on terminalAddSelectionChange",s)}}localNodeAttribute(){try{var e=b().cloneDeep(this.state.attributeMetaDataList);Array.isArray(e.RAILUNLOADINGDETAILSFP)&&e.RAILUNLOADINGDETAILSFP.length>0&&this.terminalFPSelectionChange([e.RAILUNLOADINGDETAILSFP[0].TerminalCode]),Array.isArray(e.RAILUNLOADINGDETAILSBP)&&e.RAILUNLOADINGDETAILSBP.length>0&&this.terminalBPSelectionChange([e.RAILUNLOADINGDETAILSBP[0].TerminalCode]),Array.isArray(e.RAILUNLOADINGDETAILSADDITIVE)&&e.RAILUNLOADINGDETAILSADDITIVE.length>0&&this.terminalAddSelectionChange([e.RAILUNLOADINGDETAILSADDITIVE[0].TerminalCode])}catch(t){console.log("RailReceiptDetailsComposite:Error occured on localNodeAttribute",t)}}handleResetAttributeValidationError(){try{var e=b().cloneDeep(this.state.attributeMetaDataList);this.setState({attributeFPValidationErrors:u.Fl(e.RAILUNLOADINGDETAILSFP),attributeBPValidationErrors:u.Fl(e.RAILUNLOADINGDETAILSBP),attributeAddValidationErrors:u.Fl(e.RAILUNLOADINGDETAILSADDITIVE)})}catch(t){console.log("handleAttributeValidationError:Error occured on handleReset",t)}}renderModal(){return(0,r.jsx)(d.TranslationConsumer,{children:e=>(0,r.jsxs)(c.Modal,{onClose:()=>this.setState({openManualEntryWarn:!1}),size:"mini",open:this.state.openManualEntryWarn,closeOnDimmerClick:!1,children:[(0,r.jsx)(c.Modal.Content,{children:(0,r.jsx)("div",{children:(0,r.jsx)("b",{children:e("WagonStatusForManualEntryInvalid")})})}),(0,r.jsx)(c.Modal.Footer,{children:(0,r.jsx)(c.Button,{type:"primary",size:"small",content:e("ViewMarineReceiptList_Cancel"),onClick:()=>this.setState({openManualEntryWarn:!1})})})]})})}render(){return this.state.isReadyToRender?(0,r.jsxs)("div",{children:[this.renderModal(),(0,r.jsx)(p.A,{children:(0,r.jsx)(g,{IsManEntryEnabled:this.state.IsManEntryEnabled,modLoadingDataInfo:this.state.modLoadingDataInfo,validationErrors:this.state.manualEntryValidationDict,listOptions:{wagonCodes:this.state.wagonCodeOptions,clusterCodes:this.state.clusterCodeOptions,BCUCodes:this.state.BCUCodeOptions,loadingArmCodes:this.state.loadingArmCodeOptions,quantityUOMs:this.state.quantityUOMOptions,densityUOMs:this.state.densityUOMOptions,temperatureUOMs:this.state.temperatureUOMOptions,tankCodes:this.getTankCodeSearchOptions(),meterCodes:this.getMeterCodeSearchOptions()},onFieldChange:this.handleCompartmentManualEntryChange,onTankSearchChange:this.handleTankSearchChange,onMeterSearchChange:this.handleMeterSearchChange,onTabChange:this.handleManualEntryTabChange,tabActiveIndex:this.state.manualEntryTabActiveIndex,selectedFPAttributeList:this.state.selectedFPAttributeList,selectedBPAttributeList:this.state.selectedBPAttributeList,selectedAddAttributeList:this.state.selectedAddAttributeList,attributeBPValidationErrors:this.state.attributeBPValidationErrors,attributeFPValidationErrors:this.state.attributeFPValidationErrors,attributeAddValidationErrors:this.state.attributeAddValidationErrors,onDateTextChange:this.handleDateTextChange,handleAttributeCellDataEdit:this.handleAttributeCellDataEdit})}),(0,r.jsx)(p.A,{children:(0,r.jsx)(S.q,{handleBack:this.props.onBack,handleSave:this.handleCompartmentManualEntrySave,handleReset:this.handleCompartmentManualEntryReset,saveEnabled:this.state.SaveEnabled})}),this.state.showAuthenticationLayout?(0,r.jsx)(N.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:w.i.add,functionGroup:w.$p,handleOperation:this.saveManualEntry,handleClose:this.handleAuthenticationClose}):null]}):(0,r.jsx)(L.A,{message:"Loading"})}}const M=(0,f.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})),(e=>({userActions:(0,A.zH)(E,e)})))(j);var F=i(88319),O=i(34199),U=i(78374);function V(e){let{listOptions:t,modRailWagonBatchPlanList:i,onCellDataEdit:a,onAuthorize:s,railReceipt:o}=e;const[n]=(0,d.useTranslation)(),l=(e,t)=>(0,r.jsx)(c.Select,{className:"selectDropwdown",value:i[e.rowIndex][e.field],fluid:!0,options:t,onChange:t=>a(t,e),indicator:"required",reserveSpace:!1,search:!0,noResultsMessage:n("noResultsMessage")}),h=e=>(0,r.jsx)(c.Input,{fluid:!0,value:i[e.rowIndex][e.field],onChange:t=>a(t,e),reserveSpace:!1}),u=e=>(0,r.jsx)("div",{className:"compartmentIconContainer"+(e.value?" gridButtonFontColor":""),children:(0,r.jsx)("div",{onClick:()=>s(e.rowData),className:"compartmentIcon",children:(0,r.jsx)("div",{className:"margin_l10",children:(0,r.jsx)("h5",{className:"font14",children:n("RailDispatchPlanInfo_Authorize")})})})}),p=e=>{const{value:t}=e;return"number"===typeof t?t.toLocaleString():t};return(0,r.jsx)(d.TranslationConsumer,{children:e=>(0,r.jsxs)("div",{className:"detailsContainer",children:[(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,indicator:"required",value:o.ReceiptCode,label:e("ViewReceiptList_ReceiptCode"),editable:!1,reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.DatePicker,{fluid:!0,indicator:"required",value:null===o.ScheduledDate||void 0===o.ScheduledDate||""===o.ScheduledDate?"":new Date(o.ScheduledDate),label:e("UnLoadingInfo_ScheduledDate"),type:"datetime",minuteStep:"5",displayFormat:(0,C.F1)(),reserveSpace:!1})}),(0,r.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,r.jsx)(c.Input,{fluid:!0,indicator:"required",value:o.ReceiptStatus,label:e("Receipt_ReceiptStatus"),editable:!1,reserveSpace:!1})})]}),(0,r.jsx)("div",{className:"row",children:(0,r.jsx)("div",{className:"col-12 detailsTable",children:(0,r.jsxs)(U.bQ,{data:i,children:[(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"RailWagonCode",header:e("ViewRailLoadingDetails_RailWagonCode")},"RailWagonCode"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"CarrierCompanyCode",header:e("ViewRailLoadingDetails_CarrierCompany")},"CarrierCompanyCode"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"FinishedProduct",header:e("ViewRailDispatchList_FinishedProductCode")},"FinishedProduct"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"PresetQuantity",header:e("RailDispatchTrainAssignment_PresetQuantity")},"PresetQuantity"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"SpurCode",header:e("Spur_Code"),editable:!0,editFieldType:"text",customEditRenderer:e=>l(e,t.spurCodes)},"SpurCode"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"ClusterCode",header:e("RailDispatchManualEntry_Cluster"),editable:!0,editFieldType:"text",customEditRenderer:e=>l(e,t.clusterCodes)},"ClusterCode"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"BCUCode",header:e("ViewRailLoadingDetails_BCUCode"),editable:!0,editFieldType:"text",customEditRenderer:e=>l(e,t.BCUCodes)},"BCUCode"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"ArmNoInBCU",header:e("LoadingArmInfo_ArmNoInBCU"),editable:!0,editFieldType:"text",renderer:e=>p(e),customEditRenderer:e=>h(e)},"ArmNoInBCU"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"LoadingSequenceNo",header:e("RailDispatchLoadSpotAssign_LoadingSeq"),editable:!0,editFieldType:"text",renderer:e=>p(e),customEditRenderer:e=>h(e)},"LoadingSequenceNo"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"AllowAuthorize",header:e("RailDispatchPlanInfo_Authorize"),renderer:e=>u(e)},"AllowAuthorize")]})})})]})})}var k=i(43503),B=i(28882),_=i(45217);class W extends a.Component{constructor(){super(...arguments),this.state={spurCodeOptions:[],loadSpotClusterCodeOptions:[],loadSpotBCUCodeOptions:[],railWagonBatchPlanList:{},modRailWagonBatchPlanList:{},loadSpotAssignmentSaveEnabled:!1,isReadyToRender:!1,railReceipt:{},showAuthenticationLayout:!1,isShowMultipleSpurs:!1},this.handleshareholderChange=e=>{try{this.getTerminalsList(e)}catch(t){console.log("RailReceiptLoadSpotAssignmentComposite:Error occured on handleshareholderChange",t)}},this.handleLoadSpotAssignmentAssignWagon=e=>{try{if(e.AllowAuthorize){const t={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:v.eT,KeyCodes:[{key:v.eT,value:this.props.selectedRow.Common_Code}],Entity:e},i={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[{keyFields:["Rail_Receipt_Wagon"],keyValues:[e.RailWagonCode],isSuccess:!1,errorMessage:""}]};T()(R.dwR,u.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;i.messageType=t.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?i.message="RailReceipt_BatchAuthorize_Success":(i.messageResultDetails[0].errorMessage=t.ErrorList[0],console.log("Error in handleLoadSpotAssignmentAssignWagon: ",t.ErrorList)),this.props.onSaved(this.props.selectedRow,"Authorize",i)})).catch((e=>{i.messageResultDetails[0].errorMessage=e,this.props.onSaved(this.props.selectedRow,"Authorize",i)}))}}catch(t){console.log("RailReceiptDetailsComposite: Error occurred on handleLoadSpotAssignmentAssignWagon",t)}},this.handleLoadSpotAssignmentCellDataEdit=(e,t)=>{const i=b().cloneDeep(this.state.modRailWagonBatchPlanList);i[t.rowIndex][t.field]=e,"SpurCode"===t.field?(this.getRailLoadSpotDevices(e,"CLUSTER"),this.GetRailLoadSpot(t.rowIndex,e,"SPUR")):"ClusterCode"===t.field&&this.getRailLoadSpotDevices(e,"BCU"),this.setState({modRailWagonBatchPlanList:i})},this.handleLoadSpotAssignReset=()=>{this.setState({modRailWagonBatchPlanList:b().cloneDeep(this.state.railWagonBatchPlanList)})},this.saveLoadSpotAssign=()=>{this.handleAuthenticationClose();const e=b().cloneDeep(this.state.modRailWagonBatchPlanList);this.setState({loadSpotAssignmentSaveEnabled:!1});const t={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:v.eT,KeyCodes:[{key:v.eT,value:this.props.selectedRow.Common_Code}],Entity:e},i={messageType:"critical",message:"ViewRailReceipt_LoadSportAssignment_status",messageResultDetails:[{keyFields:["ViewReceipt_ReceiptCode"],keyValues:[this.props.selectedRow.Common_Code],isSuccess:!1,errorMessage:""}]};T()(R.TcH,u.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;i.messageType=t.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.initialLoadSpotAssignmentList():(i.messageResultDetails[0].errorMessage=t.ErrorList[0],this.setState({loadSpotAssignmentSaveEnabled:u.ab(this.props.userDetails.EntityResult.FunctionsList,w.i.modify,w.JI)}),console.log("Error in handleLoadSpotAssignSave: ",t.ErrorList)),this.props.onSaved(this.props.selectedRow,"Update",i)})).catch((e=>{this.setState({loadSpotAssignmentSaveEnabled:!0}),i.messageResultDetails[0].errorMessage=e,this.props.onSaved(this.props.selectedRow,"Update",i)}))},this.handleLoadSpotAssignSave=()=>{try{const e=b().cloneDeep(this.state.modRailWagonBatchPlanList);if(this.validateLoadSpotAssignSave(e)){let t=!1;e.forEach((function(i){e.filter((e=>e.SpurCode!=i.SpurCode)).length>0&&(t=!0)})),t?this.setState({isShowMultipleSpurs:!0}):this.saveLoadSpotAfterConfirm()}else this.setState({loadSpotAssignmentSaveEnabled:u.ab(this.props.userDetails.EntityResult.FunctionsList,w.i.modify,w.JI)})}catch(e){console.log("RailReceiptDetailsComposite: Error occurred on handleLoadSpotAssignSave",e)}},this.saveLoadSpotAfterConfirm=()=>{this.setState({isShowMultipleSpurs:!1});let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showAuthenticationLayout:e},(()=>{!1===e&&this.saveLoadSpotAssign()}))},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentWillReceiveProps(e){try{void 0===e.selectedWagonRow.TrailerCode&&this.getRailWagon(e.selectedWagonRow)}catch(t){console.log("RailReceiptLoadSpotAssignmentComposite:Error occured on componentWillReceiveProps",t)}}getRailLoadSpotDevices(e,t){T()(R.SpY+"?ParentEntityCode="+e+"&EntityType="+t,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const i=e.data;!0===i.IsSuccess&&Array.isArray(i.EntityResult)?("SPUR"===t?this.setState({spurCodeOptions:u.Zj(i.EntityResult)}):"CLUSTER"===t?this.setState({loadSpotClusterCodeOptions:u.Zj(i.EntityResult)}):"BCU"===t&&this.setState({loadSpotBCUCodeOptions:u.Zj(i.EntityResult)}),this.setState({isReadyToRender:!0})):console.log("Error in getRailLoadSpotDevices: ",i.ErrorList)})).catch((e=>{console.log("Error in getRailLoadSpotDevices: ",e)}))}GetRailLoadSpot(e,t,i){T()(R.hPe+"?EntityCode="+t+"&EntityType="+i,u.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{const i=t.data;var a=b().cloneDeep(this.state.modRailWagonBatchPlanList);!0===i.IsSuccess?(a[e].BCUCode=i.EntityResult.BCUCode,a[e].ClusterCode=i.EntityResult.ClusterCode,a[e].ArmNoInBCU=i.EntityResult.ArmNoInBCU,null===a[e].ClusterCode&&""===a[e].ClusterCode||this.getRailLoadSpotDevices(a[e].ClusterCode,"BCU"),this.setState({modRailWagonBatchPlanList:a,isReadyToRender:!0})):console.log("Error in GetRailLoadSpot: ",i.ErrorList)})).catch((e=>{console.log("Error in GetRailLoadSpot: ",e)}))}getRailReceipt(e){var t=this.getTransportationType();if(h.cE.TransportationType=t,void 0!==e.Common_Code){var i=[{key:v.eT,value:e.Common_Code},{key:v.v6,value:t}],a={ShareHolderCode:this.props.selectedShareholder,keyDataCode:v.eT,KeyCodes:i};T()(R.ffd,u.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({isReadyToRender:!0,railReceipt:b().cloneDeep(t.EntityResult)}):(this.setState({railReceipt:b().cloneDeep(h.cE),isReadyToRender:!0}),console.log("Error in GetRailReceipt:",t.ErrorList))})).catch((e=>{console.log("Error while getting railReceipt:",e)}))}else this.setState({railReceipt:{...h.cE},isReadyToRender:!0})}componentDidMount(){try{u.pJ(this.props.userDetails.EntityResult.IsArchived),this.getRailReceipt(this.props.selectedRow),this.initialLoadSpotAssignmentList(),this.getRailLoadSpotDevices("","SPUR")}catch(e){console.log("RailReceiptLoadSpotAssignmentComposite:Error occured on componentDidMount",e)}}getTransportationType(){var e=D.LY.RAIL;const{genericProps:t}=this.props;return void 0!==t&&void 0!==t.transportationType&&(e=t.transportationType),e}getShareholders(){return u.Zj(this.props.userDetails.EntityResult.ShareholderList)}initialLoadSpotAssignmentList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};var t=[{key:v.ml,value:this.props.selectedRow.Common_Code}];const i={ShareHolderCode:this.props.selectedShareholder,KeyCodes:t,keyDataCode:v.eT};T()(R.mXw,u.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{const i=t.data;!0===i.IsSuccess&&Array.isArray(i.EntityResult)?this.setState({railWagonBatchPlanList:i.EntityResult,modRailWagonBatchPlanList:b().cloneDeep(i.EntityResult),loadSpotAssignmentSaveEnabled:u.ab(this.props.userDetails.EntityResult.FunctionsList,w.i.modify,w.JI)}):(this.setState({railWagonBatchPlanList:[],modRailWagonBatchPlanList:[],loadSpotAssignmentSaveEnabled:!1}),console.log("Error in GetRailReceiptBatchPlanDetails: ",i.ErrorList)),e()})).catch((e=>{this.setState({railWagonBatchPlanList:[],modRailWagonBatchPlanList:[],loadSpotAssignmentSaveEnabled:!1}),console.log("Error while getting GetRailReceiptBatchPlanDetails: ",e)}))}validateLoadSpotAssignSave(e){const t={messageType:"critical",message:"ViewRailReceipt_LoadSportAssignment_status",messageResultDetails:[]},i=b().cloneDeep(B.sx);for(let a of e)i.forEach((e=>{let i="";void 0!==e.validator&&(i=u.jr(e.validator,a[e.field])),""!==i&&t.messageResultDetails.push({keyFields:["Receipt_Code",e.displayName],keyValues:[this.props.selectedRow.Common_Code,a[e.field]],isSuccess:!1,errorMessage:i})}));return!(t.messageResultDetails.length>0)||(this.props.onSaved(this.props.selectedRow,"Validate",t),!1)}render(){return this.state.isReadyToRender?(0,r.jsxs)("div",{children:[(0,r.jsx)(p.A,{children:(0,r.jsx)(k.A,{entityCode:this.state.railReceipt.ReceiptCode,newEntityName:"RailReceiptLoadSpotAssign_PageTitle"})}),(0,r.jsx)(p.A,{children:(0,r.jsx)(V,{listOptions:{spurCodes:this.state.spurCodeOptions,clusterCodes:this.state.loadSpotClusterCodeOptions,BCUCodes:this.state.loadSpotBCUCodeOptions},railReceipt:this.state.railReceipt,modRailWagonBatchPlanList:this.state.modRailWagonBatchPlanList,onCellDataEdit:this.handleLoadSpotAssignmentCellDataEdit,onAuthorize:this.handleLoadSpotAssignmentAssignWagon})}),(0,r.jsx)(p.A,{children:(0,r.jsx)(_.A,{isOpen:this.state.isShowMultipleSpurs,confirmMessage:"Confirm_RailReceiptSave",handleNo:()=>{this.setState({isShowMultipleSpurs:!1})},handleYes:()=>this.saveLoadSpotAfterConfirm()})}),(0,r.jsx)(p.A,{children:(0,r.jsx)(S.q,{handleBack:this.props.onBack,handleSave:this.handleLoadSpotAssignSave,handleReset:this.handleLoadSpotAssignReset,saveEnabled:this.state.loadSpotAssignmentSaveEnabled})}),this.state.showAuthenticationLayout?(0,r.jsx)(N.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:w.i.modify,functionGroup:w.JI,handleClose:this.handleAuthenticationClose,handleOperation:this.saveLoadSpotAssign}):null]}):(0,r.jsx)(L.A,{message:"Loading"})}}const G=(0,f.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})),(e=>({userActions:(0,A.zH)(E,e)})))(W);function H(e){let{tableData:t,handleBack:i}=e;const[a]=(0,d.useTranslation)(),s=e=>{try{if(null===e||void 0===e||" "===e)return"";const t=e.split(" ",2);return 2!==t.length||""===t[0]?"":parseFloat(t[0]).toLocaleString()+" "+t[1]}catch(t){return console.log("Error in convertNumberWithUOM "+e),e}},o=e=>{const{value:t}=e;return null!=t&&""!==t?t.toLocaleString():""};return(0,r.jsx)("div",{className:"detailsContainer",children:(0,r.jsx)("div",{className:"row",children:(0,r.jsx)("div",{className:"detailsTable loadingTable",children:(0,r.jsxs)(U.bQ,{data:t,scrollable:!0,bAutoWidth:!0,scrollHeight:"450px",resizableColumns:!0,children:[(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"CompartmentSeqNoInVehicle",initialWidth:"125px",header:a("RailDispatchTrainAssignment_SequenceNo")},"CompartmentSeqNoInVehicle"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"TrailerCode",initialWidth:"146px",header:a("Rail_Wagon_Code")},"TrailerCode"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"CarrierCode",initialWidth:"140px",header:a("ViewReceipt_CarrierCompany")},"CarrierCode"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"ProductCode",initialWidth:"130px",header:a("Report_ProductCode")},"ProductCode"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"BaseProductCode",initialWidth:"155px",header:a("BaseProductCode")},"BaseProductCode"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"TankCode",initialWidth:"105px",header:a("TankList_Code")},"TankCode"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"BayCode",initialWidth:"120px",header:a("ViewRailLoadingDetails_BayCode")},"BayCode"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"BCUCode",initialWidth:"110px",header:a("BCU_Code")},"BCUCode"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"MeterCode",initialWidth:"110px",header:a("LoadingDetails_MeterCode")},"MeterCode"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"GrossQuantity",initialWidth:"130px",renderer:e=>s(e.value),header:a("LoadingDetailsEntry_GrossQuantity")},"GrossQuantity"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"NetQuantity",initialWidth:"130px",renderer:e=>s(e.value),header:a("LoadingDetailsEntry_NetQuantity")},"NetQuantity"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"Density",initialWidth:"150px",renderer:e=>s(e.value),header:a("UnLoadingInfo_ProductDensity")},"Density"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"Pressure",initialWidth:"100px",renderer:e=>s(e.value),header:a("UnloadingDetailsEntry_Pressure")},"Pressure"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"Temperature",initialWidth:"120px",renderer:e=>s(e.value),header:a("LoadingDetailsEntry_Temperature")},"Temperature"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"StartTime",initialWidth:"190px",header:a("Reconciliation_StartTime"),renderer:e=>new Date(e.value).toLocaleDateString()+" "+new Date(e.value).toLocaleTimeString()},"StartTime"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"EndTime",initialWidth:"190px",type:"datetime",renderer:e=>new Date(e.value).toLocaleDateString()+" "+new Date(e.value).toLocaleTimeString(),header:a("Reconciliation_EndTime")},"EndTime"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"StartTotalizer",initialWidth:"125px",renderer:e=>o(e),header:a("StartTotalizer")},"StartTotalizer"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",initialWidth:"125px",field:"EndTotalizer",renderer:e=>o(e),header:a("EndTotalizer")},"EndTotalizer"),(0,r.jsx)(U.bQ.Column,{className:"compColHeight",field:"TransactionID",initialWidth:"140px",header:a("ViewRailUnloadingDetails_TransactionNo")},"TransactionID")]})})})})}H.defaultProps={};var z=i(14159),Q=(i(92342),i(63973),i(11981)),q=i(15441),K=i(73571),$=i(61227),Y=i(39424),J=i(80297);class Z extends a.Component{constructor(){super(...arguments),this.state={railReceipt:b().cloneDeep(h.cE),receiptItem:{},isShowRightPanel:!1,isDetails:"false",isRecordWeight:"false",isViewAuditTrail:"false",isViewUnloadingDetails:"false",isMunalEntry:"false",isLoadSpotAssign:!1,ViewUnloadingData:[],ViewUnloadingHideFields:[],isReadyToRender:!1,isOperation:!1,reason:"",isDetailsModified:"false",operationsVisibilty:{add:!1,delete:!1,shareholder:!1},selectedRow:{},selectedItems:[],selectedShareholder:"",data:{},loadingDetails:[],loadingDetailsHideFields:[],fromDate:new Date,toDate:new Date,dateError:"",terminalCodes:[],openReceipt:!1,railReceiptBtnCloseOK:!1,NextOperations:[],currentStatuses:[],lastStatus:"",railReceiptType:"",modWeight:{},viewTab:0,validationErrors:u.Th(x.zw),enableHSEInspection:!0,attributeRailReceiptDataList:[],selectedAttributeList:[],attributeValidationErrors:[],saveEnabled:!1,tabActiveIndex:0,railLookUpData:{},showReport:!1,drawerStatus:!1,currentAccess:{},railReceiptKPIList:[],railReceiptDeleteStates:[],activityInfo:[],showDeleteAuthenticationLayout:!1,showAuthorizeToUnLoadAuthenticationLayout:!1,showCloseReceiptAuthenticationLayout:!1,showViewBODAuthenticationLayout:!1,showPrintBODAuthenticationLayout:!1,showRANAuthenticationLayout:!1},this.componentName="RailReceiptComponent",this.handleAdd=()=>{try{var{operationsVisibilty:e}={...this.state};e.delete=!1,e.add=!1,e.shareholder=!1,this.setState({isDetails:"true",selectedRow:{},operationsVisibilty:e,viewTab:0,isShowRightPanel:!1,drawerStatus:!1})}catch(t){console.log("RailDisatchComposite:Error occured on handleAdd")}},this.handleDelete=()=>{this.handleAuthenticationClose();try{var{operationsVisibilty:e}={...this.state};e.delete=!1,this.setState({operationsVisibilty:e});for(var t=[],i=0;i<this.state.selectedItems.length;i++){var a=this.state.selectedItems[i].Common_Code,s=this.state.selectedShareholder,o={ShareHolderCode:s,KeyCodes:[{Key:v.eT,Value:a}]};t.push(o)}T()(R.mPc,u.tW(t,this.props.tokenDetails.tokenInfo)).then((t=>{var i=t.data,a=i.IsSuccess;null!==t.data.ResultDataList&&void 0!==i.ResultDataList&&(a=i.ResultDataList.filter((function(e){return!e.IsSuccess})).length!==i.ResultDataList.length);var o=u.Cy(i,"RailReceipt_DeletionStatus",["RailReceiptCode"]);null!==i.ErrorList&&void 0!==i.ErrorList&&i.ErrorList.length>0&&0===o.messageResultDetails.length&&(o.message="ERRMSG_EXCEPTION_IN_WEBAPI"===i.ErrorList[0]?"CannotDeleteRailTransaction":i.ErrorList[0],o.messageType=i.IsSuccess?"success":"critical"),a&&(this.setState({isReadyToRender:!1}),this.getRailReceiptList(s),this.getKPIList(),e.delete=!1,this.setState({selectedItems:[],isShowRightPanel:!1,operationsVisibilty:e,selectedRow:{}})),o.messageResultDetails.forEach((e=>{e.keyFields.length>0&&(e.keyFields[0]="RailReceipt_Code")})),(0,z.toast)((0,r.jsx)(p.A,{children:(0,r.jsx)(Q.A,{notificationMessage:o})}),{autoClose:"success"===o.messageType&&1e4})})).catch((e=>{throw e}))}catch(n){console.log("RailReceiptComposite:Error occured on handleDelete")}},this.handleRangeSelect=e=>{let{to:t,from:i}=e;void 0!==t&&this.setState({toDate:t}),void 0!==i&&this.setState({fromDate:i})},this.handleDateTextChange=(e,t)=>{""===e&&this.setState({dateError:"",toDate:"",fromDate:""}),null!==t&&""!==t?this.setState({dateError:"Common_InvalidDate",toDate:"",fromDate:""}):this.setState({dateError:"",toDate:e.to,fromDate:e.from})},this.handleLoadOrders=()=>{let e=u.wb(this.state.toDate,this.state.fromDate);""!==e?this.setState({dateError:e}):(this.setState({dateError:""}),this.getRailReceiptList(this.state.selectedShareholder))},this.handleBack=()=>{try{var{operationsVisibilty:e}={...this.state};e.add=u.ab(this.props.userDetails.EntityResult.FunctionsList,w.i.add,w.hD);let t=b().cloneDeep(this.state.selectedRow);e.delete="READY"===t.ReceiptStatus,e.shareholder=!0;let i=b().cloneDeep(this.state.isRecordWeight),a=b().cloneDeep(this.state.isDetails),s=b().cloneDeep(this.state.isViewAuditTrail),o=b().cloneDeep(this.state.isViewUnloadingDetails),r=b().cloneDeep(this.state.isMunalEntry),n=b().cloneDeep(this.state.isLoadSpotAssign);this.getKPIList(),"true"===a?"true"===r||"true"===i||"true"===s||"true"===o||n?this.setState({isReadyToRender:!1,isShowRightPanel:!0,isDetails:"true",isRecordWeight:"false",isViewAuditTrail:"false",isViewUnloadingDetails:"false",isMunalEntry:"false",isLoadSpotAssign:!1,operationsVisibilty:e,drawerStatus:!1}):(e.delete=!1,this.setState({isReadyToRender:!1,isShowRightPanel:!1,isDetails:"false",isRecordWeight:"false",isViewAuditTrail:"false",isViewUnloadingDetails:"false",isMunalEntry:"false",isLoadSpotAssign:!1,selectedRow:{},selectedItems:[],operationsVisibilty:e,drawerStatus:!1}),this.getRailReceiptList(this.state.selectedShareholder)):(this.setState({isReadyToRender:!1,isDetails:"false",isRecordWeight:"false",isViewAuditTrail:"false",isViewUnloadingDetails:"false",isMunalEntry:"false",isLoadSpotAssign:!1,operationsVisibilty:e,isShowRightPanel:!1,selectedRow:{},selectedItems:[],drawerStatus:!1}),this.getRailReceiptList(this.state.selectedShareholder))}catch(t){console.log("RailReceiptComposite:Error occured on Back click",t)}},this.handleRowClick=e=>{try{var{operationsVisibilty:t,activityInfo:i}={...this.state};t.add=u.ab(this.props.userDetails.EntityResult.FunctionsList,w.i.add,w.hD);let s=i.filter((e=>e.ActivityCode===D.eR.RAIL_RECEIPT_ENABLE_DELETE&&e.ActionTypeCode===D.Gd.CHECK));var a=[];void 0!==s&&s.length>0&&(a=s[0].ReceiptStates),t.delete=!this.props.userDetails.EntityResult.IsWebPortalUser&&(a.indexOf(e.ReceiptStatus.toUpperCase())>-1&&u.ab(this.props.userDetails.EntityResult.FunctionsList,w.i.remove,w.hD)),t.shareholder=!1,this.getRailReceiptOperations(e),this.getRailReceiptAllChangeStatus(e),this.setState({isDetails:"true",saveEnabled:!0,selectedRow:e,selectedItems:[e],operationsVisibilty:t,isShowRightPanel:!0,viewTab:0,detailEnable:!0,drawerStatus:!1})}catch(s){console.log("RailReceiptComposite:Error occured on handleRowClick",s)}},this.handleSelection=e=>{try{const s=b().cloneDeep(this.state.operationsVisibilty);var{drawerStatus:t,activityInfo:i}={...this.state};let o=i.filter((e=>e.ActivityCode===D.eR.RAIL_RECEIPT_ENABLE_DELETE&&e.ActionTypeCode===D.Gd.CHECK));var a=[];void 0!==o&&o.length>0&&(a=o[0].ReceiptStates);let r=!(e.findIndex((e=>a.indexOf(e.ReceiptStatus.toUpperCase())<0))>=0);s.delete=!this.props.userDetails.EntityResult.IsWebPortalUser&&(r&&e.length>0&&u.ab(this.props.userDetails.EntityResult.FunctionsList,w.i.remove,w.hD)),s.shareholder=!1,t=1!==e.length,this.setState({isShowRightPanel:!0,selectedItems:e,operationsVisibilty:s,isOperation:!1,drawerStatus:t}),1===e.length?(this.getRailReceiptOperations(e[0]),this.getRailReceiptAllChangeStatus(e[0]),this.setState({isOperation:!0})):this.setState({isShowRightPanel:!1,selectedItems:e,operationsVisibilty:s,isOperation:!1})}catch(s){console.log("RailReceiptSComposite: Error occurred on handleSelection",s)}},this.handleUpdateStatusOperation=e=>{const t={Common_Code:e.ReceiptCode,ReceiptStatus:e.ReceiptStatus,AssociatedTerminals:e.TerminalCodes,AcutalTerminalCode:e.ActualTerminalCode};this.setState({selectedItems:[t],selectedRow:t},(()=>{this.getRailReceiptOperations(t),this.getRailReceiptAllChangeStatus(t)})),this.setState({isOperation:!0})},this.getRailReceiptOperations=e=>{var t=e.AcutalTerminalCode;null!==t&&void 0!==t||1===this.state.selectedItems.length&&(t=this.state.selectedItems[0].AcutalTerminalCode);var i={Reason:"",ReceiptCode:e.Common_Code,ReceiptStatus:e.ReceiptStatus};try{T()(R.j49,u.tW(i,this.props.tokenDetails.tokenInfo)).then((i=>{var a=i.data;if(!0===a.IsSuccess){const i={ViewRailReceipt_Delete:!1,ViewRailReceipt_Update:!1},s=["ViewRailReceipt_Update","ViewRailReceipt_Delete","ViewRailReceipt_AuthorizeToUnLoad","ViewRailReceipt_PrintRAN","ViewRailReceipt_RecordWeight","ViewRailReceipt_LoadSpotAssign","ViewRailReceipt_ManualEntry","ViewRailReceipt_ViewLoadingDetails","ViewRailReceipt_ViewAuditTrail","ViewRailReceipt_CloseReceipt","ViewRailReceipt_ViewBOD","ViewRailReceipt_PrintBOD","ViewRailReceipt_BSIOutbound"],o=[];for(let r of s)if("ViewRailReceipt_Update"!==r&&"ViewRailReceipt_Delete"!==r)if("ViewRailReceipt_PrintRAN"!==r||!0!==a.EntityResult[r])if("ViewRailReceipt_PrintBOD"!==r||!0!==a.EntityResult[r]){if("ViewRailReceipt_LoadSpotAssign"===r){if(!this.props.userDetails.EntityResult.IsEnterpriseNode&&"READY"!==e.ReceiptStatus&&null===t)continue;!0===a.EntityResult[r]&&o.push(r)}else if(!0===a.EntityResult[r]){if(("ViewRailReceipt_CloseReceipt"===r||"ViewRailReceipt_RecordWeight"===r||"ViewRailReceipt_ManualEntry"===r)&&!this.props.userDetails.EntityResult.IsEnterpriseNode&&t!==this.props.userDetails.EntityResult.TerminalCode)continue;o.push(r)}}else this.props.userDetails.EntityResult.IsWebPortalUser||o.push(r),o.push("ViewRailReceipt_ViewBOD");else this.props.userDetails.EntityResult.IsWebPortalUser||o.push(r);else{let e=this.state.operationsVisibilty;"ViewRailReceipt_Update"===r&&(i.ViewRailReceipt_Update=a.EntityResult[r]),"ViewRailReceipt_Delete"===r&&(i.ViewRailReceipt_Delete=a.EntityResult[r],e.delete=a.EntityResult[r]),this.setState({operationsVisibilty:e})}e.ReceiptStatus!==D.a$.CLOSED||!this.props.userDetails.EntityResult.IsBSIEnabledLicense||this.props.userDetails.EntityResult.IsArchived||this.props.userDetails.EntityResult.IsWebPortalUser||o.push("ViewRailReceipt_BSIOutbound"),this.setState({NextOperations:o,currentAccess:i})}else console.log("Error in getRailReceiptOperations:",a.ErrorList)}))}catch(a){console.log("Error while getting RailReceipt Operations List:",a)}},this.savedEvent=(e,t,i)=>{try{var{operationsVisibilty:a,activityInfo:s}={...this.state};let l=s.filter((e=>e.ActivityCode===D.eR.RAIL_RECEIPT_ENABLE_DELETE&&e.ActionTypeCode===D.Gd.CHECK));var o=[];if(void 0!==l&&l.length>0&&(o=l[0].ReceiptStates),"success"===i.messageType&&(a.add=u.ab(this.props.userDetails.EntityResult.FunctionsList,w.i.add,w.hD),a.delete=!this.props.userDetails.EntityResult.IsWebPortalUser&&(o.indexOf(e.ReceiptStatus.toUpperCase())>-1&&u.ab(this.props.userDetails.EntityResult.FunctionsList,w.i.remove,w.hD)),this.setState({isDetailsModified:"true",operationsVisibilty:a})),"success"===i.messageType&&"add"===t){var n=[{RailReceiptCode:e.ReceiptCode,Common_Shareholder:e.ShareholderCode}];this.setState({selectedItems:n,isShowRightPanel:!0})}(0,z.toast)((0,r.jsx)(p.A,{children:(0,r.jsx)(Q.A,{notificationMessage:i})}),{autoClose:"success"===i.messageType&&1e4})}catch(l){console.log("RailReceiptComposite:Error occured on savedEvent",l)}},this.getLookUpData=(e,t)=>{T()(R.xAA+"?LookUpTypeCode="+e,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const i=e.data;!0===i.IsSuccess?t(i.EntityResult):console.log("Error in getLookUpData: ",i.ErrorList)})).catch((e=>{console.log("RailReceiptComposite: Error occurred on getLookUpData",e)}))},this.componentWillUnmount=()=>{this.clearStorage(),window.removeEventListener("beforeunload",this.clearStorage)},this.clearStorage=()=>{sessionStorage.removeItem(this.componentName+"GridState")},this.handleShareholderSelectionChange=e=>{try{this.setState({selectedShareholder:e}),this.getRailReceiptList(e)}catch(t){console.log("RailReceiptComposite:Error occured on handleShareholderSelectionChange",t)}},this.handleOperationClick=e=>{let t=b().cloneDeep(this.state.modWeight);var{operationsVisibilty:i}={...this.state};e===D.Fj.ViewRailReceipt_AuthorizeToUnload?this.authorizeToUnLoadClick():e===D.Fj.ViewRailReceipt_RecordWeight?(i.add=!1,i.delete=!1,this.handleRecordWeight(t)):e===D.Fj.ViewRailReceipt_CloseReceipt?this.setState({openReceipt:!0}):e===D.Fj.ViewRailReceipt_ViewAuditTrail?(i.add=!1,i.delete=!1,this.handleViewAuditTrail()):e===D.Fj.ViewRailReceipt_ViewLoadingDetails?(i.add=!1,i.delete=!1,this.handleViewUnLoadingDetails()):e===D.Fj.ViewRailReceipt_PrintRAN?this.printRANClick():e===D.Fj.ViewRailReceipt_ViewBOD?(i.add=!1,this.viewBODClick()):e===D.Fj.ViewRailReceipt_PrintBOD?this.printBODClick():e===D.Fj.ViewRailReceipt_BISOutbound?this.handleBSIOutbound(this.state.selectedItems[0].Common_Code):e===D.Fj.ViewRailReceipt_ManualEntry?(i.add=!1,i.delete=!1,this.handleRailReceiptManualEntry()):e===D.Fj.ViewRailReceipt_LoadSpotAssign&&(i.add=!1,i.delete=!1,this.handleLoadSpotAssign()),this.setState({operationsVisibilty:i})},this.authorizeToUnLoadClick=()=>{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showAuthorizeToUnLoadAuthenticationLayout:e},(()=>{!1===e&&this.handleAuthorizeToLoad()}))},this.handleAuthorizeToUnload=()=>{this.handleAuthenticationClose();let e=this.state.selectedItems[0].Common_Code,t=this.state.selectedItems[0].ReceiptStatus;var i=this.state.selectedShareholder;let a=[{key:v.eT,value:e}];let s={ReceiptCode:e,ReceiptStatus:t,TmWebApiRequest:{ShareHolderCode:i,KeyCodes:a}};var o={messageType:"success",message:"ViewRailReceipt_AuthorizeLoad_status",messageResultDetails:[{keyFields:["Receipt_Code"],keyValues:[e],isSuccess:!0,errorMessage:""}]};T()(R.iYX,u.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){const e=b().cloneDeep(this.state.selectedRow);"true"===this.state.isDetails?e.ReceiptStatus=D.Mw.CHECKED_IN:this.getRailReceiptList(i),this.setState({selectedRow:e},(()=>{this.savedEvent(e,"",o)}))}else o.messageType="critical",o.messageResultDetails[0].isSuccess=!1,o.messageResultDetails[0].errorMessage=t.ErrorList[0],this.savedEvent("","",o),console.log("Error in AuthorizeToUnLoad:",t.ErrorList)})).catch((e=>{console.log("Error while AuthorizeToUnLoad:",e)}))},this.handleCloseReceipt=()=>{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showCloseReceiptAuthenticationLayout:e},(()=>{!1===e&&this.closeRailDispatch()}))},this.closeRailDispatch=()=>{this.handleAuthenticationClose();try{var e=this.state.selectedShareholder;this.setState({railReceiptBtnCloseOK:!0}),setTimeout((()=>{this.setState({railReceiptBtnCloseOK:!1})}),3600);var t=b().cloneDeep(this.state.selectedItems[0]);let a=[{key:v.eT,value:t.Common_Code}],s={Reason:this.state.reason,ReceiptCode:t.Common_Code,ReceiptStatus:t.ReceiptStatus};const o={ShareHolderCode:e,KeyCodes:a,Entity:s};var i={messageType:"success",message:"ViewRailReceipt_CloseReceipt_status",messageResultDetails:[{keyFields:["Receipt_Code"],keyValues:[t.Common_Code],isSuccess:!0,errorMessage:""}]};T()(R.wjv,u.tW(o,this.props.tokenDetails.tokenInfo)).then((t=>{if(t.data.IsSuccess){const t=b().cloneDeep(this.state.selectedRow);"true"===this.state.isDetails?t.ReceiptStatus=D.Mw.CLOSED:this.getRailReceiptList(e),this.setState({openReceipt:!1,selectedRow:t},(()=>this.savedEvent(t,"",i)))}else i.messageType="critical",i.messageResultDetails[0].isSuccess=!1,i.messageResultDetails[0].errorMessage=t.data.ErrorList[0],this.savedEvent("","",i)}))}catch(a){}},this.printRANClick=()=>{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showRANAuthenticationLayout:e},(()=>{!1===e&&this.handlePrintRAN()}))},this.handlePrintRAN=()=>{this.handleAuthenticationClose();var e=this.state.selectedShareholder;let t=this.state.selectedItems[0].Common_Code;const i={ShareHolderCode:e,KeyCodes:[{key:v.eT,value:t}]},a={messageType:"critical",message:"ShipmentCompDetail_PrintStatus",messageResultDetails:[{keyFields:["Receipt_Code"],keyValues:[t],isSuccess:!1,errorMessage:""}]};T()(R.ZXx,u.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;a.messageType=t.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=t.IsSuccess,!0!==t.IsSuccess&&(a.messageResultDetails[0].errorMessage=t.ErrorList[0],console.log("Error in handlePrintRAN: ",t.ErrorList)),this.handleNotify(a)})).catch((e=>{console.log("Error while handlePrintRAN: ",e)}))},this.handleModalBack=()=>{this.setState({showReport:!1})},this.viewBODClick=()=>{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showViewBODAuthenticationLayout:e},(()=>{!1===e&&this.handleViewBOD()}))},this.handleViewBOD=()=>{this.handleAuthenticationClose(),void 0===this.reportServiceURI?T()(R.yTV,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{e.data.IsSuccess&&(this.reportServiceURI=e.data.EntityResult,this.setState({showReport:!0}))})):this.setState({showReport:!0})},this.printBODClick=()=>{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showPrintBODAuthenticationLayout:e},(()=>{!1===e&&this.handlePrintBOD()}))},this.handlePrintBOD=()=>{this.handleAuthenticationClose();var e=this.state.selectedShareholder;let t=this.state.selectedItems[0].Common_Code;const i={ShareHolderCode:e,KeyCodes:[{key:v.eT,value:t}]},a={messageType:"critical",message:"ShipmentCompDetail_PrintStatus",messageResultDetails:[{keyFields:["Receipt_Code"],keyValues:[t],isSuccess:!1,errorMessage:""}]};T()(R.NHY,u.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;a.messageType=t.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=t.IsSuccess,!0!==t.IsSuccess&&(a.messageResultDetails[0].errorMessage=t.ErrorList[0],console.log("Error in handlePrintBOD: ",t.ErrorList)),this.handleNotify(a)})).catch((e=>{console.log("Error while handlePrintBOD: ",e)}))},this.handleManualEntryTabChange=e=>{try{this.setState({manualEntryTabActiveIndex:e})}catch(t){console.log("RailDispatchDetailsComposite: Error occurred on handleManualEntryTabChange",t)}},this.handleDrawer=()=>{var e=b().cloneDeep(this.state.drawerStatus);this.setState({drawerStatus:!e})},this.authenticateDelete=()=>{try{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showDeleteAuthenticationLayout:e}),!1===e&&this.handleDelete()}catch(e){console.log("Marine Shipment Composite : Error in authenticateDelete")}},this.handleAuthenticationClose=()=>{this.setState({showDeleteAuthenticationLayout:!1,showAuthorizeToUnLoadAuthenticationLayout:!1,showCloseReceiptAuthenticationLayout:!1,showViewBODAuthenticationLayout:!1,showPrintBODAuthenticationLayout:!1,showRANAuthenticationLayout:!1})}}getRailReceiptAllChangeStatus(e){var t={Reason:"",ReceiptCode:e.Common_Code,ReceiptStatus:e.ReceiptStatus};try{T()(R.QsL,u.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({currentStatuses:t.EntityResult}):console.log("Error in getRailReceiptAllChangeStatus: ",t.ErrorList)})).catch((e=>{console.log("Error while getRailReceiptAllChangeStatus:",e)}))}catch(i){console.log(i)}}getRailReceiptList(e){try{this.setState({isReadyToRender:!1});let t=new Date(this.state.fromDate),i=new Date(this.state.toDate);t.setHours(0,0,0),i.setHours(23,59,59);let a={startRange:t,endRange:i,TransportationType:D.LY.RAIL,ShareHolderCode:e};T()(R.cXH,u.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;!0===t.IsSuccess?this.setState({data:t.EntityResult,isReadyToRender:!0},(()=>{if(1===this.state.selectedItems.length){const i=this.state.selectedItems[0],a=t.EntityResult.Table.filter((e=>e.Common_Code===i.Common_Code));let{operationsVisibilty:s,activityInfo:o}={...this.state},r=o.filter((e=>e.ActivityCode===D.eR.RAIL_RECEIPT_ENABLE_DELETE&&e.ActionTypeCode===D.Gd.CHECK));var e=[];void 0!==r&&r.length>0&&(e=r[0].ReceiptStates),s.delete=!this.props.userDetails.EntityResult.IsWebPortalUser&&(e.indexOf(a[0].ReceiptStatus.toUpperCase())>-1&&u.ab(this.props.userDetails.EntityResult.FunctionsList,w.i.remove,w.hD)),"true"===this.state.isDetails?this.setState({selectedItems:a,selectedRow:a[0],operationsVisibilty:s}):(this.getRailReceiptOperations(a[0]),this.getRailReceiptAllChangeStatus(a[0]),this.setState({selectedItems:a,operationsVisibilty:s}))}})):(this.setState({data:[],isReadyToRender:!0}),console.log("Error in GetRailReceiptListForRole:",t.ErrorList))})).catch((e=>{this.setState({data:[],isReadyToRender:!0}),console.log("Error while geting RailReceipt List:",e)}))}catch(t){this.setState({isReadyToRender:!0}),console.log(t)}}componentDidMount(){try{u.pJ(this.props.userDetails.EntityResult.IsArchived);var{operationsVisibilty:e}={...this.state};e.add=u.ab(this.props.userDetails.EntityResult.FunctionsList,w.i.add,w.hD),this.setState({operationsVisibilty:e,selectedShareholder:this.props.userDetails.EntityResult.PrimaryShareholder}),this.getLookUpData("HSEInspection",(e=>{this.setState({enableHSEInspection:"True"===e.EnableRail})})),this.getLookUpData("Rail",(e=>{this.setState({railLookUpData:e})})),this.getTerminalsList(this.props.userDetails.EntityResult.PrimaryShareholder),this.getRailReceiptList(this.props.userDetails.EntityResult.PrimaryShareholder),this.getKPIList(),this.GetReceiptActivityInfo()}catch(t){console.log("RailReceiptComposite:Error occured on componentDidMount",t)}window.addEventListener("beforeunload",this.clearStorage)}GetReceiptActivityInfo(){try{T()(R.sF1,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{e.data.IsSuccess&&this.setState({activityInfo:e.data.EntityResult})})).catch((e=>{console.log("Error while getting receipt activityInfo:",e)}))}catch(e){console.log("Error in GetReceiptActivityInfo:",e)}}getTerminalsList(e){try{null!==e&&""!==e?T()(R.Oqv,u.tW([e],this.props.tokenDetails.tokenInfo)).then((e=>{e.data.IsSuccess&&this.setState({terminalCodes:e.data.EntityResult})})):this.setState({terminalCodes:[]})}catch(t){console.log("DestinationComposite:Error occured on getTerminalsList",t)}}getTransportationType(){var e=D.LY.RAIL;const{itemProps:t}=this.props.activeItem;return void 0!==t&&void 0!==t.transportationType&&(e=t.transportationType),e}handleNotify(e){try{(0,z.toast)((0,r.jsx)(p.A,{children:(0,r.jsx)(Q.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})}catch(t){console.log("RailDispatchComposite: Error occurred on handleNotify",t)}}onFieldChange(e,t){try{const i=b().cloneDeep(this.state.validationErrors);if(this.setState({reason:t}),void 0!==x.zw[e])return i[e]=u.jr(x.zw[e],t),this.setState({validationErrors:i}),""===i.Reason||void 0===i.Reason}catch(i){console.log("railReceiptDetailsComposite:Error occured on handleChange",i)}}handleRecordWeight(){this.setState({isRecordWeight:"true"})}handleViewAuditTrail(){var{operationsVisibilty:e}={...this.state};e.add=!1,this.setState({isViewAuditTrail:"true",saveEnabled:!1,operationsVisibilty:e})}handleViewUnLoadingDetails(){var e=this.state.selectedShareholder,t=b().cloneDeep(this.state.selectedItems[0]);const i={ShareHolderCode:e,KeyCodes:[{key:v.eT,value:t.Common_Code}]};let a={Reason:this.state.reason,ReceiptCode:t.Common_Code,ReceiptStatus:t.ReceiptStatus,TmWebApiRequest:i};T()(R.mI3,u.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({isViewUnloadingDetails:"true",ViewUnloadingData:t.EntityResult}):console.log("Error in viewUnLoadingDetails:",t.ErrorList)})).catch((e=>{console.log("Error while viewUnLoadingDetails:",e)}))}renderReportModal(){let e=null;e=this.props.userDetails.EntityResult.IsArchived?"TM/"+D.mD+"/RailBOD":"TM/"+D.PZ+"/RailBOD";let t={Culture:this.props.userDetails.EntityResult.UICulture,ShareholderCode:this.state.selectedShareholder,RailReceiptCode:1===this.state.selectedItems.length?this.state.selectedItems[0].Common_Code:this.state.selectedRow.Common_Code};return(0,r.jsx)(K.A,{showReport:this.state.showReport,handleBack:this.handleModalBack,handleModalClose:this.handleModalBack,proxyServerHost:R._Oi,reportServiceHost:this.reportServiceURI,filePath:e,parameters:t})}handleBSIOutbound(e){const t={ShareHolderCode:this.state.selectedShareholder,KeyCodes:[{key:v.eT,value:e}]},i={messageType:"critical",message:"ViewRailReceipt_BSIOutbound_status",messageResultDetails:[{keyFields:["Receipt_Code"],keyValues:[e],isSuccess:!1,errorMessage:""}]};T()(R.$4j,u.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;i.messageType=t.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=t.IsSuccess,!0!==t.IsSuccess&&(i.messageResultDetails[0].errorMessage=t.ErrorList[0],console.log("Error in handleBSIOutbound: ",t.ErrorList)),this.handleNotify(i)})).catch((e=>{console.log("Error while handleBSIOutbound: ",e)}))}handleRailReceiptManualEntry(){this.setState({isMunalEntry:"true"})}handleLoadSpotAssign(){this.setState({isLoadSpotAssign:!0})}renderModal(){return(0,r.jsx)(d.TranslationConsumer,{children:e=>(0,r.jsxs)(c.Modal,{onClose:()=>this.setState({openReceipt:!1}),size:"mini",open:this.state.openReceipt,closeOnDimmerClick:!1,children:[(0,r.jsxs)(c.Modal.Content,{children:[(0,r.jsx)("div",{className:"ViewMarineReceiptCloseHeader",children:(0,r.jsxs)("b",{children:[" ",e("Receipt_ForceCloseHeader")]})}),(0,r.jsx)("div",{children:(0,r.jsx)(c.Input,{fluid:!0,value:this.state.reason,indicator:"required",onChange:e=>this.onFieldChange("Reason",e),label:e("Receipt_ForceCloseHeader"),error:e(this.state.validationErrors.Reason)})})]}),(0,r.jsxs)(c.Modal.Footer,{children:[(0,r.jsx)(c.Button,{type:"primary",size:"small",content:e("ViewMarineReceiptList_Ok"),onClick:()=>{this.handleCloseReceipt()},disabled:this.state.railReceiptBtnCloseOK}),(0,r.jsx)(c.Button,{type:"primary",size:"small",content:e("ViewMarineReceiptList_Cancel"),onClick:()=>this.setState({openReceipt:!1})})]})]})})}getKPIList(){if(!0===u.ab(this.props.userDetails.EntityResult.FunctionsList,w.i.view,w.bL)){var e={message:"",messageType:"critical",messageResultDetails:[]};let t={PageName:Y.ZN,InputParameters:[]};T()(R.dxq,u.tW(t,this.props.tokenDetails.tokenInfo)).then((t=>{var i=t.data;!0===i.IsSuccess?this.setState({railReceiptKPIList:i.EntityResult.ListKPIDetails}):(this.setState({railReceiptKPIList:[]}),console.log("Error in Rail Receipt KPIList:",i.ErrorList),e.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:i.ErrorList[0]})),e.messageResultDetails.length>0&&(0,z.toast)((0,r.jsx)(p.A,{children:(0,r.jsx)(Q.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})})).catch((e=>{console.log("Error while getting Rail Receipt KPIList:",e)}))}}getFunctionGroupName(){return this.state.showDeleteAuthenticationLayout?w.hD:this.state.showCloseReceiptAuthenticationLayout?w.fF:this.state.showAuthorizeToUnLoadAuthenticationLayout?w.Al:this.state.showViewBODAuthenticationLayout||this.state.showPrintBODAuthenticationLayout?w.rj:this.state.showRANAuthenticationLayout?w.jx:void 0}getDeleteorEditMode(){return this.state.showDeleteAuthenticationLayout?w.i.remove:w.i.modify}handleOperation(){return this.state.showDeleteAuthenticationLayout?this.handleDelete:this.state.showAuthorizeToUnLoadAuthenticationLayout?this.handleAuthorizeToUnload:this.state.showCloseReceiptAuthenticationLayout?this.closeRailDispatch:this.state.showRANAuthenticationLayout?this.handlePrintRAN:this.state.showViewBODAuthenticationLayout?this.handleViewBOD:this.state.showPrintBODAuthenticationLayout?this.handlePrintBOD:void 0}render(){return(0,r.jsxs)("div",{children:[this.renderModal(),(0,r.jsx)(p.A,{children:(0,r.jsx)(s.$,{operationsVisibilty:this.state.operationsVisibilty,breadcrumbItem:this.props.activeItem,shareholders:this.props.userDetails.EntityResult.ShareholderList,selectedShareholder:this.state.selectedShareholder,onShareholderChange:this.handleShareholderSelectionChange,onAdd:this.handleAdd,onDelete:this.authenticateDelete,shrVisible:!1,handleBreadCrumbClick:this.props.handleBreadCrumbClick})}),"true"===this.state.isRecordWeight?(0,r.jsx)(p.A,{children:(0,r.jsx)(O.default,{Key:"RailReceiptRecordWeightDetails",selectedRow:this.state.selectedItems[0],shareholderCode:this.state.selectedShareholder,handleBack:this.handleBack,onSaved:this.savedEvent})}):"true"===this.state.isViewAuditTrail?(0,r.jsx)(p.A,{children:(0,r.jsx)(F.default,{Key:"RailReceiptViewAuditTrailDetails",selectedRow:this.state.selectedItems[0],shareholderCode:this.state.selectedShareholder,handleBack:this.handleBack,onSaved:this.savedEvent})}):"true"===this.state.isViewUnloadingDetails?(0,r.jsxs)("div",{children:[(0,r.jsx)(p.A,{children:(0,r.jsx)(d.TranslationConsumer,{children:e=>(0,r.jsx)(k.A,{newEntityName:e("ViewRailReceiptUnloading_Title")})})}),(0,r.jsx)(p.A,{children:(0,r.jsx)(H,{tableData:this.state.ViewUnloadingData.Table})}),(0,r.jsx)(p.A,{children:(0,r.jsx)(d.TranslationConsumer,{children:e=>(0,r.jsx)("div",{className:"row",children:(0,r.jsx)("div",{className:"col",style:{textAlign:"left"},children:(0,r.jsx)(c.Button,{className:"backButton",onClick:()=>this.handleBack(),content:e("Back")})})})})})]}):this.state.isLoadSpotAssign?(0,r.jsx)("div",{children:(0,r.jsx)(p.A,{children:(0,r.jsx)(G,{onSaved:this.savedEvent,selectedRow:this.state.selectedItems[0],selectedShareholder:this.state.selectedShareholder,onBack:this.handleBack})})}):"true"===this.state.isMunalEntry?(0,r.jsx)("div",{children:(0,r.jsx)(p.A,{children:(0,r.jsx)(M,{onSaved:this.savedEvent,selectedRow:this.state.selectedItems[0],selectedShareholder:this.state.selectedShareholder,onBack:this.handleBack})})}):"true"===this.state.isDetails?(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:this.state.isShowRightPanel?this.state.drawerStatus?"drawerClose":"showShipmentStatusRightPane":"",children:(0,r.jsx)(p.A,{children:(0,r.jsx)(l.default,{Key:"RailReceiptDetails",selectedRow:this.state.selectedRow,selectedShareholder:this.state.selectedShareholder,onBack:this.handleBack,onSaved:this.savedEvent,enableHSEInspection:this.state.enableHSEInspection,handleOperationClick:this.handleOperationClick,onUpdateStatusOperation:this.handleUpdateStatusOperation,terminalCodes:this.state.terminalCodes,genericProps:this.props.activeItem.itemProps,railLookUpData:this.state.railLookUpData,currentAccess:this.state.currentAccess})})}),this.state.isShowRightPanel?(0,r.jsx)("div",{className:this.state.drawerStatus?"marineStatusLeftPane":"",children:(0,r.jsx)($.A,{selectedItem:this.state.selectedItems,shipmentNextOperations:this.state.NextOperations,handleDetailsPageClick:this.handleRowClick,handleOperationButtonClick:this.handleOperationClick,currentStatuses:this.state.currentStatuses,isDetails:this.state.isDetails,handleDrawer:this.handleDrawer,isWebPortalUser:this.props.userDetails.EntityResult.IsWebPortalUser,title:"ViewAllShipment_Details",unAllowedOperations:[],webPortalAllowedOperations:["ViewRailReceipt_ViewLoadingDetails","ViewRailReceipt_ViewAuditTrail","ViewRailReceipt_ViewBOD"]})}):null]}):(0,r.jsxs)("div",{children:[(0,r.jsx)(p.A,{children:(0,r.jsx)("div",{className:"kpiSummaryContainer",children:(0,r.jsx)(J.A,{kpiList:this.state.railReceiptKPIList,pageName:"RailReceipt"})})}),(0,r.jsxs)("div",{className:this.state.isShowRightPanel?this.state.drawerStatus?"drawerClose":"showShipmentStatusRightPane":"",children:[(0,r.jsx)(p.A,{children:(0,r.jsx)(q.L,{dateRange:{from:this.state.fromDate,to:this.state.toDate},dateError:this.state.dateError,handleDateTextChange:this.handleDateTextChange,handleRangeSelect:this.handleRangeSelect,handleLoadOrders:this.handleLoadOrders,filterText:"LoadReceipts"})}),this.state.isReadyToRender?(0,r.jsx)(p.A,{children:(0,r.jsx)(n,{tableData:this.state.data.Table,columnDetails:this.state.data.Column,pageSize:this.props.userDetails.EntityResult.PageAttibutes.WebPortalListPageSize,exportRequired:!0,exportFileName:"RailReceiptList",columnPickerRequired:!0,terminalsToShow:this.props.userDetails.EntityResult.PageAttibutes.NoOfTerminalsToShow,selectionRequired:!0,columnGroupingRequired:!0,onSelectionChange:this.handleSelection,onRowClick:this.handleRowClick,parentComponent:this.componentName})}):(0,r.jsx)(L.A,{loadingClass:"globalLoader",message:"Loading"})]}),this.state.isShowRightPanel?(0,r.jsx)("div",{className:this.state.drawerStatus?"marineStatusLeftPane":"",children:(0,r.jsx)($.A,{selectedItem:this.state.selectedItems,shipmentNextOperations:this.state.NextOperations,handleDetailsPageClick:this.handleRowClick,handleOperationButtonClick:this.handleOperationClick,currentStatuses:this.state.currentStatuses,isDetails:this.state.isDetails,handleDrawer:this.handleDrawer,isWebPortalUser:this.props.userDetails.EntityResult.IsWebPortalUser,title:"ViewAllReceipt_Details",unAllowedOperations:[],webPortalAllowedOperations:["ViewRailReceipt_ViewLoadingDetails","ViewRailReceipt_ViewAuditTrail","ViewRailReceipt_ViewBOD"]})}):null]}),Object.keys(this.state.selectedRow).length>0||1===this.state.selectedItems.length?this.renderReportModal():"",(0,r.jsx)(p.A,{children:(0,r.jsx)(z.ToastContainer,{hideProgressBar:!0,closeOnClick:!1,closeButton:!0,newestOnTop:!0,position:"bottom-right",toastClassName:"toast-notification-wrap"})}),this.state.showDeleteAuthenticationLayout||this.state.showAuthorizeToUnLoadAuthenticationLayout||this.state.showCloseReceiptAuthenticationLayout||this.state.showViewBODAuthenticationLayout||this.state.showPrintBODAuthenticationLayout||this.state.showRANAuthenticationLayout?(0,r.jsx)(N.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:this.getDeleteorEditMode(),functionGroup:this.getFunctionGroupName(),handleClose:this.handleAuthenticationClose,handleOperation:this.handleOperation()}):null]})}}const X=(0,f.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(Z)},45217:(e,t,i)=>{"use strict";i.d(t,{A:()=>l});i(65043);var a=i(72711),s=i(65187),o=i(67907),r=(i(63973),i(70579));const n=e=>(0,r.jsx)(s.A,{children:(0,r.jsx)(o.TranslationConsumer,{children:t=>(0,r.jsx)("div",{id:"confirmModal",children:(0,r.jsx)(a.Modal,{open:e.isOpen,size:"large",children:(0,r.jsx)(a.Modal.Content,{children:(0,r.jsxs)("div",{style:{textAlign:"center",fontSize:"20px"},children:[(0,r.jsx)("div",{children:(0,r.jsx)("b",{children:t(e.confirmMessage)})}),(0,r.jsxs)("div",{style:{marginTop:"50px"},children:[(0,r.jsx)(a.Button,{type:"secondary",content:t("COMMON_NO"),onClick:()=>e.handleNo()}),(0,r.jsx)(a.Button,{type:"primary",content:t("COMMON_YES"),onClick:()=>e.handleYes()})]})]})})})})})});n.defaultProps={isOpen:!1};const l=n},15441:(e,t,i)=>{"use strict";i.d(t,{L:()=>n});i(65043);var a=i(67907),s=i(72711),o=i(35861),r=i(70579);function n(e){let{handleDateTextChange:t,handleRangeSelect:i,handleLoadOrders:n,dateError:l,dateRange:d,filterText:c}=e;return(0,r.jsx)(a.TranslationConsumer,{children:e=>(0,r.jsxs)("div",{className:"dateRangeContainer",children:[(0,r.jsx)("div",{className:"dateRangeMargin",children:(0,r.jsx)(s.DatePicker,{type:"daterange",closeOnSelection:!0,error:e(l),displayFormat:(0,o.F1)(),rangeValue:d,onTextChange:t,onRangeSelect:i,reserveSpace:!1})}),(0,r.jsx)("div",{className:"dateSearch",children:(0,r.jsx)(s.Button,{content:e(c),onClick:n})})]})})}},73571:(e,t,i)=>{"use strict";i.d(t,{A:()=>p});i(65043);var a=i(72711),s=i(728),o=i(92569),r=i(47766),n=(i(60663),i(7523)),l=i(97508),d=i(70579);function c(e){let{proxyServerHost:t,reportServiceHost:i,parameters:a,filePath:s,...n}=e;const l=t+"api/report",c=(e,t)=>{const i=t.settings.beforeSend;t.settings.beforeSend=function(t){i&&i(t),n.userDetails.EntityResult.IsWebPortalUser||(t.withCredentials=!0),t.URL_DEBUG.indexOf("parameters")>-1&&(t.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var t=e.hostElement;setTimeout((()=>{var e=t.querySelector(".wj-viewer-splitter"),i=t.querySelector(".wj-viewer-tabsleft").querySelectorAll("li")[2];i.disabled||(i.className="hidden",e.click())}),1e3)}})}};let h={Authorization:"Bearer "+n.tokenDetails.tokenInfo};const u=(e,a)=>{r._ReportService.prototype.load=function(e){var a=this,s=new r._Promise;return this._checkReportController(s)?(this.httpRequest(this._getReportInstancesUrl(),{method:"POST",data:e}).then((function(e){var o=r._parseReportExecutionInfo(e.responseText);a._instanceId=o.id,a._status=r._ExecutionStatus.loaded,a._outlinesLocation=o.outlinesLocation,a._statusLocation=o.statusLocation.replace(i,t),a._pageSettingsLocation=o.pageSettingsLocation,a._featuresLocation=o.featuresLocation,a._parametersLocation=o.parametersLocation,s.resolve(o)}),(function(e){s.reject(a._getError(e))})),s):s}};return(0,d.jsx)("div",{children:n.userDetails.EntityResult.IsWebPortalUser?(0,d.jsx)("div",{children:(0,d.jsx)(o.R,{requestHeaders:h,style:{height:"80vh"},parameters:a,serviceUrl:l,filePath:s,initialized:u,beforeSendRequest:c})}):(0,d.jsx)("div",{children:(0,d.jsx)(o.R,{style:{height:"80vh"},parameters:a,serviceUrl:l,filePath:s,initialized:u,beforeSendRequest:c})})})}c.defaultProps={parameters:{}},s.setLicenseKey(n.yQ);const h=(0,l.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(c);var u=i(67907);function p(e){let{proxyServerHost:t,reportServiceHost:i,filePath:s,handleBack:o,showReport:r,handleModalClose:n,parameters:l}=e;const[c]=(0,u.useTranslation)();return(0,d.jsx)(a.Modal,{style:{padding:"0px"},size:"fullscreen",open:r,children:(0,d.jsxs)("div",{children:[(0,d.jsx)(a.Header,{title:c("Header_TerminalManager"),menu:!1}),(0,d.jsx)(h,{proxyServerHost:t,reportServiceHost:i,filePath:s,parameters:l}),(0,d.jsx)("div",{style:{marginTop:"10px",marginLeft:"20px"},children:(0,d.jsx)(a.Button,{className:"backButton",onClick:o,content:c("Report_Back")})})]})})}p.defaultProps={parameters:{}}},80312:(e,t,i)=>{"use strict";i.d(t,{$3:()=>z,$H:()=>ae,$J:()=>pe,$K:()=>Ce,$V:()=>bt,$b:()=>Tt,$p:()=>B,AE:()=>f,Al:()=>k,B2:()=>at,By:()=>ft,CW:()=>Ct,DA:()=>l,Ee:()=>_e,FO:()=>I,Fy:()=>Fe,G9:()=>it,H8:()=>ee,Hq:()=>nt,Ig:()=>M,Iu:()=>R,JI:()=>dt,JJ:()=>te,JU:()=>q,Jz:()=>qe,KQ:()=>re,Kk:()=>Ze,Kw:()=>et,LP:()=>xt,LR:()=>c,Lg:()=>Y,Mg:()=>Te,Mm:()=>F,N1:()=>J,Nm:()=>m,No:()=>de,Ow:()=>W,P2:()=>o,P8:()=>Se,PD:()=>we,PE:()=>h,PG:()=>K,PP:()=>pt,Pb:()=>je,QB:()=>D,QC:()=>Z,RE:()=>ot,RO:()=>Ye,Rc:()=>Rt,Rl:()=>Dt,Rx:()=>gt,TI:()=>S,Tm:()=>me,Ug:()=>X,Ur:()=>Ge,V9:()=>d,VK:()=>G,VL:()=>ue,VQ:()=>ne,WD:()=>Oe,Wf:()=>b,YO:()=>N,YY:()=>Ie,Yb:()=>ge,Yg:()=>ze,Z9:()=>ut,ZE:()=>ct,ZU:()=>T,_N:()=>St,_S:()=>Lt,_d:()=>It,aS:()=>_,aZ:()=>ht,au:()=>Ae,b0:()=>Pt,bL:()=>ke,c2:()=>Ve,d4:()=>Me,dB:()=>g,dD:()=>Be,dK:()=>H,dY:()=>w,de:()=>u,dv:()=>Le,eQ:()=>n,f3:()=>De,fF:()=>O,fL:()=>yt,fN:()=>At,fk:()=>L,fl:()=>Re,fr:()=>E,go:()=>s,h:()=>he,hD:()=>P,hE:()=>x,hh:()=>Xe,hk:()=>oe,hz:()=>mt,i:()=>a,j2:()=>rt,jN:()=>Q,je:()=>C,jx:()=>V,kL:()=>Je,ke:()=>We,km:()=>le,l0:()=>se,l6:()=>He,lz:()=>j,m0:()=>y,nS:()=>ve,nk:()=>lt,nn:()=>A,np:()=>$,oh:()=>st,op:()=>Ke,pt:()=>Ue,qk:()=>ce,qp:()=>ye,r6:()=>Pe,rQ:()=>be,rj:()=>U,rp:()=>r,t3:()=>Et,tM:()=>Ne,to:()=>Nt,ts:()=>tt,uH:()=>Ee,uy:()=>$e,w1:()=>xe,x5:()=>ie,xz:()=>v,y_:()=>Qe,yu:()=>p,yx:()=>vt,z8:()=>fe,z_:()=>wt});const a={view:"view",add:"add",modify:"modify",remove:"remove"},s="carriercompany",o="driver",r="customer",n="trailer",l="originterminal",d="destination",c="primemover",h="vehicle",u="shipmentbycompartment",p="shipmentbyproduct",m="ViewShipmentStatus",C="vessel",g="order",R="OrderForceClose",S="contract",y="receiptplanbycompartment",T="ViewMarineShipment",D="MarineShipmentByCompartment",E="ViewMarineReceipt",A="supplier",f="finishedproduct",v="RailDispatch",P="RailReceipt",b="RailRoute",L="RailWagon",x="CloseRailDispatch",I="PrintRailBOL",w="PrintRailFAN",N="RailDispatchLoadSpotAssignment",j="RailDispatchProductAssignment",M="ViewRailDispatch",F="ViewRailLoadingDetails",O="CloseRailReceipt",U="PrintRailBOD",V="PrintRailRAN",k="ViewRailReceipt",B="ViewRailUnLoadingDetails",_="SMS",W="UnAccountedTransactionTank",G="UnAccountedTransactionMeter",H="PipelineDispatch",z="PipelineReceipt",Q="PipelineDispatchManualEntry",q="PipelineReceiptManualEntry",K="LookUpData",$="HSEInspection",Y="HSEInspectionConfig",J="Email",Z="Shareholder",X="LocationConfig",ee="DeviceConfig",te="baseproduct",ie="SiteView",ae="LeakageManualEntry",se="Terminal",oe="SlotInformation",re="TankGroup",ne="Tank",le="SealMaster",de="TankEODEntry",ce="UnmatchedLocalTransactions",he="AccessCard",ue="ResetPin",pe="SlotConfiguration",me="PrintMarineFAN",Ce="PrintMarineBOL",ge="ViewMarineLoadingDetails",Re="ViewMarineShipmentAuditTrail",Se="CloseMarineShipment",ye="IssueCard",Te="ActivateCard",De="RevokeCard",Ee="AutoIDAssociation",Ae="MarineReceiptByCompartment",fe="PrintMarineRAN",ve="PrintMarineBOD",Pe="ViewMarineUnloadingDetails",be="ViewMarineReceiptAuditTrail",Le="CloseMarineReceipt",xe="WeekendConfig",Ie="EODAdmin",we="PrintBOL",Ne="PrintFAN",je="PrintBOD",Me="CloseShipment",Fe="CloseReceipt",Oe="CONTRACTFORCECLOSE",Ue="Captain",Ve="OverrideShipmentSequence",ke="KPIInformation",Be="Language",_e="WebPortalUserMap",We="BayGroup",Ge="PipelineHeaderSiteView",He="TankMonitor",ze="PersonAdmin",Qe="ProductReconciliationReports",qe="ReportConfiguration",Ke="EXECONFIGURATION",$e="ShareholderAllocation",Ye="NotificationGroup",Je="NotificationRestriction",Ze="NotificationConfig",Xe="AllowWeighBridgeManualEntry",et="ProductAllocation",tt="MasterDeviceConfiguration",it="ShareholderAgreement",at="TANKSHAREHOLDERPRIMEFUNCTION",st="ROLEADMIN",ot="ShiftConfig",rt="PrinterConfiguration",nt="CustomerAgreement",lt="BaySCADAConfiguration",dt="RailReceiptUnloadSpotAssignment",ct="STAFF_VISITOR",ht="PipelineMeterSiteView",ut="RailSiteView",pt="MarineSiteView",mt="LoadingDetails",Ct="UnloadingDetails",gt="RoadHSEInspection",Rt="RoadHSEInspectionConfig",St="MarineHSEInspection",yt="MarineHSEInspectionConfig",Tt="RailHSEInspection",Dt="RailHSEInspectionConfig",Et="PipelineHSEInspection",At="PipelineHSEInspectionConfig",ft="PrintRAN",vt="ViewReceiptStatus",Pt="customerrecipe",bt="COAParameter",Lt="COATemplate",xt="COAManagement",It="COACustomer",wt="COAAssignment",Nt="ProductForecastConfiguration"},93779:(e,t,i)=>{"use strict";i.d(t,{$A:()=>w,$L:()=>lt,$Q:()=>Be,Ae:()=>xe,BX:()=>oe,Bl:()=>me,Bv:()=>Re,Bw:()=>Z,Cb:()=>x,Cg:()=>b,DN:()=>ot,D_:()=>rt,Dm:()=>N,E7:()=>$,EW:()=>M,FN:()=>se,FR:()=>o,FY:()=>mt,GA:()=>_e,GT:()=>T,Ge:()=>je,HB:()=>re,JQ:()=>K,KJ:()=>ee,Kz:()=>H,Ln:()=>G,M$:()=>Ge,O5:()=>tt,Of:()=>De,Oo:()=>it,Pk:()=>ge,Pm:()=>J,Q5:()=>dt,QK:()=>He,QV:()=>Ze,QZ:()=>ct,Qu:()=>ie,RX:()=>be,Rb:()=>_,Rp:()=>A,SP:()=>C,T5:()=>Oe,UB:()=>S,UT:()=>l,Ui:()=>Q,VA:()=>B,Vk:()=>Ae,Wb:()=>fe,Wv:()=>Ee,X3:()=>Ke,Y4:()=>W,Yl:()=>at,Zx:()=>Y,_B:()=>Se,_C:()=>L,_R:()=>Ce,_j:()=>ce,_n:()=>a,aM:()=>O,aW:()=>ke,bW:()=>k,c4:()=>st,cD:()=>n,c_:()=>v,cx:()=>V,dL:()=>ht,eE:()=>le,eS:()=>Qe,eT:()=>E,f:()=>j,f7:()=>pe,fR:()=>he,g1:()=>de,gN:()=>$e,gO:()=>z,iH:()=>nt,ij:()=>et,j1:()=>P,jC:()=>ye,je:()=>ue,jz:()=>ne,ll:()=>Xe,mM:()=>y,mO:()=>pt,mW:()=>Fe,ml:()=>g,mm:()=>Je,nB:()=>te,nT:()=>Me,np:()=>Ne,oA:()=>f,oG:()=>qe,oV:()=>X,ok:()=>h,oy:()=>d,pL:()=>Ie,pe:()=>We,pw:()=>ze,qF:()=>r,qQ:()=>ut,qp:()=>u,s0:()=>D,sA:()=>Le,st:()=>ae,tY:()=>F,uw:()=>q,v6:()=>s,vL:()=>Ue,vf:()=>we,wH:()=>Ye,wO:()=>Te,wX:()=>U,x4:()=>ve,xf:()=>p,xy:()=>c,yI:()=>R,yV:()=>I,yz:()=>m,zL:()=>Pe,zf:()=>Ve});const a="CarrierCode",s="TransportationType",o="ShareHolderCode",r="DriverCode",n="CustomerCode",l="TrailerCode",d="OriginTerminalCode",c="PrimeMoverCode",h="VehicleCode",u="DestinationCode",p="FinishedProductCode",m="ShipmentCode",C="OrderCode",g="ReceiptCode",R="MarineDispatchCode",S="MarineReceiptCode",y="SupplierCode",T="ContractCode",D="RailDispatchCode",E="RailReceiptCode",A="RailRouteCode",f="WagonCode",v="CompartmentCode",P="SMSConfigurationCode",b="PipelineDispatchCode",L="PipelineReceiptCode",x="EmailConfigurationCode",I="BaseProductCode",w="LocationCode",N="SiteViewType",j="EntityCode",M="EntityType",F="CardReaderCode",O="AccessCardCode",U="BcuCode",V="DeuCode",k="WeighBridgeCode",B="Weight",_="OutOfToleranceAllowed",W="LoadingArmCode",G="TransportationType",H="BayCode",z="TransactionNumber",Q="BatchNumber",q="TerminalCode",K="TankGroupCode",$="TankCode",Y="MeterCode",J="ShipmentType",Z="ShipmentStatus",X="MeterLineType",ee="DispatchCode",te="ReceiptStatus",ie="FPTransactionID",ae="ProductCategoryType",se="Reason",oe="SealMasterCode",re="Reason",ne="OperationName",le="FPTransactionID",de="ProductCategoryType",ce="CompartmentSeqNoInVehicle",he="AdjustedPlanQuantity",ue="ForceComplete",pe="DispatchStatus",me="HolidayDate",Ce="ActionID",ge="EODTimePrev",Re="TerminalAction",Se="EODTime",ye="MonthStartDay",Te="CaptainCode",De="GeneralTMUserType",Ee="GeneralTMUserCode",Ae="IsPriority",fe="ActualTerminalCode",ve="ShipmentBondNo",Pe="ReceiptBondNo",be="DeviceType",Le="DeviceCode",xe="BayGroup",Ie="PipelineHeaderCode",we="ExchangePartner",Ne="PersonID",je="UserName",Me="PipelinePlanCode",Fe="PipelinePlanType",Oe="ChannelCode",Ue="ProcessName",Ve="ReconciliationCode",ke="NotificationGroupCode",Be="NotificationGroupStatus",_e="NotificationGroupDesc",We="NotificationResSource",Ge="NotificationResMsgCode",He="NotificationOrigResSource",ze="NotificationOrigResMsgCode",Qe="NotificationMessageCode",qe="PositionType",Ke="ExchangeAgreementCode",$e="ProductTransferAgreementCode",Ye="ShareholderAgreementStatus",Je="RequestorShareholder",Ze="LenderShareholder",Xe="RequestCode",et="TransferReferenceCode",tt="ShiftID",it="ShiftName",at="PrinterName",st="LocationType",ot="ForceClosureReason",rt="TransactionType",nt="CustomerRecipeCode",lt="COATemplateCode",dt="COAManagementCode",ct="COAParameterCode",ht="COAManagementFinishedProductCode",ut="COASeqNumber",pt="ForecastDate",mt="ForecastTanks"},50477:()=>{}}]);
//# sourceMappingURL=6817.2f6e12da.chunk.js.map