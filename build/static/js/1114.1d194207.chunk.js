"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[1114],{61114:(e,t,a)=>{a.r(t),a.d(t,{default:()=>q});var i=a(65043),s=a(78374),o=a(72711),n=a(67907),r=a(24904),l=a(65187),d=a(85800),c=a(35861),h=a(7523),u=a(69062),p=a(70579);function m(e){let{railDispatch:t,modRailDispatch:a,modAssociations:i,modWagonDetails:m,validationErrors:C,listOptions:g,attributeValidationErrors:D,onAttributeCellDataEdit:y,onCompAttributeCellDataEdit:S,selectedAttributeList:R,expandedRows:A,toggleExpand:b,railRouteData:f,selectedAssociations:T,tabActiveIndex:E,onFieldChange:x,onDateTextChange:v,onAllTerminalsChange:L,onAssociationSelectionChange:P,onCellDataEdit:I,onWagonCellDataEdit:N,onAddAssociation:j,onDeleteAssociation:W,onRouteSearchChange:M,onTabChange:w,toggleWagonExpand:O,expandedWagonRows:F,currentAccess:k,isEnterpriseNode:_,compartmentDetailsPageSize:Q,enableHSEInspection:U,railLookUpData:V,WagonDetailTab:B,shipmentSource:H}=e;const[q]=(0,n.useTranslation)(),z=(e,t)=>{let a=[];return a=e.find((e=>e.TerminalCode===t)),a.attributeValidationErrors},G=(e,t)=>(0,p.jsx)(o.Select,{className:"selectDropwdown",value:i[e.rowIndex][e.field],fluid:!0,options:t,onChange:t=>I(t,e),indicator:"required",reserveSpace:!1,search:!0,noResultsMessage:q("noResultsMessage")}),Y=e=>(0,p.jsx)(o.Input,{fluid:!0,value:i[e.rowIndex][e.field],onChange:t=>I(t,e),reserveSpace:!1}),K=e=>{const{value:t}=e;return"number"===typeof t?t.toLocaleString():t},J=e=>e.rowData.IsMandatory?(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{children:e.rowData.AttributeName}),(0,p.jsx)("div",{className:"ui red circular empty label badge  circle-padding"})]}):(0,p.jsx)("div",{children:(0,p.jsx)("span",{children:e.rowData.AttributeName})}),Z=()=>k.ViewRailDispatch_Update?!k.ViewRailDispatch_Update:a.DispatchStatus!==h.Mw.READY,X=e=>{const t=A.findIndex((t=>t.SeqNumber===e.rowData.SeqNumber))>=0;return(0,p.jsxs)("div",{onClick:()=>b(e.rowData,t),className:"compartmentIcon gridButtonFontColor",children:[(0,p.jsx)("span",{children:q(t?"Hide_Attributes":"View_Attributes")}),(0,p.jsx)(o.Icon,{root:"common",name:t?"caret-up":"caret-down",className:"margin_l10"})]})},$=e=>{const t=e.rowData;try{return t.DataType.toLowerCase()===h.pe.STRING.toLowerCase()||t.DataType.toLowerCase()===h.pe.INT.toLowerCase()?(0,p.jsx)(o.Input,{fluid:!0,value:t.AttributeValue,disabled:t.IsReadonly,onChange:t=>S(e,t),reserveSpace:!1}):t.DataType.toLowerCase()===h.pe.FLOAT.toLowerCase()||t.DataType.toLowerCase()===h.pe.LONG.toLowerCase()||t.DataType.toLowerCase()===h.pe.DOUBLE.toLowerCase()?(0,p.jsx)(o.Input,{fluid:!0,value:null===t.AttributeValue||void 0===t.AttributeValue||""===t.AttributeValue?"":t.AttributeValue.toLocaleString(),disabled:t.IsReadonly,onChange:t=>S(e,t),reserveSpace:!1}):t.DataType.toLowerCase()===h.pe.BOOL.toLowerCase()?(0,p.jsx)(o.Checkbox,{checked:"true"===t.AttributeValue.toString().toLowerCase(),disabled:t.IsReadonly,onChange:t=>S(e,t)}):t.DataType.toLowerCase()===h.pe.DATETIME.toLowerCase()?(0,p.jsx)(o.DatePicker,{fluid:!0,value:null===t.AttributeValue||void 0===t.AttributeValue||""===t.AttributeValue?"":new Date(t.AttributeValue),disabled:t.IsReadonly,showYearSelector:"true",onChange:t=>S(e,t),reserveSpace:!1}):null}catch(a){console.log("RailDispatchDetails: Error occurred on handleAttributeType",a)}},ee=e=>Array.isArray(e.AttributesForUI)&&e.AttributesForUI.length>0?(0,p.jsx)("div",{className:"childTable ChildGridViewAllShipmentLoadingDetails",children:(0,p.jsxs)(s.bQ,{data:e.AttributesForUI,rows:Q,children:[_?(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"TerminalCode",header:q("CompartmentTerminal"),editable:!1},"TerminalCode"):"",(0,p.jsx)(s.bQ.Column,{className:"compColHeight",header:q("CompartmentAttributeName"),renderer:J,editable:!1},"AttributeName"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",header:q("CompartmentAttributeValue"),renderer:$}),Array.isArray(e.AttributesforUI)&&e.AttributesforUI.length>Q?(0,p.jsx)(s.bQ.Pagination,{}):""]})}):(0,p.jsx)("div",{className:"compartmentIcon",children:(0,p.jsx)("div",{className:"gridButtonAlignLeft",children:q("CustomerInventory_NoRecordsFound")})}),te=e=>{const t=F.findIndex((t=>t.TrailerCode===e.rowData.TrailerCode))>=0;return e.rowData.DispatchCompartmentStatus===h.bw.FORCE_COMPLETED&&(e.rowData.ForceComplete=!0),(0,p.jsx)("div",{onClick:()=>O(e.rowData,t),className:"compartmentIcon gridButtonFontColor",children:(0,p.jsx)(o.Icon,{root:"common",name:t?"slidercontrols-minus":"ellipsis-horizontal",className:"margin_l10"})})},ae=e=>{let t=[];return t.push(e),Array.isArray(t)&&t.length>0?(0,p.jsx)("div",{className:"childTable ChildGridViewAllShipmentLoadingDetails",children:(0,p.jsxs)(s.bQ,{data:t,onEdit:N,children:[(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"TareWeight",header:q("RailWagonConfigurationDetails_TareWeight")},"TareWeight"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"LadenWeight",header:q("PCDET_Planning_gvLadenWeight")},"LadenWeight"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"DiffWeight",header:q("Weight_Difference")},"DiffWeight")]})}):(0,p.jsx)("div",{className:"compartmentIcon",children:(0,p.jsx)("div",{className:"gridButtonAlignLeft",children:q("CustomerInventory_NoRecordsFound")})})};return(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsxs)("div",{className:"detailsContainer",children:[(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:a.DispatchCode,indicator:"required",disabled:""!==t.DispatchCode,onChange:e=>x("DispatchCode",e),label:e("RailDispatchPlanDetail_DispatchCode"),error:e(C.DispatchCode),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:a.Description,label:e("RailDispatchPlanDetail_Description"),onChange:e=>x("Description",e),error:e(C.Description),reserveSpace:!1,disabled:Z()})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,indicator:"required",placeholder:e("Common_Select"),label:e("RailDispatchPlanDetail_RouteCode"),value:a.RouteCode,onChange:e=>x("RouteCode",e),disabled:Z(),error:e(C.RouteCode),options:(0,c.r4)(g.routeCodes,e("Common_Select")),search:!0,reserveSpace:!1,noResultsMessage:e("noResultsMessage"),onSearch:M})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.DatePicker,{fluid:!0,value:null===a.ScheduledDate?"":new Date(a.ScheduledDate),label:e("RailDispatchPlanDetail_ScheduledDate"),type:"datetime",displayFormat:(0,c.F1)(),disabled:Z(),disablePast:!1,indicator:"required",showYearSelector:"true",onChange:e=>x("ScheduledDate",e),onTextChange:(e,t)=>{v("ScheduledDate",e,t)},error:e(C.ScheduledDate),minuteStep:"5",reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:f.DestinationCode,label:e("RailDispatchPlanDetail_FinalDestination"),reserveSpace:!1,disabled:!0})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,indicator:"required",placeholder:e("Common_Select"),onChange:e=>x("CreatedFromEntity",parseInt(e)),label:e("RailDispatchPlanDetail_CreatedFromEntity"),options:g.createdFromEntities,value:a.CreatedFromEntity,disabled:!(!Z()&&void 0===H),reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:a.DispatchStatus,label:e("RailDispatchPlanDetail_RailStatus"),reserveSpace:!1,disabled:!0})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("RailDispatchPlanDetail_QuantityUOM"),value:a.QuantityUOM,multiple:!1,indicator:"required",options:g.quantityUOMs,onChange:e=>x("QuantityUOM",e),error:e(C.QuantityUOM),disabled:Z()||0===g.quantityUOMs.length,reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:f.DepartureTime,label:e("RailDispatchPlanDetail_DepartTime"),reserveSpace:!1,disabled:!0})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("Cust_Status"),value:a.Active,options:[{text:e("ViewRailDispatchList_Ok"),value:!0},{text:e("ViewShipmentStatus_Inactive"),value:!1}],onChange:e=>x("Active",e),disabled:Z()||""===t.DispatchCode,noResultsMessage:e("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:a.Remarks,label:e("Cust_Remarks"),onChange:e=>x("Remarks",e),indicator:a.Active!==t.Active?"required":"",error:e(C.Remarks),reserveSpace:!1,disabled:Z()||""===t.DispatchCode})}),_?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(r.y,{terminalList:g.terminalCodes,selectedTerminal:a.TerminalCodes,error:C.TerminalCodes,onFieldChange:x,onCheckChange:L})}),null===t.DispatchCode||void 0===t.DispatchCode||""===t.DispatchCode?"":(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,placeholder:"",label:e("Shipment_LoadedTerminal"),value:a.ActualTerminalCode,disabled:!0})})]}):null]}),R.length>0?R.map((t=>(0,p.jsx)(l.A,{children:(0,p.jsx)(o.Accordion,{children:(0,p.jsx)(o.Accordion.Content,{className:"attributeAccordian",title:_?t.TerminalCode+" - "+e("Attributes_Header"):e("Attributes_Header"),children:(0,p.jsx)(d.n,{selectedAttributeList:t.attributeMetaDataList,handleCellDataEdit:y,attributeValidationErrors:z(D,t.TerminalCode)})})})}))):null,(0,p.jsx)("div",{className:"shipmentTabAlignment",children:(0,p.jsxs)(o.Tab,{activeIndex:E,onTabChange:e=>{w(e)},children:[(0,p.jsxs)(o.Tab.Pane,{title:e("RailDispatchPlanDetail_PlanHeader"),children:[(0,p.jsxs)("div",{className:"row compartmentRow",children:[(0,p.jsx)("div",{className:"col col-md-8 col-lg-9 col col-xl-9"}),(0,p.jsx)("div",{className:"col col-md-4 col-lg-3 col-xl-3",children:(0,p.jsxs)("div",{className:"compartmentIconContainer",children:[(0,p.jsxs)("div",{onClick:j,className:"compartmentIcon",children:[(0,p.jsx)("div",{children:(0,p.jsx)(o.Icon,{root:"common",name:"badge-plus",size:"medium"})}),(0,p.jsx)("div",{className:"margin_l10",children:(0,p.jsx)("h5",{className:"font14",children:e("FinishedProductInfo_Add")})})]}),(0,p.jsxs)("div",{onClick:W,className:"compartmentIcon margin_l30",children:[(0,p.jsx)("div",{children:(0,p.jsx)(o.Icon,{root:"common",name:"delete",size:"medium"})}),(0,p.jsx)("div",{className:"margin_l10",children:(0,p.jsx)("h5",{className:"font14",children:e("DestAdd_Delete")})})]})]})})]}),(0,p.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(s.bQ,{data:i,rowExpansionTemplate:ee,expandedRows:A,scrollable:!0,scrollHeight:"320px",selectionMode:"multiple",selection:T,onSelectionChange:P,children:[(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"ShareholderCode",header:(0,c.i7)(e("RailDispatchPlanDetail_ShareHolderCode")),editable:!Z(),editFieldType:"text",customEditRenderer:e=>G(e,g.shareholders)},"ShareholderCode"),2===a.CreatedFromEntity?(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"ContractCode",header:(0,c.i7)(e("RailDispatchPlanDetail_ContractCode")),editable:!Z(),editFieldType:"text",customEditRenderer:e=>G(e,g.contractCodes)},"ContractCode"):null,(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"FinishedProductCode",header:(0,c.i7)(e("RailDispatchPlanDetail_FinishedProductCode")),editable:!Z(),editFieldType:"text",customEditRenderer:e=>(e=>{const t=[];return void 0!==g.finishedProducts&&null!==g.finishedProducts&&void 0!==g.finishedProducts[e.rowData.ShareholderCode]&&Array.isArray(g.finishedProducts[e.rowData.ShareholderCode])&&g.finishedProducts[e.rowData.ShareholderCode].forEach((e=>t.push({text:e,value:e}))),G(e,t)})(e)},"FinishedProductCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"CustomerCode",header:(0,c.i7)(e("RailDispatchPlanDetail_Customer")),editable:!Z(),editFieldType:"text",customEditRenderer:e=>(e=>{const t=[];return void 0!==g.customerDestinations[e.rowData.ShareholderCode]&&null!==g.customerDestinations[e.rowData.ShareholderCode]&&Object.keys(g.customerDestinations[e.rowData.ShareholderCode]).forEach((e=>t.push({text:e,value:e}))),G(e,t)})(e)},"CustomerCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"DestinationCode",header:(0,c.i7)(e("RailDispatchPlanDetail_Destination")),editable:!Z(),editFieldType:"text",customEditRenderer:e=>(e=>{const t=[];return void 0!==g.customerDestinations[e.rowData.ShareholderCode]&&null!==g.customerDestinations[e.rowData.ShareholderCode]&&void 0!==g.customerDestinations[e.rowData.ShareholderCode][e.rowData.CustomerCode]&&Array.isArray(g.customerDestinations[e.rowData.ShareholderCode][e.rowData.CustomerCode])&&g.customerDestinations[e.rowData.ShareholderCode][e.rowData.CustomerCode].forEach((e=>t.push({text:e,value:e}))),G(e,t)})(e)},"DestinationCode"),"1"===V.PlanType?(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"PlannedQuantity",header:(0,c.i7)(e("RailDispatchPlanDetail_Quantity")),editable:!Z(),editFieldType:"text",renderer:e=>K(e),customEditRenderer:Y},"PlannedQuantity"):null,"2"===V.PlanType?(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"RailWagonCategory",header:(0,c.i7)(e("RailDispatchPlanDetail_RailWagonCategory")),editable:!Z(),editFieldType:"text",customEditRenderer:e=>G(e,g.railWagonCategories)},"RailWagonCategory"):null,"2"===V.PlanType?(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"PlannedNoOfRailWagons",header:(0,c.i7)(e("RailDispatchPlanDetail_NoOfRailWagons")),editable:!Z(),editFieldType:"text",renderer:e=>K(e),customEditRenderer:Y},"PlannedNoOfRailWagons"):null,(0,p.jsx)(s.bQ.Column,{className:"expandedColumn",initialWidth:"200px",renderer:X})]})})})]}),B.map((t=>(0,p.jsx)(o.Tab.Pane,{title:e("ViewRailDispatchList_WagonDetails"),children:(0,p.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(s.bQ,{data:m,rowExpansionTemplate:ae,expandedRows:F,scrollable:!0,scrollHeight:"320px",children:[(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"TrailerCode",header:e("Rail_Receipt_Wagon")},"TrailerCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"CarrierCompanyCode",header:e("Rail_Receipt_Carrier")},"CarrierCompanyCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"FinishedProductCode",header:e("Rail_Receipt_Product")},"FinishedProductCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"DispatchCompartmentStatus",header:e("ViewRailDispatchList_DispatchStatus"),renderer:e=>{if(null!==e.value)return u.cd(h.bw,e.value)}},"DispatchCompartmentStatus"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"PlannedQuantity",header:e("ViewRailDispatchList_PlannedQuantity")},"PlannedQuantity"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"RevisedQuantity",header:e("ViewRailDispatchList_RevisedPlannedQuantity")},"RevisedQuantity"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"LoadedQuantity",header:e("ViewRailDispatchList_LoadedQuantity")},"LoadedQuantity"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"ReturnQuantity",header:e("ViewMarineShipmentList_ReturnQuantity")},"ReturnQuantity"),U?(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"HSEInspectionStatus",header:e("VehHSE_InspectionStatus"),renderer:e=>u.cd(h.P6,parseInt(e.value))},"HSEInspectionStatus"):null,(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"AdjustedQty",header:e("ViewMarineShipmentList_AdjustPlan"),renderer:e=>(e=>(0,p.jsx)("div",{children:!1===k.ViewRailDispatch_EditAccess||e.rowData.DispatchCompartmentStatus===h.bw.LOADING||e.rowData.DispatchCompartmentStatus===h.bw.FORCE_COMPLETED||e.rowData.DispatchCompartmentStatus===h.bw.COMPLETED||e.rowData.DispatchCompartmentStatus===h.bw.OVER_FILLED||k.ViewRailDispatch_DisableAdjustPlanQty||null===e.rowData.FinishedProductCode||""===e.rowData.FinishedProductCode?(0,p.jsx)(o.Input,{fluid:!0,disabled:!0}):(0,p.jsx)(o.Input,{fluid:!0,disabled:!1,value:e.rowData.AdjustedQty,onChange:t=>N(t,e),reserveSpace:!1})}))(e)}),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",initialWidth:"100px",field:"ForceComplete",header:e("ViewShipment_ForceComplete"),renderer:e=>((e,t)=>{const a=!(!1===k.ViewRailDispatch_EditAccess||e.rowData.DispatchCompartmentStatus===h.bw.LOADING||e.rowData.DispatchCompartmentStatus===h.bw.FORCE_COMPLETED||e.rowData.DispatchCompartmentStatus===h.bw.COMPLETED||e.rowData.DispatchCompartmentStatus===h.bw.OVER_FILLED||k.ViewRailDispatch_DisableWagonForceClose||null===e.rowData.FinishedProductCode||""===e.rowData.FinishedProductCode);return(0,p.jsx)(o.Checkbox,{disabled:!a,onChange:t=>N(t,e),checked:e.value})})(e)}),(0,p.jsx)(s.bQ.Column,{className:"expandedColumn",initialWidth:"100px",renderer:te})]})})})})))]})})]})})}function C(e){let{modLoadingDataInfo:t,validationErrors:a,listOptions:i,selectedAttributeList:s,attributeValidationErrorList:r,onAttributeCellDataEdit:h,onFieldChange:u,onDateTextChange:m,onTankSearchChange:C,onMeterSearchChange:g,onTabChange:D,tabActiveIndex:y}=e;const[S]=(0,n.useTranslation)(),R=(e,t)=>{let a=[];return a=e.find((e=>e.TerminalCode===t)),a.attributeValidationErrors},A=(e,n,m)=>{let D,y;return n?(D=S("BaseProductInfo_Additive")+" - "+t.ArrTransactionAdditive[e].AdditiveProductCode+" ("+S("BPCode")+" - "+t.ArrTransactionAdditive[e].BaseProductCode+")",y="ArrTransactionAdditive"):(D=S("BPCode")+" - "+t.ArrTransactionBP[e].BaseProductCode,y="ArrTransactionBP"),(0,p.jsxs)(o.Tab.Pane,{title:D,children:[(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,indicator:"required",value:t[y][e].GrossQuantity,label:S("GrossQuantity"),onChange:t=>u("GrossQuantity",t,{type:y,index:e},{category:"product",index:m}),error:S(a.product[m].GrossQuantity),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t[y][e].NetQuantity,label:S("NetQuantity"),onChange:t=>u("NetQuantity",t,{type:y,index:e},{category:"product",index:m}),error:S(a.product[m].NetQuantity),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t[y][e].Temperature,label:S("Temperature"),onChange:t=>u("Temperature",t,{type:y,index:e},{category:"product",index:m}),error:S(a.product[m].Temperature),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,placeholder:S("Common_Select"),label:S("MarineDispatchManualEntry_TemperatureUOM"),value:t[y][e].TemperatureUOM,options:i.temperatureUOMs,onChange:t=>u("TemperatureUOM",t,{type:y,index:e},{category:"product",index:m}),reserveSpace:!1,noResultsMessage:S("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t[y][e].ProductDensity,label:S("Density"),onChange:t=>u("ProductDensity",t,{type:y,index:e},{category:"product",index:m}),error:S(a.product[m].ProductDensity),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,placeholder:S("Common_Select"),label:S("BCU_DensityUOM"),value:t[y][e].ProductDensityUOM,options:i.densityUOMs,onChange:t=>u("ProductDensityUOM",t,{type:y,index:e},{category:"product",index:m}),reserveSpace:!1,noResultsMessage:S("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,placeholder:S("Common_Select"),label:S("MeterCode"),value:t[y][e].MeterCode,options:(0,c.r4)(i.meterCodes,S("Common_Select")),onChange:t=>u("MeterCode",t,{type:y,index:e}),search:!0,reserveSpace:!1,noResultsMessage:S("noResultsMessage"),onSearch:g})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,placeholder:S("Common_Select"),label:S("TankCode"),value:t[y][e].TankCode,options:(0,c.r4)(i.tankCodes,S("Common_Select")),onChange:t=>u("TankCode",t,{type:y,index:e}),search:!0,reserveSpace:!1,noResultsMessage:S("noResultsMessage"),onSearch:C})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t[y][e].StartTotalizer,label:S("StartTotalizer"),onChange:t=>u("StartTotalizer",t,{type:y,index:e},{category:"product",index:m}),error:S(a.product[m].StartTotalizer),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t[y][e].EndTotalizer,label:S("EndTotalizer"),onChange:t=>u("EndTotalizer",t,{type:y,index:e},{category:"product",index:m}),error:S(a.product[m].EndTotalizer),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t[y][e].NetStartTotalizer,label:S("MarineReceiptManualEntry_NetStartTotalizer"),onChange:t=>u("NetStartTotalizer",t,{type:y,index:e},{category:"product",index:m}),error:S(a.product[m].NetStartTotalizer),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t[y][e].NetEndTotalizer,label:S("MarineReceiptManualEntry_NetEndTotalizer"),onChange:t=>u("NetEndTotalizer",t,{type:y,index:e},{category:"product",index:m}),error:S(a.product[m].NetEndTotalizer),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t[y][e].CalculatedGross,label:S("LoadingDetailsEntry_CalculatedGross"),onChange:t=>u("CalculatedGross",t,{type:y,index:e},{category:"product",index:m}),error:S(a.product[m].CalculatedGross),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t[y][e].CalculatedNet,label:S("LoadingDetailsEntry_CalculatedNet"),onChange:t=>u("CalculatedNet",t,{type:y,index:e},{category:"product",index:m}),error:S(a.product[m].CalculatedNet),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,placeholder:S("Common_Select"),label:S("LoadingDetails_CalculatedValueUOM"),value:t[y][e].CalculatedValueUOM,multiple:!1,options:i.quantityUOMs,onChange:t=>u("CalculatedValueUOM",t,{type:y,index:e},{category:"product",index:m}),reserveSpace:!1,noResultsMessage:S("noResultsMessage")})})]}),s[m].length>0?s[m].map((e=>(0,p.jsx)(l.A,{children:(0,p.jsx)(o.Accordion,{children:(0,p.jsx)(o.Accordion.Content,{className:"attributeAccordian",title:S("Attributes_Header"),children:(0,p.jsx)(d.n,{selectedAttributeList:e.attributeMetaDataList,handleCellDataEdit:(e,t)=>h(e,t,m),attributeValidationErrors:R(r[m],e.TerminalCode)})})})}))):null]})},b=[];let f=1;for(let o=0;o<t.ArrTransactionBP.length;o++)b.push(A(o,!1,f)),f+=1;for(let o=0;o<t.ArrTransactionAdditive.length;o++)b.push(A(o,!0,f)),f+=1;return(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsxs)("div",{className:"detailsContainer",children:[(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t.CommonInfo.DispatchCode,disabled:!0,label:e("RailDispatchPlanDetail_DispatchCode"),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t.CommonInfo.CarrierCode,disabled:!0,label:e("Rail_Receipt_Carrier"),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,indicator:"required",placeholder:e("Common_Select"),label:e("Rail_Receipt_Wagon"),value:t.CommonInfo.TrailerCode,options:i.wagonCodes,onChange:e=>u("TrailerCode",e),reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,indicator:"required",placeholder:e("Common_Select"),label:e("RailDispatchManualEntry_Cluster"),value:t.CommonInfo.BayCode,onChange:e=>u("BayCode",e),options:i.clusterCodes,error:e(a.bayCode),reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("RailDispatchManualEntry_BCU"),value:t.CommonInfo.BCUCode,onChange:e=>u("BCUCode",e),options:i.BCUCodes,reserveSpace:!1,indicator:"required",error:e(a.BCUCode),noResultsMessage:e("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("RailDispatchManualEntry_LoadingArm"),value:t.TransactionFPinfo.ArmCode,onChange:e=>u("ArmCode",e,{type:"TransactionFPinfo"}),indicator:"required",error:e(a.LoadingArm),options:i.loadingArmCodes,reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t.TransactionFPinfo.FinishedProductCode,disabled:!0,label:e("Rail_Receipt_Product"),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t.TransactionFPinfo.TransactionID,label:e("RailDispatchManualEntry_TransactionNo"),onChange:e=>u("TransactionID",e,{type:"TransactionFPinfo"},{category:"common"}),error:e(a.common.TransactionID),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.DatePicker,{fluid:!0,value:t.TransactionFPinfo.StartTime,label:e("RailDispatchManualEntry_MandatoryLoadStartTime"),onChange:e=>u("StartTime",e,{type:"TransactionFPinfo"},{category:"common"}),type:"datetime",disablePast:!1,disableFuture:!0,indicator:"required",reserveSpace:!1,minuteStep:5,showYearSelector:!0,displayFormat:(0,c.F1)(),onTextChange:(e,t)=>{m("StartTime",e,t)},error:e(a.common.StartTime)})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.DatePicker,{fluid:!0,value:t.TransactionFPinfo.EndTime,label:e("RailDispatchManualEntry_MandatoryLoadEndTime"),onChange:e=>u("EndTime",e,{type:"TransactionFPinfo"},{category:"common"}),type:"datetime",disablePast:!1,disableFuture:!0,indicator:"required",reserveSpace:!1,minuteStep:5,showYearSelector:!0,displayFormat:(0,c.F1)(),onTextChange:(e,t)=>{m("EndTime",e,t)},error:e(a.common.EndTime)})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("RailDispatchManualEntry_QuantityUOM"),value:t.TransactionFPinfo.QuantityUOM,multiple:!1,indicator:"required",options:i.quantityUOMs,disabled:!0,reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t.TransactionFPinfo.Remarks,label:e("RailDispatchManualEntry_Remarks"),onChange:e=>u("Remarks",e,{type:"TransactionFPinfo"},{category:"common"}),error:e(a.common.Remarks),reserveSpace:!1})})]}),(0,p.jsx)("div",{className:"shipmentTabAlignment",children:(0,p.jsxs)(o.Tab,{activeIndex:y,onTabChange:D,children:[(0,p.jsxs)(o.Tab.Pane,{title:""===t.TransactionFPinfo.FinishedProductCode?e("FinishedProduct"):e("FinishedProduct")+"-"+t.TransactionFPinfo.FinishedProductCode,children:[(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,indicator:"required",value:t.TransactionFPinfo.GrossQuantity,label:e("GrossQuantity"),onChange:e=>u("GrossQuantity",e,{type:"TransactionFPinfo"},{category:"product",index:0}),error:e(a.product[0].GrossQuantity),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t.TransactionFPinfo.NetQuantity,label:e("NetQuantity"),onChange:e=>u("NetQuantity",e,{type:"TransactionFPinfo"},{category:"product",index:0}),error:e(a.product[0].NetQuantity),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t.TransactionFPinfo.Temperature,label:e("Temperature"),onChange:e=>u("Temperature",e,{type:"TransactionFPinfo"},{category:"product",index:0}),error:e(a.product[0].Temperature),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("MarineDispatchManualEntry_TemperatureUOM"),value:t.TransactionFPinfo.TemperatureUOM,options:i.temperatureUOMs,onChange:e=>u("TemperatureUOM",e,{type:"TransactionFPinfo"},{category:"product",index:0}),reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t.TransactionFPinfo.ProductDensity,label:e("Density"),onChange:e=>u("ProductDensity",e,{type:"TransactionFPinfo"},{category:"product",index:0}),error:e(a.product[0].ProductDensity),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("BCU_DensityUOM"),value:t.TransactionFPinfo.ProductDensityUOM,options:i.densityUOMs,onChange:e=>u("ProductDensityUOM",e,{type:"TransactionFPinfo"},{category:"product",index:0}),reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("MeterCode"),value:t.TransactionFPinfo.MeterCode,options:(0,c.r4)(i.meterCodes,e("Common_Select")),onChange:e=>u("MeterCode",e,{type:"TransactionFPinfo"}),search:!0,reserveSpace:!1,noResultsMessage:e("noResultsMessage"),onSearch:g})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("TankCode"),value:t.TransactionFPinfo.TankCode,options:(0,c.r4)(i.tankCodes,e("Common_Select")),onChange:e=>u("TankCode",e,{type:"TransactionFPinfo"}),search:!0,reserveSpace:!1,noResultsMessage:e("noResultsMessage"),onSearch:C})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t.TransactionFPinfo.StartTotalizer,label:e("StartTotalizer"),onChange:e=>u("StartTotalizer",e,{type:"TransactionFPinfo"},{category:"product",index:0}),error:e(a.product[0].StartTotalizer),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t.TransactionFPinfo.EndTotalizer,label:e("EndTotalizer"),onChange:e=>u("EndTotalizer",e,{type:"TransactionFPinfo"},{category:"product",index:0}),error:e(a.product[0].EndTotalizer),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t.TransactionFPinfo.NetStartTotalizer,label:e("MarineReceiptManualEntry_NetStartTotalizer"),onChange:e=>u("NetStartTotalizer",e,{type:"TransactionFPinfo"},{category:"product",index:0}),error:e(a.product[0].NetStartTotalizer),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t.TransactionFPinfo.NetEndTotalizer,label:e("MarineReceiptManualEntry_NetEndTotalizer"),onChange:e=>u("NetEndTotalizer",e,{type:"TransactionFPinfo"},{category:"product",index:0}),error:e(a.product[0].NetEndTotalizer),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t.TransactionFPinfo.CalculatedGross,label:e("LoadingDetailsEntry_CalculatedGross"),onChange:e=>u("CalculatedGross",e,{type:"TransactionFPinfo"},{category:"product",index:0}),error:e(a.product[0].CalculatedGross),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Input,{fluid:!0,value:t.TransactionFPinfo.CalculatedNet,label:e("LoadingDetailsEntry_CalculatedNet"),onChange:e=>u("CalculatedNet",e,{type:"TransactionFPinfo"},{category:"product",index:0}),error:e(a.product[0].CalculatedNet),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("LoadingDetails_CalculatedValueUOM"),value:t.TransactionFPinfo.CalculatedValueUOM,options:i.quantityUOMs,onChange:e=>u("CalculatedValueUOM",e,{type:"TransactionFPinfo"},{category:"product",index:0}),reserveSpace:!1,noResultsMessage:e("noResultsMessage")})})]}),s[0].length>0?s[0].map((t=>(0,p.jsx)(l.A,{children:(0,p.jsx)(o.Accordion,{children:(0,p.jsx)(o.Accordion.Content,{className:"attributeAccordian",title:e("Attributes_Header"),children:(0,p.jsx)(d.n,{selectedAttributeList:t.attributeMetaDataList,handleCellDataEdit:(e,t)=>h(e,t,0),attributeValidationErrors:R(r[0],t.TerminalCode)})})})}))):null]}),b]})})]})})}m.defaultProps={genericProps:{transportationType:"RAIL"},isEnterpriseNode:!1};var g=a(53536),D=a.n(g),y=a(45127);function S(e){let{modRailDispatch:t,auditTrailList:a,modalData:i,onModalDataChange:r,Attributes:l,onPrint:d}=e;const c=e=>{const t=e.rowData.AttributesforUI.filter((t=>t.AttributeName===e.name))[0];return t.DataType.toLowerCase()===h.pe.STRING.toLowerCase()||t.DataType.toLowerCase()===h.pe.INT.toLowerCase()||t.DataType.toLowerCase()===h.pe.LONG.toLowerCase()||t.DataType.toLowerCase()===h.pe.FLOAT.toLowerCase()?(0,p.jsx)("label",{children:t.AttributeValue}):t.DataType.toLowerCase()===h.pe.BOOL.toLowerCase()?(0,p.jsx)(o.Checkbox,{checked:"true"===t.AttributeValue.toString().toLowerCase(),disabled:!0}):(0,p.jsx)("label",{children:new Date(t.AttributeValue).toLocaleDateString()})},m=(e,t)=>(t.cls=null,e.fontSize="7px",t.text=h.Mw[u.cd(h.g5,t.val)],t);return(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsxs)("div",{className:"detailsContainer",children:[(0,p.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,p.jsx)("div",{className:"col-12 detailsTable container-fluid",children:(0,p.jsxs)(y.IO,{itemsSource:a,chartType:"Line",bindingX:"UpdatedTime",palette:["red"],style:{width:"100%",minWidth:"800px",height:"450px"},children:[(0,p.jsx)(y.tN,{position:"Bottom"}),(0,p.jsx)(y.vc,{wjProperty:"axisY",majorUnit:1,max:16,min:0,itemFormatter:m,axisLine:!0}),(0,p.jsx)(y.t3,{binding:"DispatchStatusInNumber",name:e("RailDispatchPlanDetail_RailStatus")})]})})}),(0,p.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,p.jsx)("div",{className:"col-12 detailsTable",id:"printTable",children:(0,p.jsxs)(s.bQ,{data:a,children:[(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"DispatchCode",header:e("RailDispatchPlanDetail_DispatchCode")},"DispatchCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"DispatchStatus",header:e("RailDispatchPlanDetail_RailStatus")},"DispatchStatus"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"TrailerCode",header:e("Rail_Receipt_Wagon")},"TrailerCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"CarrierCompanyCode",header:e("Rail_Receipt_Carrier")},"CarrierCompanyCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"DispatchCompartmentStatus",header:e("Rail_Wagon_Status"),renderer:e=>{if(null!==e.value)return u.cd(h.bw,e.value)}},"DispatchCompartmentStatus"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"UserPIN",header:e("PIN")},"UserPIN"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"UpdatedTime",header:e("SAAuditTrial_UpdatedTime")},"UpdatedTime"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"OfficerName",header:e("ViewAuditTrail_OfficerName")},"OfficerName"),l.map((t=>(0,p.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",header:e(t.AttributeName),editable:!1,renderer:c})))]})})}),(0,p.jsxs)(o.Modal,{open:i.printAuditTrail.isOpen,closeOnDimmerClick:!1,className:"marineModalPrint",children:[(0,p.jsxs)(o.Modal.Content,{children:[(0,p.jsx)("div",{className:"col col-md-8 col-lg-9 col col-xl-9",children:(0,p.jsx)("h3",{children:t.DispatchCode+" - "+e("Transaction_AuditTrail_Heading")})}),(0,p.jsx)("div",{className:"row",children:(0,p.jsx)("div",{className:"col-md-10 container-fluid",children:(0,p.jsxs)(y.IO,{itemsSource:a,chartType:"Line",bindingX:"UpdatedTime",palette:["red"],style:{width:"100%",height:"450px"},children:[(0,p.jsx)(y.tN,{position:"Bottom"}),(0,p.jsx)(y.vc,{wjProperty:"axisY",majorUnit:1,max:16,min:0,itemFormatter:m,axisLine:!0}),(0,p.jsx)(y.t3,{binding:"DispatchStatusInNumber",name:e("RailDispatchPlanDetail_RailStatus")})]})})}),(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(s.bQ,{data:a,children:[(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"DispatchCode",header:e("RailDispatchPlanDetail_DispatchCode")},"DispatchCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"DispatchStatus",header:e("RailDispatchPlanDetail_RailStatus")},"DispatchStatus"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"TrailerCode",header:e("Rail_Receipt_Wagon")},"TrailerCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"CarrierCompanyCode",header:e("Rail_Receipt_Carrier")},"CarrierCompanyCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"DispatchCompartmentStatus",header:e("Rail_Wagon_Status"),renderer:e=>{if(null!==e.value)return u.cd(h.bw,e.value)}},"DispatchCompartmentStatus"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"UserPIN",header:e("PIN")},"UserPIN"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"UpdatedTime",header:e("SAAuditTrial_UpdatedTime")},"UpdatedTime"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"OfficerName",header:e("ViewAuditTrail_OfficerName")},"OfficerName"),l.map((t=>(0,p.jsx)(s.bQ.Column,{className:"compColHeight",header:e(t.AttributeName),editable:!1,renderer:c})))]})})]}),(0,p.jsxs)(o.Modal.Footer,{children:[(0,p.jsx)(o.Button,{type:"primary",content:e("ViewAuditTrail_Print"),onClick:()=>{d(t.DispatchCode+" - "+e("ViewRailDispatchList_ViewAuditTrail"))}}),(0,p.jsx)(o.Button,{type:"secondary",content:e("AccessCardInfo_Cancel"),onClick:()=>{const e=D().cloneDeep(i);e.printAuditTrail.isOpen=!1,r(e)}})]})]})]})})}function R(e){let{loadingDetailsList:t,hideColumnList:a}=e;const i={BCUCode:!0,BaseProductCode:!0,BayCode:!0,CalculatedGross:!0,CalculatedNet:!0,CalculatedValueUOM:!0,CarrierCode:!0,CompartmentSeqNoInVehicle:!0,Density:!0,EndTime:!0,EndTotalizer:!0,EndWeightInAir:!0,EndWeightInVacuum:!0,GeneralTMUserID:!0,GrossQuantity:!0,IsBonded:!0,IsBonded1:!0,Mass:!0,MeterCode:!0,Netendtotalizer:!0,NetQuantity:!0,Netstarttotalizer:!0,OfficerID:!0,PresetQuantity:!0,Pressure:!0,ProductCategoryType:!0,ProductCode:!0,ReferenceDensity:!0,Remarks:!0,StartTime:!0,StartTotalizer:!0,StartWeightInAir:!0,TankCode:!0,Temperature:!0,TrailerCode:!0,TransactionID:!0,WeighInAir:!0,WeightInVacuum:!0,resetQuantity:!0};for(let s of a)void 0!==i[s]&&(i[s]=!1);const r=e=>{try{if(null===e||void 0===e||" "===e)return"";const t=e.split(" ",2);return 2!==t.length||""===t[0]?"":parseFloat(t[0]).toLocaleString()+" "+t[1]}catch(t){return console.log("Error in convertNumberWithUOM  : "+e),e}},l=e=>{const{value:t}=e;return null!=t&&""!==t?t.toLocaleString():""};return(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsx)("div",{className:"detailsContainer",children:(0,p.jsx)("div",{className:"row",children:(0,p.jsx)("div",{className:"detailsTable loadingTable",children:(0,p.jsxs)(s.bQ,{data:t,scrollable:!0,resizableColumns:!0,children:[i.CompartmentSeqNoInVehicle?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"CompartmentSeqNoInVehicle",header:e("ViewRailLoadingDetails_SequenceNo")},"CompartmentSeqNoInVehicle"):null,i.TrailerCode?(0,p.jsx)(s.bQ.Column,{initialWidth:"160px",className:"compColHeight",field:"TrailerCode",header:e("ViewRailLoadingDetails_RailWagonCode")},"TrailerCode"):null,i.CarrierCode?(0,p.jsx)(s.bQ.Column,{initialWidth:"160px",className:"compColHeight",field:"CarrierCode",header:e("ViewRailLoadingDetails_CarrierCompany")},"CarrierCode"):null,i.ProductCode?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"ProductCode",header:e("ViewRailLoadingDetails_ProductCode")},"ProductCode"):null,i.BaseProductCode?(0,p.jsx)(s.bQ.Column,{initialWidth:"160px",className:"compColHeight",field:"BaseProductCode",header:e("ViewRailLoadingDetails_BaseProductCode")},"BaseProductCode"):null,i.TankCode?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"TankCode",header:e("ViewRailLoadingDetails_TankCode")},"TankCode"):null,i.BayCode?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"BayCode",header:e("ViewRailLoadingDetails_BayCode")},"BayCode"):null,i.BCUCode?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"BCUCode",header:e("ViewRailLoadingDetails_BCUCode")},"BCUCode"):null,i.MeterCode?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"MeterCode",header:e("ViewRailLoadingDetails_MeterCode")},"MeterCode"):null,i.GrossQuantity?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"GrossQuantity",renderer:e=>r(e.value),header:e("ViewRailLoadingDetails_GrossQuantity")},"GrossQuantity"):null,i.NetQuantity?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"NetQuantity",renderer:e=>r(e.value),header:e("ViewRailLoadingDetails_NetQuantity")},"NetQuantity"):null,i.Density?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"Density",renderer:e=>r(e.value),header:e("ViewRailLoadingDetails_Density")},"Density"):null,i.Pressure?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"Pressure",renderer:e=>r(e.value),header:e("ViewRailLoadingDetails_Pressure")},"Pressure"):null,i.Temperature?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"Temperature",renderer:e=>r(e.value),header:e("ViewRailLoadingDetails_Temperature")},"Temperature"):null,i.Mass?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"Mass",header:e("ViewRailLoadingDetails_Mass")},"Mass"):null,i.StartTime?(0,p.jsx)(s.bQ.Column,{initialWidth:"200px",className:"compColHeight",field:"StartTime",header:e("ViewRailLoadingDetails_StartTime"),renderer:e=>new Date(e.value).toLocaleDateString()+" "+new Date(e.value).toLocaleTimeString()},"StartTime"):null,i.EndTime?(0,p.jsx)(s.bQ.Column,{initialWidth:"200px",className:"compColHeight",field:"EndTime",header:e("ViewRailLoadingDetails_EndTime"),renderer:e=>new Date(e.value).toLocaleDateString()+" "+new Date(e.value).toLocaleTimeString()},"EndTime"):null,i.StartTotalizer?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"StartTotalizer",renderer:e=>l(e),header:e("ViewRailLoadingDetails_StartTotalizer")},"StartTotalizer"):null,i.EndTotalizer?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"EndTotalizer",renderer:e=>l(e),header:e("ViewRailLoadingDetails_EndTotalizer")},"EndTotalizer"):null,i.TransactionID?(0,p.jsx)(s.bQ.Column,{initialWidth:"160px",className:"compColHeight",field:"TransactionID",header:e("ViewRailLoadingDetails_TransactionNo")},"TransactionID"):null,i.ReferenceDensity?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"ReferenceDensity",renderer:e=>r(e.value),header:e("ViewRailLoadingDetails_ReferenceDensity")},"ReferenceDensity"):null,i.Remarks?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"Remarks",header:e("ViewRailLoadingDetails_Remarks")},"Remarks"):null,i.PresetQuantity?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"PresetQuantity",renderer:e=>r(e.value),header:e("ViewRailLoadingDetails_PresetQuantity")},"PresetQuantity"):null,i.resetQuantity?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"resetQuantity",renderer:e=>r(e.value),header:e("ViewRailLoadingDetails_resetQuantity")},"resetQuantity"):null,i.Netstarttotalizer?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"NetStartTotalizer",header:e("ViewRailLoadingDetails_netstarttotalizer")},"NetStartTotalizer"):null,i.NetEndtoTalizer?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"NetEndtoTalizer",header:e("ViewRailLoadingDetails_netendtotalizer")},"NetEndtoTalizer"):null,i.WeightInAir?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"WeightInAir",renderer:e=>r(e.value),header:e("ViewRailLoadingDetails_WeightInAir")},"WeightInAir"):null,i.WeightInVacuum?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"WeightInVacuum",renderer:e=>r(e.value),header:e("ViewRailLoadingDetails_WeightInVacuum")},"WeightInVacuum"):null,i.IsBonded?(0,p.jsx)(s.bQ.Column,{initialWidth:"90px",className:"compColHeight",field:"IsBonded",header:e("ViewRailLoadingDetails_IsBonded"),renderer:e=>e.value?(0,p.jsx)(o.Icon,{name:"check",size:"small",color:"green"}):(0,p.jsx)(o.Icon,{name:"close",size:"small",color:"red"})},"IsBonded"):null,i.CalculatedGross?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"CalculatedGross",header:e("ViewRailLoadingDetails_CalculatedGross")},"CalculatedGross"):null,i.CalculatedNet?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"CalculatedNet",header:e("ViewRailLoadingDetails_CalculatedNet")},"CalculatedNet"):null,i.CalculatedValueUOM?(0,p.jsx)(s.bQ.Column,{initialWidth:"130px",className:"compColHeight",field:"CalculatedValueUOM",header:e("ViewRailLoadingDetails_CalculatedValueUOM")},"CalculatedValueUOM"):null]})})})})})}a(728).setLicenseKey(h.yQ);a(30089);function A(e){let{listOptions:t,modRailWagonList:a,data:i,onFieldChange:r,selectedRow:l,onSelectionChange:d,onAssignWagon:c,onDeleteWagon:h,onMoveWagon:u,onReverseSelect:m}=e;const C=()=>{let e=D().cloneDeep(t.trailerCodes);for(let t of a)e=e.filter((e=>!(t.TrailerCode===e.value&&t.CarrierCompanyCode===i.CarrierCompanyCode)));return e};return(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsxs)("div",{className:"detailsContainer",children:[(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("WagonList_CarrierCompany"),value:i.CarrierCode,onChange:e=>r("CarrierCompanyCode",e),options:t.carrierCodes,reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Select,{className:"selectDropwdown",label:e("RailWagonSeqInfo_RailWagonCode"),value:i.TrailerCode,fluid:!0,options:C(),onChange:e=>r("TrailerCode",e),reserveSpace:!1,search:!0,noResultsMessage:e("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.Button,{className:"hse-configuration-button",content:e("RailWagonSeqInfo_Assigned"),onClick:c})})]}),(0,p.jsxs)("div",{className:"row compartmentRow",children:[(0,p.jsx)("div",{className:"col col-md-8 col-lg-9 col col-xl-9"}),(0,p.jsx)("div",{className:"col col-md-4 col-lg-3 col-xl-3",children:(0,p.jsxs)("div",{className:"compartmentIconContainer",children:[(0,p.jsxs)("div",{onClick:()=>u(!0),className:"compartmentIcon",children:[(0,p.jsx)("div",{children:(0,p.jsx)(o.Icon,{root:"common",name:"arrow-up",size:"medium"})}),(0,p.jsx)("div",{className:"margin_l10",children:(0,p.jsx)("h5",{className:"font14",children:e("RailWagonSeqInfo_MoveUp")})})]}),(0,p.jsxs)("div",{onClick:()=>u(!1),className:"compartmentIcon margin_l30",children:[(0,p.jsx)("div",{children:(0,p.jsx)(o.Icon,{root:"common",name:"arrow-down",size:"medium"})}),(0,p.jsx)("div",{className:"margin_l10",children:(0,p.jsx)("h5",{className:"font14",children:e("RailWagonSeqInfo_MoveDown")})})]}),(0,p.jsxs)("div",{onClick:m,className:"compartmentIcon margin_l30",children:[(0,p.jsx)("div",{children:(0,p.jsx)(o.Icon,{root:"common",name:"arrow-left-and-right",size:"medium"})}),(0,p.jsx)("div",{className:"margin_l10",children:(0,p.jsx)("h5",{className:"font14",children:e("RailWagonSeqInfo_Reverse")})})]}),(0,p.jsxs)("div",{onClick:h,className:"compartmentIcon margin_l30",children:[(0,p.jsx)("div",{children:(0,p.jsx)(o.Icon,{root:"common",name:"delete",size:"medium"})}),(0,p.jsx)("div",{className:"margin_l10",children:(0,p.jsx)("h5",{className:"font14",children:e("RailWagonSeqInfo_DeAssign")})})]})]})})]}),(0,p.jsx)("div",{className:"row",children:(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(s.bQ,{data:a,selectionMode:"multiple",selection:l,onSelectionChange:d,children:[(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"SequenceNo",header:e("RailRouteConfigurationDetails_Sequence")},"SequenceNo"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"TrailerCode",header:e("ViewRailLoadingDetails_RailWagonCode")},"TrailerCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"CarrierCompanyCode",header:e("ViewRailLoadingDetails_CarrierCompany")},"CarrierCompanyCode")]})})})]})})}function b(e){let{listOptions:t,modRailWagonList:a,onCellDataEdit:i,createdFromEntity:r,expandedRows:l,toggleExpand:d,onCompAttributeCellDataEdit:u,railLookUpData:m,compartmentDetailsPageSize:C,isEnterpriseNode:g}=e;const[D]=(0,n.useTranslation)(),y=(e,t)=>(0,p.jsx)(o.Select,{className:"selectDropwdown",value:a[e.rowIndex][e.field],fluid:!0,options:t,onChange:t=>i(t,e),indicator:"required",reserveSpace:!1,search:!0,noResultsMessage:D("noResultsMessage")}),S=e=>(0,p.jsx)(o.Input,{fluid:!0,value:a[e.rowIndex][e.field],onChange:t=>i(t,e),reserveSpace:!1}),R=e=>{const t=l.findIndex((t=>t.SequenceNo===e.rowData.SequenceNo))>=0;return(0,p.jsxs)("div",{onClick:()=>d(e.rowData,t),className:"compartmentIcon gridButtonFontColor",children:[(0,p.jsx)("span",{children:D(t?"Hide_Attributes":"View_Attributes")}),(0,p.jsx)(o.Icon,{root:"common",name:t?"caret-up":"caret-down",className:"margin_l10"})]})},A=e=>e.rowData.IsMandatory?(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{children:e.rowData.AttributeName}),(0,p.jsx)("div",{className:"ui red circular empty label badge  circle-padding"})]}):(0,p.jsx)("div",{children:(0,p.jsx)("span",{children:e.rowData.AttributeName})}),b=e=>{const t=e.rowData;try{return t.DataType.toLowerCase()===h.pe.STRING.toLowerCase()||t.DataType.toLowerCase()===h.pe.INT.toLowerCase()?(0,p.jsx)(o.Input,{fluid:!0,value:t.AttributeValue,disabled:t.IsReadonly,onChange:t=>u(e,t),reserveSpace:!1}):t.DataType.toLowerCase()===h.pe.FLOAT.toLowerCase()||t.DataType.toLowerCase()===h.pe.LONG.toLowerCase()||t.DataType.toLowerCase()===h.pe.DOUBLE.toLowerCase()?(0,p.jsx)(o.Input,{fluid:!0,value:null===t.AttributeValue||void 0===t.AttributeValue||""===t.AttributeValue?"":t.AttributeValue.toLocaleString(),disabled:t.IsReadonly,onChange:t=>u(e,t),reserveSpace:!1}):t.DataType.toLowerCase()===h.pe.BOOL.toLowerCase()?(0,p.jsx)(o.Checkbox,{checked:"true"===t.AttributeValue.toString().toLowerCase(),disabled:t.IsReadonly,onChange:t=>u(e,t)}):t.DataType.toLowerCase()===h.pe.DATETIME.toLowerCase()?(0,p.jsx)(o.DatePicker,{fluid:!0,value:null===t.AttributeValue||void 0===t.AttributeValue||""===t.AttributeValue?"":new Date(t.AttributeValue),disabled:t.IsReadonly,showYearSelector:"true",onChange:t=>u(e,t),reserveSpace:!1}):null}catch(a){console.log("RailDispatchDetails: Error occurred on handleAttributeType",a)}},f=e=>Array.isArray(e.AttributesForUI)&&e.AttributesForUI.length>0?(0,p.jsx)("div",{className:"childTable ChildGridViewAllShipmentLoadingDetails",children:(0,p.jsxs)(s.bQ,{data:e.AttributesForUI,rows:C,children:[g?(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"TerminalCode",header:D("CompartmentTerminal"),editable:!1},"TerminalCode"):"",(0,p.jsx)(s.bQ.Column,{className:"compColHeight",header:D("CompartmentAttributeName"),renderer:A,editable:!1},"AttributeName"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",header:D("CompartmentAttributeValue"),renderer:b}),Array.isArray(e.AttributesforUI)&&e.AttributesforUI.length>C?(0,p.jsx)(s.bQ.Pagination,{}):""]})}):(0,p.jsx)("div",{className:"compartmentIcon",children:(0,p.jsx)("div",{className:"gridButtonAlignLeft",children:D("CustomerInventory_NoRecordsFound")})});return(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsx)("div",{className:"detailsContainer",children:(0,p.jsx)("div",{className:"row",children:(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(s.bQ,{data:a,rowExpansionTemplate:f,expandedRows:l,children:[(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"SequenceNo",header:e("RailRouteConfigurationDetails_Sequence")},"SequenceNo"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"TrailerCode",header:e("ViewRailLoadingDetails_RailWagonCode")},"TrailerCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"CarrierCompanyCode",header:e("ViewRailLoadingDetails_CarrierCompany")},"CarrierCompanyCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"ShareholderCode",header:(0,c.i7)(e("RailDispatchPlanDetail_ShareHolderCode")),editable:!0,editFieldType:"text",customEditRenderer:e=>y(e,t.shareholderCodes)},"ShareholderCode"),2===r?(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"ContractCode",header:(0,c.i7)(e("RailDispatchPlanDetail_ContractCode")),editable:!0,editFieldType:"text",customEditRenderer:e=>y(e,t.contractCodes)},"ContractCode"):null,(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"FinishedProductCode",header:(0,c.i7)(e("ViewRailDispatchList_FinishedProductCode")),editable:!0,editFieldType:"text",customEditRenderer:e=>(e=>{const a=[];return void 0!==t.finishedProductCodes&&null!==t.finishedProductCodes&&void 0!==t.finishedProductCodes[e.rowData.ShareholderCode]&&Array.isArray(t.finishedProductCodes[e.rowData.ShareholderCode])&&t.finishedProductCodes[e.rowData.ShareholderCode].forEach((e=>a.push({text:e,value:e}))),y(e,a)})(e)},"FinishedProductCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"CustomerCode",header:(0,c.i7)(e("ViewRailDispatchList_Customer")),editable:!0,editFieldType:"text",customEditRenderer:e=>(e=>{let a=[];return void 0!==t.customerDestinations[e.rowData.ShareholderCode]&&null!==t.customerDestinations[e.rowData.ShareholderCode]&&Object.keys(t.customerDestinations[e.rowData.ShareholderCode]).forEach((e=>a.push({text:e,value:e}))),y(e,a)})(e)},"CustomerCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"DestinationCode",header:(0,c.i7)(e("ViewRailDispatchList_DestinationCode")),editable:!0,editFieldType:"text",customEditRenderer:e=>(e=>{let a=[];return void 0!==t.customerDestinations[e.rowData.ShareholderCode]&&null!==t.customerDestinations[e.rowData.ShareholderCode]&&void 0!==t.customerDestinations[e.rowData.ShareholderCode][e.rowData.CustomerCode]&&Array.isArray(t.customerDestinations[e.rowData.ShareholderCode][e.rowData.CustomerCode])&&t.customerDestinations[e.rowData.ShareholderCode][e.rowData.CustomerCode].forEach((e=>a.push({text:e,value:e}))),y(e,a)})(e)},"DestinationCode"),"1"===m.PlanType?(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"Quantity",header:(0,c.i7)(e("RailDispatchPlanDetail_Quantity")),editable:!0,editFieldType:"text",renderer:e=>(e=>{const{value:t}=e;return"number"===typeof t?t.toLocaleString():t})(e),customEditRenderer:S},"Quantity"):null,(0,p.jsx)(s.bQ.Column,{className:"expandedColumn",initialWidth:"200px",renderer:R})]})})})})})}function f(e){let{listOptions:t,modRailWagonBatchPlanList:a,onCellDataEdit:i,onAuthorize:r}=e;const[l]=(0,n.useTranslation)(),d=(e,t)=>(0,p.jsx)(o.Select,{className:"selectDropwdown",value:a[e.rowIndex][e.field],fluid:!0,options:t,onChange:t=>i(t,e),indicator:"required",reserveSpace:!1,search:!0,noResultsMessage:l("noResultsMessage")}),h=e=>(0,p.jsx)(o.Input,{fluid:!0,value:a[e.rowIndex][e.field],onChange:t=>i(t,e),reserveSpace:!1}),u=e=>(0,p.jsx)("div",{className:"compartmentIconContainer"+(e.value?" gridButtonFontColor":""),children:(0,p.jsx)("div",{onClick:()=>r(e.rowData),className:"compartmentIcon",children:(0,p.jsx)("div",{className:"margin_l10",children:(0,p.jsx)("h5",{className:"font14",children:l("RailDispatchPlanInfo_Authorize")})})})}),m=e=>{const{value:t}=e;return"number"===typeof t?t.toLocaleString():t};return(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsx)("div",{className:"detailsContainer",children:(0,p.jsx)("div",{className:"row",children:(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(s.bQ,{data:a,children:[(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"RailWagonCode",header:e("ViewRailLoadingDetails_RailWagonCode")},"RailWagonCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"CarrierCompanyCode",header:e("ViewRailLoadingDetails_CarrierCompany")},"CarrierCompanyCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"FinishedProduct",header:e("ViewRailDispatchList_FinishedProductCode")},"FinishedProduct"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"PresetQuantity",header:e("RailDispatchTrainAssignment_PresetQuantity"),renderer:e=>m(e)},"PresetQuantity"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"SpurCode",header:(0,c.i7)(e("Spur_Code")),editable:!0,editFieldType:"text",customEditRenderer:e=>d(e,t.spurCodes)},"SpurCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"ClusterCode",header:(0,c.i7)(e("RailDispatchManualEntry_Cluster")),editable:!0,editFieldType:"text",customEditRenderer:e=>d(e,t.clusterCodes)},"ClusterCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"BCUCode",header:(0,c.i7)(e("ViewRailLoadingDetails_BCUCode")),editable:!0,editFieldType:"text",customEditRenderer:e=>d(e,t.BCUCodes)},"BCUCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"ArmNoInBCU",header:(0,c.i7)(e("LoadingArmInfo_ArmNoInBCU")),editable:!0,editFieldType:"text",renderer:e=>m(e),customEditRenderer:h},"ArmNoInBCU"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"LoadingSequenceNo",header:(0,c.i7)(e("RailDispatchLoadSpotAssign_LoadingSeq")),editable:!0,editFieldType:"text",renderer:e=>m(e),customEditRenderer:h},"LoadingSequenceNo"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"ReturnQuantity",header:(0,c.i7)(e("ViewRailReceiptList_ReturnQuantity")),editable:!0,editFieldType:"text",renderer:e=>m(e),customEditRenderer:h},"ReturnQuantity"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"AllowAuthorize",renderer:e=>u(e)},"AllowAuthorize")]})})})})})}function T(e){let{modWeightBridgeData:t,listOptions:a,onCellDataEdit:i,onDateTextChange:r}=e;const[l]=(0,n.useTranslation)(),d=(e,a)=>(0,p.jsx)(o.Select,{className:"selectDropwdown",value:t[e.rowIndex][e.field],fluid:!0,options:a,onChange:t=>i(t,e),indicator:"required",reserveSpace:!1,search:!0,noResultsMessage:l("noResultsMessage")}),h=e=>(0,p.jsx)(o.Input,{fluid:!0,value:t[e.rowIndex][e.field],onChange:t=>i(t,e),reserveSpace:!1}),u=e=>(0,p.jsx)(o.DatePicker,{fluid:!0,value:null===t[e.rowIndex][e.field]?"":new Date(t[e.rowIndex][e.field]),type:"datetime",minuteStep:5,displayFormat:(0,c.F1)(),indicator:"required",disableFuture:!0,onChange:t=>i(t,e),onTextChange:(t,a)=>{r(e,t,a)},reserveSpace:!1}),m=e=>{const{value:t}=e;return null!==t?new Date(t).toLocaleDateString()+" "+new Date(t).toLocaleTimeString():""},C=e=>(0,p.jsx)("div",{style:{textAlign:"center"},children:(0,p.jsx)(o.Checkbox,{style:{textAlign:"center"},fluid:!0,checked:t[e.rowIndex][e.field],onChange:t=>i(t,e),reserveSpace:!1})}),g=e=>{const{value:t}=e;return"number"===typeof t?t.toLocaleString():t};return(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsx)("div",{className:"detailsContainer",children:(0,p.jsx)("div",{className:"row",children:(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(s.bQ,{data:t,editable:!0,children:[(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"WagonCode",header:e("Rail_Wagon_Code")},"WagonCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"FinishedProductCode",header:e("Receipt_Product")},"FinishedProductCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"TareWeight",header:e("RailWagonConfigurationDetails_TareWeight"),editable:!0,editFieldType:"number",renderer:e=>g(e),customEditRenderer:h},"TareWeight"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"TareWeightUOM",header:e("ViewReceiptStatus_QuantityUOM")},"TareWeightUOM"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"TareWeightWeightBridgeCode",header:e("weighBridge_tare"),editable:!0,editFieldType:"text",customEditRenderer:e=>d(e,a.weightBridges)},"TareWeightWeightBridgeCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"TareWeightOperatorOverWritten",header:e("Operator_OverWrite_Tare"),renderer:e=>C(e)},"TareWeightOperatorOverWritten"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"LadenWeight",header:e("PCDET_Planning_gvLadenWeight"),editable:!0,editFieldType:"number",renderer:e=>g(e),customEditRenderer:h},"LadenWeight"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"LadenWeightUOM",header:e("ViewReceiptStatus_QuantityUOM")},"LadenWeightUOM"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"LadenWeightWeightBridgeCode",header:e("weighBridge_Laden"),editable:!0,customEditRenderer:e=>d(e,a.weightBridges)},"LadenWeightWeightBridgeCode"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"StartTime",displayFormat:(0,c.F1)(),header:e("LoadingDetails_StartTime"),editable:!0,renderer:e=>m(e),customEditRenderer:e=>u(e)},"StartTime"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"EndTime",displayFormat:(0,c.F1)(),header:e("LoadingDetails_EndTime"),editable:!0,renderer:e=>m(e),customEditRenderer:e=>u(e)},"EndTime"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"LadenWeightOperatorOverWritten",header:e("Operator_OverWrite_Laden"),renderer:e=>C(e)},"LadenWeightOperatorOverWritten"),(0,p.jsx)(s.bQ.Column,{className:"compColHeight",field:"LoadingType",header:e("Bay_LoadType"),editable:!1,editFieldType:"text"},"LoadingType")]})})})})})}T.defaultProps={};var E=a(15417),x=a(9256),v=a(44192),L=a(46100),P=a(40854),I=a.n(P),N=a(72067),j=a(9966),W=a(50805),M=a(97508),w=(a(38726),a(43503)),O=a(93779),F=a(80312),k=a(28882),_=a(40252),Q=a(40510),U=a(39424),V=a(62900),B=a(45217);class H extends i.Component{constructor(){var e;super(...arguments),e=this,this.state={railDispatch:D().cloneDeep(L.OE),modRailDispatch:{},modAssociations:[],modWagonDetails:[],loadingDataInfo:{},modLoadingDataInfo:{},dispatchStatusChangeList:[],auditTrailList:[],loadingDetailsList:[],weightBridgeData:[],modWeightBridgeData:[],validationErrors:u.Th(v.td),manualEntryValidationDict:{},isReadyToRender:!1,shareholders:this.getShareholders(),terminalCodes:[],railWagonCategoryOptions:[],contractCodeOptions:[],quantityUOMOptions:[],densityUOMOptions:[],temperatureUOMOptions:[],routeCodeOptions:[],routeCodeSearchOptions:[],finishedProductOptions:{},customerDestinationOptions:{},weightBridgeOptions:[],weightBridgeSetting:{},expandedRows:[],expandedWagonRows:[],attribute:[],attributeMetaDataList:[],compartmentAttributeMetaDataList:[],selectedAttributeList:[],attributeValidationErrors:[],productAssignmentExpandedRows:[],wagonDetailPlanAttributeMetaDataList:[],meterCodeOptions:[],meterCodeSearchOptions:[],tankCodeOptions:[],tankCodeSearchOptions:[],wagonCodeOptions:[],clusterCodeOptions:[],clusterBCUOptions:{},BCUCodeOptions:[],loadingArmCodeOptions:[],compartmentManualEntrySaveEnabled:!1,recordWeightSaveEnabled:!1,FPAttributeMetaDataList:[],BPAttributeMetaDataList:[],additiveAttributeMetaDataList:[],manualEntrySelectedAttributeList:[],manualEntryAttributeValidationErrorList:[],auditTrailAttributeMetaDataList:[],carrierCodeOptions:[],trailerCodeOptions:[],railWagonAssignmentData:{CarrierCompanyCode:"",TrailerCode:""},modRailWagonList:[],selectedRailWagons:[],railWagonAssignmentSaveEnabled:!1,productAssignmentSaveEnabled:!1,loadSpotAssignmentSaveEnabled:!1,railWagonBatchPlanList:[],modRailWagonBatchPlanList:[],spurCodeOptions:[],loadSpotClusterCodeOptions:[],loadSpotBCUCodeOptions:[],selectedAssociations:[],railRouteData:{DestinationCode:"",DepartureTime:""},isOpenSubPage:!1,saveEnabled:!1,compartmentSaveEnabled:!1,tabActiveIndex:0,manualEntryTabActiveIndex:0,loadingDetailsHideColumnList:[],modalData:{forceCompleteCompartment:{isOpen:!1,data:{trailerCode:""}},printAuditTrail:{isOpen:!1}},contractData:[],railDispatchKPIList:[],maxNumberOfCompartments:60,showAuthenticationLayout:!1,showWagonAssignmentAuthenticationLayout:!1,showProductAssignmentAuthenticationLayout:!1,showLoadSpotAssignmentAuthenticationLayout:!1,showManualEntryAuthenticationLayout:!1,tempRailDispatch:{},tempLoadingInfo:{},isShowMultipleSpurs:!1},this.handleChange=(e,t)=>{try{const a=D().cloneDeep(this.state.modRailDispatch),i=D().cloneDeep(this.state.validationErrors);a[e]=t,"Active"===e?t!==this.state.railDispatch.Active&&(a.Remarks=""):"RouteCode"===e&&this.getRailRoute(t),this.setState({modRailDispatch:a}),void 0!==v.td[e]&&(i[e]=u.jr(v.td[e],t),this.setState({validationErrors:i})),"TerminalCodes"===e&&this.terminalSelectionChange(t)}catch(a){console.log("RailDispatchDetailsComposite:Error occurred on handleChange",a)}},this.handleDateTextChange=(e,t,a)=>{try{const i=D().cloneDeep(this.state.validationErrors),s=D().cloneDeep(this.state.modRailDispatch);i[e]=a,s[e]=t,this.setState({validationErrors:i,modRailDispatch:s})}catch(a){console.log("RailDispatchDetailsComposite: Error occurred on handleDateTextChange",a)}},this.handleCellDataEdit=(e,t)=>{const a=D().cloneDeep(this.state.modAssociations);if(a[t.rowIndex][t.field]=e,"ShareholderCode"===t.field)a[t.rowIndex].FinishedProductCode="",a[t.rowIndex].CustomerCode="",a[t.rowIndex].DestinationCode="";else if("CustomerCode"===t.field){const i=D().cloneDeep(this.state.customerDestinationOptions);if(void 0!==i[a[t.rowIndex].ShareholderCode]&&null!==i[a[t.rowIndex].ShareholderCode]){const s=i[a[t.rowIndex].ShareholderCode];void 0!==s[e]&&Array.isArray(s[e])&&1===s[e].length?a[t.rowIndex].DestinationCode=s[e][0]:a[t.rowIndex].DestinationCode=""}}else if(("FinishedProductCode"===t.field||"RailWagonCategory"===t.field)&&null!==a[t.rowIndex].FinishedProductCode&&null!==a[t.rowIndex].RailWagonCategory)return void this.getFinishedProduct(a[t.rowIndex].FinishedProductCode,a[t.rowIndex].ShareholderCode,(e=>{this.getRailWagonCategoryDetails(a[t.rowIndex].RailWagonCategory,e.ProductType,(e=>{a[t.rowIndex].PlannedQuantity=parseFloat(e.MaxLoadableWeight),this.setState({modAssociations:a})}))}));this.setState({modAssociations:a})},this.handleWagonCellDataEditOld=(e,t,a)=>{const i=D().cloneDeep(this.state.modWagonDetails),s=D().cloneDeep(this.state.expandedWagonRows);let o="";if("ForceComplete"===t&&!0===e){const e=D().cloneDeep(this.state.modalData);e.forceCompleteCompartment.isOpen=!0,e.forceCompleteCompartment.data.trailerCode=a.TrailerCode,o=!0,this.setState({modalData:e})}else o=!1;for(let n of i)if(n.TrailerCode===a.TrailerCode){n[t]=e,""!==o&&(n.isSave=o);break}for(let n of s)if(n.TrailerCode===a.TrailerCode){n[t]=e;break}this.setState({modWagonDetails:i,expandedWagonRows:s})},this.handleWagonCellDataEdit=(e,t)=>{const a=D().cloneDeep(this.state.modWagonDetails),i=D().cloneDeep(this.state.expandedWagonRows);let s="";if("ForceComplete"===t.field&&!0===e){const e=D().cloneDeep(this.state.modalData);e.forceCompleteCompartment.isOpen=!0,e.forceCompleteCompartment.data.trailerCode=t.rowData.TrailerCode,s=!0,this.setState({modalData:e})}else s=!1;for(let o of a)if(o.TrailerCode===t.rowData.TrailerCode){o[t.field]=e,""!==s&&(o.isSave=s);break}for(let o of i)if(o.TrailerCode===t.rowData.TrailerCode){o[t.field]=e;break}this.setState({modWagonDetails:a,expandedWagonRows:i})},this.handleForceCompleteCompartment=()=>{const e=D().cloneDeep(this.state.modWagonDetails),t=D().cloneDeep(this.state.expandedWagonRows),a=D().cloneDeep(this.state.modalData);for(let i of e)if(i.TrailerCode===a.forceCompleteCompartment.data.trailerCode){i.ForceComplete=!0;break}for(let i of t)if(i.TrailerCode===a.forceCompleteCompartment.data.trailerCode){i.ForceComplete=!0;break}a.forceCompleteCompartment.isOpen=!1,this.setState({modWagonDetails:e,expandedWagonRows:t,modalData:a})},this.handleAssociationSelectionChange=e=>{this.setState({selectedAssociations:e})},this.handleAddAssociation=()=>{if(!this.props.userDetails.EntityResult.IsArchived)try{const e=D().cloneDeep(this.state.modAssociations),t={LoadedQuantity:null,LoadedQuantityUOM:null,DispatchCode:null,ShareholderCode:null,CustomerCode:null,ContractCode:null,DestinationCode:null,FinishedProductCode:null,RailWagonCategory:null,PlannedNoOfRailWagons:null,PlannedQuantity:0,AdjustedPlanQuantity:null,QuantityUOM:null,AssociatedOrderItems:null,AssociatedContractItems:null,Attributes:[]};t.SeqNumber=u.Mz(this.state.modAssociations),t.ShareholderCode=this.props.selectedShareholder,e.push(t),this.setState({modAssociations:e,selectedAssociations:[]},(()=>{if(!1===this.props.userDetails.EntityResult.IsEnterpriseNode){const e=D().cloneDeep(this.state.compartmentAttributeMetaDataList);e.length>0&&this.formCompartmentAttributes([e[0].TerminalCode])}else this.formCompartmentAttributes(this.state.modRailDispatch.TerminalCodes)}))}catch(e){console.log("RailDispatchDetailsComposite:Error occurred on handleAddAssociation",e)}},this.handleDeleteAssociation=()=>{if(!this.props.userDetails.EntityResult.IsArchived)try{if(null!=this.state.selectedAssociations&&this.state.selectedAssociations.length>0&&this.state.modAssociations.length>0){let e=D().cloneDeep(this.state.modAssociations);this.state.selectedAssociations.forEach(((t,a)=>{e=e.filter(((e,a)=>e.SeqNumber!==t.SeqNumber))})),this.setState({modAssociations:e})}this.setState({selectedAssociations:[]})}catch(e){console.log("RailDispatchDetailsComposite:Error occurred on handleDeleteAssociation",e)}},this.handleAllTerminalsChange=e=>{try{const t=D().cloneDeep(this.props.terminalCodes),a=D().cloneDeep(this.state.modRailDispatch);a.TerminalCodes=e?[...t]:[],this.terminalSelectionChange(a.TerminalCodes),this.setState({modRailDispatch:a})}catch(t){console.log("RailDispatchDetailsComposite:Error occurred on handleAllTerminalsChange",t)}},this.saveRailDispatch=()=>{this.handleAuthenticationClose();try{this.setState({saveEnabled:!1});let e=D().cloneDeep(this.state.tempRailDispatch);""===this.state.railDispatch.DispatchCode?this.createRailDispatch(e):this.updateRailDispatch(e)}catch(e){console.log("RailShipComposite : Error in addUpdateRailDispatch")}},this.handleSave=()=>{try{let e=D().cloneDeep(this.state.modRailDispatch);e.DispatchItemPlanList=this.getCompartmentsFromAssociations(this.state.modAssociations);const t=u.pI(this.state.selectedAttributeList);if(this.validateSave(e,t)){e=this.fillAttributeDetails(e,t),e.DispatchItemPlanList.forEach((e=>{e.PlannedNoOfRailWagons=null===e.PlannedNoOfRailWagons?null:u.bo(e.PlannedNoOfRailWagons),e.PlannedQuantity=u.bo(e.PlannedQuantity),e.AdjustedPlanQuantity=u.bo(e.PlannedQuantity),null!==e.AssociatedContractItems&&void 0!==e.AssociatedContractItems&&e.AssociatedContractItems.length>0&&Array.isArray(e.AssociatedContractItems)&&e.AssociatedContractItems.forEach((t=>{t.ContractItemQuantity=null!==e.PlannedQuantity&&""!==e.PlannedQuantity?u.bo(e.PlannedQuantity):null,t.PlannedNoOfRailWagons=e.PlannedNoOfRailWagons})),void 0!==e.AttributesForUI&&null!=e.AttributesForUI&&(e.AttributesForUI=u.mr(e.AttributesForUI)),void 0!==e.Attributes&&null!=e.Attributes&&e.Attributes.length>0&&(e.Attributes=u.mr(e.Attributes))}));let a=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,i=D().cloneDeep(e);this.setState({showAuthenticationLayout:a,tempRailDispatch:i},(()=>{!1===a&&this.saveRailDispatch()}))}else this.setState({saveEnabled:!0})}catch(e){console.log("RailDispatchDetailsComposite: Error occurred on handleSave",e)}},this.handleReset=()=>{try{const e=D().cloneDeep(this.state.validationErrors),t=D().cloneDeep(this.state.railDispatch);if("READY"!==t.DispatchStatus)return void this.getRailDispatch({Common_Code:t.DispatchCode},!0);Object.keys(e).forEach((function(t){e[t]=""})),t.RouteCode?(this.setState({modRailDispatch:t,modAssociations:this.getAssociationsFromDispatch(t),validationErrors:e},(()=>{this.props.userDetails.EntityResult.IsEnterpriseNode?(this.terminalSelectionChange(t.TerminalCodes),this.handleResetAttributeValidationError()):(this.localNodeAttribute(),this.handleResetAttributeValidationError())})),this.getRailRoute(t.RouteCode)):this.setState({modRailDispatch:t,modAssociations:this.getAssociationsFromDispatch(t),validationErrors:e,railRouteData:{DestinationCode:"",DepartureTime:""}},(()=>{this.props.userDetails.EntityResult.IsEnterpriseNode?(this.terminalSelectionChange(t.TerminalCodes),this.handleResetAttributeValidationError()):(this.localNodeAttribute(),this.handleResetAttributeValidationError())}))}catch(e){console.log("RailDispatchDetailsComposite: Error occurred on handleReset",e)}},this.toggleExpand=function(t,a){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=D().cloneDeep(e.state.expandedRows);const o=s.findIndex((e=>e.SeqNumber===t.SeqNumber));a?i&&o>=0?(s.splice(o,1),s.push(t)):o>=0&&s.splice(o,1):o>=0?s=s.filter((e=>e.Code!==t.Code&&e.SeqNumber!==t.SeqNumber)):s.push(t),e.setState({expandedRows:s})},this.toggleWagonExpand=(e,t)=>{let a=D().cloneDeep(this.state.expandedWagonRows),i=a.findIndex((t=>t.TrailerCode===e.TrailerCode));t?a.splice(i,1):a.push(e),this.setState({expandedWagonRows:a})},this.handleCompartmentSave=()=>{try{this.setState({compartmentSaveEnabled:!1});const e=[];for(let t of this.state.modWagonDetails)(!0===t.isSave||null!==t.AdjustedQty&&void 0!==t.AdjustedQty&&""!==t.AdjustedQty)&&e.push({TrailerCode:t.TrailerCode,CarrierCompanyCode:t.CarrierCompanyCode,AdjustedQuantity:t.AdjustedQty,ForceCompleted:t.ForceComplete});this.validateCompartmentSave(e)?this.updateRailDispatchCompartInfo(e):this.setState({compartmentSaveEnabled:!0})}catch(e){console.log("RailDispatchDetailsComposite: Error occurred on handleCompartmentSave",e)}},this.handleRouteSearchChange=e=>{try{let t=this.state.routeCodeOptions.filter((t=>t.value.toLowerCase().includes(e.toLowerCase())));t.length>h.bM&&(t=t.slice(0,h.bM)),this.setState({routeCodeSearchOptions:t})}catch(t){console.log("RailDispatchDetailsComposite: Error occurred on handleRouteSearchChange",t)}},this.handleManualDateTextChange=(e,t,a)=>{try{const i=D().cloneDeep(this.state.manualEntryValidationDict),s=D().cloneDeep(this.state.modLoadingDataInfo);i.common[e]=a,s.TransactionFPinfo[e]=t,this.setState({manualEntryValidationDict:i,modLoadingDataInfo:s})}catch(a){console.log("RailDispatchDetailsComposite: Error occurred on handleDateTextChange",a)}},this.handleTankSearchChange=e=>{try{let t=this.state.tankCodeOptions.filter((t=>t.value.toLowerCase().includes(e.toLowerCase())));t.length>h.bM&&(t=t.slice(0,h.bM)),this.setState({tankCodeSearchOptions:t})}catch(t){console.log("RailDispatchDetailsComposite: Error occurred on handleRouteSearchChange",t)}},this.handleMeterSearchChange=e=>{try{let t=this.state.meterCodeOptions.filter((t=>t.value.toLowerCase().includes(e.toLowerCase())));t.length>h.bM&&(t=t.slice(0,h.bM)),this.setState({meterCodeSearchOptions:t})}catch(t){console.log("RailDispatchDetailsComposite: Error occurred on handleMeterSearchChange",t)}},this.handleAttributeCellDataEdit=(e,t)=>{try{e.DefaultValue=t;const a=D().cloneDeep(this.state.attributeValidationErrors);a.forEach((a=>{a.TerminalCode===e.TerminalCode&&(a.attributeValidationErrors[e.Code]=u.I5(e,t))})),this.setState({attribute:e,attributeValidationErrors:a})}catch(a){console.log("RailDispatchDetailsComposite: Error occurred on handleAttributeCellDataEdit",a)}},this.handleCompAttributeCellDataEdit=(e,t)=>{const a=D().cloneDeep(this.state.modAssociations);let i=a.findIndex((t=>t.SeqNumber===e.rowData.compSequenceNo));i>=0&&(a[i].AttributesForUI[e.rowData.compSequenceNo-1].AttributeValue=t),this.setState({modAssociations:a}),i>=0&&this.toggleExpand(a[i],!0,!0)},this.handleSubPageBackOnClick=()=>{try{this.setState({isOpenSubPage:!1}),this.props.onSubPageBack()}catch(e){console.log("RailDispatchDetailsComposite: Error occurred on handleSubPageBackOnClick",e)}},this.handleTabChange=e=>{try{this.setState({tabActiveIndex:e}),0===e&&this.setState({saveEnabled:u.ab(this.props.userDetails.EntityResult.FunctionsList,F.i.modify,F.xz)&&"READY"===this.state.modRailDispatch.DispatchStatus}),1===e&&this.setState({compartmentSaveEnabled:this.checkCompartmentSaveEnabled(this.state.modWagonDetails)})}catch(t){console.log("RailDispatchDetailsComposite: Error occurred on handleTabChange",t)}},this.handleModalDataChange=e=>{this.setState({modalData:e})},this.handleManualEntry=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{const a={messageType:"critical",message:"CompartmentManualEntry_OpenStatus",messageResultDetails:[{keyFields:["RailDispatchPlanDetail_DispatchCode"],keyValues:[e.state.modRailDispatch.DispatchCode],isSuccess:!1,errorMessage:"WagonStatusForManualEntryInvalid"}]};if(e.state.modWagonDetails.length>0){const i=e.checkManualEntryEnabled(e.state.modWagonDetails);""!==i||e.state.isOpenSubPage?e.preprocessManualEntryData(i,(a=>{t?e.setState({isOpenSubPage:!0,compartmentManualEntrySaveEnabled:""!==i&&a,isReadyToRender:!0,manualEntryTabActiveIndex:0},(()=>e.props.onSetRightPaneDisplay(!1))):e.setState({isOpenSubPage:!0,compartmentManualEntrySaveEnabled:""!==i&&a,manualEntryTabActiveIndex:0},(()=>e.props.onSetRightPaneDisplay(!1)))})):(e.props.onNotify(a),e.props.onSubPageBack())}else e.handleSubPageBackOnClick(),e.props.onNotify(a)}catch(a){console.log("RailDispatchDetailsComposite: Error occurred on handleManualEntry",a)}},this.handleManualEntryTabChange=e=>{try{this.setState({manualEntryTabActiveIndex:e})}catch(t){console.log("RailDispatchDetailsComposite: Error occurred on handleManualEntryTabChange",t)}},this.handleCompartmentManualEntryChange=function(t,a){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{if("TrailerCode"===t)return void e.preprocessManualEntryData(a,(()=>{e.setState({compartmentManualEntrySaveEnabled:!0})}));const o=D().cloneDeep(e.state.modLoadingDataInfo),n=D().cloneDeep(e.state.manualEntryValidationDict);void 0!==i.type?void 0!==i.index?o[i.type][i.index][t]=a:o[i.type][t]=a:o.CommonInfo[t]=a,void 0!==s.category&&("common"===s.category?void 0!==v.Jg[t]&&(n.common[t]=u.jr(v.Jg[t],a),e.setState({manualEntryValidationDict:n})):"product"===s.category&&void 0!==v.Jg[t]&&(n.product[s.index][t]=u.jr(v.Jg[t],a),e.setState({manualEntryValidationDict:n})));let r=!1;if("BayCode"===t){n.bayCode=u.jr(v.Jg.BayCode,a);let t=u.Zj(e.state.clusterBCUOptions[a]);e.setState({manualEntryValidationDict:n,BCUCodeOptions:t}),1===t.length&&(r=!0,o.CommonInfo.BCUCode=e.state.clusterBCUOptions[a][0],e.getDefaultUOMs(o.CommonInfo.BCUCode))}else"BCUCode"===t&&(e.getDefaultUOMs(o.CommonInfo.BCUCode),r=!0);e.setState({modLoadingDataInfo:o}),r&&e.getLoadingArms(o.CommonInfo.BCUCode,(t=>{const a=[];if(Array.isArray(t)){for(let e of t)a.push(e);1===a.length&&(o.TransactionFPinfo.ArmCode=a[0],e.GetMetersForLA(o.CommonInfo.BCUCode,a[0]),e.setState({modLoadingDataInfo:o}))}e.setState({loadingArmCodeOptions:u.Zj(a)})}))}catch(o){console.log("RailDispatchDetailsComposite: Error occurred on handleCompartmentManualEntryChange",o)}},this.handleManualEntryDateTextChange=(e,t,a,i)=>{try{const s=D().cloneDeep(this.state.manualEntryValidationDict),o=D().cloneDeep(this.state.modLoadingDataInfo);s.common[e]=a,o[i.type][e]=t,this.setState({manualEntryValidationDict:s,modLoadingDataInfo:o})}catch(a){console.log("RailDispatchDetailsComposite: Error occurred on handleManualEntryDateTextChange",a)}},this.handleManualEntryAttributeCellDataEdit=(e,t,a)=>{try{e.DefaultValue=t;const i=D().cloneDeep(this.state.manualEntryAttributeValidationErrorList);i[a].forEach((a=>{a.TerminalCode===e.TerminalCode&&(a.attributeValidationErrors[e.Code]=u.I5(e,t))})),this.setState({manualEntryAttributeValidationErrorList:i})}catch(i){console.log("RailDispatchDetailsComposite: Error occurred on handleManualEntryAttributeCellDataEdit",i)}},this.handleCompartmentManualEntryReset=()=>{try{const e=D().cloneDeep(this.state.loadingDataInfo),[t,a]=this.initialManualEntrySelectedAttribute(e);this.setState({modLoadingDataInfo:e,manualEntryValidationDict:this.initialManualEntryValidationErrors(e),manualEntrySelectedAttributeList:t,manualEntryAttributeValidationErrorList:a})}catch(e){console.log("RailDispatchDetailsComposite:Error occurred on handleReset",e)}},this.handleCompartmentManualEntrySave=()=>{try{const e=D().cloneDeep(this.state.modLoadingDataInfo);if(this.validateManualEntry(e)){e.TransactionFPinfo.GrossQuantity=u.bo(e.TransactionFPinfo.GrossQuantity),e.TransactionFPinfo.NetQuantity=u.bo(e.TransactionFPinfo.NetQuantity),e.TransactionFPinfo.Temperature=u.bo(e.TransactionFPinfo.Temperature),e.TransactionFPinfo.ProductDensity=u.bo(e.TransactionFPinfo.ProductDensity),e.TransactionFPinfo.StartTotalizer=u.bo(e.TransactionFPinfo.StartTotalizer),e.TransactionFPinfo.EndTotalizer=u.bo(e.TransactionFPinfo.EndTotalizer),e.TransactionFPinfo.NetStartTotalizer=u.bo(e.TransactionFPinfo.NetStartTotalizer),e.TransactionFPinfo.NetEndTotalizer=u.bo(e.TransactionFPinfo.NetEndTotalizer),e.TransactionFPinfo.CalculatedGross=u.bo(e.TransactionFPinfo.CalculatedGross),e.TransactionFPinfo.CalculatedNet=u.bo(e.TransactionFPinfo.CalculatedNet);for(let i in e.ArrTransactionBP)e.ArrTransactionBP[i].StartTime=e.TransactionFPinfo.StartTime,e.ArrTransactionBP[i].EndTime=e.TransactionFPinfo.EndTime,e.ArrTransactionBP[i].ArmCode=e.TransactionFPinfo.ArmCode,e.ArrTransactionBP[i].QuantityUOM=e.TransactionFPinfo.QuantityUOM,e.ArrTransactionBP[i].TransactionID=e.TransactionFPinfo.TransactionID,e.ArrTransactionBP[i].FinishedProductCode=e.TransactionFPinfo.FinishedProductCode,e.ArrTransactionBP[i].GrossQuantity=u.bo(e.ArrTransactionBP[i].GrossQuantity),e.ArrTransactionBP[i].NetQuantity=u.bo(e.ArrTransactionBP[i].NetQuantity),e.ArrTransactionBP[i].Temperature=u.bo(e.ArrTransactionBP[i].Temperature),e.ArrTransactionBP[i].ProductDensity=u.bo(e.ArrTransactionBP[i].ProductDensity),e.ArrTransactionBP[i].StartTotalizer=u.bo(e.ArrTransactionBP[i].StartTotalizer),e.ArrTransactionBP[i].EndTotalizer=u.bo(e.ArrTransactionBP[i].EndTotalizer),e.ArrTransactionBP[i].NetStartTotalizer=u.bo(e.ArrTransactionBP[i].NetStartTotalizer),e.ArrTransactionBP[i].NetEndTotalizer=u.bo(e.ArrTransactionBP[i].NetEndTotalizer),e.ArrTransactionBP[i].CalculatedGross=u.bo(e.ArrTransactionBP[i].CalculatedGross),e.ArrTransactionBP[i].CalculatedNet=u.bo(e.ArrTransactionBP[i].CalculatedNet);for(let i in e.ArrTransactionAdditive)e.ArrTransactionAdditive[i].StartTime=e.TransactionFPinfo.StartTime,e.ArrTransactionAdditive[i].EndTime=e.TransactionFPinfo.EndTime,e.ArrTransactionAdditive[i].ArmCode=e.TransactionFPinfo.ArmCode,e.ArrTransactionAdditive[i].QuantityUOM=e.TransactionFPinfo.QuantityUOM,e.ArrTransactionAdditive[i].TransactionID=e.TransactionFPinfo.TransactionID,e.ArrTransactionAdditive[i].FinishedProductCode=e.TransactionFPinfo.FinishedProductCode,e.ArrTransactionAdditive[i].GrossQuantity=u.bo(e.ArrTransactionAdditive[i].GrossQuantity),e.ArrTransactionAdditive[i].NetQuantity=u.bo(e.ArrTransactionAdditive[i].NetQuantity),e.ArrTransactionAdditive[i].Temperature=u.bo(e.ArrTransactionAdditive[i].Temperature),e.ArrTransactionAdditive[i].ProductDensity=u.bo(e.ArrTransactionAdditive[i].ProductDensity),e.ArrTransactionAdditive[i].StartTotalizer=u.bo(e.ArrTransactionAdditive[i].StartTotalizer),e.ArrTransactionAdditive[i].EndTotalizer=u.bo(e.ArrTransactionAdditive[i].EndTotalizer),e.ArrTransactionAdditive[i].NetStartTotalizer=u.bo(e.ArrTransactionAdditive[i].NetStartTotalizer),e.ArrTransactionAdditive[i].NetEndTotalizer=u.bo(e.ArrTransactionAdditive[i].NetEndTotalizer),e.ArrTransactionAdditive[i].CalculatedGross=u.bo(e.ArrTransactionAdditive[i].CalculatedGross),e.ArrTransactionAdditive[i].CalculatedNet=u.bo(e.ArrTransactionAdditive[i].CalculatedNet);this.fillManualEntryAttributeDetails(e);let t=D().cloneDeep(e),a=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showManualEntryAuthenticationLayout:a,tempLoadingInfo:t},(()=>{!1===a&&this.addLoadingDetails()}))}else this.setState({compartmentManualEntrySaveEnabled:!0})}catch(e){console.log("RailDispatchDetailsComposite:Error occurred on handleSave",e)}},this.addLoadingDetails=()=>{try{this.handleAuthenticationClose(),this.setState({compartmentManualEntrySaveEnabled:!1});let e=D().cloneDeep(this.state.tempLoadingInfo);this.saveManualEntry(e)}catch(e){console.log("Rail Loading DetailsComposite : Error in save Rail Loading details")}},this.handleViewAuditTrail=()=>{try{this.getAuditTrail()}catch(e){console.log("RailDispatchDetailsComposite: Error occurred on handleViewAuditTrail",e)}},this.handleOpenPrintAuditTrailPreview=()=>{const e=D().cloneDeep(this.state.modalData);e.printAuditTrail.isOpen=!0,this.setState({modalData:e})},this.handlePrintAuditTrail=e=>{let t=window.document.getElementById("printTable").innerHTML;const a=window.document.createElement("iframe");let i=null;window.document.body.appendChild(a),i=a.contentWindow.document;const s=t.substring(0,t.indexOf("<table")+6),o=t.substring(t.indexOf("<table")+6,t.length);t=e+s+' border="1" cellspacing="0"'+o,t=t.replace('<tfoot class="p-datatable-tfoot">',""),t=t.replace('<tr><td class="compColHeight"></td><td class="compColHeight"></td><td class="compColHeight"></td><td class="compColHeight"></td><td class="compColHeight"></td><td class="compColHeight"></td></tr>',""),i.write(t),i.close(),a.contentWindow.focus(),a.contentWindow.print(),setTimeout((()=>{window.document.body.removeChild(a)}),2e3);const n=D().cloneDeep(this.state.modalData);n.printAuditTrail.isOpen=!1,this.setState({modalData:n})},this.handleViewLoadingDetails=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e.props.getLookUpData("ViewRailDispatch",(a=>{const i=(a.ViewRailLoadingDetailsFields1+h.uV+a.ViewRailLoadingDetailsFields2).split(h.uV),s=[];for(let e of i){const t=e.split(":");2===t.length&&"0"===t[1]&&s.push(t[0])}e.setState({loadingDetailsHideColumnList:s}),e.getLoadingDetails(t)}))}catch(a){console.log("RailDispatchDetailsComposite: Error occurred on handleViewLoadingDetails",a)}},this.handleOpenRailWagonAssignment=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e.initialRailWagonAssignmentList(),t?e.setState({isOpenSubPage:!0,isReadyToRender:!0,railWagonAssignmentSaveEnabled:!0},(()=>e.props.onSetRightPaneDisplay(!1))):e.setState({isOpenSubPage:!0,railWagonAssignmentSaveEnabled:!0},(()=>e.props.onSetRightPaneDisplay(!1)))}catch(a){console.log("RailDispatchDetailsComposite: Error occurred on handleOpenRailWagonAssignment",a)}},this.handleRailWagonAssignmentChange=(e,t)=>{const a=D().cloneDeep(this.state.railWagonAssignmentData);a[e]=t,"CarrierCompanyCode"===e&&this.getTrailerCodes(t),this.setState({railWagonAssignmentData:a})},this.handleRailWagonSelectionChange=e=>{this.setState({selectedRailWagons:e})},this.handleRailWagonAssignmentAdd=()=>{if(!this.props.userDetails.EntityResult.IsArchived)try{const e={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[]};if(""===this.state.railWagonAssignmentData.CarrierCompanyCode)return e.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"RailDispatchWagonAssignment_CarrierEmpty"}),void this.props.onNotify(e);if(""===this.state.railWagonAssignmentData.TrailerCode)return e.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"RailDispatchWagonAssignment_RailWagonEmpty"}),void this.props.onNotify(e);const t={DispatchCode:this.state.modRailDispatch.DispatchCode,WagonCode:this.state.railWagonAssignmentData.TrailerCode,CarrierCode:this.state.railWagonAssignmentData.CarrierCompanyCode,TMWebApiRequest:{ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,KeyCodes:[{key:"RailDispatchCode",value:this.state.modRailDispatch.DispatchCode}]}};e.messageResultDetails.push({keyFields:["ViewRailLoadingDetails_RailWagonCode"],keyValues:[this.state.railWagonAssignmentData.TrailerCode],isSuccess:!1,errorMessage:""}),I()(N.bMo,u.tW(t,this.props.tokenDetails.tokenInfo)).then((t=>{const a=t.data;if(e.messageType=a.IsSuccess?"success":"critical",e.messageResultDetails[0].isSuccess=a.IsSuccess,!0===a.IsSuccess){const e=D().cloneDeep(this.state.railWagonAssignmentData),t=D().cloneDeep(this.state.modRailWagonList),a={SequenceNo:t.length+1,AssociatedOrderItems:"",CompartmentSeqNoInVehicle:"",QuantityUOM:"",Quantity:"",TrailerCode:e.TrailerCode,CarrierCompanyCode:e.CarrierCompanyCode,CompartmentCode:"",ShareholderCode:"",FinishedProductCode:"",CustomerCode:"",DestinationCode:"",DispatchCode:this.state.modRailDispatch.DispatchCode,AssociatedContractItems:[],Attributes:[]};t.push(a),e.TrailerCode="",this.setState({modRailWagonList:t,selectedRailWagons:[],railWagonAssignmentData:e})}else console.log("Error in RailDispatchValidateWagonToAssign: ",a.ErrorList),e.messageResultDetails[0].errorMessage=a.ErrorList[0],this.props.onNotify(e)})).catch((t=>{console.log("Error while RailDispatchValidateWagonToAssign: ",t),e.messageResultDetails[0].errorMessage=t,this.props.onNotify(e)}))}catch(e){console.log("RailDispatchDetailsComposite: Error occurred on handleRailWagonAssignmentAdd",e)}},this.handleRailWagonAssignmentDelete=()=>{if(!this.props.userDetails.EntityResult.IsArchived)try{if(this.state.selectedRailWagons.length>0&&this.state.modRailWagonList.length>0){let e=D().cloneDeep(this.state.modRailWagonList);this.state.selectedRailWagons.forEach(((t,a)=>{e=e.filter(((e,a)=>e.SequenceNo!==t.SequenceNo))}));for(let t=0;t<e.length;t++)e[t].SequenceNo=t+1;this.setState({modRailWagonList:e})}this.setState({selectedRailWagons:[]})}catch(e){console.log("RailDispatchDetailsComposite: Error occurred on handleRailWagonAssignmentDelete",e)}},this.handleRailWagonAssignmentMove=e=>{try{if(this.state.modRailWagonList.length>0&&1===this.state.selectedRailWagons.length){const t=D().cloneDeep(this.state.modRailWagonList);let a;for(a=0;a<t.length&&t[a].SequenceNo!==this.state.selectedRailWagons[0].SequenceNo;a++);if(e){if(0===a)return;const e=t[a-1].TrailerCode;t[a-1].TrailerCode=t[a].TrailerCode,t[a].TrailerCode=e,this.setState({modRailWagonList:t,selectedRailWagons:[D().cloneDeep(t[a-1])]})}else{if(a===t.length-1)return;const e=t[a+1].TrailerCode;t[a+1].TrailerCode=t[a].TrailerCode,t[a].TrailerCode=e,this.setState({modRailWagonList:t,selectedRailWagons:[D().cloneDeep(t[a+1])]})}}else{const e={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[{keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"ERRMSG_RAILWAGONSEQUENCE"}]};this.props.onNotify(e)}}catch(t){console.log("RailDispatchDetailsComposite: Error occurred on handleRailWagonAssignmentMove",t)}},this.handleRailWagonAssignmentReverseSelect=()=>{try{const e=[];for(let t of this.state.modRailWagonList){let a=!1;for(let e of this.state.selectedRailWagons)if(t.SequenceNo===e.SequenceNo){a=!0;break}a||e.push(t)}this.setState({selectedRailWagons:e})}catch(e){console.log("RailDispatchDetailsComposite: Error occurred on handleRailWagonAssignmentReverseSelect",e)}},this.handleRailWagonAssignReset=()=>{try{this.initialRailWagonAssignmentList()}catch(e){console.log("RailDispatchDetailsComposite: Error occurred on handleRailWagonAssignReset",e)}},this.handleRailWagonAssignSave=()=>{try{const e=D().cloneDeep(this.state.modRailDispatch);e.DispatchCompartmentDetailPlanList=this.getCompartmentsFromRailWagonList(this.state.modRailWagonList);let t={messageType:"critical",message:"ViewRailDispatch_WagonAssign_status",messageResultDetails:[]};if(this.state.maxNumberOfCompartments<this.state.modRailWagonList.length)t.messageResultDetails.push({keyFields:["RailDispatchPlanDetail_DispatchCode"],keyValues:[e.DispatchCode],isSuccess:!1,errorMessage:"Wagon_limit_Exceeded"}),this.props.onNotify(t);else{let t=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,a=D().cloneDeep(e);this.setState({showWagonAssignmentAuthenticationLayout:t,tempRailDispatch:a},(()=>{!1===t&&this.railWagonSave()}))}}catch(e){console.log("RailDispatchDetailsComposite: Error occurred on handleRailWagonAssignSave",e)}},this.railWagonSave=()=>{this.handleAuthenticationClose();const e=D().cloneDeep(this.state.tempRailDispatch);this.setState({railWagonAssignmentSaveEnabled:!1});const t={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:O.s0,KeyCodes:[{key:O.s0,value:e.DispatchCode}],Entity:e},a={messageType:"critical",message:"ViewRailDispatch_WagonAssign_status",messageResultDetails:[{keyFields:["RailDispatchPlanDetail_DispatchCode"],keyValues:[e.DispatchCode],isSuccess:!1,errorMessage:""}]};I()(N.Pq1,u.tW(t,this.props.tokenDetails.tokenInfo)).then((t=>{const i=t.data;a.messageType=i.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess?this.getRailDispatch({Common_Code:e.DispatchCode},!0):(a.messageResultDetails[0].errorMessage=i.ErrorList[0],this.setState({railWagonAssignmentSaveEnabled:!0}),console.log("Error in UpdateRailDispatchPlanWithWagon: ",i.ErrorList)),this.props.onNotify(a)})).catch((e=>{this.setState({railWagonAssignmentSaveEnabled:!0}),a.messageResultDetails[0].errorMessage=e,this.props.onNotify(a)}))},this.handleOpenProductAssignment=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e.initialProductAssignmentList((()=>{t?e.setState({isOpenSubPage:!0,isReadyToRender:!0,productAssignmentExpandedRows:[]},(()=>e.props.onSetRightPaneDisplay(!1))):e.setState({isOpenSubPage:!0,productAssignmentExpandedRows:[]},(()=>e.props.onSetRightPaneDisplay(!1)))}))}catch(a){console.log("RailDispatchDetailsComposite: Error occurred on handleOpenProductAssignment",a)}},this.getProductAssignmentQuantity=function(t,a){e.setState({modRailWagonList:t},(()=>{if(!1===e.props.userDetails.EntityResult.IsEnterpriseNode){const t=D().cloneDeep(e.state.wagonDetailPlanAttributeMetaDataList);t.length>0&&e.formProductAssignmentAttributes([t[0].TerminalCode])}else e.formProductAssignmentAttributes(e.state.modRailDispatch.TerminalCodes);a()}))},this.handleProductAssignmentCellDataEdit=(e,t)=>{const a=D().cloneDeep(this.state.modRailWagonList);if(a[t.rowIndex][t.field]=e,"ShareholderCode"===t.field)a[t.rowIndex].FinishedProductCode="",a[t.rowIndex].CustomerCode="",a[t.rowIndex].DestinationCode="";else if("CustomerCode"===t.field){const i=D().cloneDeep(this.state.customerDestinationOptions);if(void 0!==i[a[t.rowIndex].ShareholderCode]&&null!==i[a[t.rowIndex].ShareholderCode]){const s=i[a[t.rowIndex].ShareholderCode];void 0!==s[e]&&Array.isArray(s[e])&&1===s[e].length?a[t.rowIndex].DestinationCode=s[e][0]:a[t.rowIndex].DestinationCode=""}}this.setState({modRailWagonList:a})},this.productAssignmentToggleExpand=function(t,a){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=D().cloneDeep(e.state.productAssignmentExpandedRows);const o=s.findIndex((e=>e.SequenceNo===t.SequenceNo));a?i&&o>=0?(s.splice(o,1),s.push(t)):o>=0&&s.splice(o,1):o>=0?s=s.filter((e=>e.TrailerCode!==t.TrailerCode&&e.SequenceNo!==t.SequenceNo)):s.push(t),e.setState({productAssignmentExpandedRows:s})},this.handleProductAssignmentAttributeCellDataEdit=(e,t)=>{const a=D().cloneDeep(this.state.modRailWagonList);let i=a.findIndex((t=>t.SequenceNo===e.rowData.compSequenceNo));i>=0&&(a[i].AttributesForUI[e.rowData.compSequenceNo-1].AttributeValue=t),this.setState({modRailWagonList:a}),i>=0&&this.productAssignmentToggleExpand(a[i],!0,!0)},this.handleProductAssignReset=()=>{try{this.initialProductAssignmentList()}catch(e){console.log("RailDispatchDetailsComposite: Error occurred on handleProductAssignReset",e)}},this.handleProductAssignSave=()=>{try{const e=D().cloneDeep(this.state.modRailDispatch);if(e.DispatchCompartmentDetailPlanList=this.getCompartmentsFromRailWagonList(this.state.modRailWagonList),this.validateProductAssignSave(e.DispatchCompartmentDetailPlanList)){let t=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,a=D().cloneDeep(e);this.setState({showProductAssignmentAuthenticationLayout:t,tempRailDispatch:a},(()=>{!1===t&&this.productAssignmentSave()}))}else this.setState({productAssignmentSaveEnabled:!0})}catch(e){console.log("RailDispatchDetailsComposite: Error occurred on handleProductAssignSave",e)}},this.productAssignmentSave=()=>{this.handleAuthenticationClose(),this.setState({productAssignmentSaveEnabled:!1});const e=D().cloneDeep(this.state.tempRailDispatch),t={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:O.s0,KeyCodes:[{key:O.s0,value:e.DispatchCode}],Entity:e},a={messageType:"critical",message:"ViewRailDispatch_ProductAssignment_status",messageResultDetails:[{keyFields:["RailDispatchPlanDetail_DispatchCode"],keyValues:[e.DispatchCode],isSuccess:!1,errorMessage:""}]};I()(N.c5n,u.tW(t,this.props.tokenDetails.tokenInfo)).then((t=>{const i=t.data;a.messageType=i.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess?this.getRailDispatch({Common_Code:e.DispatchCode},!0):(a.messageResultDetails[0].errorMessage=i.ErrorList[0],this.setState({productAssignmentSaveEnabled:!0}),console.log("Error in UpdateRailDispatchPlanWithWagon: ",i.ErrorList)),this.props.onNotify(a)})).catch((e=>{this.setState({productAssignmentSaveEnabled:!0}),a.messageResultDetails[0].errorMessage=e,this.props.onNotify(a)}))},this.handleOpenLoadSpotAssignment=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e.initialLoadSpotAssignmentList((()=>{t?e.setState({isOpenSubPage:!0,isReadyToRender:!0},(()=>e.props.onSetRightPaneDisplay(!1))):e.setState({isOpenSubPage:!0},(()=>e.props.onSetRightPaneDisplay(!1)))}))}catch(a){console.log("RailDispatchDetailsComposite: Error occurred on handleOpenLoadSpotAssignment",a)}},this.handleLoadSpotAssignmentCellDataEdit=(e,t)=>{const a=D().cloneDeep(this.state.modRailWagonBatchPlanList);if(a[t.rowIndex][t.field]=e,"SpurCode"===t.field)return this.getRailLoadSpotDevices(e,"CLUSTER"),void this.getRailLoadSpot(e,"SPUR",(e=>{a[t.rowIndex].ClusterCode=e.ClusterCode,a[t.rowIndex].BCUCode=e.BCUCode,a[t.rowIndex].ArmNoInBCU=e.ArmNoInBCU,this.getRailLoadSpotDevices(e.ClusterCode,"BCU"),this.setState({modRailWagonBatchPlanList:a})}));"ClusterCode"===t.field&&this.getRailLoadSpotDevices(e,"BCU"),this.setState({modRailWagonBatchPlanList:a})},this.handleLoadSpotAssignmentAssignWagon=e=>{try{if(e.AllowAuthorize){const t={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:O.s0,KeyCodes:[{key:O.s0,value:this.state.modRailDispatch.DispatchCode}],Entity:e},a={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[{keyFields:["Rail_Receipt_Wagon"],keyValues:[e.RailWagonCode],isSuccess:!1,errorMessage:""}]};I()(N.TBf,u.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;a.messageType=t.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.initialLoadSpotAssignmentList():(a.messageResultDetails[0].errorMessage=t.ErrorList[0],console.log("Error in handleLoadSpotAssignmentAssignWagon: ",t.ErrorList)),this.props.onNotify(a)})).catch((e=>{a.messageResultDetails[0].errorMessage=e,this.props.onNotify(a)}))}}catch(t){console.log("RailDispatchDetailsComposite: Error occurred on handleLoadSpotAssignmentAssignWagon",t)}},this.handleLoadSpotAssignReset=()=>{this.setState({modRailWagonBatchPlanList:D().cloneDeep(this.state.railWagonBatchPlanList)})},this.handleLoadSpotAssignSave=()=>{try{const e=D().cloneDeep(this.state.modRailWagonBatchPlanList);if(this.validateLoadSpotAssignSave(e)){let t=!1;e.forEach((function(a){e.filter((e=>e.SpurCode!=a.SpurCode)).length>0&&(t=!0)})),t?this.setState({isShowMultipleSpurs:!0}):this.saveLoadSpotAfterConfirm()}else this.setState({loadSpotAssignmentSaveEnabled:!0})}catch(e){console.log("RailDispatchDetailsComposite: Error occurred on handleLoadSpotAssignSave",e)}},this.saveLoadSpotAfterConfirm=()=>{this.setState({isShowMultipleSpurs:!1});let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showLoadSpotAssignmentAuthenticationLayout:e},(()=>{!1===e&&this.railLoadSpotSave()}))},this.railLoadSpotSave=()=>{this.handleAuthenticationClose(),this.setState({loadSpotAssignmentSaveEnabled:!1});const e=D().cloneDeep(this.state.modRailWagonBatchPlanList),t={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:O.s0,KeyCodes:[{key:O.s0,value:this.state.modRailDispatch.DispatchCode}],Entity:e},a={messageType:"critical",message:"ViewRailDispatch_LoadSportAssignment_status",messageResultDetails:[{keyFields:["RailDispatchPlanDetail_DispatchCode"],keyValues:[this.state.modRailDispatch.DispatchCode],isSuccess:!1,errorMessage:""}]};I()(N.hMz,u.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;a.messageType=t.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getRailDispatch({Common_Code:this.state.modRailDispatch.DispatchCode}):(a.messageResultDetails[0].errorMessage=t.ErrorList[0],this.setState({loadSpotAssignmentSaveEnabled:!0}),console.log("Error in handleLoadSpotAssignSave: ",t.ErrorList)),this.props.onNotify(a)})).catch((e=>{this.setState({loadSpotAssignmentSaveEnabled:!0}),a.messageResultDetails[0].errorMessage=e,this.props.onNotify(a)}))},this.handleOpenRecordWeight=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{t?e.setState({isOpenSubPage:!0,isReadyToRender:!0,recordWeightSaveEnabled:!0},(()=>e.props.onSetRightPaneDisplay(!1))):e.setState({isOpenSubPage:!0,recordWeightSaveEnabled:!0},(()=>e.props.onSetRightPaneDisplay(!1)))}catch(a){console.log("RailDispatchDetailsComposite: Error occurred on handleOpenRecordWeight",a)}},this.handleRecordWeightCellDataEdit=(e,t)=>{const a=D().cloneDeep(this.state.modWeightBridgeData);a[t.rowIndex][t.field]=e,"TareWeightWeightBridgeCode"===t.field?a[t.rowIndex].TareWeightUOM=this.state.weightBridgeSetting[e].WeightUOM:"LadenWeightWeightBridgeCode"===t.field&&(a[t.rowIndex].LadenWeightUOM=this.state.weightBridgeSetting[e].WeightUOM),this.setState({modWeightBridgeData:a})},this.handleRecordWeightReset=()=>{this.setState({modWeightBridgeData:D().cloneDeep(this.state.weightBridgeData)})},this.handleRecordWeightSave=()=>{try{this.setState({recordWeightSaveEnabled:!1});const e=D().cloneDeep(this.state.modWeightBridgeData);for(let t of e)null!==t.TareWeight&&(t.TareWeight=u.bo(t.TareWeight)),null!==t.LadenWeight&&(t.LadenWeight=u.bo(t.LadenWeight));if(this.validateRecordWeightSave(e)){const t=[],a=new Date;let i=1;for(let n of e)null!==n.TareWeight&&n.TareWeight>0&&(t.push({DispatchCode:this.state.modRailDispatch.DispatchCode,TrailerCode:n.WagonCode,MeasuredWeight:n.TareWeight,WeighedTime:a,IsTareWeight:!0,IsOperatorOverWritable:n.TareWeightOperatorOverWritten,WeighbridgeCode:n.TareWeightWeightBridgeCode,WeightUOM:n.TareWeightUOM,ShareholderCode:this.props.selectedShareholder,IsWeighInOnly:!1,Remarks:"",SequenceNo:i,Attributes:[],FinishedProductCode:n.FinishedProductCode,CarrierCompanyCode:n.CarrierCompanyCode,TransportationType:h.LY.RAIL,StartTime:n.StartTime,EndTime:n.EndTime}),i+=1),null!==n.LadenWeight&&n.LadenWeight>0&&(t.push({DispatchCode:this.state.modRailDispatch.DispatchCode,TrailerCode:n.WagonCode,MeasuredWeight:n.LadenWeight,WeighedTime:a,IsTareWeight:!1,IsOperatorOverWritable:n.LadenWeightOperatorOverWritten,WeighbridgeCode:n.LadenWeightWeightBridgeCode,WeightUOM:n.LadenWeightUOM,ShareholderCode:this.props.selectedShareholder,IsWeighInOnly:!1,Remarks:"",SequenceNo:i,Attributes:[],FinishedProductCode:n.FinishedProductCode,CarrierCompanyCode:n.CarrierCompanyCode,TransportationType:h.LY.RAIL,StartTime:n.StartTime,EndTime:n.EndTime}),i+=1);const s={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:O.s0,KeyCodes:[{key:O.s0,value:this.state.modRailDispatch.DispatchCode}],Entity:t},o={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[{keyFields:["RailDispatchPlanDetail_DispatchCode"],keyValues:[this.state.modRailDispatch.DispatchCode],isSuccess:!1,errorMessage:""}]};I()(N.EAX,u.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;o.messageType=t.IsSuccess?"success":"critical",o.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getRailDispatch({Common_Code:this.state.modRailDispatch.DispatchCode}):(o.messageResultDetails[0].errorMessage=t.ErrorList[0],this.setState({recordWeightSaveEnabled:!0}),console.log("Error in UpdateRailDispatchPlanWithWagon: ",t.ErrorList)),this.props.onNotify(o)})).catch((e=>{this.setState({recordWeightSaveEnabled:!0}),o.messageResultDetails[0].errorMessage=e,this.props.onNotify(o)}))}else this.setState({recordWeightSaveEnabled:!0})}catch(e){console.log("RailDispatchDetailsComposite: Error occurred on handleRecordWeightSave",e)}},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1,showWagonAssignmentAuthenticationLayout:!1,showProductAssignmentAuthenticationLayout:!1,showLoadSpotAssignmentAuthenticationLayout:!1,showManualEntryAuthenticationLayout:!1})}}componentDidMount(){try{u.pJ(this.props.userDetails.EntityResult.IsArchived),this.getUOMs(),this.getRailRouteCodes(),this.getRailWagonCategory(),this.getFinishedProductCodes(),this.getCustomerDestinations(),this.getTankCode(this.props.selectedShareholder),this.getMeterCode(),this.getRailBayAndBcuList(),this.getRailLoadSpotDevices("","SPUR"),this.getCarrierCompanyCodes(""),this.getWeightBridgeData(),this.getContractCodes(this.props.selectedShareholder),this.getAttributes((()=>this.getRailDispatch(this.props.selectedRow))),this.getMaxCompartments()}catch(e){console.log("RailDispatchDetailsComposite:Error occurred on componentDidMount",e)}}componentWillReceiveProps(e){try{e.subPageName!==this.props.subPageName?this.handleOpenSubPage(e.subPageName):(""!==this.state.railDispatch.DispatchCode&&void 0===e.selectedRow.Common_Code||e.selectedRow.ViewRailDispatchDetails_ShipmentStatus!==this.props.selectedRow.ViewRailDispatchDetails_ShipmentStatus)&&this.getRailDispatch(e.selectedRow,!0)}catch(t){console.log("RailDispatchDetailsComposite:Error occurred on componentWillReceiveProps",t)}}getAttributes(e){const t=[E.Jr,E.bK,E._G,E.Mx,E.Ct,E.Xk,E.B6,E.eE,E.CG,E.gW,E.ip];I()(N.fKH,u.tW(t,this.props.tokenDetails.tokenInfo)).then((t=>{const a=t.data;!0===a.IsSuccess?this.setState({attributeMetaDataList:D().cloneDeep(a.EntityResult.RAILDISPATCHPLAN),attributeValidationErrors:u.Fl(a.EntityResult.RAILDISPATCHPLAN),compartmentAttributeMetaDataList:D().cloneDeep(a.EntityResult.RAILDISPATCHITEM),wagonDetailPlanAttributeMetaDataList:D().cloneDeep(a.EntityResult.RAILDISPATCHWAGONDETAILPLAN),FPAttributeMetaDataList:D().cloneDeep(a.EntityResult.RAILLOADINGDETAILSFP),BPAttributeMetaDataList:D().cloneDeep(a.EntityResult.RAILLOADINGDETAILSBP),additiveAttributeMetaDataList:D().cloneDeep(a.EntityResult.RAILLOADINGDETAILSADDITIVE),auditTrailAttributeMetaDataList:D().cloneDeep(a.EntityResult.MARINEDISPATCHSTATUSTIME)},(()=>e())):console.log("Failed to get Attributes")})).catch((e=>{console.log("Error in getAttributes: ",e)}))}terminalSelectionChange(e){try{null==e&&(e=[]);const t=[],a=D().cloneDeep(this.state.attributeMetaDataList);let i=D().cloneDeep(this.state.selectedAttributeList);const s=D().cloneDeep(this.state.attributeValidationErrors),o=D().cloneDeep(this.state.modRailDispatch);for(let n of e){const e=i.find((e=>e.TerminalCode===n));if(void 0===e){for(let i of a)if(i.TerminalCode===n){const e=o.Attributes.find((e=>e.TerminalCode===n));void 0!==e&&i.attributeMetaDataList.forEach((t=>{const a=e.ListOfAttributeData.find((e=>e.AttributeCode===t.Code));void 0!==a&&(t.DefaultValue=a.AttributeValue)})),t.push(i)}}else t.push(e)}i=u.nQ(t),s.forEach((t=>{if(void 0===e.find((e=>t.TerminalCode===e)))for(let e in t.attributeValidationErrors)t.attributeValidationErrors[e]=""})),this.formCompartmentAttributes(e),this.formProductAssignmentAttributes(e),this.setState({selectedAttributeList:i,attributeValidationErrors:s})}catch(t){console.log("RailDispatchDetailsComposite: Error occurred on terminalSelectionChange",t)}}localNodeAttribute(){try{const e=D().cloneDeep(this.state.attributeMetaDataList);if(Array.isArray(e)&&e.length>0)this.terminalSelectionChange([e[0].TerminalCode]);else{const e=D().cloneDeep(this.state.compartmentAttributeMetaDataList);Array.isArray(e)&&e.length>0&&this.formCompartmentAttributes([e[0].TerminalCode]);const t=D().cloneDeep(this.state.wagonDetailPlanAttributeMetaDataList);Array.isArray(t)&&t.length>0&&this.formProductAssignmentAttributes([t[0].TerminalCode])}}catch(e){console.log("RailDispatchDetailsComposite: Error occurred on localNodeAttribute",e)}}formCompartmentAttributes(e){try{const t=this.state.compartmentAttributeMetaDataList.filter((t=>e.some((e=>t.TerminalCode===e)))),a=D().cloneDeep(this.state.modAssociations);let i=[];t.forEach((e=>{e.attributeMetaDataList.forEach((e=>{i.push({AttributeCode:e.Code,AttributeName:e.DisplayName,AttributeValue:e.DefaultValue,TerminalCode:e.TerminalCode,IsMandatory:e.IsMandatory,DataType:e.DataType,IsReadonly:e.IsReadonly,MinValue:e.MinValue,MaxValue:e.MaxValue,ValidationFormat:e.ValidationFormat,compSequenceNo:""})}))})),a.forEach((t=>{let a=D().cloneDeep(i);if(null!==t.SeqNumber||void 0!==t.AttributesForUI&&null!==t.AttributesForUI){void 0!==t.AttributesForUI&&null!==t.AttributesForUI?(t.AttributesForUI=t.AttributesForUI.filter((t=>e.some((e=>t.TerminalCode===e)))),a=a.filter((e=>!t.AttributesForUI.some((t=>e.TerminalCode===t.TerminalCode))))):t.AttributesForUI=[];const i=D().cloneDeep(a);if(void 0!==t.Attributes&&null!==t.Attributes&&Array.isArray(t.Attributes)&&t.Attributes.length>0){t.Attributes.filter((t=>e.some((e=>t.TerminalCode===e)))).forEach((e=>{e.ListOfAttributeData.forEach((t=>{const a=i.findIndex((a=>a.TerminalCode===e.TerminalCode&&a.AttributeCode===t.AttributeCode));a>=0&&(i[a].AttributeValue=t.AttributeValue)}))})),i.forEach((e=>{e.compSequenceNo=t.SeqNumber,t.AttributesForUI.push(e)}))}else a.forEach((e=>{e.compSequenceNo=t.SeqNumber,t.AttributesForUI.push(e)}))}else t.AttributesForUI=[],a.forEach((e=>{e.compSequenceNo=t.SeqNumber,t.AttributesForUI.push(e)}));this.toggleExpand(t,!0,!0),t.AttributesForUI=u.vt(t.AttributesForUI),t.AttributesforUI=u.Q3(t.AttributesforUI)})),this.setState({modAssociations:a})}catch(t){console.log("RailDispatchDetailsComposite: Error in forming Compartment Attributes",t)}}formProductAssignmentAttributes(e){try{const t=this.state.wagonDetailPlanAttributeMetaDataList.filter((t=>e.some((e=>t.TerminalCode===e)))),a=D().cloneDeep(this.state.modRailWagonList);let i=[];t.forEach((e=>{e.attributeMetaDataList.forEach((e=>{i.push({AttributeCode:e.Code,AttributeName:e.DisplayName,AttributeValue:e.DefaultValue,TerminalCode:e.TerminalCode,IsMandatory:e.IsMandatory,DataType:e.DataType,IsReadonly:e.IsReadonly,MinValue:e.MinValue,MaxValue:e.MaxValue,ValidationFormat:e.ValidationFormat,compSequenceNo:""})}))})),a.forEach((t=>{let a=D().cloneDeep(i);if(null!==t.SequenceNo||void 0!==t.AttributesForUI&&null!==t.AttributesForUI){void 0!==t.AttributesForUI&&null!==t.AttributesForUI?(t.AttributesForUI=t.AttributesForUI.filter((t=>e.some((e=>t.TerminalCode===e)))),a=a.filter((e=>!t.AttributesForUI.some((t=>e.TerminalCode===t.TerminalCode))))):t.AttributesForUI=[];const i=D().cloneDeep(a);if(void 0!==t.Attributes&&null!==t.Attributes&&Array.isArray(t.Attributes)&&t.Attributes.length>0){t.Attributes.filter((t=>e.some((e=>t.TerminalCode===e)))).forEach((e=>{e.ListOfAttributeData.forEach((t=>{const a=i.findIndex((a=>a.TerminalCode===e.TerminalCode&&a.AttributeCode===t.AttributeCode));a>=0&&(i[a].AttributeValue=t.AttributeValue)}))})),i.forEach((e=>{e.compSequenceNo=t.SequenceNo,t.AttributesForUI.push(e)}))}else a.forEach((e=>{e.compSequenceNo=t.SequenceNo,t.AttributesForUI.push(e)}))}else t.AttributesForUI=[],a.forEach((e=>{e.compSequenceNo=t.SequenceNo,t.AttributesForUI.push(e)}));this.toggleExpand(t,!0,!0),t.AttributesForUI=u.vt(t.AttributesForUI),t.AttributesforUI=u.Q3(t.AttributesforUI)})),this.setState({modRailWagonList:a})}catch(t){console.log("RailDispatchDetailsComposite: Error in forming Compartment Attributes",t)}}fillAttributeDetails(e,t){try{return t=u.SC(t),e.Attributes=[],t.forEach((t=>{const a={ListOfAttributeData:[]};a.TerminalCode=t.TerminalCode,t.attributeMetaDataList.forEach((e=>{a.ListOfAttributeData.push({AttributeCode:e.Code,AttributeValue:e.DefaultValue})})),e.Attributes.push(a)})),e}catch(a){console.log("RailDispatchDetailsComposite: Error occurred on fillAttributeDetails",a)}}getShareholders(){return u.Zj(this.props.userDetails.EntityResult.ShareholderList)}getTransportationType(){let e=h.LY.RAIL;const{genericProps:t}=this.props;return void 0!==t&&void 0!==t.transportationType&&(e=t.transportationType),e}getUOMs(){I()(N.WFM,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){if(Array.isArray(t.EntityResult.VOLUME)&&Array.isArray(t.EntityResult.MASS)){const e=[];t.EntityResult.VOLUME.forEach((t=>{e.push(t)})),t.EntityResult.MASS.forEach((t=>{e.push(t)})),this.setState({quantityUOMOptions:u.Zj(e)})}if(Array.isArray(t.EntityResult.DENSITY)){const e=[];t.EntityResult.DENSITY.forEach((t=>{e.push(t)})),this.setState({densityUOMOptions:u.Zj(e)})}if(Array.isArray(t.EntityResult.TEMPERATURE)){const e=[];t.EntityResult.TEMPERATURE.forEach((t=>{e.push(t)})),this.setState({temperatureUOMOptions:u.Zj(e)})}}}else console.log("Error in GetUOMList: ",t.ErrorList)})).catch((e=>{console.log("Error in GetUOMList: ",e)}))}getRailRouteCodes(){I()(N.ufR,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){const e=D().cloneDeep(this.state.routeCodeOptions);t.EntityResult.forEach((t=>{e.push({text:t,value:t})}));let a=D().cloneDeep(e);a.length>h.bM&&(a=a.slice(0,h.bM)),this.setState({routeCodeOptions:e,routeCodeSearchOptions:a})}}else console.log("Error in getRailRouteCodes: ",t.ErrorList)})).catch((e=>{console.log("Error in getRailRouteCodes: ",e)}))}getRailWagonCategory(){I()(N.Lbz,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){let e=u.Zj(t.EntityResult);this.setState({railWagonCategoryOptions:e})}}else console.log("Error in getRailWagonCategory:",t.ErrorList)})).catch((e=>{console.log("Error while getting getRailWagonCategory:",e)}))}getRailWagonCategoryDetails(e,t,a){I()(N.jpn+"?RailWagonCategoryCode="+e+"&ProductType="+t,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;!0===t.IsSuccess?a(t.EntityResult):console.log("Error in getRailWagonCategory: ",t.ErrorList)})).catch((e=>{console.log("Error while getting getRailWagonCategory: ",e)}))}getRailWagon(e,t,a,i){const s={ShareHolderCode:a,keyDataCode:O.UT,KeyCodes:[{key:O.UT,value:e},{key:O.v6,value:h.LY.RAIL},{key:O._n,value:t}]};I()(N.r5l,u.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;!0===t.IsSuccess?i(t.EntityResult):console.log("Error in GetRailWagon:",t.ErrorList)})).catch((e=>{console.log("Error while getting railWagon:",e)}))}getFinishedProductCodes(){I()(N.Ypw+"?ShareholderCode=&TransportationType="+h.LY.RAIL,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){const e=t.EntityResult;this.setState({finishedProductOptions:e})}}else console.log("Error in GetFinishedProductCodes:",t.ErrorList)})).catch((e=>{console.log("Error while GetFinishedProductCodes List:",e)}))}getCustomerDestinations(){I()(N.E6k+"?ShareholderCode=&TransportationType="+h.LY.RAIL,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess)if(Array.isArray(t.EntityResult)){const e={};t.EntityResult.forEach((t=>{e[t.ShareholderCode]=t.CustomerDestinationsList})),this.setState({customerDestinationOptions:e})}else console.log("CustomerDestinations not identified for shareholder")})).catch((e=>{console.log("Error while getting Customer List:",e)}))}getTankCode(e){I()(N.Ibp+"?ShareholderCode="+e,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){const e=u.Zj(t.EntityResult);let a=D().cloneDeep(e);a.length>h.bM&&(a=a.slice(0,h.bM)),this.setState({tankCodeOptions:e,tankCodeSearchOptions:a})}}else console.log("Error in getTankCode:",t.ErrorList)})).catch((e=>{console.log("Error in getTankCode:",e)}))}getMeterCode(){I()(N.ndF,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){const e=u.Zj(t.EntityResult);let a=D().cloneDeep(e);a.length>h.bM&&(a=a.slice(0,h.bM)),this.setState({meterCodeOptions:e,meterCodeSearchOptions:a})}}else console.log("Error in getMeterCode:",t.ErrorList)})).catch((e=>{console.log("Error in getMeterCode:",e)}))}getFinishedProduct(e,t,a){var i=[{key:O.xf,value:e}],s={ShareHolderCode:t,keyDataCode:O.xf,KeyCodes:i};I()(N.cfM,u.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;t.IsSuccess?a(t.EntityResult):console.log("Error in getFinishedProduct:",t.ErrorList)})).catch((e=>{console.log("Error while getting Finished Product:",e)}))}getRailBayAndBcuList(){I()(N.mGx,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){const e={},a=[];if(Array.isArray(t.EntityResult.Table)&&t.EntityResult.Table.length>0)for(let i of t.EntityResult.Table)e[i.Code]=[],a.push(i.Code);if(Array.isArray(t.EntityResult.Table1)&&t.EntityResult.Table1.length>0)for(let i of t.EntityResult.Table1)void 0!==e[i.locationCode]&&e[i.locationCode].push(i.Code);this.setState({clusterBCUOptions:e,clusterCodeOptions:u.Zj(a)})}else console.log("Error in getRailBayAndBcuList:",t.ErrorList)})).catch((e=>{console.log("Error in getRailBayAndBcuList:",e)}))}getLoadingArms(e,t){I()(N.W$W+"?bcuCode="+e,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const a=e.data;!0===a.IsSuccess?t(a.EntityResult):console.log("Error in getLoadingArms:",a.ErrorList)})).catch((e=>{console.log("Error in getLoadingArms:",e)}))}getRailLoadSpot(e,t,a){I()(N.hPe+"?EntityCode="+e+"&EntityType="+t,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;!0===t.IsSuccess?a(t.EntityResult):console.log("Error in getRailLoadSpot: ",t.ErrorList)})).catch((e=>{console.log("Error in getRailLoadSpot: ",e)}))}getRailLoadSpotDevices(e,t){I()(N.SpY+"?ParentEntityCode="+e+"&EntityType="+t,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const a=e.data;!0===a.IsSuccess&&Array.isArray(a.EntityResult)?"SPUR"===t?this.setState({spurCodeOptions:u.Zj(a.EntityResult)}):"CLUSTER"===t?this.setState({loadSpotClusterCodeOptions:u.Zj(a.EntityResult)}):"BCU"===t&&this.setState({loadSpotBCUCodeOptions:u.Zj(a.EntityResult)}):console.log("Error in getRailLoadSpotDevices: ",a.ErrorList)})).catch((e=>{console.log("Error in getRailLoadSpotDevices: ",e)}))}getCarrierCompanyCodes(e){I()(N.Xj6+"?ShareholderCode="+e+"&TransportationType="+h.LY.RAIL,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;!0===t.IsSuccess?null!==t.EntityResult&&Array.isArray(t.EntityResult)&&this.setState({carrierCodeOptions:u.Zj(t.EntityResult)}):console.log("Error in getCarrierCompanyCodes:",t.ErrorList)})).catch((e=>{console.log("Error while getting Carrier List:",e)}))}getTrailerCodes(e){I()(N.VCb+"?CarrierCompanyCode="+e+"&TransportationType="+h.LY.RAIL,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;!0===t.IsSuccess?null!==t.EntityResult&&Array.isArray(t.EntityResult.RailWagonList)?this.setState({trailerCodeOptions:u.Zj(t.EntityResult.RailWagonList)}):this.setState({trailerCodeOptions:[]}):console.log("Error in getTrailerCodes:",t.ErrorList)})).catch((e=>{console.log("Error while getTrailerCodes: ",e)}))}getWeightBridgeData(){I()(N.UO$+"?TransportationType="+h.LY.RAIL,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess)if(void 0!==t.EntityResult.Table&&Array.isArray(t.EntityResult.Table)){const e=[],a={};for(let i of t.EntityResult.Table)e.push(i.Code),a[i.Code]=i;this.setState({weightBridgeOptions:u.Zj(e),weightBridgeSetting:a})}else this.setState({weightBridgeOptions:[],weightBridgeSetting:{}});else console.log("Error in getWeightBridgeData: ",t.ErrorList),this.setState({weightBridgeOptions:[],weightBridgeSetting:{}})})).catch((e=>{console.log("Error while getWeightBridgeData: ",e)}))}getRailDispatchWeighBridgeData(e,t){const a=[{key:"TransactionType",value:"Dispatch"},{key:O.v6,value:h.LY.RAIL},{key:"DispatchReceiptCode",value:e.DispatchCode}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:O.eT,KeyCodes:a};I()(N.iTT,u.tW(i,this.props.tokenDetails.tokenInfo)).then((a=>{const i=a.data;!0===i.IsSuccess&&null!==i.EntityResult&&Array.isArray(i.EntityResult.Table)?(this.setState({weightBridgeData:i.EntityResult.Table,modWeightBridgeData:D().cloneDeep(i.EntityResult.Table)}),this.setWagonDetailsFromDispatch(e,i.EntityResult.Table,t)):(this.setState({weightBridgeData:[],modWeightBridgeData:[]}),this.setWagonDetailsFromDispatch(e,[],t))})).catch((e=>{this.setState({weightBridgeData:[],modWeightBridgeData:[]}),console.log("Error while getting GetRailMarineDispatchReceiptWeighBridgeData:",e)}))}getWagonHseInspectionStatus(e,t){I()(N.TKi+"?TransactionType=Dispatch&DispatchReceiptCode="+e+"&ShareholderCode="+t,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess||null!==t.EntityResult||Array.isArray(t.EntityResult.Table)){const e=D().cloneDeep(this.state.modWagonDetails);for(let a of t.EntityResult.Table)for(let t of e)if(t.TrailerCode===a.Code){t.HSEInspectionStatus=a.HseInspectionStatus;break}this.setState({modWagonDetails:e})}else console.log("Error in getWagonHseInspectionStatus: ",t.ErrorList)})).catch((e=>{console.log("Error while getWagonHseInspectionStatus: ",e)}))}getContractCodes(e){I()(N.jFl+"?ShareholderCode="+e+"&TransportationType="+h.LY.RAIL,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;!0===t.IsSuccess||Array.isArray(t.EntityResult)?this.setState({contractCodeOptions:u.Zj(t.EntityResult)}):console.log("Error in getContractCodes: ",t.ErrorList)})).catch((e=>{console.log("Error while getContractCodes: ",e)}))}getRailDispatch(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const a=this.getTransportationType();L.OE.TransportationType=a;const i={CommonInfo:D().cloneDeep(L.BG),TransactionFPinfo:D().cloneDeep(L.Vp),ArrTransactionBP:[],ArrTransactionAdditive:[],IsLocalLoaded:!1};if(L.OE.QuantityUOM=this.props.userDetails.EntityResult.PageAttibutes.DefaultQtyUOMForTransactionUI.RAIL,void 0===e.Common_Code){void 0!==this.props.shipmentSource?L.OE.CreatedFromEntity=this.props.shipmentSource:L.OE.CreatedFromEntity=0;let e=[];return void 0===this.props.shipmentSource||this.props.shipmentSourceFromSummary||(e=this.getDispatchCompartmentDetails()),void 0!==this.props.shipmentSource&&this.props.shipmentSourceFromSummary&&this.getCompartmentFromOtherSource(this.props.selectedSourceCode),void this.setState({railDispatch:D().cloneDeep(L.OE),modRailDispatch:D().cloneDeep(L.OE),modAssociations:e,loadingDataInfo:D().cloneDeep(i),isReadyToRender:!0,saveEnabled:u.ab(this.props.userDetails.EntityResult.FunctionsList,F.i.add,F.xz),compartmentSaveEnabled:!1,railRouteData:{DestinationCode:"",DepartureTime:""},expandedWagonRows:[],tabActiveIndex:0},(()=>{!1===this.props.userDetails.EntityResult.IsEnterpriseNode&&this.localNodeAttribute(),this.state.isOpenSubPage&&this.handleSubPageBackOnClick()}))}const s=[{key:O.s0,value:e.Common_Code},{key:O.v6,value:a}],o={ShareHolderCode:this.props.selectedShareholder,keyDataCode:O.s0,KeyCodes:s};I()(N.bDb,u.tW(o,this.props.tokenDetails.tokenInfo)).then((a=>{const s=a.data;!0===s.IsSuccess?(t&&this.props.onUpdateStatusOperation(s.EntityResult),i.CommonInfo.LoadingType=u.cd(h.xT,1),i.CommonInfo.TransactionType="DISPATCH",i.CommonInfo.TransportationType=h.LY.RAIL,i.CommonInfo.DispatchCode=s.EntityResult.DispatchCode,i.CommonInfo.IsBonded=s.EntityResult.IsBonded,this.getRailDispatchWeighBridgeData(s.EntityResult,(()=>{this.getWagonHseInspectionStatus(e.Common_Code,this.props.selectedShareholder),this.setState({isReadyToRender:""===this.props.subPageName,railDispatch:s.EntityResult,modRailDispatch:D().cloneDeep(s.EntityResult),modAssociations:this.getAssociationsFromDispatch(s.EntityResult),loadingDataInfo:D().cloneDeep(i),saveEnabled:u.ab(this.props.userDetails.EntityResult.FunctionsList,F.i.modify,F.xz)&&s.EntityResult.DispatchStatus===h.Mw.READY||this.props.currentAccess.ViewRailDispatch_Update,compartmentSaveEnabled:this.checkCompartmentSaveEnabled(s.EntityResult.DispatchCompartmentPlanList),expandedWagonRows:[],tabActiveIndex:this.props.isDisplayDetails?1:this.state.tabActiveIndex},(()=>{this.getKPIList(s.EntityResult.DispatchCode),this.props.userDetails.EntityResult.IsEnterpriseNode?this.terminalSelectionChange(s.EntityResult.TerminalCodes):this.localNodeAttribute(),""===this.props.subPageName?this.getRailRoute(s.EntityResult.RouteCode):this.handleOpenSubPage(this.props.subPageName,!0)}))}))):(this.setState({railDispatch:D().cloneDeep(L.OE),modRailDispatch:D().cloneDeep(L.OE),loadingDataInfo:D().cloneDeep(i),isReadyToRender:!0,saveEnabled:u.ab(this.props.userDetails.EntityResult.FunctionsList,F.i.modify,F.xz)}),console.log("Error in railDispatch: ",s.ErrorList))})).catch((e=>{console.log("Error while getting railDispatch: ",e)}))}getDispatchCompartmentDetails(){let e=[];if(void 0===this.props.shipmentSource||this.props.shipmentSourceFromSummary){if(void 0!==this.props.shipmentSource&&this.props.shipmentSourceFromSummary){let t=D().cloneDeep(this.state.contractData);Array.isArray(t)&&(t.forEach((t=>{let a=t.CustomerCode;for(let i=0;i<t.ContractItems.length;i++){let s={},o=t.ContractItems[i];null!==o.RemainingQuantity&&o.RemainingQuantity>0&&(s={PlannedQuantity:null!==o.RemainingQuantity&&""!==o.RemainingQuantity?o.RemainingQuantity.toLocaleString():null,UOM:o.QuantityUOM,ContractCode:t.ContractCode,CustomerCode:a,DestinationCode:o.DestinationCode,FinishedProductCode:o.FinishedProductCode,ShareholderCode:this.props.selectedShareholder,PlannedNoOfRailWagons:null},e.push(s))}})),e=u.Q3(e),this.setState({modAssociations:e}))}}else{let t=this.props.shipmentSourceDetails.CustomerCode;if(Array.isArray(this.props.shipmentSourceCompartmentItems)){for(let a=0;a<this.props.shipmentSourceCompartmentItems.length;a++){let i={},s=this.props.shipmentSourceCompartmentItems[a];null!==s.RemainingQuantity&&s.RemainingQuantity>0&&(i={PlannedQuantity:null!==s.RemainingQuantity&&""!==s.RemainingQuantity?s.RemainingQuantity.toLocaleString():null,UOM:s.QuantityUOM,ContractCode:this.props.shipmentSourceDetails.ContractCode,CustomerCode:t,DestinationCode:s.DestinationCode,FinishedProductCode:s.FinishedProductCode,ShareholderCode:this.props.selectedShareholder,PlannedNoOfRailWagons:null},e.push(i))}e=u.Q3(e)}}return e}getCompartmentFromOtherSource(e){var t=[],a=this.props.selectedShareholder;e.forEach((e=>{var i={keyDataCode:0,ShareHolderCode:a,KeyCodes:[{Key:O.GT,Value:e}]};t.push(i)})),I()(N.RYr,u.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;!0===t.IsSuccess?this.setState({contractData:t.EntityResult},(()=>{this.getDispatchCompartmentDetails()})):this.setState({contractData:[]})}))}checkManualEntryEnabled(e){for(let t of e)if(t.DispatchCompartmentStatus===h.bw.EMPTY||t.DispatchCompartmentStatus===h.bw.PART_FILLED||t.DispatchCompartmentStatus===h.bw.INTERRUPTED)return t.TrailerCode;return""}checkCompartmentSaveEnabled(e){if(null===e)return!1;for(let t of e){const e=!(!1===this.props.currentAccess.ViewRailDispatch_EditAccess||t.DispatchCompartmentStatus===h.bw.LOADING||t.DispatchCompartmentStatus===h.bw.FORCE_COMPLETED||t.DispatchCompartmentStatus===h.bw.COMPLETED||t.DispatchCompartmentStatus===h.bw.OVER_FILLED||this.props.currentAccess.ViewRailDispatch_DisableAdjustPlanQty||null===t.FinishedProductCode||""===t.FinishedProductCode),a=!(!1===this.props.currentAccess.ViewRailDispatch_EditAccess||t.DispatchCompartmentStatus===h.bw.LOADING||t.DispatchCompartmentStatus===h.bw.FORCE_COMPLETED||t.DispatchCompartmentStatus===h.bw.COMPLETED||t.DispatchCompartmentStatus===h.bw.OVER_FILLED||this.props.currentAccess.ViewRailDispatch_DisableWagonForceClose||null===t.FinishedProductCode||""===t.FinishedProductCode);if(e&&a)return!0}return!1}getRailRoute(e){const t=this.getTransportationType(),a=[{key:O.Rp,value:e},{key:O.v6,value:t}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:O.Rp,KeyCodes:a};I()(N.QB7,u.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){const e=D().cloneDeep(this.state.railRouteData);e.DestinationCode=t.EntityResult.DestinationCode,e.DepartureTime=new Date(t.EntityResult.DepartureTime).toLocaleTimeString(),this.setState({railRouteData:e})}}else console.log("Error in GetRailRoute:",t.ErrorList)})).catch((e=>{console.log("Error while getting railRoute:",e)}))}validateSave(e,t){const a=D().cloneDeep(this.state.validationErrors);Object.keys(v.td).forEach((function(t){void 0!==e[t]&&(a[t]=u.jr(v.td[t],e[t]))})),e.Active!==this.state.railDispatch.Active&&(null===e.Remarks||""===e.Remarks?a.Remarks="OriginTerminal_RemarksRequired":a.Remarks="");const i=D().cloneDeep(this.state.attributeValidationErrors);t.forEach((e=>{i.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.attributeMetaDataList.forEach((e=>{t.attributeValidationErrors[e.Code]=u.I5(e,e.DefaultValue)}))}))})),this.setState({validationErrors:a,attributeValidationErrors:i});let s=!0;if(i.forEach((e=>{if(!s)return s;s=Object.values(e.attributeValidationErrors).every((function(e){return""===e}))})),!s)return s;s=Object.values(a).every((function(e){return""===e}));const o={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[]};if(Array.isArray(e.DispatchItemPlanList)&&e.DispatchItemPlanList.length>0){const t=D().cloneDeep(k.sT);e.DispatchItemPlanList.forEach((a=>{if(e.CreatedFromEntity===h.U6.Contract){let t="";if(Array.isArray(a.AssociatedContractItems)&&a.AssociatedContractItems.length>0){const e=a.AssociatedContractItems[0];null!==e&&void 0!==e.ContractCode&&null!==e.ContractCode&&""!==e.ContractCode||(t="Contract_Code_Empty")}else t="Contract_Code_Empty";""!==t&&o.messageResultDetails.push({keyFields:["RailDispatchPlanDetail_DispatchCode","RailDispatchPlanDetail_ContractCode"],keyValues:[e.DispatchCode,a.ContractCode],isSuccess:!1,errorMessage:t})}t.forEach((t=>{let i="";"PlannedQuantity"===t.field&&"2"===this.props.railLookUpData.PlanType||(void 0!==t.validator&&(i=u.jr(t.validator,a[t.field])),""!==i&&o.messageResultDetails.push({keyFields:["RailDispatchPlanDetail_DispatchCode",t.displayName],keyValues:[e.DispatchCode,a[t.field]],isSuccess:!1,errorMessage:i}))}));let i=[];null!==a.AttributesForUI&&void 0!==a.AttributesForUI&&(i=a.AttributesForUI.filter((e=>a.Attributes.some((t=>{const a=t.ListOfAttributeData.findIndex((t=>t.AttributeCode===e.AttributeCode))>=0;return e.TerminalCode===t.TerminalCode&&a}))))),i.forEach((e=>{const t=u.I5(e,e.AttributeValue);""!==t&&(this.props.userDetails.EntityResult.IsEnterpriseNode?o.messageResultDetails.push({keyFields:["CompAttributeComp","CompAttributeTerminal",e.AttributeName],keyValues:[a.SeqNumber,e.TerminalCode,e.AttributeValue],isSuccess:!1,errorMessage:t}):o.messageResultDetails.push({keyFields:["CompAttributeComp",e.AttributeName],keyValues:[a.SeqNumber,e.AttributeValue],isSuccess:!1,errorMessage:t}))})),this.toggleExpand(a,!0,!0),delete a.AttributesForUI,delete a.SeqNumber}))}else o.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"ERRORMSG_RAILDISPATCH_PLAN_EMPTY"});return o.messageResultDetails.length>0?(this.props.onSaved(e,"update",o),!1):s}handleResetAttributeValidationError(){try{var e=D().cloneDeep(this.state.attributeMetaDataList);this.setState({attributeValidationErrors:u.Fl(e)})}catch(t){console.log("RailDispatchDetailsComposite: Error occurred on handleResetAttributeValidationError",t)}}createRailDispatch(e){const t=[{key:O.s0,value:e.DispatchCode}],a={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:O.s0,KeyCodes:t,Entity:e},i={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[{keyFields:["RailDispatchPlanDetail_DispatchCode"],keyValues:[e.DispatchCode],isSuccess:!1,errorMessage:""}]};I()(N.jYg,u.tW(a,this.props.tokenDetails.tokenInfo)).then((t=>{const a=t.data;i.messageType=a.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=a.IsSuccess,!0===a.IsSuccess?this.getRailDispatch({Common_Code:e.DispatchCode},!0):(i.messageResultDetails[0].errorMessage=a.ErrorList[0],this.setState({saveEnabled:!0})),this.props.onSaved(this.state.modRailDispatch,"add",i)})).catch((t=>{this.setState({saveEnabled:u.ab(this.props.userDetails.EntityResult.FunctionsList,F.i.add,F.xz)}),i.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"add",i)}))}updateRailDispatch(e){const t=[{key:O.s0,value:e.DispatchCode}],a={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:O.s0,KeyCodes:t,Entity:e},i={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[{keyFields:["RailDispatchPlanDetail_DispatchCode"],keyValues:[e.DispatchCode],isSuccess:!1,errorMessage:""}]};I()(N.eTL,u.tW(a,this.props.tokenDetails.tokenInfo)).then((t=>{const a=t.data;i.messageType=a.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=a.IsSuccess,!0===a.IsSuccess?this.getRailDispatch({Common_Code:e.DispatchCode}):(i.messageResultDetails[0].errorMessage=a.ErrorList[0],this.setState({saveEnabled:!0})),this.props.onSaved(e,"update",i)})).catch((t=>{this.setState({saveEnabled:u.ab(this.props.userDetails.EntityResult.FunctionsList,F.i.add,F.xz)}),i.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"modify",i)}))}updateRailDispatchCompartmentInfo(e){const t=[{key:"DispatchCode",value:this.state.modRailDispatch.DispatchCode}],a={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:"DispatchCode",KeyCodes:t,Entity:e},i={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[{keyFields:["RailDispatchPlanDetail_DispatchCode"],keyValues:[this.state.modRailDispatch.DispatchCode],isSuccess:!1,errorMessage:""}]};I()(N.Gbz,u.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;i.messageType=t.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getRailDispatch({Common_Code:this.state.modRailDispatch.DispatchCode},!0):(i.messageResultDetails[0].errorMessage=t.ErrorList[0],this.setState({saveEnabled:!0})),this.props.onNotify(i)})).catch((e=>{this.setState({saveEnabled:!0}),i.messageResultDetails[0].errorMessage=e,this.props.onNotify(i)}))}getAssociationsFromDispatch(e){let t=[];return Array.isArray(e.DispatchItemPlanList)&&e.DispatchItemPlanList.forEach((e=>{t.push({LoadedQuantity:e.LoadedQuantity,LoadedQuantityUOM:e.LoadedQuantityUOM,DispatchCode:e.DispatchCode,ShareholderCode:e.ShareholderCode,CustomerCode:e.CustomerCode,DestinationCode:e.DestinationCode,FinishedProductCode:e.FinishedProductCode,RailWagonCategory:e.RailWagonCategory,PlannedNoOfRailWagons:e.PlannedNoOfRailWagons,PlannedQuantity:null!==e.PlannedQuantity&&""!==e.PlannedQuantity?e.PlannedQuantity.toLocaleString():null,AdjustedPlanQuantity:null!==e.AdjustedPlanQuantity&&""!==e.AdjustedPlanQuantity?e.AdjustedPlanQuantity.toLocaleString():null,QuantityUOM:e.QuantityUOM,ContractCode:null!=e.AssociatedContractItems?e.AssociatedContractItems[0].ContractCode:null,AssociatedOrderItems:e.AssociatedOrderItems,AssociatedContractItems:e.AssociatedContractItems,Attributes:e.Attributes})})),t=u.Q3(t),t}getCompartmentsFromAssociations(e){const t=[];return Array.isArray(e)&&e.forEach((e=>{if(null!==e.FinishedProductCode&&""!==e.FinishedProductCode||null!==e.CustomerCode&&""!==e.CustomerCode||null!==e.DestinationCode&&""!==e.DestinationCode){let a=[];if(this.props.userDetails.EntityResult.IsEnterpriseNode)a=D().cloneDeep(this.state.modRailDispatch.TerminalCodes),null==a&&(a=[]);else{const e=D().cloneDeep(this.state.compartmentAttributeMetaDataList);e.length>0&&(a=[e[0].TerminalCode])}let i=[];e.Attributes=[],a.forEach((t=>{null!==e.AttributesForUI&&void 0!==e.AttributesForUI&&(i=e.AttributesForUI.filter((e=>e.TerminalCode===t)));const a={ListOfAttributeData:[]};a.TerminalCode=t,i.forEach((e=>{""===e.AttributeValue&&!0!==e.IsMandatory||a.ListOfAttributeData.push({AttributeCode:e.AttributeCode,AttributeValue:e.AttributeValue})})),null!==a.ListOfAttributeData&&void 0!==a.ListOfAttributeData&&a.ListOfAttributeData.length>0&&e.Attributes.push(a)})),t.push({LoadedQuantity:e.LoadedQuantity,LoadedQuantityUOM:e.LoadedQuantityUOM,DispatchCode:this.state.modRailDispatch.DispatchCode,ShareholderCode:e.ShareholderCode,CustomerCode:e.CustomerCode,DestinationCode:e.DestinationCode,FinishedProductCode:e.FinishedProductCode,RailWagonCategory:e.RailWagonCategory,PlannedNoOfRailWagons:e.PlannedNoOfRailWagons,PlannedQuantity:e.PlannedQuantity,AdjustedPlanQuantity:e.PlannedQuantity,QuantityUOM:this.state.modRailDispatch.QuantityUOM,AssociatedContractItems:null===e.ContractCode?null:[{ContractCode:e.ContractCode,ShareholderCode:e.ShareholderCode,ContractItemQuantity:null!==e.PlannedQuantity&&""!==e.PlannedQuantity?e.PlannedQuantity:null,QuantityUOM:this.state.modRailDispatch.QuantityUOM,FinishedProductCode:e.FinishedProductCode,Destination:e.DestinationCode,RailWagonCategory:e.RailWagonCategory,PlannedNoOfRailWagons:e.PlannedNoOfRailWagons}],AssociatedOrderItems:e.AssociatedOrderItems,Attributes:e.Attributes,AttributesForUI:e.AttributesForUI})}})),t}setWagonDetailsFromDispatch(e,t,a){const i=[],s=[];Array.isArray(e.DispatchCompartmentPlanList)&&e.DispatchCompartmentPlanList.forEach((e=>{let a;e.DispatchCompartmentStatus!==h.bw.EMPTY&&e.DispatchCompartmentStatus!==h.bw.PART_FILLED&&e.DispatchCompartmentStatus!==h.bw.INTERRUPTED||s.push(e.TrailerCode);for(let i of t)if(i.WagonCode===e.TrailerCode){a=i;break}const o={TrailerCode:e.TrailerCode,CarrierCompanyCode:e.CarrierCompanyCode,FinishedProductCode:e.FinishedProductCode,DispatchCompartmentStatus:e.DispatchCompartmentStatus,PlannedQuantity:null!==e.PlannedQuantity&&""!==e.PlannedQuantity?e.PlannedQuantity.toLocaleString()+(e.PlanQuantityUOM?" "+e.PlanQuantityUOM:""):"",RevisedQuantity:null!==e.AdjustedPlanQuantity&&""!==e.AdjustedPlanQuantity?e.AdjustedPlanQuantity.toLocaleString()+(e.PlanQuantityUOM?" "+e.PlanQuantityUOM:""):"",LoadedQuantity:null!==e.LoadedQuantity&&""!==e.LoadedQuantity?e.LoadedQuantity.toLocaleString()+(e.LoadedQuantityUOM?" "+e.LoadedQuantityUOM:""):"",ReturnQuantity:null!==e.ReturnQuantity&&""!==e.ReturnQuantity?e.ReturnQuantity.toLocaleString()+(e.PlanQuantityUOM?" "+e.PlanQuantityUOM:""):"",TareWeight:"",LadenWeight:"",DiffWeight:"",HSEInspectionStatus:"",AdjustedQty:"",ForceComplete:!1};if(void 0!==a){let e=!1,t=!1;""!==a.TareWeightInDispatchReceiptUOM&&null!==a.TareWeightInDispatchReceiptUOM&&(e=!0,o.TareWeight=Math.round(a.TareWeightInDispatchReceiptUOM).toLocaleString()+" "+a.DispatchReceiptUOM),""!==a.LadenWeightInDispatchReceiptUOM&&null!==a.LadenWeightInDispatchReceiptUOM&&(t=!0,o.LadenWeight=Math.round(a.LadenWeightInDispatchReceiptUOM).toLocaleString()+" "+a.DispatchReceiptUOM),e&&t?o.DiffWeight=Math.round(a.LadenWeightInDispatchReceiptUOM-a.TareWeightInDispatchReceiptUOM).toLocaleString()+" "+a.DispatchReceiptUOM:!e&&t?o.DiffWeight=o.LadenWeight:e&&!t&&(0===Math.round(a.TareWeightInDispatchReceiptUOM)?o.DiffWeight=o.TareWeight:o.DiffWeight="-"+o.TareWeight)}i.push(o)})),this.setState({modWagonDetails:i,wagonCodeOptions:u.Zj(s)},(()=>a()))}validateCompartmentSave(e){const t={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[]};let a=!1;const i=D().cloneDeep(k.NI);for(let s of e){if(""!==s.AdjustedQuantity){a=!0;const e=u.jr(i.validator,s.AdjustedQuantity);""!==e&&t.messageResultDetails.push({keyFields:["RailDispatchPlanDetail_DispatchCode",i.displayName],keyValues:[this.state.modRailDispatch.DispatchCode,s.AdjustedQuantity],isSuccess:!1,errorMessage:e})}!0===s.ForceCompleted&&(a=!0)}return a||t.messageResultDetails.push({keyFields:["RailDispatchPlanDetail_DispatchCode"],keyValues:[this.state.modRailDispatch.DispatchCode],isSuccess:!1,errorMessage:"ViewRailDispatchList_NoAdjustments"}),!(t.messageResultDetails.length>0)||(this.props.onNotify(t),!1)}updateRailDispatchCompartInfo(e){const t={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:"DispatchCode",KeyCodes:[{key:"DispatchCode",value:this.state.modRailDispatch.DispatchCode}],Entity:e},a={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[{keyFields:["RailDispatchPlanDetail_DispatchCode"],keyValues:[this.state.modRailDispatch.DispatchCode],isSuccess:!1,errorMessage:""}]};I()(N.Gbz,u.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;a.messageType=t.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getRailDispatch({Common_Code:this.state.modRailDispatch.DispatchCode}):(a.messageResultDetails[0].errorMessage=t.ErrorList[0],this.setState({compartmentSaveEnabled:!0}),console.log("Error in updateRailDispatchCompartInfo: ",t.ErrorList)),this.props.onNotify(a)})).catch((e=>{this.setState({compartmentSaveEnabled:!0}),a.messageResultDetails[0].errorMessage=e,this.props.onNotify(a)}))}getRouteCodeSearchOptions(){let e=D().cloneDeep(this.state.routeCodeSearchOptions),t=this.state.modRailDispatch.RouteCode;if(null!==t&&""!==t&&void 0!==t){void 0===e.find((e=>e.value.toLowerCase()===t.toLowerCase()))&&e.push({text:t,value:t})}return e}getTankCodeSearchOptions(){let e=D().cloneDeep(this.state.tankCodeSearchOptions);return e}getMeterCodeSearchOptions(){let e=D().cloneDeep(this.state.meterCodeSearchOptions);return e}handleOpenSubPage(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"RailDispatchViewAuditTrailDetails"===e?this.getAuditTrail(t):"RailDispatchViewLoadingDetailsDetails"===e?this.handleViewLoadingDetails(t):"RailDispatchCompartmentManualEntryDetails"===e?this.handleManualEntry(t):"RailDispatchRailWagonAssignmentDetails"===e?this.handleOpenRailWagonAssignment(t):"RailDispatchProductAssignmentDetails"===e?this.handleOpenProductAssignment(t):"RailDispatchLoadSpotAssignmentDetails"===e?this.handleOpenLoadSpotAssignment(t):"RailDispatchRecordWeightDetails"===e&&this.handleOpenRecordWeight(t)}preprocessManualEntryData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},a=null,i=null;if(""!==e){for(let t of this.state.modRailDispatch.DispatchCompartmentPlanList)if(t.TrailerCode===e){a=t;break}for(let t of this.state.modRailDispatch.DispatchCompartmentDetailPlanList)if(t.TrailerCode===e){i=t;break}}if(null!==a&&null!==i){if(!a.FinishedProductCode){const a={messageType:"critical",message:"ViewRailDispatchManualEntry_status",messageResultDetails:[{keyFields:["Rail_Receipt_Wagon"],keyValues:[e],isSuccess:!1,errorMessage:"RailDispatchManualEntry_ProductNotAssigned"}]};this.props.onNotify(a);const i=D().cloneDeep(this.state.loadingDataInfo),[s,o]=this.initialManualEntrySelectedAttribute(i);return this.setState({loadingDataInfo:i,modLoadingDataInfo:D().cloneDeep(i),manualEntryValidationDict:this.initialManualEntryValidationErrors(i),manualEntrySelectedAttributeList:s,manualEntryAttributeValidationErrorList:o}),void t(!1)}const i=D().cloneDeep(this.state.loadingDataInfo);i.CommonInfo.TrailerCode=e,i.CommonInfo.CarrierCode=a.CarrierCompanyCode,i.TransactionFPinfo.FinishedProductCode=a.FinishedProductCode,i.TransactionFPinfo.QuantityUOM=this.state.modRailDispatch.QuantityUOM,i.TransactionFPinfo.StartTime=new Date,i.TransactionFPinfo.EndTime=new Date,this.getFinishedProduct(a.FinishedProductCode,a.ShareholderCode,(e=>{if(i.ArrTransactionBP=[],i.ArrTransactionAdditive=[],Array.isArray(e.FinishedProductItems)&&e.FinishedProductItems.length>0)for(let t of e.FinishedProductItems){const e=D().cloneDeep(L.Vp);e.FinishedProductCode=t.FinishedProductCode,e.BaseProductCode=t.BaseProductCode,e.AdditiveProductCode=t.AdditiveCode,null!==t.AdditiveCode&&""!==t.AdditiveCode?i.ArrTransactionAdditive.push(e):i.ArrTransactionBP.push(e)}const[a,s]=this.initialManualEntrySelectedAttribute(i);this.setState({loadingDataInfo:i,modLoadingDataInfo:D().cloneDeep(i),manualEntryValidationDict:this.initialManualEntryValidationErrors(i),manualEntrySelectedAttributeList:a,manualEntryAttributeValidationErrorList:s}),t(!0)}))}else{const e=D().cloneDeep(this.state.loadingDataInfo),[a,i]=this.initialManualEntrySelectedAttribute(e);this.setState({loadingDataInfo:e,modLoadingDataInfo:D().cloneDeep(e),manualEntrySelectedAttributeList:a,manualEntryAttributeValidationErrorList:i}),t(!1)}}getDefaultUOMs(e){let t="",a="";if(""!==e&&void 0!==e)try{var i=[{key:O.wX,value:e}],s={ShareHolderCode:"",keyDataCode:O.wX,KeyCodes:i};I()(N.T1y,u.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{let i=e.data;if(!0===i.IsSuccess){let e=i.EntityResult;a=e.TemperatureUOM,t=e.DensityUOM;let s=D().cloneDeep(this.state.modLoadingDataInfo);s.TransactionFPinfo.TemperatureUOM=a,s.TransactionFPinfo.ProductDensityUOM=t,s.ArrTransactionAdditive.map((e=>{e.TemperatureUOM=a,e.ProductDensityUOM=t})),s.ArrTransactionBP.map((e=>{e.TemperatureUOM=a,e.ProductDensityUOM=t})),this.setState({modLoadingDataInfo:s})}}))}catch(o){console.log("TruckShipmentManualEntryDetailsComposite:Error while getting getBCUDeviceDetails")}}GetMetersForLA(e,t){try{var a=[{key:O.Dm,value:h.Dm.RAIL_BCUVIEW},{key:O.wX,value:e},{key:O.uw,value:this.state.modRailDispatch.ActualTerminalCode}],i={ShareHolderCode:"",keyDataCode:O.Dm,KeyCodes:a};I()(N._xh,u.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{var a=e.data;if(!0===a.IsSuccess&&Array.isArray(a.EntityResult)&&a.EntityResult.length>0){let e=a.EntityResult[0].AssociatedArmsList.find((e=>e.Code===t));if(null!==e){let t=D().cloneDeep(this.state.modLoadingDataInfo),a=[],i=[];a=e.AssociatedMeterList.find((e=>"MAINLINE"===e.MeterLineType)),i=e.AssociatedMeterList.find((e=>"ADDITIVE"===e.MeterLineType));let s="",o="";1===a.MeterList.length&&(s=a.MeterList[0].Code),1===i.MeterList.length&&(o=i.MeterList[0].Code),""!==s&&t.ArrTransactionBP.map((e=>{e.MeterCode=s})),""!==o&&t.ArrTransactionAdditive.map((e=>{e.MeterCode=o})),this.setState({modLoadingDataInfo:t})}}}))}catch(s){console.log("SiteTreeView:Error occured in GetMetersForLA",s)}}initialManualEntrySelectedAttribute(e){let t=[],a=[],i=[];void 0!==this.state.FPAttributeMetaDataList[0]&&(t=u.nQ([D().cloneDeep(this.state.FPAttributeMetaDataList[0])])),void 0!==this.state.BPAttributeMetaDataList[0]&&(a=u.nQ([D().cloneDeep(this.state.BPAttributeMetaDataList[0])])),void 0!==this.state.additiveAttributeMetaDataList[0]&&(i=u.nQ([D().cloneDeep(this.state.additiveAttributeMetaDataList[0])]));const s=[t],o=[u.Fl(this.state.FPAttributeMetaDataList)];for(let n=0;n<e.ArrTransactionBP.length;n++)s.push(D().cloneDeep(a)),o.push(u.Fl(this.state.BPAttributeMetaDataList));for(let n=0;n<e.ArrTransactionAdditive.length;n++)s.push(D().cloneDeep(i)),o.push(u.Fl(this.state.additiveAttributeMetaDataList));return[s,o]}initialManualEntryValidationErrors(e){const t={},a={};for(let s in v.Jg)"BayCode"!==s&&"BCUCode"!==s&&"LoadingArm"!==s&&("TransactionID"===s||"StartTime"===s||"EndTime"===s||"Remarks"===s?t[s]="":a[s]="");const i={bayCode:"",BCUCode:"",LoadingArm:"",common:t,product:[a]};for(let s=0;s<e.ArrTransactionBP.length;s++)i.product.push(D().cloneDeep(a));for(let s=0;s<e.ArrTransactionAdditive.length;s++)i.product.push(D().cloneDeep(a));return i}validateManualEntry(e){const t=D().cloneDeep(this.state.manualEntryValidationDict);let a,i=!0;t.bayCode=u.jr(v.Jg.BayCode,e.CommonInfo.BayCode),t.BCUCode=u.jr(v.Jg.BCUCode,e.CommonInfo.BCUCode),t.LoadingArm=u.jr(v.Jg.LoadingArm,e.TransactionFPinfo.ArmCode),""!==t.bayCode&&(i=!1),""!==t.BCUCode&&(i=!1),""!==t.LoadingArm&&(i=!1);for(let r in t.common)t.common[r]=u.jr(v.Jg[r],e.TransactionFPinfo[r]),""!==t.common[r]&&(i=!1);e.TransactionFPinfo.StartTime>=e.TransactionFPinfo.EndTime&&(t.common.StartTime="MarineDispatchManualEntry_ErrorLoadTime",i=!1);let s=0;for(let r in t.product[s])t.product[s][r]=u.jr(v.Jg[r],e.TransactionFPinfo[r]),""!==t.product[s][r]&&(i=!1,void 0===a&&(a=s));for(let r of e.ArrTransactionBP){s+=1;for(let e in t.product[s])t.product[s][e]=u.jr(v.Jg[e],r[e]),""!==t.product[s][e]&&(i=!1,void 0===a&&(a=s))}for(let r of e.ArrTransactionAdditive){s+=1;for(let e in t.product[s])t.product[s][e]=u.jr(v.Jg[e],r[e]),""!==t.product[s][e]&&(i=!1,void 0===a&&(a=s))}const o=D().cloneDeep(this.state.manualEntrySelectedAttributeList),n=D().cloneDeep(this.state.manualEntryAttributeValidationErrorList);for(let r=0;r<o.length;r++)for(let e of o[r])for(let t of n[r])if(t.TerminalCode===e.TerminalCode)for(let s of e.attributeMetaDataList){let e=u.I5(s,s.DefaultValue);""!==e&&(i=!1,void 0===a&&(a=r)),t.attributeValidationErrors[s.Code]=e}return void 0!==a&&this.handleManualEntryTabChange(a),this.setState({manualEntryValidationDict:t,manualEntryAttributeValidationErrorList:n}),i}fillManualEntryAttributeDetails(e){const t=D().cloneDeep(this.state.manualEntrySelectedAttributeList),a=(e,t)=>{const a=u.SC(t);e.Attributes=[],a.forEach((t=>{const a={ListOfAttributeData:[]};a.TerminalCode=t.TerminalCode,t.attributeMetaDataList.forEach((e=>{a.ListOfAttributeData.push({AttributeCode:e.Code,AttributeValue:e.DefaultValue})})),e.Attributes.push(a)}))};let i=0;a(e.TransactionFPinfo,t[i]);for(let s of e.ArrTransactionBP)i+=1,a(s,t[i]);for(let s of e.ArrTransactionAdditive)i+=1,a(s,t[i])}saveManualEntry(e){const t=[{key:O.s0,value:e.CommonInfo.DispatchCode}],a={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:O.s0,KeyCodes:t,Entity:[e]},i={messageType:"critical",message:"ViewRailDispatchManualEntry_status",messageResultDetails:[{keyFields:["RailDispatchPlanDetail_DispatchCode"],keyValues:[e.CommonInfo.DispatchCode],isSuccess:!1,errorMessage:""}]};I()(N.h5D,u.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;i.messageType=t.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess||(i.messageResultDetails[0].errorMessage=t.ErrorList[0],console.log("Error in saveManualEntry: ",t.ErrorList)),this.setState({compartmentManualEntrySaveEnabled:!0}),this.props.onNotify(i)})).catch((e=>{this.setState({compartmentManualEntrySaveEnabled:!0}),i.messageResultDetails[0].errorMessage=e,this.props.onNotify(i)}))}getAuditTrail(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,KeyCodes:[{key:"DispatchCode",value:this.state.modRailDispatch.DispatchCode}]};I()(N.Og_,u.tW(t,this.props.tokenDetails.tokenInfo)).then((t=>{const a=t.data;if(!0===a.IsSuccess){for(let e=0;e<a.EntityResult.length;e++)a.EntityResult[e].UpdatedTime=new Date(a.EntityResult[e].UpdatedTime).toLocaleString(),a.EntityResult[e].DispatchStatusInNumber=h.g5[a.EntityResult[e].DispatchStatus];let t=D().cloneDeep(this.state.auditTrailAttributeMetaDataList);for(let e=0;e<a.EntityResult.length;e++)a.EntityResult[e].AttributesforUI=this.formReadonlyCompAttributes(a.EntityResult[e].Attributes,t);e?this.setState({isOpenSubPage:!0,auditTrailList:a.EntityResult,isReadyToRender:!0},(()=>this.props.onSetRightPaneDisplay(!1))):this.setState({isOpenSubPage:!0,auditTrailList:a.EntityResult},(()=>this.props.onSetRightPaneDisplay(!1)))}else console.log("Error in getAuditTrail: ",a.ErrorList)})).catch((e=>{console.log("Error while getAuditTrail: ",e)}))}formReadonlyCompAttributes(e,t){let a=[];return null!==t&&void 0!==t&&t.length>0&&t.forEach((e=>{e.attributeMetaDataList.forEach((e=>{a.push({AttributeCode:e.Code,AttributeName:e.DisplayName?e.DisplayName:e.Code,AttributeValue:e.DefaultValue,TerminalCode:e.TerminalCode,IsMandatory:e.IsMandatory,DataType:e.DataType,IsReadonly:e.IsReadonly,MinValue:e.MinValue,MaxValue:e.MaxValue,ValidationFormat:e.ValidationFormat,compSequenceNo:""})}))})),null!==e&&void 0!==e&&e.length>0&&e.forEach((e=>{a.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.ListOfAttributeData.forEach((e=>{t.AttributeCode===e.AttributeCode&&(t.AttributeValue=e.AttributeValue)}))}))})),a}getLoadingDetails(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t={DispatchCode:this.state.modRailDispatch.DispatchCode,TMWebApiRequest:{ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,KeyCodes:[{key:"RailDispatchCode",value:this.state.modRailDispatch.DispatchCode}]}};I()(N.rQX,u.tW(t,this.props.tokenDetails.tokenInfo)).then((t=>{const a=t.data;if(!0===a.IsSuccess){for(let e=0;e<a.EntityResult.Table.length;e++)a.EntityResult.Table[e].ProductCode=a.EntityResult.Table[e].ProductCode.replace(/&nbsp;/g," ");e?this.setState({isOpenSubPage:!0,loadingDetailsList:a.EntityResult.Table,isReadyToRender:!0},(()=>this.props.onSetRightPaneDisplay(!1))):this.setState({isOpenSubPage:!0,loadingDetailsList:a.EntityResult.Table},(()=>this.props.onSetRightPaneDisplay(!1)))}else console.log("Error in getLoadingDetails: ",a.ErrorList)})).catch((e=>{console.log("Error while getLoadingDetails: ",e)}))}initialRailWagonAssignmentList(){const e={CarrierCompanyCode:"",TrailerCode:""};if(Array.isArray(this.state.modRailDispatch.DispatchCompartmentDetailPlanList)){const t=[];for(let e of this.state.modRailDispatch.DispatchCompartmentDetailPlanList)t.push({SequenceNo:t.length+1,AssociatedOrderItems:"",CompartmentSeqNoInVehicle:"",QuantityUOM:"",Quantity:"",TrailerCode:e.TrailerCode,CarrierCompanyCode:e.CarrierCompanyCode,CompartmentCode:"",ShareholderCode:"",FinishedProductCode:"",CustomerCode:"",DestinationCode:"",DispatchCode:"",AssociatedContractItems:[],Attributes:[]});this.setState({railWagonAssignmentData:e,modRailWagonList:t,trailerCodeOptions:[],selectedRailWagons:[]})}else this.setState({railWagonAssignmentData:e,modRailWagonList:[],trailerCodeOptions:[],selectedRailWagons:[]})}getCompartmentsFromRailWagonList(e){const t=[];for(let a of e){void 0!==a.AttributesForUI&&null!=a.AttributesForUI&&(a.AttributesForUI=u.mr(a.AttributesForUI));let e=[];if(this.props.userDetails.EntityResult.IsEnterpriseNode)e=D().cloneDeep(this.state.modRailDispatch.TerminalCodes),null==e&&(e=[]);else{const t=D().cloneDeep(this.state.compartmentAttributeMetaDataList);t.length>0&&(e=[t[0].TerminalCode])}let i=[];a.Attributes=[],e.forEach((e=>{null!==a.AttributesForUI&&void 0!==a.AttributesForUI&&(i=a.AttributesForUI.filter((t=>t.TerminalCode===e)));const t={ListOfAttributeData:[]};t.TerminalCode=e,i.forEach((e=>{""===e.AttributeValue&&!0!==e.IsMandatory||t.ListOfAttributeData.push({AttributeCode:e.AttributeCode,AttributeValue:e.AttributeValue})})),null!==t.ListOfAttributeData&&void 0!==t.ListOfAttributeData&&t.ListOfAttributeData.length>0&&a.Attributes.push(t)})),t.push({AssociatedContractItems:null===a.ContractCode?null:[{ContractCode:a.ContractCode,ShareholderCode:a.ShareholderCode,ContractItemQuantity:null!==a.Quantity&&""!==a.Quantity?u.bo(a.Quantity):null,QuantityUOM:this.state.modRailDispatch.QuantityUOM,FinishedProductCode:a.FinishedProductCode,Destination:a.DestinationCode}],AssociatedOrderItems:a.AssociatedOrderItems,Attributes:a.Attributes,AttributesForUI:a.AttributesForUI,CarrierCompanyCode:a.CarrierCompanyCode,CompartmentCode:a.CompartmentCode,CompartmentSeqNoInVehicle:a.CompartmentSeqNoInVehicle,CustomerCode:a.CustomerCode,DestinationCode:a.DestinationCode,DispatchCode:a.DispatchCode,FinishedProductCode:a.FinishedProductCode,Quantity:u.bo(a.Quantity),QuantityUOM:a.QuantityUOM,SequenceNo:a.SequenceNo,ShareholderCode:a.ShareholderCode,TrailerCode:a.TrailerCode})}return t}initialProductAssignmentList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};const t=[{key:O.s0,value:this.state.modRailDispatch.DispatchCode},{key:O.v6,value:h.LY.RAIL}],a={ShareHolderCode:this.props.selectedShareholder,keyDataCode:O.s0,KeyCodes:t};I()(N.cGe,u.tW(a,this.props.tokenDetails.tokenInfo)).then((t=>{const a=t.data;if(!0===a.IsSuccess)if(Array.isArray(a.EntityResult.DispatchCompartmentDetailPlanList)){const t=[];for(let e of a.EntityResult.DispatchCompartmentDetailPlanList)t.push({SequenceNo:e.SequenceNo,AssociatedOrderItems:e.AssociatedOrderItems,CompartmentSeqNoInVehicle:e.CompartmentSeqNoInVehicle,QuantityUOM:e.QuantityUOM,Quantity:e.Quantity,TrailerCode:e.TrailerCode,CarrierCompanyCode:e.CarrierCompanyCode,CompartmentCode:e.CompartmentCode,ShareholderCode:e.ShareholderCode,FinishedProductCode:e.FinishedProductCode,CustomerCode:e.CustomerCode,DestinationCode:e.DestinationCode,DispatchCode:e.DispatchCode,AssociatedContractItems:e.AssociatedContractItems,Attributes:e.Attributes,ContractCode:null!=e.AssociatedContractItems?e.AssociatedContractItems[0].ContractCode:null});this.setState({modRailWagonList:t,productAssignmentSaveEnabled:t.length>0},(()=>this.getProductAssignmentQuantity(t,e)))}else this.setState({modRailWagonList:[],productAssignmentSaveEnabled:!1})})).catch((e=>{console.log("Error while getting initialProductAssignmentList: ",e)}))}validateProductAssignSave(e){const t={messageType:"critical",message:"ViewRailDispatch_ProductAssignment_status",messageResultDetails:[]},a=D().cloneDeep(k.sT);for(let i of e){a.forEach((e=>{"PlannedQuantity"===e.field&&(e.field="Quantity");let a="";void 0!==e.validator&&(a=u.jr(e.validator,i[e.field])),""!==a&&t.messageResultDetails.push({keyFields:["RailDispatchPlanDetail_DispatchCode",e.displayName],keyValues:[this.state.modRailDispatch.DispatchCode,i[e.field]],isSuccess:!1,errorMessage:a})}));let e=[];null!==i.AttributesForUI&&void 0!==i.AttributesForUI&&(e=i.AttributesForUI.filter((e=>i.Attributes.some((t=>{const a=t.ListOfAttributeData.findIndex((t=>t.AttributeCode===e.AttributeCode))>=0;return e.TerminalCode===t.TerminalCode&&a}))))),e.forEach((e=>{const a=u.I5(e,e.AttributeValue);""!==a&&(this.props.userDetails.EntityResult.IsEnterpriseNode?t.messageResultDetails.push({keyFields:["CompAttributeComp","CompAttributeTerminal",e.AttributeName],keyValues:[i.SequenceNo,e.TerminalCode,e.AttributeValue],isSuccess:!1,errorMessage:a}):t.messageResultDetails.push({keyFields:["CompAttributeComp",e.AttributeName],keyValues:[i.SequenceNo,e.AttributeValue],isSuccess:!1,errorMessage:a}))})),this.toggleExpand(i,!0,!0),delete i.AttributesForUI}return!(t.messageResultDetails.length>0)||(this.props.onNotify(t),!1)}initialLoadSpotAssignmentList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};const t={ShareHolderCode:this.props.selectedShareholder,KeyCodes:[{key:"DispatchCode",value:this.state.modRailDispatch.DispatchCode}]};I()(N.eJJ,u.tW(t,this.props.tokenDetails.tokenInfo)).then((t=>{const a=t.data;if(!0===a.IsSuccess&&Array.isArray(a.EntityResult)){for(let e of a.EntityResult)e.ReturnQuantityUOM=this.state.modRailDispatch.QuantityUOM,void 0!==e.SpurCode&&""!==e.SpurCode&&null!==e.SpurCode&&(this.getRailLoadSpotDevices(e.SpurCode,"CLUSTER"),this.getRailLoadSpotDevices(e.ClusterCode,"BCU"));this.setState({railWagonBatchPlanList:a.EntityResult,modRailWagonBatchPlanList:D().cloneDeep(a.EntityResult),loadSpotAssignmentSaveEnabled:!0})}else this.setState({railWagonBatchPlanList:[],modRailWagonBatchPlanList:[],loadSpotAssignmentSaveEnabled:!1}),console.log("Error in GetRailDispatchBatchPlanDetails: ",a.ErrorList);e()})).catch((e=>{this.setState({railWagonBatchPlanList:[],modRailWagonBatchPlanList:[],loadSpotAssignmentSaveEnabled:!1}),console.log("Error while getting GetRailDispatchBatchPlanDetails: ",e)}))}validateLoadSpotAssignSave(e){const t={messageType:"critical",message:"ViewRailDispatch_LoadSportAssignment_status",messageResultDetails:[]},a=D().cloneDeep(k.P1);for(let i of e)a.forEach((e=>{let a="";void 0!==e.validator&&(a=u.jr(e.validator,i[e.field])),""!==a&&t.messageResultDetails.push({keyFields:["RailDispatchPlanDetail_DispatchCode",e.displayName],keyValues:[this.state.modRailDispatch.DispatchCode,i[e.field]],isSuccess:!1,errorMessage:a})}));return!(t.messageResultDetails.length>0)||(this.props.onNotify(t),!1)}validateRecordWeightSave(e){const t={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[]};let a=!1;for(let i of e)null!==i.TareWeight&&""!==i.TareWeight&&(a=!0,null!==i.TareWeightWeightBridgeCode&&""!==i.TareWeightWeightBridgeCode||t.messageResultDetails.push({keyFields:["Rail_Wagon_Code"],keyValues:[i.WagonCode],isSuccess:!1,errorMessage:"ViewShipment_WBMandatory"})),null!==i.LadenWeight&&""!==i.LadenWeight&&(a=!0,null!==i.LadenWeightWeightBridgeCode&&""!==i.LadenWeightWeightBridgeCode||t.messageResultDetails.push({keyFields:["Rail_Wagon_Code"],keyValues:[i.WagonCode],isSuccess:!1,errorMessage:"ViewShipment_WBMandatory"})),i.StartTime>=i.EndTime&&t.messageResultDetails.push({keyFields:["Rail_Wagon_Code"],keyValues:[i.WagonCode],isSuccess:!1,errorMessage:"MarineDispatchManualEntry_ErrorLoadTime"});return a||t.messageResultDetails.push({keyFields:["RailDispatchPlanDetail_DispatchCode"],keyValues:[this.state.modRailDispatch.DispatchCode],isSuccess:!1,errorMessage:"ERRMSG_RAIL_DISPATCH_WAGON_WEIGHBRIDGE_INFO_EMPTY"}),!(t.messageResultDetails.length>0)||(this.props.onNotify(t),!1)}getKPIList(e){if(!0===u.ab(this.props.userDetails.EntityResult.FunctionsList,F.i.view,F.bL)){let t={PageName:U.l7,TransportationType:h.LY.RAIL,InputParameters:[{key:"ShipmentCode",value:e}]};I()(N.dxq,u.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({railDispatchKPIList:t.EntityResult.ListKPIDetails}):(this.setState({railDispatchKPIList:[]}),console.log("Error in pipeline KPIList:",t.ErrorList))})).catch((e=>{console.log("Error while getting PipelineDispatch KPIList:",e)}))}}getMaxCompartments(){try{I()(N.xAA+"?LookUpTypeCode=VirtualPreset",u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess&&(isNaN(parseInt(t.EntityResult["RailMaximumNumberOfWagonsPerTrain "]))||this.setState({maxNumberOfCompartments:parseInt(t.EntityResult["RailMaximumNumberOfWagonsPerTrain "])}))}))}catch(e){console.log("Error while getting RailDispatchDetailsComposite getMaxCompartments:",e)}}getFunctionGroupName(){return this.state.showAuthenticationLayout||this.state.showWagonAssignmentAuthenticationLayout?F.xz:this.state.showProductAssignmentAuthenticationLayout?F.lz:this.state.showLoadSpotAssignmentAuthenticationLayout?F.YO:this.state.showManualEntryAuthenticationLayout?F.Mm:void 0}getDeleteorEditMode(){return this.state.showAuthenticationLayout||this.state.showWagonAssignmentAuthenticationLayout?""===this.state.railDispatch.DispatchCode?F.i.add:F.i.modify:this.state.showManualEntryAuthenticationLayout?F.i.add:F.i.modify}handleOperation(){return this.state.showAuthenticationLayout?this.saveRailDispatch:this.state.showWagonAssignmentAuthenticationLayout?this.railWagonSave:this.state.showProductAssignmentAuthenticationLayout?this.productAssignmentSave:this.state.showLoadSpotAssignmentAuthenticationLayout?this.railLoadSpotSave:this.state.showManualEntryAuthenticationLayout?this.addLoadingDetails:void 0}showPasswordCheckPopupModal(){return this.state.showAuthenticationLayout||this.state.showWagonAssignmentAuthenticationLayout||this.state.showProductAssignmentAuthenticationLayout||this.state.showLoadSpotAssignmentAuthenticationLayout||this.state.showManualEntryAuthenticationLayout?(0,p.jsx)(V.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:this.getDeleteorEditMode(),functionGroup:this.getFunctionGroupName(),handleClose:this.handleAuthenticationClose,handleOperation:this.handleOperation()}):null}render(){const e=[{fieldName:"RailDispatchPlanList_DateLastModified",fieldValue:new Date(this.state.modRailDispatch.UpdatedTime).toLocaleDateString()+" "+new Date(this.state.modRailDispatch.UpdatedTime).toLocaleTimeString()},{fieldName:"RailDispatchPlanDetail_LastActiveTime",fieldValue:void 0!==this.state.modRailDispatch.LastActiveTime&&null!==this.state.modRailDispatch.LastActiveTime?new Date(this.state.modRailDispatch.LastActiveTime).toLocaleDateString()+" "+new Date(this.state.modRailDispatch.LastActiveTime).toLocaleTimeString():""},{fieldName:"RailDispatchPlanDetail_CreateTime",fieldValue:new Date(this.state.modRailDispatch.CreatedTime).toLocaleDateString()+" "+new Date(this.state.modRailDispatch.CreatedTime).toLocaleTimeString()}],t=[];Object.keys(h.U6).forEach((e=>{"None"!==e&&"Contract"!==e||t.push({text:e,value:h.U6[e]})}));const a=this.state.modalData,i=0===this.state.tabActiveIndex;return this.state.isReadyToRender?this.state.isOpenSubPage?"RailDispatchCompartmentManualEntryDetails"===this.props.subPageName?(0,p.jsxs)("div",{children:[(0,p.jsx)(l.A,{children:(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsx)(w.A,{newEntityName:this.state.modRailDispatch.DispatchCode+" - "+e("ManualEntry")})})}),this.showPasswordCheckPopupModal(),(0,p.jsx)(l.A,{children:(0,p.jsx)(C,{modLoadingDataInfo:this.state.modLoadingDataInfo,validationErrors:this.state.manualEntryValidationDict,listOptions:{wagonCodes:this.state.wagonCodeOptions,clusterCodes:this.state.clusterCodeOptions,BCUCodes:this.state.BCUCodeOptions,loadingArmCodes:this.state.loadingArmCodeOptions,quantityUOMs:this.state.quantityUOMOptions,densityUOMs:this.state.densityUOMOptions,temperatureUOMs:this.state.temperatureUOMOptions,tankCodes:this.getTankCodeSearchOptions(),meterCodes:this.getMeterCodeSearchOptions()},selectedAttributeList:this.state.manualEntrySelectedAttributeList,attributeValidationErrorList:this.state.manualEntryAttributeValidationErrorList,onAttributeCellDataEdit:this.handleManualEntryAttributeCellDataEdit,onFieldChange:this.handleCompartmentManualEntryChange,onDateTextChange:this.handleManualDateTextChange,onTankSearchChange:this.handleTankSearchChange,onMeterSearchChange:this.handleMeterSearchChange,onTabChange:this.handleManualEntryTabChange,tabActiveIndex:this.state.manualEntryTabActiveIndex})}),(0,p.jsx)(l.A,{children:(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col col-lg-4",children:(0,p.jsx)(o.Button,{className:"backButton",onClick:this.handleSubPageBackOnClick,content:e("Back")})}),(0,p.jsxs)("div",{className:"col col-lg-8",style:{textAlign:"right"},children:[(0,p.jsx)(o.Button,{content:e("LookUpData_btnReset"),className:"cancelButton",onClick:this.handleCompartmentManualEntryReset}),(0,p.jsx)(o.Button,{content:e("Save"),onClick:this.handleCompartmentManualEntrySave,disabled:!this.state.compartmentManualEntrySaveEnabled})]})]})})})]}):"RailDispatchViewAuditTrailDetails"===this.props.subPageName?(0,p.jsxs)("div",{children:[(0,p.jsx)(l.A,{children:(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsx)(w.A,{newEntityName:this.state.modRailDispatch.DispatchCode+" - "+e("ViewRailDispatchList_ViewAuditTrail")})})}),(0,p.jsx)(l.A,{children:(0,p.jsx)(S,{modRailDispatch:this.state.modRailDispatch,auditTrailList:this.state.auditTrailList,modalData:this.state.modalData,onModalDataChange:this.handleModalDataChange,onPrint:this.handlePrintAuditTrail,Attributes:void 0!==this.state.auditTrailList&&this.state.auditTrailList.length>0?this.state.auditTrailList[0].AttributesforUI:[]})}),(0,p.jsx)(l.A,{children:(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col col-lg-4",children:(0,p.jsx)(o.Button,{className:"backButton",onClick:this.handleSubPageBackOnClick,content:e("Back")})}),(0,p.jsx)("div",{className:"col col-lg-8",style:{textAlign:"right"},children:(0,p.jsx)(o.Button,{content:e("ViewAuditTrail_PrintAuditTrail"),onClick:this.handleOpenPrintAuditTrailPreview})})]})})})]}):"RailDispatchViewLoadingDetailsDetails"===this.props.subPageName?(0,p.jsxs)("div",{children:[(0,p.jsx)(l.A,{children:(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsx)(w.A,{newEntityName:this.state.modRailDispatch.DispatchCode+" - "+e("ViewRailDispatchList_ViewTransactions")})})}),(0,p.jsx)(l.A,{children:(0,p.jsx)(R,{loadingDetailsList:this.state.loadingDetailsList,hideColumnList:this.state.loadingDetailsHideColumnList})}),(0,p.jsx)(l.A,{children:(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col col-lg-4",children:(0,p.jsx)(o.Button,{className:"backButton",onClick:this.handleSubPageBackOnClick,content:e("Back")})}),(0,p.jsx)("div",{className:"col col-lg-8",style:{textAlign:"right"}})]})})})]}):"RailDispatchRailWagonAssignmentDetails"===this.props.subPageName?(0,p.jsxs)("div",{children:[(0,p.jsx)(l.A,{children:(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsx)(w.A,{newEntityName:this.state.modRailDispatch.DispatchCode+" - "+e("RailDispatchList_WagonAssignment")})})}),this.showPasswordCheckPopupModal(),(0,p.jsx)(l.A,{children:(0,p.jsx)(A,{listOptions:{carrierCodes:this.state.carrierCodeOptions,trailerCodes:this.state.trailerCodeOptions},modRailWagonList:this.state.modRailWagonList,data:this.state.railWagonAssignmentData,onFieldChange:this.handleRailWagonAssignmentChange,selectedRow:this.state.selectedRailWagons,onSelectionChange:this.handleRailWagonSelectionChange,onAssignWagon:this.handleRailWagonAssignmentAdd,onDeleteWagon:this.handleRailWagonAssignmentDelete,onMoveWagon:this.handleRailWagonAssignmentMove,onReverseSelect:this.handleRailWagonAssignmentReverseSelect})}),(0,p.jsx)(l.A,{children:(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col col-lg-4",children:(0,p.jsx)(o.Button,{className:"backButton",onClick:this.handleSubPageBackOnClick,content:e("Back")})}),(0,p.jsxs)("div",{className:"col col-lg-8",style:{textAlign:"right"},children:[(0,p.jsx)(o.Button,{content:e("LookUpData_btnReset"),className:"cancelButton",onClick:this.handleRailWagonAssignReset}),(0,p.jsx)(o.Button,{content:e("Save"),onClick:this.handleRailWagonAssignSave,disabled:!this.state.railWagonAssignmentSaveEnabled})]})]})})})]}):"RailDispatchProductAssignmentDetails"===this.props.subPageName?(0,p.jsxs)("div",{children:[(0,p.jsx)(l.A,{children:(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsx)(w.A,{newEntityName:this.state.modRailDispatch.DispatchCode+" - "+e("RailDispatchList_ProductAssignment")})})}),this.showPasswordCheckPopupModal(),(0,p.jsx)(l.A,{children:(0,p.jsx)(b,{listOptions:{shareholderCodes:this.state.shareholders,contractCodes:this.state.contractCodeOptions,finishedProductCodes:this.state.finishedProductOptions,customerDestinations:this.state.customerDestinationOptions},modRailWagonList:this.state.modRailWagonList,onCellDataEdit:this.handleProductAssignmentCellDataEdit,createdFromEntity:this.state.modRailDispatch.CreatedFromEntity,expandedRows:this.state.productAssignmentExpandedRows,toggleExpand:this.productAssignmentToggleExpand,onCompAttributeCellDataEdit:this.handleProductAssignmentAttributeCellDataEdit,railLookUpData:this.props.railLookUpData})}),(0,p.jsx)(l.A,{children:(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col col-lg-4",children:(0,p.jsx)(o.Button,{className:"backButton",onClick:this.handleSubPageBackOnClick,content:e("Back")})}),(0,p.jsxs)("div",{className:"col col-lg-8",style:{textAlign:"right"},children:[(0,p.jsx)(o.Button,{content:e("LookUpData_btnReset"),className:"cancelButton",onClick:this.handleProductAssignReset}),(0,p.jsx)(o.Button,{content:e("Save"),onClick:this.handleProductAssignSave,disabled:!this.state.productAssignmentSaveEnabled})]})]})})})]}):"RailDispatchLoadSpotAssignmentDetails"===this.props.subPageName?(0,p.jsxs)("div",{children:[(0,p.jsx)(l.A,{children:(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsx)(w.A,{newEntityName:this.state.modRailDispatch.DispatchCode+" - "+e("RailDispatchList_LoadSpotAssignment")})})}),this.showPasswordCheckPopupModal(),(0,p.jsx)(l.A,{children:(0,p.jsx)(f,{listOptions:{spurCodes:this.state.spurCodeOptions,clusterCodes:this.state.loadSpotClusterCodeOptions,BCUCodes:this.state.loadSpotBCUCodeOptions},modRailWagonBatchPlanList:this.state.modRailWagonBatchPlanList,onCellDataEdit:this.handleLoadSpotAssignmentCellDataEdit,onAuthorize:this.handleLoadSpotAssignmentAssignWagon})}),(0,p.jsx)(l.A,{children:(0,p.jsx)(B.A,{isOpen:this.state.isShowMultipleSpurs,confirmMessage:"Confirm_LoadSpot",handleNo:()=>{this.setState({isShowMultipleSpurs:!1})},handleYes:()=>this.saveLoadSpotAfterConfirm()})}),(0,p.jsx)(l.A,{children:(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col col-lg-4",children:(0,p.jsx)(o.Button,{className:"backButton",onClick:this.handleSubPageBackOnClick,content:e("Back")})}),(0,p.jsxs)("div",{className:"col col-lg-8",style:{textAlign:"right"},children:[(0,p.jsx)(o.Button,{content:e("LookUpData_btnReset"),className:"cancelButton",onClick:this.handleLoadSpotAssignReset}),(0,p.jsx)(o.Button,{content:e("Save"),onClick:this.handleLoadSpotAssignSave,disabled:!this.state.loadSpotAssignmentSaveEnabled})]})]})})})]}):"RailDispatchRecordWeightDetails"===this.props.subPageName?(0,p.jsxs)("div",{children:[(0,p.jsx)(l.A,{children:(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsx)(w.A,{newEntityName:this.state.modRailDispatch.DispatchCode+" - "+e("ViewRailDispatch_RecordWeight")})})}),(0,p.jsx)(l.A,{children:(0,p.jsx)(T,{listOptions:{weightBridges:this.state.weightBridgeOptions},modWeightBridgeData:this.state.modWeightBridgeData,onCellDataEdit:this.handleRecordWeightCellDataEdit,onDateTextChange:this.handleDateTextChange})}),(0,p.jsx)(l.A,{children:(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col col-lg-4",children:(0,p.jsx)(o.Button,{className:"backButton",onClick:this.handleSubPageBackOnClick,content:e("Back")})}),(0,p.jsxs)("div",{className:"col col-lg-8",style:{textAlign:"right"},children:[(0,p.jsx)(o.Button,{content:e("LookUpData_btnReset"),className:"cancelButton",onClick:this.handleRecordWeightReset}),(0,p.jsx)(o.Button,{content:e("Save"),onClick:this.handleRecordWeightSave,disabled:!this.state.recordWeightSaveEnabled})]})]})})})]}):null:(0,p.jsxs)("div",{children:[(0,p.jsx)(l.A,{children:(0,p.jsx)(w.A,{entityCode:this.state.railDispatch.DispatchCode,newEntityName:"RailDispatchPlanDetail_NewRailDispatch",popUpContents:e})}),(0,p.jsx)(Q.A,{KPIList:this.state.railDispatchKPIList,children:" "}),(0,p.jsx)(l.A,{children:(0,p.jsx)(m,{railDispatch:this.state.railDispatch,modRailDispatch:this.state.modRailDispatch,modAssociations:this.state.modAssociations,modWagonDetails:this.state.modWagonDetails,validationErrors:this.state.validationErrors,selectedAssociations:this.state.selectedAssociations,listOptions:{shareholders:this.state.shareholders,terminalCodes:this.props.terminalCodes,quantityUOMs:this.state.quantityUOMOptions,routeCodes:this.getRouteCodeSearchOptions(),railWagonCategories:this.state.railWagonCategoryOptions,contractCodes:this.state.contractCodeOptions,createdFromEntities:t,finishedProducts:this.state.finishedProductOptions,customerDestinations:this.state.customerDestinationOptions},attributeValidationErrors:this.state.attributeValidationErrors,onAttributeCellDataEdit:this.handleAttributeCellDataEdit,onCompAttributeCellDataEdit:this.handleCompAttributeCellDataEdit,selectedAttributeList:this.state.selectedAttributeList,toggleExpand:this.toggleExpand,expandedRows:this.state.expandedRows,tabActiveIndex:this.state.tabActiveIndex,railRouteData:this.state.railRouteData,onFieldChange:this.handleChange,onDateTextChange:this.handleDateTextChange,onAllTerminalsChange:this.handleAllTerminalsChange,onAssociationSelectionChange:this.handleAssociationSelectionChange,onCellDataEdit:this.handleCellDataEdit,onWagonCellDataEdit:this.handleWagonCellDataEdit,onAddAssociation:this.handleAddAssociation,onDeleteAssociation:this.handleDeleteAssociation,onRouteSearchChange:this.handleRouteSearchChange,toggleWagonExpand:this.toggleWagonExpand,expandedWagonRows:this.state.expandedWagonRows,onTabChange:this.handleTabChange,currentAccess:this.props.currentAccess,isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,compartmentDetailsPageSize:this.props.userDetails.EntityResult.PageAttibutes.WebPortalListPageSize,enableHSEInspection:this.props.enableHSEInspection,railLookUpData:this.props.railLookUpData,WagonDetailTab:""===this.state.railDispatch.DispatchCode||null===this.state.railDispatch.DispatchCode||void 0===this.state.railDispatch.DispatchCode?[]:[""],shipmentSource:this.props.shipmentSource})}),(0,p.jsx)(l.A,{children:(0,p.jsx)(x.q,{handleBack:this.props.onBack,handleSave:i?this.handleSave:this.handleCompartmentSave,handleReset:this.handleReset,saveEnabled:i?this.state.saveEnabled:this.state.compartmentSaveEnabled})}),this.showPasswordCheckPopupModal(),(0,p.jsx)(l.A,{children:(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)(o.Modal,{size:"mini",open:this.state.modalData.forceCompleteCompartment.isOpen,closeOnDimmerClick:!1,children:[(0,p.jsx)(o.Modal.Content,{children:(0,p.jsx)("p",{children:e("ForceToComplete")})}),(0,p.jsxs)(o.Modal.Footer,{children:[(0,p.jsx)(o.Button,{content:e("AccessCardInfo_Ok"),onClick:this.handleForceCompleteCompartment}),(0,p.jsx)(o.Button,{content:e("AccessCardInfo_Cancel"),onClick:()=>{a.forceCompleteCompartment.isOpen=!1,this.setState({modalData:a})}})]})]})})})})]}):(0,p.jsx)(_.A,{message:"Loading"})}}const q=(0,M.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})),(e=>({userActions:(0,W.zH)(j,e)})))(H)},45217:(e,t,a)=>{a.d(t,{A:()=>l});a(65043);var i=a(72711),s=a(65187),o=a(67907),n=(a(63973),a(70579));const r=e=>(0,n.jsx)(s.A,{children:(0,n.jsx)(o.TranslationConsumer,{children:t=>(0,n.jsx)("div",{id:"confirmModal",children:(0,n.jsx)(i.Modal,{open:e.isOpen,size:"large",children:(0,n.jsx)(i.Modal.Content,{children:(0,n.jsxs)("div",{style:{textAlign:"center",fontSize:"20px"},children:[(0,n.jsx)("div",{children:(0,n.jsx)("b",{children:t(e.confirmMessage)})}),(0,n.jsxs)("div",{style:{marginTop:"50px"},children:[(0,n.jsx)(i.Button,{type:"secondary",content:t("COMMON_NO"),onClick:()=>e.handleNo()}),(0,n.jsx)(i.Button,{type:"primary",content:t("COMMON_YES"),onClick:()=>e.handleYes()})]})]})})})})})});r.defaultProps={isOpen:!1};const l=r},30089:()=>{}}]);
//# sourceMappingURL=1114.1d194207.chunk.js.map