"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[7519,3235],{27519:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var n=a(65043),o=a(69062),i=a(40854),s=a.n(i),c=a(72067),r=a(65187),l=a(43503),d=a(9256),h=a(40252),u=a(72711),p=a(67907),m=a(7523),T=a(70579);function R(e){let{reconciliationInfo:t,modReconciliationInfo:a,validationErrors:n,onFieldChange:i,listOptions:s,handleReconciliationStatusChange:c,handleReopenReconciliation:r,handleViewReport:l,handleViewUnAccountedTransactions:d,handleReset:h}=e;return(0,T.jsx)(p.TranslationConsumer,{children:e=>(0,T.jsxs)("div",{className:"detailsContainer",children:[(0,T.jsxs)("div",{className:"row",children:[(0,T.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,T.jsx)(u.Input,{fluid:!0,value:a.ReconciliationCode,disabled:!0,label:e("ReconciliationReportDetail_RcCode"),error:e(n.Code),reserveSpace:!1})}),(0,T.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,T.jsx)(u.Input,{fluid:!0,value:new Date(a.StartDate).toLocaleDateString()+" "+new Date(a.StartDate).toLocaleTimeString(),disabled:!0,label:e("ReconciliationReportDetail_StartDate"),error:e(n.Name),reserveSpace:!1})}),(0,T.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,T.jsx)(u.Input,{fluid:!0,value:new Date(a.EndDate).toLocaleDateString()+" "+new Date(a.EndDate).toLocaleTimeString(),disabled:!0,label:e("ReconciliationReportDetail_EndDate"),error:e(n.Name),reserveSpace:!1})}),(0,T.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,T.jsx)(u.Select,{fluid:!0,placeholder:"Select",value:a.Status,label:e("ReconciliationReportDetail_Status"),options:o.Zj(s.productReconciliationStatusOptions),onChange:e=>c(e),error:e(n.Status),reserveSpace:!1,search:!0,onResultsMessage:e("noResultsMessage")})}),(0,T.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,T.jsx)(u.Input,{fluid:!0,value:a.Remarks,label:e("CaptainInfo_Remarks"),error:e(n.Remarks),indicator:a.Status!==t.Status?"required":"",reserveSpace:!1,onChange:e=>i("Remarks",e)})}),(0,T.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,T.jsx)(u.Input,{fluid:!0,value:a.ReportWarnings,label:e("ReconciliationReportDetail_ReportProcessWarning"),disabled:!0,error:e(n.ReportWarnings),reserveSpace:!1})})]}),(0,T.jsxs)("div",{className:"row userActionPosition",children:[(0,T.jsx)("div",{className:"col-12 col-md-3 col-lg-4",children:(0,T.jsx)(u.Button,{type:"primary",onClick:()=>l(),content:e("ReconciliationReportDetail_btnViewReconcile"),disabled:!1})}),(0,T.jsx)("div",{className:"col-12 col-md-3 col-lg-4",children:(0,T.jsx)(u.Button,{type:"primary",content:e("ReconciliationReportDetail_btnUnAccountedTankTransaction"),disabled:"Meter"===t.EntityTypeCode,onClick:()=>d()})}),(0,T.jsx)("div",{className:"col-12 col-md-3 col-lg-4",children:(0,T.jsx)(u.Button,{type:"primary",disabled:"Tank"===t.EntityTypeCode,content:e("ReconciliationReportDetail_btnUnAccountedMeterTransaction"),onClick:()=>d()})}),(0,T.jsx)("div",{className:"col-12 col-md-3 col-lg-4",children:(0,T.jsx)(u.Button,{type:"primary",onClick:()=>r(),disabled:!(a.Status.toUpperCase()===m.ZS.Reconciled_Diff.toUpperCase()),content:e("ReconciliationReportDetail_btnManualReconcile")})})]})]})})}R.defaultProps={listOptions:{productReconciliationStatusOptions:[]}};var C=a(78374);function y(e){let{transactionData:t,handleBack:a,pageSize:n}=e;return(0,T.jsx)("div",{children:(0,T.jsx)(p.TranslationConsumer,{children:e=>(0,T.jsx)("div",{children:(0,T.jsxs)("div",{className:"detailsContainer",children:[(0,T.jsxs)("div",{id:"printTable",children:[(0,T.jsx)("div",{className:"row",children:(0,T.jsx)("div",{className:"col-12",children:(0,T.jsx)("h3",{children:e("MeterUnaccountedTransaction_Header")})})}),(0,T.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,T.jsx)("div",{className:"col-12 detailsTable ",children:(0,T.jsxs)(C.bQ,{data:t,reorderableColumns:!0,resizableColumns:!0,search:!0,searchPlaceholder:e("LoadingDetailsView_SearchGrid"),rows:n,children:[(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"MeterUnaccountedTransaction_MeterCode",header:e("MeterUnaccountedTransaction_MeterCode"),editable:!1,editFieldType:"text"},"MeterUnaccountedTransaction_MeterCode"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"MeterUnaccountedTransaction_TankCode",header:e("MeterUnaccountedTransaction_TankCode"),editable:!1,editFieldType:"text"},"MeterUnaccountedTransaction_TankCode"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"Vehicle_Transport",header:e("Vehicle_Transport"),editable:!1,editFieldType:"text"},"Vehicle_Transport"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"MeterUnaccountedTransaction_BPCode",header:e("MeterUnaccountedTransaction_BPCode"),editable:!1,editFieldType:"text"},"MeterUnaccountedTransaction_BPCode"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"MeterUnaccountedTransaction_Type",header:e("MeterUnaccountedTransaction_Type"),editable:!1,editFieldType:"text"},"MeterUnaccountedTransaction_Type"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"MeterUnaccountedTransaction_UnAccountedGrossQuantity",header:e("MeterUnaccountedTransaction_UnAccountedGrossQuantity"),editable:!1,editFieldType:"text"},"MeterUnaccountedTransaction_UnAccountedGrossQuantity"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"MeterUnaccountedTransaction_UnAccountedNetQuantity",header:e("MeterUnaccountedTransaction_UnAccountedNetQuantity"),editable:!1,editFieldType:"text"},"MeterUnaccountedTransaction_UnAccountedNetQuantity"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"MeterUnaccountedTransaction_QuantityUOM",header:e("MeterUnaccountedTransaction_QuantityUOM"),editable:!1,editFieldType:"text"},"MeterUnaccountedTransaction_QuantityUOM"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"MeterUnaccountedTransaction_CreatedTime",header:e("MeterUnaccountedTransaction_CreatedTime"),editable:!1,editFieldType:"text",renderer:e=>new Date(e.value).toLocaleDateString()},"MeterUnaccountedTransaction_CreatedTime")]})})})]}),(0,T.jsx)("div",{className:"row",children:(0,T.jsx)("div",{className:"col-12 col-sm-6 col-lg-8",children:(0,T.jsx)(u.Button,{className:"backButton",onClick:a,content:e("Back")})})})]})})})})}function f(e){let{transactionData:t,handleBack:a,pageSize:n}=e;return(0,T.jsx)("div",{children:(0,T.jsx)(p.TranslationConsumer,{children:e=>(0,T.jsx)("div",{children:(0,T.jsxs)("div",{className:"detailsContainer",children:[(0,T.jsxs)("div",{id:"printTable",children:[(0,T.jsx)("div",{className:"row",children:(0,T.jsx)("div",{className:"col-12",children:(0,T.jsx)("h3",{children:e("TankUnaccountedTransaction_Header")})})}),(0,T.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,T.jsx)("div",{className:"col-12 detailsTable ",children:(0,T.jsxs)(C.bQ,{data:t,reorderableColumns:!0,resizableColumns:!0,search:!0,searchPlaceholder:e("LoadingDetailsView_SearchGrid"),rows:n,children:[(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"TankUnaccountedTransaction_TankCode",header:e("TankUnaccountedTransaction_TankCode"),editable:!1,editFieldType:"text"},"TankUnaccountedTransaction_TankCode"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"TankUnaccountedTransaction_BPCode",header:e("TankUnaccountedTransaction_BPCode"),editable:!1,editFieldType:"text"},"TankUnaccountedTransaction_BPCode"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"Vehicle_Transport",header:e("Vehicle_Transport"),editable:!1,editFieldType:"text"},"Vehicle_Transport"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"TankUnaccountedTransaction_Type",header:e("TankUnaccountedTransaction_Type"),editable:!1,editFieldType:"text"},"TankUnaccountedTransaction_Type"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"TankUnaccountedTransaction_UnAccountedGrossQuantity",header:e("TankUnaccountedTransaction_UnAccountedGrossQuantity"),editable:!1,editFieldType:"text"},"TankUnaccountedTransaction_UnAccountedGrossQuantity"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"TankUnaccountedTransaction_UnAccountedNetQuantity",header:e("TankUnaccountedTransaction_UnAccountedNetQuantity"),editable:!1,editFieldType:"text"},"TankUnaccountedTransaction_UnAccountedNetQuantity"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"TankUnaccountedTransaction_QuantityUOM",header:e("TankUnaccountedTransaction_QuantityUOM"),editable:!1,editFieldType:"text"},"TankUnaccountedTransaction_QuantityUOM"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"TankUnaccountedTransaction_Density",header:e("TankUnaccountedTransaction_Density"),editable:!1,editFieldType:"text"},"TankUnaccountedTransaction_Density"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"TankUnaccountedTransaction_DensityUOM",header:e("TankUnaccountedTransaction_DensityUOM"),editable:!1,editFieldType:"text"},"TankUnaccountedTransaction_DensityUOM"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"TankUnaccountedTransaction_StartTime",header:e("TankUnaccountedTransaction_StartTime"),editable:!1,editFieldType:"text"},"TankUnaccountedTransaction_StartTime"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"TankUnaccountedTransaction_EndTime",header:e("TankUnaccountedTransaction_EndTime"),editable:!1,editFieldType:"text"},"TankUnaccountedTransaction_EndTime"),(0,T.jsx)(C.bQ.Column,{className:"compColHeight",field:"TankUnaccountedTransaction_CreatedTime",header:e("TankUnaccountedTransaction_CreatedTime"),editable:!1,editFieldType:"text"},"TankUnaccountedTransaction_CreatedTime")]})})})]}),(0,T.jsx)("div",{className:"row",children:(0,T.jsx)("div",{className:"col-12 col-sm-6 col-lg-8",children:(0,T.jsx)(u.Button,{className:"backButton",onClick:a,content:e("Back")})})})]})})})})}y.defaultProps={},f.defaultProps={};var g=a(46100),U=a(44192),S=(a(38726),a(97508)),v=a(93779),x=a(53536),k=a.n(x),D=a(80312),j=a(73571),_=a(15441),b=a(62900);class E extends n.Component{constructor(){super(...arguments),this.state={reconciliationInfo:k().cloneDeep(g.Pq),modReconciliationInfo:{},validationErrors:o.Th(U.jQ),isReadyToRender:!1,saveEnabled:!0,productReconciliationStatusOptions:[],showReport:!1,reonciliationReportNames:{tank:"",meter:""},showTankTransactions:!1,showMeterTransactions:!1,data:{},fromDate:new Date,toDate:new Date,dateError:"",showAuthenticationLayout:!1,tempReconciliationInfo:{}},this.updateProductReconciliationReport=()=>{try{this.handleAuthenticationClose(),this.setState({saveEnabled:!1});let e=k().cloneDeep(this.state.tempReconciliationInfo);this.updateReconciliationReport(e)}catch(e){console.log("ProductReconciliationReport Details Composite : Error in updateProductReconciliationReport")}},this.handleSave=()=>{try{let e=this.state.modReconciliationInfo;if(this.validateSave(e)){let t=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,a=k().cloneDeep(e);this.setState({showAuthenticationLayout:t,tempReconciliationInfo:a},(()=>{!1===t&&this.updateProductReconciliationReport()}))}else this.setState({saveEnabled:!0})}catch(e){console.log("ProductReconciliationReportDetailsComposite:Error occured on handleSave",e)}},this.handleReopenReconciliation=()=>{try{let e=this.state.modReconciliationInfo;e.RefreshWithLatestTransactions=!0,this.setState({saveEnabled:!1}),this.validateSave(e)?this.reopenReconciliation(e):this.setState({saveEnabled:!0})}catch(e){console.log("ProductReconciliationReportDetailsComposite:Error occured on handleReopenReconciliation",e)}},this.handleViewUnAccountedTransactions=()=>{try{"Meter"===k().cloneDeep(this.state.modReconciliationInfo).EntityTypeCode?(this.GetUnAccountedTransactionMeterList(this.props.shareholerCode),this.setState({showTankTransactions:!1,showMeterTransactions:!0})):(this.GetUnAccountedTransactionTankList(this.props.shareholerCode),this.setState({showTankTransactions:!0,showMeterTransactions:!1}))}catch(e){console.log("Error in handleViewUnAccountedTransactions",e)}},this.handleRangeSelect=e=>{let{to:t,from:a}=e;void 0!==t&&this.setState({toDate:t}),void 0!==a&&this.setState({fromDate:a})},this.handleLoadOrders=()=>{let e=o.wb(this.state.toDate,this.state.fromDate);if(""!==e)this.setState({dateError:e});else{this.setState({dateError:""});this.props.userDetails;this.state.showMeterTransactions?this.GetUnAccountedTransactionMeterList(this.props.shareholerCode):this.GetUnAccountedTransactionTankList(this.props.shareholerCode)}},this.handleReset=()=>{try{const{validationErrors:e}={...this.state},t=k().cloneDeep(this.state.reconciliationInfo);Object.keys(e).forEach((function(t){e[t]=""})),this.setState({modReconciliationInfo:{...t},selectedCompRow:[],validationErrors:e})}catch(e){console.log("ProductReconciliationDetailsComposite:Error occured on handleReset",e)}},this.handleChange=(e,t)=>{try{const a=k().cloneDeep(this.state.modReconciliationInfo);a[e]=t,this.setState({modReconciliationInfo:a});const n=k().cloneDeep(this.state.validationErrors);void 0!==U.jQ[e]&&(n[e]=o.jr(U.jQ[e],t),this.setState({validationErrors:n}))}catch(a){console.log("ProductReconciliationDetailsComposite:Error occured on handleChange",a)}},this.handleModalBack=()=>{this.setState({showReport:!1})},this.handleViewReport=()=>{try{void 0===this.reportServiceURI?s()(c.yTV,o.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{e.data.IsSuccess&&(this.reportServiceURI=e.data.EntityResult,this.setState({showReport:!0}))})):this.setState({showReport:!0})}catch(e){console.log("ProductReconciliationDetailsComposite:Error occured on handleView Report",e)}},this.BackEvent=()=>{try{this.setState({showTankTransactions:!1,showMeterTransactions:!1})}catch(e){console.log("Error in BackEvent",e)}},this.handleReconciliationStatusChange=e=>{try{let t=k().cloneDeep(this.state.modReconciliationInfo);t.Status=e,t.Status!==this.state.reconciliationInfo.Status&&(t.Remarks=""),this.setState({modReconciliationInfo:t})}catch(t){console.log(t)}},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentDidMount(){try{o.pJ(this.props.userDetails.EntityResult.IsArchived),this.getReconciliationReport(this.props.selectedRow),this.getLookUpData(),this.getProductReconciliationStatus(this.props.selectedRow.Reconciliation_Status)}catch(e){console.log("ProductReconciliationDetailsComposite:Error occured on componentDidMount",e)}}componentWillReceiveProps(e){try{if(""!==this.state.reconciliationInfo.reconciliationCode&&void 0===e.selectedRow.Common_Code&&this.props.tokenDetails.tokenInfo===e.tokenDetails.tokenInfo){this.getReconciliationReport(e.selectedRow);let t={...this.state.validationErrors};Object.keys(t).forEach((e=>{t[e]=""})),this.setState({validationErrors:t})}}catch(t){console.log("ProductReconciliationDetailsComposite:Error occured on componentWillReceiveProps",t)}}getProductReconciliationStatus(e){s()(c.xwF,o.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var a=t.data;if(!0===a.IsSuccess){let t=[];if(null!==a.EntityResult){Object.keys(a.EntityResult).forEach((e=>t.push(a.EntityResult[e])));let n=[];e.toUpperCase()===m.ZS.Open.toUpperCase()?n=t.filter((e=>e.toUpperCase()===m.ZS.Open.toUpperCase())):e.toUpperCase()===m.ZS.In_Progress.toUpperCase()?n=t.filter((e=>e.toUpperCase()===m.ZS.In_Progress.toUpperCase())):e.toUpperCase()===m.ZS.Reconciled_NoDiff.toUpperCase()?n=t.filter((e=>e.toUpperCase()===m.ZS.Reconciled_NoDiff.toUpperCase()||e.toUpperCase()===m.ZS.Approved.toUpperCase()||e.toUpperCase()===m.ZS.Closed.toUpperCase())):e.toUpperCase()===m.ZS.Approved.toUpperCase()?n=t.filter((e=>e.toUpperCase()===m.ZS.Approved.toUpperCase()||e.toUpperCase()===m.ZS.Closed.toUpperCase())):e.toUpperCase()===m.ZS.Reconciled_Diff.toUpperCase()?n=t.filter((e=>e.toUpperCase()===m.ZS.Reconciled_Diff.toUpperCase()||e.toUpperCase()===m.ZS.Approved.toUpperCase()||e.toUpperCase()===m.ZS.Rejected.toUpperCase())):e.toUpperCase()===m.ZS.Rejected.toUpperCase()&&(n=t.filter((e=>e.toUpperCase()===m.ZS.Rejected.toUpperCase()||e.toUpperCase()===m.ZS.Closed.toUpperCase()))),n.length>0?this.setState({productReconciliationStatusOptions:n}):this.setState({productReconciliationStatusOptions:t})}else console.log("No productReconciliationStatusOptions identified.")}else console.log("Error in GetProductReconciliationStatus:",a.ErrorList)})).catch((e=>{console.log("Error while getting ProductReconciliationStatus:",e)}))}validateSave(e){var t=k().cloneDeep(this.state.validationErrors);Object.keys(U.jQ).forEach((function(a){t[a]=o.jr(U.jQ[a],e[a])})),e.Status!==this.state.reconciliationInfo.Status&&(null!==e.Remarks&&""!==e.Remarks||(t.Remarks="CaptainInfo_RemarksRequired")),this.setState({validationErrors:t});var a=!0;return a&&(a=Object.values(t).every((function(e){return""===e}))),a}reopenReconciliation(e){let t=[{key:v.zf,value:e.Code}],a={keyDataCode:v.zf,KeyCodes:t,Entity:e},n={messageType:"critical",message:"ManualReconciliation_UpdateSuccessMsg",messageResultDetails:[{keyFields:["ReconciliationReportDetail_RcCode"],keyValues:[e.ReconciliationCode],isSuccess:!1,errorMessage:""}]};s()(c.BFq,o.tW(a,this.props.tokenDetails.tokenInfo)).then((t=>{let a=t.data;n.messageType=a.IsSuccess?"success":"critical",n.messageResultDetails[0].isSuccess=a.IsSuccess,!0===a.IsSuccess?this.setState({saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,D.i.modify,D.y_)},(()=>this.getReconciliationReport({Common_Code:e.ReconciliationCode}))):(n.messageResultDetails[0].errorMessage=a.ErrorList[0],this.setState({saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,D.i.modify,D.y_)}),console.log("Error in update ReconciliationReport:",a.ErrorList)),this.props.onSaved(this.state.modReconciliationInfo,"update",n)})).catch((e=>{this.setState({saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,D.i.modify,D.y_)}),n.messageResultDetails[0].errorMessage=e,this.props.onSaved(this.state.modReconciliationInfo,"modify",n)}))}GetUnAccountedTransactionTankList(e){let t=new Date(this.state.fromDate),a=new Date(this.state.toDate);t.setHours(0,0,0),a.setHours(23,59,59);let n={ShareholderCode:e,startRange:t,endRange:a};void 0!==e&&""!==e&&s()(c.Wto,o.tW(n,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({data:this.fillTankDetails(t.EntityResult),isReadyToRender:!0}):(this.setState({data:[],isReadyToRender:!0}),console.log("Error in GetUnAccountedTransactionTankList:",t.ErrorList))})).catch((e=>{this.setState({data:[],isReadyToRender:!0}),console.log("Error while getting UnAccountedTransactionTank List:",e)}))}fillTankDetails(e){try{return e.Table.forEach((e=>{null!==e.TankUnaccountedTransaction_UnAccountedGrossQuantity&&""!==e.TankUnaccountedTransaction_UnAccountedGrossQuantity&&(e.TankUnaccountedTransaction_UnAccountedGrossQuantity=e.TankUnaccountedTransaction_UnAccountedGrossQuantity.toLocaleString()),null!==e.TankUnaccountedTransaction_UnAccountedNetQuantity&&""!==e.TankUnaccountedTransaction_UnAccountedNetQuantity&&(e.TankUnaccountedTransaction_UnAccountedNetQuantity=e.TankUnaccountedTransaction_UnAccountedNetQuantity.toLocaleString()),null!==e.TankUnaccountedTransaction_Density&&""!==e.TankUnaccountedTransaction_Density&&(e.TankUnaccountedTransaction_Density=e.TankUnaccountedTransaction_Density.toLocaleString())})),this.setState({data:e}),e}catch(t){console.log("UnAccountedTransactionMeterDetailsComposite:Error occured on fillDetails",t)}}GetUnAccountedTransactionMeterList(e){let t=new Date(this.state.fromDate),a=new Date(this.state.toDate);t.setHours(0,0,0),a.setHours(23,59,59);let n={ShareholderCode:e,startRange:t,endRange:a};void 0!==e&&""!==e&&s()(c.Nh5,o.tW(n,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({data:this.fillMeterDetails(t.EntityResult),isReadyToRender:!0}):(this.setState({data:[],isReadyToRender:!0}),console.log("Error in GetUnAccountedTransactionMeterList:",t.ErrorList))})).catch((e=>{this.setState({data:[],isReadyToRender:!0}),console.log("Error while getting UnAccountedTransactionMeter List:",e)}))}fillMeterDetails(e){try{return e.Table.forEach((e=>{null!==e.MeterUnaccountedTransaction_UnAccountedGrossQuantity&&""!==e.MeterUnaccountedTransaction_UnAccountedGrossQuantity&&(e.MeterUnaccountedTransaction_UnAccountedGrossQuantity=e.MeterUnaccountedTransaction_UnAccountedGrossQuantity.toLocaleString()),null!==e.MeterUnaccountedTransaction_UnAccountedNetQuantity&&""!==e.MeterUnaccountedTransaction_UnAccountedNetQuantity&&(e.MeterUnaccountedTransaction_UnAccountedNetQuantity=e.MeterUnaccountedTransaction_UnAccountedNetQuantity.toLocaleString())})),this.setState({data:e}),e}catch(t){console.log("UnAccountedTransactionMeterDetailsComposite:Error occured on fillDetails",t)}}updateReconciliationReport(e){let t=[{key:v.zf,value:e.Code}],a={keyDataCode:v.zf,KeyCodes:t,Entity:e},n={messageType:"critical",message:"ProductReconciliation_UpdateMsg",messageResultDetails:[{keyFields:["ReconciliationReportDetail_RcCode"],keyValues:[e.ReconciliationCode],isSuccess:!1,errorMessage:""}]};s()(c.BFq,o.tW(a,this.props.tokenDetails.tokenInfo)).then((t=>{let a=t.data;n.messageType=a.IsSuccess?"success":"critical",n.messageResultDetails[0].isSuccess=a.IsSuccess,!0===a.IsSuccess?this.setState({saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,D.i.modify,D.y_)},(()=>this.getReconciliationReport({Common_Code:e.ReconciliationCode}))):(n.messageResultDetails[0].errorMessage=a.ErrorList[0],this.setState({saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,D.i.modify,D.y_)}),console.log("Error in update ReconciliationReport:",a.ErrorList)),this.props.onSaved(this.state.modReconciliationInfo,"update",n)})).catch((e=>{this.setState({saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,D.i.modify,D.y_)}),n.messageResultDetails[0].errorMessage=e,this.props.onSaved(this.state.modReconciliationInfo,"modify",n)}))}getReconciliationReport(e){if(void 0!==e.Common_Code){var t=[{key:v.zf,value:e.Common_Code}],a={reconciliationCode:e.Common_Code,keyDataCode:v.zf,KeyCodes:t};s()(c.GIH,o.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?(t.EntityResult.ReconciliationCode=t.EntityResult.ReconciliationCode.toString(),this.setState({isReadyToRender:!0,reconciliationInfo:k().cloneDeep(t.EntityResult),modReconciliationInfo:k().cloneDeep(t.EntityResult),saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,D.i.modify,D.y_)})):(this.setState({reconciliationInfo:k().cloneDeep(g.Pq),modReconciliationInfo:k().cloneDeep(g.Pq),isReadyToRender:!0}),console.log("Error in get ReconciliationReport:",t.ErrorList))})).catch((t=>{console.log("Error while get ReconciliationReport:",t,e)}))}else this.setState({reconciliationInfo:k().cloneDeep(g.Pq),modReconciliationInfo:k().cloneDeep(g.Pq),isReadyToRender:!0,saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,D.i.add,D.y_)})}getLookUpData(){s()(c.xAA+"?LookUpTypeCode=ReportConfig",o.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){var{reonciliationReportNames:a}={...this.state};a.tank=t.EntityResult.TankFolio,a.meter=t.EntityResult.MeterReconciliation,this.setState({reonciliationReportNames:a})}else console.log("Error in getLookUpData: ",t.ErrorList)})).catch((e=>{console.log("ProductReconciliationDetailsComposite: Error occurred on getLookUpData",e)}))}renderModal(){var{reonciliationReportNames:e}={...this.state};let t=null,a="";a="Meter"===this.state.reconciliationInfo.EntityTypeCode?e.meter:e.tank,t=this.props.userDetails.EntityResult.IsArchived?"TM/"+m.mD+"/"+a:"TM/"+m.PZ+"/"+a;let n={};return n={Culture:this.props.userDetails.EntityResult.UICulture,ReconciliationCode:this.state.reconciliationInfo.ReconciliationCode,readonly:1},(0,T.jsx)(r.A,{children:(0,T.jsx)(j.A,{showReport:this.state.showReport,handleBack:this.handleModalBack,handleModalClose:this.handleModalBack,proxyServerHost:c._Oi,reportServiceHost:this.reportServiceURI,filePath:t,parameters:n})})}render(){const e={productReconciliationStatusOptions:this.state.productReconciliationStatusOptions},t=[{fieldName:"CaptainInfo_LastUpdated",fieldValue:new Date(this.state.modReconciliationInfo.LastUpdatedTime).toLocaleDateString()+" "+new Date(this.state.modReconciliationInfo.LastUpdatedTime).toLocaleTimeString()},{fieldName:"CaptainInfo_CreatedTime",fieldValue:new Date(this.state.modReconciliationInfo.CreatedTime).toLocaleDateString()+" "+new Date(this.state.modReconciliationInfo.CreatedTime).toLocaleTimeString()}];return this.state.isReadyToRender?(0,T.jsxs)("div",{children:[(0,T.jsx)(r.A,{children:(0,T.jsx)(l.A,{entityCode:this.state.reconciliationInfo.ReconciliationCode,popUpContents:t})}),this.state.showTankTransactions||this.state.showMeterTransactions?this.state.showMeterTransactions?(0,T.jsxs)(r.A,{children:[(0,T.jsx)(_.L,{dateRange:{from:this.state.fromDate,to:this.state.toDate},dateError:this.state.dateError,handleRangeSelect:this.handleRangeSelect,handleLoadOrders:this.handleLoadOrders,filterText:"LoadTransactionMeter"}),(0,T.jsx)(y,{transactionData:this.state.data.Table,handleBack:this.BackEvent,pageSize:this.props.userDetails.EntityResult.PageAttibutes.WebPortalListPageSize})]}):(0,T.jsxs)(r.A,{children:[(0,T.jsx)(_.L,{dateRange:{from:this.state.fromDate,to:this.state.toDate},dateError:this.state.dateError,handleRangeSelect:this.handleRangeSelect,handleLoadOrders:this.handleLoadOrders,filterText:"LoadTransactionTank"}),(0,T.jsx)(f,{transactionData:this.state.data.Table,handleBack:this.BackEvent,pageSize:this.props.userDetails.EntityResult.PageAttibutes.WebPortalListPageSize})]}):!1===this.state.showReport?(0,T.jsxs)(r.A,{children:[(0,T.jsx)(R,{reconciliationInfo:this.state.reconciliationInfo,modReconciliationInfo:this.state.modReconciliationInfo,listOptions:e,validationErrors:this.state.validationErrors,onFieldChange:this.handleChange,handleReconciliationStatusChange:this.handleReconciliationStatusChange,handleReopenReconciliation:this.handleReopenReconciliation,handleViewReport:this.handleViewReport,handleViewUnAccountedTransactions:this.handleViewUnAccountedTransactions}),(0,T.jsx)(d.q,{handleBack:this.props.onBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.saveEnabled})]}):this.renderModal(),this.state.showAuthenticationLayout?(0,T.jsx)(b.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:D.i.modify,functionGroup:D.y_,handleOperation:this.updateProductReconciliationReport,handleClose:this.handleAuthenticationClose}):null]}):(0,T.jsx)(h.A,{message:""})}}const N=(0,S.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(E)},43503:(e,t,a)=>{a.d(t,{A:()=>c});a(65043);var n=a(67907),o=a(72711),i=a(70579);function s(e){let{entityCode:t,newEntityName:a,popUpContents:s}=e;return(0,i.jsx)(n.TranslationConsumer,{children:e=>(0,i.jsx)("div",{className:"headerContainer",children:(0,i.jsxs)("div",{className:"row headerSpacing",children:[(0,i.jsx)("div",{className:"col paddingHeaderItemLeft",children:(0,i.jsx)("span",{style:{margin:"auto"},className:"headerLabel",children:""===t||void 0===t?e(a):t})}),""!==t&&void 0!==t&&s.length>0?(0,i.jsx)("div",{className:"headerItemRight",children:(0,i.jsx)(o.Popup,{element:(0,i.jsxs)("div",{children:[e(s[0].fieldName)+" ",":"," "+s[0].fieldValue,(0,i.jsx)(o.Icon,{style:{marginLeft:"10px"},root:"common",name:"caret-down",size:"small"})]}),position:"bottom left",children:(0,i.jsx)(o.List,{className:"detailsHeaderPopUp",children:s.map((t=>(0,i.jsxs)(o.List.Content,{className:"detailsHeaderPopUpListPadding",children:[e(t.fieldName)+" ",":"," "+t.fieldValue]},"content.fieldName")))})})}):""]})})})}s.defaultProps={entityCode:"",newEntityName:"",popUpContents:[]};const c=s},9256:(e,t,a)=>{a.d(t,{q:()=>s});a(65043);var n=a(72711),o=a(67907),i=a(70579);function s(e){let{handleBack:t,handleSave:a,handleReset:s,saveEnabled:c}=e;return(0,i.jsx)(o.TranslationConsumer,{children:e=>(0,i.jsxs)("div",{className:"row userActionPosition",children:[(0,i.jsx)("div",{className:"col-12 col-md-3 col-lg-4",children:(0,i.jsx)(n.Button,{className:"backButton",onClick:t,content:e("Back")})}),(0,i.jsx)("div",{className:"col-12 col-md-9 col-lg-8",children:(0,i.jsxs)("div",{style:{float:"right"},children:[(0,i.jsx)(n.Button,{content:e("LookUpData_btnReset"),className:"cancelButton",onClick:s}),(0,i.jsx)(n.Button,{content:e("Save"),disabled:!c,onClick:a})]})})]})})}s.defaultProps={saveEnabled:!1}},15441:(e,t,a)=>{a.d(t,{L:()=>c});a(65043);var n=a(67907),o=a(72711),i=a(35861),s=a(70579);function c(e){let{handleDateTextChange:t,handleRangeSelect:a,handleLoadOrders:c,dateError:r,dateRange:l,filterText:d}=e;return(0,s.jsx)(n.TranslationConsumer,{children:e=>(0,s.jsxs)("div",{className:"dateRangeContainer",children:[(0,s.jsx)("div",{className:"dateRangeMargin",children:(0,s.jsx)(o.DatePicker,{type:"daterange",closeOnSelection:!0,error:e(r),displayFormat:(0,i.F1)(),rangeValue:l,onTextChange:t,onRangeSelect:a,reserveSpace:!1})}),(0,s.jsx)("div",{className:"dateSearch",children:(0,s.jsx)(o.Button,{content:e(d),onClick:c})})]})})}},73571:(e,t,a)=>{a.d(t,{A:()=>p});a(65043);var n=a(72711),o=a(728),i=a(92569),s=a(47766),c=(a(60663),a(7523)),r=a(97508),l=a(70579);function d(e){let{proxyServerHost:t,reportServiceHost:a,parameters:n,filePath:o,...c}=e;const r=t+"api/report",d=(e,t)=>{const a=t.settings.beforeSend;t.settings.beforeSend=function(t){a&&a(t),c.userDetails.EntityResult.IsWebPortalUser||(t.withCredentials=!0),t.URL_DEBUG.indexOf("parameters")>-1&&(t.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var t=e.hostElement;setTimeout((()=>{var e=t.querySelector(".wj-viewer-splitter"),a=t.querySelector(".wj-viewer-tabsleft").querySelectorAll("li")[2];a.disabled||(a.className="hidden",e.click())}),1e3)}})}};let h={Authorization:"Bearer "+c.tokenDetails.tokenInfo};const u=(e,n)=>{s._ReportService.prototype.load=function(e){var n=this,o=new s._Promise;return this._checkReportController(o)?(this.httpRequest(this._getReportInstancesUrl(),{method:"POST",data:e}).then((function(e){var i=s._parseReportExecutionInfo(e.responseText);n._instanceId=i.id,n._status=s._ExecutionStatus.loaded,n._outlinesLocation=i.outlinesLocation,n._statusLocation=i.statusLocation.replace(a,t),n._pageSettingsLocation=i.pageSettingsLocation,n._featuresLocation=i.featuresLocation,n._parametersLocation=i.parametersLocation,o.resolve(i)}),(function(e){o.reject(n._getError(e))})),o):o}};return(0,l.jsx)("div",{children:c.userDetails.EntityResult.IsWebPortalUser?(0,l.jsx)("div",{children:(0,l.jsx)(i.R,{requestHeaders:h,style:{height:"80vh"},parameters:n,serviceUrl:r,filePath:o,initialized:u,beforeSendRequest:d})}):(0,l.jsx)("div",{children:(0,l.jsx)(i.R,{style:{height:"80vh"},parameters:n,serviceUrl:r,filePath:o,initialized:u,beforeSendRequest:d})})})}d.defaultProps={parameters:{}},o.setLicenseKey(c.yQ);const h=(0,r.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(d);var u=a(67907);function p(e){let{proxyServerHost:t,reportServiceHost:a,filePath:o,handleBack:i,showReport:s,handleModalClose:c,parameters:r}=e;const[d]=(0,u.useTranslation)();return(0,l.jsx)(n.Modal,{style:{padding:"0px"},size:"fullscreen",open:s,children:(0,l.jsxs)("div",{children:[(0,l.jsx)(n.Header,{title:d("Header_TerminalManager"),menu:!1}),(0,l.jsx)(h,{proxyServerHost:t,reportServiceHost:a,filePath:o,parameters:r}),(0,l.jsx)("div",{style:{marginTop:"10px",marginLeft:"20px"},children:(0,l.jsx)(n.Button,{className:"backButton",onClick:i,content:d("Report_Back")})})]})})}p.defaultProps={parameters:{}}},35861:(e,t,a)=>{a.d(t,{F1:()=>c,i7:()=>r,r4:()=>s});var n=a(86178),o=a.n(n),i=(a(15660),a(65043),a(70579));function s(e,t){if(Array.isArray(e)){0===e.filter((e=>e.text===t)).length&&e.unshift({value:null,text:t})}return e}function c(){let e=window.navigator.userLanguage||window.navigator.language;return o().locale(e),o().localeData().longDateFormat("L")}function r(e){return(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{children:e}),(0,i.jsx)("div",{class:"ui red circular empty label badge  circle-padding"})]})}}}]);
//# sourceMappingURL=7519.dd912bb7.chunk.js.map