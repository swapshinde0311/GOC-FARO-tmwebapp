"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[7271],{67271:(e,t,a)=>{a.r(t),a.d(t,{default:()=>k});var r=a(65043),o=a(97508),s=a(65187),i=a(11981),n=a(14159),l=a(67907),d=a(72711),c=a(85800),u=a(69062),h=a(35861),m=a(70579);function p(e){let{modTruckManualEntryLoadingDetailsCommonInfo:t,modTruckManualEntryLoadingFPInfo:a,modTruckManualEntryLoadingBPInfo:r,modTruckManualEntryLoadingAdvInfo:o,validationErrors:i,validationErrorsForFP:n,validationErrorsForBP:p,listOptions:E,onFieldChange:g,onTabChange:y,productList:C,activeIndex:M,onDateTextChange:D,selectedAttributeList:T,attributeValidationErrors:S,selectedAttributeBPList:v,bpAttributeValidationErrors:L,selectedAttributeAdvList:f,advAttributeValidationErrors:A,handleAttributeCellDataEdit:b,handleAttributeCellDataEditBPandAdditive:I,currentCompTopUpReq:k}=e;const P=(e,t)=>{let a=[];return void 0!==e&&(a=e.find((e=>e.TerminalCode===t))),a.attributeValidationErrors};return(0,m.jsx)(l.TranslationConsumer,{children:e=>(0,m.jsx)("div",{children:(0,m.jsxs)("div",{className:"detailsContainer",children:[(0,m.jsxs)("div",{className:"row",children:[(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Select,{fluid:!0,placeholder:"Select",value:t.CompartmentSeqNoInVehicle,label:e("LoadingDetailsEntry_CompSeqNo"),options:u.Zj(E.compartmentSeqNoInVehicleList),onChange:e=>g("Common","CompartmentSeqNoInVehicle",e),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),indicator:"required",error:e(i.CompartmentSeqNoInVehicle)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.DatePicker,{fluid:!0,value:new Date(a.StartTime),label:e("UnloadingDetailsEntry_unloadStartTime"),disablePast:!1,type:"datetime",indicator:"required",onChange:e=>g("FP","StartTime",e),displayFormat:(0,h.F1)(),reserveSpace:!1,disableFuture:!0,minuteStep:1,onTextChange:(e,t)=>{D("StartTime",e,t)},error:e(n.StartTime)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.DatePicker,{fluid:!0,value:new Date(a.EndTime),label:e("UnloadingDetailsEntry_unloadEndTime"),minuteStep:1,disablePast:!1,type:"datetime",indicator:"required",onChange:e=>g("FP","EndTime",e),displayFormat:(0,h.F1)(),reserveSpace:!1,disableFuture:!0,onTextChange:(e,t)=>{D("EndTime",e,t)},error:e(n.EndTime)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Select,{fluid:!0,placeholder:"Select",value:t.BayCode,label:e("Bay_Bay"),options:u.Zj(E.Bays),onChange:e=>g("Common","BayCode",e),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),indicator:"required",error:e(i.BayCode)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Select,{fluid:!0,placeholder:"Select",value:t.BCUCode,label:e("LoadingDetails_BCUCode"),options:u.Zj(E.BCUs),onChange:e=>g("Common","BCUCode",e),multiple:!1,reserveSpace:!1,search:!1,indicator:"required",noResultsMessage:e("noResultsMessage"),error:e(i.BCUCode)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Select,{fluid:!0,placeholder:"Select",value:a.LoadingArmCode,label:e("Loadingarm_Loadingarm"),options:u.Zj(E.LoadingArms),onChange:e=>g("FP","LoadingArmCode",e),multiple:!1,reserveSpace:!1,search:!1,indicator:"required",noResultsMessage:e("noResultsMessage"),error:e(n.LoadingArmCode)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Input,{fluid:!0,value:a.FinishedProductCode,label:e("MarineDispatchManualEntry_FinishedProduct"),disabled:!0,onChange:e=>g("FP","FinishedProductCode",e),reserveSpace:!1,error:e(n.FinishedProductCode)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Select,{fluid:!0,placeholder:"Select",value:a.QuantityUOM,label:e("LoadingDetailsEntry_QuantityUOM"),indicator:"required",options:E.quantityUOMOptions,onChange:e=>g("FP","QuantityUOM",e),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(n.QuantityUOM)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Input,{fluid:!0,value:a.TransactionID,label:e("LoadingDetailsEntry_TransactionNo"),onChange:e=>g("FP","TransactionID",e),reserveSpace:!1,error:e(n.TransactionID)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Input,{fluid:!0,value:a.Remarks,label:e("LoadingDetailsEntry_Remarks"),onChange:e=>g("FP","Remarks",e),reserveSpace:!1,error:e(n.Remarks)})})]}),(0,m.jsx)(d.Tab,{activeIndex:M,onTabChange:e=>y(e),children:C.map(((t,a)=>{let o=t.baseProductCode?e(t.productType)+"-"+t.code+"("+e("BPCode")+"-"+t.baseProductCode+")":e(t.productType)+"-"+t.code;return(0,m.jsxs)(d.Tab.Pane,{title:o,children:[(0,m.jsxs)("div",{className:"row",children:[(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Input,{fluid:!0,value:r[a].GrossQuantity,label:e("GrossQuantity"),indicator:"required",onChange:e=>g("BP","GrossQuantity",e),reserveSpace:!1,error:e(p[a].GrossQuantity)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Input,{fluid:!0,value:r[a].NetQuantity,label:e("NetQuantity"),onChange:e=>g("BP","NetQuantity",e),reserveSpace:!1,error:e(p[a].NetQuantity)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Input,{fluid:!0,value:r[a].Temperature,label:e("Temperature"),onChange:e=>g("BP","Temperature",e),reserveSpace:!1,error:e(p[a].Temperature)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Select,{fluid:!0,value:r[a].TemperatureUOM,options:E.temperatureUOMs,placeholder:"Select",label:e("MarineDispatchManualEntry_TemperatureUOM"),onChange:e=>g("BP","TemperatureUOM",e),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(p[a].TemperatureUOM)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Input,{fluid:!0,value:r[a].ProductDensity,label:e("ViewShipment_Density"),onChange:e=>g("BP","ProductDensity",e),reserveSpace:!1,error:e(p[a].ProductDensity)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Select,{fluid:!0,value:r[a].ProductDensityUOM,options:E.densityUOMS,placeholder:"Select",label:e("ViewShipment_DensityUOM"),onChange:e=>g("BP","ProductDensityUOM",e),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(p[a].ProductDensityUOM)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Select,{fluid:!0,value:r[a].MeterCode,options:u.Zj(E.meterCodes),placeholder:"Select",label:e("Meter_Code"),onChange:e=>g("BP","MeterCode",e),multiple:!1,reserveSpace:!1,search:!1,indicator:"required",noResultsMessage:e("noResultsMessage"),error:e(p[a].MeterCode)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Select,{fluid:!0,value:r[a].TankCode,options:u.Zj(E.tankCodes),placeholder:"Select",label:e("TankCode"),onChange:e=>g("BP","TankCode",e),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(p[a].TankCode)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Input,{fluid:!0,value:r[a].StartTotalizer,label:e("StartTotalizer"),onChange:e=>g("BP","StartTotalizer",e),reserveSpace:!1,error:e(p[a].StartTotalizer)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Input,{fluid:!0,value:r[a].EndTotalizer,label:e("EndTotalizer"),onChange:e=>g("BP","EndTotalizer",e),reserveSpace:!1,error:e(p[a].EndTotalizer)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Input,{fluid:!0,value:r[a].NetStartTotalizer,label:e("MarineDispatchManualEntry_NetStartTotalizer"),onChange:e=>g("BP","NetStartTotalizer",e),reserveSpace:!1,error:e(p[a].NetStartTotalizer)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Input,{fluid:!0,value:r[a].NetEndTotalizer,label:e("MarineDispatchManualEntry_NetEndTotalizer"),onChange:e=>g("BP","NetEndTotalizer",e),reserveSpace:!1,error:e(p[a].NetEndTotalizer)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Input,{fluid:!0,value:r[a].CalculatedGross,label:e("LoadingDetails_CalculatedGross"),onChange:e=>g("BP","CalculatedGross",e),reserveSpace:!1,error:e(p[a].CalculatedGross)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Input,{fluid:!0,value:r[a].CalculatedNet,label:e("LoadingDetails_CalculatedNet"),onChange:e=>g("BP","CalculatedNet",e),reserveSpace:!1,error:e(p[a].CalculatedNet)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(d.Select,{fluid:!0,value:r[a].CalculatedValueUOM,options:E.calcValueUOM,placeholder:"Select",label:e("LoadingDetails_CalculatedValueUOM"),onChange:e=>g("BP","CalculatedValueUOM",e),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(p[a].CalculatedValueUOM)})})]}),T.length>0?T.map((t=>(0,m.jsx)(s.A,{children:(0,m.jsx)(d.Accordion,{children:(0,m.jsx)(d.Accordion.Content,{className:"attributeAccordian",title:e("Attributes_Header"),children:(0,m.jsx)(c.n,{selectedAttributeList:t.attributeMetaDataList,handleCellDataEdit:b,attributeValidationErrors:P(S,t.TerminalCode)})})})}))):null]},a)}))})]})})})}var E=a(9256),g=a(53536),y=a.n(g),C=a(46100),M=a(44192),D=a(93779),T=a(40854),S=a.n(T),v=a(7523),L=a(72067),f=a(15417),A=a(80312),b=a(62900);class I extends r.Component{constructor(){var e;super(...arguments),e=this,this.state={modTruckManualEntryLoadingDetailsCommonInfo:y().cloneDeep(C.KB),modTruckManualEntryLoadingFPInfo:y().cloneDeep(C.IA),modTruckManualEntryLoadingBPInfo:[],modTruckManualEntryLoadingAdvInfo:[],quantityUOMOptions:[],densityUOMS:[],temperatureUOMs:[],calcValueUOM:[],compartmentSeqNoInVehicleList:[],Bays:[],LoadingArms:[],BCUs:[],BaysandBCUs:[],productList:[],activeIndex:0,meterCodes:[],tankCodes:[],validationErrors:u.Th(M.tr),validationErrorsForFP:u.Th(M.Nj),attributeMetaDataList:[],validationErrorsForBP:[],selectedAttributeList:[],attributeValidationErrors:[],selectedAttributeBPList:{},bpAttributeValidationErrors:{},selectedAttributeAdvList:{},advAttributeValidationErrors:{},manualEntrySaveEnable:!1,isBCUTransLoad:!1,transloadSource:"",currentCompTopUpReq:{},ManualEntryFieldDeatils:[],showAuthenticationLayout:!1,tempUnLoadingDetails:{}},this.handleReset=()=>{try{let e=y().cloneDeep(C.IA);e.StartTime=new Date,e.EndTime=new Date,e.QuantityUOM=this.props.receipt.ReceiptQuantityUOM,this.setState({modTruckManualEntryLoadingDetailsCommonInfo:y().cloneDeep(C.KB),modTruckManualEntryLoadingFPInfo:e,modTruckManualEntryLoadingBPInfo:[],modTruckManualEntryLoadingAdvInfo:[],LoadingArms:[],BCUs:[],productList:[],activeIndex:0,validationErrorsForBP:[],manualEntrySaveEnable:u.ab(this.props.userDetails.EntityResult.FunctionsList,A.i.modify,A.m0),isBCUTransLoad:!1,transloadSource:"",currentCompTopUpReq:{}})}catch(e){console.log("TruckShipmentManualEntryDetailsComposite:Error occured on handleReset",e)}},this.handleChange=function(t,a,r){try{let o=y().cloneDeep(e.state.validationErrors),s=y().cloneDeep(e.state.validationErrorsForFP),i=y().cloneDeep(e.state.validationErrorsForBP);if(t===v.yK.Common){let t=y().cloneDeep(e.state.modTruckManualEntryLoadingDetailsCommonInfo);if(t[a]=r,a===v.yK.BAY){let a=e.getBCUs(r);a.length>0&&1===a.length&&(t.BCUCode=a[0],e.GetLoadingArms(a[0]),e.getBCUDetails(a[0]))}a===v.yK.BCU&&(e.GetLoadingArms(r),e.getBCUDetails(r)),a===v.yK.CompartmentSeqNoInVehicle&&e.getFPReceipeDetails(r),void 0!==M.tr[a]&&(o[a]=u.jr(M.tr[a],r)),e.setState({modTruckManualEntryLoadingDetailsCommonInfo:t,validationErrors:o})}if(t===v.yK.FP){let t=y().cloneDeep(e.state.modTruckManualEntryLoadingFPInfo);if(t[a]=r,a===v.yK.LOADINGARM){let t=y().cloneDeep(e.state.modTruckManualEntryLoadingDetailsCommonInfo);e.GetMetersForLA(t.BCUCode,r)}void 0!==M.Nj[a]&&(s[a]=u.jr(M.Nj[a],r)),e.setState({modTruckManualEntryLoadingFPInfo:t,validationErrorsForFP:s})}if(t===v.yK.BP){let t=e.state.activeIndex,o=y().cloneDeep(e.state.modTruckManualEntryLoadingBPInfo);o[t][a]=r,void 0!==M.Ap[a]&&(i[a]=u.jr(M.Ap[a],r)),e.setState({modTruckManualEntryLoadingBPInfo:o,validationErrorsForBP:i})}}catch(o){console.log(e.props.ShipmentType+"TruckShipmentManualEntryDetailsComposite:Error occured on handleChange",o)}},this.addLoadingDetails=()=>{try{this.setState({manualEntrySaveEnable:!1});let e=y().cloneDeep(this.state.tempUnLoadingDetails);this.CreateManualEntry(e)}catch(e){console.log("Truck unLoading DetailsComposite : Error in save Receipt Unloading")}},this.handleSave=()=>{try{let e=this.fillAttributeDetails(),t=this.fillManualEntryDetails(e);if(this.validateSave()){let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,a=y().cloneDeep(t);this.setState({showAuthenticationLayout:e,tempUnLoadingDetails:a},(()=>{!1===e&&this.addLoadingDetails()}))}else this.setState({manualEntrySaveEnable:u.ab(this.props.userDetails.EntityResult.FunctionsList,A.i.modify,A.m0),showAuthenticationLayout:!1})}catch(e){console.log("MarineShipmentDetailsComposite:Error occured on handleSave",e)}},this.handleAttributeCellDataEditFP=(e,t)=>{try{e.DefaultValue=t,this.setState({attribute:e});const a=y().cloneDeep(this.state.attributeValidationErrors);a.forEach((a=>{a.TerminalCode===e.TerminalCode&&(a.attributeValidationErrors[e.Code]=u.I5(e,t))})),this.setState({attributeValidationErrors:a})}catch(a){console.log("TruckShipmentManualEntryDetailsComposite:Error occured on handleAttributeCellDataEditFP",a)}},this.validateSave=()=>{const{modTruckManualEntryLoadingDetailsCommonInfo:e,modTruckManualEntryLoadingFPInfo:t,modTruckManualEntryLoadingBPInfo:a}=this.state,r=y().cloneDeep(this.state.validationErrors),o=y().cloneDeep(this.state.validationErrorsForFP),s=y().cloneDeep(this.state.validationErrorsForBP);Object.keys(M.Nj).forEach((function(e){o[e]=u.jr(M.Nj[e],t[e])})),Object.keys(M.tr).forEach((function(t){r[t]=u.jr(M.tr[t],e[t])})),this.state.productList.map(((e,t)=>{Object.keys(M.Ap).forEach((function(e){s[t][e]=u.jr(M.Ap[e],a[t][e])}))})),t.StartTime>=t.EndTime&&(o.StartTime="MarineReceiptManualEntry_ErrorUnloadTime"),this.setState({validationErrors:r,validationErrorsForFP:o,validationErrorsForBP:s});var i=y().cloneDeep(this.state.attributeValidationErrors);y().cloneDeep(this.state.selectedAttributeList).forEach((e=>{i.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.attributeMetaDataList.forEach((e=>{t.attributeValidationErrors[e.Code]=u.I5(e,e.DefaultValue)}))}))})),this.setState({attributeValidationErrors:i});var n=Object.values(r).every((function(e){return""===e})),l=Object.values(o).every((function(e){return""===e})),d=!0;return this.state.productList.map(((e,t)=>{d=Object.values(s[t]).every((function(e){return""===e}))})),console.log("returnValueBP",d),n&&l&&d},this.handleTabChange=e=>{this.setState({activeIndex:e})},this.handleDateTextChange=(e,t,a)=>{try{var r=y().cloneDeep(this.state.validationErrors),o=y().cloneDeep(this.state.modTruckManualEntryLoadingFPInfo);r[e]=a,o[e]=t,this.setState({validationErrorsForFP:r,modTruckManualEntryLoadingFPInfo:o})}catch(a){console.log("TruckShipmentManualEntryDetailsComposite:Error occured on handleDateTextChange",a)}},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentDidMount(){try{this.setDefaultValues(),u.pJ(this.props.userDetails.EntityResult.IsArchived),this.GetUOMList(),this.GetBaysandBCUs(),this.getCompartmentSeqNo(),this.getmeterCodes(),this.getTankCodes(),this.getAttributes(),this.setState({manualEntrySaveEnable:u.ab(this.props.userDetails.EntityResult.FunctionsList,A.i.modify,A.m0)})}catch(e){console.log("Error occured on componentDidMount",e)}}setDefaultValues(){C.IA.QuantityUOM=this.props.receipt.ReceiptQuantityUOM,this.setState({modTruckManualEntryLoadingFPInfo:y().cloneDeep(C.IA),modTruckManualEntryLoadingDetailsCommonInfo:y().cloneDeep(C.KB),modTruckManualEntryLoadingAdvInfo:[],productList:[]})}formAttributesforEachTab(e){let t=e[0].TerminalCode;var a=[];return e.forEach((function(e){e.TerminalCode===t&&a.push(e)})),a}handleAttributes(){let e=y().cloneDeep(this.state.attributeMetaDataList.UNLOADINGTRANSACTIONS),t=y().cloneDeep(this.state.selectedAttributeList);if(e.length>0){t=this.formAttributesforEachTab(e),this.setState({selectedAttributeList:t}),y().cloneDeep(this.state.attributeValidationErrors).forEach((e=>{Object.keys(e.attributeValidationErrors).forEach((t=>e.attributeValidationErrors[t]=""))}))}}getAttributes(){try{S()(L.fKH,u.tW([f.wf],this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({attributeMetaDataList:y().cloneDeep(t.EntityResult),attributeValidationErrors:u.Fl(t.EntityResult.UNLOADINGTRANSACTIONS)}):console.log("Failed to get Attributes")}))}catch(e){console.log("Error while getting Attributes:",e)}}GetBaysandBCUs(){try{S()(L.aWO,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){let e=[],a=t.EntityResult;Array.isArray(Object.keys(a))&&Object.keys(a).forEach((t=>{e.push(t)})),this.setState({Bays:e,BaysandBCUs:a})}}else console.log("TruckShipmentManualEntryDetailsComposite: Error in GetBaysandBCUs:",t.ErrorList)})).catch((e=>{console.log("TruckShipmentManualEntryDetailsComposite: Error while getting GetBaysandBCUs:",e)}))}catch(e){console.log("TruckShipmentManualEntryDetailsComposite: Error in GetBaysandBCUs:",e)}}GetUOMList(){S()(L.WFM,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){let e=[],a=[],r=[],o=[];if(Array.isArray(t.EntityResult.VOLUME)&&(o=u.Zj(t.EntityResult.VOLUME),e=u.Zj(t.EntityResult.VOLUME)),Array.isArray(t.EntityResult.MASS)){u.Zj(t.EntityResult.MASS).forEach((t=>{e.push(t),o.push(t)}))}Array.isArray(t.EntityResult.DENSITY)&&(a=u.Zj(t.EntityResult.DENSITY)),Array.isArray(t.EntityResult.TEMPERATURE)&&(r=u.Zj(t.EntityResult.TEMPERATURE)),this.setState({quantityUOMOptions:e,densityUOMS:a,calcValueUOM:o,temperatureUOMs:r})}}else console.log("TruckShipmentManualEntryDetailsComposite: Error in GetUOMList:",t.ErrorList)})).catch((e=>{console.log("TruckShipmentManualEntryDetailsComposite: Error while getting GetUOMList:",e)}))}GetLoadingArms(e){let t=[];try{let a=y().cloneDeep(this.state.modTruckManualEntryLoadingFPInfo);S()(L.W$W+"?bcuCode="+e,u.Jm(this.props.tokenDetails.tokenInfo)).then((r=>{var o=r.data;!0===o.IsSuccess?null!==o.EntityResult&&(t=o.EntityResult,Array.isArray(t)&&1===t.length?(a.LoadingArmCode=t[0],this.GetMetersForLA(e,t[0])):a.LoadingArmCode="",this.setState({LoadingArms:o.EntityResult,modTruckManualEntryLoadingFPInfo:a})):console.log("TruckReceiptManualEntryDetailsComposite: Error in GetLoadingArms:",o.ErrorList)})).catch((e=>{console.log("TruckReceiptManualEntryDetailsComposite: Error while getting GetLoadingArms:",e)}))}catch(a){console.log("TruckReceiptManualEntryDetailsComposite: Error while getting GetLoadingArms:",a)}}getBCUs(e){let t=[];try{let a=y().cloneDeep(this.state.BaysandBCUs);Object.keys(a).length>0&&(t=a[e]),this.setState({BCUs:t})}catch(a){console.log("TruckShipmentManualEntryDetailsComposite: Error in getBCUs:",a)}return t}getBCUDetails(e){try{var t=[{key:D.wX,value:e}],a={ShareHolderCode:"",keyDataCode:D.wX,KeyCodes:t};S()(L.T1y,u.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;if(!0===t.IsSuccess){let e=t.EntityResult,a=y().cloneDeep(this.state.modTruckManualEntryLoadingBPInfo);a.map((t=>{t.TemperatureUOM=e.TemperatureUOM,t.ProductDensityUOM=e.DensityUOM}));let r=y().cloneDeep(this.state.modTruckManualEntryLoadingAdvInfo);r.map((t=>{t.TemperatureUOM=e.TemperatureUOM,t.ProductDensityUOM=e.DensityUOM})),this.setState({modTruckManualEntryLoadingBPInfo:a,modTruckManualEntryLoadingAdvInfo:r}),e.ReceiptSource===v.LY.RAIL?this.setState({isBCUTransLoad:!0,transloadSource:v.LY.RAIL}):e.ReceiptSource===v.LY.MARINE&&this.setState({isBCUTransLoad:!0,transloadSource:v.LY.MARINE})}}))}catch(r){console.log("TruckShipmentManualEntryDetailsComposite:Error while getting getBCUDeviceDetails")}}GetMetersForLA(e,t){try{var a=[{key:D.Dm,value:v.Dm.ROAD_BCUVIEW},{key:D.wX,value:e},{key:D.uw,value:this.props.receipt.ActualTerminalCode}],r={ShareHolderCode:"",keyDataCode:D.Dm,KeyCodes:a};S()(L._xh,u.tW(r,this.props.tokenDetails.tokenInfo)).then((e=>{var a=e.data;if(!0===a.IsSuccess&&Array.isArray(a.EntityResult)&&a.EntityResult.length>0){let e=a.EntityResult[0].AssociatedArmsList.find((e=>e.Code===t));if(null!==e){let t=[],a=[];t=e.AssociatedMeterList.find((e=>"MAINLINE"===e.MeterLineType)),a=e.AssociatedMeterList.find((e=>"ADDITIVE"===e.MeterLineType));let r="",o="";if(1===t.MeterList.length&&(r=t.MeterList[0].Code),1===a.MeterList.length&&(o=a.MeterList[0].Code),""!==r){let e=y().cloneDeep(this.state.modTruckManualEntryLoadingBPInfo);e.map((e=>{e.MeterCode=r})),this.setState({modTruckManualEntryLoadingBPInfo:e})}if(""!==o){let e=y().cloneDeep(this.state.modTruckManualEntryLoadingAdvInfo);e.map((e=>{e.MeterCode=o})),this.setState({modTruckManualEntryLoadingAdvInfo:e})}}}}))}catch(o){console.log("SiteTreeView:Error occured in GetMetersForLA",o)}}getFPReceipeDetails(e){try{let t=y().cloneDeep(this.state.modTruckManualEntryLoadingFPInfo),a=this.props.receipt.ReceiptOriginTerminalCompartmentsInfo.find((t=>t.CompartmentSeqNoInVehicle.toString()===e)).FinishedProductCode;t.FinishedProductCode=a,y().cloneDeep(this.state.validationErrorsForFP).FinishedProductCode="",this.setState({modTruckManualEntryLoadingFPInfo:t}),S()(L._dY+"?finishedProduct="+a+"&shCode="+this.props.selectedShareholder,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var a=e.data;if(!0===a.IsSuccess){if(null!==a.EntityResult){let e=[],r=[],o=[];Array.isArray(a.EntityResult.Table)&&a.EntityResult.Table.forEach((t=>{C.IA.BaseProductCode=t.code,e.push({code:t.code,productType:t.ProductTYPE}),r.push(u.Th(M.Ap)),o.push(y().cloneDeep(C.IA))})),this.setState({productList:e,validationErrorsForBP:r,modTruckManualEntryLoadingFPInfo:t,modTruckManualEntryLoadingBPInfo:o,manualEntrySaveEnable:u.ab(this.props.userDetails.EntityResult.FunctionsList,A.i.modify,A.m0)},(()=>{this.handleAttributes()}))}}else console.log("TruckShipmentManualEntryDetailsComposite: Error in getFPReceiptDetails:",a.ErrorList)})).catch((e=>{console.log("TruckShipmentManualEntryDetailsComposite: Error while getting FPReceiptDetails:",e)}))}catch(t){console.log("TruckShipmentManualEntryDetailsComposite: Error while getting getFPReceiptDetails:",t)}}fillAttributeDetails(){try{let e=y().cloneDeep(this.state.selectedAttributeList),t=y().cloneDeep(this.state.modTruckManualEntryLoadingBPInfo);return t[0].Attributes=[],e.forEach((e=>{let a={ListOfAttributeData:[]};a.TerminalCode=e.TerminalCode,e.attributeMetaDataList.forEach((e=>{a.ListOfAttributeData.push({AttributeCode:e.Code,AttributeValue:e.DefaultValue})})),t[0].Attributes.push(a)})),this.setState({modTruckManualEntryLoadingBPInfo:t}),t}catch(e){console.log("TrailerDetailsComposite:Error occured on fillAttributeDetails",e)}}CreateManualEntry(e){var t=[{key:D.ml,value:this.props.receipt.ReceiptCode}],a={messageType:"critical",message:"TruckReceipt_ManualEntryCreateStatus",messageResultDetails:[{keyFields:["MarineDispatchManualEntry_CompSeqNo"],keyValues:[this.state.modTruckManualEntryLoadingDetailsCommonInfo.CompartmentSeqNoInVehicle],isSuccess:!1,errorMessage:""}]},r={ShareHolderCode:this.props.selectedShareholder,keyDataCode:D.ml,KeyCodes:t,Entity:e};S()(L.lSn,u.tW(r,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;a.messageType=t.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.setState({saveEnabled:!0,showAuthenticationLayout:!1},(()=>{this.setDefaultValues()})):(a.message="MarineReceiptManualEntry_SaveFailure",a.messageResultDetails[0].errorMessage=t.ErrorList[0],this.setState({saveEnabled:!0,showAuthenticationLayout:!1})),(0,n.toast)((0,m.jsx)(s.A,{children:(0,m.jsx)(i.A,{notificationMessage:a})}),{autoClose:"success"===a.messageType&&1e4})})).catch((e=>{this.setState({showAuthenticationLayout:!1}),a.messageResultDetails[0].errorMessage=e,console.log("Error while handleSave:",e)}))}fillManualEntryDetails(e){let t=y().cloneDeep(this.state.modTruckManualEntryLoadingFPInfo),a=[];try{let r={CommonInfo:{},LoadingDetailFPinfo:{},ArrLoadingDetailAdditive:[],ArrLoadingDetailBP:[],TerminalCodes:[]},{modTruckManualEntryLoadingDetailsCommonInfo:o}=this.state;o.LoadingDetailsType="MANUAL",o.ReceiptCode=this.props.receipt.ReceiptCode,o.ShareHolderCode=this.props.selectedShareholder,e.forEach((e=>{e.StartTime=t.StartTime,e.EndTime=t.EndTime,e.LoadingArmCode=t.LoadingArmCode,e.QuantityUOM=t.QuantityUOM,e.TransactionID=t.TransactionID,e.FinishedProductCode=t.FinishedProductCode})),r.CommonInfo=y().cloneDeep(o),r.LoadingDetailFPinfo=y().cloneDeep(t),r.ArrLoadingDetailBP=y().cloneDeep(e),r.CommonInfo.CompartmentSeqNoInVehicle=u.bo(r.CommonInfo.CompartmentSeqNoInVehicle),r.ArrLoadingDetailBP.forEach((e=>{Object.keys(e).forEach((t=>{t.includes("UOM")||"LoadingArmCode"===t||"StartTime"===t||"EndTime"===t||"FinishedProductCode"===t||"MeterCode"===t||"TankCode"===t||"Attributes"===t||"BaseProductCode"===t||"AdditiveProductCode"===t||(e[t]=u.bo(e[t]))}))})),a.push(r)}catch(r){console.log("TruckShipmentManualEntryDetailsComposite:Error in creating request for Manual Entry",r)}return a}getCompartmentSeqNo(){let e=y().cloneDeep(this.state.compartmentSeqNoInVehicleList);this.props.receipt.ReceiptCompartmentsInfo.sort(((e,t)=>e.CompartmentSeqNoInVehicle-t.CompartmentSeqNoInVehicle)).map((t=>{e.push(t.CompartmentSeqNoInVehicle.toString()),this.setState({compartmentSeqNoInVehicleList:e})}))}getmeterCodes(){try{S()(L.ndF,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(console.log("meterCodes",t),!0===t.IsSuccess){if(null!==t.EntityResult){let e=[];e=t.EntityResult,this.setState({meterCodes:e})}}else console.log("TruckShipmentManualEntryDetailsComposite: Error in getmeterCodes:",t.ErrorList)})).catch((e=>{console.log("TruckShipmentManualEntryDetailsComposite: Error while getting getmeterCodes:",e)}))}catch(e){console.log("TruckShipmentManualEntryDetailsComposite: Error in getmeterCodes:",e)}}getTankCodes(){try{S()(L.Ibp+"?ShareholderCode="+this.props.selectedShareholder,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){let e=[];e=t.EntityResult,this.setState({tankCodes:e})}}else console.log("TruckShipmentManualEntryDetailsComposite: Error in getTankCodes:",t.ErrorList)})).catch((e=>{console.log("TruckShipmentManualEntryDetailsComposite: Error while getting getTankCodes:",e)}))}catch(e){console.log("TruckShipmentManualEntryDetailsComposite: Error in getTankCodes:",e)}}render(){const e={compartmentSeqNoInVehicleList:this.state.compartmentSeqNoInVehicleList,quantityUOMOptions:this.state.quantityUOMOptions,densityUOMS:this.state.densityUOMS,temperatureUOMs:this.state.temperatureUOMs,calcValueUOM:this.state.calcValueUOM,LoadingArms:this.state.LoadingArms,Bays:this.state.Bays,BCUs:this.state.BCUs,meterCodes:this.state.meterCodes,tankCodes:this.state.tankCodes};return(0,m.jsx)(l.TranslationConsumer,{children:t=>(0,m.jsxs)("div",{children:[(0,m.jsx)(s.A,{children:(0,m.jsx)(p,{onFieldChange:this.handleChange,onTabChange:this.handleTabChange,listOptions:e,productList:this.state.productList,modTruckManualEntryLoadingDetailsCommonInfo:this.state.modTruckManualEntryLoadingDetailsCommonInfo,modTruckManualEntryLoadingFPInfo:this.state.modTruckManualEntryLoadingFPInfo,modTruckManualEntryLoadingBPInfo:this.state.modTruckManualEntryLoadingBPInfo,modTruckManualEntryLoadingAdvInfo:this.state.modTruckManualEntryLoadingAdvInfo,validationErrors:this.state.validationErrors,validationErrorsForFP:this.state.validationErrorsForFP,validationErrorsForBP:this.state.validationErrorsForBP,selectedAttributeList:this.state.selectedAttributeList,attributeValidationErrors:this.state.attributeValidationErrors,selectedAttributeBPList:this.state.selectedAttributeBPList,bpAttributeValidationErrors:this.state.bpAttributeValidationErrors,selectedAttributeAdvList:this.state.selectedAttributeAdvList,advAttributeValidationErrors:this.state.advAttributeValidationErrors,onDateTextChange:this.handleDateTextChange,currentCompTopUpReq:this.state.currentCompTopUpReq,handleAttributeCellDataEdit:this.handleAttributeCellDataEditFP})}),(0,m.jsx)(s.A,{children:(0,m.jsx)(E.q,{handleBack:this.props.handleBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.manualEntrySaveEnable})}),this.state.showAuthenticationLayout?(0,m.jsx)(b.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:A.i.add,functionGroup:A.CW,handleOperation:this.addLoadingDetails,handleClose:this.handleAuthenticationClose}):null]})})}}const k=(0,o.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(I)}}]);
//# sourceMappingURL=7271.4b5d84a6.chunk.js.map