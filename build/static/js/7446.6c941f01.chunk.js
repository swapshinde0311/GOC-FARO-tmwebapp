"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[7446],{47446:(e,t,i)=>{i.r(t),i.d(t,{default:()=>j});var s=i(65043),a=i(69062),o=i(40854),n=i.n(o),l=i(7523),r=i(72067),c=i(72711),d=i(67907),m=i(78374),h=i(70579);function C(e){let{emailConfig:t,modEmailConfig:i,validationErrors:s,onFieldChange:a,listOptions:o,onEntityTypeChange:n,handleCellDataEdit:l,onActiveStatusChange:r}=e;const C=e=>{var t=i.Recipients.filter((t=>t.Recipient===e.rowData.Recipient));return(0,h.jsx)("div",{children:(0,h.jsx)(c.Radio,{checked:"To"===e.field?t[0].To:"CC"===e.field?t[0].CC:"BCC"===e.field?t[0].BCC:t[0].None,onChange:()=>l(e)})})};return(0,h.jsx)(d.TranslationConsumer,{children:e=>(0,h.jsxs)("div",{className:"detailsContainer",children:[(0,h.jsxs)("div",{className:"row",children:[(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(c.Input,{fluid:!0,value:i.EmailMessageCode,indicator:"required",disabled:""!==t.EmailMessageCode,onChange:e=>a("EmailMessageCode",e),label:e("EmailConfiguration_Code"),error:e(s.EmailMessageCode),reserveSpace:!1})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(c.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("EmailConfiguration_EntityType"),value:i.EmailSMSEntityType,options:o.EntityTypeOptions,onChange:e=>{n(e)},indicator:"required",error:e(s.EmailSMSEntityType),reserveSpace:!1,search:!0,noResultsMessage:e("noResultsMessage")})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(c.Input,{fluid:!0,value:i.Subject,indicator:"required",onChange:e=>a("Subject",e),label:e("EmailConfiguration_Subject"),error:e(s.Subject),reserveSpace:!1})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(c.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("EmailConfiguration_Priority"),value:i.Priority,options:o.priority,onChange:e=>{a("Priority",e)},indicator:"required",error:e(s.Priority),reserveSpace:!1,search:!0,noResultsMessage:e("noResultsMessage")})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(c.Input,{fluid:!0,value:i.MessageText,indicator:"required",onChange:e=>a("MessageText",e),label:e("EmailConfiguration_EmailMessage"),error:e(s.MessageText),reserveSpace:!1})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsxs)("div",{className:"ui single-input fluid disabled",style:{width:"30%",float:"left"},children:[(0,h.jsx)("div",{class:"ui input-label",children:(0,h.jsx)("span",{className:"input-label-message",children:e("EmailConfiguration_Attachment")})}),(0,h.jsx)("div",{className:"input-wrap",children:(0,h.jsx)(c.Checkbox,{fluid:!0,checked:i.Attachment,onChange:e=>a("Attachment",e),value:i.Attachment})})]})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(c.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("EmailConfiguration_Status"),value:i.Active,options:[{text:e("ViewShipment_Ok"),value:!0},{text:e("ViewShipmentStatus_Inactive"),value:!1}],onChange:e=>r(e),error:e(s.Active),reserveSpace:!1,search:!0,noResultsMessage:e("noResultsMessage")})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(c.Input,{fluid:!0,value:i.Remarks,onChange:e=>a("Remarks",e),label:e("EmailConfiguration_Remarks"),error:e(s.Remarks),indicator:i.Active!==t.Active?"required":"",reserveSpace:!1})})]}),(0,h.jsxs)("div",{className:""!==i.EmailSMSEntityType&&void 0!==i.EmailSMSEntityType?"row":"hidden",children:[(0,h.jsx)("div",{className:"col col-md-8 col-lg-9 col col-xl-9",children:(0,h.jsx)("h4",{children:e("EmailConfiguration_RecipientList")})}),(0,h.jsx)("div",{className:"col-12 detailsTable",children:(0,h.jsxs)(m.bQ,{data:i.Recipients,onEdit:l,children:[(0,h.jsx)(m.bQ.Column,{className:"compColHeight",field:"Recipient",header:e("EmailConfiguration_Recipient"),editFieldType:"text"},"Recipient"),(0,h.jsx)(m.bQ.Column,{className:"compColHeight",field:"To",header:e("EmailConfiguration_To"),renderer:C},"To"),(0,h.jsx)(m.bQ.Column,{className:"compColHeight",field:"CC",header:e("EmailConfiguration_CC"),renderer:C},"CC"),(0,h.jsx)(m.bQ.Column,{className:"compColHeight",field:"BCC",header:e("EmailConfiguration_BCC"),renderer:C},"BCC"),(0,h.jsx)(m.bQ.Column,{className:"compColHeight",field:"None",header:e("EmailConfiguration_None"),renderer:C},"None")]})})]})]})})}C.defaultProps={listOptions:{priority:[],EntityTypeOptions:[]}};var u=i(9256),p=i(97508),g=i(46100),E=i(44192),f=(i(38726),i(65187)),y=i(43503),v=i(93779),R=i(40252),S=i(53536),D=i.n(S),x=i(80312),T=i(62900);class L extends s.Component{constructor(){super(...arguments),this.state={emailConfig:D().cloneDeep(g.UN),modEmailConfig:{},validationErrors:a.Th(E.Di),isReadyToRender:!1,saveEnabled:!1,EmailEntityTypeRecipientOptions:{},EntityTypeOptions:[],showAuthenticationLayout:!1,tempEmailConfig:{}},this.handleChange=(e,t)=>{try{const i=D().cloneDeep(this.state.modEmailConfig);i[e]=t,this.setState({modEmailConfig:i});const s=D().cloneDeep(this.state.validationErrors);void 0!==E.Di[e]&&(s[e]=a.jr(E.Di[e],t),this.setState({validationErrors:s}))}catch(i){console.log("EmailConfigurationDetailsComposite:Error occured on handleChange",i)}},this.handleEntityTypeChange=e=>{try{const t=D().cloneDeep(this.state.modEmailConfig),i=D().cloneDeep(this.state.validationErrors);t.EmailSMSEntityType=e,i.EmailSMSEntityType="",this.setState({modEmailConfig:t,validationErrors:i},(()=>this.bindRecipientList(e)))}catch(t){console.log("EmailConfigurationDetailsComposite:Error occured on handleEntityTypeChange",t)}},this.handleCellDataEdit=e=>{try{const t=D().cloneDeep(this.state.modEmailConfig);Object.keys(t.Recipients[e.rowIndex]).forEach((function(i){"Recipient"!==i&&i!==e.field&&(t.Recipients[e.rowIndex][i]=!1)})),t.Recipients[e.rowIndex][e.field]=!0,this.setState({modEmailConfig:t})}catch(t){console.log("Error in handlecelldataedit",t)}},this.handleActiveStatusChange=e=>{try{const t=D().cloneDeep(this.state.modEmailConfig);t.Active=e,t.Active!==this.state.emailConfig.Active&&(t.Remarks="");const i=D().cloneDeep(this.state.validationErrors);t.Active===this.state.emailConfig.Active&&(null!==t.Remarks&&""!==t.Remarks||(i.Remarks="")),this.setState({modEmailConfig:t,validationErrors:i})}catch(t){console.log("EmailConfigurationDetailsComposite:Error occured on handleActiveStatusChange",t)}},this.handleReset=()=>{try{const{validationErrors:e}={...this.state},t=D().cloneDeep(this.state.emailConfig);Object.keys(e).forEach((function(t){e[t]=""})),this.setState({modEmailConfig:{...t},selectedCompRow:[],validationErrors:e},(()=>this.bindRecipientList(t.EmailSMSEntityType)))}catch(e){console.log("EmailConfigurationDetailsComposite:Error occured on handleReset",e)}},this.saveEmailConfig=()=>{try{this.setState({saveEnabled:!1});let e=D().cloneDeep(this.state.tempEmailConfig);""===this.state.emailConfig.EmailMessageCode?this.createEmailConfiguration(e):this.updateEmailConfiguration(e)}catch(e){console.log("EmailConfigDetailsComposite : Error in saveEmailConfig")}},this.handleSave=()=>{try{let e=this.fillRecipientDetails();if(this.validateSave(e)){let t=D().cloneDeep(e),i=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showAuthenticationLayout:i,tempEmailConfig:t},(()=>{!1===i&&this.saveEmailConfig()}))}else this.setState({saveEnabled:!0})}catch(e){console.log("EmailConfigurationDetailsComposite:Error occured on handleSave",e)}},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentDidMount(){try{this.GetEmailEntityTypeList(),this.getEmailConfiguration(this.props.selectedRow)}catch(e){console.log("EmailConfigurationDetailsComposite:Error occured on componentDidMount",e)}}GetEmailEntityTypeList(){try{n()(r.XXT,a.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){let e=this.state.EntityTypeOptions;e=a.Zj(Object.keys(t.EntityResult)),this.setState({EmailEntityTypeRecipientOptions:t.EntityResult,EntityTypeOptions:e})}}else console.log("Error in GetEmailEntityTypeList:",t.ErrorList)})).catch((e=>{console.log("Error while getting GetEmailEntityTypeList:",e)}))}catch(e){console.log("Error in GetEmailEntityTypeList",e)}}componentWillReceiveProps(e){try{if(""!==this.state.emailConfig.EmailMessageCode&&void 0===e.selectedRow.Common_Code&&this.props.tokenDetails.tokenInfo===e.tokenDetails.tokenInfo){this.getEmailConfiguration(e.selectedRow);let t={...this.state.validationErrors};Object.keys(t).forEach((e=>{t[e]=""})),this.setState({validationErrors:t})}}catch(t){console.log("EmailConfigurationDetailsComposite:Error occured on componentWillReceiveProps",t)}}getEmailConfiguration(e){try{if(g.UN.Priority=2,void 0===e.Common_Code)return void this.setState({emailConfig:D().cloneDeep(g.UN),modEmailConfig:D().cloneDeep(g.UN),isReadyToRender:!0,saveEnabled:a.ab(this.props.userDetails.EntityResult.FunctionsList,x.i.add,x.N1)});var t=[{key:v.Cb,value:e.Common_Code}],i={keyDataCode:v.Cb,KeyCodes:t};n()(r.$rV,a.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({isReadyToRender:!0,emailConfig:D().cloneDeep(t.EntityResult),modEmailConfig:D().cloneDeep(t.EntityResult),saveEnabled:a.ab(this.props.userDetails.EntityResult.FunctionsList,x.i.modify,x.N1)},(()=>this.bindRecipientList(t.EntityResult.EmailSMSEntityType))):(this.setState({emailConfig:D().cloneDeep(g.UN),modEmailConfig:D().cloneDeep(g.UN),isReadyToRender:!0}),console.log("Error in getEmailConfiguration:",t.ErrorList))})).catch((t=>{console.log("Error while getting EmailConfiguration:",t,e)}))}catch(s){console.log("Error in getEmailConfiguration",s)}}bindRecipientList(e){try{const t=D().cloneDeep(this.state.modEmailConfig),i=D().cloneDeep(this.state.EmailEntityTypeRecipientOptions);t.Recipients=[],i[e].Value.forEach((e=>{let i={Recipient:e,To:t.RecipientListTo.indexOf(e)>=0,CC:t.RecipientListCC.indexOf(e)>=0,BCC:t.RecipientListBCC.indexOf(e)>=0,None:!(t.RecipientListTo.indexOf(e)>=0||t.RecipientListCC.indexOf(e)>=0||t.RecipientListBCC.indexOf(e)>=0)};t.Recipients.push(i)})),this.setState({modEmailConfig:t})}catch(t){console.log("EmailConfigurationDetailsComposite:Error occured on bindRecipientList",t)}}validateSave(e){try{const t={...this.state.validationErrors};Object.keys(E.Di).forEach((function(i){void 0!==e[i]&&(t[i]=a.jr(E.Di[i],e[i]))})),e.Active!==this.state.emailConfig.Active&&(null!==e.Remarks&&""!==e.Remarks||(t.Remarks="Vehicle_RemarksRequired"));let i={messageType:"critical",message:"EmailConfiguration_AddUpdateSuccessMsg",messageResultDetails:[]};e.Recipients.filter((e=>!0===e.To)).length<=0&&i.messageResultDetails.push({keyFields:["EmailConfiguration_Code"],keyValues:[e.EmailMessageCode],isSuccess:!1,errorMessage:"EMAILMESSAGE_RECIPIENTTO_EMPTY_X"}),this.setState({validationErrors:t});let s=Object.values(t).every((function(e){return""===e}));return i.messageResultDetails.length>0?(this.props.onSaved(this.state.modEmailConfig,"update",i),!1):s}catch(t){console.log("Error is validatesave",t)}}fillRecipientDetails(){try{let e=D().cloneDeep(this.state.modEmailConfig);return e.RecipientListTo="",e.RecipientListCC="",e.RecipientListBCC="",e.Recipients.forEach((t=>{!0===t.To?e.RecipientListTo=e.RecipientListTo+t.Recipient+",":!0===t.CC?e.RecipientListCC=e.RecipientListCC+t.Recipient+",":!0===t.BCC&&(e.RecipientListBCC=e.RecipientListBCC+t.Recipient+",")})),e.RecipientListTo=e.RecipientListTo.slice(0,-1),e.RecipientListCC=e.RecipientListCC.slice(0,-1),e.RecipientListBCC=e.RecipientListBCC.slice(0,-1),e}catch(e){console.log("EmailConfigurationDetailsComposite:Error occured on fillRecipientDetails",e)}}createEmailConfiguration(e){try{let t=[{key:v.Cb,value:e.EmailMessageCode}],i={keyDataCode:v.Cb,KeyCodes:t,Entity:e},s={messageType:"critical",message:"EmailConfiguration_AddUpdateSuccessMsg",messageResultDetails:[{keyFields:["EmailConfiguration_Code"],keyValues:[e.EmailMessageCode],isSuccess:!1,errorMessage:""}]};n()(r.x5U,a.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{let i=t.data;s.messageType=i.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess?this.setState({saveEnabled:a.ab(this.props.userDetails.EntityResult.FunctionsList,x.i.modify,x.N1),showAuthenticationLayout:!1},(()=>this.getEmailConfiguration({Common_Code:e.EmailMessageCode}))):(s.messageResultDetails[0].errorMessage=i.ErrorList[0],this.setState({saveEnabled:a.ab(this.props.userDetails.EntityResult.FunctionsList,x.i.add,x.N1),showAuthenticationLayout:!1}),console.log("Error in createEmailConfiguration:",i.ErrorList)),this.props.onSaved(this.state.modEmailConfig,"add",s)})).catch((e=>{this.setState({saveEnabled:a.ab(this.props.userDetails.EntityResult.FunctionsList,x.i.add,x.N1),showAuthenticationLayout:!1}),s.messageResultDetails[0].errorMessage=e,this.props.onSaved(this.state.modEmailConfig,"add",s)}))}catch(t){console.log("Error in create emailconfiguration",t)}}updateEmailConfiguration(e){try{let t=[{key:v.Cb,value:e.EmailMessageCode}],i={keyDataCode:v.Cb,KeyCodes:t,Entity:e},s={messageType:"critical",message:"EmailConfiguration_AddUpdateSuccessMsg",messageResultDetails:[{keyFields:["EmailConfiguration_Code"],keyValues:[e.EmailMessageCode],isSuccess:!1,errorMessage:""}]};n()(r.qBu,a.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{let i=t.data;s.messageType=i.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess?this.setState({saveEnabled:a.ab(this.props.userDetails.EntityResult.FunctionsList,x.i.modify,x.N1),showAuthenticationLayout:!1},(()=>this.getEmailConfiguration({Common_Code:e.EmailMessageCode}))):(s.messageResultDetails[0].errorMessage=i.ErrorList[0],this.setState({saveEnabled:a.ab(this.props.userDetails.EntityResult.FunctionsList,x.i.modify,x.N1),showAuthenticationLayout:!1}),console.log("Error in createEmailConfiguration:",i.ErrorList)),this.props.onSaved(this.state.modEmailConfig,"update",s)})).catch((e=>{this.setState({saveEnabled:a.ab(this.props.userDetails.EntityResult.FunctionsList,x.i.modify,x.N1),showAuthenticationLayout:!1}),s.messageResultDetails[0].errorMessage=e,this.props.onSaved(this.state.modEmailConfig,"modify",s)}))}catch(t){console.log("Error in updateemailConfiguration",t)}}render(){const e={priority:l.Ff,EntityTypeOptions:this.state.EntityTypeOptions},t=[{fieldName:"EmailConfiguration_LastUpDt",fieldValue:new Date(this.state.modEmailConfig.LastUpdatedTime).toLocaleDateString()+" "+new Date(this.state.modEmailConfig.LastUpdatedTime).toLocaleTimeString()},{fieldName:"EmailConfiguration_LastActiveTime",fieldValue:void 0!==this.state.modEmailConfig.LastActiveTime&&null!==this.state.modEmailConfig.LastActiveTime?new Date(this.state.modEmailConfig.LastActiveTime).toLocaleDateString()+" "+new Date(this.state.modEmailConfig.LastActiveTime).toLocaleTimeString():""},{fieldName:"EmailConfiguration_CreateDt",fieldValue:new Date(this.state.modEmailConfig.CreatedTime).toLocaleDateString()+" "+new Date(this.state.modEmailConfig.CreatedTime).toLocaleTimeString()}];return this.state.isReadyToRender?(0,h.jsxs)("div",{children:[(0,h.jsx)(f.A,{children:(0,h.jsx)(y.A,{entityCode:this.state.emailConfig.EmailMessageCode,newEntityName:"EmailConfiguration_lHeader",popUpContents:t})}),(0,h.jsx)(f.A,{children:(0,h.jsx)(C,{emailConfig:this.state.emailConfig,modEmailConfig:this.state.modEmailConfig,listOptions:e,validationErrors:this.state.validationErrors,onFieldChange:this.handleChange,onEntityTypeChange:this.handleEntityTypeChange,handleCellDataEdit:this.handleCellDataEdit,onActiveStatusChange:this.handleActiveStatusChange})}),(0,h.jsx)(f.A,{children:(0,h.jsx)(u.q,{handleBack:this.props.onBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.saveEnabled})}),this.state.showAuthenticationLayout?(0,h.jsx)(T.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:""===this.state.emailConfig.EmailMessageCode?x.i.add:x.i.modify,functionGroup:x.N1,handleOperation:this.saveEmailConfig,handleClose:this.handleAuthenticationClose}):null]}):(0,h.jsx)(R.A,{message:"Loading"})}}const j=(0,p.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(L)},43503:(e,t,i)=>{i.d(t,{A:()=>l});i(65043);var s=i(67907),a=i(72711),o=i(70579);function n(e){let{entityCode:t,newEntityName:i,popUpContents:n}=e;return(0,o.jsx)(s.TranslationConsumer,{children:e=>(0,o.jsx)("div",{className:"headerContainer",children:(0,o.jsxs)("div",{className:"row headerSpacing",children:[(0,o.jsx)("div",{className:"col paddingHeaderItemLeft",children:(0,o.jsx)("span",{style:{margin:"auto"},className:"headerLabel",children:""===t||void 0===t?e(i):t})}),""!==t&&void 0!==t&&n.length>0?(0,o.jsx)("div",{className:"headerItemRight",children:(0,o.jsx)(a.Popup,{element:(0,o.jsxs)("div",{children:[e(n[0].fieldName)+" ",":"," "+n[0].fieldValue,(0,o.jsx)(a.Icon,{style:{marginLeft:"10px"},root:"common",name:"caret-down",size:"small"})]}),position:"bottom left",children:(0,o.jsx)(a.List,{className:"detailsHeaderPopUp",children:n.map((t=>(0,o.jsxs)(a.List.Content,{className:"detailsHeaderPopUpListPadding",children:[e(t.fieldName)+" ",":"," "+t.fieldValue]},"content.fieldName")))})})}):""]})})})}n.defaultProps={entityCode:"",newEntityName:"",popUpContents:[]};const l=n},9256:(e,t,i)=>{i.d(t,{q:()=>n});i(65043);var s=i(72711),a=i(67907),o=i(70579);function n(e){let{handleBack:t,handleSave:i,handleReset:n,saveEnabled:l}=e;return(0,o.jsx)(a.TranslationConsumer,{children:e=>(0,o.jsxs)("div",{className:"row userActionPosition",children:[(0,o.jsx)("div",{className:"col-12 col-md-3 col-lg-4",children:(0,o.jsx)(s.Button,{className:"backButton",onClick:t,content:e("Back")})}),(0,o.jsx)("div",{className:"col-12 col-md-9 col-lg-8",children:(0,o.jsxs)("div",{style:{float:"right"},children:[(0,o.jsx)(s.Button,{content:e("LookUpData_btnReset"),className:"cancelButton",onClick:n}),(0,o.jsx)(s.Button,{content:e("Save"),disabled:!l,onClick:i})]})})]})})}n.defaultProps={saveEnabled:!1}}}]);
//# sourceMappingURL=7446.6c941f01.chunk.js.map