"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[7408],{47408:(e,t,i)=>{i.r(t),i.d(t,{default:()=>x});var s=i(65043),a=i(46100),o=i(93779),n=i(72067),l=i(97508),r=i(53536),c=i.n(r),d=i(40854),S=i.n(d),h=i(69062),u=i(65187),m=i(40252),p=i(9256),g=i(43503),y=i(72711),C=i(67907),f=i(78374),v=i(70579);function E(e){let{smsConfiguration:t,modSMSConfiguration:i,validationErrors:s,listOptions:a,RecipientDetails:o,onFieldChange:n,onAddParamClick:l,handleParamField:r,onActiveStatusChange:c}=e;const d=e=>{var t=o.filter((t=>t.Recipient===e.rowData.Recipient));return(0,v.jsx)("div",{children:(0,v.jsx)(y.Radio,{checked:"To"===e.field?t[0].To:t[0].None,onChange:()=>n("To"===e.field?"To":"None",t[0].Recipient)})})};return(0,v.jsx)(C.TranslationConsumer,{children:e=>(0,v.jsxs)("div",{className:"detailsContainer",children:[(0,v.jsxs)("div",{className:"row",children:[(0,v.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,v.jsx)(y.Input,{fluid:!0,value:i.SMSMessageCode,indicator:"required",disabled:""!==t.SMSMessageCode,onChange:e=>n("SMSMessageCode",e),label:e("SMSConfiguration_Code"),error:e(s.SMSMessageCode),reserveSpace:!1})}),(0,v.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,v.jsx)(y.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("SMSConfiguration_EntityType"),value:i.EmailSMSEntityType,options:a.entityTypeOptions,onChange:e=>n("EmailSMSEntityType",e),indicator:"required",error:e(s.EmailSMSEntityType),reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),disabled:""!==t.EmailSMSEntityType&&void 0!==t.EmailSMSEntityType})}),(0,v.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,v.jsx)(y.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("SMSConfiguration_EntityParamType"),value:i.EntityParamType,options:a.entityParamTypeOptions,onChange:e=>n("EntityParamType",e),error:e(s.EntityParamType),reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage")})}),(0,v.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,v.jsxs)("div",{className:"rect-box listbox",children:[(0,v.jsx)("div",{children:e("SMSConfiguration_EntityParamField")}),(0,v.jsx)("ul",{children:void 0!==a.entityParamFieldOptions&&a.entityParamFieldOptions.length>0&&a.entityParamFieldOptions.map(((e,t)=>(0,v.jsx)("li",{className:e.value===i.SelectedParamField?"selected-list":"",onClick:()=>r(e.value),children:e.text},t)))})]})}),(0,v.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,v.jsx)(y.Button,{className:"associateParamFieldBtn",content:e("SMSConfig_AddParamField"),onClick:()=>l(),disabled:""===i.SelectedParamField||void 0===i.SelectedParamField})}),(0,v.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,v.jsx)(y.TextArea,{fluid:!0,label:e("SMSConfiguration_SMSMessage"),value:i.MessageText,onChange:e=>n("MessageText",e),error:e(s.MessageText),indicator:"required"})}),(0,v.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,v.jsx)(y.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("Cust_Status"),value:i.Active,options:[{text:e("ViewShipment_Ok"),value:!0},{text:e("ViewShipmentStatus_Inactive"),value:!1}],onChange:e=>c(e),reserveSpace:!1})}),(0,v.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,v.jsx)(y.Input,{fluid:!0,value:null===i.Remarks?"":i.Remarks,label:e("Cust_Remarks"),onChange:e=>n("Remarks",e),reserveSpace:!1,error:e(s.Remarks),indicator:i.Active!==t.Active?"required":""})})]}),(0,v.jsxs)("div",{className:""!==i.EmailSMSEntityType&&void 0!==i.EmailSMSEntityType?"row":"hidden",children:[(0,v.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,v.jsx)("label",{children:e("SMSConfiguration_RecipientList")})}),(0,v.jsx)("div",{className:"col-12 detailsTable",children:(0,v.jsxs)(f.bQ,{data:o,scrollable:!0,scrollHeight:"320px",children:[(0,v.jsx)(f.bQ.Column,{className:"compColHeight",field:"Recipient",header:e("SMSConfiguration_Recipient")},"Recipient"),(0,v.jsx)(f.bQ.Column,{className:"compColHeight",field:"To",header:e("SMSConfiguration_To"),renderer:d},"To"),(0,v.jsx)(f.bQ.Column,{className:"compColHeight",field:"None",header:e("SMSConfiguration_None"),renderer:d},"None")]})})]})]})})}E.defaultProps={listOptions:{entityTypeOptions:[],entityParamTypeOptions:[],entityParamFieldOptions:[]}};var M=i(80312),R=i(44192),D=i(62900);class T extends s.Component{constructor(){super(...arguments),this.state={smsConfiguration:{},modSMSConfiguration:{},entityDetails:{},validationErrors:h.Th(R.eN),isReadyToRender:!1,saveEnabled:!1,entityTypeOptions:[],entityParamTypeOptions:[],entityParamFieldOptions:[],RecipientDetails:[],showAuthenticationLayout:!1,tempSMSConfiguration:{}},this.handleChange=(e,t)=>{try{let i=c().cloneDeep(this.state.modSMSConfiguration);i[e]=t,"EmailSMSEntityType"===e&&(this.getEntityParameterType(t),this.getRecipientList(t)),"EntityParamType"===e&&this.getEntityParamFields(t);let s=this.state.RecipientDetails;"To"===e&&(s.forEach((e=>{e.Recipient===t&&(e.To=!0,e.None=!1)})),this.setState({RecipientDetails:s})),"None"===e&&(s.forEach((e=>{e.Recipient===t&&(e.To=!1,e.None=!0)})),this.setState({RecipientDetails:s}));const a={...this.state.validationErrors};void 0!==R.eN[e]&&(a[e]=h.jr(R.eN[e],t)),this.setState({validationErrors:a,modSMSConfiguration:i})}catch(i){console.log("SMSConfigurationDetailsComposite:Error occured on handleChange",i)}},this.handleParamField=e=>{var t=c().cloneDeep(this.state.modSMSConfiguration);t.SelectedParamField=e,this.setState({modSMSConfiguration:t})},this.handleAddParamterClick=()=>{try{var e=c().cloneDeep(this.state.modSMSConfiguration);let t=" ["+e.EntityParamType+"_"+e.SelectedParamField+"] ";e.MessageText=e.MessageText+t,this.setState({modSMSConfiguration:e})}catch(t){console.log("Error in handleAddParameterClick",t)}},this.saveSMSConfiguration=()=>{try{this.setState({saveEnabled:!1});let e=c().cloneDeep(this.state.tempSMSConfiguration);""===this.state.smsConfiguration.SMSMessageCode?this.createSMSConfiguration(e):this.updateSMSConfiguration(e)}catch(e){console.log("SMSConfigurationgDetailsComposite : Error in saveSMSConfiguration")}},this.handleSave=()=>{try{let e=c().cloneDeep(this.state.modSMSConfiguration);const t=c().cloneDeep(this.state.RecipientDetails);if(e.RecipientList=this.formRecipientList(t),this.validateSave(e)){let t=c().cloneDeep(e),i=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showAuthenticationLayout:i,tempSMSConfiguration:t},(()=>{!1===i&&this.saveSMSConfiguration()}))}else this.setState({saveEnabled:!0})}catch(e){console.log("SMSConfigurationDetailsComposite:Error occured on handleSave",e)}},this.handleActiveStatusChange=e=>{try{let t=c().cloneDeep(this.state.modSMSConfiguration);t.Active=e,t.Active!==this.state.smsConfiguration.Active&&(t.Remarks=""),this.setState({modSMSConfiguration:t})}catch(t){console.log(t)}},this.handleReset=()=>{try{const e={...this.state.validationErrors};Object.keys(e).forEach((function(t){e[t]=""}));let t=c().cloneDeep(this.state.smsConfiguration);t.EntityParamType="",this.setState({modSMSConfiguration:t,validationErrors:e,entityParamFieldOptions:[]}),this.getEntityParameterType(this.state.smsConfiguration.EmailSMSEntityType),this.getRecipientList(this.state.smsConfiguration.EmailSMSEntityType)}catch(e){console.log("SMSConfigurationDetailsComposite:Error occured on handleReset",e)}},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentWillReceiveProps(e){try{""!==this.state.smsConfiguration.SMSMessageCode&&void 0===e.selectedRow.Common_Code&&this.props.tokenDetails.tokenInfo===e.tokenDetails.tokenInfo&&this.getSMSConfiguration(e.selectedRow)}catch(t){console.log("SMSConfigurationDetailsComposite:Error occured on componentWillReceiveProps",t)}}getSMSConfiguration(e){try{if(void 0===e.Common_Code)return void this.setState({smsConfiguration:c().cloneDeep(a.fy),modSMSConfiguration:c().cloneDeep(a.fy),isReadyToRender:!0,saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,M.i.add,M.aS),entityParamTypeOptions:[],entityParamFieldOptions:[],RecipientDetails:[]});var t=[{key:o.j1,value:e.Common_Code}],i={keyDataCode:o.j1,KeyCodes:t};S()(n.g,h.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?(this.setState({isReadyToRender:!0,smsConfiguration:t.EntityResult,modSMSConfiguration:c().cloneDeep(t.EntityResult),saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,M.i.modify,M.aS)}),this.getEntityParameterType(t.EntityResult.EmailSMSEntityType),this.getRecipientList(t.EntityResult.EmailSMSEntityType)):(this.setState({smsConfiguration:c().cloneDeep(a.fy),modSMSConfiguration:c().cloneDeep(a.fy),isReadyToRender:!0,selColor:""}),console.log("Error in getSMSConfiguration:",t.ErrorList))})).catch((t=>{console.log("Error while getting SMS Configuration:",t,e)}))}catch(s){console.log("Error while getting SMS Configuration:",s)}}componentDidMount(){try{this.getEntityDetails(),this.getSMSConfiguration(this.props.selectedRow)}catch(e){console.log("SMSConfigurationDetailsComposite:Error occured on componentDidMount",e)}}getEntityDetails(){try{S()(n.zg8,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&void 0!==t.EntityResult){let e=this.state.entityTypeOptions;e=h.Zj(Object.keys(t.EntityResult)),this.setState({entityDetails:t.EntityResult,entityTypeOptions:e})}}else console.log("Error in getEntityDetails:",t.ErrorList)})).catch((e=>{console.log("Error while getting Entity Details:",e)}))}catch(e){console.log("Error while getting Entity Details:",e)}}getEntityParameterType(e){try{const t=c().cloneDeep(this.state.entityDetails);let i=this.state.entityParamTypeOptions;i=[],i=h.Zj([t[e].Key]),this.setState({entityParamTypeOptions:i})}catch(t){console.log("SMSConfigurationDetailsComposite:Error occured on getEntityParameterType",t)}}getEntityParamFields(e){try{S()(n.Uh7+e,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&void 0!==t.EntityResult){let e=this.state.entityParamFieldOptions;e=h.Zj(t.EntityResult),this.setState({entityParamFieldOptions:e})}}else console.log("Error in getEntityParamFields:",t.ErrorList)})).catch((e=>{console.log("Error while getting Entity Param Fields:",e)}))}catch(t){console.log("Error while getting Entity Param Fields:",t)}}getRecipientList(e){try{let t=c().cloneDeep(this.state.RecipientDetails);const i=c().cloneDeep(this.state.modSMSConfiguration);let s=c().cloneDeep(this.state.entityDetails);t=[],s[e].Value.forEach((e=>{let s={Recipient:e,To:i.RecipientList.indexOf(e)>=0,None:!(i.RecipientList.indexOf(e)>=0)};t.push(s)})),this.setState({RecipientDetails:t})}catch(t){console.log("SMSConfigurationDetailsComposite:Error occured on getRecipientList",t)}}formRecipientList(e){let t="";try{Array.isArray(e)&&(e.forEach((e=>{!0===e.To&&(t+=e.Recipient+",")})),""!==t&&void 0!==t&&(t=t.slice(0,-1)))}catch(i){}return t}validateSave(e){try{var t=c().cloneDeep(this.state.validationErrors);Object.keys(R.eN).forEach((function(i){t[i]=h.jr(R.eN[i],e[i])}));let i="",s={messageType:"critical",message:"SMSConfig_SavedStatus",messageResultDetails:[]};return e.Active!==this.state.smsConfiguration.Active&&(null!==e.Remarks&&""!==e.Remarks||(t.Remarks="Receipt_RemarksRequired")),""!==e.RecipientList&&null!==e.RecipientList&&void 0!==e.RecipientList||(i="SMSConfiguration_RecipientListEmptyError",""!==i&&s.messageResultDetails.push({keyFields:["SMSConfiguration_RecipientList"],keyValues:[e.RecipientList],isSuccess:!1,errorMessage:i}),""===e.SMSMessageCode||""===e.EmailSMSEntityType)?(this.setState({validationErrors:t}),Object.values(t).every((function(e){return""===e}))):(this.props.onSaved(e,"update",s),!1)}catch(i){console.log("Error in validate save",i)}}createSMSConfiguration(e){try{var t=[{key:o.j1,value:e.SMSMessageCode}],i={keyDataCode:o.j1,KeyCodes:t,Entity:e},s={messageType:"critical",message:"SMSConfig_SavedStatus",messageResultDetails:[{keyFields:["SMSConfiguration_Code"],keyValues:[e.SMSMessageCode],isSuccess:!1,errorMessage:""}]};S()(n.snV,h.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{var i=t.data;s.messageType=i.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess?this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,M.i.modify,M.aS)},(()=>this.getSMSConfiguration({Common_Code:e.SMSMessageCode}))):(s.messageResultDetails[0].errorMessage=i.ErrorList[0],this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,M.i.add,M.aS)}),console.log("Error in createSMSConfiguration:",i.ErrorList)),this.props.onSaved(e,"add",s)})).catch((t=>{this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,M.i.add,M.aS)}),s.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"add",s)}))}catch(a){console.log("Error in createSMSConfiguration",a)}}updateSMSConfiguration(e){try{let t=[{key:o.j1,value:e.SMSMessageCode}],i={keyDataCode:o.j1,KeyCodes:t,Entity:e},s={messageType:"critical",message:"SMSConfig_SavedStatus",messageResultDetails:[{keyFields:["SMSConfiguration_Code"],keyValues:[e.SMSMessageCode],isSuccess:!1,errorMessage:""}]};S()(n.F8O,h.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{var i=t.data;s.messageType=i.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess?this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,M.i.modify,M.aS)},(()=>this.getSMSConfiguration({Common_Code:e.SMSMessageCode}))):(s.messageResultDetails[0].errorMessage=i.ErrorList[0],this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,M.i.modify,M.aS)}),console.log("Error in updateSMSConfiguration:",i.ErrorList)),this.props.onSaved(e,"update",s)})).catch((t=>{s.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"modify",s),this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,M.i.modify,M.aS)})}))}catch(t){console.log("Error in updateSMSConfiguration:",t)}}render(){const e=[{fieldName:"DriverInfo_LastUpdated",fieldValue:new Date(this.state.modSMSConfiguration.LastUpdatedTime).toLocaleDateString()+" "+new Date(this.state.modSMSConfiguration.LastUpdatedTime).toLocaleTimeString()},{fieldName:"DriverInfo_LastActive",fieldValue:void 0!==this.state.modSMSConfiguration.LastActiveTime&&null!==this.state.modSMSConfiguration.LastActiveTime?new Date(this.state.modSMSConfiguration.LastActiveTime).toLocaleDateString()+" "+new Date(this.state.modSMSConfiguration.LastActiveTime).toLocaleTimeString():""},{fieldName:"DriverInfo_CreatedTime",fieldValue:new Date(this.state.modSMSConfiguration.CreatedTime).toLocaleDateString()+" "+new Date(this.state.modSMSConfiguration.CreatedTime).toLocaleTimeString()}];return this.state.isReadyToRender?(0,v.jsxs)("div",{children:[(0,v.jsx)(u.A,{children:(0,v.jsx)(g.A,{entityCode:this.state.smsConfiguration.SMSMessageCode,newEntityName:"SMSConfigurationDetails_PageTitle",popUpContents:e})}),(0,v.jsx)(u.A,{children:(0,v.jsx)(E,{smsConfiguration:this.state.smsConfiguration,modSMSConfiguration:this.state.modSMSConfiguration,validationErrors:this.state.validationErrors,listOptions:{entityTypeOptions:this.state.entityTypeOptions,entityParamTypeOptions:this.state.entityParamTypeOptions,entityParamFieldOptions:this.state.entityParamFieldOptions},RecipientDetails:this.state.RecipientDetails,onFieldChange:this.handleChange,handleParamField:this.handleParamField,onActiveStatusChange:this.handleActiveStatusChange,onAddParamClick:this.handleAddParamterClick})}),(0,v.jsx)(u.A,{children:(0,v.jsx)(p.q,{handleBack:this.props.onBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.saveEnabled})}),this.state.showAuthenticationLayout?(0,v.jsx)(D.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:""===this.state.smsConfiguration.SMSMessageCode?M.i.add:M.i.modify,functionGroup:M.aS,handleOperation:this.saveSMSConfiguration,handleClose:this.handleAuthenticationClose}):null]}):(0,v.jsx)(m.A,{message:"Loading"})}}const x=(0,l.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(T)},43503:(e,t,i)=>{i.d(t,{A:()=>l});i(65043);var s=i(67907),a=i(72711),o=i(70579);function n(e){let{entityCode:t,newEntityName:i,popUpContents:n}=e;return(0,o.jsx)(s.TranslationConsumer,{children:e=>(0,o.jsx)("div",{className:"headerContainer",children:(0,o.jsxs)("div",{className:"row headerSpacing",children:[(0,o.jsx)("div",{className:"col paddingHeaderItemLeft",children:(0,o.jsx)("span",{style:{margin:"auto"},className:"headerLabel",children:""===t||void 0===t?e(i):t})}),""!==t&&void 0!==t&&n.length>0?(0,o.jsx)("div",{className:"headerItemRight",children:(0,o.jsx)(a.Popup,{element:(0,o.jsxs)("div",{children:[e(n[0].fieldName)+" ",":"," "+n[0].fieldValue,(0,o.jsx)(a.Icon,{style:{marginLeft:"10px"},root:"common",name:"caret-down",size:"small"})]}),position:"bottom left",children:(0,o.jsx)(a.List,{className:"detailsHeaderPopUp",children:n.map((t=>(0,o.jsxs)(a.List.Content,{className:"detailsHeaderPopUpListPadding",children:[e(t.fieldName)+" ",":"," "+t.fieldValue]},"content.fieldName")))})})}):""]})})})}n.defaultProps={entityCode:"",newEntityName:"",popUpContents:[]};const l=n},9256:(e,t,i)=>{i.d(t,{q:()=>n});i(65043);var s=i(72711),a=i(67907),o=i(70579);function n(e){let{handleBack:t,handleSave:i,handleReset:n,saveEnabled:l}=e;return(0,o.jsx)(a.TranslationConsumer,{children:e=>(0,o.jsxs)("div",{className:"row userActionPosition",children:[(0,o.jsx)("div",{className:"col-12 col-md-3 col-lg-4",children:(0,o.jsx)(s.Button,{className:"backButton",onClick:t,content:e("Back")})}),(0,o.jsx)("div",{className:"col-12 col-md-9 col-lg-8",children:(0,o.jsxs)("div",{style:{float:"right"},children:[(0,o.jsx)(s.Button,{content:e("LookUpData_btnReset"),className:"cancelButton",onClick:n}),(0,o.jsx)(s.Button,{content:e("Save"),disabled:!l,onClick:i})]})})]})})}n.defaultProps={saveEnabled:!1}}}]);
//# sourceMappingURL=7408.040ef61a.chunk.js.map