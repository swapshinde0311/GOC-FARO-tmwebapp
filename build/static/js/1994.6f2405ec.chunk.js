"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[1994],{51994:(e,t,i)=>{i.r(t),i.d(t,{default:()=>O});var r=i(65043),a=i(69062),s=i(93779),o=i(72067),l=i(7523),n=i(97508),d=i(40854),c=i.n(d),h=i(65187),m=i(43503),u=i(9256),p=i(80312),v=i(46100),g=i(24904),C=i(67907),D=i(72711),M=i(85800),E=i(35861),y=i(70579);function R(e){let{primeMover:t,modPrimeMover:i,attributeValidationErrors:r,onFieldChange:a,validationErrors:s,onDateTextChange:o,onAllTerminalsChange:l,listOptions:n,isEnterpriseNode:d,modAttributeMetaDataList:c,onAttributeDataChange:m}=e;const u=(e,t)=>{let i=[];return i=e.find((e=>e.TerminalCode===t)),i.attributeValidationErrors},[p]=(0,C.useTranslation)();return(0,y.jsx)("div",{className:"detailsContainer",children:(0,y.jsxs)("div",{className:"row",children:[(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(D.Input,{fluid:!0,value:i.Code,label:p("PrimeMover_Code"),indicator:"required",disabled:""!==t.Code,onChange:e=>a("Code",e),error:p(s.Code),reserveSpace:!1})}),(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(D.Input,{fluid:!0,value:i.Name,label:p("PrimeMoverList_Name"),indicator:"required",onChange:e=>a("Name",e),error:p(s.Name),reserveSpace:!1})}),(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(D.Input,{fluid:!0,value:null===i.Description?"":i.Description,label:p("PrimeMover_Desc"),onChange:e=>a("Description",e),error:p(s.Description),reserveSpace:!1})}),(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(D.Select,{fluid:!0,placeholder:p("Common_Select"),label:p("PrimeMoverList_Carrier"),value:i.CarrierCompanyCode,options:n.carriers,onChange:e=>{a("CarrierCompanyCode",e)},indicator:"required",error:p(s.CarrierCompanyCode),reserveSpace:!1,disabled:""!==t.Code,search:!0,noResultsMessage:p("noResultsMessage")})}),(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(D.Input,{fluid:!0,value:null===i.LicensceNo?"":i.LicensceNo,label:p("PrimeMover_LicenseNo"),onChange:e=>a("LicensceNo",e),error:p(s.LicensceNo),reserveSpace:!1})}),(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(D.DatePicker,{fluid:!0,value:null===i.licenseExpiryDate?"":new Date(i.licenseExpiryDate),displayFormat:(0,E.F1)(),label:p("PrimeMover_LicenseExpiry"),showYearSelector:"true",disablePast:!0,onChange:e=>a("licenseExpiryDate",e),onTextChange:(e,t)=>{o("licenseExpiryDate",e,t)},error:p(s.licenseExpiryDate),reserveSpace:!1})}),(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(D.Input,{fluid:!0,value:null===i.RoadTaxNo?"":i.RoadTaxNo,label:p("PrimeMover_RoadTaxNo"),onChange:e=>a("RoadTaxNo",e),error:p(s.RoadTaxNo),reserveSpace:!1})}),(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(D.DatePicker,{fluid:!0,value:null===i.RoadTaxNoIssueDate?"":new Date(i.RoadTaxNoIssueDate),displayFormat:(0,E.F1)(),label:p("PrimeMover_RoadTaxIssue"),showYearSelector:"true",onChange:e=>a("RoadTaxNoIssueDate",e),onTextChange:(e,t)=>{o("RoadTaxNoIssueDate",e,t)},error:p(s.RoadTaxNoIssueDate),reserveSpace:!1})}),(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(D.DatePicker,{fluid:!0,value:null===i.RoadTaxNoExpiryDate?"":new Date(i.RoadTaxNoExpiryDate),displayFormat:(0,E.F1)(),label:p("PrimeMover_RoadTaxExpiry"),disablePast:!0,showYearSelector:"true",onChange:e=>a("RoadTaxNoExpiryDate",e),onTextChange:(e,t)=>{o("RoadTaxNoExpiryDate",e,t)},error:p(s.RoadTaxNoExpiryDate),reserveSpace:!1})}),(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(D.Input,{fluid:!0,value:null===i.TareWeight?"":i.TareWeight.toLocaleString(),label:p("PrimeMover_Tareweight"),indicator:"required",onChange:e=>a("TareWeight",e),error:p(s.TareWeight),reserveSpace:!1})}),(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(D.Select,{fluid:!0,placeholder:p("Common_Select"),label:p("PrimeMover_UOMWeight"),value:i.TareWeightUOM,options:n.unitOfWeight,onChange:e=>{a("TareWeightUOM",e)},indicator:"required",error:p(s.TareWeightUOM),reserveSpace:!1,search:!0,noResultsMessage:p("noResultsMessage")})}),(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(D.Input,{fluid:!0,value:null===i.Height?"":i.Height.toLocaleString(),label:p("PrimeMover_Height"),onChange:e=>a("Height",e),error:p(s.Height),reserveSpace:!1})}),(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(D.Input,{fluid:!0,value:null===i.Width?"":i.Width.toLocaleString(),label:p("PrimeMover_Width"),onChange:e=>a("Width",e),error:p(s.Width),reserveSpace:!1})}),(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(D.Input,{fluid:!0,value:null===i.Length?"":i.Length.toLocaleString(),label:p("PrimeMover_Length"),onChange:e=>a("Length",e),error:p(s.Length),reserveSpace:!1})}),(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(D.Select,{fluid:!0,placeholder:p("Common_Select"),label:p("PrimeMover_UOMDimemsion"),value:i.LWHUOM,options:(0,E.r4)(n.unitOfDimension,p("Common_Select")),onChange:e=>{a("LWHUOM",e)},error:p(s.LWHUOM),reserveSpace:!1,search:!0,noResultsMessage:p("noResultsMessage")})}),d?(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(g.y,{terminalList:n.terminalCodes,selectedTerminal:i.TerminalCodes,error:p(s.TerminalCodes),onFieldChange:a,onCheckChange:l})}):"",(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(D.Select,{fluid:!0,placeholder:p("Common_Select"),label:p("PrimeMover_Status"),value:i.Active,options:[{text:p("ViewShipment_Ok"),value:!0},{text:p("ViewShipmentStatus_Inactive"),value:!1}],onChange:e=>a("Active",e)})}),(0,y.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,y.jsx)(D.Input,{fluid:!0,value:null===i.Remarks?"":i.Remarks,label:p("Trailer_Remarks"),indicator:i.Active!==t.Active?"required":"",onChange:e=>a("Remarks",e),error:p(s.Remarks)})}),c.length>0?c.map((e=>(0,y.jsx)(h.A,{children:(0,y.jsx)(D.Accordion,{children:(0,y.jsx)(D.Accordion.Content,{className:"attributeAccordian",title:d?e.TerminalCode+" - "+p("Attributes_Header"):p("Attributes_Header"),children:(0,y.jsx)(M.n,{selectedAttributeList:e.attributeMetaDataList,handleCellDataEdit:m,attributeValidationErrors:u(r,e.TerminalCode)})})})}))):null]})})}R.defaultProps={listOptions:{carriers:[],unitOfWeight:[],unitOfDimension:[],terminalCodes:[]},isEnterpriseNode:!1};var L=i(44192),S=i(53536),T=i.n(S),x=i(40252),b=i(15417),P=i(97105),N=i(40510),f=i(39424),A=i(62900);class I extends r.Component{constructor(){super(...arguments),this.state={primeMover:{},modPrimeMover:{},validationErrors:a.Th(L.RG),isReadyToRender:!1,carrierOptions:[],terminalOptions:[],weightUOMOptions:[],lengthUOMOptions:[],saveEnabled:!1,attributeMetaDataList:[],modAttributeMetaDataList:[],attributeValidationErrors:[],primeMoverKPIList:[],showAuthenticationLayout:!1,tempPrimeMover:{}},this.handleChange=(e,t)=>{let i=T().cloneDeep(this.state.modPrimeMover);try{"CarrierCompanyCode"===e?this.handleCarrierChange(t):i[e]=t;const r={...this.state.validationErrors};i.Active===this.state.primeMover.Active&&(this.state.primeMover.Remarks!==i.Remarks&&""!==i.Remarks||(r.Remarks=""),""===i.Remarks&&(i.Remarks=this.state.primeMover.Remarks)),"Active"===e&&i.Active!==this.state.primeMover.Active&&(i.Remarks=""),"RoadTaxNo"!==e&&"RoadTaxNoIssueDate"!==e&&"RoadTaxNoExpiryDate"!==e||(r.RoadTaxNo="",r.RoadTaxNoExpiryDate="",r.RoadTaxNoIssueDate=""),"LicensceNo"!==e&&"licenseExpiryDate"!==e||(r.licenseExpiryDate="",r.LicensceNo=""),"Height"!==e&&"Length"!==e&&"Width"!==e&&"LWHUOM"!==e||(r.LWHUOM=""),void 0!==L.RG[e]&&(r[e]=a.jr(L.RG[e],t)),this.setState({validationErrors:r,modPrimeMover:i}),"TerminalCodes"===e&&this.terminalSelectionChange(t)}catch(r){console.log("PrimeMoverDetailsComposite:Error occured on handleChange",r)}},this.handleDateTextChange=(e,t,i)=>{try{let r={...this.state.validationErrors},a={...this.state.modPrimeMover};r[e]=i,a[e]=t,this.setState({validationErrors:r,modPrimeMover:a})}catch(i){console.log("PrimeMoverDetailsComposite:Error occured on handleDateTextChange",i)}},this.handleAllTerminalsChange=e=>{try{const t=T().cloneDeep(this.state.modPrimeMover);let i=[...this.state.terminalOptions];t.TerminalCodes=e?i:[],this.setState({modPrimeMover:t}),this.terminalSelectionChange(t.TerminalCodes)}catch(t){console.log("CarrierDetailsComposite:Error occured on handleAllTerminasChange",t)}},this.handleCarrierChange=e=>{this.getTerminalsForCarrier(e)},this.savePrimeMover=()=>{try{this.setState({saveEnabled:!1});let e=T().cloneDeep(this.state.tempPrimeMover);""===this.state.primeMover.Code?this.createPrimeMover(e):this.updatePrimeMover(e)}catch(e){console.log("PrimeMoversComposite : Error in savePrimeMover")}},this.handleSave=()=>{try{if(Object.values(this.state.validationErrors).every((function(e){return""===e}))){let e=this.fillDetails(),t=a.pI(this.state.modAttributeMetaDataList);if(this.validateSave(e,t)){e=this.convertStringtoDecimal(e,t),e=a.pC(P.S.PrimeMover,e);let i=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,r=T().cloneDeep(e);this.setState({showAuthenticationLayout:i,tempPrimeMover:r},(()=>{!1===i&&this.savePrimeMover()}))}else this.setState({saveEnabled:!0})}}catch(e){console.log("PrimeMoverDetailsComposite:Error occured on handleSave",e)}},this.handleAttributeDataChange=(e,t)=>{try{let i=[],r=T().cloneDeep(this.state.modAttributeMetaDataList),s=r.filter((t=>t.TerminalCode===e.TerminalCode));s.length>0&&Array.isArray(s[0].attributeMetaDataList)&&(i=s[0].attributeMetaDataList.filter((t=>t.Code===e.Code))),i.length>0&&(i[0].DefaultValue=t);const o=T().cloneDeep(this.state.attributeValidationErrors);o.forEach((i=>{i.TerminalCode===e.TerminalCode&&(i.attributeValidationErrors[e.Code]=a.I5(e,t))})),this.setState({attributeValidationErrors:o,modAttributeMetaDataList:r})}catch(i){console.log("DriverDetailsComposite:Error occured on handleAttributeDataChange",i)}},this.handleReset=()=>{try{let e=T().cloneDeep(this.state.primeMover);if(this.setState({modPrimeMover:e}),""===this.state.primeMover.Code){let e=[];this.setState({terminalOptions:e})}let t={...this.state.validationErrors};Object.keys(t).forEach((e=>{t[e]=""})),this.setState({validationErrors:t,modAttributeMetaDataList:[]},(()=>{this.props.userDetails.EntityResult.IsEnterpriseNode?(this.terminalSelectionChange(e.TerminalCodes),this.handleResetAttributeValidationError()):(this.localNodeAttribute(),this.handleResetAttributeValidationError())}))}catch(e){console.log("PrimeMoverDetailsComposite:Error occured on handleReset",e)}},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentDidMount(){try{a.pJ(this.props.userDetails.EntityResult.IsArchived);let e=!1;void 0===this.props.selectedRow.Common_Code&&(e=!0),this.getAttributes(e),this.getCarrierList(this.props.selectedShareholder),this.getUOMList()}catch(e){console.log("PrimeMoverDetailsComposite:Error occured on componentDidMount",e)}}componentWillReceiveProps(e){try{if(""!==this.state.primeMover.Code&&void 0===e.selectedRow.Common_Code&&this.props.tokenDetails.tokenInfo===e.tokenDetails.tokenInfo){this.getAttributes(!0);let e={...this.state.validationErrors};Object.keys(e).forEach((t=>{e[t]=""})),this.setState({validationErrors:e})}}catch(t){console.log("PrimeMoverDetailsComposite:Error occured on componentWillReceiveProps",t)}}getAttributes(e){try{c()(o.fKH,a.tW([b.Cw],this.props.tokenDetails.tokenInfo)).then((t=>{var i=t.data;!0===i.IsSuccess?this.setState({attributeMetaDataList:T().cloneDeep(i.EntityResult),attributeValidationErrors:a.Fl(i.EntityResult.primemover)},(()=>this.getPrimeMover(e))):console.log("Error in getAttributes:")}))}catch(t){console.log("Error while getAttributes:",t)}}getUOMList(){c()(o.WFM,a.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){let e=t.EntityResult.MASS,i=[];e.forEach((e=>{i.push({text:e,value:e})}));let r=t.EntityResult.LENGTH,a=[];r.forEach((e=>{a.push({text:e,value:e})})),this.setState({weightUOMOptions:i,lengthUOMOptions:a})}}else console.log("Error in getUOM:",t.ErrorList)})).catch((e=>{console.log("Error while getting getUOM:",e)}))}getCarrierList(e){c()(o.Xj6+"?ShareholderCode="+e+"&Transportationtype="+l.LY.ROAD,a.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){let e=a.Zj(t.EntityResult);this.setState({carrierOptions:e})}}else console.log("Error in GetCarrierList:",t.ErrorList)})).catch((e=>{console.log("Error while getting Carrier List:",e)}))}getPrimeMover(e){if(e){let e=[];return v.Mu.TareWeightUOM=this.props.userDetails.EntityResult.PageAttibutes.DefaultUOMS.MassUOM,void this.setState({primeMover:T().cloneDeep(v.Mu),modPrimeMover:T().cloneDeep(v.Mu),isReadyToRender:!0,terminalOptions:e,primeMoverKPIList:[],saveEnabled:a.ab(this.props.userDetails.EntityResult.FunctionsList,p.i.add,p.LR)},(()=>{!1===this.props.userDetails.EntityResult.IsEnterpriseNode&&this.localNodeAttribute()}))}let t=[{key:s.xy,value:void 0===this.props.selectedRow.Common_Code?this.state.modPrimeMover.Code:this.props.selectedRow.Common_Code}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:s.xy,KeyCodes:t};c()(o.v8p,a.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;!0===t.IsSuccess?this.setState({isReadyToRender:!0,primeMover:T().cloneDeep(t.EntityResult),modPrimeMover:T().cloneDeep(t.EntityResult),saveEnabled:a.ab(this.props.userDetails.EntityResult.FunctionsList,p.i.modify,p.LR)},(()=>{this.getTerminalsForCarrier(t.EntityResult.CarrierCompanyCode),this.getKPIList(this.props.selectedShareholder,t.EntityResult.PrimeMoverCode),this.props.userDetails.EntityResult.IsEnterpriseNode?this.terminalSelectionChange(t.EntityResult.TerminalCodes):this.localNodeAttribute()})):(this.setState({modPrimeMover:T().cloneDeep(v.Mu),primeMover:T().cloneDeep(v.Mu),isReadyToRender:!0}),console.log("Error in GetPrimeMover:",t.ErrorList))})).catch((e=>{console.log("Error while getting PrimeMover:",e)}))}terminalSelectionChange(e){try{let s=[];var t=[],i=[];t=T().cloneDeep(this.state.attributeMetaDataList),i=T().cloneDeep(this.state.modAttributeMetaDataList);const o=T().cloneDeep(this.state.attributeValidationErrors);var r=T().cloneDeep(this.state.modPrimeMover);e.forEach((e=>{var a=i.find((t=>t.TerminalCode===e));void 0===a?t.primemover.forEach((function(t){if(t.TerminalCode===e){var i=r.Attributes.find((t=>t.TerminalCode===e));void 0!==i&&t.attributeMetaDataList.forEach((function(e){var t=i.ListOfAttributeData.find((t=>t.AttributeCode===e.Code));void 0!==t&&(e.DefaultValue=t.AttributeValue)})),s.push(t)}})):s.push(a)})),i=[],i=s,i=a.nQ(i),o.forEach((t=>{void 0===e.find((e=>t.TerminalCode===e))&&Object.keys(t.attributeValidationErrors).forEach((e=>t.attributeValidationErrors[e]=""))})),this.setState({modAttributeMetaDataList:i,attributeValidationErrors:o})}catch(s){console.log("CustomerDetailsComposite:Error occured on terminalSelectionChange",s)}}localNodeAttribute(){try{var e=T().cloneDeep(this.state.attributeMetaDataList);Array.isArray(e.primemover)&&e.primemover.length>0&&this.terminalSelectionChange([e.primemover[0].TerminalCode])}catch(t){console.log("CustomerDetailsComposite:Error occured on localNodeAttribute",t)}}getTerminalsForCarrier(e){const t=T().cloneDeep(this.state.modPrimeMover);let i=[...this.state.terminalOptions];t.CarrierCompanyCode=e;try{if(void 0===e)return i=[],t.TerminalCodes=[],void this.setState({terminalOptions:i,modPrimeMover:t});let r=[{key:s._n,value:e},{key:s.v6,value:l.LY.ROAD}],n={ShareHolderCode:this.props.selectedShareholder,keyDataCode:s._n,KeyCodes:r};c()(o.pm$,a.tW(n,this.props.tokenDetails.tokenInfo)).then((e=>{let r=e.data;!0===r.IsSuccess&&null!==r.EntityResult&&null!==r.EntityResult.TerminalCodes?(i=[...r.EntityResult.TerminalCodes],this.setState({terminalOptions:i})):(i=[],this.setState({terminalOptions:i}),console.log("Error in GetCarrier:",r.ErrorList));let a={...this.state.primeMover};void 0!==a.Code&&""!==a.Code&&null!==a.Code||(1===i.length?(t.TerminalCodes=[...i],this.terminalSelectionChange(t.TerminalCodes)):(t.TerminalCodes=[],this.localNodeAttribute())),Array.isArray(t.TerminalCodes)&&(t.TerminalCodes=i.filter((e=>t.TerminalCodes.includes(e)))),this.setState({modPrimeMover:t})})).catch((r=>{i=[],t.TerminalCodes=[],this.setState({terminalOptions:i,modPrimeMover:t}),console.log("Error while getting Carrier:",r,e)}))}catch(r){i=[],t.TerminalCodes=[],this.setState({terminalOptions:i,modPrimeMover:t}),console.log("PrimeMoverDetailsComposite:Error occured on handleCarrierChange",r)}}fillDetails(){try{const e={...this.state.modPrimeMover};return e.ShareholderCode=this.props.selectedShareholder,""===e.Height&&(e.Height=null),""===e.Length&&(e.Length=null),""===e.Width&&(e.Width=null),null!==e.TareWeight&&""!==e.TareWeight&&(e.TareWeight=e.TareWeight.toLocaleString()),null!==e.Height&&""!==e.Height&&(e.Height=e.Height.toLocaleString()),null!==e.Length&&""!==e.Length&&(e.Length=e.Length.toLocaleString()),null!==e.Width&&""!==e.Width&&(e.Width=e.Width.toLocaleString()),e.PrimeMoverType=l.zr.NON_RIGID_PRIMEMOVER,e}catch(e){console.log("PrimeMoverDetails error on fill details",e)}}convertStringtoDecimal(e,t){try{return null!==e.Height&&""!==e.Height&&(e.Height=a.bo(e.Height)),null!==e.Length&&""!==e.Length&&(e.Length=a.bo(e.Length)),null!==e.Width&&""!==e.Width&&(e.Width=a.bo(e.Width)),null!==e.TareWeight&&""!==e.TareWeight&&(e.TareWeight=a.bo(e.TareWeight)),t=a.SC(t),e.Attributes=a.Gh(t),e}catch(i){console.log("convertStringtoDecimal error primemover details",i)}}validateSave(e,t){let i={...this.state.validationErrors};Object.keys(L.RG).forEach((function(t){i[t]=a.jr(L.RG[t],e[t])})),e.Active!==this.state.primeMover.Active&&""===e.Remarks&&(i.Remarks="PrimeMover_RemarksRequired"),(null!==e.LicensceNo&&""!==e.LicensceNo||!isNaN(Date.parse(e.licenseExpiryDate)))&&(isNaN(Date.parse(e.licenseExpiryDate))&&(i.licenseExpiryDate="LICENSEEXPIRYDATE_REQUIRED"),null!==e.LicensceNo&&""!==e.LicensceNo||(i.LicensceNo="Vessel_LicNoRequired")),(null===e.RoadTaxNo||""===e.RoadTaxNo)&&isNaN(Date.parse(e.RoadTaxNoIssueDate))&&isNaN(Date.parse(e.RoadTaxNoExpiryDate))||(null!==e.RoadTaxNo&&""!==e.RoadTaxNo||(i.RoadTaxNo="Vehicle_RoadTaxNoRequired"),isNaN(Date.parse(e.RoadTaxNoIssueDate))&&(i.RoadTaxNoIssueDate="Vehicle_RoadTaxIssRequired"),isNaN(Date.parse(e.RoadTaxNoExpiryDate))&&(i.RoadTaxNoExpiryDate="Vehicle_RoadTaxExpRequired")),null===e.Height&&null==e.Width&&null===e.Length||null!==e.LWHUOM||(i.LWHUOM="PrimeMover_UOMRequired");var r=T().cloneDeep(this.state.attributeValidationErrors);t.forEach((e=>{r.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.attributeMetaDataList.forEach((e=>{t.attributeValidationErrors[e.Code]=a.I5(e,e.DefaultValue)}))}))})),this.setState({validationErrors:i,attributeValidationErrors:r});var s=!0;return r.forEach((e=>{if(!s)return s;s=Object.values(e.attributeValidationErrors).every((function(e){return""===e}))})),s&&(s=Object.values(i).every((function(e){return""===e}))),s}handleResetAttributeValidationError(){try{var e=T().cloneDeep(this.state.attributeMetaDataList);this.setState({attributeValidationErrors:a.Fl(e.driver)})}catch(t){console.log("handleAttributeValidationError:Error occured on handleReset",t)}}createPrimeMover(e){let t=[{key:s.xy,value:e.Code}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:s.xy,KeyCodes:t,Entity:e},r={messageType:"critical",message:"PrimeMoverDetails_SavedStatus",messageResultDetails:[{keyFields:["PrimeMover_Code"],keyValues:[e.Code],isSuccess:!1,errorMessage:""}]};c()(o.FyF,a.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{let i=t.data;r.messageType=i.IsSuccess?"success":"critical",r.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess?(this.setState({saveEnabled:a.ab(this.props.userDetails.EntityResult.FunctionsList,p.i.modify,p.LR),showAuthenticationLayout:!1}),this.getPrimeMover(!1)):(r.messageResultDetails[0].errorMessage=i.ErrorList[0],this.setState({saveEnabled:a.ab(this.props.userDetails.EntityResult.FunctionsList,p.i.add,p.LR),showAuthenticationLayout:!1}),console.log("Error in CreatePrimeMover:",i.ErrorList)),this.props.onSaved(e,"add",r)})).catch((t=>{this.setState({saveEnabled:a.ab(this.props.userDetails.EntityResult.FunctionsList,p.i.add,p.LR),showAuthenticationLayout:!1}),r.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"add",r)}))}updatePrimeMover(e){let t=[{key:s.xy,value:e.Code}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:s.xy,KeyCodes:t,Entity:e},r={messageType:"critical",message:"PrimeMoverDetails_SavedStatus",messageResultDetails:[{keyFields:["PrimeMover_Code"],keyValues:[e.Code],isSuccess:!1,errorMessage:""}]};c()(o.imr,a.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{let i=t.data;r.messageType=i.IsSuccess?"success":"critical",r.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess?(this.setState({saveEnabled:a.ab(this.props.userDetails.EntityResult.FunctionsList,p.i.modify,p.LR),showAuthenticationLayout:!1}),this.getPrimeMover(!1)):(this.setState({saveEnabled:a.ab(this.props.userDetails.EntityResult.FunctionsList,p.i.modify,p.LR),showAuthenticationLayout:!1}),r.messageResultDetails[0].errorMessage=i.ErrorList[0],console.log("Error in UpdatePrimeMover:",i.ErrorList)),this.props.onSaved(e,"update",r)})).catch((t=>{r.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"modify",r),this.setState({saveEnabled:a.ab(this.props.userDetails.EntityResult.FunctionsList,p.i.modify,p.LR),showAuthenticationLayout:!1})}))}getKPIList(e,t){if(!0===a.ab(this.props.userDetails.EntityResult.FunctionsList,p.i.view,p.bL)){let i={PageName:f.mK,InputParameters:[{key:"ShareholderCode",value:e},{key:"PrimemoverCode",value:t}]};c()(o.dxq,a.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({primeMoverKPIList:t.EntityResult.ListKPIDetails}):(this.setState({primeMoverKPIList:[]}),console.log("Error in Prime Mover KPIList:",t.ErrorList))})).catch((e=>{console.log("Error while getting Prime Mover KPIList:",e)}))}}render(){const e={carriers:this.state.carrierOptions,unitOfWeight:this.state.weightUOMOptions,unitOfDimension:this.state.lengthUOMOptions,terminalCodes:this.state.terminalOptions},t=[{fieldName:"PrimeMover_LastUpdated",fieldValue:new Date(this.state.modPrimeMover.LastUpdatedTime).toLocaleDateString()+" "+new Date(this.state.modPrimeMover.LastUpdatedTime).toLocaleTimeString()},{fieldName:"PrimeMover_LastActiveTime",fieldValue:void 0!==this.state.modPrimeMover.LastActiveTime&&null!==this.state.modPrimeMover.LastActiveTime?new Date(this.state.modPrimeMover.LastActiveTime).toLocaleDateString()+" "+new Date(this.state.modPrimeMover.LastActiveTime).toLocaleTimeString():""},{fieldName:"PrimeMover_CreatedTime",fieldValue:new Date(this.state.modPrimeMover.CreatedTime).toLocaleDateString()+" "+new Date(this.state.modPrimeMover.CreatedTime).toLocaleTimeString()}];return this.state.isReadyToRender?(0,y.jsxs)("div",{children:[(0,y.jsx)(h.A,{children:(0,y.jsx)(m.A,{entityCode:this.state.primeMover.Code,newEntityName:"PrimeMover_NewPrimeMover",popUpContents:t})}),(0,y.jsx)(N.A,{KPIList:this.state.primeMoverKPIList,children:" "}),(0,y.jsx)(h.A,{children:(0,y.jsx)(R,{primeMover:this.state.primeMover,modPrimeMover:this.state.modPrimeMover,validationErrors:this.state.validationErrors,modAttributeMetaDataList:this.state.modAttributeMetaDataList,attributeMetaDataList:this.state.attributeMetaDataList,attributeValidationErrors:this.state.attributeValidationErrors,listOptions:e,onFieldChange:this.handleChange,onDateTextChange:this.handleDateTextChange,onAllTerminalsChange:this.handleAllTerminalsChange,onAttributeDataChange:this.handleAttributeDataChange,isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode})}),(0,y.jsx)(h.A,{children:(0,y.jsx)(u.q,{handleBack:this.props.onBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.saveEnabled})}),this.state.showAuthenticationLayout?(0,y.jsx)(A.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:""===this.state.primeMover.Code?p.i.add:p.i.modify,functionGroup:p.LR,handleOperation:this.savePrimeMover,handleClose:this.handleAuthenticationClose}):null]}):(0,y.jsx)(x.A,{message:"Loading"})}}const O=(0,n.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(I)}}]);
//# sourceMappingURL=1994.6f2405ec.chunk.js.map