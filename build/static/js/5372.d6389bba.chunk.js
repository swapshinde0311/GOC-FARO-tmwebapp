"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[5372],{45372:(e,t,a)=>{a.r(t),a.d(t,{default:()=>V});var i=a(65043),s=a(78374),o=a(72711),n=a(67907),r=a(35861),l=a(7523),d=a(85800),c=a(65187),h=a(69062),m=a(70579);function p(e){let{allocationDetails:t,marineDispatch:a,modMarineDispatch:p,modAssociations:u,modTankAssociations:C,validationErrors:D,listOptions:S,selectedAssociations:y,selectedTankAssociations:g,onFieldChange:A,onDateTextChange:E,handleAssociationSelectionChange:v,handleTankAssociationSelectionChange:b,handleCellDataEdit:f,handleTankCellDataEdit:T,handleAddAssociation:I,handleAddTankAssociation:M,handleDeleteAssociation:L,handleDeleteTankAssociation:x,onVesselSearchChange:R,isEnterpriseNode:P,handleInputDataEdit:k,operationsVisibilty:N,handleCellCheck:w,viewTab:j,onTabChange:V,handleAttributeCellDataEdit:_,attributeValidationErrors:Q,selectedAttributeList:F,handleCompAttributeCellDataEdit:O,expandedRows:U,toggleExpand:q,expandedCellRows:B,modMarineCompartmentDetails:H,onCarrierSearchChange:W,isHSEInspectionEnable:Y,isBondShow:K,onCarrierCompanyChange:G,compDetailsTab:J,allocationTab:z,isSlotbookinginUI:Z,updateEnableForConfigure:X}=e;const[$]=(0,n.useTranslation)(),[ee,te]=(0,i.useState)(!1),[ae,ie]=(0,i.useState)(!1),[se,oe]=(0,i.useState)({}),ne=(e,t)=>(0,m.jsx)(o.Select,{className:"selectDropwdown",value:u[e.rowIndex][e.field],fluid:!0,options:t,onChange:t=>f(t,e),indicator:"required",reserveSpace:!1,search:!0,noResultsMessage:$("noResultsMessage")}),re=(e,t)=>(0,m.jsx)(o.Select,{className:"selectDropwdown",value:C[e.rowIndex][e.field],fluid:!0,options:t,onChange:t=>T(t,e),indicator:"required",reserveSpace:!1,search:!0,noResultsMessage:$("noResultsMessage")}),le=e=>(0,m.jsx)(o.Input,{fluid:!0,value:u[e.rowIndex][e.field],onChange:t=>f(t,e),reserveSpace:!1}),de=e=>(0,m.jsx)(o.Input,{fluid:!0,value:C[e.rowIndex][e.field],onChange:t=>T(t,e),reserveSpace:!1}),ce=e=>{const{value:t}=e;try{return"number"===typeof t?t.toLocaleString():t}catch(a){return t}},he=(e,t)=>null!==e&&""!==e?e+t:"",me=(e,t)=>{let a=[];return a=e.find((e=>e.TerminalCode===t)),a.attributeValidationErrors},pe=e=>{const t=e.rowData;try{return t.DataType.toLowerCase()===l.pe.STRING.toLowerCase()||t.DataType.toLowerCase()===l.pe.INT.toLowerCase()||t.DataType.toLowerCase()===l.pe.FLOAT.toLowerCase()||t.DataType.toLowerCase()===l.pe.LONG.toLowerCase()||t.DataType.toLowerCase()===l.pe.DOUBLE.toLowerCase()?(0,m.jsx)(o.Input,{fluid:!0,value:t.AttributeValue,disabled:t.IsReadonly,onChange:t=>O(e,t),reserveSpace:!1}):t.DataType.toLowerCase()===l.pe.BOOL.toLowerCase()?(0,m.jsx)(o.Checkbox,{checked:"true"===t.AttributeValue.toString().toLowerCase(),disabled:t.IsReadonly,onChange:t=>O(e,t)}):t.DataType.toLowerCase()===l.pe.DATETIME.toLowerCase()?(0,m.jsx)(o.DatePicker,{fluid:!0,minuteStep:"5",value:null===t.AttributeValue||void 0===t.AttributeValue||""===t.AttributeValue?"":new Date(t.AttributeValue),disabled:t.IsReadonly,showYearSelector:"true",onChange:t=>O(e,t),reserveSpace:!1}):null}catch(a){console.log("TrailerDetails:Error occured on handleAttributeType",a)}},ue=e=>e.rowData.IsMandatory?(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{children:e.rowData.AttributeName}),(0,m.jsx)("div",{className:"ui red circular empty label badge  circle-padding"})]}):(0,m.jsx)("div",{children:(0,m.jsx)("span",{children:e.rowData.AttributeName})}),Ce=e=>{te(e),this.props.onFieldChange("Bonded")},De=e=>{const t=U.findIndex((t=>t.CompartmentSeqNoInVehicle===e.rowData.CompartmentSeqNoInVehicle))>=0;return(0,m.jsxs)("div",{onClick:()=>q(e.rowData,t),className:"compartmentIcon gridButtonFontColor",children:[(0,m.jsx)("span",{children:$(t?"Hide_Attributes":"View_Attributes")}),(0,m.jsx)(o.Icon,{root:"common",name:t?"caret-up":"caret-down",className:"margin_l10"})]})};function Se(e){return Array.isArray(e.AttributesforUI)&&e.AttributesforUI.length>0?(0,m.jsx)("div",{className:"childTable ChildGridViewAllShipmentLoadingDetails",children:(0,m.jsxs)(s.bQ,{data:e.AttributesforUI,children:[P?(0,m.jsx)(s.bQ.Column,{className:"compColHeight",field:"TerminalCode",header:$("CompartmentTerminal"),editable:!1},"TerminalCode"):"",(0,m.jsx)(s.bQ.Column,{className:"compColHeight",header:$("CompartmentAttributeName"),renderer:ue,editable:!1},"AttributeName"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight",header:$("CompartmentAttributeValue"),renderer:pe})]})}):(0,m.jsx)("div",{className:"compartmentIcon",children:(0,m.jsx)("div",{style:{paddingRight:"87%"},children:$("CustomerInventory_NoRecordsFound")})})}const ye=e=>{let t=H.findIndex((t=>t.CompartmentSeqNoInVehicle===e.CompartmentSeqNoInVehicle));return(0,m.jsx)("div",{children:N.adjustPlanIsDisable||p.DispatchStatus!==l.Mw.QUEUED&&p.DispatchStatus!==l.Mw.PARTIALLY_LOADED&&p.DispatchStatus!==l.Mw.AUTO_LOADED&&p.DispatchStatus!==l.Mw.INTERRUPTED&&p.DispatchStatus!==l.Mw.MANUALLY_LOADED||1===e.DispatchCompartmentStatus||4===e.DispatchCompartmentStatus||5===e.DispatchCompartmentStatus||3===e.DispatchCompartmentStatus||P?(0,m.jsx)(o.Input,{fluid:!0,disabled:!0}):(0,m.jsx)(o.Input,{fluid:!0,disabled:!1,value:H[t].AdjustmentToPlannedQuantity,onChange:t=>{k(t,e)},reserveSpace:!1})})},ge=e=>{let t=e.rowData.forceComplete;return H.forEach((a=>{a.CompartmentSeqNoInVehicle===e.rowData.CompartmentSeqNoInVehicle&&(t=a.forceComplete)})),(0,m.jsx)("div",{children:N.forceCompleteIsDisable||p.DispatchStatus!==l.Mw.QUEUED&&p.DispatchStatus!==l.Mw.PARTIALLY_LOADED&&p.DispatchStatus!==l.Mw.AUTO_LOADED&&p.DispatchStatus!==l.Mw.INTERRUPTED&&p.DispatchStatus!==l.Mw.MANUALLY_LOADED||1===e.rowData.DispatchCompartmentStatus||4===e.rowData.DispatchCompartmentStatus||5===e.rowData.DispatchCompartmentStatus||3===e.rowData.DispatchCompartmentStatus||P?(0,m.jsx)(o.Checkbox,{disabled:!0}):(0,m.jsx)(o.Checkbox,{checked:t,disabled:!1,onClick:t=>{t.stopPropagation(),e.rowData.forceComplete?w(e):(oe(e),ie(!0))}})})},Ae=e=>{try{const t=e.rowData[e.field];return void 0===t||null===t||""===t?"":new Date(t).toLocaleDateString()+" "+new Date(t).toLocaleTimeString()}catch(t){const a=e.rowData[e.field];return console.log("error in disPlayValue",t),new Date(a)+" "+new Date(a)}},Ee=e=>{const a=e.rowData[e.field];return void 0===a||null===a||""===a?"":a+" "+t[0].uom};const ve=e=>{let t=[];return t.push(e),(0,m.jsx)("div",{className:"childTable ChildGridViewAllShipmentLoadingDetails",children:(0,m.jsxs)(s.bQ,{data:t,children:[(0,m.jsx)(s.bQ.Column,{className:"compColHeight",field:"AdjustmentToPlannedQuantity",header:$("ViewShipment_AdjustmentToPlannedQuantity"),renderer:e=>ye(e.rowData)}),(0,m.jsx)(s.bQ.Column,{className:"compColHeight",field:"forceComplete",header:$("ViewShipment_ForceComplete"),renderer:e=>ge(e)})]})})};return(0,m.jsx)(n.TranslationConsumer,{children:e=>(0,m.jsxs)("div",{className:"detailsContainer",children:[(0,m.jsxs)("div",{className:"row",children:[(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Input,{fluid:!0,value:p.DispatchCode,indicator:"required",disabled:""!==a.DispatchCode,onChange:e=>A("DispatchCode",e),label:e("Marine_ShipmentCompDetail_ShipmentNumber"),error:e(D.DispatchCode),reserveSpace:!1})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Select,{fluid:!0,placeholder:"Select",indicator:"required",disabled:!(X||""===a.DispatchCode),label:e("Marine_ShipmentCompDetail_CarrierCompany"),value:p.CarrierCode,options:S.carrierCompany,onChange:e=>{G(e)},error:e(D.CarrierCode),reserveSpace:!1,search:!0,noResultsMessage:e("noResultsMessage"),onSearch:W})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Select,{fluid:!0,placeholder:"Select",indicator:"required",disabled:!(X||""===a.DispatchCode),label:e("Marine_ShipmentCompDetail_Vehicle"),value:p.VesselCode,options:(0,r.r4)(S.vessels,e("Common_Select")),onChange:e=>{A("VesselCode",e)},error:e(D.VesselCode),reserveSpace:!1,search:!0,noResultsMessage:e("noResultsMessage"),onSearch:R})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.DatePicker,{fluid:!0,minuteStep:"5",value:null===p.ScheduledDate?"":new Date(p.ScheduledDate),label:e("Marine_ShipmentCompDetail_ScheduledDate"),type:"datetime",disablePast:!1,indicator:"required",disabled:!(X||""===a.DispatchCode),onChange:e=>A("ScheduledDate",e),displayFormat:(0,r.F1)(),error:e(D.ScheduledDate),onTextChange:(e,t)=>{E("ScheduledDate",e,t)},reserveSpace:!1})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Input,{fluid:!0,value:p.DispatchStatus,onChange:e=>A("DispatchStatus",e),label:e("Marine_ShipmentCompDetail_ShipmentStatus"),reserveSpace:!1,disabled:!0})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Select,{fluid:!0,placeholder:e("MarineDispatchManualEntry_LASelect"),label:e("Marine_ShipmentCompDetail_UOM"),value:p.QuantityUOM,multiple:!1,indicator:"required",options:S.shipmentUOM,onChange:e=>A("QuantityUOM",e),error:e(D.QuantityUOM),disabled:!(X||""===a.DispatchCode),reserveSpace:!1,search:!0,noResultsMessage:e("noResultsMessage")})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Input,{fluid:!0,value:p.Description,disabled:!(X||""===a.DispatchCode),onChange:e=>A("Description",e),label:e("CarrierDetails_Desc"),error:e(D.Description),reserveSpace:!1})}),""!==a.DispatchCode&&Z?(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4 ddlSelectAll",children:(0,m.jsxs)("div",{className:"ui single-input fluid disabled",children:[(0,m.jsx)("div",{class:"ui input-label",children:(0,m.jsx)("span",{className:"input-label-message",children:e("ViewShipment_IsSlotBooked")})}),(0,m.jsx)("div",{className:"input-wrap",children:(0,m.jsx)("label",{style:{fontWeight:"bold"},children:p.SlotBooked?"Booked":"Not Booked"})})]})}):"",X&&""===a.DispatchCode||P||!Y?"":(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Input,{fluid:!0,value:p.HSEInspectionStatus,label:e("Marine_ShipmentCompDetail_InspectionStatus"),reserveSpace:!1,disabled:!0})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Select,{fluid:!0,placeholder:e("FinishedProductInfo_Select"),label:e("Cust_Status"),value:p.Active,options:[{text:e("ViewShipment_Ok"),value:!0},{text:e("ViewShipmentStatus_Inactive"),value:!1}],onChange:e=>A("Active",e),disabled:!(X||""===a.DispatchCode)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Input,{fluid:!0,value:p.Remarks,label:e("Cust_Remarks"),onChange:e=>A("Remarks",e),indicator:p.Active!==a.Active?"required":"",error:e(D.Remarks),reserveSpace:!1,disabled:!(X||""===a.DispatchCode)})}),P?(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Select,{fluid:!0,placeholder:"Select",indicator:"required",label:e("TerminalCodes"),value:null===p.TerminalCodes||0===p.TerminalCodes.length?"":p.TerminalCodes[0],disabled:!(X||""===a.DispatchCode),options:(0,r.r4)(h.Zj(S.terminalCodes),e("Common_Select")),onChange:e=>A("TerminalCodes",e),error:e(D.TerminalCodes),reserveSpace:!1})}):"",X&&""===a.DispatchCode||!P?"":(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Input,{fluid:!0,placeholder:"",label:e("Shipment_LoadedTerminal"),value:a.ActualTerminalCode,disabled:!0})}),K?(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",style:{paddingTop:"25px"},children:(0,m.jsx)(o.Checkbox,{label:e("ViewShipmentStatus_ShipmentBond"),checked:ee||null!==a.BondNumber,onChange:e=>Ce(e),disabled:!X})}):"",K&&(ee||null!==a.BondNumber)?(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Input,{fluid:!0,indicator:"required",label:e("Shipment_BondedNo"),value:a.BondNumber,error:e(D.BondNumber),disabled:!X,onChange:e=>A("BondNumber",e),reserveSpace:!1})}):""]}),F.length>0?F.map((t=>(0,m.jsx)(c.A,{children:(0,m.jsx)(o.Accordion,{children:(0,m.jsx)(o.Accordion.Content,{className:"attributeAccordian",title:P?t.TerminalCode+" - "+e("Attributes_Header"):e("Attributes_Header"),children:(0,m.jsx)(d.n,{selectedAttributeList:t.attributeMetaDataList,handleCellDataEdit:_,attributeValidationErrors:me(Q,t.TerminalCode)})})})}))):null,(0,m.jsxs)("div",{children:[(0,m.jsxs)(o.Tab,{defaultActiveIndex:j,onTabChange:V,className:"col-12",children:[(0,m.jsxs)(o.Tab.Pane,{title:e("Shipment_Compartment_Planning_Tab_Header"),children:[(0,m.jsx)("div",{className:"row compartmentRow",children:(0,m.jsx)("div",{className:"col col-md-12 col-lg-12 col-xl-12",children:X?(0,m.jsxs)("div",{className:"compartmentIconContainer",children:[(0,m.jsxs)("div",{onClick:I,className:"compartmentIcon",children:[(0,m.jsx)("div",{children:(0,m.jsx)(o.Icon,{root:"common",name:"badge-plus",size:"medium"})}),(0,m.jsx)("div",{className:"margin_l10",children:(0,m.jsx)("h5",{className:"font14",children:e("FinishedProductInfo_Add")})})]}),(0,m.jsxs)("div",{onClick:L,className:"compartmentIcon margin_l30",children:[(0,m.jsx)("div",{children:(0,m.jsx)(o.Icon,{root:"common",name:"delete",size:"medium"})}),(0,m.jsx)("div",{className:"margin_l10",children:(0,m.jsx)("h5",{className:"font14",children:e("DestAdd_Delete")})})]})]}):(0,m.jsxs)("div",{className:"compartmentIconContainer",children:[(0,m.jsxs)("div",{className:"compartmentIcon",children:[(0,m.jsx)("div",{children:(0,m.jsx)(o.Icon,{root:"common",name:"badge-plus",size:"medium"})}),(0,m.jsx)("div",{className:"margin_l10",children:(0,m.jsx)("h5",{className:"font14",children:e("FinishedProductInfo_Add")})})]}),(0,m.jsxs)("div",{className:"compartmentIcon margin_l30",children:[(0,m.jsx)("div",{children:(0,m.jsx)(o.Icon,{root:"common",name:"delete",size:"medium"})}),(0,m.jsx)("div",{className:"margin_l10",children:(0,m.jsx)("h5",{className:"font14",children:e("DestAdd_Delete")})})]})]})})}),(0,m.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,m.jsx)("div",{className:"col-12 detailsTable",children:(0,m.jsxs)(s.bQ,{data:u,selectionMode:"multiple",selection:y,onSelectionChange:v,rowExpansionTemplate:Se,expandedRows:U,children:[(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"ShareholderCode",header:(0,r.i7)(e("Marine_ShipmentCompDetail_Shareholder")),editable:X,editFieldType:"text",customEditRenderer:e=>ne(e,S.shareholders)},"ShareholderCode"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"CompartmentSeqNoInVehicle",header:(0,r.i7)(e("Marine_ShipmentCompDetail_CompSeqInVehicle")),editable:X,editFieldType:"text",customEditRenderer:e=>ne(e,S.compSeqOptions)},"CompartmentSeqNoInVehicle"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"FinishedProductCode",header:(0,r.i7)(e("Marine_ShipmentCompDetail_ProductCode")),editable:X,editFieldType:"text",customEditRenderer:e=>(e=>{let t=[];return void 0!==S.FinishedProducts&&null!==S.FinishedProducts&&void 0!==S.FinishedProducts[e.rowData.ShareholderCode]&&Array.isArray(S.FinishedProducts[e.rowData.ShareholderCode])&&S.FinishedProducts[e.rowData.ShareholderCode].forEach((e=>t.push({text:e,value:e}))),ne(e,t)})(e)},"FinishedProductCode"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"CustomerCode",header:(0,r.i7)(e("Marine_ShipmentCompDetail_Customer")),editable:X,editFieldType:"text",customEditRenderer:e=>(e=>{let t=[];if(void 0!==S.shareholderCustomers&&null!==S.shareholderCustomers){let a=S.shareholderCustomers.filter((t=>t.ShareholderCode===e.rowData.ShareholderCode));a.length>0&&null!==a[0].CustomerDestinationsList&&Object.keys(a[0].CustomerDestinationsList).forEach((e=>t.push({text:e,value:e})))}return ne(e,t)})(e)},"CustomerCode"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"DestinationCode",header:(0,r.i7)(e("Marine_ShipmentCompDetail_Destination")),editable:X,editFieldType:"text",customEditRenderer:e=>(e=>{let t=[],a=[];if(void 0!==S.shareholderCustomers&&null!==S.shareholderCustomers){let i=S.shareholderCustomers.filter((t=>t.ShareholderCode===e.rowData.ShareholderCode));i.length>0&&null!==i[0].CustomerDestinationsList&&(a=i[0].CustomerDestinationsList),void 0!==a[e.rowData.CustomerCode]&&Array.isArray(a[e.rowData.CustomerCode])&&a[e.rowData.CustomerCode].forEach((e=>t.push({text:e,value:e})))}return ne(e,t)})(e)},"DestinationCode"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"Quantity",header:(0,r.i7)(e("Marine_ShipmentCompDetail_Quantity")),editable:X,editFieldType:"text",renderer:e=>ce(e),customEditRenderer:le},"Quantity"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight",initialWidth:"170px",renderer:De})]})})})]}),(0,m.jsxs)(o.Tab.Pane,{title:e("ShipmentTankPlanning"),children:[(0,m.jsx)("div",{className:"row compartmentRow",children:(0,m.jsx)("div",{className:"col col-md-12 col-lg-12 col-xl-12",children:X?(0,m.jsxs)("div",{className:"compartmentIconContainer",children:[(0,m.jsxs)("div",{onClick:X?M:"",className:"compartmentIcon",children:[(0,m.jsx)("div",{children:(0,m.jsx)(o.Icon,{root:"common",name:"badge-plus",size:"medium"})}),(0,m.jsx)("div",{className:"margin_l10",children:(0,m.jsx)("h5",{className:"font14",children:e("FinishedProductInfo_Add")})})]}),(0,m.jsxs)("div",{onClick:X?x:"",className:"compartmentIcon margin_l30",children:[(0,m.jsx)("div",{children:(0,m.jsx)(o.Icon,{root:"common",name:"delete",size:"medium"})}),(0,m.jsx)("div",{className:"margin_l10",children:(0,m.jsx)("h5",{className:"font14",children:e("DestAdd_Delete")})})]})]}):(0,m.jsxs)("div",{className:"compartmentIconContainer",children:[(0,m.jsxs)("div",{className:"compartmentIcon",children:[(0,m.jsx)("div",{children:(0,m.jsx)(o.Icon,{root:"common",name:"badge-plus",size:"medium"})}),(0,m.jsx)("div",{className:"margin_l10",children:(0,m.jsx)("h5",{className:"font14",children:e("FinishedProductInfo_Add")})})]}),(0,m.jsxs)("div",{className:"compartmentIcon margin_l30",children:[(0,m.jsx)("div",{children:(0,m.jsx)(o.Icon,{root:"common",name:"delete",size:"medium"})}),(0,m.jsx)("div",{className:"margin_l10",children:(0,m.jsx)("h5",{className:"font14",children:e("DestAdd_Delete")})})]})]})})}),(0,m.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,m.jsx)("div",{className:"col-12 detailsTable",children:(0,m.jsxs)(s.bQ,{data:C,selectionMode:"multiple",selection:g,onSelectionChange:b,children:[(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"ShareholderCode",header:(0,r.i7)(e("Marine_ShipmentCompDetail_Shareholder")),editable:X,editFieldType:"text",customEditRenderer:e=>re(e,S.shareholders)},"ShareholderCode"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"CompartmentSeqNoInVehicle",header:(0,r.i7)(e("Marine_ShipmentCompDetail_CompSeqInVehicle")),editable:X,editFieldType:"text",customEditRenderer:e=>re(e,S.compSeqOptions)},"CompartmentSeqNoInVehicle"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"FinishedProductCode",header:(0,r.i7)(e("Marine_ShipmentCompDetail_ProductCode")),editable:X,editFieldType:"text",customEditRenderer:e=>(e=>{let t=[];return void 0!==S.FinishedProducts&&null!==S.FinishedProducts&&void 0!==S.FinishedProducts[e.rowData.ShareholderCode]&&Array.isArray(S.FinishedProducts[e.rowData.ShareholderCode])&&S.FinishedProducts[e.rowData.ShareholderCode].forEach((e=>t.push({text:e,value:e}))),re(e,t)})(e)},"FinishedProductCode"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"BaseProductCode",header:(0,r.i7)(e("Marine_ShipmentCompDetail_BaseProduct")),editable:X,editFieldType:"text",customEditRenderer:e=>(e=>{let t=[];if(void 0!==S.baseProductDetails.ALLPROD&&null!==S.baseProductDetails.ALLPROD)var a=S.baseProductDetails.ALLPROD.concat(S.additiveDetails.ALLPROD);return void 0!==a&&null!==a&&a.length>0&&Object.values(a).forEach((e=>t.push({text:e,value:e}))),re(e,t)})(e)},"BaseProductCode"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"TankCode",header:(0,r.i7)(e("Marine_ShipmentCompDetail_Tank")),editable:X,editFieldType:"text",customEditRenderer:e=>re(e,S.tankCodeOptions)},"TankCode"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"PlannedQuantity",header:(0,r.i7)(e("Marine_ShipmentCompDetail_Quantity")),editable:X,editFieldType:"text",renderer:e=>ce(e),customEditRenderer:de},"PlannedQuantity")]})})})]}),J.map((()=>(0,m.jsx)(o.Tab.Pane,{title:e("ViewShipment_LoadingDetails_TopUpDecant"),disabled:""===a.DispatchCode&&X,children:(0,m.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,m.jsx)("div",{className:"col-12 detailsTable",children:(0,m.jsxs)(s.bQ,{data:H,rowExpansionTemplate:ve,expandedRows:B,children:[(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"CompartmentSeqNoInVehicle",header:e("ViewMarineShipmentList_SeqNo")}),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"FinishedProductCode",header:e("ViewShipmentCompartment_Product")}),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"DispatchCompartmentStatus",header:e("ViewShipmentStatus_Status"),renderer:e=>{return(t=e.rowData.DispatchCompartmentStatus)===l.Kl.EMPTY?"EMPTY":t===l.Kl.LOADING?"LOADING":t===l.Kl.PART_FILLED?"PART_FILLED":t===l.Kl.OVER_FILLED?"OVER_FILLED":t===l.Kl.FORCE_COMPLETED?"FORCE_COMPLETED":t===l.Kl.COMPLETED?"COMPLETED":t===l.Kl.INTERRUPTED?"INTERRUPTED":"";var t}}),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"PlannedQuantity",header:e("ViewShipmentCompartment_PlannedQuantity"),renderer:e=>he(e.rowData.PlannedQuantity,e.rowData.PlanQuantityUOM)}),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"AdjustedPlanQuantity",header:e("ViewShipmentCompartment_AdjustedQuantity"),renderer:e=>he(e.rowData.AdjustedPlanQuantity,e.rowData.PlanQuantityUOM)}),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"ReturnQuantity",header:e("ViewMarineShipmentList_ReturnQuantity"),renderer:e=>he(e.rowData.ReturnQuantity,e.rowData.PlanQuantityUOM)}),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"LoadedQuantity",header:e("ViewMarineShipmentList_LoadedQuantity"),renderer:e=>he(e.rowData.LoadedQuantity,e.rowData.PlanQuantityUOM)}),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"AdjustmentToPlannedQuantity",header:e("ViewShipment_AdjustmentToPlannedQuantity"),renderer:e=>ye(e.rowData)}),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"forceComplete",header:e("ViewShipment_ForceComplete"),renderer:e=>ge(e)})]})})})}))),z.map((()=>(0,m.jsx)(o.Tab.Pane,{title:e("ViewMarineShipmentProductAllocation_Item"),disabled:""===a.DispatchCode&&X,children:(0,m.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,m.jsx)("div",{className:"col-12 detailsTable",children:(0,m.jsxs)(s.bQ,{data:t,scrollable:!0,children:[(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"EntityCode",header:e("MarineShipmentProductAllocationDetails_CustomerCode"),editable:!1,editFieldType:"text"},"EntityCode"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"productcode",header:e("MarineShipmentProductAllocationDetails_ProductCode"),editable:!1,editFieldType:"text"},"productcode"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",header:e("MarineShipmentProductAllocationDetails_AllocationType"),field:"allocationtype",editable:!1,editFieldType:"text"},"allocationtype"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",field:"allocationperiod",header:e("MarineShipmentProductAllocationDetails_AllocationFrequency"),editable:!1,editFieldType:"text"},"allocationperiod"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",header:e("MarineShipmentProductAllocationDetails_StartDate"),editable:!1,field:"startdate",editFieldType:"text",renderer:e=>Ae(e)},"startdate"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",header:e("MarineShipmentProductAllocationDetails_EndDate"),editable:!1,field:"enddate",editFieldType:"text",renderer:e=>Ae(e)},"enddate"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",header:e("MarineShipmentProductAllocationDetails_AllocatedQuantity"),editable:!1,field:"allocatedqty",editFieldType:"text",renderer:e=>Ee(e)},"allocatedqty"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",header:e("MarineShipmentProductAllocationDetails_BlockedQuantity"),editable:!1,field:"blockedqty",editFieldType:"text",renderer:e=>Ee(e)},"blockedqty"),(0,m.jsx)(s.bQ.Column,{className:"compColHeight colminWidth",header:e("MarineShipmentProductAllocationDetails_LoadedQuantity"),editable:!1,field:"loadedqty",editFieldType:"text",renderer:e=>Ee(e)},"loadedqty")]})})})})))]}),(0,m.jsx)(n.TranslationConsumer,{children:e=>(0,m.jsxs)(o.Modal,{open:ae,size:"small",children:[(0,m.jsx)(o.Modal.Content,{children:(0,m.jsx)("div",{children:(0,m.jsx)("b",{children:e("ForceToComplete")})})}),(0,m.jsxs)(o.Modal.Footer,{children:[(0,m.jsx)(o.Button,{type:"secondary",content:e("Cancel"),onClick:()=>{ie(!1)}}),(0,m.jsx)(o.Button,{type:"primary",content:e("Confirm"),onClick:()=>{ie(!1),w(se)}})]})]})})]})]})})}p.defaultProps={isEnterpriseNode:!1,isSlotbookinginUI:!1};var u=a(44192),C=a(46100),D=a(40854),S=a.n(D),y=a(9966),g=a(50805),A=a(97508),E=(a(38726),a(43503)),v=a(93779),b=a(80312),f=a(28882),T=a(53536),I=a.n(T),M=a(40252),L=a(53164),x=a(15417),R=a(72067),P=a(9256),k=a(40510),N=a(39424),w=a(62900);class j extends i.Component{constructor(){var e;super(...arguments),e=this,this.state={marineDispatch:I().cloneDeep(C.Y0),modMarineDispatch:{},baseProductDetails:{},additiveDetails:{},modAssociations:[],modTankAssociations:[],tempModTankAssociations:[],modTankPlanAssociations:[],vehicleDetails:{carrierCode:"",vehicleCompartments:[]},modVehicleDetails:{carrierCode:"",vehicleCompartments:[]},validationErrors:h.Th(u.FQ),isReadyToRender:!1,isCompartmentDetails:!1,shareholders:this.getShareholders(),terminalCodes:this.props.terminalCodes,shipmentUOM:[],Captains:[],vessels:[],vesselSearchOptions:[],FinishedProducts:{},customerDestinationOptions:{},compSeqOptions:[],shareholderCustomers:[],tankCodeOptions:[],associatedCompartments:[],saveEnabled:!1,selectedAssociations:[],selectedTankAssociations:[],marineShipmentPlan:[],marineCompartmentDetails:[],modMarineCompartmentDetails:[],attributeMetaDataList:[],attributeValidationErrors:[],compartmentAttributeMetaDataList:[],selectedAttributeList:[],attribute:[],terminalOptions:[],expandedRows:[],operationsVisibilty:{forceCompleteIsDisable:!1,adjustPlanIsDisable:!1},finishedProductItems:[],length:0,isManualEntry:!1,expandedCellRows:[],carrierOptions:[],carrierShareholderMap:{},carrierSearchOptions:[],isHSEInspectionEnable:!1,isBondShow:!1,isNewDispatch:!1,productAllocationDetails:[],marineDispatchKPIList:[],showAuthenticationLayout:!1,tempMarineDispatch:{}},this.handleChange=(e,t)=>{try{const a=I().cloneDeep(this.state.modMarineDispatch),i=I().cloneDeep(this.state.validationErrors);"TerminalCodes"===e?(null===t?a[e]=[]:a[e][0]=t,this.terminalSelectionChange([t]),this.getTankListForRole(t)):a[e]=t,"VesselCode"===e&&(null===t?this.setState({modAssociations:[],modTankAssociations:[],modTankPlanAssociations:[]}):this.getVessel(t,!0)),"Active"===e&&(a.Active!==this.state.marineDispatch.Active&&(a.Remarks=""),a[e]=t),"DispatchCode"===e&&(a.DispatchCode=t,0!==this.state.modTankAssociations.length&&this.state.modTankAssociations.forEach((e=>{e.DispatchCode=t}))),"BondNumber"===e&&(a[e]=t),"ScheduledDate"===e&&(a[e]=t),"DispatchStatus"===e&&(a[e]=t),"QuantityUOM"===e&&(a[e]=t),"Description"===e&&(a[e]=t),"Active"===e&&(a[e]=t),"Remarks"===e&&(a[e]=t),"Bonded"===e&&(i.BondNumber="BONDED_NO_CANT_BE_EMPTY_FOR_BONDED_MARINE_DISPATCH_X"),this.setState({modMarineDispatch:a}),void 0!==u.FQ[e]&&(i[e]=h.jr(u.FQ[e],t),this.setState({validationErrors:i}))}catch(a){console.log("MarineDispatchDetailsComposite:Error occured on handleChange",a)}},this.handleAddAssociation=()=>{if(!this.props.userDetails.EntityResult.IsArchived)try{if(this.state.modAssociations.length<this.state.modVehicleDetails.vehicleCompartments.length){let t=I().cloneDeep(this.state.modAssociations),a={DispatchCode:null,ShareholderCode:this.props.selectedShareholder,CustomerCode:null,DestinationCode:null,FinishedProductCode:null,CompartmentCode:null,CarrierCompanyCode:null,TrailerCode:null,Quantity:null,QuantityUOM:null,SequenceNo:0,CompartmentSeqNoInVehicle:"",AssociatedOrderItems:null,AssociatedContractItems:null,Attributes:[]};var e=1;t.forEach((t=>{var a=t.SequenceNo;if(null!==a&&""!==a&&void 0!==a&&!isNaN(parseInt(a))){let t=parseInt(a);t>=e&&(e=t+1)}})),a.SequenceNo=e,a.QuantityUOM=this.state.modMarineDispatch.QuantityUOM,t.push(a),this.setState({modAssociations:t,selectedAssociations:[]},(()=>{if(!1===this.props.userDetails.EntityResult.IsEnterpriseNode){var e=I().cloneDeep(this.state.compartmentAttributeMetaDataList);e.length>0&&this.formCompartmentAttributes([e[0].TerminalCode])}else this.formCompartmentAttributes(this.state.modMarineDispatch.TerminalCodes)}))}}catch(t){console.log("MarineDispatchDetailsComposite:Error occured on handleAddAssociation",t)}},this.handleAddTankAssociation=()=>{if(!this.props.userDetails.EntityResult.IsArchived)try{let t=I().cloneDeep(this.state.modTankAssociations),a=I().cloneDeep(C.vs);var e=1;t.forEach((t=>{var a=t.SequenceNo;if(null!==a&&""!==a&&void 0!==a&&!isNaN(parseInt(a))){let t=parseInt(a);t>=e&&(e=t+1)}})),a.SequenceNo=e,a.PlanQuantityUOM=this.state.modMarineDispatch.QuantityUOM,t.push(a),this.setState({modTankPlanAssociations:t,modTankAssociations:t,selectedTankAssociations:[]})}catch(t){console.log("MarineDispatchDetailsComposite:Error occured on handleAddAssociation",t)}},this.handleDeleteAssociation=()=>{if(!this.props.userDetails.EntityResult.IsArchived)try{if(null!=this.state.selectedAssociations&&this.state.selectedAssociations.length>0&&this.state.modAssociations.length>0){let e=I().cloneDeep(this.state.modAssociations),t=I().cloneDeep(this.state.modTankPlanAssociations);this.state.selectedAssociations.forEach((a=>{e=e.filter((e=>e.SequenceNo!==a.SequenceNo)),t=t.filter((e=>e.CompartmentSeqNoInVehicle!==a.CompartmentSeqNoInVehicle))})),this.setState({modAssociations:e,modTankPlanAssociations:t,modTankAssociations:t,selectedAssociations:[]})}}catch(e){console.log("MarineDispatchDetailsComposite:Error occured on handleDeleteAssociation",e)}},this.handleDeleteTankAssociation=()=>{if(!this.props.userDetails.EntityResult.IsArchived)try{if(null!=this.state.selectedTankAssociations&&this.state.selectedTankAssociations.length>0&&this.state.modTankAssociations.length>0){let e=I().cloneDeep(this.state.modTankAssociations);this.state.selectedTankAssociations.forEach(((t,a)=>{e=e.filter(((e,a)=>e.SequenceNo!==t.SequenceNo))})),this.setState({modTankPlanAssociations:e,modTankAssociations:e,selectedTankAssociations:[]})}}catch(e){console.log("MarineDispatchDetailsComposite:Error occured on handleDeleteTankAssociation",e)}},this.handleCellDataEdit=(e,t)=>{try{let i=I().cloneDeep(this.state.modAssociations);if(i[t.rowIndex][t.field]=e,"Quantity"===t.field&&(i[t.rowIndex].Quantity=e.toLocaleString()),"CustomerCode"!==t.field&&"FinishedProductCode"!==t.field&&"DestinationCode"!==t.field||this.getFinishedProduct(i,t),"ShareholderCode"===t.field){i[t.rowIndex].CustomerCode="",i[t.rowIndex].FinishedProductCode="",i[t.rowIndex].DestinationCode="";let s=this.state.shareholderCustomers.filter((t=>t.ShareholderCode===e));var a;if(s.length>0)a=s[0].CustomerDestinationsList,this.setState({customerDestinationOptions:a});else console.log("no customers identified for shareholder")}else if("CustomerCode"===t.field){let a=this.state.shareholderCustomers.filter((e=>e.ShareholderCode===t.rowData.ShareholderCode))[0].CustomerDestinationsList;void 0!==a&&null!==a&&(void 0!==a[e]&&Array.isArray(a[e])&&1===a[e].length?(i[t.rowIndex].DestinationCode=a[e][0],this.getFinishedProduct(i,t)):i[t.rowIndex].DestinationCode="")}else if("CompartmentSeqNoInVehicle"===t.field){let a=this.state.modVehicleDetails.vehicleCompartments.filter((t=>t.vehCompSeq.toString()===e.toString()));a.length>0&&(i[t.rowIndex].Quantity=null!==a[0].SFL&&""!==a[0].SFL?a[0].SFL.toLocaleString():null,i[t.rowIndex].TrailerCode=a[0].trailerCode,i[t.rowIndex].CompartmentCode=a[0].compCode)}this.setState({modAssociations:i})}catch(i){console.log("MarineDispatchDetailsComposite:Error occured on handleCellDataEdit",i)}},this.handleTankCellDataEdit=(e,t)=>{try{let s=I().cloneDeep(this.state.modTankAssociations);if(s[t.rowIndex][t.field]=e,"ShareholderCode"===t.field)s[t.rowIndex].FinishedProductCode="",s[t.rowIndex].BaseProductCode="",s[t.rowIndex].DestinationCode="";else if("CompartmentSeqNoInVehicle"===t.field){let a=this.state.modVehicleDetails.vehicleCompartments.filter((t=>t.vehCompSeq.toString()===e.toString()));a.length>0&&(s[t.rowIndex].PlannedQuantity=null!==a[0].SFL&&""!==a[0].SFL?a[0].SFL.toLocaleString():null,s[t.rowIndex].TrailerCode=a[0].trailerCode,s[t.rowIndex].CompartmentCode=a[0].compCode)}else if("FinishedProductCode"===t.field)""===s[t.rowIndex][t.field]&&(s[t.rowIndex].BaseProductCode="",s[t.rowIndex].TankCode="");else if("BaseProductCode"===t.field){let a=this.state.tankCodeOptions;void 0!==a&&null!==a&&(void 0!==a[e]&&Array.isArray(a[e])&&1===a[e].length?s[t.rowIndex].tankCode=a[e][0]:s[t.rowIndex].tankCode="")}else if("TankCode"===t.field){var a=[],i=I().cloneDeep(C.PV);i.CompartmentCode=s[t.rowIndex].CompartmentCode,i.CompartmentSeqNoInVehicle=s[t.rowIndex].CompartmentSeqNoInVehicle,i.PlannedQuantity=h.bo(s[t.rowIndex].PlannedQuantity),i.PlanQuantityUOM=s[t.rowIndex].PlanQuantityUOM,i.DispatchCode=s[t.rowIndex].DispatchCode,i.TankCode=s[t.rowIndex].TankCode,a.push(i),s[t.rowIndex].DispatchCompartmentTanks=a}else"PlannedQuantity"===t.field&&null!==s[t.rowIndex].DispatchCompartmentTanks&&""!==s[t.rowIndex].DispatchCompartmentTanks&&0!==s[t.rowIndex].DispatchCompartmentTanks.length&&(s[t.rowIndex].DispatchCompartmentTanks[0].PlannedQuantity=h.bo(s[t.rowIndex].PlannedQuantity));this.setState({modTankAssociations:s,modTankPlanAssociations:s})}catch(s){console.log("MarineDispatchDetailsComposite:Error occured on handleTankCellDataEdit",s)}},this.handleAssociationSelectionChange=e=>{this.setState({selectedAssociations:e})},this.handleTankAssociationSelectionChange=e=>{this.setState({selectedTankAssociations:e})},this.toggleExpand=function(t,a){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=e.state.expandedRows,o=s.findIndex((e=>e.CompartmentSeqNoInVehicle===t.CompartmentSeqNoInVehicle));a?i&&o>=0?(s.splice(o,1),s.push(t)):o>=0&&s.splice(o,1):o>=0?s=s.filter((e=>e.Code!==t.Code&&e.CompartmentSeqNoInVehicle!==t.CompartmentSeqNoInVehicle)):s.push(t),e.setState({expandedRows:s})},this.handleAttributeCellDataEdit=(e,t)=>{try{const a=I().cloneDeep(this.state.attributeValidationErrors);a.forEach((a=>{a.TerminalCode===e.TerminalCode&&(a.attributeValidationErrors[e.Code]=h.I5(e,t))})),this.setState({attributeValidationErrors:a}),e.DataType!==l.IB.INT&&e.DataType!==l.IB.LONG&&e.DataType!==l.IB.FLOAT&&e.DataType!==l.IB.DOUBLE||(t=h.bo(t)),e.DefaultValue=t,this.setState({attribute:e})}catch(a){console.log("TrailerDetailsComposite:Error occured on handleAttributeCellDataEdit",a)}},this.handleCompAttributeCellDataEdit=(e,t)=>{let a=I().cloneDeep(this.state.modAssociations);e.rowData.DataType!==l.IB.INT&&e.rowData.DataType!==l.IB.LONG&&e.rowData.DataType!==l.IB.FLOAT&&e.rowData.DataType!==l.IB.DOUBLE||(t=h.bo(t));let i=a.findIndex((t=>t.CompartmentSeqNoInVehicle===e.rowData.compSequenceNo));i>=0&&("Bool"===e.rowData.DataType?"true"===e.rowData.AttributeValue?a[i].AttributesforUI[e.rowData.SeqNumber-1].AttributeValue="false":a[i].AttributesforUI[e.rowData.SeqNumber-1].AttributeValue="true":a[i].AttributesforUI[e.rowData.SeqNumber-1].AttributeValue=t),this.setState({modAssociations:a}),i>=0&&this.toggleExpand(a[i],!0,!0)},this.handleActiveStatusChange=e=>{try{let t=I().cloneDeep(this.state.modMarineDispatch);t.Active=e,t.Active!==this.state.marineDispatch.Active&&(t.Remarks=""),this.setState({modMarineDispatch:t})}catch(t){console.log(t)}},this.handleSave=()=>{let{saveEnabled:e}=this.state;if(e)try{var t=I().cloneDeep(this.state.modTankAssociations),a=t.filter((e=>0!==e.DispatchCompartmentTanks.length));if(0===(a=a.filter((e=>""!==e.DispatchCompartmentTanks[0].TankCode))).length){this.saveMarineDispatch([])}else this.saveMarineDispatch(t)}catch(i){console.log("MarineDispatchDetailsComposite:Error occured on handleSave",i)}else this.compartmentDetailsSave()},this.addUpdateMarineDispatch=()=>{try{this.setState({saveEnabled:!1});let e=I().cloneDeep(this.state.tempMarineDispatch);""===this.state.marineDispatch.DispatchCode?this.createMarineDispatch(e):this.updateMarineDispatch(e)}catch(e){console.log("MarineShipComposite : Error in addUpdateMarineDispatch")}},this.handleReset=()=>{try{let e=I().cloneDeep(this.state.vehicleDetails),t=[],a=[],i=[],s=[];""===this.state.marineDispatch.DispatchCode?(t=[],s=[]):(t=this.getAssociationsFromDispatch(this.state.marineDispatch),a=I().cloneDeep(this.state.tempModTankAssociations),i=I().cloneDeep(this.state.tempModTankAssociations),e.vehicleCompartments.forEach((e=>s.push({text:e.vehCompSeq.toString(),value:e.vehCompSeq.toString()})))),this.setState({modMarineDispatch:I().cloneDeep(this.state.marineDispatch),validationErrors:[],modVehicleDetails:I().cloneDeep(this.state.vehicleDetails),modAssociations:t,modTankAssociations:a,modTankPlanAssociations:i,selectedAttributeList:[],selectedAssociations:[],selectedTankAssociations:[],vesselSearchOptions:[],terminalCodes:this.props.terminalCodes,compSeqOptions:s},(()=>{this.props.userDetails.EntityResult.IsEnterpriseNode?(this.terminalSelectionChange(t.TerminalCodes),this.handleResetAttributeValidationError()):(this.localNodeAttribute(),this.handleResetAttributeValidationError())}))}catch(e){console.log("MarineDispatchDetailsComposite:Error occured on handleReset",e)}},this.handleDateTextChange=(e,t,a)=>{try{var i=I().cloneDeep(this.state.validationErrors),s=I().cloneDeep(this.state.modMarineDispatch);i[e]=a,s[e]=t,this.setState({validationErrors:i,modMarineDispatch:s})}catch(a){console.log("MarineDispatchDetailsComposite:Error occured on handleDateTextChange",a)}},this.handleAllTerminalsChange=e=>{try{var t=[...this.props.terminalCodes],a=I().cloneDeep(this.state.modMarineDispatch);a.TerminalCodes=e?[...t]:[],this.setState({modMarineDispatch:a})}catch(i){console.log("MarineDispatchDetailsComposite:Error occured on handleAllTerminalsChange",i)}},this.onCarrierCompanyChange=e=>{try{const t=I().cloneDeep(this.state.modMarineDispatch),a=I().cloneDeep(this.state.validationErrors);t.CarrierCode=e,t.VesselCode="",this.setState({modMarineDispatch:t,modAssociations:[],modTankAssociations:[],modTankPlanAssociations:[]},(()=>this.getVesselsByCarrier(this.props.selectedShareholder))),this.props.userDetails.EntityResult.IsEnterpriseNode&&this.getTerminalsForCarrier(e),a.CarrierCode="",this.setState({validationErrors:a})}catch(t){console.log("ViewMarineReceiptDetailsComposite:Error occured on onCarrierCompanyChange",t)}},this.handleVesselSearchChange=e=>{try{let t=this.state.vessels.filter((t=>t.value.toLowerCase().includes(e.toLowerCase())));t.length>l.bM&&(t=t.slice(0,l.bM)),this.setState({vesselSearchOptions:t})}catch(t){console.log("MarineDispatchDetailsComposite:Error occured on handleVesselSearchChange",t)}},this.handleInputDataEdit=(e,t)=>{var a=I().cloneDeep(this.state.modMarineCompartmentDetails);a.forEach((a=>{a.CompartmentSeqNoInVehicle===t.CompartmentSeqNoInVehicle&&(a.AdjustmentToPlannedQuantity=e)})),this.setState({modMarineCompartmentDetails:a})},this.compartmentDetailsSave=()=>{for(var e=[],t={messageType:"critical",message:"ViewMarineShipmentList_CompartmentDetailsStatus",messageResultDetails:[{keyFields:["Marine_ShipmentCompDetail_ShipmentNumber"],keyValues:[this.state.modMarineDispatch.DispatchCode],isSuccess:!1,errorMessage:""}]},a=0;a<this.state.modMarineCompartmentDetails.length;a++){var i=this.state.modMarineDispatch.DispatchCode,s=this.state.modMarineCompartmentDetails[a].AdjustmentToPlannedQuantity;null!==s&&(s=h.bo(s));var o={keyDataCode:this.state.modMarineCompartmentDetails[a].CompartmentSeqNoInVehicle,KeyCodes:[{Key:v.yI,Value:i},{key:v._j,value:this.state.modMarineCompartmentDetails[a].CompartmentSeqNoInVehicle},{key:v.fR,value:s},{key:v.je,value:this.state.modMarineCompartmentDetails[a].forceComplete}]};e.push(o)}S()(R.oY,h.tW(e,this.props.tokenDetails.tokenInfo)).then((e=>{var a=e.data;a.IsSuccess?(t.messageType="success",t.messageResultDetails[0].isSuccess=a.IsSuccess,this.getMarineCompartmentDetails(this.props.selectedRow),this.props.onSaved(this.state.modMarineDispatch,"UpdateCompartmentDetails",t),this.props.handlePageAdd(this.state.marineDispatch)):(t.messageResultDetails[0].errorMessage=a.ErrorList[0],this.props.onSaved(this.state.modMarineDispatch,"UpdateCompartmentDetails",t))})).catch((e=>{t.messageResultDetails[0].errorMessage=e,this.props.onSaved(this.state.modMarineDispatch,"UpdateCompartmentDetails",t),console.log("Error while compartmentDetailsSave:",e)})),this.setState({marineCompartmentDetails:this.state.modMarineCompartmentDetails,expandedCellRows:[]})},this.onBack=()=>{this.state.isCompartmentDetails?this.setState({isCompartmentDetails:!1}):this.state.isManualEntry&&this.setState({isManualEntry:!1,isCompartmentDetails:!0}),this.componentDidMount()},this.ButtonIsAvailable=(e,t)=>{var a=[{key:v.yI,value:e.Common_Code},{key:v.jz,value:t}],i={keyDataCode:v.yI,KeyCodes:a};S()(R.t5r,h.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{var{operationsVisibilty:a}={...this.state};"FORCE_COMPLETE"===t?(a.forceCompleteIsDisable=!(e.data.IsSuccess||!1===h.ab(this.props.userDetails.EntityResult.FunctionsList,b.i.modify,b.ZU)),this.setState({operationsVisibilty:a})):"ADJUST_PLAN"===t&&(a.adjustPlanIsDisable=!(e.data.IsSuccess||!1===h.ab(this.props.userDetails.EntityResult.FunctionsList,b.i.modify,b.ZU)),this.setState({operationsVisibilty:a}))})).catch((e=>{console.log("Error in get marine dispatch compartment details operations:",e)}))},this.handleCellCheck=e=>{let t=I().cloneDeep(this.state.modMarineCompartmentDetails);t.forEach((t=>{t.CompartmentSeqNoInVehicle===e.rowData.CompartmentSeqNoInVehicle&&(t.forceComplete=!t.forceComplete)})),this.setState({modMarineCompartmentDetails:t})},this.handleCarrierSearchChange=e=>{try{let t=this.state.carrierOptions.filter((t=>t.value.toLowerCase().includes(e.toLowerCase())));t.length>l.bM&&(t=t.slice(0,l.bM)),this.setState({carrierSearchOptions:t})}catch(t){console.log("MarineDispatchDetailsComposite:Error occured on handleCarrierSearchChange",t)}},this.handleSaveCompartmentDetailsEnabled=()=>{const e=-1===this.state.marineCompartmentDetails.findIndex((e=>1!==e.DispatchCompartmentStatus&&3!==e.DispatchCompartmentStatus&&4!==e.DispatchCompartmentStatus&&5!==e.DispatchCompartmentStatus)),{modMarineDispatch:t}=this.state,{operationsVisibilty:a}=this.state;return!(t.DispatchStatus!==l.Mw.QUEUED&&t.DispatchStatus!==l.Mw.PARTIALLY_LOADED&&t.DispatchStatus!==l.Mw.AUTO_LOADED&&t.DispatchStatus!==l.Mw.INTERRUPTED&&t.DispatchStatus!==l.Mw.MANUALLY_LOADED&&a.forceCompleteIsDisable&&a.adjustPlanIsDisable||this.props.userDetails.EntityResult.IsEnterpriseNode||e)},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})},this.onTabChange=e=>{1===e&&this.setState({modTankAssociations:this.state.modTankPlanAssociations}),this.props.onTabChange(e)}}getFinishedProduct(e,t){var a=I().cloneDeep(this.state.modTankPlanAssociations);if(null!==e[t.rowIndex].CustomerCode&&null!==e[t.rowIndex].FinishedProductCode&&null!==e[t.rowIndex].DestinationCode&&null!==e[t.rowIndex].Quantity){a=a.filter((a=>a.CompartmentSeqNoInVehicle!==e[t.rowIndex].CompartmentSeqNoInVehicle));var i=[{key:v.xf,value:e[t.rowIndex].FinishedProductCode}],s={ShareHolderCode:t.rowData.ShareholderCode,keyDataCode:v.xf,KeyCodes:i};S()(R.cfM,h.tW(s,this.props.tokenDetails.tokenInfo)).then((i=>{var s=i.data;if(!0===s.IsSuccess&&0!==s.EntityResult.FinishedProductItems.length){var o=s.EntityResult.FinishedProductItems,n=0;for(let e=0;e<o.length;e++)n+=o[e].Quantity;for(let i=0;i<o.length;i++){var r=I().cloneDeep(C.vs),l=o[i];r.SequenceNo=this.state.length+i+1,r.ShareholderCode=e[t.rowIndex].ShareholderCode,r.CompartmentCode=e[t.rowIndex].CompartmentCode,r.CompartmentSeqNoInVehicle=e[t.rowIndex].CompartmentSeqNoInVehicle,r.FinishedProductCode=e[t.rowIndex].FinishedProductCode,r.BaseProductCode=null===l.AdditiveCode?l.BaseProductCode:l.AdditiveCode,r.PlannedQuantity=(h.bo(e[t.rowIndex].Quantity)*l.Quantity/n).toLocaleString(),r.PlanQuantityUOM=e[t.rowIndex].QuantityUOM,r.DispatchCode=this.state.modMarineDispatch.DispatchCode,a.push(r)}this.setState({length:this.state.length+o.length})}})).catch((e=>{console.log("error in getting finishedProduct",e)}))}this.setState({modTankPlanAssociations:a})}componentWillReceiveProps(e){try{""!==this.state.marineDispatch.DispatchCode&&void 0===e.selectedRow.Common_Code&&this.props.tokenDetails.tokenInfo===e.tokenDetails.tokenInfo&&this.getMarineDispatch(e.selectedRow.Common_Code,!0)}catch(t){console.log("MarineDispatchDetailsComposite:Error occured on componentWillReceiveProps",t)}}getUoms(){S()(R.WFM,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){var a=I().cloneDeep(this.state.shipmentUOM);if(Array.isArray(t.EntityResult.VOLUME)&&(a=h.Zj(t.EntityResult.VOLUME)),Array.isArray(t.EntityResult.MASS)){h.Zj(t.EntityResult.MASS).forEach((e=>a.push(e)))}this.setState({shipmentUOM:a})}}else console.log("Error in GetUOMList:",t.ErrorList)})).catch((e=>{console.log("Error while getting GetUOMList:",e)}))}getVessel(e,t){let a=I().cloneDeep(this.state.modMarineDispatch),i=I().cloneDeep(this.state.modVehicleDetails);a.VesselCode=e;let s=[{key:v.ok,value:e},{key:v.v6,value:l.LY.MARINE},{key:v._n,value:a.CarrierCode}],o={ShareHolderCode:this.props.selectedShareholder,keyDataCode:v.ok,KeyCodes:s};S()(R.zRL,h.tW(o,this.props.tokenDetails.tokenInfo)).then((e=>{let s=e.data;if(!0===s.IsSuccess){if(null!==s.EntityResult){i.carrierCode=s.EntityResult.CarrierCompanyCode,i.vehicleCompartments=this.getCompartmentDetailsFromVehicle(s.EntityResult);let e=[];if(i.vehicleCompartments.forEach((t=>e.push({text:t.vehCompSeq.toString(),value:t.vehCompSeq.toString()}))),t){this.setState({modTankAssociations:[]});let e=this.getShipmentCompartmentFromVehicleCompartment(i.vehicleCompartments);null!=this.state.modMarineDispatch.QuantityUOM&&""!==this.state.modMarineDispatch.QuantityUOM&&e.forEach((e=>{e.QuantityUOM=this.state.modMarineDispatch.QuantityUOM})),null!==this.state.modMarineDispatch.DispatchCode&&""!==this.state.modMarineDispatch.DispatchCode&&e.forEach((e=>{e.DispatchCode=this.state.modMarineDispatch.DispatchCode})),this.setState({modAssociations:e},(()=>{var e=I().cloneDeep(this.state.modMarineDispatch.TerminalCodes);if(!1===this.props.userDetails.EntityResult.IsEnterpriseNode){var t=I().cloneDeep(this.state.compartmentAttributeMetaDataList);t.length>0&&this.formCompartmentAttributes([t[0].TerminalCode])}else void 0!==e&&null!==e&&this.formCompartmentAttributes(e)}))}if(this.setState({modMarineDispatch:a,modVehicleDetails:i,compSeqOptions:e}),this.state.marineDispatch.VehicleCode===a.VehicleCode){let e=I().cloneDeep(i);this.setState({vehicleDetails:e})}}}else this.setState({modMarineDispatch:a}),console.log("Error in GetVehicle:",s.ErrorList)})).catch((e=>{console.log("Error in getVessel:",e)}))}getCompartmentDetailsFromVehicle(e){let t=[],a=1;return e.VehicleTrailers.forEach((e=>{if(Array.isArray(e.Trailer.Compartments))for(let i=0;i<e.Trailer.Compartments.length;i++){let s=e.Trailer.Compartments[i],o={compCode:s.Code,vehCompSeq:a,trailerCode:s.TrailerCode,trailerCompSeq:s.CompartmentSeqNoInTrailer,SFL:s.Capacity,UOM:s.UOM};t.push(o),a+=1}})),t}getShipmentCompartmentFromVehicleCompartment(e){let t=[];try{if(Array.isArray(e))for(let a=0;a<e.length;a++){let i=e[a],s={AssociatedContractItems:null,AssociatedOrderItems:null,Attributes:[],CarrierCompanyCode:null,CompartmentCode:i.compCode,CompartmentSeqNoInVehicle:i.vehCompSeq,CustomerCode:null,DestinationCode:null,DispatchCode:null,FinishedProductCode:null,Quantity:null!==i.SFL&&""!==i.SFL?i.SFL.toLocaleString():null,QuantityUOM:i.UOM,SequenceNo:i.trailerCompSeq,ShareholderCode:this.props.selectedShareholder,TrailerCode:i.trailerCode,attributesForUI:this.state.modAssociations.attributesForUI,TerminalCodes:this.state.modMarineDispatch.TerminalCodes};t.push(s)}}catch(a){console.log("error in getShipmentCompartmentFromVehicleCompartment",a)}return t}getVehicleCodes(){S()(R.FKP+"?Transportationtype="+l.LY.MARINE,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){var a=I().cloneDeep(this.state.vessels);t.EntityResult.forEach((e=>{a.push({text:e,value:e})}));let e=I().cloneDeep(a);e.length>l.bM&&(e=e.slice(0,l.bM)),this.setState({vessels:a,vesselSearchOptions:e})}}else console.log("Error in getVehicleCodes:",t.ErrorList)})).catch((e=>{console.log("Error while getting Vessel List:",e)}))}getFinishedProductCodes(e){try{S()(R.Ypw+"?ShareholderCode="+e+"&Transportationtype="+l.LY.MARINE,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){var a=I().cloneDeep(this.state.FinishedProducts);a=t.EntityResult,this.setState({FinishedProducts:a})}}else console.log("Error in GetFinishedProductCodes:",t.ErrorList)})).catch((e=>{console.log("Error while GetFinishedProductCodes List:",e)}))}catch(t){console.log("GetFinishedProductCodes:Error occured on GetFinishedProductCodes",t)}}getTankListForRole(e){var t=this.props.userDetails.EntityResult.PrimaryShareholder;S()(R.eX4+"?ShareholderCode="+t,h.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var a=t.data;if(!0===a.IsSuccess){var i=[],s=a.EntityResult.Table;if(this.props.userDetails.EntityResult.IsEnterpriseNode)if(""===e)for(let e=0;e<s.length;e++)i.push(s[e].Common_Code);else{s=s.filter((t=>t.TerminalCode===e));for(let e=0;e<s.length;e++)i.push(s[e].Common_Code)}else for(let e=0;e<s.length;e++)i.push(s[e].Common_Code);i=h.Zj(i),this.setState({tankCodeOptions:i})}else this.setState({tankCodeOptions:[]}),console.log("Error in getTankListForRole:",a.ErrorList)})).catch((e=>{this.setState({tankCodeOptions:[]}),console.log("Error while getting TankListForRole:",e)}))}getCustomerDestinations(e){S()(R.E6k+"?ShareholderCode="+e+"&TransportationType="+l.LY.MARINE,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess)if(Array.isArray(t.EntityResult)){t.EntityResult.length>0?this.setState({shareholderCustomers:t.EntityResult}):console.log("no customers identified for shareholder")}else console.log("customerdestinations not identified for shareholder")})).catch((e=>{console.log("Error while getting Customer List:",e)}))}getMarineDispatchProductAllocationDetails(e){var t=I().cloneDeep(e);S()(R.U5z+"?ShipmentCode="+t.Common_Code+"&TransportationType=MARINE",h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?null===t.EntityResult?this.setState({productAllocationDetails:[]}):this.setState({productAllocationDetails:t.EntityResult.Table}):this.setState({productAllocationDetails:[]})})).catch((e=>{this.setState({productAllocationDetails:[]}),console.log("Error while getting MarineDispatchProductAllocationDetails:",e)}))}componentDidMount(){try{h.pJ(this.props.userDetails.EntityResult.IsArchived),this.getUoms(),this.getFinishedProductCodes(""),this.getCustomerDestinations(""),this.getBaseProductList(),this.getAdditivesList(),this.getLookUpData(),this.getMarineShipmentPlan(this.props.selectedRow),this.getMarineCompartmentDetails(this.props.selectedRow),this.ButtonIsAvailable(this.props.selectedRow,"FORCE_COMPLETE"),this.ButtonIsAvailable(this.props.selectedRow,"ADJUST_PLAN"),this.getCarrierList(),this.getCarrierShareholder(),this.getBond(),this.getMarineDispatchProductAllocationDetails(this.props.selectedRow);let e=!1;void 0===this.props.selectedRow.Common_Code&&(e=!0),this.getAttributes(e)}catch(e){console.log("MarineDispatchDetailsComposite:Error occured on componentDidMount",e)}}getBond(){S()(R.G0M+"?ShareHolderCode="+this.props.selectedShareholder,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){let e=!1;"True"===t.EntityResult&&(e=!0),this.setState({isBondShow:e})}else console.log("Error in getLookUpData: ",t.ErrorList)})).catch((e=>{console.log("MarineDispatchDetailsComposite: Error occurred on getLookUpData",e)}))}getLookUpData(){S()(R.xAA+"?LookUpTypeCode=HSEInspection",h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){let e=!1;"True"===t.EntityResult.EnableMarine&&(e=!0),this.setState({isHSEInspectionEnable:e})}else console.log("Error in getLookUpData: ",t.ErrorList)})).catch((e=>{console.log("MarineDispatchDetailsComposite: Error occurred on getLookUpData",e)}))}getAttributes(e){try{S()(R.fKH,h.tW([x.cf,x.lA],this.props.tokenDetails.tokenInfo)).then((t=>{var a=t.data;!0===a.IsSuccess?(void 0===a.EntityResult.marineDispatch&&(a.EntityResult.marineDispatch=[]),this.setState({attributeMetaDataList:I().cloneDeep(a.EntityResult.MARINEDISPATCH),attributeValidationErrors:h.Fl(a.EntityResult.MARINEDISPATCH),compartmentAttributeMetaDataList:I().cloneDeep(a.EntityResult.MARINEDISPATCHCOMPARTMENTDETAIL)},(()=>{this.getMarineDispatch(this.props.selectedRow.Common_Code,e)}))):console.log("Failed to get Attributes")}))}catch(t){console.log("Error while getting Attributes:",t)}}getShareholders(){return h.Zj(this.props.userDetails.EntityResult.ShareholderList)}getMarineDispatch(e,t){C.Y0.QuantityUOM=this.props.userDetails.EntityResult.PageAttibutes.DefaultQtyUOMForTransactionUI.MARINE,C.Y0.TerminalCodes=1===this.props.terminalCodes.length?[...this.props.terminalCodes]:[];var a=this.getTransportationType();if(C.Y0.TransportationType=a,t){void 0!==C.Y0.TerminalCodes&&null!==C.Y0.TerminalCodes&&0!==C.Y0.TerminalCodes.length?this.getTankListForRole(C.Y0.TerminalCodes[0]):this.getTankListForRole("");let e=[];return this.handleResetAttributeValidationError(),void this.setState({marineDispatch:I().cloneDeep(C.Y0),modMarineDispatch:I().cloneDeep(C.Y0),modAssociations:[],modTankAssociations:[],isReadyToRender:!0,terminalOptions:e,isNewDispatch:!0,selectedAttributeList:[],saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,b.i.add,b.QB)},(()=>{!1===this.props.userDetails.EntityResult.IsEnterpriseNode&&this.localNodeAttribute()}))}var i=[{key:v.yI,value:e},{key:v.v6,value:a}],s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:v.yI,KeyCodes:i};S()(R.FDo,h.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){var a=[];for(let e=0;e<t.EntityResult.DispatchCompartmentPlanList.length;e++){var i=[{key:v.xf,value:t.EntityResult.DispatchCompartmentPlanList[e].FinishedProductCode}],s={ShareHolderCode:t.EntityResult.DispatchCompartmentPlanList[e].ShareholderCode,keyDataCode:v.xf,KeyCodes:i};S()(R.cfM,h.tW(s,this.props.tokenDetails.tokenInfo)).then((i=>{var s=i.data;if(!0===s.IsSuccess){var o=s.EntityResult.FinishedProductItems,n=0;for(let e=0;e<s.EntityResult.FinishedProductItems.length;e++)n+=s.EntityResult.FinishedProductItems[e].Quantity;for(let i=0;i<s.EntityResult.FinishedProductItems.length;i++){var r=I().cloneDeep(C.vs);r.DispatchCode=t.EntityResult.DispatchCode,r.ShareholderCode=t.EntityResult.DispatchCompartmentPlanList[e].ShareholderCode,r.CompartmentSeqNoInVehicle=t.EntityResult.DispatchCompartmentPlanList[e].CompartmentSeqNoInVehicle,r.FinishedProductCode=t.EntityResult.DispatchCompartmentPlanList[e].FinishedProductCode,r.BaseProductCode=null===o[i].AdditiveCode?o[i].BaseProductCode:o[i].AdditiveCode,r.PlanQuantityUOM=t.EntityResult.DispatchCompartmentPlanList[e].PlanQuantityUOM,r.CompartmentCode=t.EntityResult.DispatchCompartmentPlanList[e].CompartmentCode,r.TankCode=null!==t.EntityResult.DispatchCompartmentPlanList[e].DispatchCompartmentTanks&&0!==t.EntityResult.DispatchCompartmentPlanList[e].DispatchCompartmentTanks.length?t.EntityResult.DispatchCompartmentPlanList[e].DispatchCompartmentTanks[i].TankCode:"",r.PlannedQuantity=null!==t.EntityResult.DispatchCompartmentPlanList[e].DispatchCompartmentTanks&&""!==t.EntityResult.DispatchCompartmentPlanList[e].DispatchCompartmentTanks&&0!==t.EntityResult.DispatchCompartmentPlanList[e].DispatchCompartmentTanks.length?t.EntityResult.DispatchCompartmentPlanList[e].DispatchCompartmentTanks[i].PlannedQuantity.toLocaleString():(t.EntityResult.DispatchCompartmentPlanList[e].PlannedQuantity*(o[i].Quantity/n)).toLocaleString(),r.SequenceNo=this.state.length+i+1;var d=[],c=I().cloneDeep(C.PV);c.CompartmentCode=t.EntityResult.DispatchCompartmentPlanList[e].CompartmentCode,c.CompartmentSeqNoInVehicle=t.EntityResult.DispatchCompartmentPlanList[e].CompartmentSeqNoInVehicle,c.PlannedQuantity=null!==t.EntityResult.DispatchCompartmentPlanList[e].DispatchCompartmentTanks&&""!==t.EntityResult.DispatchCompartmentPlanList[e].DispatchCompartmentTanks&&0!==t.EntityResult.DispatchCompartmentPlanList[e].DispatchCompartmentTanks.length?t.EntityResult.DispatchCompartmentPlanList[e].DispatchCompartmentTanks[i].PlannedQuantity.toLocaleString():t.EntityResult.DispatchCompartmentDetailPlanList[e].Quantity*(o[i].Quantity/n),c.PlanQuantityUOM=t.EntityResult.DispatchCompartmentPlanList[e].PlanQuantityUOM,c.DispatchCode=t.EntityResult.DispatchCompartmentPlanList[e].DispatchCode,c.TankCode=0===t.EntityResult.DispatchCompartmentPlanList[e].DispatchCompartmentTanks.length?"":t.EntityResult.DispatchCompartmentPlanList[e].DispatchCompartmentTanks[i].TankCode,d.push(c),r.DispatchCompartmentTanks=d,a.push(r)}this.setState({length:this.state.length+o.length},(()=>{if(e===t.EntityResult.DispatchCompartmentPlanList.length-1){let e=I().cloneDeep(t.EntityResult);e.HSEInspectionStatus=h.cd(l.sL,e.HSEInspectionStatus),this.setState({isReadyToRender:!0,marineDispatch:e,isNewDispatch:!1,modMarineDispatch:I().cloneDeep(e),modAssociations:this.getAssociationsFromDispatch(t.EntityResult),modTankAssociations:a,modTankPlanAssociations:a,tempModTankAssociations:a,saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,b.i.modify,b.QB)&&this.props.updateEnableForConfigure},(()=>{void 0!==e.TerminalCodes&&null!==e.TerminalCodes&&0!==e.TerminalCodes.length?this.getTankListForRole(e.TerminalCodes[0]):this.getTankListForRole(""),this.getVesselsByCarrier(this.props.selectedShareholder),this.getVessel(t.EntityResult.VesselCode,!1),this.getKPIList(t.EntityResult.DispatchCode),this.props.userDetails.EntityResult.IsEnterpriseNode?this.terminalSelectionChange(t.EntityResult.TerminalCodes):this.localNodeAttribute()}))}e===this.state.modAssociations.length-1&&this.setState({length:0})}))}else this.setState({finishedProductItems:[]})}))}}else this.setState({isNewDispatch:!1,marineDispatch:I().cloneDeep(C.Y0),modMarineDispatch:I().cloneDeep(C.Y0),isReadyToRender:!0}),console.log("Error in GetMarineDispatch:",t.ErrorList)})).catch((e=>{console.log("Error while getting marineDispatch:",e)}))}handleResetAttributeValidationError(){try{var e=I().cloneDeep(this.state.attributeMetaDataList);this.setState({attributeValidationErrors:h.Fl(e)})}catch(t){console.log("TrailerDetailsComposite:Error occured on handleResetAttributeValidationError",t)}}localNodeAttribute(){try{var e=I().cloneDeep(this.state.attributeMetaDataList);if(Array.isArray(e)&&e.length>0)this.terminalSelectionChange([e[0].TerminalCode]);else{var t=I().cloneDeep(this.state.compartmentAttributeMetaDataList);Array.isArray(t)&&t.length>0&&this.formCompartmentAttributes([t[0].TerminalCode])}}catch(a){console.log("TrailerDetailsComposite:Error occured on localNodeAttribute",a)}}terminalSelectionChange(e){try{if(null!==e&&void 0!==e){let s=[];var t=[],a=[];t=I().cloneDeep(this.state.attributeMetaDataList),a=I().cloneDeep(this.state.selectedAttributeList);const o=I().cloneDeep(this.state.attributeValidationErrors);var i=I().cloneDeep(this.state.modMarineDispatch);null!==e&&e.forEach((e=>{var o=a.find((t=>t.TerminalCode===e));void 0===o?t.forEach((function(t){if(t.TerminalCode===e){var a=i.Attributes.find((t=>t.TerminalCode===e));void 0!==a&&t.attributeMetaDataList.forEach((function(e){var t=a.ListOfAttributeData.find((t=>t.AttributeCode===e.Code));void 0!==t&&(e.DefaultValue=t.AttributeValue)})),s.push(t)}})):s.push(o)})),a=[],a=s,o.forEach((t=>{void 0===e.find((e=>t.TerminalCode===e))&&Object.keys(t.attributeValidationErrors).forEach((e=>t.attributeValidationErrors[e]=""))})),""!==e&&void 0!==a&&this.formCompartmentAttributes(e),this.setState({selectedAttributeList:a,attributeValidationErrors:o},(()=>{}))}}catch(s){console.log("TrailerDetailsComposite:Error occured on terminalSelectionChange",s)}}formCompartmentAttributes(e){try{let t=I().cloneDeep(this.state.compartmentAttributeMetaDataList);t=t.filter((function(t){return e.some((function(e){return t.TerminalCode===e}))}));let a=I().cloneDeep(this.state.modAssociations),i=[];t.forEach((e=>{e.attributeMetaDataList.forEach((e=>{i.push({AttributeCode:e.Code,AttributeName:e.DisplayName,AttributeValue:e.DefaultValue,TerminalCode:e.TerminalCode,IsMandatory:e.IsMandatory,DataType:e.DataType,IsReadonly:e.IsReadonly,compSequenceNo:""})}))}));let s=I().cloneDeep(i);a.forEach((t=>{if(null!==t.CompartmentCode||null!==t.AttributesforUI&&void 0!==t.AttributesforUI){null!==t.AttributesforUI&&void 0!==t.AttributesforUI?(t.AttributesforUI=t.AttributesforUI.filter((function(t){return e.some((function(e){return t.TerminalCode===e}))})),i=i.filter((function(e){return!t.AttributesforUI.some((function(t){return e.TerminalCode===t.TerminalCode}))}))):t.AttributesforUI=[];let a=I().cloneDeep(i);if(Array.isArray(t.Attributes)&&null!==t.Attributes&&void 0!==t.Attributes&&t.Attributes.length>0){t.Attributes.filter((function(t){return e.some((function(e){return t.TerminalCode===e}))})).forEach((e=>{e.ListOfAttributeData.forEach((t=>{let i=a.findIndex((a=>a.TerminalCode===e.TerminalCode&&a.AttributeCode===t.AttributeCode));i>=0&&(a[i].AttributeValue=t.AttributeValue)}))})),a.forEach((e=>{e.compSequenceNo=t.CompartmentSeqNoInVehicle,t.AttributesforUI.push(e)}))}else{I().cloneDeep(i).forEach((e=>{e.compSequenceNo=t.CompartmentSeqNoInVehicle,t.AttributesforUI.push(e)}))}}else t.AttributesforUI=[],s.forEach((e=>{e.compSequenceNo=t.CompartmentSeqNoInVehicle,t.AttributesforUI.push(e)}));this.toggleExpand(t,!0,!0),t.AttributesforUI=h.Q3(t.AttributesforUI)})),this.setState({modAssociations:a})}catch(t){console.log("TrailerDetailsComposite:Error in forming Compartment Attributes",t)}}getTerminalsForCarrier(e){if(this.props.userDetails.EntityResult.IsEnterpriseNode){const a=I().cloneDeep(this.state.modMarineDispatch);let i=[...this.state.terminalCodes];a.CarrierCode=e,a.VesselCode="",a.modAssociations=[];try{if(void 0===e)return i=[],a.TerminalCodes=[],void this.setState({terminalCodes:i,modMarineDispatch:a});let t=[{key:v._n,value:e},{key:v.v6,value:l.LY.MARINE}],s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:v._n,KeyCodes:t};S()(R.pm$,h.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;!0===t.IsSuccess&&null!==t.EntityResult&&null!==t.EntityResult.TerminalCodes?(i=[...t.EntityResult.TerminalCodes],this.setState({terminalCodes:i})):(i=[],this.setState({terminalCodes:i}));let a={...this.state.modMarineDispatch};void 0!==a.ReceiptCode&&""!==a.ReceiptCode&&null!==a.ReceiptCode||(1===i.length?a.TerminalCodes=[...i]:a.TerminalCodes=[]),Array.isArray(a.TerminalCodes)&&(a.TerminalCodes=i.filter((e=>a.TerminalCodes.includes(e)))),this.setState({modMarineDispatch:a},(()=>this.terminalSelectionChange(a.TerminalCodes)))})).catch((t=>{i=[],a.TerminalCodes=[],this.setState({terminalCodes:i,modMarineDispatch:a},(()=>this.formCompartmentAttributes([]))),console.log("Error while getting Carrier:",t,e)}))}catch(t){i=[],a.TerminalCodes=[],this.setState({terminalCodes:i,modMarineDispatch:a},(()=>this.formCompartmentAttributes([]))),console.log("TrailerDetailsComposite:Error occured on handleCarrierChange",t)}}else this.formCompartmentAttributes([])}fillAttributeDetails(e){try{let t=I().cloneDeep(this.state.selectedAttributeList);return e.Attributes=[],t.forEach((t=>{let a={ListOfAttributeData:[]};a.TerminalCode=t.TerminalCode,t.attributeMetaDataList.forEach((e=>{a.ListOfAttributeData.push({AttributeCode:e.Code,AttributeValue:e.DefaultValue})})),e.Attributes.push(a)})),e.DispatchCompartmentDetailPlanList.forEach((t=>{let a=[];if(this.props.userDetails.EntityResult.IsEnterpriseNode)a=I().cloneDeep(e.TerminalCodes);else{var i=I().cloneDeep(this.state.compartmentAttributeMetaDataList);i.length>0&&(a=[i[0].TerminalCode])}let s=[];t.Attributes=[],void 0!==a&&null!==a&&a.forEach((e=>{null!==t.AttributesforUI&&void 0!==t.AttributesforUI&&(s=t.AttributesforUI.filter((function(t){return t.TerminalCode===e})));let a={ListOfAttributeData:[]};a.TerminalCode=e,s.forEach((e=>{""===e.AttributeValue&&!0!==e.IsMandatory||a.ListOfAttributeData.push({AttributeCode:e.AttributeCode,AttributeValue:e.AttributeValue})})),null!==a.ListOfAttributeData&&void 0!==a.ListOfAttributeData&&a.ListOfAttributeData.length>0&&t.Attributes.push(a)}))})),this.setState({modMarineDispatch:e}),e}catch(t){console.log("MarineDispatchDetailsComposite:Error occured on fillAttributeDetails",t)}}getTransportationType(){var e=l.LY.MARINE;const{genericProps:t}=this.props;return void 0!==t&&void 0!==t.transportationType&&(e=t.transportationType),e}validateSave(e){var t=I().cloneDeep(this.state.validationErrors);Object.keys(u.FQ).forEach((function(a){void 0!==e[a]&&(t[a]=h.jr(u.FQ[a],e[a]))})),e.Active!==this.state.marineDispatch.Active&&(null!==e.Remarks&&""!==e.Remarks||(t.Remarks="Marine_ShipmentCompDetail_RemarksRequired"));let a={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[]};if(Array.isArray(e.DispatchCompartmentDetailPlanList)&&e.DispatchCompartmentDetailPlanList.length>0?e.DispatchCompartmentDetailPlanList.forEach((t=>{f.eP.forEach((i=>{let s="";void 0!==i.validator&&(s=h.jr(i.validator,t[i.field])),""!==s&&a.messageResultDetails.push({keyFields:["Marine_ShipmentCompDetail_ShipmentNumber",i.displayName],keyValues:[e.DispatchCode,t[i.field]],isSuccess:!1,errorMessage:s})}))})):a.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"ERRMSG_MARINESHIPMENT_COMP_DETAIL_PLAN_LIST_EMPTY"}),[...new Set(e.DispatchCompartmentDetailPlanList.map((e=>e.CompartmentSeqNoInVehicle.toString())))].length!==e.DispatchCompartmentDetailPlanList.length)return a.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"ERRMSG_RAILDISPATCH_ITEMPLAN_DUPLICATE"}),this.props.onSaved(this.state.modMarineDispatch,"update",a),!1;var i=I().cloneDeep(this.state.attributeValidationErrors);I().cloneDeep(this.state.selectedAttributeList).forEach((e=>{i.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.attributeMetaDataList.forEach((e=>{t.attributeValidationErrors[e.Code]=h.I5(e,e.DefaultValue)}))}))})),this.setState({validationErrors:t,attributeValidationErrors:i});var s=!0;return i.forEach((e=>{if(!s)return s;s=Object.values(e.attributeValidationErrors).every((function(e){return""===e}))})),s?(s=Object.values(t).every((function(e){return""===e})),a.messageResultDetails.length>0?(this.props.onSaved(this.state.modMarineDispatch,"update",a),!1):s):s}saveMarineDispatch(e){let t=I().cloneDeep(this.state.modMarineDispatch);t.DispatchCompartmentDetailPlanList=this.getCompartmentFromAssociations(this.state.modAssociations);let a=this.fillAttributeDetails(t);if(this.validateSave(a)){t.DispatchCompartmentDetailPlanList=t.DispatchCompartmentDetailPlanList.map((e=>(e.Quantity=h.bo(e.Quantity),e))),t.DispatchCompartmentPlanList=this.getTankPlanFromTankAssociations(e);let a=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,i=I().cloneDeep(t);this.setState({showAuthenticationLayout:a,tempMarineDispatch:i},(()=>{!1===a&&this.addUpdateMarineDispatch()}))}else this.setState({saveEnabled:!0})}createMarineDispatch(e){this.handleAuthenticationClose(),e.DispatchCompartmentDetailPlanList.forEach((t=>{t.QuantityUOM=e.QuantityUOM}));var t=[{key:v.yI,value:e.DispatchCode}],a={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:v.yI,KeyCodes:t,Entity:e},i={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[{keyFields:["Marine_ShipmentCompDetail_ShipmentNumber"],keyValues:[e.DispatchCode],isSuccess:!1,errorMessage:""}]};S()(R.rnP,h.tW(a,this.props.tokenDetails.tokenInfo)).then((t=>{var a=t.data;i.messageType=a.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=a.IsSuccess,!0===a.IsSuccess?this.props.handlePageAdd(e):(i.messageResultDetails[0].errorMessage=a.ErrorList[0],this.setState({saveEnabled:!0}),console.log("Error in CreateMarineDispatch:",a.ErrorList)),this.props.onSaved(e,"add",i)})).catch((e=>{this.setState({saveEnabled:!0}),i.messageResultDetails[0].errorMessage=e,this.props.onSaved(this.state.modMarineDispatch,"add",i)}))}updateMarineDispatch(e){this.handleAuthenticationClose(),e.DispatchCompartmentDetailPlanList.forEach((t=>{t.QuantityUOM=e.QuantityUOM})),Array.isArray(e.DispatchItemPlanList)&&e.DispatchItemPlanList.forEach((t=>{t.QuantityUOM=e.QuantityUOM}));var t=[{key:v.yI,value:e.DispatchCode}],a={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:v.yI,KeyCodes:t,Entity:e},i={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[{keyFields:["Marine_ShipmentCompDetail_ShipmentNumber"],keyValues:[e.DispatchCode],isSuccess:!1,errorMessage:""}]};S()(R.sN,h.tW(a,this.props.tokenDetails.tokenInfo)).then((t=>{var a=t.data;i.messageType=a.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=a.IsSuccess,!0===a.IsSuccess?this.props.handlePageAdd(e):(this.setState({saveEnabled:!0}),i.messageResultDetails[0].errorMessage=a.ErrorList[0],console.log("Error in UpdateMarineDispatch:",a.ErrorList)),this.props.onSaved(e,"update",i)})).catch((t=>{i.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"modify",i),this.setState({saveEnabled:!0})}))}getAssociationsFromDispatch(e){e.DispatchCompartmentDetailPlanList.sort(((e,t)=>e.CompartmentSeqNoInVehicle>t.CompartmentSeqNoInVehicle?1:e.CompartmentSeqNoInVehicle<t.CompartmentSeqNoInVehicle?-1:0));let t=[];try{Array.isArray(e.DispatchCompartmentDetailPlanList)&&e.DispatchCompartmentDetailPlanList.forEach((e=>t.push({AssociatedContractItems:e.AssociatedContractItems,AssociatedOrderItems:e.AssociatedOrderItems,Attributes:e.Attributes,CarrierCompanyCode:e.CarrierCompanyCode,CompartmentCode:e.CompartmentCode,CompartmentSeqNoInVehicle:e.CompartmentSeqNoInVehicle,CustomerCode:e.CustomerCode,DestinationCode:e.DestinationCode,DispatchCode:e.DispatchCode,FinishedProductCode:e.FinishedProductCode,Quantity:null!==e.Quantity&&""!==e.Quantity?e.Quantity.toLocaleString():null,QuantityUOM:e.QuantityUOM,SequenceNo:e.CompartmentSeqNoInVehicle,ShareholderCode:e.ShareholderCode,TrailerCode:e.TrailerCode})))}catch(a){console.log("error in getAssociationsFromDispatch",a)}return t}getCompartmentFromAssociations(e){let t=[];return Array.isArray(e)&&e.forEach((e=>{(null!==e.FinishedProductCode&&""!==e.FinishedProductCode||null!==e.CustomerCode&&""!==e.CustomerCode||null!==e.DestinationCode&&""!==e.DestinationCode)&&t.push({AssociatedContractItems:e.AssociatedContractItems,AssociatedOrderItems:e.AssociatedOrderItems,Attributes:e.Attributes,AttributesforUI:e.AttributesforUI,CarrierCompanyCode:e.CarrierCompanyCode,CompartmentCode:e.CompartmentCode,CompartmentSeqNoInVehicle:e.CompartmentSeqNoInVehicle,CustomerCode:e.CustomerCode,DestinationCode:e.DestinationCode,DispatchCode:this.state.modMarineDispatch.DispatchCode,FinishedProductCode:e.FinishedProductCode,Quantity:e.Quantity,QuantityUOM:e.QuantityUOM,SequenceNo:e.SequenceNo,ShareholderCode:e.ShareholderCode,TrailerCode:e.TrailerCode})})),t}getTankPlanFromTankAssociations(e){return Array.isArray(e)&&e.forEach((e=>{null!==e.PlannedQuantity&&""!==e.PlannedQuantity&&(e.PlannedQuantity=h.bo(e.PlannedQuantity)),null!==e.DispatchCompartmentTanks&&""!==e.DispatchCompartmentTanks&&0!==e.DispatchCompartmentTanks.length&&(e.DispatchCompartmentTanks[0].PlannedQuantity=h.bo(e.DispatchCompartmentTanks[0].PlannedQuantity))})),e}getVesselSearchOptions(){let e=I().cloneDeep(this.state.vesselSearchOptions),t=this.state.modMarineDispatch.VesselCode;if(null!==t&&""!==t&&void 0!==t){void 0===e.find((e=>e.value.toLowerCase()===t.toLowerCase()))&&e.push({text:t,value:t})}return e}getCarrierList(){S()(R.Xj6+"?ShareholderCode=&Transportationtype="+l.LY.MARINE,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){let e=h.Zj(t.EntityResult),a=I().cloneDeep(e);a.length>l.bM&&(a=a.slice(0,l.bM)),this.setState({carrierOptions:e,carrierSearchOptions:a})}}else console.log("Error in GetCarrierListForRole:",t.ErrorList)})).catch((e=>{console.log("Error while getting Carrier List:",e)}))}getVesselsByCarrier(e){if(void 0!==this.state.modMarineDispatch.CarrierCode&&null!==this.state.modMarineDispatch.CarrierCode&&void 0!==e&&null!==e){let{carrierShareholderMap:e}=this.state;S()(R.crg+"?ShareholderCode="+e.get(this.state.modMarineDispatch.CarrierCode)+"&Transportationtype="+l.LY.MARINE+"&CarrierCode="+this.state.modMarineDispatch.CarrierCode,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){var a=[];t.EntityResult.forEach((e=>{a.push({text:e,value:e})}));let e=I().cloneDeep(a);e.length>l.bM&&(e=e.slice(0,l.bM)),this.setState({vessels:a,vesselSearchOptions:e})}}else console.log("Error in getVesselCodeByCarrier:",t.ErrorList)})).catch((e=>{console.log("Error while getting Vessel List:",e)}))}}getCarrierShareholder(){S()(R.S4D+"?ShareholderCode=&Transportationtype="+l.LY.MARINE,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){let e=new Map;t.EntityResult.Table.forEach((t=>{e.set(t.Common_Code,t.Common_Shareholder)})),this.setState({carrierShareholderMap:e})}else console.log("Error in getCarrierShareholder:",t.ErrorList)})).catch((e=>{console.log("Error while getting CarrierShareholder:",e)}))}getCarrierSearchOptions(){let e=I().cloneDeep(this.state.carrierSearchOptions),t=this.state.modMarineDispatch.CarrierCode;if(null!==t&&""!==t&&void 0!==t){void 0===e.find((e=>e.value.toLowerCase()===t.toLowerCase()))&&e.push({text:t,value:t})}return e}getSaveEnabled(){var e=this.handleSaveCompartmentDetailsEnabled(),t=I().cloneDeep(this.state.saveEnabled),a=I().cloneDeep(this.props.viewTab);return 2===a?e&&h.ab(this.props.userDetails.EntityResult.FunctionsList,b.i.modify,b.QB):3!==a&&t}getKPIList(e){if(!0===h.ab(this.props.userDetails.EntityResult.FunctionsList,b.i.view,b.bL)){let t={PageName:N.RU,TransportationType:l.LY.MARINE,InputParameters:[{key:"ShipmentCode",value:e}]};S()(R.dxq,h.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({marineDispatchKPIList:t.EntityResult.ListKPIDetails}):(this.setState({marineDispatchKPIList:[]}),console.log("Error in pipeline KPIList:",t.ErrorList))})).catch((e=>{console.log("Error while getting PipelineDispatch KPIList:",e)}))}}render(){const e=this.getSaveEnabled();let t=[];try{t=[{fieldName:"Marine_ShipmentCompDetail_LastUpdated",fieldValue:new Date(this.state.modMarineDispatch.UpdatedTime).toLocaleDateString()+" "+new Date(this.state.modMarineDispatch.UpdatedTime).toLocaleTimeString()},{fieldName:"Marine_ShipmentCompDetail_CreatedTime",fieldValue:new Date(this.state.modMarineDispatch.CreatedTime).toLocaleDateString()+" "+new Date(this.state.modMarineDispatch.CreatedTime).toLocaleTimeString()},{fieldName:"Terminal_ActiveTime",fieldValue:void 0!==this.state.modMarineDispatch.LastActiveTime&&null!==this.state.modMarineDispatch.LastActiveTime?new Date(this.state.modMarineDispatch.LastActiveTime).toLocaleDateString()+" "+new Date(this.state.modMarineDispatch.LastActiveTime).toLocaleTimeString():""}]}catch(a){console.log("error in get popUpContents",a),t=[{fieldName:"Marine_ShipmentCompDetail_LastUpdated",fieldValue:new Date(this.state.modMarineDispatch.UpdatedTime)+" "+new Date(this.state.modMarineDispatch.UpdatedTime)},{fieldName:"Marine_ShipmentCompDetail_CreatedTime",fieldValue:new Date(this.state.modMarineDispatch.CreatedTime)+" "+new Date(this.state.modMarineDispatch.CreatedTime)},{fieldName:"Terminal_ActiveTime",fieldValue:void 0!==this.state.modMarineDispatch.LastActiveTime&&null!==this.state.modMarineDispatch.LastActiveTime?new Date(this.state.modMarineDispatch.LastActiveTime)+" "+new Date(this.state.modMarineDispatch.LastActiveTime):""}]}return this.state.isReadyToRender?(0,m.jsxs)("div",{children:[(0,m.jsx)(c.A,{children:(0,m.jsx)(E.A,{entityCode:this.state.marineDispatch.DispatchCode,newEntityName:"Marine_ShipmentCompDetail_NewShipmentByCompartment",popUpContents:t})}),this.state.isManualEntry?(0,m.jsx)("div",{children:(0,m.jsx)(c.A,{children:(0,m.jsx)(L.default,{dispatchCode:this.state.modMarineDispatch.DispatchCode,handleBack:this.onBack,IsBonded:this.state.modMarineDispatch.IsBonded,DispatchStatus:this.state.modMarineDispatch.DispatchStatus,QuantityUOM:this.state.modMarineDispatch.QuantityUOM,ActualTerminalCode:this.state.modMarineDispatch.ActualTerminalCode})})}):(0,m.jsxs)("div",{children:[(0,m.jsx)(k.A,{KPIList:this.state.marineDispatchKPIList,children:" "}),(0,m.jsx)(c.A,{children:(0,m.jsx)(p,{selectedRow:this.props.selectedRow,marineDispatch:this.state.marineDispatch,modMarineDispatch:this.state.modMarineDispatch,modAssociations:this.state.modAssociations,modTankAssociations:this.state.modTankAssociations,validationErrors:this.state.validationErrors,selectedAssociations:this.state.selectedAssociations,selectedTankAssociations:this.state.selectedTankAssociations,listOptions:{shareholders:this.state.shareholders,terminalCodes:this.state.terminalCodes,shipmentUOM:this.state.shipmentUOM,carrierCompany:this.getCarrierSearchOptions(),compSeqOptions:this.state.compSeqOptions,vessels:this.getVesselSearchOptions(),FinishedProducts:this.state.FinishedProducts,customerDestinationOptions:this.state.customerDestinationOptions,shareholderCustomers:this.state.shareholderCustomers,baseProductDetails:this.state.baseProductDetails,tankCodeOptions:this.state.tankCodeOptions,additiveDetails:this.state.additiveDetails},shareholderCustomers:this.state.shareholderCustomers,onFieldChange:this.handleChange,onDateTextChange:this.handleDateTextChange,handleAssociationSelectionChange:this.handleAssociationSelectionChange,handleTankAssociationSelectionChange:this.handleTankAssociationSelectionChange,handleCellDataEdit:this.handleCellDataEdit,handleTankCellDataEdit:this.handleTankCellDataEdit,handleAddAssociation:this.handleAddAssociation,handleAddTankAssociation:this.handleAddTankAssociation,handleDeleteAssociation:this.handleDeleteAssociation,handleDeleteTankAssociation:this.handleDeleteTankAssociation,onVesselSearchChange:this.handleVesselSearchChange,isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,isSlotbookinginUI:this.props.userDetails.EntityResult.ShowSlotBookedInUI,marineShipmentPlan:this.state.marineShipmentPlan,marineCompartmentDetails:this.state.marineCompartmentDetails,handleInputDataEdit:this.handleInputDataEdit,compartmentDetailsSave:this.compartmentDetailsSave,operationsVisibilty:this.state.operationsVisibilty,handleCellCheck:this.handleCellCheck,viewTab:this.props.viewTab,onTabChange:this.onTabChange,handleAttributeCellDataEdit:this.handleAttributeCellDataEdit,selectedAttributeList:this.state.selectedAttributeList,attributeValidationErrors:this.state.attributeValidationErrors,onCarrierCompanyChange:this.onCarrierCompanyChange,expandedRows:this.state.expandedRows,toggleExpand:this.toggleExpand,handleCompAttributeCellDataEdit:this.handleCompAttributeCellDataEdit,expandedCellRows:this.state.expandedCellRows,modMarineCompartmentDetails:this.state.modMarineCompartmentDetails,onCarrierSearchChange:this.handleCarrierSearchChange,isHSEInspectionEnable:this.state.isHSEInspectionEnable,isBondShow:this.state.isBondShow,compartmentDetailsPageSize:this.props.userDetails.EntityResult.PageAttibutes.WebPortalListPageSize,compDetailsTab:this.state.isNewDispatch?[]:[""],allocationTab:!1===this.state.isNewDispatch&&!1===this.props.userDetails.EntityResult.IsEnterpriseNode?[""]:[],allocationDetails:this.state.productAllocationDetails,updateEnableForConfigure:this.props.updateEnableForConfigure})}),(0,m.jsx)(c.A,{children:(0,m.jsx)(P.q,{handleBack:this.props.onBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:e})}),this.state.showAuthenticationLayout?(0,m.jsx)(w.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:""===this.state.marineDispatch.DispatchCode?b.i.add:b.i.modify,functionGroup:b.QB,handleOperation:this.addUpdateMarineDispatch,handleClose:this.handleAuthenticationClose}):null]})]}):(0,m.jsx)(M.A,{message:"Loading"})}getMarineShipmentPlan(e){void 0!==e.Common_Code?S()(R.yWy+"?MarineDispatchCode="+e.Common_Code,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({marineShipmentPlan:t.EntityResult}):console.log("Error in getMarineShipmentPlan:",t.ErrorList)})).catch((e=>{console.log("Error while getting MarineShipmentPlan:",e)})):this.setState({marineShipmentPlan:[]})}getMarineCompartmentDetails(e){void 0!==e.Common_Code?S()(R.tGc+"?MarineDispatchCode="+e.Common_Code,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){for(var a=0;a<t.EntityResult.length;a++)t.EntityResult[a]={...t.EntityResult[a],forceComplete:!1,AdjustmentToPlannedQuantity:""},t.EntityResult[a].AdjustedPlanQuantity=""!==t.EntityResult[a].AdjustedPlanQuantity&&null!==t.EntityResult[a].AdjustedPlanQuantity?t.EntityResult[a].AdjustedPlanQuantity.toLocaleString():"",t.EntityResult[a].PlannedQuantity=""!==t.EntityResult[a].PlannedQuantity&&null!==t.EntityResult[a].PlannedQuantity?t.EntityResult[a].PlannedQuantity.toLocaleString():"",t.EntityResult[a].ReturnQuantity=""!==t.EntityResult[a].ReturnQuantity&&null!==t.EntityResult[a].ReturnQuantity?t.EntityResult[a].ReturnQuantity.toLocaleString():"",t.EntityResult[a].LoadedQuantity=""!==t.EntityResult[a].LoadedQuantity&&null!==t.EntityResult[a].LoadedQuantity?t.EntityResult[a].LoadedQuantity.toLocaleString():"";this.setState({marineCompartmentDetails:t.EntityResult,modMarineCompartmentDetails:t.EntityResult})}else console.log("Error in getMarineCompartmentDetails:",t.ErrorList)})).catch((e=>{console.log("Error while getting MarineCompartmentDetails:",e)})):this.setState({marineCompartmentDetails:[]})}getTankCode(){S()(h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){const e=h.Zj(t.EntityResult);this.setState({tankCodeOptions:e})}}else console.log("Error in getTankCode:",t.ErrorList)})).catch((e=>{console.log("Error in getTankCode:",e)}))}getBaseProductList(){S()(R.mD_,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&void 0!==t.EntityResult){let e=t.EntityResult;this.setState({baseProductDetails:e})}}else console.log("Error in getBaseProductList:",t.ErrorList)})).catch((e=>{console.log("Error while getting Base Product List:",e)}))}getAdditivesList(){S()(R.Oyd,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&void 0!==t.EntityResult){let e=t.EntityResult;this.setState({additiveDetails:e})}}else console.log("Error in getAdditivesList:",t.ErrorList)})).catch((e=>{console.log("Error while getting Additives List:",e)}))}}const V=(0,A.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})),(e=>({userActions:(0,g.zH)(y,e)})))(j)}}]);
//# sourceMappingURL=5372.d6389bba.chunk.js.map