"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[9868,5841,8222],{58480:(e,t,s)=>{s.r(t),s.d(t,{default:()=>f});var a=s(65043),r=s(72711),i=s(67907),o=s(69062),l=s(65187),n=(s(35861),s(70579));function d(e){let{reportScheduleDetails:t,modreportScheduleDetails:s,validationErrors:a,listOptions:l,onReportNameChange:d,onPrinterChange:h,isEnterpriseNode:c,isWebPortalUser:p,onCheckChange:u,showReportParams:m,onParamLoad:S,paramValues:R,savedparamValues:D,parameterLoading:g}=e;return(0,n.jsx)(i.TranslationConsumer,{children:e=>(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"detailsContainer",children:(0,n.jsxs)("div",{className:"row",children:[(0,n.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,n.jsx)(r.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("ReportSchedule_ReportName"),value:s.ReportName,options:l.reportNames,onChange:e=>{d(e)},indicator:"required",error:e(a.ReportName),reserveSpace:!1,disabled:""!==t.ReportName&&void 0!==t.ReportName,search:!0,noResultsMessage:e("noResultsMessage")})}),(0,n.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,n.jsx)(r.Input,{fluid:!0,value:null===s.ScheduleName?"":s.ScheduleName,label:e("ReportSchedules_ScheduleName"),disabled:!0,indicator:"required",reserveSpace:!1})}),(0,n.jsxs)("div",{className:"col-12 col-md-6 col-lg-4 checkboxSelect",children:[(0,n.jsx)(r.Checkbox,{className:"LabelEnabled",label:e("ReportSchedules_IsEOS"),checked:s.IsEOS,onChange:e=>{u("IsEOS",e)},disabled:!1}),(0,n.jsx)(r.Checkbox,{className:"LabelEnabled",label:e("ReportSchedules_IsEOD"),checked:s.IsEOD,onChange:e=>{u("IsEOD",e)},disabled:!1}),(0,n.jsx)(r.Checkbox,{className:"LabelEnabled",label:e("ReportSchedules_IsMonthly"),checked:s.IsMonthly,onChange:e=>{u("IsMonthly",e)},disabled:!1}),(0,n.jsx)(r.Checkbox,{className:"LabelEnabled",label:e("ReportSchedules_IsWeekly"),checked:s.IsWeekly,onChange:e=>{u("IsWeekly",e)},disabled:!1})]}),(0,n.jsxs)("div",{className:"col-12 col-md-6 col-lg-4",children:[(0,n.jsx)("table",{width:"100%",children:(0,n.jsxs)("tbody",{children:[" ",(0,n.jsx)("tr",{width:"100%",children:(0,n.jsx)("td",{width:"100%",valign:"top",children:(0,n.jsx)(r.Checkbox,{className:"LabelEnabled",label:e("ReportSchedule_IsPrint"),checked:s.IsPrint,onChange:e=>{u("IsPrint",e)},disabled:!1})})}),(0,n.jsxs)("tr",{children:[" ",(0,n.jsx)("td",{width:"100%",children:(0,n.jsx)(r.Select,{fluid:!0,placeholder:"Select",value:void 0!==s.Printer&&""!==s.Printer&&s.IsPrint?o.Nc(s.Printer):[],disabled:!s.IsPrint,indicator:s.IsPrint?"required":"",options:o.Zj(l.printerList),onChange:e=>h(e),error:e(a.Printer),multiple:!0,reserveSpace:!1,search:!0,noResultsMessage:e("noResultsMessage")})})]})]})}),(0,n.jsx)("div",{className:"col-12 col-md-6 col-lg-4"})]}),(0,n.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:" "})]})}),g?(0,n.jsx)("div",{className:"authLoading parameterLoader",children:(0,n.jsx)(r.Loader,{text:" ",className:"globalLoaderPositionPosition"})}):"",m?(0,n.jsx)("div",{className:"detailsContainer",children:(0,n.jsx)("div",{className:"row",children:S()})}):""]})})}d.defaultProps={listOptions:{reportNames:[],printers:[]},isEnterpriseNode:!1,isWebPortalUser:!1};var h=s(9256),c=s(46100),p=s(40854),u=s.n(p),m=s(72067),S=s(97508),R=(s(38726),s(43503)),D=s(60446),g=s.n(D),y=s(40252),v=s(44192),E=s(80312),C=s(53536),N=s.n(C),P=(s(97105),s(62900));class b extends a.Component{constructor(){super(...arguments),this.state={reportScheduleDetails:{},modreportScheduleDetails:{},validationErrors:o.Th(v.i4),isReadyToRender:!1,saveEnabled:!1,entityType:"reportSchedule",printerList:[],reportNames:[],selectedShareholer:this.props.selectedShareholder,showReportParams:!1,parameters:[],displayParameters:[],paramValues:{},savedparamValues:{},paramOptions:{},disabledParams:{},listLoading:!0,parameterLoading:!1,showAuthenticationLayout:!1,tempReportScheduleDetails:{}},this.validateParams=e=>{let t={...this.state.validationErrors},s={...this.state.modreportScheduleDetails};!s.IsPrint||void 0!==s.Printer&&null!==s.Printer&&""!==s.Printer?t.Printer="":t.Printer="ReportSchedule_PrinterRequired",""!==s.ReportName&&null!=s.ReportName||(t.ReportName="ReportSchedule_ReportNameRequired");let a=this.validationDef;return void 0!==a&&null!=a&&Object.keys(a).forEach((function(s){void 0!==e[s]&&(t[s]=o.jr(a[s],e[s]))})),this.setState({validationErrors:t}),Object.values(t).every((function(e){return""===e}))},this.getReportParams=(e,t)=>{u()(m.B7e+"?ReportName="+e,o.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{if(e.data.IsSuccess){let s=e.data.EntityResult.Parameters,a=e.data.EntityResult.Parameters;this.paramTables=e.data.EntityResult.ReportsData;let r=N().cloneDeep(this.state.paramOptions),i=N().cloneDeep(this.state.disabledParams),l={Culture:this.props.userDetails.EntityResult.UICulture};if(this.validationDef={},this.reportName=e.data.EntityResult.ReportName,void 0!==e.data.EntityResult.UserName&&null!==e.data.EntityResult.UserName&&(l.UserName=e.data.EntityResult.UserName),void 0!==s&&null!==s){for(let e=0;e<s.length;++e)("DateTime"===s[e].ControlType||!this.props.userDetails.EntityResult.IsEnterpriseNode&&s[e].IsOnlyForEnterprise||"Shareholder"===s[e].ParamName)&&(a=a.filter((t=>t.ParamName!==s[e].ParamName)));for(let e=0;e<s.length;++e)if("DropDownList"===s[e].ControlType)if(this.validationDef[s[e].ParamName]=[],!0===s[e].Required&&this.validationDef[s[e].ParamName].push({minLength:1,errorCode:"Select_Value"}),null===s[e].DependentControls||0===s[e].DependentControls.length||1===s[e].DependentControls.length&&"Shareholder"===s[e].DependentControls[0]||1===s[e].DependentControls.length&&"Terminal"===s[e].DependentControls[0]&&!this.props.userDetails.EntityResult.IsEnterpriseNode){let t=s[e].TableName,a=s[e].FieldName,n=this.paramTables[t],d=new Set(n.map((e=>e[a])));d=[...d];let h=o.Zj(d);l[s[e].ParamName]=null,s[e].IsOnlyForEnterprise||s[e].Required||(h.unshift({text:"All",value:"0"}),l[s[e].ParamName]=0),r[s[e].ParamName]=h,i[s[e].ParamName]=!1}else{let t=[{text:"All",value:"0"}];r[s[e].ParamName]=t,i[s[e].ParamName]=!0,l[s[e].ParamName]=0,s[e].IsOnlyForEnterprise||s[e].Required||(t.unshift({text:"All",value:"0"}),l[s[e].ParamName]=0)}else if("DateTime"===s[e].ControlType){if(!0===s[e].Required){let t=[{minLength:1,errorCode:"Select_Date"},{isDate:!0,errorCode:"Valid_Date"}];this.validationDef[s[e].ParamName]=t}l[s[e].ParamName]=null}else if("Date"===s[e].ControlType){if(!0===s[e].Required){let t=[{minLength:1,errorCode:"Select_Date"},{isDate:!0,errorCode:"Valid_Date"}];this.validationDef[s[e].ParamName]=t}l[s[e].ParamName]=null}else if("Text"===s[e].ControlType){if(!0===s[e].Required){let t=[{minLength:1,errorCode:"Mandatory_Field"},{expression:"^[0-9a-zA-Z-_]+$",errorCode:"Code_ValidInputCharacters"}];this.validationDef[s[e].ParamName]=t}l[s[e].ParamName]=null}this.props.userDetails.EntityResult.IsEnterpriseNode||void 0===l||null===l||void 0===r.Terminal||null===r.Terminal||(l.Terminal=r.Terminal[0].value),void 0!==l&&null!==l&&void 0!==r.Shareholder&&null!==r.Shareholder&&(l.Shareholder=this.props.selectedShareholder);let n=s.filter((e=>"DateTime"===e.ControlType||"Date"===e.ControlType));if(void 0!==n&&null!==n&&n.length>0)for(let e=0;e<n.length;++e)l[n[e].ParamName]=g()(new Date).format("YYYY-MM-DD");void 0===t||null===t||""===t?this.setState({parameters:[...e.data.EntityResult.Parameters],paramOptions:r,disabledParams:i,paramValues:l,showReportParams:!0,validationErrors:o.Th(this.validationDef),parameterLoading:!1,displayParameters:a}):this.setState({parameters:[...e.data.EntityResult.Parameters],paramOptions:r,disabledParams:i,showReportParams:!0,validationErrors:o.Th(this.validationDef),parameterLoading:!1,displayParameters:a})}}else console.log("Get Report Params error:",e.data.ErrorList),this.setState({parameterLoading:!1,showReportParams:!1})})).catch((e=>{console.log("Error occured on get report params",e),this.setState({parameterLoading:!1,showReportParams:!1})}))},this.handleReportChange=e=>{try{this.setState({parameterLoading:!0});let t=this.state.modreportScheduleDetails;t.ReportName=e,t.ScheduleName=e+this.props.selectedShareholder,this.setState({modreportScheduleDetails:t}),this.getReportParams(e,null),this.buildReportParams()}catch(t){console.log("ReportsComposite: Error occured onhandleShowReportClick",t)}},this.handlePrinterChange=e=>{try{const t=N().cloneDeep(this.state.modreportScheduleDetails);t.Printer=e.join(","),this.setState({modreportScheduleDetails:t})}catch(t){console.log("ReportScheduleDetailsComposite:Error occured on handlePrinterChange",t)}},this.handleCheckChange=(e,t)=>{try{const s=N().cloneDeep(this.state.modreportScheduleDetails);s[e]=t,"IsPrint"!==e||t||(s.Printer=""),this.setState({modreportScheduleDetails:s})}catch(s){console.log("ReportScheduleDetailsComposite:Error occured on handleCheckChange",s)}},this.buildReportParams=()=>{let e=!1;return""!==this.state.savedparamValues&&void 0!==this.state.savedparamValues&&(e=!0),this.state.displayParameters.map((t=>"DropDownList"===t.ControlType?(0,n.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,n.jsx)(i.TranslationConsumer,{children:s=>(0,n.jsx)(r.Select,{fluid:!0,placeholder:s("FinishedProductInfo_Select"),indicator:t.Required?"required":"",label:s(t.LocalisedParamName),value:e||void 0!==this.state.paramValues[t.ParamName]&&null!==this.state.paramValues[t.ParamName]?e?this.state.savedparamValues[t.ParamName]:this.state.paramValues[t.ParamName]:"",disabled:this.state.disabledParams[t.ParamName],options:this.state.paramOptions[t.ParamName],onChange:e=>this.onDropDownChange(e,t),error:s(this.state.validationErrors[t.ParamName]),reserveSpace:!1})})}):"DateTime"===t.ControlType?"":"Text"===t.ControlType?(0,n.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,n.jsx)(i.TranslationConsumer,{children:s=>(0,n.jsx)(r.Input,{fluid:!0,value:e||null!==this.state.paramValues[t.ParamName]?e?this.state.savedparamValues[t.ParamName]:this.state.paramValues[t.ParamName]:"",onChange:e=>this.onFieldChange(t.ParamName,e),label:s(t.LocalisedParamName),error:s(this.state.validationErrors[t.ParamName]),reserveSpace:!1})})}):void 0))},this.onFieldChange=(e,t)=>{let s=N().cloneDeep(this.state.paramValues),a=N().cloneDeep(this.state.validationErrors);s[e]=t,void 0!==this.validationDef[e]&&(a[e]=o.jr(this.validationDef[e],t)),this.setState({paramValues:s,validationErrors:a})},this.onDateTextChange=(e,t,s)=>{let a=N().cloneDeep(this.state.paramValues),r=N().cloneDeep(this.state.validationErrors);r[e]=s,a[e]=t,this.setState({paramValues:a,validationErrors:r})},this.onDropDownChange=(e,t)=>{let s=N().cloneDeep(this.state.paramValues),a=N().cloneDeep(this.state.disabledParams),r=N().cloneDeep(this.state.paramOptions),i=N().cloneDeep(this.state.validationErrors);if(void 0!==e&&null!==e){s[t.ParamName]=e,void 0!==this.validationDef[t.ParamName]&&(i[t.ParamName]=o.jr(this.validationDef[t.ParamName],e));let l=t.RefreshControls;for(let e=0;e<l.length;++e){a[l[e]]=!1;let t=this.state.parameters.find((t=>{let{ParamName:s}=t;return s===l[e]})),i=this.paramTables[t.TableName],n=t.DependentControls;for(let e=0;e<n.length;++e){let t=this.state.parameters.find((t=>{let{ParamName:s}=t;return s===n[e]}));i=i.filter((a=>a[t.FieldName]===s[n[e]]))}let d=new Set(i.map((e=>e[t.FieldName])));d=[...d];let h=o.Zj(d);h.unshift({text:"All",value:"0"}),r[t.ParamName]=h}}this.setState({paramValues:s,savedparamValues:s,disabledParams:a,paramOptions:r,validationErrors:i})},this.AddUpdateReportConfig=()=>{try{this.setState({saveEnabled:!1}),this.handleAuthenticationClose();let e=N().cloneDeep(this.state.tempReportScheduleDetails);e=this.FillParams(e),""===this.state.reportScheduleDetails.ReportName?this.CreateReportSchedule(e):this.UpdateReportSchedule(e)}catch(e){console.log("Report config Composite : Error in AddUpdateReportConfig")}},this.handleSave=()=>{try{let e=N().cloneDeep(this.state.modreportScheduleDetails);if(this.validateParams(this.state.paramValues)){let t=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,s=N().cloneDeep(e);this.setState({showAuthenticationLayout:t,tempReportScheduleDetails:s},(()=>{!1===t&&this.AddUpdateReportConfig()}))}else this.setState({saveEnabled:!0})}catch(e){console.log("ReportScheduleDetailsComposite:Error occured on handleSave",e)}},this.handleReset=()=>{try{const e={...this.state.validationErrors},t=N().cloneDeep(this.state.reportScheduleDetails);Object.keys(e).forEach((function(t){e[t]=""})),this.setState({modreportScheduleDetails:{...t},validationErrors:e,displayParameters:[],paramValues:{},savedparamValues:{},paramOptions:{},disabledParams:{}})}catch(e){console.log("ReportScheduleDetailsComposite:Error occured on handleReset",e)}},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentDidMount(){try{let e=!1;void 0===this.props.selectedRow.ReportSchedules_ReportName&&(e=!0),this.getReportSchedule(e)}catch(e){console.log("ReportScheduleDetailsComposite:Error occured on componentDidMount",e)}}componentWillReceiveProps(e){try{""!==this.state.reportScheduleDetails.ReportName&&void 0===e.selectedRow.ReportSchedules_ReportName&&this.props.tokenDetails.tokenInfo===e.tokenDetails.tokenInfo&&this.getReportSchedule(!0)}catch(t){console.log("ReportScheduleDetailsComposite:Error occured on componentWillReceiveProps",t)}}getReportSchedule(e){let t;this.getReportNames(e),this.getPrintersNames(),e?this.setState({reportScheduleDetails:N().cloneDeep(c.bZ),modreportScheduleDetails:N().cloneDeep(c.bZ),showReportParams:!1,parameters:[],displayParameters:[],paramValues:{},savedparamValues:{},paramOptions:{},disabledParams:{},isReadyToRender:!0,saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,E.i.add,E.Jz)}):(t=this.state.modreportScheduleDetails,void 0!==t.ShareholderCode&&null!==t.ShareholderCode&&""!==t.ShareholderCode||(t.ShareholderCode=this.props.selectedShareholder),void 0!==t.ReportName&&null!==t.ReportName&&""!==t.ReportName||(t.ReportName=this.props.selectedRow.ReportSchedules_ReportName),u()(m.cSQ+"?ShareholderCode="+t.ShareholderCode+"&ReportName="+t.ReportName,o.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?(this.getReportParams(t.EntityResult.ReportName,t.EntityResult.ParamData),this.FillParamValuesFromDetails(t.EntityResult.ParamData),this.setState({isReadyToRender:!0,reportScheduleDetails:t.EntityResult,modreportScheduleDetails:N().cloneDeep(t.EntityResult),saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,E.i.modify,E.Jz)})):(this.setState({modreportScheduleDetails:N().cloneDeep(c.bZ),reportScheduleDetails:N().cloneDeep(c.bZ),isReadyToRender:!0}),console.log("Error in GetReportScheduleDetails:",t.ErrorList))})).catch((e=>{console.log("Error while getting report schedule:",e)})))}FillParamValuesFromDetails(e){try{let t={};if(void 0!==e&&""!==e&&e.split(",").length>2){let s=e.split(",");s.pop();for(let e=0;e<s.length-1;e+=2)t[s[e]]=s[e+1];this.setState({savedparamValues:t,paramValues:t},(()=>{this.setState({showReportParams:!0}),this.buildReportParams()}))}}catch(t){console.log("ReportScheduleDetailsComposite:Error occured on handleSave",t)}}FillParams(e){let t=Object.keys(this.state.paramValues),s="";for(let a=0;a<t.length;++a)s=s+t[a]+","+this.state.paramValues[t[a]]+",";return e.ParamData=s,e}CreateReportSchedule(e){e.ShareholderCode=this.props.selectedShareholder;var t={messageType:"critical",message:"ReportSchedule_SavedStatus",messageResultDetails:[{keyFields:["ReportSchedule_Title"],keyValues:[e.ReportName],isSuccess:!1,errorMessage:""}]};u()(m.scr,o.tW(e,this.props.tokenDetails.tokenInfo)).then((s=>{var a=s.data;t.messageType=a.IsSuccess?"success":"critical",t.messageResultDetails[0].isSuccess=a.IsSuccess,!0===a.IsSuccess?this.getReportSchedule(!1):(t.messageResultDetails[0].errorMessage=a.ErrorList[0],this.setState({saveEnabled:!0}),console.log("Error in CreateReportSchedule:",a.ErrorList)),this.props.onSaved(e,"add",t)})).catch((e=>{console.log("Error while getting GetReportList:",e)}))}UpdateReportSchedule(e){e.ShareholderCode=this.props.selectedShareholder;var t={messageType:"critical",message:"ReportSchedule_SavedStatus",messageResultDetails:[{keyFields:["ReportSchedule_Title"],keyValues:[e.ReportName],isSuccess:!1,errorMessage:""}]};u()(m.Vhx,o.tW(e,this.props.tokenDetails.tokenInfo)).then((s=>{var a=s.data;t.messageType=a.IsSuccess?"success":"critical",t.messageResultDetails[0].isSuccess=a.IsSuccess,!0===a.IsSuccess?this.getReportSchedule(!1):(t.messageResultDetails[0].errorMessage=a.ErrorList[0],this.setState({saveEnabled:!0}),console.log("Error in CreateReportSchedule:",a.ErrorList)),this.props.onSaved(e,"add",t)})).catch((e=>{console.log("Error while getting CreateReportSchedule:",e)}))}getReportNames(e){let t=null;!0===e&&(t=this.props.selectedShareholder);let s=[];u()(m.Avh+"?ShareholderCode="+t,o.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?(s=t.EntityResult,this.setState({reportNames:s})):console.log("Error in GetAllReportNames:",t.ErrorList)})).catch((e=>{console.log("Error while getting GetAllReportNames:",e)}))}getPrintersNames(){let e=[];try{u()(m.Yeq,o.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{t.data.IsSuccess?(e=t.data.EntityResult,this.setState({printerList:e})):console.log("Error:In getPrintersNames",t)}))}catch(t){console.log("ReportScheduleDetailsComposite:Error occured on getPrintersNames",t)}}render(){const e={printerList:this.state.printerList,reportNames:o.JT(this.state.reportNames)};return this.state.isReadyToRender?(0,n.jsxs)("div",{children:[(0,n.jsx)(l.A,{children:(0,n.jsx)(R.A,{entityCode:this.state.reportScheduleDetails.ReportName,newEntityName:"DriverInfo_NewReportSchedule"})}),(0,n.jsx)(l.A,{children:(0,n.jsx)(d,{reportScheduleDetails:this.state.reportScheduleDetails,modreportScheduleDetails:this.state.modreportScheduleDetails,validationErrors:this.state.validationErrors,listOptions:e,onReportNameChange:this.handleReportChange,onPrinterChange:this.handlePrinterChange,onCheckChange:this.handleCheckChange,onParamLoad:this.buildReportParams,showReportParams:this.state.showReportParams,isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,isWebPortalUser:this.props.userDetails.EntityResult.IsWebPortalUser,paramValues:this.state.paramValues,savedparamValues:this.state.savedparamValues,parameterLoading:this.state.parameterLoading})}),(0,n.jsx)(l.A,{children:(0,n.jsx)(h.q,{handleBack:this.props.onBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.saveEnabled})}),this.state.showAuthenticationLayout?(0,n.jsx)(P.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:""===this.state.reportScheduleDetails.ReportName?E.i.add:E.i.modify,functionGroup:E.Jz,handleOperation:this.AddUpdateReportConfig,handleClose:this.handleAuthenticationClose}):null]}):(0,n.jsx)(y.A,{message:"Loading"})}}const f=(0,S.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(b)},56474:(e,t,s)=>{s.r(t),s.d(t,{default:()=>P});var a=s(65043),r=s(66554),i=s(40854),o=s.n(i),l=s(72067),n=s(14159),d=(s(92342),s(97508)),h=(s(63973),s(11981)),c=s(69062),p=s(65187),u=s(80312),m=s(21808),S=s(70579);function R(e){let{tableData:t,columnDetails:s,pageSize:a,terminalsToShow:r,selectedItems:i,onSelectionChange:o,onRowClick:l}=e;return(0,S.jsx)(m.k,{tableData:t,columnDetails:s,pageSize:a,terminalsToShow:r,selectedItems:i,onSelectionChange:o,onRowClick:l})}var D=s(58480),g=s(40252),y=s(53536),v=s.n(y),E=s(46100),C=s(62900);class N extends a.Component{constructor(){super(...arguments),this.state={isDetails:"false",isReadyToRender:!1,isDetailsModified:"false",operationsVisibilty:{add:!1,delete:!1,shareholder:!0},selectedRow:{},selectedItems:[],selectedShareholder:"",data:{},showAuthenticationLayout:!1},this.handleAdd=()=>{try{var{operationsVisibilty:e}={...this.state};e.delete=!1,e.add=!1,e.shareholder=!1,this.setState({isDetails:"true",selectedRow:{},operationsVisibilty:e})}catch(t){console.log("ReportSchedule:Error occured on handleAdd",t)}},this.handleDelete=()=>{this.handleAuthenticationClose();try{var{operationsVisibilty:e}={...this.state};e.delete=!1,this.setState({operationsVisibilty:e});for(var t=[],s=[],a=[],r="",i=0;i<this.state.selectedItems.length;i++){var d=v().cloneDeep(E.bZ);d.ShareholderCode=this.state.selectedShareholder,d.ReportName=this.state.selectedItems[i].ReportSchedules_ReportName,r=r+this.state.selectedItems[i].ReportSchedules_ReportName+"-",t.push(d),a.push("ReportSchedule_Title"),s.push(this.state.selectedItems[i].ReportSchedules_ReportName)}var u={messageType:"critical",message:"ReportSchedule_DeletionStatus",messageResultDetails:[]};o()(l.vtI,c.tW(t,this.props.tokenDetails.tokenInfo)).then((t=>{var r=t.data;r.IsSuccess?(this.setState({isReadyToRender:!1}),this.getreportScheduleList(this.state.selectedShareholder),e.delete=!1,this.setState({selectedItems:[],operationsVisibilty:e,selectedRow:{}})):(e.delete=!0,this.setState({operationsVisibilty:e})),u.messageType=r.IsSuccess?"success":"critical";var i={keyFields:a,keyValues:s,isSuccess:!0,errorMessage:""};u.messageResultDetails.push(i),(0,n.toast)((0,S.jsx)(p.A,{children:(0,S.jsx)(h.A,{notificationMessage:u})}),{autoClose:"success"===u.messageType&&1e4})})).catch((e=>{console.log("Error occured while deleting:"+e);var{operationsVisibilty:t}={...this.state};t.delete=!0,this.setState({operationsVisibilty:t})}))}catch(m){console.log("ReportScheduleComposite:Error occured on handleDelet",m)}},this.handleBack=()=>{try{var{operationsVisibilty:e}={...this.state};e.add=c.ab(this.props.userDetails.EntityResult.FunctionsList,u.i.add,u.Jz),e.delete=!1,e.shareholder=!0,this.setState({isDetails:"false",selectedRow:{},selectedItems:[],operationsVisibilty:e,isReadyToRender:!1}),this.getreportScheduleList(this.state.selectedShareholder)}catch(t){console.log("ReportSchedule:Error occured on Back click",t)}},this.handleRowClick=e=>{try{var{operationsVisibilty:t}={...this.state};t.add=c.ab(this.props.userDetails.EntityResult.FunctionsList,u.i.add,u.Jz),t.delete=c.ab(this.props.userDetails.EntityResult.FunctionsList,u.i.remove,u.Jz),t.shareholder=!1,this.setState({isDetails:"true",selectedRow:e,selectedItems:[e],operationsVisibilty:t})}catch(s){console.log("ReportSchedule:Error occured on handleRowClick",s)}},this.handleSelection=e=>{try{var{operationsVisibilty:t}={...this.state};t.delete=e.length>0&&c.ab(this.props.userDetails.EntityResult.FunctionsList,u.i.remove,u.Jz),this.setState({selectedItems:e,operationsVisibilty:t})}catch(s){console.log("ReportSchedule:Error occured on handleSelection",s)}},this.savedEvent=(e,t,s)=>{try{var{operationsVisibilty:a}={...this.state};if("success"===s.messageType&&(a.add=c.ab(this.props.userDetails.EntityResult.FunctionsList,u.i.add,u.Jz),a.delete=c.ab(this.props.userDetails.EntityResult.FunctionsList,u.i.remove,u.Jz),this.setState({isDetailsModified:"true",operationsVisibilty:a})),"success"===s.messageType&&"add"===t){var r=[{ReportSchedules_ReportName:e.ReportName,Common_Shareholder:e.ShareholderCode}];this.setState({selectedItems:r})}(0,n.toast)((0,S.jsx)(p.A,{children:(0,S.jsx)(h.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4})}catch(i){console.log("ReportSchedule:Error occured on savedEvent",i)}},this.handleShareholderSelectionChange=e=>{try{let{operationsVisibilty:t}={...this.state};t.delete=!1,this.setState({selectedShareholder:e,isReadyToRender:!1,selectedItems:[],operationsVisibilty:t}),this.getreportScheduleList(e)}catch(t){console.log("ReportSchedule:Error occured on handleShareholderSelectionChange",t)}},this.authenticateDelete=()=>{try{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showAuthenticationLayout:e}),!1===e&&this.handleDelete()}catch(e){console.log("Report Schedule Composite : Error in authenticateDelete")}},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}getreportScheduleList(e){o()(l.b3i+"?Shareholder="+e,c.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({data:t.EntityResult,isReadyToRender:!0}):(this.setState({data:[],isReadyToRender:!0}),console.log("Error in GetReportScheduleListForRole:",t.ErrorList))})).catch((e=>{this.setState({data:[],isReadyToRender:!0}),console.log("Error while getting ReportSchedule List:",e)}))}componentDidMount(){try{c.pJ(this.props.userDetails.EntityResult.IsArchived);var{operationsVisibilty:e}={...this.state};e.add=c.ab(this.props.userDetails.EntityResult.FunctionsList,u.i.add,u.Jz),this.setState({operationsVisibilty:e,selectedShareholder:this.props.userDetails.EntityResult.PrimaryShareholder}),this.getreportScheduleList(this.props.userDetails.EntityResult.PrimaryShareholder)}catch(t){console.log("ReportSchedule:Error occured on ComponentDidMount",t)}}render(){return(0,S.jsxs)("div",{children:[(0,S.jsx)(p.A,{children:(0,S.jsx)(r.$,{operationsVisibilty:this.state.operationsVisibilty,breadcrumbItem:this.props.activeItem,shareholders:this.props.userDetails.EntityResult.ShareholderList,selectedShareholder:this.state.selectedShareholder,onShareholderChange:this.handleShareholderSelectionChange,onDelete:this.authenticateDelete,onAdd:this.handleAdd,handleBreadCrumbClick:this.props.handleBreadCrumbClick})}),"true"===this.state.isDetails?(0,S.jsx)(p.A,{children:(0,S.jsx)(D.default,{selectedRow:this.state.selectedRow,selectedShareholder:this.state.selectedShareholder,onBack:this.handleBack,onSaved:this.savedEvent},"ReportScheduleDetails")}):this.state.isReadyToRender?(0,S.jsx)("div",{children:(0,S.jsx)(p.A,{children:(0,S.jsx)(R,{tableData:this.state.data.Table,columnDetails:this.state.data.Column,pageSize:this.props.userDetails.EntityResult.PageAttibutes.WebPortalListPageSize,terminalsToShow:this.props.userDetails.EntityResult.PageAttibutes.NoOfTerminalsToShow,selectedItems:this.state.selectedItems,onRowClick:this.handleRowClick,onSelectionChange:this.handleSelection})})}):(0,S.jsx)(g.A,{message:"Loading"}),(0,S.jsx)(p.A,{children:(0,S.jsx)(n.ToastContainer,{hideProgressBar:!0,closeOnClick:!1,closeButton:!0,newestOnTop:!0,position:"bottom-right",toastClassName:"toast-notification-wrap"})}),this.state.showAuthenticationLayout?(0,S.jsx)(C.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:u.i.remove,functionGroup:u.Jz,handleClose:this.handleAuthenticationClose,handleOperation:this.handleDelete}):null]})}}const P=(0,d.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(N)},97105:(e,t,s)=>{s.d(t,{S:()=>a});const a={Driver:["License1ExpiryDate","License1IssueDate","License2IssueDate","License2ExpiryDate","License3IssueDate","License3ExpiryDate","HazardousLicenseExpiry"],CarrierCompany:["PermitExpiryDate"],PrimeMover:["RoadTaxNoIssueDate","RoadTaxNoExpiryDate","licenseExpiryDate"],Wagon:["LicenseExpiryDate"],Vehicle:["LicenseNoIssueDate","LicenseNoExpiryDate","RoadTaxNoIssueDate","RoadTaxNoExpiryDate","Bondexpirydate","HazardousLicenseExpiry"],Contract:["StartDate","EndDate"],ContractItem:["StartDate","EndDate"],Order:["OrderStartDate","OrderEndDate","OrderDate","DeliveryDate"],AccessCard:["ExpiryDate","IssueDate","PasswordExpiryDate"],Trailer:["HazardousLicenseExpiry"]}},35861:(e,t,s)=>{s.d(t,{F1:()=>l,i7:()=>n,r4:()=>o});var a=s(86178),r=s.n(a),i=(s(15660),s(65043),s(70579));function o(e,t){if(Array.isArray(e)){0===e.filter((e=>e.text===t)).length&&e.unshift({value:null,text:t})}return e}function l(){let e=window.navigator.userLanguage||window.navigator.language;return r().locale(e),r().localeData().longDateFormat("L")}function n(e){return(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{children:e}),(0,i.jsx)("div",{class:"ui red circular empty label badge  circle-padding"})]})}}}]);
//# sourceMappingURL=9868.219b5ff1.chunk.js.map