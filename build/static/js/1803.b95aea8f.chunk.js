"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[1803,5841,8222],{31975:(t,e,s)=>{s.r(e),s.d(e,{default:()=>b});var o=s(65043),i=s(66554),a=s(40854),l=s.n(a),r=s(72067),n=s(7523),h=s(14159),c=(s(92342),s(97508)),d=(s(63973),s(11981)),u=s(69062),p=s(65187),y=s(93779),m=s(80312),S=s(23602),C=s(78278),R=s(40252),E=s(15821),g=s(62900),D=s(70579);class A extends o.Component{constructor(){super(...arguments),this.state={isDetails:"false",isReadyToRender:!1,isDetailsModified:"false",operationsVisibilty:{add:!1,delete:!1,shareholder:!0},selectedRow:{},selectedItems:[],data:{},isEnable:!0,allocationType:"",selectedShareholder:void 0===this.props.selectedShareholder||null===this.props.selectedShareholder||""===this.props.selectedShareholder?this.props.userDetails.EntityResult.PrimaryShareholder:this.props.selectedShareholder,showAuthenticationLayout:!1},this.handleAdd=()=>{try{var{operationsVisibilty:t}={...this.state};t.delete=!1,t.add=!1,t.shareholder=!1,this.setState({isDetails:"true",selectedRow:{},operationsVisibilty:t})}catch(e){console.log("ProductAllocationComposite:Error occured on handleAdd",e)}},this.authenticateDelete=()=>{try{let t=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showAuthenticationLayout:t}),!1===t&&this.handleDelete()}catch(t){console.log("Product Allocation Composite : Error in authenticateDelete")}},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})},this.handleDelete=()=>{try{this.handleAuthenticationClose();var{operationsVisibilty:t}={...this.state};t.delete=!1,this.setState({operationsVisibilty:t});for(var e=[],s=0;s<this.state.selectedItems.length;s++){var o=this.state.selectedShareholder,i=this.state.selectedItems[s].Common_Code,a={keyDataCode:0,ShareHolderCode:o,KeyCodes:[{Key:y.EW,Value:this.state.allocationType},{Key:y.f,Value:i}]};e.push(a)}l()(r.Rkh,u.tW(e,this.props.tokenDetails.tokenInfo)).then((e=>{console.log(e.data);var s=e.data,o=s.isSuccess;null!==s.ResultDataList&&void 0!==s.ResultDataList&&(o=s.ResultDataList.filter((function(t){return!t.IsSuccess})).length!==s.ResultDataList.length);var i=u.Cy(s,"ProductAllocation_DeletionStatus",["EntityCode"]);o?(this.setState({isReadyToRender:!1}),this.getProductAllocationList(this.state.selectedShareholder,this.state.allocationType),t.delete=!1,this.setState({selectedItems:[],operationsVisibilty:t,selectedRow:{}})):(t.delete=!0,this.setState({operationsVisibilty:t})),i.messageResultDetails.forEach((t=>{t.keyFields.length>0&&(t.keyFields[0]=this.state.allocationType===n.CY.CUSTOMER?"ShipmentCompDetail_CustomerCode":"RailDispatchManualEntry_CarrierCode")})),(0,h.toast)((0,D.jsx)(p.A,{children:(0,D.jsx)(d.A,{notificationMessage:i})}),{autoClose:"success"===i.messageType&&1e4})})).catch((t=>{throw t}))}catch(c){console.log("ProductAllocationComposite:Error occured on handleDelete",c)}},this.handleRowClick=t=>{try{var{operationsVisibilty:e}={...this.state};e.add=u.ab(this.props.userDetails.EntityResult.FunctionsList,m.i.add,m.Kw),e.delete=u.ab(this.props.userDetails.EntityResult.FunctionsList,m.i.remove,m.Kw),e.shareholder=!1,this.setState({isDetails:"true",selectedRow:t,selectedItems:[t],operationsVisibilty:e})}catch(s){console.log("ProductAllocationComposite:Error occured on handleRowClick",s)}},this.handleSelection=t=>{try{var{operationsVisibilty:e}={...this.state};e.delete=t.length>0&&u.ab(this.props.userDetails.EntityResult.FunctionsList,m.i.remove,m.Kw),this.setState({selectedItems:t,operationsVisibilty:e})}catch(s){console.log("ProductAllocationComposite:Error occured on handleSelection",s)}},this.savedEvent=(t,e,s)=>{try{var{operationsVisibilty:o}={...this.state};if(null===s)o.add=u.ab(this.props.userDetails.EntityResult.FunctionsList,m.i.add,m.Kw),o.delete=u.ab(this.props.userDetails.EntityResult.FunctionsList,m.i.remove,m.Kw),this.setState({isDetailsModified:"true",operationsVisibilty:o});else{if("success"===s.messageType&&(o.add=!0,o.delete=!0,this.setState({isDetailsModified:"true",operationsVisibilty:o})),"success"===s.messageType&&"add"===e){var i=[{Common_Code:t.EntityCode}];this.setState({selectedItems:i})}(0,h.toast)((0,D.jsx)(p.A,{children:(0,D.jsx)(d.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4})}}catch(a){console.log("ProductAllocationComposite:Error occured on savedEvent",a)}},this.handleBack=()=>{try{var{operationsVisibilty:t}={...this.state};t.add=u.ab(this.props.userDetails.EntityResult.FunctionsList,m.i.add,m.Kw),t.delete=!1,this.setState({isDetails:!1,selectedRow:{},selectedItems:[],isReadyToRender:!1}),this.getProductAllocationList(this.state.selectedShareholder,this.state.allocationType)}catch(e){console.log("ProductAllocationComposite:Error occured on Back click",e)}},this.handleShareholderSelectionChange=t=>{try{this.setState({selectedShareholder:t,isReadyToRender:!1,selectedItems:[]}),this.getProductAllocationList(t,this.state.allocationType)}catch(e){console.log("ProductAllocationComposite:Error occured on handleShareholderSelectionChange",e)}}}componentDidMount(){try{u.pJ(this.props.userDetails.EntityResult.IsArchived),this.getLookUpData()}catch(t){console.log("ProductAllocationComposite:Error occured on ComponentDidMount",t)}}getLookUpData(){l()(r.xAA+"?LookUpTypeCode=ProductAllocation",u.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{const e=t.data;if(!0===e.IsSuccess){let t=!0,o=e.EntityResult.AllocationEntity.toUpperCase();if(o=e.EntityResult.AllocationEntity.toUpperCase()===n.CY.CUSTOMER_AND_SHAREHOLDER?n.CY.CUSTOMER:e.EntityResult.AllocationEntity.toUpperCase(),e.EntityResult.AllocationEntity.toUpperCase()===n.CY.SHAREHOLDER&&(t=!1),t&&"FALSE"===e.EntityResult.EnableProductAllocation.toUpperCase()&&(t=!1),this.setState({lookUpData:e.EntityResult,isEnable:t}),t){var{operationsVisibilty:s}={...this.state};s.add=u.ab(this.props.userDetails.EntityResult.FunctionsList,m.i.add,m.Kw),this.setState({operationsVisibilty:s,allocationType:o},(()=>{this.getProductAllocationList(this.state.selectedShareholder,o)}))}}else console.log("Error in getLookUpData: ",e.ErrorList)})).catch((t=>{console.log("ShareholderAllocationComposite: Error occurred on getLookUpData",t)}))}getProductAllocationList(t,e){try{l()(r.Ekm+"?ShareholderCode="+t+"&allocationType="+e,u.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var e=t.data;!0===e.IsSuccess?this.setState({data:e.EntityResult,isReadyToRender:!0}):(this.setState({data:[],isReadyToRender:!0}),console.log("Error in getProductAllocationList:",e.ErrorList))})).catch((t=>{this.setState({data:[],isReadyToRender:!0}),console.log("Error while getting product allocation List:",t)}))}catch(s){console.log("Error while getting product allocation List:",s)}}render(){return(0,D.jsxs)("div",{children:[(0,D.jsx)(p.A,{children:(0,D.jsx)(i.$,{operationsVisibilty:this.state.operationsVisibilty,breadcrumbItem:this.props.activeItem,shareholders:this.props.userDetails.EntityResult.ShareholderList,selectedShareholder:this.state.selectedShareholder,onShareholderChange:this.handleShareholderSelectionChange,onDelete:this.authenticateDelete,onAdd:this.handleAdd,handleBreadCrumbClick:this.props.handleBreadCrumbClick})}),"true"===this.state.isDetails?(0,D.jsx)(p.A,{children:(0,D.jsx)(C.default,{selectedRow:this.state.selectedRow,onBack:this.handleBack,onSaved:this.savedEvent,allocationType:this.state.allocationType,selectedShareholder:this.state.selectedShareholder},"ShareholderAllocationDetails")}):this.state.isReadyToRender?(0,D.jsx)("div",{children:(0,D.jsx)(p.A,{children:(0,D.jsx)(S.P,{tableData:this.state.data.Table,columnDetails:this.state.data.Column,pageSize:this.props.userDetails.EntityResult.PageAttibutes.WebPortalListPageSize,exportRequired:!0,exportFileName:"ShareholderAllocationList",columnPickerRequired:!0,terminalsToShow:this.props.userDetails.EntityResult.PageAttibutes.NoOfTerminalsToShow,selectionRequired:!0,columnGroupingRequired:!0,selectedItems:this.state.selectedItems,onRowClick:this.handleRowClick,onSelectionChange:this.handleSelection,parentComponent:this.componentName})})}):(0,D.jsx)(D.Fragment,{children:this.state.isEnable?(0,D.jsx)(R.A,{message:"Loading"}):(0,D.jsx)(E.default,{errorMessage:"ProductAllocation_Enable"})}),(0,D.jsx)(p.A,{children:(0,D.jsx)(h.ToastContainer,{hideProgressBar:!0,closeOnClick:!1,closeButton:!0,newestOnTop:!0,position:"bottom-right",toastClassName:"toast-notification-wrap"})}),this.state.showAuthenticationLayout?(0,D.jsx)(g.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:m.i.remove,functionGroup:m.Kw,handleClose:this.handleAuthenticationClose,handleOperation:this.handleDelete}):null]})}}const b=(0,c.Ng)((t=>({userDetails:t.getUserDetails.userDetails,tokenDetails:t.getUserDetails.TokenAuth})))(A)}}]);
//# sourceMappingURL=1803.b95aea8f.chunk.js.map