"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[4401],{4401:(e,t,a)=>{a.r(t),a.d(t,{default:()=>k});var s=a(65043),r=a(97508),i=a(65187),n=a(11981),o=a(14159),l=a(67907),d=a(72711),p=a(85800),u=a(69062),c=a(35861),h=a(70579);function m(e){let{modPipelineSnapshotInfo:t,modPipelineTankTransactionSnapshotInfo:a,modPipelineMeterTransactionSnapshotInfo:s,tankValidationErrors:r,meterValidationErrors:n,listOptions:o,modAttributeMetaDataList:m,attributeValidationErrors:M,onFieldChange:T,onTabChange:S,onAttributeDataChange:D,activeIndex:E,modDispatch:C,isMeterRequired:y,isTankRequired:g,onDateTextChange:v}=e;const P=(e,t)=>{let a=[];return void 0!==e&&(a=e.find((e=>e.TerminalCode===t))),a.attributeValidationErrors};return(0,h.jsx)(l.TranslationConsumer,{children:e=>(0,h.jsx)("div",{children:(0,h.jsxs)("div",{className:"detailsContainer",children:[(0,h.jsxs)("div",{className:"row",children:[(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:C.FinishedProductCode,label:e("PipelineDispatch_FinishedProductCode"),disabled:!0,reserveSpace:!1})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:C.PipelineDispatchCode,label:e("PipelineEntry_PipelineHeaderDispatchCode"),disabled:!0,reserveSpace:!1})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:C.PipelineHeaderCode,label:e("PipelineEntry_PipelineHeaderCode"),disabled:!0,reserveSpace:!1})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Select,{fluid:!0,value:o.tankCodes,label:e("PipelineEntry_PlanedTank"),options:u.Zj(o.tankCodes),disabled:!0,multiple:!0,reserveSpace:!1})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Select,{fluid:!0,value:[C.PipelineHeaderMeterCode],label:e("PipelineEntry_PlanedMeter"),options:u.Zj(o.meterCodes),disabled:!0,multiple:!0,reserveSpace:!1})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.DatePicker,{fluid:!0,value:a.ScanStartTime,label:e("PipelineEntry_CaptureStartTime"),type:"datetime",displayFormat:(0,c.F1)(),disablePast:!1,disableFuture:!0,indicator:"required",onChange:e=>T("ScanStartTime",e,"Tank"),onTextChange:(e,t)=>{v("ScanStartTime",e,t)},error:e(r.ScanStartTime),reserveSpace:!1})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.DatePicker,{fluid:!0,value:a.ScanEndTime,label:e("PipelineEntry_CaptureEndTime"),type:"datetime",displayFormat:(0,c.F1)(),disablePast:!1,disableFuture:!0,indicator:"required",onChange:e=>T("ScanEndTime",e,"Tank"),onTextChange:(e,t)=>{v("ScanEndTime",e,t)},error:e(r.ScanEndTime),reserveSpace:!1})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:t.Remarks,label:e("LoadingDetailsEntry_Remarks"),onChange:e=>T("Remarks",e),reserveSpace:!1,error:e(r.Remarks)})})]}),m.length>0?m.map((t=>(0,h.jsx)(i.A,{children:(0,h.jsx)(d.Accordion,{children:(0,h.jsx)(d.Accordion.Content,{className:"attributeAccordian",title:e("Attributes_Header"),children:(0,h.jsx)(p.n,{selectedAttributeList:t.attributeMetaDataList,handleCellDataEdit:D,attributeValidationErrors:P(M,t.TerminalCode)})})})}))):null,(0,h.jsxs)(d.Tab,{activeIndex:E,onTabChange:e=>S(e),children:[(0,h.jsx)(d.Tab.Pane,{title:e("Pipeline_Header_meter_Level_Trasaction"),children:(0,h.jsxs)("div",{className:"row",children:[(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("PipelineEntry_PipelineMeterCode"),value:s.MeterCode,onChange:e=>T("MeterCode",e,"Meter"),indicator:y?"required":null,error:e(n.MeterCode),options:u.Zj(o.meterCodes),reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:s.GrossStartTotalizer,label:e("PipelineMeter_StartGrossTotalizer"),onChange:e=>T("GrossStartTotalizer",e,"Meter"),reserveSpace:!1,error:e(n.GrossStartTotalizer),indicator:""!==s.MeterCode?"required":null})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:s.NetStartTotalizer,label:e("PipelineMeter_StartNetTotalizer"),onChange:e=>T("NetStartTotalizer",e,"Meter"),reserveSpace:!1,error:e(n.NetStartTotalizer),indicator:""!==s.MeterCode?"required":null})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:s.GrossEndTotalizer,label:e("PipelineMeter_EndGrossTotalizer"),onChange:e=>T("GrossEndTotalizer",e,"Meter"),reserveSpace:!1,error:e(n.GrossEndTotalizer),indicator:""!==s.MeterCode?"required":null})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:s.NetEndTotalizer,label:e("TankMeter_EndNetTotalizer"),onChange:e=>T("NetEndTotalizer",e,"Meter"),reserveSpace:!1,error:e(n.NetEndTotalizer),indicator:""!==s.MeterCode?"required":null})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:s.Temperature,label:e("LoadingDetailsEntry_Temperature"),onChange:e=>T("Temperature",e,"Meter"),reserveSpace:!1,error:e(n.Temperature)})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Select,{fluid:!0,value:s.TemperatureUOM,options:o.temperatureUOMs,placeholder:"Select",label:e("MarineDispatchManualEntry_TemperatureUOM"),onChange:e=>T("TemperatureUOM",e,"Meter"),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(n.TemperatureUOM),indicator:""!==s.Temperature?"required":null})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:s.Density,label:e("Density"),onChange:e=>T("Density",e,"Meter"),reserveSpace:!1,error:e(n.Density)})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Select,{fluid:!0,value:s.DensityUOM,options:o.densityUOMS,placeholder:"Select",label:e("BaseProductInfox_UOM"),onChange:e=>T("DensityUOM",e,"Meter"),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(n.DensityUOM),indicator:""!==s.Density?"required":null})})]})}),(0,h.jsx)(d.Tab.Pane,{title:e("Pipeline_Tank_Level_Trasaction"),children:(0,h.jsxs)("div",{className:"row",children:[(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("AtgConfigure_TankCode"),value:a.TankCode,onChange:e=>T("TankCode",e,"Tank"),indicator:g?"required":null,error:e(r.TankCode),options:u.Zj(o.tankCodes),reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:a.GrossMass,label:e("TankInfo_GrossMass"),onChange:e=>T("GrossMass",e,"Tank"),reserveSpace:!1,error:e(r.GrossMass)})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Select,{fluid:!0,value:a.MassUOM,options:o.quantityUOMOptions,placeholder:"Select",label:e("TankEODEntry_MassQuantityUOM"),onChange:e=>T("MassUOM",e,"Tank"),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(r.MassUOM),indicator:""!==a.GrossMass?"required":null})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:a.GrossStartVolume,label:e("Gross_start_Volume"),onChange:e=>T("GrossStartVolume",e,"Tank"),reserveSpace:!1,error:e(r.GrossStartVolume),indicator:""!==a.TankCode?"required":null})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:a.NetStartVolume,label:e("Net_start_Volume"),onChange:e=>T("NetStartVolume",e,"Tank"),reserveSpace:!1,error:e(r.NetStartVolume),indicator:""!==a.TankCode?"required":null})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:a.GrossEndVolume,label:e("Gross_end_Volume"),onChange:e=>T("GrossEndVolume",e,"Tank"),reserveSpace:!1,error:e(r.GrossEndVolume),indicator:""!==a.TankCode?"required":null})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:a.NetEndVolume,label:e("Net_end_Volume"),onChange:e=>T("NetEndVolume",e,"Tank"),reserveSpace:!1,error:e(r.NetEndVolume),indicator:""!==a.TankCode?"required":null})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Select,{fluid:!0,value:a.VolumeUOM,options:o.volumeUOMs,placeholder:"Select",label:e("TankTransaction_VolumeUom"),onChange:e=>T("VolumeUOM",e,"Tank"),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(r.VolumeUOM),indicator:""!==a.TankCode?"required":null})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:a.Temperature,label:e("LoadingDetailsEntry_Temperature"),onChange:e=>T("Temperature",e,"Tank"),reserveSpace:!1,error:e(r.Temperature)})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Select,{fluid:!0,value:a.TemperatureUOM,options:o.temperatureUOMs,placeholder:"Select",label:e("MarineDispatchManualEntry_TemperatureUOM"),onChange:e=>T("TemperatureUOM",e,"Tank"),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(r.TemperatureUOM),indicator:""!==a.Temperature?"required":null})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:a.Density,label:e("Density"),onChange:e=>T("Density",e,"Tank"),reserveSpace:!1,error:e(r.Density)})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Select,{fluid:!0,value:a.DensityUOM,options:o.densityUOMS,placeholder:"Select",label:e("BaseProductInfox_UOM"),onChange:e=>T("DensityUOM",e,"Tank"),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(r.DensityUOM),indicator:""!==a.Density?"required":null})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Input,{fluid:!0,value:a.Pressure,label:e("LoadingDetailsEntry_Pressure"),onChange:e=>T("Pressure",e,"Tank"),reserveSpace:!1,error:e(r.Pressure)})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)(d.Select,{fluid:!0,value:a.PressureUOM,options:o.pressureUOMs,placeholder:"Select",label:e("BCU_PressureUOM"),onChange:e=>T("PressureUOM",e,"Tank"),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(r.PressureUOM),indicator:""!==a.Pressure?"required":null})})]})})]})]})})})}m.defaultProps={};var M=a(9256),T=a(53536),S=a.n(T),D=a(46100),E=a(44192),C=a(93779),y=a(40854),g=a.n(y),v=a(7523),P=a(72067),U=a(80312),O=a(15417),b=a(62900);class f extends s.Component{constructor(){var e;super(...arguments),e=this,this.state={modPipelineSnapshotInfo:S().cloneDeep(D.uk),modPipelineTankTransactionSnapshotInfo:S().cloneDeep(D.$U),modPipelineMeterTransactionSnapshotInfo:S().cloneDeep(D.$U),quantityUOMOptions:[],densityUOMS:[],temperatureUOMs:[],volumeUOMs:[],pressureUOMs:[],tankCodes:[],meterCodes:this.props.pipelineHeaderMeterOptions,tankValidationErrors:u.Th(E.nN),meterValidationErrors:u.Th(E.nN),attributeMetaDataList:[],modAttributeMetaDataList:[],attributeValidationErrors:[],activeIndex:0,manualEntrySaveEnable:!0,isComminglingAlert:!1,showAuthenticationLayout:!1,tempPipelineSnapshotInfo:{}},this.addLoadingDetails=()=>{try{this.setState({saveEnabled:!1});let e=S().cloneDeep(this.state.tempPipelineSnapshotInfo);this.CreateManualEntry(e)}catch(e){console.log("Pipeline Dispatch Manual Entry Composite : Error in addLoadingDetails")}},this.handleSave=()=>{try{let e=u.pI(this.state.modAttributeMetaDataList);if(this.validateSave(e)){let t=this.fillDetails(e),a=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,s=S().cloneDeep(t);this.setState({showAuthenticationLayout:a,tempPipelineSnapshotInfo:s},(()=>{!1===a&&this.addLoadingDetails()}))}else this.setState({manualEntrySaveEnable:!0})}catch(e){console.log("PipelineDispatchManualEntryDetailsComposite:Error occured on handleSave",e)}},this.ComminglingAlert=()=>(0,h.jsx)(l.TranslationConsumer,{children:e=>(0,h.jsxs)(d.Modal,{open:this.state.isComminglingAlert,size:"small",children:[(0,h.jsx)(d.Modal.Content,{children:(0,h.jsx)("div",{className:"col col-lg-12",children:(0,h.jsx)("h5",{children:e("PipelineManualEntry_ComminglingError").replace("{0}",this.props.selectedShareholder).replace("{1}",this.state.modPipelineTankTransactionSnapshotInfo.TankCode)})})}),(0,h.jsx)(d.Modal.Footer,{children:(0,h.jsx)(d.Button,{type:"primary",content:e("AccessCardInfo_Ok"),onClick:()=>{this.setState({isComminglingAlert:!1})}})})]})}),this.handleReset=()=>{try{let t=S().cloneDeep(D.$U),a=S().cloneDeep(D.$U);this.props.isMeterRequired&&null!==this.state.meterCodes&&1===this.state.meterCodes.length&&(a.MeterCode=this.state.meterCodes[0]);const s={...this.state.tankValidationErrors},r={...this.state.meterValidationErrors};Object.keys(s).forEach((function(e){s[e]=""})),Object.keys(r).forEach((function(e){r[e]=""}));var e=S().cloneDeep(this.state.attributeMetaDataList);this.setState({modPipelineMeterTransactionSnapshotInfo:a,modPipelineTankTransactionSnapshotInfo:t,tankValidationErrors:s,meterValidationErrors:r,modAttributeMetaDataList:[],attributeValidationErrors:u.Fl(e.PIPELINETRANSACTIONS)},(()=>{this.formAttributesForUI(e),this.setDefaultValues()}))}catch(t){console.log("PipelineDispatchManualEntryDetailsComposite: Error in reset")}},this.handleChange=function(t,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{if("Tank"===s){let s=S().cloneDeep(e.state.modPipelineTankTransactionSnapshotInfo);const r=S().cloneDeep(e.state.tankValidationErrors);s[t]=a,"TankCode"===t?e.getTankDetails(s):"ScanEndTime"===t?(r.ScanStartTime="",e.setState({modPipelineTankTransactionSnapshotInfo:s})):e.setState({modPipelineTankTransactionSnapshotInfo:s}),void 0!==E.nN[t]&&(r[t]=u.jr(E.nN[t],a)),e.setState({tankValidationErrors:r})}else if("Meter"===s){let s=S().cloneDeep(e.state.modPipelineMeterTransactionSnapshotInfo);s[t]=a;const r=S().cloneDeep(e.state.meterValidationErrors);void 0!==E.nN[t]&&(r[t]=u.jr(E.nN[t],a)),e.setState({modPipelineMeterTransactionSnapshotInfo:s,meterValidationErrors:r})}else{let s=S().clone(e.state.modPipelineSnapshotInfo);s[t]=a;const r=S().cloneDeep(e.state.tankValidationErrors);void 0!==E.nN[t]&&(r[t]=u.jr(E.nN[t],a),e.setState({modPipelineSnapshotInfo:s,tankValidationErrors:r}))}}catch(r){console.log("PipelineDispatchManualEntryDetailsComposite : Error in handle change")}},this.handleDateTextChange=(e,t,a)=>{try{let s=S().cloneDeep(this.state.modPipelineTankTransactionSnapshotInfo);const r=S().cloneDeep(this.state.tankValidationErrors);r[e]=a,s[e]=t,this.setState({tankValidationErrors:r,modPipelineTankTransactionSnapshotInfo:s})}catch(a){console.log("PipelineDispatchManualEntryDetailsComposite:Error occured on handleDateTextChange",a)}},this.handleTabChange=e=>{this.setState({activeIndex:e})},this.handleAttributeDataChange=(e,t)=>{try{let a=[],s=S().cloneDeep(this.state.modAttributeMetaDataList),r=s.filter((t=>t.TerminalCode===e.TerminalCode));r.length>0&&Array.isArray(r[0].attributeMetaDataList)&&(a=r[0].attributeMetaDataList.filter((t=>t.Code===e.Code))),a.length>0&&(a[0].DefaultValue=t);const i=S().cloneDeep(this.state.attributeValidationErrors);i.forEach((a=>{a.TerminalCode===e.TerminalCode&&(a.attributeValidationErrors[e.Code]=u.I5(e,t))})),this.setState({attributeValidationErrors:i,modAttributeMetaDataList:s})}catch(a){console.log("PipelineDispatchtManualEntryDetailsComposite:Error occured on handleAttributeCellDataEditFP",a)}},this.handleTabChange=e=>{this.setState({activeIndex:e})},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentDidMount(){try{u.pJ(this.props.userDetails.EntityResult.IsArchived),this.GetUOMList(),this.getAttributes(),this.setDefaultValues()}catch(e){console.log("PipelineDispatchManualEntryDetailsComposite : Error occured on componentDidMount",e)}}setDefaultValues(){try{let e=S().cloneDeep(this.state.modPipelineTankTransactionSnapshotInfo),t=S().cloneDeep(this.state.modPipelineMeterTransactionSnapshotInfo);e.VolumeUOM=this.props.pipelineDispatch.QuantityUOM,e.ScanStartTime=new Date,e.ScanEndTime=new Date,t.TemperatureUOM=this.props.userDetails.EntityResult.PageAttibutes.DefaultUOMS.TemperatureUOM,t.DensityUOM=this.props.userDetails.EntityResult.PageAttibutes.DefaultUOMS.DensityUOM,this.setState({modPipelineTankTransactionSnapshotInfo:e,modPipelineMeterTransactionSnapshotInfo:t},(()=>{this.getmeterCodes(),this.getTankCodes()}))}catch(e){console.log("PipelineDispatchManualEntryDetailsComposite : Error occured while setting default values",e)}}getTankDetails(e){try{var t=[{key:C.E7,value:e.TankCode},{key:C.uw,value:null!==this.props.pipelineDispatch.TerminalCodes&&this.props.pipelineDispatch.TerminalCodes.length>0?this.props.pipelineDispatch.TerminalCodes[0]:null}],a={keyDataCode:C.E7,KeyCodes:t};g()(P.vQz,u.tW(a,this.props.tokenDetails.tokenInfo)).then((t=>{let a=t.data;if(a.IsSuccess){let t=a.EntityResult;e.PressureUOM=t.PressureUOM,e.MassUOM=t.GrossMassUOM,e.DensityUOM=t.DensityUOM,e.TemperatureUOM=t.TemperatureUOM,this.setState({modPipelineTankTransactionSnapshotInfo:e})}else this.setState({modPipelineTankTransactionSnapshotInfo:e})})).catch((e=>{console.log("PipelineDispatchManualEntryDetailsComposite : Error while getting Tank Details",e)}))}catch(s){console.log("PipelineDispatchManualEntryDetailsComposite : Error in getting Tank Details",s)}}getmeterCodes(){try{let e=S().cloneDeep(this.props.pipelineDispatch);this.setState({meterCodes:this.props.pipelineHeaderMeterOptions},(()=>{if(this.props.isMeterRequired&&void 0!==e.PipelineHeaderMeterCode&&null!==e.PipelineHeaderMeterCode){let t=S().cloneDeep(this.state.modPipelineMeterTransactionSnapshotInfo);t.MeterCode=e.PipelineHeaderMeterCode,this.setState({modPipelineMeterTransactionSnapshotInfo:t})}}))}catch(e){console.log("PipelineDispatchManualEntryDetailsCOmposite : Error in getting meter codes",e)}}getTankCodes(){try{let e=null===this.props.pipelineDispatch.FinishedProductCode||void 0===this.props.pipelineDispatch.FinishedProductCode?"":this.props.pipelineDispatch.FinishedProductCode,t=this.props.selectedShareholder;g()(P.gQ7+"?shCode="+t+"&finishedProductCode="+e,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){let e=[];e=t.EntityResult,this.setState({tankCodes:e},(()=>{if(this.props.isTankRequired&&1===e.length){let t=S().cloneDeep(this.state.modPipelineTankTransactionSnapshotInfo);t.TankCode=e[0],this.getTankDetails(t)}}))}}else console.log("TruckShipmentManualEntryDetailsComposite: Error in getTankCodes:",t.ErrorList)})).catch((e=>{console.log("TruckShipmentManualEntryDetailsComposite: Error while getting getTankCodes:",e)}))}catch(e){console.log("PipelineDispatchManualEntryDetailsComposite : error in getting tank codes")}}CreateManualEntry(e){this.handleAuthenticationClose();var t=[{key:C.FR,value:this.props.selectedShareholder},{key:C.KJ,value:this.props.pipelineDispatch.PipelineDispatchCode}],a={messageType:"critical",message:"PipelineDispatch_ManualEntryCreateStatus",messageResultDetails:[{keyFields:["PipelineDispatch_DispatchCode"],keyValues:[this.props.pipelineDispatch.PipelineDispatchCode],isSuccess:!1,errorMessage:""}]},s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:C.Cg,KeyCodes:t,Entity:e};g()(P.rV,u.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;a.messageType=t.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?t.ErrorList.length>0&&""!==t.ErrorList[0]?this.setState({manualEntrySaveEnable:!1,isComminglingAlert:!0,modPipelineMeterTransactionSnapshotInfo:S().cloneDeep(D.$U),modPipelineTankTransactionSnapshotInfo:S().cloneDeep(D.$U)},(()=>{this.setDefaultValues();var e=S().cloneDeep(this.state.attributeMetaDataList);this.formAttributesForUI(e)})):this.setState({manualEntrySaveEnable:!0,modPipelineMeterTransactionSnapshotInfo:S().cloneDeep(D.$U),modPipelineTankTransactionSnapshotInfo:S().cloneDeep(D.$U)},(()=>{this.setDefaultValues();var e=S().cloneDeep(this.state.attributeMetaDataList);this.formAttributesForUI(e)})):(a.message="MarineDispatchManualEntry_SaveFailure",a.messageResultDetails[0].errorMessage=t.ErrorList[0],this.setState({manualEntrySaveEnable:!0})),(0,o.toast)((0,h.jsx)(i.A,{children:(0,h.jsx)(n.A,{notificationMessage:a})}),{autoClose:"success"===a.messageType&&1e4})})).catch((e=>{a.messageResultDetails[0].errorMessage=e,console.log("PipelineDispatchManualEntryDetailsComposite: Error while creating Manual Entry:",e)}))}fillDetails(e){let t={pipelineSnapshotInfoList:[],commonTransactionSnapshotInfoList:[],isBonded:this.props.pipelineDispatch.IsBonded,tankCode:""};try{e=u.SC(e);let a=u.Gh(e),s=S().cloneDeep(this.state.modPipelineSnapshotInfo),r=[];s.PlanCode=null===this.props.pipelineDispatch.PipelineDispatchCode||""===this.props.pipelineDispatch.PipelineDispatchCode?"":this.props.pipelineDispatch.PipelineDispatchCode,s.TransactionType=v.Br.DISPATCH,s.ShareholderCode=null===this.props.selectedShareholder||""===this.props.selectedShareholder?"":this.props.selectedShareholder,r.push(s);let i=[],n=S().cloneDeep(this.state.modPipelineTankTransactionSnapshotInfo);if(""!==n.TankCode&&null!==n.TankCode){t.tankCode=n.TankCode;let e=S().cloneDeep(D.$U),s=S().cloneDeep(D.$U);e.TransactionType=v.Br.DISPATCH,s.TransactionType=v.Br.DISPATCH,e.ScanTime=n.ScanStartTime,s.ScanTime=n.ScanEndTime,null!==this.props.pipelineDispatch.PipelineHeaderCode&&""!==this.props.pipelineDispatch.PipelineHeaderCode&&(e.PipelineHeaderCode=this.props.pipelineDispatch.PipelineHeaderCode,s.PipelineHeaderCode=this.props.pipelineDispatch.PipelineHeaderCode),""!==n.TankCode&&null!==n.TankCode&&(e.TankCode=n.TankCode,s.TankCode=n.TankCode),""!==n.MeterCode&&null!==n.MeterCode&&(e.MeterCode=n.MeterCode,s.MeterCode=n.MeterCode),""!==n.FlowRate&&null!==n.FlowRate&&(e.FlowRate=u.bo(n.FlowRate),s.FlowRate=u.bo(n.FlowRate)),e.FlowRateUOM=n.FlowRateUOM,s.FlowRateUOM=n.FlowRateUOM,""!==n.GrossStartTotalizer&&null!==n.GrossStartTotalizer&&(e.GrossTotalizer=u.bo(n.GrossStartTotalizer),s.GrossTotalizer=u.bo(n.GrossEndTotalizer)),""!==n.NetStartTotalizer&&null!==n.NetStartTotalizer&&(e.NetTotalizer=u.bo(n.NetStartTotalizer),s.NetTotalizer=u.bo(n.NetEndTotalizer)),""!==n.NetEndTotalizer&&null!==n.NetEndTotalizer&&(s.NetTotalizer=u.bo(n.NetEndTotalizer)),""!==n.GrossStartVolume&&null!==n.GrossStartVolume&&(e.GrossVolume=u.bo(n.GrossStartVolume)),""!==n.GrossEndVolume&&null!==n.GrossEndVolume&&(s.GrossVolume=u.bo(n.GrossEndVolume)),""!==n.NetStartVolume&&null!==n.NetStartVolume&&(e.NetVolume=u.bo(n.NetStartVolume)),""!==n.NetEndVolume&&null!==n.NetEndVolume&&(s.NetVolume=u.bo(n.NetEndVolume)),""!==n.Temperature&&null!==n.Temperature&&(e.Temperature=u.bo(n.Temperature),s.Temperature=u.bo(n.Temperature)),""!==n.TemperatureUOM&&null!==n.TemperatureUOM&&(e.TemperatureUOM=n.TemperatureUOM,s.TemperatureUOM=n.TemperatureUOM),""!==n.Density&&null!==n.Density&&(e.Density=u.bo(n.Density),s.Density=u.bo(n.Density)),""!==n.DensityUOM&&null!==n.DensityUOM&&(e.DensityUOM=n.DensityUOM,s.DensityUOM=n.DensityUOM),""!==n.GrossMass&&null!==n.GrossMass&&(e.GrossMass=u.bo(n.GrossMass),s.GrossMass=u.bo(n.GrossMass),e.MassUOM=n.MassUOM,s.MassUOM=n.MassUOM),""!==n.Pressure&&null!==n.Pressure&&(e.Pressure=u.bo(n.Pressure),s.Pressure=u.bo(n.Pressure)),""!==n.PressureUOMv&&null!==n.PressureUOM&&(e.PressureUOM=n.PressureUOM,s.PressureUOM=n.PressureUOM),e.IsManualEntry=!0,s.IsManualEntry=!0,e.LastUpdatedBy=this.props.userDetails.EntityResult.Firstname+" "+this.props.userDetails.EntityResult.LastName,s.LastUpdatedBy=this.props.userDetails.EntityResult.Firstname+" "+this.props.userDetails.EntityResult.LastName,e.Attributes=a,s.Attributes=a,""!==n.VolumeUOM&&null!==n.VolumeUOM&&(e.IsStart=!0,e.IsEnd=!1,s.IsStart=!1,s.IsEnd=!0,e.VolumeUOM=n.VolumeUOM,s.VolumeUOM=n.VolumeUOM),i.push(e),i.push(s)}let o=S().cloneDeep(this.state.modPipelineMeterTransactionSnapshotInfo);if(""!==o.MeterCode&&void 0!==o.MeterCode){let e=S().cloneDeep(D.$U),t=S().cloneDeep(D.$U);e.TransactionType=v.Br.DISPATCH,t.TransactionType=v.Br.DISPATCH,null!==this.props.pipelineDispatch.PipelineHeaderCode&&""!==this.props.pipelineDispatch.PipelineHeaderCode?(e.PipelineHeaderCode=this.props.pipelineDispatch.PipelineHeaderCode,t.PipelineHeaderCode=this.props.pipelineDispatch.PipelineHeaderCode):(e.PipelineHeaderCode="",t.PipelineHeaderCode=""),""!==o.Density&&null!==o.Density?(e.Density=u.bo(o.Density),t.Density=u.bo(o.Density)):(e.Density=0,t.Density=0),e.DensityUOM=o.DensityUOM,t.DensityUOM=o.DensityUOM,e.IsManualEntry=!0,t.IsManualEntry=!0,""!==o.MeterCode&&null!==o.MeterCode&&(e.MeterCode=o.MeterCode,t.MeterCode=o.MeterCode),""!==o.Temperature&&null!==o.Temperature&&(e.Temperature=u.bo(o.Temperature),t.Temperature=u.bo(o.Temperature)),e.TemperatureUOM=o.TemperatureUOM,t.TemperatureUOM=o.TemperatureUOM,""!==o.GrossStartTotalizer&&null!==o.GrossEndTotalizer&&(e.GrossTotalizer=u.bo(o.GrossStartTotalizer),t.GrossTotalizer=u.bo(o.GrossEndTotalizer)),""!==o.NetStartTotalizer&&null!==o.NetEndTotalizer&&(e.NetTotalizer=u.bo(o.NetStartTotalizer),t.NetTotalizer=u.bo(o.NetEndTotalizer)),e.ScanTime=n.ScanStartTime,t.ScanTime=n.ScanEndTime,e.LastUpdatedBy=this.props.userDetails.EntityResult.Firstname+" "+this.props.userDetails.EntityResult.LastName,t.LastUpdatedBy=this.props.userDetails.EntityResult.Firstname+" "+this.props.userDetails.EntityResult.LastName,e.Attributes=a,t.Attributes=a,e.IsStart=!0,e.IsEnd=!1,t.IsStart=!1,t.IsEnd=!0,i.push(e),i.push(t)}t.pipelineSnapshotInfoList=r,t.commonTransactionSnapshotInfoList=i}catch(a){console.log("PipelineDispatchManualEntryDetailsComposite:Error occured on forming request",a)}return t}validateSave(e){const t={...this.state.tankValidationErrors},a={...this.state.meterValidationErrors};let s=S().cloneDeep(this.state.modPipelineTankTransactionSnapshotInfo),r=S().cloneDeep(this.state.modPipelineMeterTransactionSnapshotInfo);Object.keys(E.nN).forEach((function(e){void 0!==s[e]&&(t[e]=u.jr(E.nN[e],s[e]))})),Object.keys(E.nN).forEach((function(e){void 0!==r[e]&&(a[e]=u.jr(E.nN[e],r[e]))})),s.ScanStartTime>=s.ScanEndTime&&(t.ScanStartTime="MarineDispatchManualEntry_ErrorLoadTime"),""!==r.MeterCode&&null!==r.MeterCode&&void 0!==r.MeterCode||!this.props.isMeterRequired||(a.MeterCode="PipelineReceiptDetails_MandatoryHeaderMeterCode"),""!==r.MeterCode&&null!==r.MeterCode&&void 0!==r.MeterCode&&(""!==r.GrossStartTotalizer&&null!==r.GrossStartTotalizer&&void 0!==r.GrossStartTotalizer||(a.GrossStartTotalizer="PipelineEntry_MandatoryStartGrossTotalizer"),""!==r.GrossEndTotalizer&&null!==r.GrossEndTotalizer&&void 0!==r.GrossEndTotalizer||(a.GrossEndTotalizer="PipelineEntry_MandatoryEndGrossTotalizer"),""!==r.NetStartTotalizer&&null!==r.NetStartTotalizer&&void 0!==r.NetStartTotalizer||(a.NetStartTotalizer="PipelineEntry_MandatoryStartNetTotalizer"),""!==r.NetEndTotalizer&&null!==r.NetEndTotalizer&&void 0!==r.NetEndTotalizer||(a.NetEndTotalizer="PipelineEntry_MandatoryEndNetTotalizer")),""===r.Temperature||null===r.Temperature||void 0===r.Temperature||""!==r.TemperatureUOM&&null!==r.TemperatureUOM&&void 0!==r.TemperatureUOM||(a.TemperatureUOM="BCU_TemperatureUOMRequired"),""===r.Density||null===r.Density||void 0===r.Density||""!==r.DensityUOM&&null!==r.DensityUOM&&void 0!==r.DensityUOM||(a.DensityUOM="Reconciliation_DensityUOMMandatory"),!this.props.isTankRequired||""!==s.TankCode&&null!==s.TankCode&&void 0!==s.TankCode||(t.TankCode="PipelineReceiptDetails_MandatoryHeaderMeterCode"),""!==s.TankCode&&null!==s.TankCode&&void 0!==s.TankCode&&(""!==s.GrossStartVolume&&null!==s.GrossStartVolume&&void 0!==s.GrossStartVolume||(t.GrossStartVolume="PipelineEntry_MandatoryStartGrossVolume"),""!==s.GrossEndVolume&&null!==s.GrossEndVolume&&void 0!==s.GrossEndVolume||(t.GrossEndVolume="PipelineEntry_MandatoryEndGrossVolume"),""!==s.NetStartVolume&&null!==s.NetStartVolume&&void 0!==s.NetStartVolume||(t.NetStartVolume="PipelineEntry_MandatoryStartNetVolume"),""!==s.NetEndVolume&&null!==s.NetEndVolume&&void 0!==s.NetEndVolume||(t.NetEndVolume="PipelineEntry_MandatoryEndNetVolume"),""!==s.VolumeUOM&&null!==s.VolumeUOM&&void 0!==s.VolumeUOM||(t.VolumeUOM="PipelineEntry_MandatoryEndNetTotalizer")),""===s.GrossMass||null===s.GrossMass||void 0===s.GrossMass||""!==s.MassUOM&&null!==s.MassUOM&&void 0!==s.MassUOM||(t.MassUOM="PipelineEntry_MandatoryMassUOM"),""===s.Temperature||null===s.Temperature||void 0===s.Temperature||""!==s.TemperatureUOM&&null!==s.TemperatureUOM&&void 0!==s.TemperatureUOM||(t.TemperatureUOM="BCU_TemperatureUOMRequired"),""===s.Density||null===s.Density||void 0===s.Density||""!==s.DensityUOM&&null!==s.DensityUOM&&void 0!==s.DensityUOM||(t.DensityUOM="Reconciliation_DensityUOMMandatory"),""===s.Pressure||null===s.Pressure||void 0===s.Pressure||""!==s.PressureUOM&&null!==s.PressureUOM&&void 0!==s.PressureUOM||(t.PressureUOM="PipelineEntry_MandatoryPressureUOM");var i=S().cloneDeep(this.state.attributeValidationErrors);e.forEach((e=>{i.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.attributeMetaDataList.forEach((e=>{t.attributeValidationErrors[e.Code]=u.I5(e,e.DefaultValue)}))}))})),this.setState({tankValidationErrors:t,meterValidationErrors:a,attributeValidationErrors:i});var n,o=!0,l=!0;return(n=Object.values(a).every((function(e){return""===e})))||this.setState({activeIndex:0}),n&&(l=Object.values(t).every((function(e){return""===e}))),l||this.setState({activeIndex:1}),l&&i.forEach((e=>{if(!o)return o;o=Object.values(e.attributeValidationErrors).every((function(e){return""===e}))})),o&&l&&n}formAttributesForUI(e){try{if(e.PIPELINETRANSACTIONS.length>0){let t=[],a=e.PIPELINETRANSACTIONS[0].TerminalCode;e.PIPELINETRANSACTIONS.forEach((function(e){e.TerminalCode===a&&t.push(e)})),this.setState({modAttributeMetaDataList:t}),S().cloneDeep(this.state.attributeValidationErrors).forEach((e=>{Object.keys(e.attributeValidationErrors).forEach((t=>e.attributeValidationErrors[t]=""))}))}}catch(t){console.log("PipelineDispatchManualEntryDetails : Error in forming attributes for UI")}}getAttributes(){try{g()(P.fKH,u.tW([O.N4],this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({attributeMetaDataList:S().cloneDeep(t.EntityResult),attributeValidationErrors:u.Fl(t.EntityResult.PIPELINETRANSACTIONS)},(()=>{this.formAttributesForUI(t.EntityResult)})):console.log("Failed to get Attributes")}))}catch(e){console.log("Error while getting Attributes:",e)}}GetUOMList(){try{if(null!==this.props.UOMS&&void 0!==this.props.UOMS){let e=this.props.UOMS,t=[],a=[],s=[],r=[],i=[];Array.isArray(e.VOLUME)&&(r=u.Zj(e.VOLUME)),Array.isArray(e.MASS)&&(t=u.Zj(e.MASS)),Array.isArray(e.DENSITY)&&(a=u.Zj(e.DENSITY)),Array.isArray(e.TEMPERATURE)&&(s=u.Zj(e.TEMPERATURE)),Array.isArray(e.PRESSURE)&&(i=u.Zj(e.PRESSURE)),this.setState({quantityUOMOptions:t,densityUOMS:a,temperatureUOMs:s,volumeUOMs:r,pressureUOMs:i})}}catch(e){console.log("PipelineDispatchManualEntryDetailsComposite : Error in getting UOMS")}}render(){const e={quantityUOMOptions:this.state.quantityUOMOptions,densityUOMS:this.state.densityUOMS,temperatureUOMs:this.state.temperatureUOMs,volumeUOMs:this.state.volumeUOMs,pressureUOMs:this.state.pressureUOMs,tankCodes:this.state.tankCodes,meterCodes:this.state.meterCodes};return(0,h.jsxs)("div",{children:[(0,h.jsx)(i.A,{children:(0,h.jsx)(m,{onFieldChange:this.handleChange,onTabChange:this.handleTabChange,listOptions:e,modDispatch:this.props.pipelineDispatch,modPipelineSnapshotInfo:this.state.modPipelineSnapshotInfo,modPipelineTankTransactionSnapshotInfo:this.state.modPipelineTankTransactionSnapshotInfo,modPipelineMeterTransactionSnapshotInfo:this.state.modPipelineMeterTransactionSnapshotInfo,tankValidationErrors:this.state.tankValidationErrors,meterValidationErrors:this.state.meterValidationErrors,modAttributeMetaDataList:this.state.modAttributeMetaDataList,onAttributeDataChange:this.handleAttributeDataChange,attributeValidationErrors:this.state.attributeValidationErrors,activeIndex:this.state.activeIndex,isMeterRequired:this.props.isMeterRequired,isTankRequired:this.props.isTankRequired,onDateTextChange:this.handleDateTextChange})}),(0,h.jsx)(i.A,{children:(0,h.jsx)(M.q,{handleBack:this.props.handleBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.manualEntrySaveEnable})}),this.state.isComminglingAlert?this.ComminglingAlert():null,this.state.showAuthenticationLayout?(0,h.jsx)(b.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:U.i.add,functionGroup:U.jN,handleOperation:this.addLoadingDetails,handleClose:this.handleAuthenticationClose}):null]})}}const k=(0,r.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(f)}}]);
//# sourceMappingURL=4401.e2491a49.chunk.js.map