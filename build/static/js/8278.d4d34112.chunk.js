"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[8278,3235],{78278:(e,t,o)=>{o.r(t),o.d(t,{default:()=>j});var a=o(65043),i=o(69062),l=o(40854),s=o.n(l),n=o(72067),r=o(72711),d=o(78374),c=o(35861),h=o(67907),u=o(7523),m=o(70579);function p(e){let{allocation:t,modAllocation:o,modAllocationItems:a,validationErrors:l,onFieldChange:s,listOptions:n,handleCellDataEdit:p,handleAddAssociation:A,handleDeleteAssociation:C,handleViewItems:E,handleViewShipments:S,selectedAssociations:I,handleRowSelectionChange:y,onDateTextChange:D,expandedRows:g,toggleExpand:T,compartmentDetailsPageSize:f,handleCompAttributeCellDataEdit:b,allocationType:N}=e;const[R]=(0,h.useTranslation)(),v=e=>{const{value:t}=e;return null!==t?new Date(t).toLocaleDateString():""},P=e=>{const t=e.rowData,o=e=>{var t=e.split("-");return new Date(t[0],t[1]-1,t[2])},a=(e,t)=>{var o=new Date(t);t=o.getFullYear()+"-"+("0"+(o.getMonth()+1)).slice(-2)+"-"+("0"+o.getDate()).slice(-2),b(e,t)};try{return t.DataType.toLowerCase()===u.pe.STRING.toLowerCase()||t.DataType.toLowerCase()===u.pe.INT.toLowerCase()?(0,m.jsx)(r.Input,{fluid:!0,value:t.AttributeValue,disabled:t.IsReadonly,onChange:t=>b(e,t),reserveSpace:!1}):t.DataType.toLowerCase()===u.pe.FLOAT.toLowerCase()||t.DataType.toLowerCase()===u.pe.LONG.toLowerCase()||t.DataType.toLowerCase()===u.pe.DOUBLE.toLowerCase()?(0,m.jsx)(r.Input,{fluid:!0,value:null===t.AttributeValue||void 0===t.AttributeValue||""===t.AttributeValue?"":t.AttributeValue.toLocaleString(),disabled:t.IsReadonly,onChange:t=>b(e,t),reserveSpace:!1}):t.DataType.toLowerCase()===u.pe.BOOL.toLowerCase()?(0,m.jsx)(r.Checkbox,{checked:"true"===t.AttributeValue.toString().toLowerCase(),disabled:t.IsReadonly,onChange:t=>b(e,t)}):t.DataType.toLowerCase()===u.pe.DATETIME.toLowerCase()?(0,m.jsx)(r.DatePicker,{fluid:!0,value:null===t.AttributeValue||void 0===t.AttributeValue||""===t.AttributeValue?"":o(t.AttributeValue),disabled:t.IsReadonly,showYearSelector:"true",onChange:t=>a(e,t),onTextChange:t=>{a(e,t)},reserveSpace:!1}):null}catch(i){console.log("ShareholderAllocationDetails:Error occured on handleAttributeType",i)}},x=e=>e.rowData.IsMandatory?(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{children:e.rowData.AttributeName}),(0,m.jsx)("div",{class:"ui red circular empty label badge  circle-padding"})]}):(0,m.jsx)("div",{children:(0,m.jsx)("span",{children:e.rowData.AttributeName})});const L=e=>(0,m.jsx)(r.DatePicker,{fluid:!0,value:null===a[e.rowIndex][e.field]?"":new Date(a[e.rowIndex][e.field]),type:"date",displayFormat:(0,c.F1)(),indicator:"required",onChange:t=>p(t,e),onTextChange:(t,o)=>{D(e,t,o)},reserveSpace:!1}),O=e=>{const{value:t}=e;return"number"===typeof t?t.toLocaleString():t},M=(e,t)=>"Active"===e.field&&e.rowData.NewlyAdded?null:(0,m.jsx)(r.Select,{className:"selectDropwdown",value:a[e.rowIndex][e.field],fluid:!0,options:t,onChange:t=>p(t,e),indicator:"required",reserveSpace:!1,search:!0,noResultsMessage:R("noResultsMessage")}),j=e=>(0,m.jsx)(r.Input,{fluid:!0,value:null!==a[e.rowIndex][e.field]&&void 0!==a[e.rowIndex][e.field]?a[e.rowIndex][e.field].toLocaleString():a[e.rowIndex][e.field],onChange:t=>p(t,e),reserveSpace:!1,disabled:"BlockedQuantity"===e.field||"LoadedQuantity"===e.field});return(0,m.jsxs)("div",{className:"detailsContainer",children:[(0,m.jsxs)("div",{className:"row",children:[N===u.CY.CUSTOMER?(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(r.Select,{fluid:!0,placeholder:R("Common_Select"),label:R("ShipmentCompDetail_CustomerCode"),value:o.EntityCode,options:n.customerOptions,indicator:"required",disabled:""!==t.EntityCode,onChange:e=>s("EntityCode",e),reserveSpace:!1,search:!0,noResultsMessage:R("noResultsMessage"),error:R(l.EntityCode)})}):N===u.CY.CARRIERCOMPANY?(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(r.Select,{fluid:!0,placeholder:R("Common_Select"),label:R("ShipmentContractList_CarrierCompany"),value:o.EntityCode,options:i.Zj(n.CarrierCompanyOptions),indicator:"required",disabled:""!==t.EntityCode,onChange:e=>s("EntityCode",e),reserveSpace:!1,search:!0,noResultsMessage:R("noResultsMessage"),error:R(l.EntityCode)})}):(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(r.Select,{fluid:!0,placeholder:R("Common_Select"),label:R("ShipmentContractList_ShareHolder"),value:o.ShareholderCode,options:i.Zj(n.ShareholderList),indicator:"required",disabled:""!==t.ShareholderCode,onChange:e=>s("ShareholderCode",e),reserveSpace:!1,search:!0,noResultsMessage:R("noResultsMessage"),error:R(l.ShareholderCode)})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(r.Input,{fluid:!0,value:null===o.Description?"":o.Description,onChange:e=>s("Description",e),label:R("Supplier_Description"),error:R(l.Description),reserveSpace:!1})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsxs)("div",{className:"PAIconContainer",children:[(0,m.jsx)("div",{onClick:E,className:"PAIcon",children:(0,m.jsx)("div",{children:(0,m.jsx)("h5",{className:"font14",children:R("PA_ButViewDetail")})})}),(0,m.jsx)("div",{onClick:S,className:"PAIcon margin_l30",children:(0,m.jsx)("div",{children:(0,m.jsx)("h5",{className:"font14",children:R("PA_ButShipmentViewDetail")})})})]})})]}),(0,m.jsxs)("div",{className:"row compartmentRow",children:[(0,m.jsx)("div",{className:"col col-md-8 col-lg-9 col col-xl-9",children:N===u.CY.SHAREHOLDER?(0,m.jsx)("h4",{children:R("ShareholderAllocationInfo_Details")}):(0,m.jsx)("h4",{children:R("ProductAllocationInfo_Details")})}),(0,m.jsx)("div",{className:"col col-md-4 col-lg-3 col-xl-3",children:(0,m.jsxs)("div",{className:"compartmentIconContainer",children:[(0,m.jsxs)("div",{onClick:A,className:"compartmentIcon",children:[(0,m.jsx)("div",{children:(0,m.jsx)(r.Icon,{root:"common",name:"badge-plus",size:"medium"})}),(0,m.jsx)("div",{className:"margin_l10",children:(0,m.jsx)("h5",{className:"font14",children:R("TrailerInfo_Add")})})]}),(0,m.jsxs)("div",{onClick:C,className:"compartmentIcon margin_l30",children:[(0,m.jsx)("div",{children:(0,m.jsx)(r.Icon,{root:"common",name:"delete",size:"medium"})}),(0,m.jsx)("div",{className:"margin_l10",children:(0,m.jsx)("h5",{className:"font14",children:R("TrailerInfo_Delete")})})]})]})})]}),(0,m.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,m.jsx)("div",{className:"col-12 detailsTable PAItems",children:(0,m.jsxs)(d.bQ,{data:a,scrollable:!0,scrollHeight:"320px",selectionMode:"multiple",selection:I,onSelectionChange:y,rowExpansionTemplate:function(e){return Array.isArray(e.AttributesforUI)&&e.AttributesforUI.length>0?(0,m.jsx)("div",{className:"childTable ChildGridViewAllShipmentLoadingDetails",children:(0,m.jsxs)(d.bQ,{data:e.AttributesforUI,rows:f,children:[(0,m.jsx)(d.bQ.Column,{className:"compColHeight",header:R("CompartmentAttributeName"),renderer:x,editable:!1},"AttributeName"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",header:R("CompartmentAttributeValue"),renderer:P}),Array.isArray(e.AttributesforUI)&&e.AttributesforUI.length>f?(0,m.jsx)(d.bQ.Pagination,{}):""]})}):(0,m.jsx)("div",{className:"compartmentIcon",children:(0,m.jsx)("div",{className:"gridButtonAlignLeft",children:R("CustomerInventory_NoRecordsFound")})})},expandedRows:g,children:[(0,m.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"FinishedProductCode",header:(0,c.i7)(R("ContractInfo_Product")),editable:!0,editFieldType:"text",customEditRenderer:e=>M(e,n.finishedProductOptions)},"FinishedProductCode"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"AllocationType",header:(0,c.i7)(R("ProductAllocationItemInfo_AllocationType")),editable:!0,editFieldType:"text",customEditRenderer:e=>(e=>{let t=[];return void 0!==n.allocationTypeandFrequencies&&null!==n.allocationTypeandFrequencies&&Object.keys(n.allocationTypeandFrequencies).forEach((e=>t.push({text:e,value:e}))),M(e,t)})(e)},"AllocationType"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"AllocationPeriod",header:(0,c.i7)(R("ProductAllocationItemInfo_AllocationFrequency")),editable:!0,editFieldType:"text",customEditRenderer:e=>(e=>{let t=[];return void 0!==n.allocationTypeandFrequencies&&null!==n.allocationTypeandFrequencies&&void 0!==n.allocationTypeandFrequencies[e.rowData.AllocationType]&&Array.isArray(n.allocationTypeandFrequencies[e.rowData.AllocationType])&&n.allocationTypeandFrequencies[e.rowData.AllocationType].forEach((e=>t.push({text:e.Code,value:e.Code}))),M(e,t)})(e)},"AllocationPeriod"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"StartDate",header:(0,c.i7)(R("ContractInfo_StartDate")),editable:!0,renderer:e=>v(e),customEditRenderer:e=>L(e)},"StartDate"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"EndDate",header:(0,c.i7)(R("ContractInfo_EndDate")),editable:!0,renderer:e=>v(e),customEditRenderer:e=>L(e)},"EndDate"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"Quantity",header:(0,c.i7)(R("ProductAllocationItemInfo_AllocatedQty")),editable:!0,editFieldType:"text",renderer:e=>O(e),customEditRenderer:j},"Quantity"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight colminWidth disabledCell",field:"BlockedQuantity",header:R("ProductAllocationItemInfo_BlockedQty"),editable:!1,editFieldType:"text",renderer:e=>O(e)},"BlockedQuantity"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight colminWidth disabledCell",field:"LoadedQuantity",header:R("ProductAllocationItemInfo_LoadedQty"),editable:!1,editFieldType:"text",renderer:e=>O(e)},"LoadedQuantity"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight colminPAWidth",field:"QuantityUOM",header:(0,c.i7)(R("ViewShipment_UOM")),editable:!0,editFieldType:"text",customEditRenderer:e=>M(e,n.UOMOptions)},"QuantityUOM"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight colminPAWidth",field:"Active",header:R("ProductAllocationItemInfo_Active"),editable:!0,editFieldType:"text",customEditRenderer:e=>M(e,u.w_)},"Active"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"DeviationPercentOfQty",header:R("ProductAllocationItemInfo_Deviation"),editable:!0,editFieldType:"text",renderer:e=>O(e),customEditRenderer:j},"DeviationPercentOfQty"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"MinimumQuantity",header:R("ProductAllocationItemInfo_MinimumQuantity"),editable:!0,editFieldType:"text",renderer:e=>O(e),customEditRenderer:j},"MinimumQuantity"),(0,m.jsx)(d.bQ.Column,{className:"expandedColumn",initialWidth:"150px",renderer:e=>{const t=g.findIndex((t=>t.SeqNumber===e.rowData.SeqNumber))>=0;return(0,m.jsxs)("div",{onClick:()=>T(e.rowData,t),className:"compartmentIcon gridButtonFontColor",children:[(0,m.jsx)("span",{children:R(t?"Hide_Attributes":"View_Attributes")}),(0,m.jsx)(r.Icon,{root:"common",name:t?"caret-up":"caret-down",className:"margin_l10"})]})}})]})})})]})}function A(e){let{allocationItemList:t,handleBack:o,pageSize:a,allocationType:i}=e;return(0,m.jsx)("div",{children:(0,m.jsx)(h.TranslationConsumer,{children:e=>(0,m.jsx)("div",{children:(0,m.jsxs)("div",{className:"detailsContainer",children:[(0,m.jsxs)("div",{id:"printTable",children:[(0,m.jsx)("div",{className:"row",children:(0,m.jsx)("div",{className:"col-12",children:(0,m.jsx)("h3",{children:i===u.CY.SHAREHOLDER?e("ProductAllocationItemDetails_Shareholder_Header"):i===u.CY.CUSTOMER?e("ProductAllocationItemDetails_Customer_Header"):e("ProductAllocationItemDetails_CarrierCompany_Header")})})}),(0,m.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,m.jsx)("div",{className:"col-12 detailsTable ",children:(0,m.jsxs)(d.bQ,{data:t,reorderableColumns:!0,resizableColumns:!0,search:!0,searchPlaceholder:e("LoadingDetailsView_SearchGrid"),rows:a,children:[(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"productcode",header:e("MarineShipmentProductAllocationDetails_ProductCode"),editable:!1,editFieldType:"text"},"productcode"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"allocationtype",header:e("MarineShipmentProductAllocationDetails_AllocationType"),editable:!1,editFieldType:"text"},"allocationtype"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"allocationperiod",header:e("MarineShipmentProductAllocationDetails_AllocationFrequency"),editable:!1,editFieldType:"text"},"allocationperiod"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"startdate",header:e("MarineShipmentProductAllocationDetails_StartDate"),editable:!1,editFieldType:"text"},"startdate"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"enddate",header:e("MarineShipmentProductAllocationDetails_EndDate"),editable:!1,editFieldType:"text"},"enddate"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"allocatedqty",header:e("MarineShipmentProductAllocationDetails_AllocatedQuantity"),editable:!1,editFieldType:"text"},"allocatedqty"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"blockedqty",header:e("MarineShipmentProductAllocationDetails_BlockedQuantity"),editable:!1,editFieldType:"text"},"blockedqty"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"loadedqty",header:e("MarineShipmentProductAllocationDetails_LoadedQuantity"),editable:!1,editFieldType:"text"},"loadedqty")]})})})]}),(0,m.jsx)("div",{className:"row",children:(0,m.jsx)("div",{className:"col-12 col-sm-6 col-lg-8",children:(0,m.jsx)(r.Button,{className:"backButton",onClick:o,content:e("Back")})})})]})})})})}function C(e){let{allocationShipmentList:t,handleBack:o,pageSize:a,allocationType:i}=e;return(0,m.jsx)("div",{children:(0,m.jsx)(h.TranslationConsumer,{children:e=>(0,m.jsx)("div",{children:(0,m.jsxs)("div",{className:"detailsContainer",children:[(0,m.jsxs)("div",{id:"printTable",children:[(0,m.jsx)("div",{className:"row",children:(0,m.jsx)("div",{className:"col-12",children:(0,m.jsx)("h3",{children:i===u.CY.SHAREHOLDER?e("ProductAllocationShipmentItemDetails_Shareholder"):i===u.CY.CUSTOMER?e("ProductAllocationShipmentItemDetails_Customer"):e("ProductAllocationShipmentItemDetails_Carrier")})})}),(0,m.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,m.jsx)("div",{className:"col-12 detailsTable ",children:(0,m.jsxs)(d.bQ,{data:t,reorderableColumns:!0,resizableColumns:!0,search:!0,searchPlaceholder:e("LoadingDetailsView_SearchGrid"),rows:a,children:[(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"shipmentcode",header:e("ProductAllocationItemInfo_ShipmentCode"),editable:!1,editFieldType:"text"},"shipmentcode"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"transportationType",header:e("ProductAllocation_TransportationType"),editable:!1,editFieldType:"text"},"transportationType"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"customercode",header:e("ProductAllocation_Customer_Code"),editable:!1,editFieldType:"text"},"customercode"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"productcode",header:e("ProductAllocation_Product_Code"),editable:!1,editFieldType:"text"},"productcode"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"allocationtype",header:e("ProductAllocation_Allocation_Type"),editable:!1,editFieldType:"text"},"allocationtype"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"allocationperiod",header:e("MarineShipmentProductAllocationDetails_AllocationFrequency"),editable:!1,editFieldType:"text"},"allocationperiod"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"startdate",header:e("MarineShipmentProductAllocationDetails_StartDate"),editable:!1,editFieldType:"text"},"startdate"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"enddate",header:e("MarineShipmentProductAllocationDetails_EndDate"),editable:!1,editFieldType:"text"},"enddate"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"allocatedqty",header:e("MarineShipmentProductAllocationDetails_AllocatedQuantity"),editable:!1,editFieldType:"text"},"allocatedqty"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"blockedqty",header:e("MarineShipmentProductAllocationDetails_BlockedQuantity"),editable:!1,editFieldType:"text"},"blockedqty"),(0,m.jsx)(d.bQ.Column,{className:"compColHeight",field:"loadedqty",header:e("MarineShipmentProductAllocationDetails_LoadedQuantity"),editable:!1,editFieldType:"text"},"loadedqty")]})})})]}),(0,m.jsx)("div",{className:"row",children:(0,m.jsx)("div",{className:"col-12 col-sm-6 col-lg-8",children:(0,m.jsx)(r.Button,{className:"backButton",onClick:o,content:e("Back")})})})]})})})})}p.defaultProps={listOptions:{ShareholderList:[],finishedProductOptions:[],allocationTypeandFrequencies:{},UOMOptions:[]}},A.defaultProps={},C.defaultProps={};var E=o(9256),S=o(97508),I=o(46100),y=o(44192),D=o(28882),g=(o(38726),o(65187)),T=o(43503),f=o(93779),b=o(40252),N=o(53536),R=o.n(N),v=o(80312),P=o(15417),x=o(60446),L=o.n(x),O=o(62900);class M extends a.Component{constructor(){var e;super(...arguments),e=this,this.state={allocation:R().cloneDeep(I.nC),modAllocation:{},validationErrors:i.Th(y.Wi),allocationItemsvalidationErrors:i.Th(D.yL),isReadyToRender:!1,saveEnabled:!1,allocationItemsList:[],allocationShipmentItemsList:[],selectedAssociations:[],modAllocationItems:[],finishedProductOptions:[],UOMOptions:[],allocationTypeandFrequencies:{},showAllocationItems:!1,showAllocationShipments:!1,noOfSignificantDigits:"3",expandedRows:[],customerOptions:[],CarrierCompanyOptions:[],showAuthenticationLayout:!1,tempAllocation:{}},this.handleChange=(e,t)=>{try{const a=R().cloneDeep(this.state.modAllocation);if(a[e]=t,this.setState({modAllocation:a}),void 0!==y.Wi[e]){var o={...this.state.validationErrors};o[e]=i.jr(y.Wi[e],t),this.setState({validationErrors:o})}"ShareholderCode"===e&&(this.getFinishedProductCodes(t),this.getShareholderAllocation({Common_Code:t}))}catch(a){console.log("ShareholderAllocationDetailsComposite:Error occured on handleChange",a)}},this.handleReset=()=>{try{let e=[];Array.isArray(this.state.allocation.ProductAllocationEntityItems)&&(e=i.Q3(R().cloneDeep(this.state.allocation.ProductAllocationEntityItems)),e.forEach((e=>{e.Active=!0===e.Active?"Active":"Inactive"}))),this.setState({modAllocation:R().cloneDeep(this.state.allocation),modAllocationItems:e,validationErrors:i.Th(y.Wi),allocationItemsvalidationErrors:i.Th(D.yL)})}catch(e){console.log("ShareholderAllocationDetailsComposite:Error occured on handleReset",e)}},this.saveAllocation=()=>{try{this.setState({saveEnabled:!1});let e=R().cloneDeep(this.state.tempAllocation);""===this.state.allocation.ShareholderCode?this.createAllocation(e):this.updateAllocation(e)}catch(e){console.log("Save Allocation  Composite : Error in save Allocation")}},this.handleSave=()=>{try{let e=R().cloneDeep(this.state.modAllocation),t=R().cloneDeep(this.state.modAllocationItems);if(e=this.fillDetails(e,t),this.validateSave(e)){e=this.fillAttributeDetails(e);let t=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,o=R().cloneDeep(e);this.setState({showAuthenticationLayout:t,tempAllocation:o},(()=>{!1===t&&this.saveAllocation()}))}else this.setState({saveEnabled:!0})}catch(e){console.log("ShareholderAllocationDetailsComposite:Error occured on handleSave",e)}},this.handleAddAssociation=()=>{if(!this.props.userDetails.EntityResult.IsArchived)try{let e=R().cloneDeep(this.state.modAllocationItems),t={CreatedTime:null,LastActiveTime:null,Remarks:"",Active:null,DeviationPercentOfQty:null,QuantityUOM:null,LoadedQuantity:null,MinimumQuantity:null,BlockedQuantity:null,Quantity:null,EndDate:new Date,StartDate:new Date,AllocationPeriod:"",AllocationType:null,FinishedProductCode:null,ShareholderCode:"",LastUpdatedTime:new Date,Attributes:[],NewlyAdded:!0};t.SeqNumber=i.Mz(e),e.push(t),this.setState({modAllocationItems:e,selectedAssociations:[]},(()=>{var e=R().cloneDeep(this.state.compartmentAttributeMetaDataList);e.length>0&&this.formCompartmentAttributes([e[0].TerminalCode])}))}catch(e){console.log("TruckReceiptDetailsComposite:Error occured on handleAddCompartment",e)}},this.toggleExpand=function(t,o){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.state.expandedRows,l=i.findIndex((e=>e.SeqNumber===t.SeqNumber));o?a&&l>=0?(i.splice(l,1),i.push(t)):l>=0&&i.splice(l,1):l>=0?i=i.filter((e=>e.Code!==t.Code&&e.SeqNumber!==t.SeqNumber)):i.push(t),e.setState({expandedRows:i})},this.handleDeleteAssociation=()=>{if(!this.props.userDetails.EntityResult.IsArchived)try{if(null!=this.state.selectedAssociations&&this.state.selectedAssociations.length>0&&this.state.modAllocationItems.length>0){let e=R().cloneDeep(this.state.modAllocationItems);this.state.selectedAssociations.forEach(((t,o)=>{e=e.filter(((e,o)=>e.SeqNumber!==t.SeqNumber))})),this.setState({modAllocationItems:e,selectedAssociations:[]})}}catch(e){console.log("RigidtruckDetailsComposite:Error occured on handleDeleteCompartment",e)}},this.getAllocationItems=()=>{try{if(null!==this.state.allocation.ShareholderCode&&""!==this.state.allocation.ShareholderCode&&void 0!==this.state.allocation.ShareholderCode||null!==this.state.allocation.EntityCode&&""!==this.state.allocation.EntityCode&&void 0!==this.state.allocation.EntityCode){var e=[{key:f.f,value:this.props.allocationType===u.CY.SHAREHOLDER?this.state.modAllocation.ShareholderCode:this.state.modAllocation.EntityCode},{key:f.EW,value:this.props.allocationType}],t={ShareHolderCode:this.props.allocationType===u.CY.SHAREHOLDER?this.state.modAllocation.ShareholderCode:this.props.selectedShareholder,keyDataCode:f.FR,KeyCodes:e};s()(n.qy_,i.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){let e=t.EntityResult,o=R().cloneDeep(e.Table),a=R().clone(this.state.noOfSignificantDigits);o.forEach((e=>{e.allocatedqty=null!==e.allocatedqty?Math.round(e.allocatedqty,a).toString()+" "+e.uom:"0 "+e.uom,e.blockedqty=null!==e.blockedqty?Math.round(e.blockedqty,a).toString()+" "+e.uom:"0 "+e.uom,e.loadedqty=null!==e.loadedqty?Math.round(e.loadedqty,a).toString()+" "+e.uom:"0 "+e.uom,e.startdate=new Date(e.startdate).toLocaleDateString(),e.enddate=new Date(e.enddate).toLocaleDateString()})),this.setState({allocationItemsList:o,showAllocationItems:!0})}else this.setState({allocationItemsList:[],showAllocationItems:!1}),console.log("Error in getShareholder:",t.ErrorList)})).catch((e=>{console.log("Error while getShareholder:",e)}))}}catch(o){console.log("Error in getting allocation items",o)}},this.getAllocationShipments=()=>{try{if(null!==this.state.allocation.ShareholderCode&&""!==this.state.allocation.ShareholderCode&&void 0!==this.state.allocation.ShareholderCode||null!==this.state.allocation.EntityCode&&""!==this.state.allocation.EntityCode&&void 0!==this.state.allocation.EntityCode){var e=[{key:f.f,value:this.props.allocationType===u.CY.SHAREHOLDER?this.state.modAllocation.ShareholderCode:this.state.modAllocation.EntityCode},{key:f.EW,value:this.props.allocationType}],t={ShareHolderCode:this.props.allocationType===u.CY.SHAREHOLDER?this.state.modAllocation.ShareholderCode:this.props.selectedShareholder,keyDataCode:f.FR,KeyCodes:e};s()(n.BB9,i.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){let e=t.EntityResult,o=R().cloneDeep(e.Table),a=R().cloneDeep(this.state.noOfSignificantDigits);o.forEach((e=>{e.allocatedqty=null!==e.allocatedqty?Math.round(e.allocatedqty,a).toString()+" "+e.uom:"0 "+e.uom,e.blockedqty=null!==e.blockedqty?Math.round(e.blockedqty,a).toString()+" "+e.uom:"0 "+e.uom,e.loadedqty=null!==e.loadedqty?Math.round(e.loadedqty,a).toString()+" "+e.uom:"0 "+e.uom,e.startdate=new Date(e.startdate).toLocaleDateString(),e.enddate=new Date(e.enddate).toLocaleDateString()})),this.setState({allocationShipmentItemsList:o,showAllocationShipments:!0})}else this.setState({allocationShipmentItemsList:[],showAllocationShipments:!1}),console.log("Error in getShareholder:",t.ErrorList)})).catch((e=>{console.log("Error while getShareholder:",e)}))}}catch(o){console.log("Error in getting allocation shipment items",o)}},this.handleAssociationSelectionChange=e=>{this.setState({selectedAssociations:e})},this.handleCellDataEdit=(e,t)=>{let o=R().cloneDeep(this.state.modAllocationItems);o[t.rowIndex][t.field]=e,"AllocationType"===t.field&&(o[t.rowIndex].AllocationPeriod=null),this.setState({modAllocationItems:o})},this.handleDateTextChange=(e,t,o)=>{try{var a=R().cloneDeep(this.state.modAllocationItems);let o=a.findIndex((t=>t.SeqNumber===e.rowData.SeqNumber));o>=0&&(a[o][e.field]=""===t?null:t,this.setState({modAllocationItems:a}))}catch(o){console.log("Error in DateTextChange : Error occured on handleDateTextChange",o)}},this.BackEvent=()=>{try{this.setState({showAllocationShipments:!1,showAllocationItems:!1},(()=>{this.props.allocationType===u.CY.SHAREHOLDER?this.getShareholderAllocation({Common_Code:this.state.allocation.ShareholderCode}):this.getShareholderAllocation({Common_Code:this.state.allocation.EntityCode})}))}catch(e){console.log("Error in BackEvent",e)}},this.handleCompAttributeCellDataEdit=(e,t)=>{let o=R().cloneDeep(this.state.modAllocationItems),a=o.findIndex((t=>t.SeqNumber===e.rowData.compSequenceNo));a>=0&&(o[a].AttributesforUI[e.rowData.SeqNumber-1].AttributeValue=t),this.setState({modAllocationItems:o}),a>=0&&this.toggleExpand(o[a],!0,!0)},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentDidMount(){try{i.pJ(this.props.userDetails.EntityResult.IsArchived),this.GetUOMList(),this.getProductAllocationTypesandFrequencies(),this.getAttributes(this.props.selectedRow),this.props.allocationType===u.CY.CUSTOMER&&this.getCustomerList(),this.props.allocationType===u.CY.CARRIERCOMPANY&&this.getCarrierCompanies(),this.props.allocationType!==u.CY.SHAREHOLDER&&this.getFinishedProductCodes(this.props.selectedShareholder)}catch(e){console.log("ShareholderDetailsComposite:Error occured on componentDidMount",e)}}getCustomerList(){s()(n.E6k+"?TransportationType= &ShareholderCode="+this.props.selectedShareholder,i.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess)if(Array.isArray(t.EntityResult)){let e=t.EntityResult.filter((e=>e.ShareholderCode===this.props.selectedShareholder));if(e.length>0){let t=e[0].CustomerDestinationsList,o=[];null!==t&&(o=Object.keys(t),o=i.Zj(o)),this.setState({customerOptions:o})}else console.log("ShareholderAllocationDetailsComposite:no customers identified for shareholder")}else console.log("ShareholderAllocationDetailsComposite:customerdestinations not identified for shareholder")}))}getCarrierCompanies(){s()(n.Zes+"?ShareholderCode="+this.props.selectedShareholder,i.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){var o=t.EntityResult.Table2,a=[];o.forEach((e=>{a.push(e.Code)})),this.setState({CarrierCompanyOptions:a})}else console.log("Error in GetCarrierListForRole:",t.ErrorList)})).catch((e=>{console.log("Error while getting Carrier List:",e)}))}getAttributes(e){try{s()(n.fKH,i.tW([P.C4],this.props.tokenDetails.tokenInfo)).then((t=>{var o=t.data;!0===o.IsSuccess?this.setState({compartmentAttributeMetaDataList:R().cloneDeep(o.EntityResult.PRODUCTALLOCATIONITEM)},(()=>this.getShareholderAllocation(e))):console.log("Failed to get Attributes")}))}catch(t){console.log("Error while getting Attributes:",t)}}formCompartmentAttributes(e){try{let t=R().cloneDeep(this.state.compartmentAttributeMetaDataList);t=t.filter((function(t){return e.some((function(e){return t.TerminalCode===e}))}));let o=R().cloneDeep(this.state.modAllocationItems);o.forEach((o=>{let a=[];t.forEach((e=>{e.attributeMetaDataList.forEach((e=>{a.push({AttributeCode:e.Code,AttributeName:e.DisplayName,AttributeValue:e.DefaultValue,TerminalCode:e.TerminalCode,IsMandatory:e.IsMandatory,DataType:e.DataType,IsReadonly:e.IsReadonly,MinValue:e.MinValue,MaxValue:e.MaxValue,ValidationFormat:e.ValidationFormat,compSequenceNo:""})}))}));let l=R().cloneDeep(a);if(null!==o.Code||null!==o.AttributesforUI&&void 0!==o.AttributesforUI){null!==o.AttributesforUI&&void 0!==o.AttributesforUI?(o.AttributesforUI=o.AttributesforUI.filter((function(t){return e.some((function(e){return t.TerminalCode===e}))})),a=a.filter((function(e){return!o.AttributesforUI.some((function(t){return e.TerminalCode===t.TerminalCode}))}))):o.AttributesforUI=[];let t=R().cloneDeep(a);if(Array.isArray(o.Attributes)&&null!==o.Attributes&&void 0!==o.Attributes&&o.Attributes.length>0){o.Attributes.filter((function(t){return e.some((function(e){return t.TerminalCode===e}))})).forEach((e=>{e.ListOfAttributeData.forEach((o=>{let a=t.findIndex((t=>t.TerminalCode===e.TerminalCode&&t.AttributeCode===o.AttributeCode));a>=0&&(t[a].AttributeValue=o.AttributeValue)}))})),t.forEach((e=>{e.compSequenceNo=o.SeqNumber,o.AttributesforUI.push(e)}))}else a.forEach((e=>{e.compSequenceNo=o.SeqNumber,o.AttributesforUI.push(e)}))}else o.AttributesforUI=[],l.forEach((e=>{e.compSequenceNo=o.CompartmentSeqNoInTrailer,o.AttributesforUI.push(e)}));this.toggleExpand(o,!0,!0),void 0!==o.AttributesforUI&&null!=o.AttributesforUI&&(o.AttributesforUI=i.vt(o.AttributesforUI)),o.AttributesforUI=i.Q3(o.AttributesforUI)})),this.setState({modAllocationItems:o})}catch(t){console.log("ShareholderAllocationDetailsComposite:Error in forming Compartment Attributes",t)}}fillAttributeDetails(e){try{return e.ProductAllocationEntityItems.forEach((e=>{void 0!==e.AttributesforUI&&null!=e.AttributesforUI&&(e.AttributesforUI=i.mr(e.AttributesforUI));let t=[];var o=R().cloneDeep(this.state.compartmentAttributeMetaDataList);o.length>0&&(t=[o[0].TerminalCode]);let a=[];e.Attributes=[],t.forEach((t=>{null!==e.AttributesforUI&&void 0!==e.AttributesforUI&&(a=e.AttributesforUI.filter((function(e){return e.TerminalCode===t})));let o={ListOfAttributeData:[]};o.TerminalCode=t,a.forEach((e=>{""===e.AttributeValue&&!0!==e.IsMandatory||o.ListOfAttributeData.push({AttributeCode:e.AttributeCode,AttributeValue:e.AttributeValue})})),null!==o.ListOfAttributeData&&void 0!==o.ListOfAttributeData&&o.ListOfAttributeData.length>0&&e.Attributes.push(o)}))})),e}catch(t){console.log("ShareholderAllocationDetailsComposite:Error occured on fillAttributeDetails",t)}}componentWillReceiveProps(e){try{if(""!==this.state.allocation.ShareholderCode&&void 0===e.selectedRow.Common_Code){this.getShareholderAllocation(e.selectedRow);let t={...this.state.validationErrors};Object.keys(t).forEach((e=>{t[e]=""}));let o={...this.state.allocationItemsvalidationErrors};Object.keys(o).forEach((e=>{o[e]=""})),this.setState({validationErrors:t,allocationItemsvalidationErrors:o})}}catch(t){console.log("PipelineDispatchDetailsComposite:Error occured on componentWillReceiveProps",t)}}getProductAllocationTypesandFrequencies(){s()(n.OxR,i.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){let e={};Array.isArray(t.EntityResult.Table)&&Array.isArray(t.EntityResult.Table1)&&t.EntityResult.Table.forEach((o=>{e[o.Code]=t.EntityResult.Table1.filter((e=>e.AllocationType===o.Code))})),this.setState({allocationTypeandFrequencies:e})}}else console.log("Error in GetUOMList:",t.ErrorList)})).catch((e=>{console.log("Error while getting GetUOMList:",e)}))}GetUOMList(){s()(n.WFM,i.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){let e=[];if(Array.isArray(t.EntityResult.VOLUME)&&(e=i.Zj(t.EntityResult.VOLUME)),Array.isArray(t.EntityResult.MASS)){i.Zj(t.EntityResult.MASS).forEach((t=>e.push(t)))}this.setState({UOMOptions:e})}}else console.log("Error in GetUOMList:",t.ErrorList)})).catch((e=>{console.log("Error while getting GetUOMList:",e)}))}validateSave(e){const t={...this.state.validationErrors};Object.keys(y.Wi).forEach((function(o){void 0!==e[o]&&(t[o]=i.jr(y.Wi[o],e[o]))}));let o={messageType:"critical",message:"ShareholderAllocation_SavedStatus",messageResultDetails:[]};var a=!0;if(a&&(a=Object.values(t).every((function(e){return""===e}))),this.setState({validationErrors:t}),Array.isArray(e.ProductAllocationEntityItems)&&e.ProductAllocationEntityItems.length>0){let t=!0;e.ProductAllocationEntityItems.forEach((a=>{if(t){let e=new Date(a.StartDate).getFullYear();4!==e.toString().length&&(t=!1,o.messageResultDetails.push({keyFields:["ContractInfo_Product","ExchangeAgreementDetails_StartDate"],keyValues:[a.FinishedProductCode,a.StartDate],isSuccess:!1,errorMessage:"Common_InvalidDate"})),e=new Date(a.EndDate).getFullYear(),4!==e.toString().length&&(t=!1,o.messageResultDetails.push({keyFields:["ContractInfo_Product","ContractInfo_EndDate"],keyValues:[a.FinishedProductCode,a.EndDate],isSuccess:!1,errorMessage:"Common_InvalidDate"}))}if(t){let l=e.ProductAllocationEntityItems.filter((e=>e.SeqNumber!==a.SeqNumber&&e.FinishedProductCode===a.FinishedProductCode));l.length>0&&l.forEach((e=>{(a.StartDate>=e.StartDate&&a.StartDate<=e.EndDate||a.EndDate>=e.StartDate&&a.EndDate<=e.EndDate)&&(t=!1,o.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"ErrMsg_PAItem_SameItem_DateOverLap"}))})),t&&(D.yL.forEach((e=>{let t="";void 0!==e.validator&&(t=i.jr(e.validator,a[e.field])),""!==t&&o.messageResultDetails.push({keyFields:["ContractInfo_Product",e.displayName],keyValues:[a.FinishedProductCode,a[e.field]],isSuccess:!1,errorMessage:t})})),null!==a.AttributesforUI&&void 0!==a.AttributesforUI&&a.AttributesforUI.forEach((e=>{let t=i.I5(e,e.AttributeValue);""!==t&&o.messageResultDetails.push({keyFields:[e.AttributeName],keyValues:[e.AttributeValue],isSuccess:!1,errorMessage:t})})))}this.toggleExpand(a,!0,!0)}))}else o.messageResultDetails.push({keyFields:["Report_Shareholder"],keyValues:[e.ShareholderCode],isSuccess:!1,errorMessage:"ERRMSG_PA_NOITEMS"});return o.messageResultDetails.length>0?(this.props.onSaved(this.state.modAllocation,"update",o),!1):a}fillDetails(e,t){try{e.EntityCode=this.props.allocationType!==u.CY.SHAREHOLDER?e.EntityCode:e.ShareholderCode,e.ShareholderCode=this.props.allocationType!==u.CY.SHAREHOLDER?this.props.selectedShareholder:e.ShareholderCode,e.EntityType=this.props.allocationType,e.Source="TM_UI";let o=[];return Array.isArray(t)&&t.length>0&&t.forEach((t=>{let a=R().cloneDeep(this.state.selectedAssociations).findIndex((e=>e.SeqNumber===t.SeqNumber));(null!==t.FinishedProductCode&&void 0!==t.FinishedProductCode&&""!==t.FinishedProductCode||a>=0)&&(t.ShareholderCode=e.ShareholderCode,t.StartDate=L()(t.StartDate).format("YYYY-MM-DD"),t.EndDate=L()(t.EndDate).format("YYYY-MM-DD"),t.Quantity=null!==t.Quantity&&""!==t.Quantity?i.bo(t.Quantity):null,t.DeviationPercentOfQty=null!==t.DeviationPercentOfQty&&""!==t.DeviationPercentOfQty?i.bo(t.DeviationPercentOfQty):null,t.MinimumQuantity=null!==t.MinimumQuantity&&""!==t.MinimumQuantity?i.bo(t.MinimumQuantity):null,t.Active=null===t.Active||"Active"===t.Active,void 0!==t.AttributesforUI&&null!=t.AttributesforUI&&(t.AttributesforUI=i.BZ(t.AttributesforUI)),o.push(t))})),e.ProductAllocationEntityItems=o,e}catch(o){return console.log("Error in fillDetails",o),e}}createAllocation(e){this.handleAuthenticationClose();let t=[{key:f.f,value:this.props.allocationType===u.CY.SHAREHOLDER?e.ShareholderCode:e.EntityCode}],o={keyDataCode:f.f,KeyCodes:t,Entity:e},a={messageType:"critical",message:this.props.allocationType===u.CY.SHAREHOLDER?"ShareholderAllocation_SavedStatus":"ProductAllocation_SavedStatus",messageResultDetails:[{keyFields:[this.props.allocationType===u.CY.SHAREHOLDER?"Report_Shareholder":this.props.allocationType===u.CY.CUSTOMER?"ContractInfo_Customer":"productAllocation_Carrier"],keyValues:[e.EntityCode],isSuccess:!1,errorMessage:""}]};s()(n.eCp,i.tW(o,this.props.tokenDetails.tokenInfo)).then((t=>{let o=t.data;a.messageType=o.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=o.IsSuccess,!0===o.IsSuccess?this.setState({saveEnabled:i.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.modify,v.uy)},(()=>this.getShareholderAllocation({Common_Code:e.EntityCode}))):(a.messageResultDetails[0].errorMessage=o.ErrorList[0],this.setState({saveEnabled:i.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.add,v.uy)}),console.log("Error in CreateShareholderAllocation:",o.ErrorList)),this.props.onSaved(e,"add",a)})).catch((t=>{this.setState({saveEnabled:i.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.add,v.uy)}),a.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"add",a)}))}updateAllocation(e){this.handleAuthenticationClose();let t=[{key:f.f,value:e.EntityCode}],o={keyDataCode:f.f,KeyCodes:t,Entity:e},a={messageType:"critical",message:this.props.allocationType===u.CY.SHAREHOLDER?"ShareholderAllocation_SavedStatus":"ProductAllocation_SavedStatus",messageResultDetails:[{keyFields:[this.props.allocationType===u.CY.SHAREHOLDER?"Report_Shareholder":this.props.allocationType===u.CY.CUSTOMER?"ContractInfo_Customer":"productAllocation_Carrier"],keyValues:[e.EntityCode],isSuccess:!1,errorMessage:""}]};s()(n.RvE,i.tW(o,this.props.tokenDetails.tokenInfo)).then((t=>{let o=t.data;a.messageType=o.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=o.IsSuccess,!0===o.IsSuccess?this.setState({saveEnabled:i.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.modify,v.uy)},(()=>this.getShareholderAllocation({Common_Code:e.EntityCode}))):(a.messageResultDetails[0].errorMessage=o.ErrorList[0],this.setState({saveEnabled:i.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.add,v.uy)}),console.log("Error in UpdateShareholderAllocation:",o.ErrorList)),this.props.onSaved(e,"add",a)})).catch((t=>{this.setState({saveEnabled:i.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.add,v.uy)}),a.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"update",a)}))}getShareholderAllocation(e){if(void 0!==e.Common_Code){var t=[{key:f.f,value:e.Common_Code},{key:f.EW,value:this.props.allocationType}],o={ShareHolderCode:this.props.allocationType===u.CY.SHAREHOLDER?e.Common_Code:this.props.selectedShareholder,keyDataCode:f.FR,KeyCodes:t};s()(n.AIv,i.tW(o,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){let e=R().cloneDeep(t.EntityResult.ProductAllocationEntityItems);e=i.Q3(e),e.forEach((e=>{e.Active=!0===e.Active?"Active":"Inactive"})),this.setState({isReadyToRender:!0,allocation:R().cloneDeep(t.EntityResult),modAllocation:R().cloneDeep(t.EntityResult),modAllocationItems:e,saveEnabled:i.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.modify,v.uy)},(()=>{var e=R().cloneDeep(this.state.compartmentAttributeMetaDataList);Array.isArray(e)&&e.length>0&&this.formCompartmentAttributes([e[0].TerminalCode]),this.getFinishedProductCodes(t.EntityResult.ShareholderCode)})),this.props.onSaved(t.EntityResult,"add",null)}else this.setState({isReadyToRender:!0,allocation:R().cloneDeep(I.nC),modAllocationItems:[],saveEnabled:i.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.add,v.uy)},(()=>{var e=R().cloneDeep(this.state.compartmentAttributeMetaDataList);Array.isArray(e)&&e.length>0&&this.formCompartmentAttributes([e[0].TerminalCode])})),console.log("Error in getShareholder:",t.ErrorList)})).catch((t=>{console.log("Error while getShareholder:",t,e)}))}else this.setState({allocation:R().cloneDeep(I.nC),modAllocation:R().cloneDeep(I.nC),modAllocationItems:[],isReadyToRender:!0,saveEnabled:i.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.add,v.uy)},(()=>{var e=R().cloneDeep(this.state.compartmentAttributeMetaDataList);Array.isArray(e)&&e.length>0&&this.formCompartmentAttributes([e[0].TerminalCode])}))}getSignificantDigits(){try{s()(n.xAA+"?LookUpTypeCode=Common",i.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;!0===t.IsSuccess?void 0!==t.EntityResult.NumberOfSignificantDigits&&null!==t.EntityResult.NumberOfSignificantDigits&&this.setState({noOfSignificantDigits:t.EntityResult.NumberOfSignificantDigits}):console.log("Error in getSignificantDigits: ",t.ErrorList)})).catch((e=>{console.log("PipelineDispatchDetailsComposite: Error occurred on getSignificantDigits",e)}))}catch(e){console.log("PipelineDispatchDetailsComposite:Error occured on geting RefrenceSourceLookUp Value",e)}}getFinishedProductCodes(e){s()(n.w43+"?ShareholderCode="+e,i.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){let e=i.Zj(t.EntityResult);this.setState({finishedProductOptions:e})}}else console.log("Error in getFinishedProductCodes:",t.ErrorList)})).catch((e=>{console.log("Error while getting getFinishedProductCodes:",e)}))}getFunctionGroupName(){return this.props.allocationType===u.CY.SHAREHOLDER?v.uy:v.Kw}render(){const e={ShareholderList:this.props.userDetails.EntityResult.ShareholderList,finishedProductOptions:this.state.finishedProductOptions,allocationTypeandFrequencies:this.state.allocationTypeandFrequencies,UOMOptions:this.state.UOMOptions,customerOptions:this.state.customerOptions,CarrierCompanyOptions:this.state.CarrierCompanyOptions},t=[{fieldName:"ShareholderDetails_LastUpdated",fieldValue:new Date(this.state.modAllocation.LastUpdatedTime).toLocaleDateString()+" "+new Date(this.state.modAllocation.LastUpdatedTime).toLocaleTimeString()},{fieldName:"ShareholderDetails_CreatedDate",fieldValue:new Date(this.state.modAllocation.CreatedTime).toLocaleDateString()+" "+new Date(this.state.modAllocation.CreatedTime).toLocaleTimeString()}];return this.state.isReadyToRender?(0,m.jsxs)("div",{children:[(0,m.jsx)(g.A,{children:(0,m.jsx)(T.A,{entityCode:this.state.allocation.EntityCode,newEntityName:this.props.allocationType===u.CY.SHAREHOLDER?"ProductAllocationItemInfo_AddShareholder":this.props.allocationType===u.CY.CUSTOMER?"ProductAllocationItemInfo_AddCustomer":"ProductAllocationItemInfo_AddCarrier",popUpContents:t})}),this.state.showAllocationItems?(0,m.jsx)(g.A,{children:(0,m.jsx)(A,{allocationItemList:this.state.allocationItemsList,handleBack:this.BackEvent,pageSize:this.props.userDetails.EntityResult.PageAttibutes.WebPortalListPageSize,allocationType:this.props.allocationType})}):this.state.showAllocationShipments?(0,m.jsx)(g.A,{children:(0,m.jsx)(C,{allocationShipmentList:this.state.allocationShipmentItemsList,handleBack:this.BackEvent,pageSize:this.props.userDetails.EntityResult.PageAttibutes.WebPortalListPageSize,allocationType:this.props.allocationType})}):(0,m.jsxs)("div",{children:[(0,m.jsx)(g.A,{children:(0,m.jsx)(p,{allocation:this.state.allocation,modAllocation:this.state.modAllocation,modAllocationItems:this.state.modAllocationItems,validationErrors:this.state.validationErrors,onFieldChange:this.handleChange,listOptions:e,isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,handleViewItems:this.getAllocationItems,handleViewShipments:this.getAllocationShipments,selectedAssociations:this.state.selectedAssociations,handleRowSelectionChange:this.handleAssociationSelectionChange,handleCellDataEdit:this.handleCellDataEdit,onDateTextChange:this.handleDateTextChange,handleAddAssociation:this.handleAddAssociation,handleDeleteAssociation:this.handleDeleteAssociation,toggleExpand:this.toggleExpand,expandedRows:this.state.expandedRows,compartmentDetailsPageSize:this.props.userDetails.EntityResult.PageAttibutes.WebPortalListPageSize,handleCompAttributeCellDataEdit:this.handleCompAttributeCellDataEdit,allocationType:this.props.allocationType})}),(0,m.jsx)(g.A,{children:(0,m.jsx)(E.q,{handleBack:this.props.onBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.saveEnabled})}),this.state.showAuthenticationLayout?(0,m.jsx)(O.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:""===this.state.allocation.ShareholderCode?v.i.add:v.i.modify,functionGroup:this.getFunctionGroupName(),handleOperation:this.saveAllocation,handleClose:this.handleAuthenticationClose}):null]})]}):(0,m.jsx)(b.A,{message:"Loading"})}}const j=(0,S.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(M)},43503:(e,t,o)=>{o.d(t,{A:()=>n});o(65043);var a=o(67907),i=o(72711),l=o(70579);function s(e){let{entityCode:t,newEntityName:o,popUpContents:s}=e;return(0,l.jsx)(a.TranslationConsumer,{children:e=>(0,l.jsx)("div",{className:"headerContainer",children:(0,l.jsxs)("div",{className:"row headerSpacing",children:[(0,l.jsx)("div",{className:"col paddingHeaderItemLeft",children:(0,l.jsx)("span",{style:{margin:"auto"},className:"headerLabel",children:""===t||void 0===t?e(o):t})}),""!==t&&void 0!==t&&s.length>0?(0,l.jsx)("div",{className:"headerItemRight",children:(0,l.jsx)(i.Popup,{element:(0,l.jsxs)("div",{children:[e(s[0].fieldName)+" ",":"," "+s[0].fieldValue,(0,l.jsx)(i.Icon,{style:{marginLeft:"10px"},root:"common",name:"caret-down",size:"small"})]}),position:"bottom left",children:(0,l.jsx)(i.List,{className:"detailsHeaderPopUp",children:s.map((t=>(0,l.jsxs)(i.List.Content,{className:"detailsHeaderPopUpListPadding",children:[e(t.fieldName)+" ",":"," "+t.fieldValue]},"content.fieldName")))})})}):""]})})})}s.defaultProps={entityCode:"",newEntityName:"",popUpContents:[]};const n=s},9256:(e,t,o)=>{o.d(t,{q:()=>s});o(65043);var a=o(72711),i=o(67907),l=o(70579);function s(e){let{handleBack:t,handleSave:o,handleReset:s,saveEnabled:n}=e;return(0,l.jsx)(i.TranslationConsumer,{children:e=>(0,l.jsxs)("div",{className:"row userActionPosition",children:[(0,l.jsx)("div",{className:"col-12 col-md-3 col-lg-4",children:(0,l.jsx)(a.Button,{className:"backButton",onClick:t,content:e("Back")})}),(0,l.jsx)("div",{className:"col-12 col-md-9 col-lg-8",children:(0,l.jsxs)("div",{style:{float:"right"},children:[(0,l.jsx)(a.Button,{content:e("LookUpData_btnReset"),className:"cancelButton",onClick:s}),(0,l.jsx)(a.Button,{content:e("Save"),disabled:!n,onClick:o})]})})]})})}s.defaultProps={saveEnabled:!1}},15417:(e,t,o)=>{o.d(t,{$7:()=>x,AN:()=>oe,AU:()=>R,Ak:()=>Ve,Ao:()=>a,B6:()=>Z,C4:()=>ke,CG:()=>K,Ct:()=>W,Cw:()=>w,EY:()=>b,G$:()=>Ze,G6:()=>$e,GF:()=>me,GJ:()=>j,Gj:()=>he,Gl:()=>le,H9:()=>Ye,HB:()=>Ne,HP:()=>f,Hr:()=>be,II:()=>it,IQ:()=>y,Jr:()=>q,Jx:()=>Ie,Ki:()=>te,LP:()=>ie,Lv:()=>l,MK:()=>E,MX:()=>ee,Mx:()=>B,N4:()=>Me,NH:()=>Se,OF:()=>Je,Ps:()=>F,Q7:()=>We,QY:()=>k,SF:()=>s,Sq:()=>Te,Sw:()=>ne,TQ:()=>X,U7:()=>N,UH:()=>C,UO:()=>se,V_:()=>Pe,Vy:()=>_e,W9:()=>de,WN:()=>I,Wr:()=>i,Ww:()=>$,XP:()=>ve,Xk:()=>Y,Yb:()=>ge,Yy:()=>p,Z2:()=>je,ZN:()=>L,ZO:()=>De,Zu:()=>qe,_G:()=>G,_N:()=>h,_u:()=>ce,ad:()=>re,al:()=>ye,ao:()=>_,bK:()=>V,bN:()=>S,cf:()=>O,dO:()=>xe,dU:()=>m,dv:()=>n,eE:()=>z,g:()=>T,gG:()=>r,gS:()=>Re,gT:()=>ot,gW:()=>J,gZ:()=>Xe,go:()=>v,gp:()=>U,hq:()=>Oe,i6:()=>et,ip:()=>ue,k9:()=>A,kI:()=>D,l4:()=>we,l5:()=>g,lA:()=>M,lU:()=>Ke,mD:()=>Ue,mY:()=>H,mq:()=>d,n$:()=>at,n7:()=>u,nZ:()=>Le,rA:()=>He,s$:()=>Fe,s8:()=>Qe,se:()=>Ee,tA:()=>fe,vK:()=>tt,vs:()=>Ce,w2:()=>ze,w4:()=>Ae,wT:()=>c,wY:()=>P,wf:()=>pe,wk:()=>ae,xW:()=>Q,yM:()=>Ge,yO:()=>Be});const a="driver",i="carriercompany",l="shareholder",s="baseProduct",n="TRAILER",r="TRAILERCOMPARTMENT",d="terminal",c="customer",h="destination",u="finishedproduct",m="tank",p="marine_vessel",A="marine_trailercompartment",C="supplier",E="vehicle",S="vehicletrailer",I="originterminal",y="bay",D="loadingArm",g="cardreader",T="vehicleprimemover",f="meter",b="SHIPMENT",N="SHIPMENTCOMPARTMENT",R="SHIPMENTDESTINATIONCOMPARTMENT",v="SHIPMENTDETAILS",P="SHIPMENTTRAILERWEIGHBRIDGE",x="SHIPMENTTRAILER",L="SHIPMENTSTATUSTIME",O="MARINEDISPATCH",M="MARINEDISPATCHCOMPARTMENTDETAIL",j="railwagon",w="primemover",H="bcu",k="RAILRECEIPTPLAN",F="RAILRECEIPTWAGONDETAILPLAN",_="RAILUNLOADINGDETAILSFP",U="RAILUNLOADINGDETAILSBP",Q="RAILUNLOADINGDETAILSADDITIVE",q="RAILDISPATCHPLAN",V="RAILDISPATCHITEM",G="RAILDISPATCHSTATUSCHANGE",B="RAILDISPATCHWAGON",W="RAILDISPATCHWAGONDETAILPLAN",Y="RAILDISPATCHWAGONWEIGHBRIDGE",Z="RAILDISPATCHWAGONCOMPARTMENT",z="RAILLOADINGDETAILSFP",K="RAILLOADINGDETAILSBP",J="RAILLOADINGDETAILSADDITIVE",$="marineReceipt",X="UNACCOUNTEDMETERTRANSACTION",ee="UNACCOUNTEDTANKTRANSACTION",te="marineLoadingDetailsFP",oe="marineLoadingDetailsAdditive",ae="marineLoadingDetailsBP",ie="marineReceiptCompartmentDetail",le="marineUnloadingDetailsFP",se="marineUnloadingDetailsBP",ne="accessCard",re="LOADINGDETAILSFP",de="LOADINGDETAILSBP",ce="LOADINGDETAILSADDITIVE",he="MARINERECEIPTSTATUSTIME",ue="MARINEDISPATCHSTATUSTIME",me="RECEIPT",pe="UNLOADINGTRANSACTIONS",Ae="ORDER",Ce="ORDERITEM",Ee="CONTRACT",Se="CONTRACT_ITEM",Ie="RECEIPTORIGINTERMINALCOMPARTMENT",ye="GeneralTMUser_CAPTAIN",De="weighbridge",ge="deu",Te="GeneralTMUser_STAFF",fe="GeneralTMUser_VISITOR",be="PIPELINEHEADER",Ne="SEALMASTER",Re="PIPELINERECEIPT",ve="ROADSHIPMENTSLOTINFO",Pe="ROADRECEIPTSLOTINFO",xe="MARINESHIPMENTSLOTINFO",Le="MARINERECEIPTSLOTINFO",Oe="PIPELINEDISPATCH",Me="PIPELINETRANSACTIONS",je="PIPELINEDISPATCHSTATUSTIME",we="PIPELINERECEIPTSTATUSTIME",He="PROCESSCONFIG",ke="PRODUCTALLOCATIONITEM",Fe="HSEINSPECTIONSHIPMENTRIGIDTRUCK",_e="HSEINSPECTIONSHIPMENTTRAILER",Ue="HSEINSPECTIONSHIPMENTPRIMEMOVER",Qe="HSEINSPECTIONSHIPMENTNONFILLINGVEHICLE",qe="HSEINSPECTIONMARINESHIPMENTBARGE",Ve="HSEINSPECTIONMARINESHIPMENTSHIP",Ge="HSEINSPECTIONSHIPMENTRAILWAGON",Be="HSEINSPECTIONSHIPMENTPIPELINE",We="HSEINSPECTIONRECEIPTRIGIDTRUCK",Ye="HSEINSPECTIONRECEIPTTRAILER",Ze="HSEINSPECTIONRECEIPTPRIMEMOVER",ze="HSEINSPECTIONRECEIPTNONFILLINGVEHICLE",Ke="HSEINSPECTIONMARINERECEIPTBARGE",Je="HSEINSPECTIONMARINERECEIPTSHIP",$e="HSEINSPECTIONRECEIPTRAILWAGON",Xe="HSEINSPECTIONRECEIPTPIPELINE",et="SHAREHOLDERAGREEMENT",tt="COATEMPLATE",ot="COAMANAGEMENT",at="COACUSTOMER",it="COAASSIGNMENT"},35861:(e,t,o)=>{o.d(t,{F1:()=>n,i7:()=>r,r4:()=>s});var a=o(86178),i=o.n(a),l=(o(15660),o(65043),o(70579));function s(e,t){if(Array.isArray(e)){0===e.filter((e=>e.text===t)).length&&e.unshift({value:null,text:t})}return e}function n(){let e=window.navigator.userLanguage||window.navigator.language;return i().locale(e),i().localeData().longDateFormat("L")}function r(e){return(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{children:e}),(0,l.jsx)("div",{class:"ui red circular empty label badge  circle-padding"})]})}}}]);
//# sourceMappingURL=8278.d4d34112.chunk.js.map