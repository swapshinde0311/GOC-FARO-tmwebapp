"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[4280],{74280:(e,t,i)=>{i.r(t),i.d(t,{default:()=>V});var s=i(65043),a=i(78374),l=i(72711),n=i(67907),o=i(65187),r=i(35861),c=i(69062),d=i(85800),p=i(70579);function h(e){let{pipelineReceipt:t,modPipelineReceipt:i,validationErrors:s,listOptions:h,onFieldChange:u,selectedAssociations:m,handleAssociationSelectionChange:R,handleCellDataEdit:g,handleAddAssociation:C,handleDeleteAssociation:T,dropdownOptions:S,handlePipelineHeaderChange:P,isEnterpriseNode:y,handleTerminalChange:E,onAttributeDataChange:D,modAttributeMetaDataList:b,attributeValidationErrors:v,onTabChange:x,activeTab:A,loadingDetails:f,loadingDetailsTab:k,pipelineSnapShotInfo:j,handleCellCheck:L,isMeterRequired:M,isTankRequired:N,onDateTextChange:I}=e;const[_]=(0,n.useTranslation)(),O=(e,t)=>(0,p.jsx)(l.Select,{className:"selectDropwdown",value:i.PipelineReceiptTanks[e.rowIndex][e.field],fluid:!0,options:t,onChange:t=>g(t,e),indicator:"required",reserveSpace:!1,search:!0,noResultsMessage:_("noResultsMessage")}),w=e=>(0,p.jsx)(l.Input,{fluid:!0,value:i.PipelineReceiptTanks[e.rowIndex][e.field],onChange:t=>g(t,e),reserveSpace:!1}),U=e=>(0,p.jsx)(l.DatePicker,{fluid:!0,value:null===i.PipelineReceiptTanks[e.rowIndex][e.field]?"":new Date(i.PipelineReceiptTanks[e.rowIndex][e.field]),type:"datetime",displayFormat:(0,r.F1)(),indicator:"required",onChange:t=>g(t,e),onTextChange:(t,i)=>{I(e,t,i)},reserveSpace:!1}),H=e=>{const{value:t}=e;return null!==t?new Date(t).toLocaleDateString()+" "+new Date(t).toLocaleTimeString():""},V=(e,t)=>{let i=[];return i=e.find((e=>e.TerminalCode===t)),i.attributeValidationErrors},Q=e=>(0,p.jsx)(l.Checkbox,{className:"forceCompleteChkBox",checked:e.value,onChange:t=>{L(e,t)}});return(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsxs)("div",{className:"detailsContainer",children:[(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(l.Input,{fluid:!0,value:i.PipelineReceiptCode,indicator:"required",disabled:""!==t.PipelineReceiptCode,onChange:e=>u("PipelineReceiptCode",e),label:e("PipelineReceiptDetails_ReceiptCode"),error:e(s.PipelineReceiptCode),reserveSpace:!1})}),y?(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(l.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("TerminalCode"),value:null===i.TerminalCodes||0===i.TerminalCodes.length?"":i.TerminalCodes[0],disabled:""!==t.PipelineReceiptCode,onChange:e=>E(e),indicator:"required",error:e(s.TerminalCodes),options:c.Zj(S.terminalCodes),reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}):"",(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(l.Select,{fluid:!0,indicator:"required",label:e("PipelineReceiptDetails_CustomerCode"),value:i.SupplierCode,onChange:e=>u("SupplierCode",e),error:e(s.SupplierCode),options:h.suppliers,reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(l.Select,{fluid:!0,indicator:"required",label:e("PipelineReceiptDetails_Destination"),value:i.OriginTerminalCode,onChange:e=>u("OriginTerminalCode",e),error:e(s.OriginTerminalCode),options:h.originTerminals,reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(l.Input,{fluid:!0,value:null===i.PipelineReceiptStatus?"":i.PipelineReceiptStatus,label:e("PipelineReceiptDetails_ReceiptStatus"),reserveSpace:!1,disabled:!0})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(l.Select,{fluid:!0,indicator:"required",label:e("PipelineReceiptDetails_HeaderLineCode"),value:i.PipelineHeaderCode,onChange:e=>P(e),error:e(s.PipelineHeaderCode),options:S.pipelineHeaderOptions,reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(l.Select,{fluid:!0,label:e("PipelineReceiptDetails_BulkTransactionMeter"),value:null===i.PipelineHeaderMeterCode?"":i.PipelineHeaderMeterCode,onChange:e=>u("PipelineHeaderMeterCode",e),options:S.pipelineHeaderMeterOptions,reserveSpace:!1,indicator:M?"required":"",noResultsMessage:e("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(l.Input,{fluid:!0,value:null===i.Quantity?"":i.Quantity,indicator:"required",onChange:e=>u("Quantity",e),label:e("PipelineReceiptDetails_Quantity"),error:e(s.Quantity),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(o.A,{children:(0,p.jsx)(l.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("PipelineReceiptDetails_UOM"),value:null===i.QuantityUOM?"":i.QuantityUOM,multiple:!1,indicator:"required",options:h.quantityUOM,onChange:e=>u("QuantityUOM",e),error:e(s.QuantityUOM),disabled:0===h.quantityUOM.length,reserveSpace:!1,noResultsMessage:e("noResultsMessage")})})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(l.Select,{fluid:!0,indicator:"required",label:e("PipelineReceiptDetails_FinishedProductCode"),value:i.FinishedProductCode,onChange:e=>u("FinishedProductCode",e),error:e(s.FinishedProductCode),options:h.finishedProducts,reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4 starttime",children:(0,p.jsx)(l.DatePicker,{fluid:!0,value:null===i.ScheduledStartTime?"":new Date(i.ScheduledStartTime),label:e("PipelineReceiptDetails_ExpectedStartTime"),type:"datetime",displayFormat:(0,r.F1)(),disablePast:!1,indicator:"required",onChange:e=>u("ScheduledStartTime",e),error:e(s.ScheduledStartTime),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4 ",children:(0,p.jsx)(l.DatePicker,{fluid:!0,value:null===i.ScheduledEndTime?"":new Date(i.ScheduledEndTime),label:e("PipelineReceiptDetails_ExpectedEndTime"),type:"datetime",displayFormat:(0,r.F1)(),disablePast:!1,indicator:"required",onChange:e=>u("ScheduledEndTime",e),error:e(s.ScheduledEndTime),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(l.Input,{fluid:!0,value:i.Remarks,label:e("Cust_Remarks"),onChange:e=>u("Remarks",e),error:e(s.Remarks),reserveSpace:!1})})]}),b.length>0?b.map((t=>(0,p.jsx)(o.A,{children:(0,p.jsx)(l.Accordion,{children:(0,p.jsx)(l.Accordion.Content,{className:"attributeAccordian",title:y?t.TerminalCode+" - "+e("Attributes_Header"):e("Attributes_Header"),children:(0,p.jsx)(d.n,{selectedAttributeList:t.attributeMetaDataList,handleCellDataEdit:D,attributeValidationErrors:V(v,t.TerminalCode)})})})}))):null,(0,p.jsx)("div",{className:"shipmentTabAlignment",children:(0,p.jsxs)(l.Tab,{activeIndex:A,onTabChange:e=>{x(e)},children:[(0,p.jsxs)(l.Tab.Pane,{title:e("PipelineReceiptDetails_ReceiptTankPlanning"),children:[(0,p.jsx)("div",{className:"row compartmentRow",children:(0,p.jsx)("div",{className:"col",children:(0,p.jsxs)("div",{className:"compartmentIconContainer",children:[(0,p.jsxs)("div",{onClick:C,className:"compartmentIcon",children:[(0,p.jsx)("div",{children:(0,p.jsx)(l.Icon,{root:"common",name:"badge-plus",size:"medium"})}),(0,p.jsx)("div",{className:"margin_l10",children:(0,p.jsx)("h5",{className:"font14",children:e("FinishedProductInfo_Add")})})]}),(0,p.jsxs)("div",{onClick:T,className:"compartmentIcon margin_l30",children:[(0,p.jsx)("div",{children:(0,p.jsx)(l.Icon,{root:"common",name:"delete",size:"medium"})}),(0,p.jsx)("div",{className:"margin_l10",children:(0,p.jsx)("h5",{className:"font14",children:e("DestAdd_Delete")})})]})]})})}),(0,p.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(a.bQ,{data:i.PipelineReceiptTanks,selectionMode:"multiple",selection:m,onSelectionChange:R,children:[(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"TankCode",header:N?(0,r.i7)(e("PipelineReceipt_TankCode")):e("PipelineReceipt_TankCode"),editable:!0,editFieldType:"text",customEditRenderer:e=>O(e,S.tankCodeOptions)},"TankCode"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"Quantity",header:e("PipelineReceiptDetails_Quantity"),editable:!0,editFieldType:"text",renderer:e=>(e=>{const{value:t}=e;return"number"===typeof t?t.toLocaleString():t})(e),customEditRenderer:w},"Quantity"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"PlannedStartTime",header:e("PipelineReceiptDetails_ExpectedStartTime"),editable:!0,editFieldType:"text",renderer:e=>H(e),customEditRenderer:e=>U(e)},"PlannedStartTime"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"PlannedEndTime",header:e("PipelineReceiptDetails_ExpectedEndTime"),editable:!0,editFieldType:"text",renderer:e=>H(e),customEditRenderer:e=>U(e)},"PlannedEndTime")]})})})]}),k.map((t=>(0,p.jsxs)(l.Tab.Pane,{title:e("ViewReceipt_LoadingDetails"),children:[(0,p.jsx)(l.Accordion,{children:(0,p.jsxs)(l.Accordion.Content,{title:e("PipelineDispatchDetails_TransactionSummary"),children:[" ",(0,p.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(a.bQ,{data:j,scrollable:!0,scrollHeight:"320px",children:[(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"ReceivedGrossQuantity",header:e("PipelineDispatchTransaction_ActualGrossQuantity"),editable:!1,editFieldType:"text"},"ReceivedGrossQuantity"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"ReceivedNetQuantity",header:e("PipelineDispatchTransaction_ActualNetQuantity"),editable:!1},"ReceivedNetQuantity"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"RationPending",header:e("PipelineDispatchTransaction_RationPending"),editable:!1},"RationPending"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"ReceivedQuantityUOM",header:e("PipelineDispatchTransaction_ActualQuantityUOM"),editable:!1},"ReceivedQuantityUOM"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"PlannedStartTime",header:e("PipelineDispatchTransaction_ExpectedStartDateTime"),editable:!1},"PlannedStartTime"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"PlannedEndTime",header:e("PipelineDispatchTransaction_ExpectedEndDateTime"),editable:!1},"PlannedEndTime"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"ActualStartTime",header:e("PipelineDispatchTransaction_ActualStartDateTime"),editable:!1},"ActualStartTime"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"ActualEndTime",header:e("PipelineDispatchTransaction_ActualEndDateTime"),editable:!1},"ActualEndTime"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"IsInvalid",header:e("PipelineDispatchTransaction_Ignore"),renderer:Q},"IsInvalid")]})})}),(0,p.jsx)("div",{className:"row",children:(0,p.jsx)("div",{className:"col col-lg-4"})})]})}),(0,p.jsx)(l.Accordion,{children:(0,p.jsxs)(l.Accordion.Content,{title:e("PipelineDispatchDetails_TankTransactionSummary"),children:[" ",(0,p.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(a.bQ,{data:f.Table2,scrollable:!0,scrollHeight:"320px",children:[(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"TankCode",header:e("PipelineReceipt_TankCode"),editable:!1,editFieldType:"text"},"TankCode"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"StartGrossVolume",header:e("TankTransaction_StartGrossVolume"),editable:!1},"StartGrossVolume"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"EndGrossVolume",header:e("TankVolume_EndGrossVolume"),editable:!1},"EndGrossVolume"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"StartNetVolume",header:e("TankTransaction_StartNetVolume"),editable:!1},"StartNetVolume"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"EndNetVolume",header:e("TankVolume_EndNetVolume"),editable:!1},"EndNetVolume"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"Density",header:e("PipelineEntry_Density"),editable:!1},"Density"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"Temperature",header:e("PipelineEntry_Temparature"),editable:!1},"Temperature")]})})}),(0,p.jsx)("div",{className:"row",children:(0,p.jsx)("div",{className:"col col-lg-4"})})]})}),(0,p.jsx)(l.Accordion,{children:(0,p.jsxs)(l.Accordion.Content,{title:e("PipelineDispatchDetails_MeterTransactionSummary"),children:[" ",(0,p.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(a.bQ,{data:f.Table1,scrollable:!0,scrollHeight:"320px",children:[(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"MeterCode",header:e("LoadingDetails_MeterCode"),editable:!1,editFieldType:"text"},"MeterCode"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"StartGrossTotalizer",header:e("Reconciliation_StartGrossTotalizer"),editable:!1},"StartGrossTotalizer"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"EndGrossTotalizer",header:e("End Gross Totalizer"),editable:!1},"EndGrossTotalizer"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"StartNetTotalizer",header:e("Start Net Totalizer"),editable:!1},"StartNetTotalizer"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"EndNetTotalizer",header:e("End Net Totalizer"),editable:!1},"EndNetTotalizer"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"Density",header:e("PipelineEntry_Density"),editable:!1},"Density"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"Temperature",header:e("PipelineEntry_Temparature"),editable:!1},"Temperature")]})})})]})})]})))]})})]})})}h.defaultProps={dropdownOptions:{pipelineHeaderOptions:[],pipelineHeaderMeterOptions:[],tankCodeOptions:[],terminalCodes:[]},isEnterpriseNode:!1};var u=i(9256),m=i(44192),R=i(46100),g=i(40854),C=i.n(g),T=i(72067),S=i(7523),P=i(9966),y=i(50805),E=i(97508),D=(i(38726),i(43503)),b=i(93779),v=i(80312),x=i(53536),A=i.n(x),f=i(28882),k=i(40252),j=i(15417),L=i(11981),M=i(14159),N=i(24947),I=i(61227),_=i(91684),O=i(40510),w=i(39424),U=i(62900);class H extends s.Component{constructor(){super(...arguments),this.state={pipelineReceipt:{...R.a2},modPipelineReceipt:{},modAssociations:[],loadingDetails:{},validationErrors:c.Th(m.LT),isReadyToRender:!1,listOptions:{quantityUOM:[],suppliers:[],originTerminals:[],finishedProducts:[],terminalCodes:this.props.terminalCodes},quantityUOMOptions:[],supplierOptions:[],originTerminalOptions:[],pipelineHeaderOptions:[],pipelineHeaderMeterOptions:[],finishedProductOptions:[],tankOptions:[],saveEnabled:!1,selectedAssociations:[],attributeMetaDataList:[],attributeValidationErrors:[],modAttributeMetaDataList:[],activeTab:0,isManualEntry:!1,currentReceiptStatus:[],drawerStatus:!0===this.props.userDetails.EntityResult.IsWebPortalUser,isViewAuditTrail:!1,modAuditTrailList:[],auditTrailList:[],Remarks:"",RemarksPopUp:!1,UOMS:{},isMeterRequired:!1,isTankRequired:!0,pipelineSnapShotInfo:[],isSubmit:!1,viewAuditTrailAttributeMetaDataList:[],shipmentNextOperations:[],pipelineReceiptKPIList:[],tempPipelineReceipt:{}},this.handleAttributeDataChange=(e,t)=>{try{let i=[],s=A().cloneDeep(this.state.modAttributeMetaDataList),a=s.filter((t=>t.TerminalCode===e.TerminalCode));a.length>0&&Array.isArray(a[0].attributeMetaDataList)&&(i=a[0].attributeMetaDataList.filter((t=>t.Code===e.Code))),i.length>0&&(i[0].DefaultValue=t),this.setState({modAttributeMetaDataList:s});const l=A().cloneDeep(this.state.attributeValidationErrors);l.forEach((i=>{i.TerminalCode===e.TerminalCode&&(i.attributeValidationErrors[e.Code]=c.I5(e,t))})),this.setState({attributeValidationErrors:l})}catch(i){console.log("PipelineReceiptDetailsComposite:Error occured on handleAttributeCellDataEdit",i)}},this.addUpdatePipelineReceipt=()=>{try{this.setState({saveEnabled:!1});let e=A().cloneDeep(this.state.tempPipelineReceipt);""===this.state.pipelineReceipt.PipelineReceiptCode?this.createPipelineReceipt(e):this.updatePipelineReceipt(e)}catch(e){console.log("pipeline Receipt Composite : Error in addUpdatePipelineReceipt")}},this.handleSave=()=>{try{let e=this.fillDetails(),t=c.pI(this.state.modAttributeMetaDataList);if(this.validateSave(e,t)){e=this.convertStringtoDecimal(e,t);let i=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,s=A().cloneDeep(e);this.setState({showAuthenticationLayout:i,tempPipelineReceipt:s},(()=>{!1===i&&this.addUpdatePipelineReceipt()}))}else this.setState({saveEnabled:!0})}catch(e){console.log("PipelineReceiptDetailsComposite:Error occured on handleSave",e)}},this.handleReset=()=>{try{const{validationErrors:e}={...this.state},t=A().cloneDeep(this.state.pipelineReceipt);Object.keys(e).forEach((function(t){e[t]=""})),this.setState({modPipelineReceipt:{...t},modAssociations:[],validationErrors:e})}catch(e){console.log("PipelineReceiptDetailsComposite:Error occured on handleReset",e)}},this.handleChange=(e,t)=>{try{const i=A().cloneDeep(this.state.modPipelineReceipt),s=A().cloneDeep(this.state.validationErrors);i[e]=t,"SupplierCode"===e&&(this.setOriginTerminals(t),1===this.state.listOptions.supplierOriginTerminalOptions[t].length?i.OriginTerminalCode=this.state.listOptions.supplierOriginTerminalOptions[t][0]:i.OriginTerminalCode=""),this.setState({modPipelineReceipt:i}),void 0!==m.LT[e]&&(s[e]=c.jr(m.LT[e],t),this.setState({validationErrors:s}))}catch(i){console.log("PipelinReceiptDetailsComposite:Error occured on handleChange",i)}},this.handleAssociationSelectionChange=e=>{try{this.setState({selectedAssociations:e})}catch(t){console.log("error in handlAssociationselectionchange",t)}},this.handleCellDataEdit=(e,t)=>{try{let i=A().cloneDeep(this.state.modPipelineReceipt);i.PipelineReceiptTanks[t.rowIndex][t.field]=e,this.setState({modPipelineReceipt:i})}catch(i){console.log("Error in handleCellDataEdit",i)}},this.handleDateTextChange=(e,t,i)=>{try{var s=A().cloneDeep(this.state.modPipelineReceipt);let i=s.PipelineReceiptTanks.findIndex((t=>t.sequenceNo===e.rowData.sequenceNo));i>=0&&(s.PipelineReceiptTanks[i][e.field]=""===t?null:t,this.setState({modPipelineReceipt:s}))}catch(i){console.log("Error in DateTextChange : Error occured on handleDateTextChange",i)}},this.handleAddAssociation=()=>{try{if(!this.props.userDetails.EntityResult.IsArchived)try{let e=A().cloneDeep(this.state.modPipelineReceipt),t={PipelineReceiptCode:"",TankCode:null,PipelineTankMeterCode:null,Quantity:0,QuantityUOM:"",PlannedStartTime:null,PlannedEndTime:null,sequenceNo:c.Mz(e.PipelineReceiptTanks)};e.PipelineReceiptTanks.push(t),this.setState({modPipelineReceipt:e,selectedAssociations:[]})}catch(e){console.log("PipelineReceiptDetailsComposite:Error occured on handleAddAssociation",e)}}catch(e){console.log("PipelineReceiptDetailsComposite: Error occured on handleAddAssociation",e)}},this.handleDeleteAssociation=()=>{try{if(!this.props.userDetails.EntityResult.IsArchived)try{if(null!=this.state.selectedAssociations&&this.state.selectedAssociations.length>0&&this.state.modPipelineReceipt.PipelineReceiptTanks.length>0){let e=A().cloneDeep(this.state.modPipelineReceipt);this.state.selectedAssociations.forEach(((t,i)=>{e.PipelineReceiptTanks=e.PipelineReceiptTanks.filter(((e,i)=>e.sequenceNo!==t.sequenceNo))})),this.setState({modPipelineReceipt:e})}this.setState({selectedAssociations:[]})}catch(e){console.log("PipelineReceiptDetailsComposite:Error occured on handleDeleteAssociation",e)}}catch(e){console.log("error in handle Delete Association",e)}},this.handlePipelineHeaderChange=e=>{try{const t=A().cloneDeep(this.state.modPipelineReceipt);t.PipelineHeaderCode=e,this.setState({modPipelineReceipt:t}),this.getPipelineMeter(e,t.TerminalCodes[0])}catch(t){console.log("PipelineReceiptDetailsComposite:Error occured on handlePipelineHeaderChange",t)}},this.handleTerminalChange=e=>{try{const t=A().cloneDeep(this.state.modPipelineReceipt);null===e?t.TerminalCodes=[]:(t.TerminalCodes[0]=e,t.PipelineHeaderCode="",t.PipelineHeaderMeterCode=null,t.FinishedProductCode=""),this.setState({modPipelineReceipt:t,pipelineHeaderMeterOptions:[]},(()=>{this.getTank(e),this.getHeaderLineCode(e),this.getSupplierOriginTerminals(this.props.selectedShareholder,t.SupplierCode,e),this.getFinishedProductCodes(this.props.selectedShareholder,e)}))}catch(t){console.log("PipelineReceiptDetailsComposite:Error occured on handleTerminalChange",t)}},this.handleTabChange=e=>{try{this.setState({activeTab:e,expandedRows:[]})}catch(t){console.log("RailreceiptDetailsComposite: Error occurred on handleTabChange",t)}},this.handleDrawer=()=>{var e=A().cloneDeep(this.state.drawerStatus);this.setState({drawerStatus:!e})},this.onBack=()=>{let e=this.getDispatchUpdateStates();this.setState({isManualEntry:!1,saveEnabled:e.indexOf(this.state.pipelineReceipt.PipelineReceiptStatus)&&c.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.modify,v.$3),isViewAuditTrail:!1,drawerStatus:!1}),this.getPipelineReceipt({Common_Code:this.state.pipelineReceipt.PipelineReceiptCode})},this.handleCloseReceipttModal=()=>(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsxs)(l.Modal,{open:this.state.RemarksPopUp,size:"mini",children:[(0,p.jsxs)(l.Modal.Content,{children:[(0,p.jsx)("div",{className:"col col-lg-12",children:(0,p.jsx)("h3",{children:e("ViewPipelineDispatch_CloseHeader")+" : "+this.state.modPipelineReceipt.PipelineReceiptCode})}),(0,p.jsx)("div",{style:{display:"flex",flexWrap:"wrap"},children:(0,p.jsx)("div",{className:"col col-lg-12",children:(0,p.jsx)(l.Input,{fluid:!0,value:this.state.Remarks,reserveSpace:!1,onChange:e=>{this.setState({Remarks:e})}})})})]}),(0,p.jsxs)(l.Modal.Footer,{children:[(0,p.jsx)(l.Button,{type:"primary",content:e("AccessCardInfo_Ok"),onClick:()=>{if(""===this.state.Remarks){let e={messageType:"critical",message:"ViewPipelineReceipt_ShipmentClose",messageResultDetails:[{keyFields:["ReceiptCode"],keyValues:[this.state.modPipelineReceipt.PipelineReceiptCode],isSuccess:!1,errorMessage:"Enter_Receipt_ReasonForCloseure"}]};(0,M.toast)((0,p.jsx)(o.A,{children:(0,p.jsx)(L.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})}else this.setState({RemarksPopUp:!1},(()=>{this.state.isSubmit?this.handleSubmit():this.handleReceiptClose()}))}}),(0,p.jsx)(l.Button,{type:"primary",content:e("Cancel"),onClick:()=>{this.setState({RemarksPopUp:!1,Remarks:""})}})]})]})}),this.handleCellCheck=(e,t)=>{try{let i=A().cloneDeep(this.state.pipelineSnapShotInfo);const s=i.findIndex((t=>t.SeqNumber===e.rowData.SeqNumber));s>-1&&(i[s].IsInvalid=t),this.setState({pipelineSnapShotInfo:i})}catch(i){console.log("Error in handleCellcheck",i)}},this.handleOperationClick=e=>{let t=A().cloneDeep(this.state.pipelineReceipt),i={messageType:"critical",message:e+"_status",messageResultDetails:[{keyFields:["ReceiptDetail_ReceiptNumber"],keyValues:[t.PipelineReceiptCode],isSuccess:!1,errorMessage:""}]};switch(e){case S.DH.Authorize_ManualEntry_Update:this.props.handleAuthorizeToManualEntry(t,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{i.messageType=e.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=e.IsSuccess,!0===e.IsSuccess?this.getPipelineReceipt({Common_Code:t.PipelineReceiptCode},1):i.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,M.toast)((0,p.jsx)(o.A,{children:(0,p.jsx)(L.A,{notificationMessage:i})}),{autoClose:"success"===i.messageType&&1e4})}));break;case S.DH.Authorize_Scada_Update:this.props.handleAuthorizeToUpdateScada(t,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{i.messageType=e.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=e.IsSuccess,!0===e.IsSuccess?this.getPipelineReceipt({Common_Code:t.PipelineReceiptCode},1):i.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,M.toast)((0,p.jsx)(o.A,{children:(0,p.jsx)(L.A,{notificationMessage:i})}),{autoClose:"success"===i.messageType&&1e4})}));break;case S.DH.PipelineDispatch_BtnManualEntry:this.setState({isManualEntry:!0});break;case S.DH.PipelineDispatch_BtnSubmit:this.setState({RemarksPopUp:!0,isSubmit:!0});break;case S.DH.PipelineDispatch_BtnClosed:this.setState({RemarksPopUp:!0,isSubmit:!1});break;case S.DH.PipelineDispatchList_btnViewTransactionReport:this.props.handleViewTransaction();break;case S.DH.PipelineDispatchList_btnTransactionReport:this.props.handlePrintTransaction(t,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{i.messageType=e.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=e.IsSuccess,!0===e.IsSuccess?this.getPipelineReceipt({Common_Code:t.PipelineReceiptCode},1):i.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,M.toast)((0,p.jsx)(o.A,{children:(0,p.jsx)(L.A,{notificationMessage:i})}),{autoClose:"success"===i.messageType&&1e4})}));break;case S.DH.PipelineDispatch_BtnAuditTrail:this.props.handleViewAuditTrail(t,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{if(!0===e.IsSuccess){let i=e.EntityResult,s=A().cloneDeep(this.state.viewAuditTrailAttributeMetaDataList);for(let e=0;e<i.length;e++){let t=i[e].PipelineReceiptStatus.toUpperCase();t===S.BJ.CLOSED?t=S.Jh.CLOSED:t===S.BJ.AUTHORIZED?t=S.Jh.AUTHORIZED:t===S.BJ.READY?t=S.Jh.READY:t===S.BJ.INPROGRESS?t=S.Jh.INPROGRESS:t===S.BJ.MANUALLY_COMPLETED&&(t=S.Jh.MANUALLY_COMPLETED),i[e].PipelineReceiptstatus=t,i[e].UpdatedTime=new Date(i[e].UpdatedTime).toLocaleDateString()+" "+new Date(i[e].UpdatedTime).toLocaleTimeString()}let a=e.EntityResult;for(let e=0;e<a.length;e++)a[e].AttributesforUI=this.formReadonlyCompAttributes(a[e].Attributes,s);this.setState({auditTrailList:e.EntityResult,modAuditTrailList:i,isViewAuditTrail:!0}),this.getPipelineReceipt({Common_Code:t.PipelineReceiptCode})}else i.messageType=e.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=e.IsSuccess,i.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,M.toast)((0,p.jsx)(o.A,{children:(0,p.jsx)(L.A,{notificationMessage:i})}),{autoClose:"success"===i.messageType&&1e4})}));break;default:return}},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentWillReceiveProps(e){try{""!==this.state.pipelineReceipt.PipelineReceiptCode&&void 0===e.selectedRow.Common_Code&&this.setState({isPlanned:!1,activeTab:0,isManualEntry:!1}),this.getPipelineReceipt(e.selectedRow,0)}catch(t){console.log("PipelineReceiptDetailsComposite:Error occured on componentWillReceiveProps",t)}}componentDidMount(){try{c.pJ(this.props.userDetails.EntityResult.IsArchived),this.getUoms(),this.getRefrenceSource(),this.getAttributes(this.props.selectedRow),this.props.userDetails.EntityResult.IsEnterpriseNode||(this.getTank(""),this.getHeaderLineCode(""),this.getSupplierOriginTerminals(this.props.selectedShareholder,null,""),this.getFinishedProductCodes(this.props.selectedShareholder,""),this.getPipelineMeter(this.props.selectedShareholder,""))}catch(e){console.log("PipelineReceiptDetailsComposite:Error occured on componentDidMount",e)}}getUoms(){try{C()(T.WFM,c.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult.VOLUME)){var i=A().cloneDeep(this.state.listOptions);if(null!==t.EntityResult&&Array.isArray(t.EntityResult.VOLUME)&&(i.quantityUOM=c.Zj(t.EntityResult.VOLUME)),Array.isArray(t.EntityResult.MASS)){c.Zj(t.EntityResult.MASS).forEach((e=>i.quantityUOM.push(e)))}this.setState({listOptions:i,UOMS:t.EntityResult})}}else console.log("Error in GetUOMList:",t.ErrorList)})).catch((e=>{console.log("Error in GetUOMList:",e)}))}catch(e){console.log("Error in GetUOMList",e)}}getFinishedProductCodes(e,t){try{C()(T.w43+"?ShareholderCode="+e+"&TerminalCode="+t,c.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){var i=A().cloneDeep(this.state.listOptions);i.finishedProducts=[],t.EntityResult.forEach((e=>{i.finishedProducts.push({text:e,value:e})})),this.setState({listOptions:i})}}else console.log("Error in GetFinishedProductCodes:",t.ErrorList)})).catch((e=>{console.log("Error while GetFinishedProductCodes List:",e)}))}catch(i){console.log("error in GetFinishProduct",i)}}getSupplierOriginTerminals(e,t,i){try{C()(T._fS+"?ShareholderCode="+e+"&Transportationtype="+S.LY.PIPELINE+"&TerminalCode="+i,c.Jm(this.props.tokenDetails.tokenInfo)).then((i=>{let s=i.data;if(!0===s.IsSuccess)if(Array.isArray(s.EntityResult)){let i=s.EntityResult.filter((t=>t.ShareholderCode===e));if(i.length>0){var a=A().cloneDeep(this.state.listOptions);a.supplierOriginTerminalOptions=i[0].SupplierOriginTerminalsList,a.suppliers=[],a.originTerminals=[];for(let e in a.supplierOriginTerminalOptions)a.suppliers.push({text:e,value:e});this.props.userDetails.EntityResult.IsEnterpriseNode&&(a.supplierOriginTerminalOptions=i[0].SupplierOriginTerminalsList),this.setState({listOptions:a}),t&&this.setOriginTerminals(t)}else console.log("no customers identified for shareholder")}else console.log("customerdestinations not identified for shareholder");else console.log("Error in getOriginTerminals:",s.ErrorList)})).catch((e=>{console.log("Error while getOriginTerminals List:",e)}))}catch(s){console.log("Error in getOriginTermials",s)}}getHeaderLineCode(e){try{C()(T.KNA+"?Terminal="+e,c.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){let e=c.Zj(t.EntityResult);this.setState({pipelineHeaderOptions:e})}}else console.log("Error in getHeaderLineCode:",t.ErrorList)})).catch((e=>{console.log("Error in getHeaderLineCode:",e)}))}catch(t){console.log("Error in getHeaderLineCode",t)}}getAttributes(e){try{C()(T.fKH,c.tW([j.gS,j.l4],this.props.tokenDetails.tokenInfo)).then((t=>{var i=t.data;!0===i.IsSuccess?this.setState({attributeMetaDataList:A().cloneDeep(i.EntityResult.PIPELINERECEIPT),viewAuditTrailAttributeMetaDataList:A().cloneDeep(i.EntityResult.PIPELINERECEIPTCHSTATUSTIME),attributeValidationErrors:c.Fl(i.EntityResult.PIPELINERECEIPT)},(()=>this.getPipelineReceipt(e))):console.log("Failed to get Attributes")}))}catch(t){console.log("Error while getting Attributes:",t)}}localNodeAttribute(){try{var e=A().cloneDeep(this.state.attributeMetaDataList);e.length>0&&this.terminalSelectionChange([e[0].TerminalCode])}catch(t){console.log("TrailerDetailsComposite:Error occured on localNodeAttribute",t)}}terminalSelectionChange(e){try{let a=[];var t=[],i=[];t=A().cloneDeep(this.state.attributeMetaDataList),i=A().cloneDeep(this.state.modAttributeMetaDataList);const l=A().cloneDeep(this.state.attributeValidationErrors);var s=A().cloneDeep(this.state.pipelineReceipt);e.forEach((e=>{var l=i.find((t=>t.TerminalCode===e));void 0===l?t.forEach((function(t){if(t.TerminalCode===e){var i=s.Attributes.find((t=>t.TerminalCode===e));void 0!==i&&t.attributeMetaDataList.forEach((function(e){var t=i.ListOfAttributeData.find((t=>t.AttributeCode===e.Code));void 0!==t&&(e.DefaultValue=t.AttributeValue)})),a.push(t)}})):a.push(l)})),i=[],i=a,i=c.nQ(i),l.forEach((t=>{void 0===e.find((e=>t.TerminalCode===e))&&Object.keys(t.attributeValidationErrors).forEach((e=>t.attributeValidationErrors[e]=""))})),this.setState({modAttributeMetaDataList:i,attributeValidationErrors:l})}catch(a){console.log("TrailerDetailsComposite:Error occured on terminalSelectionChange",a)}}fillAttributeDetails(e,t){try{return t=c.SC(t),e.Attributes=c.Gh(t),this.setState({modPipelineReceipt:e}),e}catch(i){console.log("PipelineReceiptDetailsComposite:Error occured on fillAttributeDetails",i)}}convertStringtoDecimal(e,t){try{return e=this.fillAttributeDetails(e,t)}catch(i){console.log("convertStringtoDecimal error PipelineDetails Details",i)}}getPipelineReceipt(e){try{let a=S.LY.PIPELINE;var{listOptions:t}={...this.state};if(void 0===e.Common_Code)return R.a2.QuantityUOM=this.props.userDetails.EntityResult.PageAttibutes.DefaultQtyUOMForTransactionUI.PIPELINE,R.a2.TransactionMode=S.LY.PIPELINE,R.a2.Quantity="",R.a2.ScheduledEndTime=new Date,R.a2.ScheduledStartTime=new Date,void this.setState({pipelineReceipt:{...R.a2},modPipelineReceipt:{...R.a2},listOptions:t,isReadyToRender:!0,activeTab:0,isPlanned:!1,pipelineReceiptKPIList:[],saveEnabled:c.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.add,v.$3)},(()=>{this.props.userDetails.EntityResult.IsEnterpriseNode?1===this.props.terminalCodes.length?this.terminalSelectionChange(this.props.terminalCodes):this.terminalSelectionChange([]):this.localNodeAttribute([])}));var i=[{key:b._C,value:e.Common_Code},{key:b.v6,value:a}],s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:b._C,KeyCodes:i};C()(T.VvZ,c.tW(s,this.props.tokenDetails.tokenInfo)).then((t=>{var i=t.data;if(console.log(i),!0===i.IsSuccess){i.EntityResult.code=e.Common_Code,null===i.EntityResult.PipelineReceiptTanks?i.EntityResult.PipelineReceiptTanks=[]:i.EntityResult.PipelineReceiptTanks=c.Q3(i.EntityResult.PipelineReceiptTanks),this.props.userDetails.EntityResult.IsEnterpriseNode?(this.getTank(i.EntityResult.TerminalCodes[0]),this.getHeaderLineCode(i.EntityResult.TerminalCodes[0]),this.getPipelineMeter(i.EntityResult.PipelineHeaderCode,i.EntityResult.TerminalCodes[0]),this.getSupplierOriginTerminals(this.props.selectedShareholder,i.EntityResult.SupplierCode,i.EntityResult.TerminalCodes[0]),this.terminalSelectionChange(i.EntityResult.TerminalCodes),this.getFinishedProductCodes(this.props.selectedShareholder,i.EntityResult.TerminalCodes[0])):(this.localNodeAttribute(),this.getPipelineMeter(i.EntityResult.PipelineHeaderCode,""));this.getDispatchUpdateStates();this.setState({isReadyToRender:!0,pipelineReceipt:i.EntityResult,modPipelineReceipt:{...i.EntityResult},isPlanned:!0,saveEnabled:c.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.modify,v.$3)},(()=>{this.GetSnapShotsForPlan(i.EntityResult),this.getSupplierOriginTerminals(this.props.selectedShareholder,i.EntityResult.SupplierCode,""),this.getReciptStatuses(e),this.getReceiptOperations(),this.getKPIList(this.props.selectedShareholder,i.EntityResult.PipelineReceiptCode)}))}else this.setState({pipelineReceipt:{...R.a2},modPipelineReceipt:{...R.a2},isReadyToRender:!0}),console.log("Error in getPipelineReceipt:",i.ErrorList)})).catch((e=>{console.log("Error while getting pipelineReceipt:",e)}))}catch(a){console.log("Error while getting pipelineReceipt",a)}}fillDetails(){let{modPipelineReceipt:e}={...this.state};try{null!==e.Quantity&&""!==e.Quantity&&(e.Quantity=c.bo(e.Quantity)),e.ShareholderCode=this.props.selectedShareholder,e.ScheduledStartTime.setSeconds(parseInt("00"),parseInt("000"));let t=[];Array.isArray(e.PipelineReceiptTanks)&&e.PipelineReceiptTanks.forEach((i=>{(null!==i.TankCode&&""!==i.TankCode||null!==i.Quantity&&""!==i.Quantity)&&(i.PipelineReceiptCode=e.PipelineReceiptCode,i.QuantityUOM=e.QuantityUOM,i.Quantity=c.bo(i.Quantity),i.PlannedStartTime=null===i.PlannedStartTime?e.ScheduledStartTime:i.PlannedStartTime,i.PlannedEndTime=null===i.PlannedEndTime?e.ScheduledEndTime:i.PlannedEndTime,t.push(i))})),e.PipelineReceiptTanks=t}catch(t){console.log("Error in fillDetails",t)}return e}validateSave(e,t){try{var i=A().cloneDeep(this.state.validationErrors);Object.keys(m.LT).forEach((function(t){void 0!==e[t]&&(i[t]=c.jr(m.LT[t],e[t]))})),this.props.userDetails.EntityResult.IsEnterpriseNode&&null!==e.TerminalCodes&&0===e.TerminalCodes.length&&(i.TerminalCodes="Terminal_reqTerCode"),!this.state.isMeterRequired||""!==e.PipelineHeaderMeterCode&&null!==e.PipelineHeaderMeterCode&&void 0!==e.PipelineHeaderMeterCode||(i.PipelineHeaderMeterCode="PipelineReceiptDetails_MandatoryHeaderMeterCode");let l={messageType:"critical",message:"PipelineReceipt_SavedSuccess_msg",messageResultDetails:[]};if(Array.isArray(e.PipelineReceiptTanks)&&e.PipelineReceiptTanks.length>0){let t=[],i=0;e.PipelineReceiptTanks.forEach((s=>{t.includes(s.TankCode)?l.messageResultDetails.push({keyFields:["PipelineReceiptDetails_ReceiptCode","PipelineReceipt_TankCode"],keyValues:[e.PipelineReceiptCode,s.TankCode],isSuccess:!1,errorMessage:"PIPELINEDISPATCH_TANKINFO_DUPLICATE"}):""===s.Quantity||0===s.Quantity||""!==s.TankCode&&null!==s.TankCode&&void 0!==s.TankCode?t.push(s.TankCode):l.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"TankCode_EMPTY"}),f.sz.forEach((t=>{let i="";void 0!==t.validator&&(i=c.jr(t.validator,s[t.field])),""!==i&&this.state.isTankRequired&&l.messageResultDetails.push({keyFields:["PipelineReceiptDetails_ReceiptCode",t.displayName],keyValues:[e.PipelineReceiptCode,s[t.field]],isSuccess:!1,errorMessage:i})})),i+=s.Quantity})),i!==e.Quantity&&this.state.isTankRequired&&l.messageResultDetails.push({keyFields:["PipelineReceiptDetails_ReceiptCode","PipelineReceiptDetails_Quantity"],keyValues:[e.PipelineReceiptCode,e.Quantity],isSuccess:!1,errorMessage:"PIPELINE_TANKPLAN_QUANTITY_INVALID_X"})}else this.state.isTankRequired&&l.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"ERRMSG_PIPELINE_CUSTODYREFERENCE_TANKINFO_EMPTY"});var s=A().cloneDeep(this.state.attributeValidationErrors);t.forEach((e=>{s.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.attributeMetaDataList.forEach((e=>{t.attributeValidationErrors[e.Code]=c.I5(e,e.DefaultValue)}))}))})),this.setState({validationErrors:i});var a=Object.values(i).every((function(e){return""===e}));return l.messageResultDetails.length>0?(this.props.onSaved(e,"update",l),!1):a}catch(l){console.log("error in validate save",l)}}createPipelineReceipt(e){this.handleAuthenticationClose();try{var t=[{key:b._C,value:e.PipelineReceiptCode}],i={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:b._C,KeyCodes:t,Entity:e},s={messageType:"critical",message:"PipelineReceipt_SavedSuccess_msg",messageResultDetails:[{keyFields:["PipelineReceipt_ReceiptCode"],keyValues:[e.PipelineReceiptCode],isSuccess:!1,errorMessage:""}]};C()(T.vBU,c.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{var i=t.data;if(s.messageType=i.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess)this.getPipelineReceipt({Common_Code:e.PipelineReceiptCode});else{s.messageResultDetails[0].errorMessage=i.ErrorList[0];this.getDispatchUpdateStates();this.setState({saveEnabled:c.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.add,v.$3)}),console.log("Error in CreatePipelineReceipt:",i.ErrorList)}this.props.onSaved(e,"add",s)})).catch((t=>{this.getDispatchUpdateStates();this.setState({saveEnabled:c.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.add,v.$3)}),s.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"add",s)}))}catch(a){console.log("error in create receipt",a)}}updatePipelineReceipt(e){this.handleAuthenticationClose();try{var t=[{key:b._C,value:e.code}],i={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:b._C,KeyCodes:t,Entity:e},s={messageType:"critical",message:"PipelineReceipt_SavedSuccess_msg",messageResultDetails:[{keyFields:["PipelineReceipt_ReceiptCode"],keyValues:[e.code],isSuccess:!1,errorMessage:""}]};C()(T.wSL,c.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{var i=t.data;if(s.messageType=i.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess)this.getPipelineReceipt({Common_Code:e.PipelineReceiptCode});else{s.messageResultDetails[0].errorMessage=i.ErrorList[0];this.getDispatchUpdateStates();this.setState({saveEnabled:c.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.add,v.$3)}),console.log("Error in updatePipelineReceipt:",i.ErrorList)}this.props.onSaved(e,"update",s)})).catch((t=>{this.getDispatchUpdateStates();this.setState({saveEnabled:c.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.add,v.$3)}),s.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"modify",s)}))}catch(a){console.log("error in update Receipt",a)}}setOriginTerminals(e){try{var t=A().cloneDeep(this.state.listOptions);let i=[];this.state.listOptions.supplierOriginTerminalOptions[e].forEach((e=>{i.push({text:e,value:e})})),t.originTerminals=i,this.setState({listOptions:t})}catch(i){console.log("Error in setOriginterminal",i)}}getPipelineMeter(e,t){try{var i=[{key:b.pL,value:e},{key:b.uw,value:this.props.userDetails.EntityResult.IsEnterpriseNode?t:null}],s={keyDataCode:b.pL,KeyCodes:i};C()(T.WQk,c.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;let i=[],s=A().cloneDeep(this.state.modPipelineReceipt),a=A().cloneDeep(this.state.validationErrors);!0===t.IsSuccess&&null!==t.EntityResult&&null!==t.EntityResult.AssociatedMeterCodes&&Array.isArray(t.EntityResult.AssociatedMeterCodes)&&(i=c.Zj(t.EntityResult.AssociatedMeterCodes),this.state.isMeterRequired&&1===t.EntityResult.AssociatedMeterCodes.length&&""!==s.PipelineHeaderCode&&null!==s.PipelineHeaderCode&&void 0!==s.PipelineHeaderCode&&(s.PipelineHeaderMeterCode=t.EntityResult.AssociatedMeterCodes[0],a.PipelineHeaderMeterCode="")),this.setState({pipelineHeaderMeterOptions:i,validationErrors:a,modPipelineReceipt:s})})).catch((e=>{console.log("Error while getPipelineMeter:",e)}))}catch(a){console.log("Error while getPipelineMeter:",a)}}getTank(e){try{var t=this.props.userDetails.EntityResult.PrimaryShareholder;C()(T.eX4+"?ShareholderCode="+t,c.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var i=t.data;if(!0===i.IsSuccess){var s=[],a=i.EntityResult.Table;if(null!==a&&Array.isArray(a))if(this.props.userDetails.EntityResult.IsEnterpriseNode){a=a.filter((t=>t.TerminalCode===e));for(let e=0;e<a.length;e++)s.push(a[e].Common_Code)}else for(let e=0;e<a.length;e++)s.push(a[e].Common_Code);if(null!==s&&Array.isArray(s)){let e=c.Zj(s);this.setState({tankOptions:e})}}else console.log("Error in getTankList:",i.ErrorList)})).catch((e=>{console.log("Error in getTankList:",e)}))}catch(i){console.log("Error in getTankList:",i)}}GetSnapShotsForPlan(e){try{var t=[{key:b.nT,value:e.PipelineReceiptCode},{key:b.mW,value:S.Br.RECEIPT}],i={ShareHolderCode:this.props.selectedShareholder,KeyCodes:t};C()(T.oLb,c.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data.EntityResult,i=[],s=A().cloneDeep(this.state.Remarks);void 0!==t&&null!==t&&(null!==t.Table&&t.Table.length>0&&t.Table.forEach((e=>{e.RationPending=null!==e.RationPending?"FALSE"===e.RationPending.toString().toUpperCase()?"False":"True":e.RationPending,e.ActualEndTime=null!==e.ActualEndTime?new Date(e.ActualEndTime).toLocaleDateString()+" "+new Date(e.ActualEndTime).toLocaleTimeString():e.ActualEndTime,e.ActualStartTime=null!==e.ActualStartTime?new Date(e.ActualStartTime).toLocaleDateString()+" "+new Date(e.ActualStartTime).toLocaleTimeString():e.ActualStartTime,e.PlannedEndTime=new Date(e.PlannedEndTime).toLocaleDateString()+" "+new Date(e.PlannedEndTime).toLocaleTimeString(),e.PlannedStartTime=new Date(e.PlannedStartTime).toLocaleDateString()+" "+new Date(e.PlannedStartTime).toLocaleTimeString(),i.push(e),s=e.Remarks})),null!==t.Table2&&t.Table2.length>0&&t.Table2.forEach((e=>{e.EndGrossVolume=null===e.EndGrossVolume?"":e.EndGrossVolume.toString()+" "+e.VolumeUOM,e.EndNetVolume=null===e.EndNetVolume?"":e.EndNetVolume.toString()+" "+e.VolumeUOM,e.StartGrossVolume=null===e.StartGrossVolume?"":e.StartGrossVolume.toString()+" "+e.VolumeUOM,e.StartNetVolume=null===e.StartNetVolume?"":e.StartNetVolume.toString()+" "+e.VolumeUOM,e.Density=null===e.Density||0===e.Density?"0":e.Density.toString()+" "+e.DensityUOM,e.Temperature=null===e.Temperature||0===e.Temperature?"0":e.Temperature.toString()+" "+e.TemperatureUOM})),null!==t.Table1&&t.Table1.length>0&&t.Table1.forEach((e=>{e.Density=null===e.Density||0===e.Density?"0":e.Density.toString()+" "+e.DensityUOM,e.Temperature=null===e.Temperature||0===e.Temperature?"0":e.Temperature.toString()+" "+e.TemperatureUOM}))),null!==i&&void 0!==i&&i.length>0&&(i=c.Q3(i)),this.setState({loadingDetails:t,pipelineSnapShotInfo:i})})).catch((e=>{console.log("Error while getting receipt compartment details:",e)}))}catch(s){console.log("Error while getting receipt getsnapshot:",s)}}fillTransactionPlanDetails(e){try{console.log("modLoadingDetails",e);let t=[];return Array.isArray(e)&&e.forEach((e=>{e.adjustedquantity=0,t.push({ReceivedGrossQuantity:e.ReceivedGrossQuantity,ReceivedNetQuantity:e.ReceivedNetQuantity,RationPending:e.RationPending,PlannedQuantityUOM:e.PlannedQuantityUOM,PlannedStartTime:new Date(e.PlannedStartTime).toLocaleDateString()+" "+new Date(e.PlannedStartTime).toLocaleTimeString(),PlannedEndTime:new Date(e.PlannedEndTime).toLocaleDateString()+" "+new Date(e.PlannedEndTime).toLocaleTimeString(),ActualStartTime:new Date(e.ActualStartTime).toLocaleDateString()+" "+new Date(e.ActualStartTime).toLocaleTimeString()})})),t=c.Q3(t),t}catch(t){console.log("Error in FillTransactionPlan Details",t)}}fillTankDetails(e){try{let t=[];return Array.isArray(e)&&e.forEach((e=>{e.adjustedquantity=0,t.push({TankCode:e.TankCode,StartGrossVolume:e.StartGrossVolume,EndGrossVolume:e.EndGrossVolume,StartNetVolume:e.StartNetVolume,EndNetVolume:e.EndNetVolume,Density:e.Density,Temperature:e.Temperature})})),t=c.Q3(t),t}catch(t){console.log("error in fillTankDetails",t)}}fillMeterDetails(e){try{let t=[];return Array.isArray(e)&&e.forEach((e=>{e.adjustedquantity=0,t.push({MeterCode:e.TankCode,StartGrossTotalizer:e.StartGrossTotalizer,EndGrossTotalizer:e.EndGrossTotalizer,StartNetTotalizer:e.StartNetTotalizer,EndNetTotalizer:e.EndNetTotalizer,Density:e.Density,Temperature:e.Temperature})})),t=c.Q3(t),t}catch(t){console.log("eror in fill Tank Details")}}getReciptStatuses(e){try{C()(T.kH4+"?shareholderCode="+this.props.selectedShareholder+"&pipelineReceiptCode="+e.Common_Code,c.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;this.setState({currentReceiptStatus:t.EntityResult})})).catch((e=>{console.log("Error while getting getReceiptStatuses:",e)}))}catch(t){console.log(t)}}handleReceiptClose(){try{let i={messageType:"critical",message:"ViewPipelineReceipt_ShipmentClose",messageResultDetails:[{keyFields:["ReceiptCode"],keyValues:[this.state.modPipelineReceipt.PipelineReceiptCode],isSuccess:!1,errorMessage:""}]};var e=[{key:b._C,value:this.state.modPipelineReceipt.PipelineReceiptCode},{key:"Remarks",value:this.state.Remarks}],t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:b._C,KeyCodes:e};C()(T.juj,c.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(i.messageType=t.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess)this.getPipelineReceipt({Common_Code:this.state.modPipelineReceipt.PipelineReceiptCode},0);else{i.messageResultDetails[0].errorMessage=t.ErrorList[0];let e=this.getDispatchUpdateStates();this.setState({saveEnabled:e.indexOf(t.EntityResult.PipelineReceiptStatus)&&c.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.modify,v.$3)}),console.log("Error in closing the dispatch:",t.ErrorList)}this.props.onSaved(this.state.pipelineReceipt,"add",i)})).catch((e=>{let t=this.getDispatchUpdateStates();this.setState({saveEnabled:t.indexOf(this.state.pipelineReceipt.PipelineReceiptStatus)&&c.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.modify,v.$3)}),i.messageResultDetails[0].errorMessage=e,this.props.onSaved(this.state.pipelineReceipt,"add",i)}))}catch(i){console.log("Error while closing the receipt:",i)}}getDispatchUpdateStates(){var e=[];try{let t=this.props.activityInfo.filter((e=>e.ActivityCode===S.Ch.PIPELINE_RECEIPT_ENABLE_UPDATE&&e.ActionTypeCode===S.Gd.CHECK));void 0!==t&&t.length>0&&(e=t[0].ShipmentStates)}catch(t){console.log("Error in gettingDispatchUpdateStates",t)}return e}getReceiptOperations(){try{const e=A().cloneDeep(this.state.pipelineReceipt);let t=[];e.PipelineReceiptStatus.toUpperCase()!==S.Nh.READY&&e.PipelineReceiptStatus.toUpperCase()!==S.Nh.PARTIALLY_COMPLETED||(t.push("Authorize_ManualEntry_Update"),t.push("Authorize_Scada_Update")),e.PipelineReceiptStatus.toUpperCase()===S.Nh.CLOSED&&(t.push("PipelineDispatchList_btnTransactionReport"),t.push("PipelineDispatchList_btnViewTransactionReport")),t.push("PipelineDispatch_BtnAuditTrail"),e.PipelineReceiptStatus.toUpperCase()!==S.Nh.CLOSED&&e.PipelineReceiptStatus.toUpperCase()!==S.Nh.READY&&(t.push("PipelineDispatch_BtnManualEntry"),t.push("PipelineDispatch_BtnClosed"),t.push("PipelineDispatch_BtnSubmit")),this.setState({shipmentNextOperations:t})}catch(e){console.log("Error in getting receipt Current Operations")}}UpdatePipelineReceiptRationedQuantities(e){try{var t=[{key:b._C,value:this.state.pipelineReceipt.PipelineReceiptCode}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:b._C,KeyCodes:t,Entity:e},s={messageType:"critical",message:"PipelineReceiptTransaction_SavedMessage",messageResultDetails:[{keyFields:["PipelineReceiptDetails_ReceiptCode"],keyValues:[this.state.pipelineReceipt.PipelineReceiptCode],isSuccess:!1,errorMessage:""}]};C()(T.HjB,c.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(s.messageType=t.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess)this.getPipelineReceipt({Common_Code:this.state.pipelineReceipt.PipelineReceiptCode});else{s.messageResultDetails[0].errorMessage=t.ErrorList[0];let e=this.getDispatchUpdateStates();this.setState({saveEnabled:e.indexOf(this.state.pipelineReceipt.PipelineReceiptStatus)&&c.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.add,v.$3)}),console.log("Error in  Update rationed quantities:",t.ErrorList)}this.props.onSaved(this.state.pipelineReceipt,"add",s)})).catch((e=>{let t=this.getDispatchUpdateStates();this.setState({saveEnabled:t.indexOf(this.state.pipelineReceipt.PipelineReceiptStatus)&&c.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.add,v.$3)}),s.messageResultDetails[0].errorMessage=e,this.props.onSaved(this.state.pipelineReceipt,"add",s)}))}catch(a){console.log("eror in UpdatePipelineReceiptRationedQuantities",a)}}MarkInvalidPipelineReceiptRecords(e){try{var t=[{key:b._C,value:this.state.pipelineReceipt.PipelineReceiptCode}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:b._C,KeyCodes:t,Entity:e},s={messageType:"critical",message:"PipelineReceiptTransaction_SavedMessage",messageResultDetails:[{keyFields:["PipelineReceiptDetails_ReceiptCode"],keyValues:[this.state.pipelineReceipt.PipelineReceiptCode],isSuccess:!1,errorMessage:""}]};C()(T.ZXT,c.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(s.messageType=t.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess)this.getPipelineReceipt({Common_Code:this.state.pipelineReceipt.PipelineReceiptCode});else{s.messageResultDetails[0].errorMessage=t.ErrorList[0];let e=this.getDispatchUpdateStates();this.setState({saveEnabled:e.indexOf(this.state.pipelineReceipt.PipelineReceiptStatus)&&c.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.add,v.$3)}),console.log("Error in  Update rationed quantities:",t.ErrorList)}this.props.onSaved(this.state.pipelineReceipt,"add",s)})).catch((e=>{let t=this.getDispatchUpdateStates();this.setState({saveEnabled:t.indexOf(this.state.pipelineReceipt.PipelineReceiptStatus)&&c.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.add,v.$3)}),s.messageResultDetails[0].errorMessage=e,this.props.onSaved(this.state.pipelineReceipt,"add",s)}))}catch(a){console.log("Error in MarkInvalidPipelineReceiptRecords",a)}}handleSubmit(){try{let e=[],t=!1;A().cloneDeep(this.state.pipelineSnapShotInfo).forEach((i=>{let s=A().cloneDeep(R.uk);s.Remarks=this.state.Remarks,null!==this.state.pipelineReceipt.PipelineReceiptCode&&""!==this.state.pipelineReceipt.PipelineReceiptCode?s.PlanCode=this.state.pipelineReceipt.PipelineReceiptCode:s.PlanCode="",s.TransactionType=S.Br.RECEIPT,s.ShareholderCode=this.props.selectedShareholder,null!==i.PipelineTransactionID&&""!==i.PipelineTransactionID&&(s.PipelineTransactionID=c.bo(i.PipelineTransactionID)),null!==i.ReceivedGrossQuantity&&""!==i.ReceivedGrossQuantity&&(s.GrossQuantity=c.bo(i.ReceivedGrossQuantity)),null!==i.ReceivedNetQuantity&&""!==i.ReceivedNetQuantity&&(s.NetQuantity=c.bo(i.ReceivedNetQuantity)),null!==i.RationPending&&"TRUE"===i.RationPending.toString().toUpperCase()&&(t=!0,s.RationPending=!0),s.IsInvalid=i.IsInvalid,e.push(s)})),null!==e&&e.length>0&&(t?this.UpdatePipelineReceiptRationedQuantities(e):this.MarkInvalidPipelineReceiptRecords(e))}catch(e){console.log("PipelineDispatchDetailsComposite : Error in forming Submit request",e)}}getRefrenceSource(){try{C()(T.xAA+"?LookUpTypeCode=PipelineReceipt",c.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;!0===t.IsSuccess?"0"===t.EntityResult.CustodyTransferReferenceSource?this.setState({isMeterRequired:!0,isTankRequired:!1}):this.setState({isMeterRequired:!1,isTankRequired:!0}):console.log("Error in getLookUpData: ",t.ErrorList)})).catch((e=>{console.log("PipelineDispatchComposite: Error occurred on getLookUpData",e)}))}catch(e){console.log("PipelineDispatchComposite:Error occured on geting RefrenceSourceLookUp Value",e)}}formReadonlyCompAttributes(e,t){let i=[];return null!==t&&void 0!==t&&t.length>0&&t.forEach((e=>{e.attributeMetaDataList.forEach((e=>{i.push({AttributeCode:e.Code,AttributeName:e.DisplayName?e.DisplayName:e.Code,AttributeValue:e.DefaultValue,TerminalCode:e.TerminalCode,IsMandatory:e.IsMandatory,DataType:e.DataType,IsReadonly:e.IsReadonly,MinValue:e.MinValue,MaxValue:e.MaxValue,ValidationFormat:e.ValidationFormat,compSequenceNo:""})}))})),null!==e&&void 0!==e&&e.length>0&&e.forEach((e=>{i.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.ListOfAttributeData.forEach((e=>{t.AttributeCode===e.AttributeCode&&(t.AttributeValue=e.AttributeValue)}))}))})),i}getKPIList(e,t){if(!0===c.ab(this.props.userDetails.EntityResult.FunctionsList,v.i.view,v.bL)){let i={PageName:w.of,TransportationType:S.LY.PIPELINE,InputParameters:[{key:"ShareholderCode",value:e},{key:"ReceiptCode",value:t}]};C()(T.dxq,c.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({pipelineReceiptKPIList:t.EntityResult.ListKPIDetails}):(this.setState({pipelineReceiptKPIList:[]}),console.log("Error in truck Receipt KPIList:",t.ErrorList))})).catch((e=>{console.log("Error while getting truck Receipt KPIList:",e)}))}}render(){const e={pipelineHeaderOptions:this.state.pipelineHeaderOptions,pipelineHeaderMeterOptions:this.state.pipelineHeaderMeterOptions,tankCodeOptions:this.state.tankOptions,terminalCodes:this.props.terminalCodes},t=[{fieldName:"Receipt_LastUpdated",fieldValue:new Date(this.state.modPipelineReceipt.LastUpdatedTime).toLocaleDateString()+" "+new Date(this.state.modPipelineReceipt.LastUpdatedTime).toLocaleTimeString()},{fieldName:"Receipt_CreatedTime",fieldValue:new Date(this.state.modPipelineReceipt.CreatedTime).toLocaleDateString()+" "+new Date(this.state.modPipelineReceipt.CreatedTime).toLocaleTimeString()}];return this.state.isReadyToRender?(0,p.jsxs)("div",{children:[(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsx)(o.A,{children:(0,p.jsx)(D.A,{entityCode:this.state.isManualEntry?this.state.pipelineReceipt.PipelineReceiptCode+"\xa0-\xa0"+e("LoadingDetailsEntry_Title"):this.state.pipelineReceipt.PipelineReceiptCode,newEntityName:"Receipt_NewReceiptByCompartment",popUpContents:t})})}),this.state.isViewAuditTrail?(0,p.jsx)(o.A,{children:(0,p.jsx)(_.V,{ReceiptCode:this.state.modPipelineReceipt.PipelineReceiptCode,auditTrailList:this.state.auditTrailList,modAuditTrailList:this.state.modAuditTrailList,handleBack:this.onBack,Attributes:void 0!==this.state.auditTrailList&&this.state.auditTrailList.length>0?this.state.auditTrailList[0].AttributesforUI:[]})}):this.state.isManualEntry?(0,p.jsx)("div",{children:(0,p.jsx)(o.A,{children:(0,p.jsx)(N.default,{receipt:this.state.modPipelineReceipt,handleBack:this.onBack,selectedShareholder:this.props.selectedShareholder,UOMS:this.state.UOMS,listOptions:this.state.listOptions,isMeterRequired:this.state.isMeterRequired,isTankRequired:this.state.isTankRequired})})}):(0,p.jsxs)("div",{children:[(0,p.jsx)(O.A,{KPIList:this.state.pipelineReceiptKPIList,children:" "}),(0,p.jsxs)("div",{className:""!==this.state.pipelineReceipt.PipelineReceiptCode?this.state.drawerStatus?"drawerClose":"showShipmentStatusRightPane":"",children:[(0,p.jsx)(o.A,{children:(0,p.jsx)(h,{pipelineReceipt:this.state.pipelineReceipt,modPipelineReceipt:this.state.modPipelineReceipt,validationErrors:this.state.validationErrors,selectedAssociations:this.state.selectedAssociations,listOptions:this.state.listOptions,dropdownOptions:e,onFieldChange:this.handleChange,handleAssociationSelectionChange:this.handleAssociationSelectionChange,handleCellDataEdit:this.handleCellDataEdit,handleAddAssociation:this.handleAddAssociation,handleDeleteAssociation:this.handleDeleteAssociation,handlePipelineHeaderChange:this.handlePipelineHeaderChange,isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,handleTerminalChange:this.handleTerminalChange,modAttributeMetaDataList:this.state.modAttributeMetaDataList,attributeValidationErrors:this.state.attributeValidationErrors,onAttributeDataChange:this.handleAttributeDataChange,activeTab:this.state.activeTab,onTabChange:this.handleTabChange,loadingDetails:this.state.loadingDetails,handleCellCheck:this.handleCellCheck,pipelineSnapShotInfo:this.state.pipelineSnapShotInfo,isMeterRequired:this.state.isMeterRequired,isTankRequired:this.state.isTankRequired,loadingDetailsTab:""!==this.state.pipelineReceipt.PipelineReceiptCode?[""]:[],onDateTextChange:this.handleDateTextChange})}),(0,p.jsx)(o.A,{children:(0,p.jsx)(u.q,{handleBack:this.props.onBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.saveEnabled})}),this.state.showAuthenticationLayout?(0,p.jsx)(U.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:""===this.state.pipelineReceipt.PipelineReceiptCode?v.i.add:v.i.modify,functionGroup:v.$3,handleOperation:this.addUpdatePipelineReceipt,handleClose:this.handleAuthenticationClose}):null]}),(0,p.jsx)("div",{children:""!==this.state.pipelineReceipt.PipelineReceiptCode?(0,p.jsx)("div",{className:this.state.drawerStatus?"marineStatusLeftPane":"",children:(0,p.jsx)(n.TranslationConsumer,{children:e=>(0,p.jsx)(I.A,{selectedItem:[{Common_Code:this.state.modPipelineReceipt.PipelineReceiptCode}],shipmentNextOperations:this.state.shipmentNextOperations,handleOperationButtonClick:this.handleOperationClick,currentStatuses:this.state.currentReceiptStatus,handleDrawer:this.handleDrawer,isDetails:!0,isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,webPortalAllowedOperations:["PipelineDispatchList_btnViewTransactionReport","PipelineDispatch_BtnAuditTrail"],isWebPortalUser:this.props.userDetails.EntityResult.IsWebPortalUser,unAllowedOperations:["Authorize_ManualEntry_Update","Authorize_Scada_Update","PipelineDispatch_BtnManualEntry","PipelineDispatch_BtnClosed","PipelineDispatch_BtnSubmit"]})})}):""})]}),this.state.RemarksPopUp?this.handleCloseReceipttModal():null]}):(0,p.jsx)(k.A,{message:"Loading"})}}const V=(0,E.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})),(e=>({userActions:(0,y.zH)(P,e)})))(H)},91684:(e,t,i)=>{i.d(t,{V:()=>h});var s=i(65043),a=i(67907),l=i(72711),n=i(78374),o=i(45127),r=i(728),c=i(7523),d=i(69062),p=i(70579);function h(e){let{ReceiptCode:t,auditTrailList:i,handleBack:r,modAuditTrailList:h,Attributes:u}=e;const[m,R]=(0,s.useState)(!1),g=e=>{const t=e.rowData.AttributesforUI.filter((t=>t.AttributeName===e.name))[0];return t.DataType.toLowerCase()===c.pe.STRING.toLowerCase()||t.DataType.toLowerCase()===c.pe.INT.toLowerCase()||t.DataType.toLowerCase()===c.pe.LONG.toLowerCase()||t.DataType.toLowerCase()===c.pe.FLOAT.toLowerCase()?(0,p.jsx)("label",{children:t.AttributeValue}):t.DataType.toLowerCase()===c.pe.BOOL.toLowerCase()?(0,p.jsx)(l.Checkbox,{checked:"true"===t.AttributeValue.toString().toLowerCase(),disabled:!0}):(0,p.jsx)("label",{children:new Date(t.AttributeValue).toLocaleDateString()})},C=(e,t)=>{try{t.cls=null,e.fontSize="10px",t.text=(0,d.cd)(c.Jh,t.val)}catch(i){console.log("Error in formatter",i)}return t};return(0,p.jsxs)("div",{children:[(0,p.jsx)(a.TranslationConsumer,{children:e=>(0,p.jsx)("div",{children:(0,p.jsxs)("div",{className:"detailsContainer",children:[(0,p.jsxs)("div",{id:"printTable",children:[(0,p.jsx)("div",{className:"row",children:(0,p.jsx)("div",{className:"col-12",children:(0,p.jsx)("h3",{children:e("Transaction_AuditTrail_Heading")})})}),(0,p.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,p.jsx)("div",{className:"col-12 container-fluid",children:(0,p.jsxs)(o.IO,{itemsSource:h,chartType:"Line",bindingX:"UpdatedTime",palette:["blue"],style:{width:"100%",minWidth:"1000px",height:"550px"},plotMargin:"50 10 155 150 ",children:[(0,p.jsx)(o.tN,{position:"Bottom"}),(0,p.jsx)(o.vc,{wjProperty:"axisY",majorUnit:1,max:9,min:0,itemFormatter:C,axisLine:!0}),(0,p.jsx)(o.t3,{binding:"PipelineReceiptstatus",name:e("Receipt_ReceiptStatus")})]})})}),(0,p.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(n.bQ,{data:i,scrollable:!0,children:[(0,p.jsx)(n.bQ.Column,{className:"compColHeight colminWidth",field:"PipelineReceiptStatus",header:e("ViewReceiptAuditTrail_ReceiptStatus"),editable:!1,editFieldType:"text"},"PipelineReceiptStatus"),(0,p.jsx)(n.bQ.Column,{className:"compColHeight colminWidth",field:"UpdatedTime",header:e("ViewAuditTrail_UpdatedTime"),editable:!1,editFieldType:"text"},"UpdatedTime"),u.map((t=>(0,p.jsx)(n.bQ.Column,{className:"compColHeight",header:e(t.AttributeName),editable:!1,renderer:g})))]})})})]}),(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col-12 col-sm-6 col-lg-8",children:(0,p.jsx)(l.Button,{className:"backButton",onClick:r,content:e("Back")})}),(0,p.jsx)("div",{className:"col-12 col-sm-6 col-lg-4",style:{textAlign:"right"},children:(0,p.jsx)(l.Button,{className:"printButton",onClick:()=>{R(!0)},content:e("ViewAuditTrail_PrintAuditTrail")})})]})]})})}),(0,p.jsx)(a.TranslationConsumer,{children:e=>(0,p.jsx)(l.Modal,{open:m,className:"marineModalPrint",children:(0,p.jsxs)(l.Modal.Content,{children:[(0,p.jsxs)("div",{style:{display:"flex",flexWrap:"wrap"},children:[(0,p.jsx)("div",{className:"col col-lg-8",children:(0,p.jsx)("h3",{children:e("Transaction_AuditTrail_Heading")+" : "+t})}),(0,p.jsx)("div",{className:"col col-lg-4",style:{textAlign:"right"},children:(0,p.jsx)("div",{onClick:()=>{R(!1)},children:(0,p.jsx)(l.Icon,{root:"common",name:"close"})})})]}),(0,p.jsx)("div",{className:"col-md-10 container-fluid",children:(0,p.jsxs)(o.IO,{itemsSource:h,chartType:"Line",bindingX:"UpdatedTime",palette:["blue"],style:{width:"100%",minWidth:"1000px",height:"550px"},plotMargin:"50 10 155 150 ",children:[(0,p.jsx)(o.tN,{position:"Bottom"}),(0,p.jsx)(o.vc,{wjProperty:"axisY",majorUnit:1,max:9,min:0,itemFormatter:C,axisLine:!0}),(0,p.jsx)(o.t3,{binding:"PipelineReceiptstatus",name:e("Receipt_ReceiptStatus")})]})}),(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(n.bQ,{data:i,children:[(0,p.jsx)(n.bQ.Column,{className:"compColHeight",field:"PipelineReceiptStatus",header:e("ViewReceiptAuditTrail_ReceiptStatus"),editable:!1,editFieldType:"text"},"PipelineReceiptStatus"),(0,p.jsx)(n.bQ.Column,{className:"compColHeight",field:"UpdatedTime",header:e("ViewAuditTrail_UpdatedTime"),editable:!1,editFieldType:"text"},"UpdatedTime"),u.map((t=>(0,p.jsx)(n.bQ.Column,{className:"compColHeight",header:e(t.AttributeName),editable:!1,renderer:g})))]})}),(0,p.jsxs)(l.Modal.Footer,{children:[(0,p.jsx)(l.Button,{type:"primary",size:"small",content:e("ViewAuditTrail_Print"),onClick:()=>{let e=window.document.getElementById("printTable").innerHTML;const t=window.document.createElement("IFRAME");let i=null;window.document.body.appendChild(t),i=t.contentWindow.document;const s=e.substring(0,e.indexOf("<table")+6),a=e.substring(e.indexOf("<table")+6,e.length);e=s+' border="1" cellspacing="1"'+a,i.write(e),i.close(),t.contentWindow.focus(),t.contentWindow.print(),setTimeout((()=>{window.document.body.removeChild(t)}),2e3)}}),(0,p.jsx)(l.Button,{type:"primary",size:"small",content:e("MarineEOD_Close"),onClick:()=>{R(!1)}})]})]})})})]})}r.setLicenseKey(c.yQ),h.defaultProps={}}}]);
//# sourceMappingURL=4280.f0c7e6dd.chunk.js.map