"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[2554],{2554:(e,t,s)=>{s.r(t),s.d(t,{default:()=>T});var a=s(65043),i=s(46100),o=s(80432),l=s(40854),c=s.n(l),n=s(97508),d=s(53536),r=s.n(d),h=s(69062),u=s(93779),p=s(72067),D=s(7523),v=s(65187),m=s(40252),y=s(43503),L=s(72711),C=s(67907),g=s(78374),S=s(70579);function A(e){let{location:t,modLocation:s,modAvailableDevices:a,modAssociatedDevices:i,selectedLocationType:o,validationErrors:l,checkBoxChanged:c,onFieldChange:n,handleCellDataEdit:d,onActiveStatusChange:r}=e;const[h]=(0,C.useTranslation)(),u=e=>(0,S.jsx)(L.Input,{fluid:!0,value:i[e.rowIndex][e.field],onChange:t=>d(t,e),reserveSpace:!1});return(0,S.jsxs)("div",{className:"detailsContainer",children:[(0,S.jsxs)("div",{className:"row",children:[(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(L.Input,{fluid:!0,value:s.LocationCode,label:h(o+"Code"),indicator:"required",disabled:""!==t.LocationCode,onChange:e=>n("LocationCode",e),error:h(l.LocationCode),reserveSpace:!1})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(L.Input,{fluid:!0,value:s.LocationName,label:h(o+"Name"),indicator:"required",onChange:e=>n("LocationName",e),error:h(l.LocationName),reserveSpace:!1})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(L.Input,{fluid:!0,value:o,disabled:"true",label:h("LocationType"),onChange:e=>n("LocationType",e),reserveSpace:!1})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(L.Input,{fluid:!0,value:null===s.Description?"":s.Description,label:h("FinishedProductList_Description"),onChange:e=>n("Description",e),error:h(l.Description),reserveSpace:!1})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(L.Select,{fluid:!0,placeholder:h("FinishedProductInfo_Select"),label:h("Cust_Status"),value:s.Active,options:[{text:h("ViewShipment_Ok"),value:!0},{text:h("ViewShipmentStatus_Inactive"),value:!1}],onChange:e=>r(e)})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(L.Input,{fluid:!0,value:null===s.Remarks?"":s.Remarks,label:h("Cust_Remarks"),onChange:e=>n("Remarks",e),indicator:s.Active!==t.Active?"required":"",error:h(l.Remarks),reserveSpace:!1})})]}),(0,S.jsxs)("div",{className:"row",children:[(0,S.jsxs)("div",{className:"col-3 pr-1 pb-0",children:[(0,S.jsx)("h5",{children:h("Loc_AvailableDevices")}),(0,S.jsx)(L.Accordion,{children:a.map((e=>(0,S.jsx)(L.Accordion.Content,{title:e.DeviceType,arrowPosition:"left",children:e.DeviceList.map((t=>(0,S.jsx)("div",{children:(0,S.jsx)(L.Checkbox,{label:t.DeviceCode,checked:t.IsAssociated,onChange:s=>c(t.DeviceCode,e.DeviceType,s)})})))})))})]}),(0,S.jsxs)("div",{className:"col-9 pb-0",children:[(0,S.jsx)("h5",{children:h("Loc_AssociatedDevices")}),(0,S.jsxs)(g.bQ,{data:i,children:[(0,S.jsx)(g.bQ.Column,{className:"compColHeight",field:"DeviceCode",header:h("Loc_DeviceCode"),editable:!0,sortable:!0,editFieldType:"text",customEditRenderer:u},"DeviceCode"),(0,S.jsx)(g.bQ.Column,{className:"compColHeight",field:"DeviceType",header:h("Loc_DeviceType"),editable:!0,sortable:!0,editFieldType:"text",customEditRenderer:u},"DeviceType"),(0,S.jsx)(g.bQ.Column,{className:"compColHeight",field:"DeviceModel",header:h("Loc_DeviceModel"),editable:!0,sortable:!0,editFieldType:"text",customEditRenderer:u},"DeviceModel")]})]})]})]})}var E=s(44192),I=s(80312),b=s(62900);class k extends a.Component{constructor(){super(...arguments),this.state={island:{},modIsland:{},location:{},modLocation:{},saveEnabled:!1,isDeleteEnabled:!1,selectedLocationType:"",isReadyToRender:!1,modAvailableDevices:[],modAssociatedDevices:[],checkedDevices:[],validationErrors:h.Th(E.Kj),showDeleteAuthenticationLayout:!1,showSaveAuthenticationLayout:!1,tempIsland:{},tempLocation:{}},this.handleCheckboxChanged=(e,t,s)=>{try{let o=r().cloneDeep(this.state.modAvailableDevices);var a=o.findIndex((e=>e.DeviceType===t));if(void 0!==a)var i=o[a].DeviceList.findIndex((t=>t.DeviceCode===e));void 0!==i&&(o[a].DeviceList[i].IsAssociated=s),this.setState({modAvailableDevices:o});let l={DeviceType:t,DeviceCode:e,DeviceModel:null},c=r().cloneDeep(this.state.checkedDevices);!0===s&&0===c.filter((t=>t.DeviceCode===e)).length?(c.push(l),this.setState({checkedDevices:c})):!1===s&&this.state.checkedDevices.filter((t=>t.DeviceCode===e)).length>0&&(c=c.filter((t=>t.DeviceCode!==e)),this.setState({checkedDevices:c}))}catch(o){console.log("IslandDetailsComposite:Error occured on handleCheckboxChanged",o)}},this.handleChange=(e,t)=>{try{let s=r().cloneDeep(this.state.modLocation);s[e]=t;const a={...this.state.validationErrors};s.Active===this.state.location.Active&&(this.state.location.Remarks!==s.Remarks&&""!==s.Remarks||(a.Remarks=""),""===s.Remarks&&(s.Remarks=this.state.location.Remarks)),"Active"===e&&s.Active!==this.state.location.Active&&(s.Remarks=""),void 0!==E.OA[e]&&(a[e]=h.jr(E.OA[e],t)),this.setState({validationErrors:a,modLocation:s})}catch(s){console.log("IslandDetailsComposite:Error occured on handleChange",s)}},this.handleCellDataEdit=(e,t)=>{try{let s=r().cloneDeep(this.state.modAssociatedDevices);s[t.rowIndex][t.field]=e,this.setState({modAssociatedDevices:s})}catch(s){console.log("IslandDetailsComposite:Error occured on handleCellDataEdit",s)}},this.handleActiveStatusChange=e=>{try{let t=r().cloneDeep(this.state.modLocation);t.Active=e,t.Active!==this.state.location.Active&&(t.Remarks=""),this.setState({modLocation:t})}catch(t){console.log("LocationDetailsComposite:Error occured on handleActiveStatusChange",t)}},this.saveIsland=()=>{try{this.setState({saveEnabled:!1});let e=r().cloneDeep(this.state.tempIsland),t=r().cloneDeep(this.state.tempLocation);""===this.state.location.LocationCode?this.createIsland(e,t):this.updateIsland(e,t)}catch(e){console.log("IslandComposite : Error in saveIsland")}},this.handleSave=()=>{try{let e=this.fillLocationDetails(),t=this.fillDetails();if(this.validateSave(e)){let s=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,a=r().cloneDeep(t),i=r().cloneDeep(e);this.setState({showSaveAuthenticationLayout:s,tempIsland:a,tempLocation:i},(()=>{!1===s&&this.saveIsland()}))}else this.setState({saveEnabled:!0})}catch(e){console.log("IslandDetailsComposite:Error occured on handleSave",e)}},this.handleDelete=()=>{try{var e=this.state.modLocation.LocationCode,t={keyDataCode:0,ShareHolderCode:"",KeyCodes:[{Key:u.$A,Value:e},{Key:u.uw,Value:this.props.selectedTerminal}]};let s={messageType:"critical",message:[this.state.selectedLocationType+"DeletionStatus"],messageResultDetails:[{keyFields:[D.uA.ISLAND+"Code"],keyValues:[e],isSuccess:!1,errorMessage:""}]};c()(p.dx0,h.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;s.messageType=t.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.deleteLocation():(s.messageResultDetails[0].errorMessage=t.ErrorList[0],this.setState({isDeleteEnabled:!0,saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,I.i.remove,I.x5),showDeleteAuthenticationLayout:!1}),this.props.onDelete(this.state.modLocation,"delete",s))}))}catch(s){console.log("IslandDetailsComposite:Error occured on handleDelete",s)}},this.authenticateDelete=()=>{try{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showDeleteAuthenticationLayout:e}),!1===e&&this.handleDelete()}catch(e){console.log("IslandComposite : Error in authenticateDelete")}},this.handleAuthenticationClose=()=>{this.setState({showSaveAuthenticationLayout:!1,showDeleteAuthenticationLayout:!1})}}componentDidMount(){try{h.pJ(this.props.userDetails.EntityResult.IsArchived),this.getDeviceList(this.props)}catch(e){console.log("IslandDetailsComposite:Error occured on componentDidMount",e)}}componentWillReceiveProps(e){try{if(void 0===e.Code&&this.props.tokenDetails.tokenInfo===e.tokenDetails.tokenInfo){this.getDeviceList(e);let t={...this.state.validationErrors};Object.keys(t).forEach((e=>{t[e]=""})),this.setState({validationErrors:t})}}catch(t){console.log("IslandDetailsComposite:Error occured on componentWillReceiveProps",t)}}getDeviceList(e){let t=e.locationtype,s=this.props.selectedTerminal;try{c()(p.X3N+"?locationType="+t+"&locationInfo=&terminalCode="+s,h.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{let s=t.data;!0===s.IsSuccess&&Array.isArray(s.EntityResult)&&s.EntityResult.length>0?this.setState({modAvailableDevices:s.EntityResult},(()=>{this.getIsland(e)})):this.getIsland(e)}))}catch(a){console.log("IslandDetailsComposite:Error occured on getDeviceList",a)}}getIsland(e){try{let a=e.selectedlocation,o=e.selectedTerminal;if(this.setState({selectedLocationType:D.uA.ISLAND}),i.F4.LocationType=D.uA.ISLAND,i.F4.AvailableDevices=this.state.modAvailableDevices,!0===e.isClone)return void this.setState({selectedLocationType:D.uA.ISLAND,location:r().cloneDeep(i.F4),modLocation:r().cloneDeep(i.F4),isReadyToRender:!0,modAssociatedDevices:[],modAvailableDevices:r().cloneDeep(this.state.modAvailableDevices),checkedDevices:[],isDeleteEnabled:!1,saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,I.i.add,I.x5)});if(void 0===a||""===a)return void this.setState({location:r().cloneDeep(i.F4),modLocation:r().cloneDeep(i.F4),selectedLocationType:i.F4.LocationType,modAssociatedDevices:[],modAvailableDevices:r().cloneDeep(i.F4.AvailableDevices),checkedDevices:[],isDeleteEnabled:!1,isReadyToRender:!0,saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,I.i.add,I.x5)});var t=[{key:u.$A,value:a},{key:u.uw,value:o}],s={ShareHolderCode:"",keyDataCode:u.$A,KeyCodes:t};c()(p.Q8r,h.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){let e=r().cloneDeep(t.EntityResult.AssociatedDevices);Array.isArray(e)&&e.forEach((e=>{e.DeviceType=(0,h.cd)(D.k6,e.DeviceType)})),this.setState({selectedLocationType:r().cloneDeep(t.EntityResult.LocationType),isReadyToRender:!0,location:t.EntityResult,modLocation:r().cloneDeep(t.EntityResult),modAssociatedDevices:e,modAvailableDevices:r().cloneDeep(t.EntityResult.AvailableDevices),isDeleteEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,I.i.remove,I.x5),saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,I.i.modify,I.x5)})}else this.setState({selectedLocationType:i.F4.LocationType,location:r().cloneDeep(i.F4),modLocation:r().cloneDeep(i.F4),isReadyToRender:!0,modAssociatedDevices:[],modAvailableDevices:[],checkedDevices:[],isDeleteEnabled:!1})}))}catch(a){console.log("IslandDetailsComposite:Error occured on getIsland",a)}}fillLocationDetails(){try{let e=r().cloneDeep(this.state.modLocation),t=r().cloneDeep(this.state.checkedDevices);return t.forEach((e=>{e.TerminalCode=this.props.selectedTerminal})),e.LocationType=this.state.selectedLocationType,e.TerminalCode=this.props.selectedTerminal,e.AssociatedDevices=t,e}catch(e){console.log("IslandDetailsComposite:Error occured on fillLocationDetails",e)}}fillDetails(){try{let e=r().cloneDeep(this.state.modLocation),t=r().cloneDeep(this.state.modIsland);return t.Code=e.LocationCode,t.Name=e.LocationName,t.EntityTypeCode=this.state.selectedLocationType,t.ParentCode=this.props.parentCode,t.TerminalCode=this.props.selectedTerminal,t.Active=e.Active,t.Description=e.Description,t.Remarks=e.Remarks,t}catch(e){console.log("IslandDetailsComposite:Error occured on filldetails",e)}}validateSave(e){const t={...this.state.validationErrors};Object.keys(E.OA).forEach((function(s){void 0!==e[s]&&(t[s]=h.jr(E.OA[s],e[s]))})),e.Active!==this.state.location.Active&&(null!==e.Remarks&&""!==e.Remarks||(t.Remarks="OriginTerminal_RemarksRequired"));let s={messageType:"critical",message:[this.state.selectedLocationType+"SavedSuccess"],messageResultDetails:[]};this.setState({validationErrors:t});var a=Object.values(t).every((function(e){return""===e}));return s.messageResultDetails.length>0?(this.props.onSaved(this.state.modLocation,"update",s),!1):a}deleteLocation(){try{var e=[],t=this.state.modLocation.LocationCode,s={keyDataCode:0,ShareHolderCode:"",KeyCodes:[{Key:u.$A,Value:t},{Key:u.uw,Value:this.props.selectedTerminal}]};e.push(s),c()(p.$Xc,h.tW(e,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data,s=t.IsSuccess;null!==t.ResultDataList&&void 0!==t.ResultDataList&&(s=t.ResultDataList.filter((function(e){return!e.IsSuccess})).length!==t.ResultDataList.length);var a=h.Cy(t,[this.state.selectedLocationType+"DeletionStatus"],["LocationCode"]);s?(this.getIsland({selectedlocation:this.state.modLocation.LocationCode,selectedTerminal:this.props.selectedTerminal,isClone:!0}),this.setState({isDeleteEnabled:!1,showDeleteAuthenticationLayout:!1})):this.setState({isDeleteEnabled:!0,showDeleteAuthenticationLayout:!1}),a.messageResultDetails.forEach((e=>{e.keyFields.length>0&&(e.keyFields[0]=[this.state.selectedLocationType+"Code"])})),this.props.onDelete(this.state.modLocation,"delete",a)}))}catch(a){console.log("IslandDetailsComposite:Error occured on handleDelete",a)}}createIsland(e,t){try{let s=[{key:u.f,value:e.Code}],a={ShareHolderCode:"",keyDataCode:u.$A,KeyCodes:s,Entity:e},i={messageType:"critical",message:[this.state.selectedLocationType+"SavedSuccess"],messageResultDetails:[{keyFields:[this.state.selectedLocationType+"Code"],keyValues:[e.Code],isSuccess:!1,errorMessage:""}]};c()(p.ks4,h.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{let s=e.data;i.messageType=s.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?(this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,I.i.add,I.x5),showSaveAuthenticationLayout:!1}),this.createLocation(t)):(i.messageResultDetails[0].errorMessage=s.ErrorList[0],this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,I.i.add,I.x5),showSaveAuthenticationLayout:!1}),this.props.onSaved(this.state.modGantry,"add",i))}))}catch(s){console.log("IslandDetailsComposite:Error occured on createIsland",s)}}createLocation(e){try{let t=[{key:u.$A,value:e.LocationCode}],s={LocationInfo:e,BayInfo:null,isBayRequest:!1},a={ShareHolderCode:"",keyDataCode:u.$A,KeyCodes:t,Entity:s},i={messageType:"critical",message:[this.state.selectedLocationType+"SavedSuccess"],messageResultDetails:[{keyFields:[this.state.selectedLocationType+"Code"],keyValues:[e.LocationCode],isSuccess:!1,errorMessage:""}]};c()(p.Kbi,h.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;i.messageType=t.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?(this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,I.i.add,I.x5),showSaveAuthenticationLayout:!1}),this.getIsland({selectedlocation:this.state.modLocation.LocationCode,selectedTerminal:this.props.selectedTerminal,isClone:!1})):(i.messageResultDetails[0].errorMessage=t.ErrorList[0],this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,I.i.add,I.x5),showSaveAuthenticationLayout:!1})),this.props.onSaved(this.state.modLocation,"add",i)}))}catch(t){console.log("IslandDetailsComposite:Error occured on createLocation",t)}}updateIsland(e,t){try{let s=[{key:u.f,value:e.Code}],a={ShareHolderCode:"",keyDataCode:u.$A,KeyCodes:s,Entity:e},i={messageType:"critical",message:[this.state.selectedLocationType+"SavedSuccess"],messageResultDetails:[{keyFields:[this.state.selectedLocationType+"Code"],keyValues:[e.Code],isSuccess:!1,errorMessage:""}]};c()(p.f80,h.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{let s=e.data;i.messageType=s.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?(this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,I.i.add,I.x5),showSaveAuthenticationLayout:!1}),this.updateLocation(t)):(i.messageResultDetails[0].errorMessage=s.ErrorList[0],this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,I.i.add,I.x5),showSaveAuthenticationLayout:!1}),this.props.onSaved(this.state.modGantry,"add",i))}))}catch(s){console.log("IslandDetailsComposite:Error occured on updateIsland",s)}}updateLocation(e){try{let t=[{key:u.$A,value:e.LocationCode}],s={LocationInfo:e,BayInfo:null,isBayRequest:!1},a={ShareHolderCode:"",keyDataCode:u.$A,KeyCodes:t,Entity:s},i={messageType:"critical",message:[this.state.selectedLocationType+"SavedSuccess"],messageResultDetails:[{keyFields:[this.state.selectedLocationType+"Code"],keyValues:[e.LocationCode],isSuccess:!1,errorMessage:""}]};c()(p.Xe1,h.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;i.messageType=t.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?(this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,I.i.modify,I.x5),showSaveAuthenticationLayout:!1}),this.getIsland({selectedlocation:this.state.modLocation.LocationCode,selectedTerminal:this.props.selectedTerminal,isClone:!1})):(i.messageResultDetails[0].errorMessage=t.ErrorList[0],this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,I.i.modify,I.x5),showSaveAuthenticationLayout:!1})),this.props.onSaved(this.state.modLocation,"update",i)}))}catch(t){console.log("IslandDetailsComposite:Error occured on updateLocation",t)}}handleOperation(){return this.state.showDeleteAuthenticationLayout?this.handleDelete:this.saveIsland}getFunctionName(){return this.state.showDeleteAuthenticationLayout?I.i.remove:""===this.state.island.Code?I.i.add:I.i.modify}render(){const e=[{fieldName:"DriverInfo_LastUpdated",fieldValue:new Date(this.state.modLocation.LastUpdatedTime).toLocaleDateString()+" "+new Date(this.state.modLocation.LastUpdatedTime).toLocaleTimeString()},{fieldName:"DriverInfo_LastActive",fieldValue:void 0!==this.state.modLocation.LastActive&&null!==this.state.modLocation.LastActive?new Date(this.state.modLocation.LastActive).toLocaleDateString()+" "+new Date(this.state.modLocation.LastActive).toLocaleTimeString():""},{fieldName:"DriverInfo_CreatedTime",fieldValue:new Date(this.state.modLocation.CreatedTime).toLocaleDateString()+" "+new Date(this.state.modLocation.CreatedTime).toLocaleTimeString()}];return this.state.isReadyToRender?(0,S.jsxs)("div",{children:[(0,S.jsx)(v.A,{children:(0,S.jsx)(y.A,{entityCode:this.state.location.LocationCode,newEntityName:"New"+this.state.selectedLocationType,popUpContents:e})}),(0,S.jsx)(v.A,{children:(0,S.jsx)(A,{location:this.state.location,modLocation:this.state.modLocation,modAvailableDevices:this.state.modAvailableDevices,modAssociatedDevices:this.state.modAssociatedDevices,selectedLocationType:this.state.selectedLocationType,validationErrors:this.state.validationErrors,onFieldChange:this.handleChange,checkBoxChanged:this.handleCheckboxChanged,handleCellDataEdit:this.handleCellDataEdit,onActiveStatusChange:this.handleActiveStatusChange})}),(0,S.jsx)(v.A,{children:(0,S.jsx)(o.E,{isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,handleSave:this.handleSave,handleDelete:this.authenticateDelete,saveEnabled:this.state.saveEnabled,isDeleteEnabled:this.state.isDeleteEnabled})}),this.state.showDeleteAuthenticationLayout||this.state.showSaveAuthenticationLayout?(0,S.jsx)(b.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:this.getFunctionName(),functionGroup:I.x5,handleClose:this.handleAuthenticationClose,handleOperation:this.handleOperation()}):null]}):(0,S.jsx)(m.A,{message:"Loading"})}}const T=(0,n.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(k)}}]);
//# sourceMappingURL=2554.9659235f.chunk.js.map