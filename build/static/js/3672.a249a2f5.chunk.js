"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[3672],{71291:(e,t,i)=>{i.r(t),i.d(t,{default:()=>F});var s=i(65043),a=i(78374),n=i(72711),l=i(67907),o=i(85800),r=i(65187),c=i(35861),d=i(69062),p=i(70579);function h(e){let{pipelineDispatch:t,modPipelineDispatch:i,validationErrors:s,attributeValidationErrors:h,listOptions:u,selectedCompRow:m,onFieldChange:D,handleRowSelectionChange:C,handleCellDataEdit:g,handleAddCompartment:S,handleDeleteCompartment:T,isEnterpriseNode:P,handleTerminalChange:E,handlePipelineHeaderChange:y,onTabChange:b,activeTab:x,loadingDetailsTab:f,modAttributeMetaDataList:v,onAttributeDataChange:R,loadingDetails:A,pipelineSnapShotInfo:k,isMeterRequired:L,isTankRequired:I,handleCellCheck:M,onDateTextChange:j}=e;const N=(e,t)=>{let i=[];return i=e.find((e=>e.TerminalCode===t)),i.attributeValidationErrors},_=e=>(0,p.jsx)(n.Input,{fluid:!0,value:i.PipelineDispatchTanks[e.rowIndex][e.field],onChange:t=>g(t,e),reserveSpace:!1}),O=e=>(0,p.jsx)(n.DatePicker,{fluid:!0,value:null===i.PipelineDispatchTanks[e.rowIndex][e.field]?"":new Date(i.PipelineDispatchTanks[e.rowIndex][e.field]),type:"datetime",displayFormat:(0,c.F1)(),indicator:"required",onChange:t=>g(t,e),onTextChange:(t,i)=>{j(e,t,i)},reserveSpace:!1}),w=e=>{const{value:t}=e;return null!==t?new Date(t).toLocaleDateString()+" "+new Date(t).toLocaleTimeString():""},U=e=>(0,p.jsx)(n.Checkbox,{className:"forceCompleteChkBox",checked:e.value,onChange:t=>{M(e,t)}});return(0,p.jsx)(l.TranslationConsumer,{children:e=>(0,p.jsxs)("div",{className:"detailsContainer",children:[(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(n.Input,{fluid:!0,value:i.PipelineDispatchCode,indicator:"required",disabled:""!==t.PipelineDispatchCode,onChange:e=>D("PipelineDispatchCode",e),label:e("PipelineDispatch_DispatchCode"),error:e(s.PipelineDispatchCode),reserveSpace:!1})}),P?(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(n.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("TerminalCode"),value:null===i.TerminalCodes||0===i.TerminalCodes.length?"":i.TerminalCodes[0],disabled:""!==t.PipelineDispatchCode,onChange:e=>E(e),indicator:"required",error:e(s.TerminalCodes),options:d.Zj(u.terminalCodes),reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}):"",(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(n.Select,{fluid:!0,indicator:"required",label:e("PipelineDispatch_CustomerCode"),value:i.CustomerCode,onChange:e=>D("CustomerCode",e),options:u.customerOptions,error:e(s.CustomerCode),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(n.Select,{fluid:!0,indicator:"required",label:e("PipelineDispatch_Destination"),value:i.DestinationCode,onChange:e=>D("DestinationCode",e),options:u.destinationOptions,error:e(s.DestinationCode),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(n.Input,{fluid:!0,value:i.PipelineDispatchStatus,label:e("PipelineDispatch_DispatchStatus"),reserveSpace:!1,disabled:!0})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(n.Select,{fluid:!0,indicator:"required",label:e("PipelineDispatch_HeaderLineCode"),value:i.PipelineHeaderCode,onChange:e=>y(e),options:u.pipelineHeaderOptions,error:e(s.PipelineHeaderCode),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(n.Select,{fluid:!0,label:e("PipelineDispatch_HeaderLineMeter"),value:i.PipelineHeaderMeterCode,onChange:e=>D("PipelineHeaderMeterCode",e),options:d.Zj(u.pipelineHeaderMeterOptions),error:e(s.PipelineHeaderMeterCode),indicator:L?"required":"",reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(n.Input,{fluid:!0,value:i.Quantity,indicator:"required",onChange:e=>D("Quantity",e),label:e("PipelineDispatch_Quantity"),error:e(s.Quantity),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(r.A,{children:(0,p.jsx)(n.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("PipelineDispatch_UOM"),value:i.QuantityUOM,multiple:!1,indicator:"required",options:u.quantityUOM,disabled:0===u.quantityUOM.length,error:e(s.QuantityUOM),onChange:e=>D("QuantityUOM",e),reserveSpace:!1})})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(n.Select,{fluid:!0,indicator:"required",label:e("PipelineDispatch_FinishedProductCode"),value:i.FinishedProductCode,onChange:e=>D("FinishedProductCode",e),options:u.finishedProductOptions,error:e(s.FinishedProductCode),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4 starttime",children:(0,p.jsx)(n.DatePicker,{fluid:!0,value:null===i.ScheduledStartTime?"":new Date(i.ScheduledStartTime),label:e("PipelineDispatch_ExpectedStartTime"),type:"datetime",displayFormat:(0,c.F1)(),disablePast:!1,indicator:"required",onChange:e=>D("ScheduledStartTime",e),error:e(s.ScheduledStartTime),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(n.DatePicker,{fluid:!0,value:null===i.ScheduledEndTime?"":new Date(i.ScheduledEndTime),label:e("PipelineDispatch_ExpectedEndTime"),type:"datetime",displayFormat:(0,c.F1)(),disablePast:!1,indicator:"required",onChange:e=>D("ScheduledEndTime",e),error:e(s.ScheduledEndTime),reserveSpace:!1})}),(0,p.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,p.jsx)(n.Input,{fluid:!0,value:i.Remarks,label:e("Cust_Remarks"),onChange:e=>D("Remarks",e),reserveSpace:!1})})]}),v.length>0?v.map((t=>(0,p.jsx)(r.A,{children:(0,p.jsx)(n.Accordion,{children:(0,p.jsx)(n.Accordion.Content,{className:"attributeAccordian",title:P?t.TerminalCode+" - "+e("Attributes_Header"):e("Attributes_Header"),children:(0,p.jsx)(o.n,{selectedAttributeList:t.attributeMetaDataList,handleCellDataEdit:R,attributeValidationErrors:N(h,t.TerminalCode)})})})}))):null,(0,p.jsx)("div",{className:"shipmentTabAlignment",children:(0,p.jsxs)(n.Tab,{activeIndex:x,onTabChange:e=>{b(e)},children:[(0,p.jsxs)(n.Tab.Pane,{title:e("Dispatch_Plan"),children:[(0,p.jsxs)("div",{className:"row compartmentRow",children:[(0,p.jsx)("div",{className:"col col-md-8 col-lg-9 col col-xl-9"}),(0,p.jsx)("div",{className:"col col-md-4 col-lg-3 col-xl-3",children:(0,p.jsxs)("div",{className:"compartmentIconContainer",children:[(0,p.jsxs)("div",{onClick:S,className:"compartmentIcon",children:[(0,p.jsx)("div",{children:(0,p.jsx)(n.Icon,{root:"common",name:"badge-plus",size:"medium"})}),(0,p.jsx)("div",{className:"margin_l10",children:(0,p.jsx)("h5",{className:"font14",children:e("FinishedProductInfo_Add")})})]}),(0,p.jsxs)("div",{onClick:T,className:"compartmentIcon margin_l30",children:[(0,p.jsx)("div",{children:(0,p.jsx)(n.Icon,{root:"common",name:"delete",size:"medium"})}),(0,p.jsx)("div",{className:"margin_l10",children:(0,p.jsx)("h5",{className:"font14",children:e("DestAdd_Delete")})})]})]})})]}),(0,p.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(a.bQ,{data:i.PipelineDispatchTanks,selectionMode:"multiple",selection:m,onSelectionChange:C,children:[(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"TankCode",header:I?(0,c.i7)(e("PipelineDispatch_TankCode")):e("PipelineDispatch_TankCode"),editable:!0,editFieldType:"text",customEditRenderer:e=>{return t=e,s=u.tankCodeOptions,(0,p.jsx)(n.Select,{className:"selectDropwdown",value:i.PipelineDispatchTanks[t.rowIndex][t.field],fluid:!0,options:s,onChange:e=>g(e,t),indicator:"required",reserveSpace:!1,search:!0});var t,s}},"TankCode"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"Quantity",header:e("PipelineDispatch_ExpectedQuantity"),editable:!0,editFieldType:"text",renderer:e=>(e=>{const{value:t}=e;return"number"===typeof t?t.toLocaleString():t})(e),customEditRenderer:_},"Quantity"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"PlannedStartTime",header:e("PipelineDispatch_ExpectedStartTime"),editable:!0,renderer:e=>w(e),customEditRenderer:e=>O(e)},"PlannedStartTime"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"PlannedEndTime",header:e("PipelineDispatch_ExpectedEndTime"),editable:!0,renderer:e=>w(e),customEditRenderer:e=>O(e)},"PlannedEndTime")]})})})]}),f.map((t=>(0,p.jsxs)(n.Tab.Pane,{title:e("ViewShipment_LoadingDetails"),children:[(0,p.jsx)(r.A,{children:(0,p.jsx)(n.Accordion,{children:(0,p.jsx)(n.Accordion.Content,{className:"attributeAccordian",title:e("PipelineDispatchDetails_TransactionSummary"),children:(0,p.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(a.bQ,{data:k,children:[(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"ReceivedGrossQuantity",header:e("PipelineDispatchTransaction_ActualGrossQuantity"),initialWidth:"120px"},"ReceivedGrossQuantity"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"ReceivedNetQuantity",header:e("PipelineDispatchTransaction_ActualNetQuantity")},"ReceivedNetQuantity"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"RationPending",header:e("PipelineDispatchTransaction_RationPending")},"RationPending"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"ReceivedQuantityUOM",header:e("PipelineDispatchTransaction_ActualQuantityUOM")},"ReceivedQuantityUOM"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"PlannedStartTime",header:e("PipelineDispatchTransaction_ExpectedStartDateTime")},"PlannedStartTime"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"PlannedEndTime",header:e("PipelineDispatchTransaction_ExpectedEndDateTime")},"PlannedEndTime"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"ActualStartTime",header:e("PipelineDispatchTransaction_ActualStartDateTime")},"ActualStartTime"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"ActualEndTime",header:e("PipelineDispatchTransaction_ActualEndDateTime")},"ActualEndTime"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"IsInvalid",header:e("PipelineDispatchTransaction_Ignore"),renderer:U},"IsInvalid")]})})})})})}),(0,p.jsx)(r.A,{children:(0,p.jsx)(n.Accordion,{children:(0,p.jsx)(n.Accordion.Content,{className:"attributeAccordian",title:e("PipelineDispatchDetails_TankTransactionSummary"),children:(0,p.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(a.bQ,{data:A.Table2,children:[(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"TankCode",header:e("TankVolume_TankCode"),initialWidth:"150px"},"TankCode"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"StartGrossVolume",header:e("TankVolume_StartGrossVolume")},"StartGrossVolume"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"EndGrossVolume",header:e("TankVolume_EndGrossVolume")},"EndGrossVolume"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"StartNetVolume",header:e("TankVolume_StartNetVolume")},"StartNetVolume"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"EndNetVolume",header:e("TankVolume_EndNetVolume")},"EndNetVolume"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"Density",header:e("TankVolume_Density")},"Density"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"Temperature",header:e("TankVolume_Temprature")},"Temperature")]})})})})})}),(0,p.jsx)(r.A,{children:(0,p.jsx)(n.Accordion,{children:(0,p.jsx)(n.Accordion.Content,{className:"attributeAccordian",title:e("PipelineDispatchDetails_MeterTransactionSummary"),children:(0,p.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(a.bQ,{data:A.Table1,children:[(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"MeterCode",header:e("PipelineReceipt_MeterCode"),initialWidth:"150px"},"MeterCode"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"StartGrossTotalizer",header:e("TankTransaction_StartGrossTotalizer")},"StartGrossTotalizer"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"EndGrossTotalizer",header:e("TankMeter_EndGrossTotalizer")},"EndGrossTotalizer"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"StartNetTotalizer",header:e("TankTransaction_StartNetTotalizer")},"StartNetTotalizer"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"EndNetTotalizer",header:e("TankMeter_EndNetTotalizer")},"EndNetTotalizer"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"Density",header:e("TankMeter_Density")},"Density"),(0,p.jsx)(a.bQ.Column,{className:"compColHeight",field:"Temperature",header:e("TankMeter_Temperature")},"Temperature")]})})})})})})]})))]})})]})})}h.defaultProps={listOptions:{quantityUOM:[],pipelineHeaderOptions:[],pipelineHeaderMeterOptions:[],tankCodeOptions:[],terminalCodes:[],customerOptions:[],destinationOptions:[],finishedProductOptions:[]},isEnterpriseNode:!1};var u=i(9256),m=i(44192),D=i(46100),C=i(40854),g=i.n(C),S=i(72067),T=i(7523),P=i(9966),E=i(50805),y=i(97508),b=(i(38726),i(43503)),x=i(93779),f=i(80312),v=i(53536),R=i.n(v),A=i(28882),k=i(40252),L=i(15417),I=i(61227),M=i(4401),j=i(14159),N=i(11981),_=i(87770),O=i(40510),w=i(39424),U=i(60446),H=i.n(U),V=i(62900);class Q extends s.Component{constructor(){super(...arguments),this.state={pipelineDispatch:R().cloneDeep(D.Wf),modPipelineDispatch:{},validationErrors:d.Th(m.xS),isReadyToRender:!1,quantityUOMOptions:[],customerOptions:[],customerDestinationOptions:{},destinationOptions:[],pipelineHeaderOptions:[],pipelineHeaderMeterOptions:[],finishedProductOptions:[],tankOptions:[],saveEnabled:!1,selectedCompRow:[],activeTab:0,attributeMetaDataList:[],modAttributeMetaDataList:[],attributeValidationErrors:[],loadingDetails:{},currentDispatchStatus:{},shipmentNextOperations:[],drawerStatus:!1,UOMS:{},isManualEntry:!1,isViewAuditTrail:!1,isMeterRequired:!1,isTankRequired:!0,pipelineSnapShotInfo:[],commentsPopUp:!1,remarks:"",isSubmit:!1,auditTrailAttributeMetaDataList:[],modAuditTrailList:[],auditTrailList:[],noOfSignificantDigits:"3",pipelineDispatchKPIList:[],showAuthenticationLayout:!1,tempPipelineDispatch:{}},this.handleAttributeDataChange=(e,t)=>{try{let i=[],s=R().cloneDeep(this.state.modAttributeMetaDataList),a=s.filter((t=>t.TerminalCode===e.TerminalCode));a.length>0&&Array.isArray(a[0].attributeMetaDataList)&&(i=a[0].attributeMetaDataList.filter((t=>t.Code===e.Code))),i.length>0&&(i[0].DefaultValue=t),this.setState({modAttributeMetaDataList:s});const n=R().cloneDeep(this.state.attributeValidationErrors);n.forEach((i=>{i.TerminalCode===e.TerminalCode&&(i.attributeValidationErrors[e.Code]=d.I5(e,t))})),this.setState({attributeValidationErrors:n})}catch(i){console.log("TrailerDetailsComposite:Error occured on handleAttributeCellDataEdit",i)}},this.addUpdatePipelineDispatch=()=>{try{this.setState({saveEnabled:!1});let e=R().cloneDeep(this.state.tempPipelineDispatch);""===this.state.pipelineDispatch.PipelineDispatchCode?this.createPipelineDispatch(e):this.updatePipelineDispatch(e)}catch(e){console.log("pipeline Dispatch Composite : Error in addUpdatePipelineDispatch")}},this.handleSave=()=>{try{let e=this.fillDetails(),t=d.pI(this.state.modAttributeMetaDataList);if(this.validateSave(e,t)){e=this.convertStringtoDecimal(e,t);let i=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,s=R().cloneDeep(e);this.setState({showAuthenticationLayout:i,tempPipelineDispatch:s},(()=>{!1===i&&this.addUpdatePipelineDispatch()}))}else this.setState({saveEnabled:!0})}catch(e){console.log("PipelineDispatchDetailsComposite:Error occured on handleSave",e)}},this.handleOperationClick=e=>{let t=R().cloneDeep(this.state.pipelineDispatch),i={messageType:"critical",message:e+"_status",messageResultDetails:[{keyFields:["PipelineDispatch_DispatchCode"],keyValues:[t.PipelineDispatchCode],isSuccess:!1,errorMessage:""}]};switch(e){case T.DH.Authorize_ManualEntry_Update:this.props.handleAuthorizeToManualEntry(t.PipelineDispatchCode,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{i.messageType=e.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=e.IsSuccess,!0===e.IsSuccess?this.getPipelineDispatch({Common_Code:t.PipelineDispatchCode}):i.messageResultDetails[0].errorMessage=e.ErrorList[0],this.props.onSaved(t,"update",i)}));break;case T.DH.Authorize_Scada_Update:this.props.handleAuthorizeToScadaUpdate(t.PipelineDispatchCode,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{i.messageType=e.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=e.IsSuccess,!0===e.IsSuccess?this.getPipelineDispatch({Common_Code:t.PipelineDispatchCode}):i.messageResultDetails[0].errorMessage=e.ErrorList[0],this.props.onSaved(t,"update",i)}));break;case T.DH.PipelineDispatchList_btnTransactionReport:this.props.handlePrintTransaction(t,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{i.messageType=e.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=e.IsSuccess,!0===e.IsSuccess?this.getPipelineDispatch({Common_Code:t.PipelineDispatchCode},1):i.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,j.toast)((0,p.jsx)(r.A,{children:(0,p.jsx)(N.A,{notificationMessage:i})}),{autoClose:"success"===i.messageType&&1e4})}));break;case T.DH.PipelineDispatchList_btnViewTransactionReport:this.props.handleViewTransaction();break;case T.DH.PipelineDispatch_BtnAuditTrail:this.props.handleViewAuditTrail(t.PipelineDispatchCode,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{if(!0===e.IsSuccess){let i=R().cloneDeep(e.EntityResult),s=R().cloneDeep(this.state.auditTrailAttributeMetaDataList);for(let e=0;e<i.length;e++){let t=i[e].PipelineDispatchStatus.toUpperCase();t===T.iT.CLOSED?t=T.xx.CLOSED:t===T.iT.AUTHORIZED?t=T.xx.AUTHORIZED:t===T.iT.READY?t=T.xx.READY:t===T.iT.INPROGRESS?t=T.xx.INPROGRESS:t===T.iT.MANUALLY_COMPLETED?t=T.xx.MANUALLY_COMPLETED:t===T.iT.INITIATED?t=T.xx.INITIATED:t===T.iT.INTERRUPTED?t=T.xx.INTERRUPTED:t===T.iT.AUTO_COMPLETED?t=T.xx.AUTO_COMPLETED:t===T.iT.PARTIALLY_COMPLETED?t=T.xx.PARTIALLY_COMPLETED:t===T.iT.EXCESSIVELY_COMPLETED&&(t=T.xx.EXCESSIVELY_COMPLETED),i[e].PipelineDispatchStatus=t,i[e].UpdatedTime=new Date(i[e].UpdatedTime).toLocaleDateString()+" "+new Date(i[e].UpdatedTime).toLocaleTimeString()}let a=R().cloneDeep(e.EntityResult);for(let e=0;e<a.length;e++)a[e].UpdatedTime=new Date(a[e].UpdatedTime).toLocaleDateString()+" "+new Date(a[e].UpdatedTime).toLocaleTimeString(),a[e].PipelineDispatchStatus===T.iT.AUTHORIZED&&(a[e].PipelineDispatchStatus=T.pC.AUTHORIZED),a[e].AttributesforUI=this.formReadonlyCompAttributes(a[e].Attributes,s);this.setState({auditTrailList:a,modAuditTrailList:i,isViewAuditTrail:!0}),this.getPipelineDispatch({Common_Code:t.PipelineDispatchCode})}else i.messageType=e.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=e.IsSuccess,i.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,j.toast)((0,p.jsx)(r.A,{children:(0,p.jsx)(N.A,{notificationMessage:i})}),{autoClose:"success"===i.messageType&&1e4})}));break;case T.DH.PipelineDispatch_BtnManualEntry:this.setState({isManualEntry:!0});break;case T.DH.PipelineDispatch_BtnClosed:this.setState({commentsPopUp:!0,isSubmit:!1});break;case T.DH.PipelineDispatch_BtnSubmit:this.setState({commentsPopUp:!0,isSubmit:!0});break;default:return}},this.handleCellCheck=(e,t)=>{let i=R().cloneDeep(this.state.pipelineSnapShotInfo);const s=i.findIndex((t=>t.SeqNumber===e.rowData.SeqNumber));s>-1&&(i[s].IsInvalid=t),this.setState({pipelineSnapShotInfo:i})},this.onBack=()=>{let e=this.getDispatchUpdateStates();this.setState({isManualEntry:!1,isViewAuditTrail:!1,saveEnabled:e.indexOf(this.state.pipelineDispatch.PipelineDispatchStatus)>-1&&d.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.modify,f.dK),drawerStatus:!1}),this.getPipelineDispatch({Common_Code:this.state.modPipelineDispatch.PipelineDispatchCode})},this.handleCommentsModal=()=>(0,p.jsx)(l.TranslationConsumer,{children:e=>(0,p.jsxs)(n.Modal,{open:this.state.commentsPopUp,size:"mini",children:[(0,p.jsxs)(n.Modal.Content,{children:[(0,p.jsx)("div",{className:"col col-lg-12",children:(0,p.jsx)("h3",{children:e("ViewPipelineDispatch_CloseHeader")+" : "+this.state.pipelineDispatch.PipelineDispatchCode})}),(0,p.jsx)("div",{style:{display:"flex",flexWrap:"wrap"},children:(0,p.jsx)("div",{className:"col col-lg-12",children:(0,p.jsx)(n.Input,{fluid:!0,value:this.state.remarks,reserveSpace:!1,onChange:e=>{this.setState({remarks:e})}})})})]}),(0,p.jsxs)(n.Modal.Footer,{children:[(0,p.jsx)(n.Button,{type:"primary",content:e("AccessCardInfo_Ok"),onClick:()=>{if(""===this.state.remarks){let e={messageType:"critical",message:"ViewPipelineDispatch_ShipmentClose",messageResultDetails:[{keyFields:["PipelineDispatch_DispatchCode"],keyValues:[this.state.pipelineDispatch.PipelineDispatchCode],isSuccess:!1,errorMessage:"AdditiveInjectorInfo_RemarkRequired"}]};(0,j.toast)((0,p.jsx)(r.A,{children:(0,p.jsx)(N.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})}else this.setState({commentsPopUp:!1},(()=>{this.state.isSubmit?this.handleSubmit():this.CloseDispatch()}))}}),(0,p.jsx)(n.Button,{type:"primary",content:e("Cancel"),onClick:()=>{this.setState({commentsPopUp:!1,remarks:R().cloneDeep(this.state.remarks)})}})]})]})}),this.handleReset=()=>{try{const e={...this.state.validationErrors},t=R().cloneDeep(this.state.pipelineDispatch);Object.keys(e).forEach((function(t){e[t]=""})),this.setState({modPipelineDispatch:{...t},validationErrors:e,modAttributeMetaDataList:[]},(()=>{this.props.userDetails.EntityResult.IsEnterpriseNode?(this.terminalSelectionChange(t.TerminalCodes),this.handleResetAttributeValidationError()):(this.localNodeAttribute(),this.handleResetAttributeValidationError())}))}catch(e){console.log("PipelineDispatchDetailsComposite:Error occured on handleReset",e)}},this.handleChange=(e,t)=>{try{const i=R().cloneDeep(this.state.modPipelineDispatch),s=R().cloneDeep(this.state.validationErrors);i[e]=t,"CustomerCode"===e&&(this.setDestinations(t),1===this.state.customerDestinationOptions[t].length?(i.DestinationCode=this.state.customerDestinationOptions[t][0],s.DestinationCode=""):i.DestinationCode=""),this.setState({modPipelineDispatch:i}),void 0!==m.xS[e]&&(s[e]=d.jr(m.xS[e],t),this.setState({validationErrors:s}))}catch(i){console.log("PipelineDispatchDetailsComposite:Error occured on handleChange",i)}},this.handleRowSelectionChange=e=>{this.setState({selectedCompRow:e})},this.handleCellDataEdit=(e,t)=>{try{let i=R().cloneDeep(this.state.modPipelineDispatch);i.PipelineDispatchTanks[t.rowIndex][t.field]=e,this.setState({modPipelineDispatch:i})}catch(i){console.log("Error in handleCellDataEdit",i)}},this.handleDateTextChange=(e,t,i)=>{try{var s=R().cloneDeep(this.state.modPipelineDispatch);let i=s.PipelineDispatchTanks.findIndex((t=>t.sequenceNo===e.rowData.sequenceNo));i>=0&&(s.PipelineDispatchTanks[i][e.field]=""===t?null:t,this.setState({modPipelineDispatch:s}))}catch(i){console.log("Error in DateTextChange : Error occured on handleDateTextChange",i)}},this.handleAddCompartment=()=>{try{if(!this.props.userDetails.EntityResult.IsArchived)try{let e=R().cloneDeep(this.state.modPipelineDispatch),t={PipelineDispatchCode:"",TankCode:"",PipelineTankMeterCode:null,Quantity:0,QuantityUOM:"",PlannedStartTime:null,PlannedEndTime:null,SeqNumber:d.Mz(e.PipelineDispatchTanks)};e.PipelineDispatchTanks.push(t),this.setState({modPipelineDispatch:e,selectedCompRow:[]})}catch(e){console.log("PipelineDispatchDetailsComposite:Error occured on handleAddCompartment",e)}}catch(e){console.log("PipelineDispatchDetailsComposite: Error in Add Compartment")}},this.handleDeleteCompartment=()=>{try{if(!this.props.userDetails.EntityResult.IsArchived)try{if(null!=this.state.selectedCompRow&&this.state.selectedCompRow.length>0&&this.state.modPipelineDispatch.PipelineDispatchTanks.length>0){let e=R().cloneDeep(this.state.modPipelineDispatch);this.state.selectedCompRow.forEach(((t,i)=>{e.PipelineDispatchTanks=e.PipelineDispatchTanks.filter(((e,i)=>e.SeqNumber!==t.SeqNumber))})),this.setState({modPipelineDispatch:e,selectedCompRow:[]})}}catch(e){console.log("PipelineDispatchDetailsComposite:Error occured on handleDeleteCompartment",e)}}catch(e){console.log("PipelineDispatchDetailsComposite: Error in Delete Compartment")}},this.handlePipelineHeaderChange=e=>{try{const t=R().cloneDeep(this.state.modPipelineDispatch);t.PipelineHeaderCode=e;let i=R().cloneDeep(this.state.validationErrors);i.PipelineHeaderCode="",this.setState({modPipelineDispatch:t,validationErrors:i},(()=>this.getPipelineMeter(e,t.TerminalCodes[0])))}catch(t){console.log("PipelineDispatchDetailsComposite:Error occured on handlePipelineHeaderChange",t)}},this.handleTerminalChange=e=>{try{const t=R().cloneDeep(this.state.modPipelineDispatch);null===e?t.TerminalCodes=[]:(t.TerminalCodes[0]=e,t.PipelineHeaderCode=null,t.PipelineHeaderMeterCode=null),this.setState({modPipelineDispatch:t,pipelineHeaderMeterOptions:[]},(()=>{this.getTank(e),this.getHeaderLineCode(e),this.getCustomerDestinations(this.props.selectedShareholder,t.CustomerCode,e),this.getFinishedProductCodes(this.props.selectedShareholder,e),this.terminalSelectionChange([e])}))}catch(t){console.log("PipelineDispatchDetailsComposite:Error occured on handleTerminalChange",t)}},this.handleTabChange=e=>{try{this.setState({activeTab:e,expandedRows:[]})}catch(t){console.log("PipelineDispatchDetailsComposite: Error occurred on handleTabChange",t)}},this.handleDrawer=()=>{var e=R().cloneDeep(this.state.drawerStatus);this.setState({drawerStatus:!e})},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentWillReceiveProps(e){try{if(""!==this.state.pipelineDispatch.PipelineDispatchCode&&void 0===e.selectedRow.Common_Code){this.getAttributes(e.selectedRow);let t={...this.state.validationErrors};Object.keys(t).forEach((e=>{t[e]=""})),this.setState({validationErrors:t,isManualEntry:!1,activeTab:0})}}catch(t){console.log("PipelineDispatchDetailsComposite:Error occured on componentWillReceiveProps",t)}}componentDidMount(){try{d.pJ(this.props.userDetails.EntityResult.IsArchived),this.getUoms(),this.getRefrenceSource(),this.getSignificantDigits(),this.props.userDetails.EntityResult.IsEnterpriseNode||(this.getTank(""),this.getHeaderLineCode(""),this.getCustomerDestinations(this.props.selectedShareholder,null,""),this.getFinishedProductCodes(this.props.selectedShareholder,"")),this.getAttributes(this.props.selectedRow)}catch(e){console.log("PipelineDispatchDetailsComposite:Error occured on componentDidMount",e)}}getSignificantDigits(){try{g()(S.xAA+"?LookUpTypeCode=Common",d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;!0===t.IsSuccess?void 0!==t.EntityResult.NumberOfSignificantDigits&&null!==t.EntityResult.NumberOfSignificantDigits&&this.setState({noOfSignificantDigits:t.EntityResult.NumberOfSignificantDigits}):console.log("Error in getSignificantDigits: ",t.ErrorList)})).catch((e=>{console.log("PipelineDispatchDetailsComposite: Error occurred on getSignificantDigits",e)}))}catch(e){console.log("PipelineDispatchDetailsComposite:Error occured on geting RefrenceSourceLookUp Value",e)}}getRefrenceSource(){try{g()(S.xAA+"?LookUpTypeCode=PipelineDispatch",d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;!0===t.IsSuccess?"0"===t.EntityResult.CustodyTransferReferenceSource?this.setState({isMeterRequired:!0,isTankRequired:!1}):this.setState({isMeterRequired:!1,isTankRequired:!0}):console.log("Error in getLookUpData: ",t.ErrorList)})).catch((e=>{console.log("PipelineDispatchDetailsComposite: Error occurred on getLookUpData",e)}))}catch(e){console.log("PipelineDispatchDetailsComposite:Error occured on geting RefrenceSourceLookUp Value",e)}}getAttributes(e){try{g()(S.fKH,d.tW([L.hq,L.Z2],this.props.tokenDetails.tokenInfo)).then((t=>{var i=t.data;!0===i.IsSuccess?this.setState({attributeMetaDataList:R().cloneDeep(i.EntityResult.PIPELINEDISPATCH),auditTrailAttributeMetaDataList:R().cloneDeep(i.EntityResult.PIPELINEDISPATCHSTATUSTIME),attributeValidationErrors:d.Fl(i.EntityResult.PIPELINEDISPATCH)},(()=>this.getPipelineDispatch(e))):console.log("Error in getAttributes:")}))}catch(t){console.log("Error while getAttributes:",t)}}localNodeAttribute(){try{var e=R().cloneDeep(this.state.attributeMetaDataList);e.length>0&&this.terminalSelectionChange([e[0].TerminalCode])}catch(t){console.log("TrailerDetailsComposite:Error occured on localNodeAttribute",t)}}terminalSelectionChange(e){try{let a=[];var t=[],i=[];t=R().cloneDeep(this.state.attributeMetaDataList),i=R().cloneDeep(this.state.modAttributeMetaDataList);const n=R().cloneDeep(this.state.attributeValidationErrors);var s=R().cloneDeep(this.state.pipelineDispatch);e.forEach((e=>{var n=i.find((t=>t.TerminalCode===e));void 0===n?t.forEach((function(t){if(t.TerminalCode===e){var i=s.Attributes.find((t=>t.TerminalCode===e));void 0!==i&&t.attributeMetaDataList.forEach((function(e){var t=i.ListOfAttributeData.find((t=>t.AttributeCode===e.Code));void 0!==t&&(e.DefaultValue=t.AttributeValue)})),a.push(t)}})):a.push(n)})),i=[],i=a,i=d.nQ(i),n.forEach((t=>{void 0===e.find((e=>t.TerminalCode===e))&&Object.keys(t.attributeValidationErrors).forEach((e=>t.attributeValidationErrors[e]=""))})),this.setState({modAttributeMetaDataList:i,attributeValidationErrors:n})}catch(a){console.log("TrailerDetailsComposite:Error occured on terminalSelectionChange",a)}}fillAttributeDetails(e,t){try{return t=d.SC(t),e.Attributes=d.Gh(t),this.setState({modPipelineDispatch:e}),e}catch(i){console.log("PipelineDispatchDetailsComposite:Error occured on fillAttributeDetails",i)}}convertStringtoDecimal(e,t){try{return e=this.fillAttributeDetails(e,t)}catch(i){console.log("convertStringtoDecimal error Pipeline Dispatch Details",i)}}getUoms(){try{g()(S.WFM,d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult.VOLUME)){var i=R().cloneDeep(this.state.quantityUOMOptions);t.EntityResult.VOLUME.forEach((e=>{i.push({text:e,value:e})})),t.EntityResult.MASS.forEach((e=>{i.push({text:e,value:e})})),this.setState({quantityUOMOptions:i,UOMS:t.EntityResult})}}else console.log("Error in GetUOMList:",t.ErrorList)})).catch((e=>{console.log("Error in GetUOMList:",e)}))}catch(e){console.log("Error in GetUOMList",e)}}getFinishedProductCodes(e,t){try{g()(S.w43+"?ShareholderCode="+e+"&TerminalCode="+t,d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){var i=[];t.EntityResult.forEach((e=>{i.push({text:e,value:e})})),this.setState({finishedProductOptions:i})}}else console.log("Error in GetFinishedProductCodes:",t.ErrorList)})).catch((e=>{console.log("Error while GetFinishedProductCodes List:",e)}))}catch(i){console.log("Error in getting FinishedProduct")}}getCustomerDestinations(e,t,i){try{g()(S.E6k+"?ShareholderCode="+e+"&TransportationType="+T.LY.PIPELINE+"&TerminalCode="+i,d.Jm(this.props.tokenDetails.tokenInfo)).then((i=>{let s=i.data;if(!0===s.IsSuccess)if(Array.isArray(s.EntityResult)){let i=s.EntityResult.filter((t=>t.ShareholderCode===e));if(i.length>0){let e=[],s=R().cloneDeep(this.state.customerDestinationOptions);s=i[0].CustomerDestinationsList;for(let t in s)e.push({text:t,value:t});this.setState({customerOptions:e,customerDestinationOptions:s}),t&&this.setDestinations(t)}else console.log("no customers identified for shareholder")}else console.log("customerdestinations not identified for shareholder")})).catch((e=>{console.log("Error while getting Customer List:",e)}))}catch(s){console.log("Error in getting CustomerDestination List",s)}}setDestinations(e){try{let t=[];this.state.customerDestinationOptions[e].forEach((e=>{t.push({text:e,value:e})})),this.setState({destinationOptions:t})}catch(t){console.log("Errro in setting the destination options")}}getHeaderLineCode(e){try{g()(S.KNA+"?Terminal="+e,d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){let e=d.Zj(t.EntityResult);this.setState({pipelineHeaderOptions:e})}}else console.log("Error in getHeaderLineCode:",t.ErrorList)})).catch((e=>{console.log("Error in getHeaderLineCode:",e)}))}catch(t){console.log("Error in getting Header Code",t)}}getDispatchUpdateStates(){var e=[];try{let t=this.props.activityInfo.filter((e=>e.ActivityCode===T.Ch.PIPELINE_DISPATCH_ENABLE_UPDATE&&e.ActionTypeCode===T.Gd.CHECK));void 0!==t&&t.length>0&&(e=t[0].ShipmentStates)}catch(t){console.log("Error in gettingDispatchUpdateStates",t)}return e}getPipelineDispatch(e){try{let s=T.LY.PIPELINE;if(void 0===e.Common_Code)return D.Wf.TransactionMode=T.LY.PIPELINE,D.Wf.QuantityUOM=this.props.userDetails.EntityResult.PageAttibutes.DefaultQtyUOMForTransactionUI.PIPELINE,D.Wf.Quantity="",D.Wf.ScheduledEndTime=new Date,D.Wf.ScheduledStartTime=new Date,void this.setState({pipelineDispatch:R().cloneDeep(D.Wf),modPipelineDispatch:R().cloneDeep(D.Wf),modAttributeMetaDataList:[],isReadyToRender:!0,pipelineDispatchKPIList:[],saveEnabled:d.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.add,f.dK)},(()=>{this.props.userDetails.EntityResult.IsEnterpriseNode?1===this.props.terminalCodes.length?this.terminalSelectionChange(this.props.terminalCodes):this.terminalSelectionChange([]):this.localNodeAttribute([])}));var t=[{key:x.Cg,value:e.Common_Code},{key:x.v6,value:s}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:x.Cg,KeyCodes:t};g()(S.Zt7,d.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{var i=t.data;if(!0===i.IsSuccess){null===i.EntityResult.PipelineDispatchTanks?i.EntityResult.PipelineDispatchTanks=[]:i.EntityResult.PipelineDispatchTanks=d.Q3(i.EntityResult.PipelineDispatchTanks),this.props.userDetails.EntityResult.IsEnterpriseNode?(this.getTank(i.EntityResult.TerminalCodes[0]),this.getHeaderLineCode(i.EntityResult.TerminalCodes[0]),this.getPipelineMeter(i.EntityResult.PipelineHeaderCode,i.EntityResult.TerminalCodes[0]),this.getCustomerDestinations(this.props.selectedShareholder,i.EntityResult.CustomerCode,i.EntityResult.TerminalCodes[0]),this.getFinishedProductCodes(this.props.selectedShareholder,i.EntityResult.TerminalCodes[0])):(this.getPipelineMeter(i.EntityResult.PipelineHeaderCode,""),this.getCustomerDestinations(this.props.selectedShareholder,i.EntityResult.CustomerCode,""));let t=this.getDispatchUpdateStates();this.setState({isReadyToRender:!0,pipelineDispatch:i.EntityResult,modPipelineDispatch:{...i.EntityResult},saveEnabled:t.indexOf(i.EntityResult.PipelineDispatchStatus)>-1&&d.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.modify,f.dK)},(()=>{this.getLoadingDetails(i.EntityResult),this.getDispatchStatuses(e),this.getDispatchOperations(),this.getKPIList(this.props.selectedShareholder,i.EntityResult.PipelineDispatchCode),this.props.userDetails.EntityResult.IsEnterpriseNode?this.terminalSelectionChange(i.EntityResult.TerminalCodes):this.localNodeAttribute()}))}else this.setState({pipelineDispatch:R().cloneDeep(D.Wf),modPipelineDispatch:R().cloneDeep(D.Wf),isReadyToRender:!0}),console.log("Error in GetPipelineDispatch:",i.ErrorList)})).catch((e=>{console.log("Error while getting pipelineDispatch:",e)}))}catch(s){console.log("PipelineDispatchDetailsComposite : Error in getting pipeline dispatch")}}getDispatchOperations(){try{const e=R().cloneDeep(this.state.pipelineDispatch);let t=[];e.PipelineDispatchStatus.toUpperCase()!==T.Nh.READY&&e.PipelineDispatchStatus.toUpperCase()!==T.Nh.PARTIALLY_COMPLETED||(t.push("Authorize_ManualEntry_Update"),t.push("Authorize_Scada_Update")),e.PipelineDispatchStatus.toUpperCase()===T.Nh.CLOSED&&(t.push("PipelineDispatchList_btnTransactionReport"),t.push("PipelineDispatchList_btnViewTransactionReport")),t.push("PipelineDispatch_BtnAuditTrail"),e.PipelineDispatchStatus.toUpperCase()!==T.Nh.CLOSED&&e.PipelineDispatchStatus.toUpperCase()!==T.Nh.READY&&(t.push("PipelineDispatch_BtnManualEntry"),t.push("PipelineDispatch_BtnClosed"),t.push("PipelineDispatch_BtnSubmit")),this.setState({shipmentNextOperations:t})}catch(e){console.log("Error in getting Dispatch Current Operations")}}getDispatchStatuses(e){try{g()(S.i+"?shareholderCode="+this.props.selectedShareholder+"&pipelineDispatchCode="+e.Common_Code,d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;this.setState({currentDispatchStatus:t.EntityResult})})).catch((e=>{console.log("Error while getting getDispatchStatuses:",e)}))}catch(t){console.log(t)}}getLoadingDetails(e){try{var t=[{key:x.nT,value:e.PipelineDispatchCode},{key:x.mW,value:T.Br.DISPATCH}],i={ShareHolderCode:this.props.selectedShareholder,KeyCodes:t};g()(S.J59,d.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data.EntityResult,i=[],s=R().cloneDeep(this.state.remarks);if(void 0!==t&&null!==t){let e=R().cloneDeep(this.state.noOfSignificantDigits);null!==t.Table&&t.Table.length>0&&t.Table.forEach((e=>{e.RationPending=null!==e.RationPending?"FALSE"===e.RationPending.toString().toUpperCase()?"False":"True":e.RationPending,e.ActualEndTime=null!==e.ActualEndTime?new Date(e.ActualEndTime).toLocaleDateString()+" "+new Date(e.ActualEndTime).toLocaleTimeString():e.ActualEndTime,e.ActualStartTime=null!==e.ActualStartTime?new Date(e.ActualStartTime).toLocaleDateString()+" "+new Date(e.ActualStartTime).toLocaleTimeString():e.ActualStartTime,e.PlannedEndTime=new Date(e.PlannedEndTime).toLocaleDateString()+" "+new Date(e.PlannedEndTime).toLocaleTimeString(),e.PlannedStartTime=new Date(e.PlannedStartTime).toLocaleDateString()+" "+new Date(e.PlannedStartTime).toLocaleTimeString(),i.push(e),s=e.Remarks})),null!==t.Table2&&t.Table2.length>0&&t.Table2.forEach((t=>{t.EndGrossVolume=Math.round(t.EndGrossVolume,e).toString()+" "+t.VolumeUOM,t.EndNetVolume=Math.round(t.EndNetVolume,e).toString()+" "+t.VolumeUOM,t.StartGrossVolume=Math.round(t.StartGrossVolume,e).toString()+" "+t.VolumeUOM,t.StartNetVolume=Math.round(t.StartNetVolume,e).toString()+" "+t.VolumeUOM,t.Density=null===t.Density||0===t.Density?"0":Math.round(t.Density,e).toString()+" "+t.DensityUOM,t.Temperature=null===t.Temperature||0===t.Temperature?"0":Math.round(t.Temperature,e).toString()+" "+t.TemperatureUOM})),null!==t.Table1&&t.Table1.length>0&&t.Table1.forEach((t=>{t.Density=null===t.Density||0===t.Density?"0":Math.round(t.Density,e).toString()+" "+t.DensityUOM,t.Temperature=null===t.Temperature||0===t.Temperature?"0":Math.round(t.Temperature,e).toString()+" "+t.TemperatureUOM}))}null!==i&&void 0!==i&&i.length>0&&(i=d.Q3(i)),this.setState({loadingDetails:t,pipelineSnapShotInfo:i,remarks:s})})).catch((e=>{console.log("Error while getting dispatch compartment details:",e)}))}catch(s){console.log("Error in getLoadingDetails",s)}}formReadonlyCompAttributes(e,t){let i=[];return null!==t&&void 0!==t&&t.length>0&&t.forEach((e=>{e.attributeMetaDataList.forEach((e=>{i.push({AttributeCode:e.Code,AttributeName:e.DisplayName?e.DisplayName:e.Code,AttributeValue:e.DefaultValue,TerminalCode:e.TerminalCode,IsMandatory:e.IsMandatory,DataType:e.DataType,IsReadonly:e.IsReadonly,MinValue:e.MinValue,MaxValue:e.MaxValue,ValidationFormat:e.ValidationFormat,compSequenceNo:""})}))})),null!==e&&void 0!==e&&e.length>0&&e.forEach((e=>{i.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.ListOfAttributeData.forEach((e=>{t.AttributeCode===e.AttributeCode&&(t.AttributeValue=e.AttributeValue)}))}))})),i}CloseDispatch(){try{let e={messageType:"critical",message:"PipelineTransaction_SavedMessage",messageResultDetails:[{keyFields:["PipelineDispatch_DispatchCode"],keyValues:[this.state.pipelineDispatch.PipelineDispatchCode],isSuccess:!1,errorMessage:""}]},t=[{key:x.Cg,value:this.state.pipelineDispatch.PipelineDispatchCode},{key:"Remarks",value:this.state.remarks}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:x.Cg,KeyCodes:t};g()(S.t5T,d.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{let i=t.data;e.messageType=i.IsSuccess?"success":"critical",e.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess?this.getPipelineDispatch({Common_Code:this.state.pipelineDispatch.PipelineDispatchCode}):(e.messageResultDetails[0].errorMessage=i.ErrorList[0],console.log("Error in closing the dispatch:",i.ErrorList)),this.props.onSaved(this.state.pipelineDispatch,"add",e)})).catch((t=>{let i=this.getDispatchUpdateStates();this.setState({saveEnabled:i.indexOf(this.state.pipelineDispatch.PipelineDispatchStatus)>-1&&d.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.modify,f.dK)}),e.messageResultDetails[0].errorMessage=t,this.props.onSaved(this.state.pipelineDispatch,"add",e)}))}catch(e){console.log("PipelineDispatchDetails : Error in closing the dispatch")}}handleSubmit(){try{let e=[],t=!1;R().cloneDeep(this.state.pipelineSnapShotInfo).forEach((i=>{let s=R().cloneDeep(D.uk);s.Remarks=this.state.remarks,null!==this.state.pipelineDispatch.PipelineDispatchCode&&""!==this.state.pipelineDispatch.PipelineDispatchCode?s.PlanCode=this.state.pipelineDispatch.PipelineDispatchCode:s.PlanCode="",s.TransactionType=T.Br.DISPATCH,s.ShareholderCode=this.props.selectedShareholder,null!==i.PipelineTransactionID&&""!==i.PipelineTransactionID&&(s.PipelineTransactionID=d.bo(i.PipelineTransactionID)),null!==i.ReceivedGrossQuantity&&""!==i.ReceivedGrossQuantity&&(s.GrossQuantity=d.bo(i.ReceivedGrossQuantity)),null!==i.ReceivedNetQuantity&&""!==i.ReceivedNetQuantity&&(s.NetQuantity=d.bo(i.ReceivedNetQuantity)),null!==i.RationPending&&"TRUE"===i.RationPending.toString().toUpperCase()&&(t=!0,s.RationPending=!0),s.IsInvalid=i.IsInvalid,e.push(s)})),null!==e&&e.length>0&&(t?this.UpdatePipelineRationedQuantities(e):this.MarkInvalidPipelineRecords(e))}catch(e){console.log("PipelineDispatchDetailsComposite : Error in forming Submit request",e)}}UpdatePipelineRationedQuantities(e){try{var t=[{key:x.Cg,value:this.state.pipelineDispatch.PipelineDispatchCode}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:x.Cg,KeyCodes:t,Entity:e},s={messageType:"critical",message:"PipelineTransaction_SavedMessage",messageResultDetails:[{keyFields:["PipelineDispatch_DispatchCode"],keyValues:[this.state.pipelineDispatch.PipelineDispatchCode],isSuccess:!1,errorMessage:""}]};g()(S.b1w,d.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;if(s.messageType=t.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess)this.getPipelineDispatch({Common_Code:this.state.pipelineDispatch.PipelineDispatchCode});else{s.messageResultDetails[0].errorMessage=t.ErrorList[0];let e=this.getDispatchUpdateStates();this.setState({saveEnabled:e.indexOf(this.state.pipelineDispatch.PipelineDispatchStatus)>-1&&d.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.modify,f.dK)}),console.log("Error in  Update rationed quantities:",t.ErrorList)}this.props.onSaved(this.state.pipelineDispatch,"add",s)})).catch((e=>{let t=this.getDispatchUpdateStates();this.setState({saveEnabled:t.indexOf(this.state.pipelineDispatch.PipelineDispatchStatus)>-1&&d.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.modify,f.dK)}),s.messageResultDetails[0].errorMessage=e,this.props.onSaved(this.state.pipelineDispatch,"add",s)}))}catch(a){console.log("PipelineDispatchDetailsComposite : Error in UpdatePipelineRationedQuantities",a)}}MarkInvalidPipelineRecords(e){try{var t=[{key:x.Cg,value:this.state.pipelineDispatch.PipelineDispatchCode}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:x.Cg,KeyCodes:t,Entity:e},s={messageType:"critical",message:"PipelineTransaction_SavedMessage",messageResultDetails:[{keyFields:["PipelineDispatch_DispatchCode"],keyValues:[this.state.pipelineDispatch.PipelineDispatchCode],isSuccess:!1,errorMessage:""}]};g()(S.V8x,d.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;if(s.messageType=t.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess)this.getPipelineDispatch({Common_Code:this.state.pipelineDispatch.PipelineDispatchCode});else{s.messageResultDetails[0].errorMessage=t.ErrorList[0];let e=this.getDispatchUpdateStates();this.setState({saveEnabled:e.indexOf(this.state.pipelineDispatch.PipelineDispatchStatus)>-1&&d.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.modify,f.dK)}),console.log("Error in  Update invalid records:",t.ErrorList)}this.props.onSaved(this.state.pipelineDispatch,"add",s)})).catch((e=>{let t=this.getDispatchUpdateStates();this.setState({saveEnabled:t.indexOf(this.state.pipelineDispatch.PipelineDispatchStatus)>-1&&d.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.modify,f.dK)}),s.messageResultDetails[0].errorMessage=e,this.props.onSaved(this.state.pipelineDispatch,"add",s)}))}catch(a){console.log("PipelineDispatchDetailsComposite : Error in MarkInvalidPipelineRecords",a)}}fillDetails(){let{modPipelineDispatch:e}={...this.state};try{null!==e.Quantity&&""!==e.Quantity&&(e.Quantity=d.bo(e.Quantity));let t=H()(new Date(e.ScheduledStartTime)).set("second",0).set("millisecond",0).toDate();e.ScheduledStartTime=t.toLocaleDateString()+" "+t.toLocaleTimeString(),e.ShareholderCode=this.props.selectedShareholder;let i=[];Array.isArray(e.PipelineDispatchTanks)&&e.PipelineDispatchTanks.forEach((t=>{(null!==t.TankCode&&""!==t.TankCode||null!==t.Quantity&&""!==t.Quantity)&&(t.PipelineDispatchCode=e.PipelineDispatchCode,t.QuantityUOM=e.QuantityUOM,t.Quantity=d.bo(t.Quantity),t.PlannedStartTime=null===t.PlannedStartTime?e.ScheduledStartTime:t.PlannedStartTime,t.PlannedEndTime=null===t.PlannedEndTime?e.ScheduledEndTime:t.PlannedEndTime,i.push(t))})),e.PipelineDispatchTanks=i,e.PipelineDispatchTankInfo=i}catch(t){console.log("Error in fillDetails",t)}return e}validateSave(e,t){try{var i=R().cloneDeep(this.state.validationErrors);Object.keys(m.xS).forEach((function(t){void 0!==e[t]&&(i[t]=d.jr(m.xS[t],e[t]))})),this.props.userDetails.EntityResult.IsEnterpriseNode&&null!==e.TerminalCodes&&0===e.TerminalCodes.length&&(i.TerminalCodes="Terminal_reqTerCode"),!this.state.isMeterRequired||""!==e.PipelineHeaderMeterCode&&null!==e.PipelineHeaderMeterCode&&void 0!==e.PipelineHeaderMeterCode||(i.PipelineHeaderMeterCode="PipelineReceiptDetails_MandatoryHeaderMeterCode");let n={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[]};if(Array.isArray(e.PipelineDispatchTanks)&&e.PipelineDispatchTanks.length>0){let t=[],i=0;e.PipelineDispatchTanks.forEach((s=>{t.includes(s.TankCode)?n.messageResultDetails.push({keyFields:["PipelineDispatch_DispatchCode","PipelineDispatch_TankCode"],keyValues:[e.PipelineDispatchCode,s.TankCode],isSuccess:!1,errorMessage:"PIPELINEDISPATCH_TANKINFO_DUPLICATE"}):t.push(s.TankCode),A.Ix.forEach((t=>{let i="";void 0!==t.validator&&(i=d.jr(t.validator,s[t.field])),""!==i&&n.messageResultDetails.push({keyFields:["PipelineDispatch_DispatchCode",t.displayName],keyValues:[e.PipelineDispatchCode,s[t.field]],isSuccess:!1,errorMessage:i})})),i+=s.Quantity})),i!==e.Quantity&&n.messageResultDetails.push({keyFields:["PipelineDispatch_DispatchCode","PipelineDispatch_ExpectedQuantity"],keyValues:[e.PipelineDispatchCode,e.Quantity],isSuccess:!1,errorMessage:"PIPELINE_TANKPLAN_QUANTITY_INVALID_X"})}else this.state.isTankRequired&&n.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"ERRMSG_PIPELINE_CUSTODYREFERENCE_TANKINFO_EMPTY"});var s=R().cloneDeep(this.state.attributeValidationErrors);t.forEach((e=>{s.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.attributeMetaDataList.forEach((e=>{t.attributeValidationErrors[e.Code]=d.I5(e,e.DefaultValue)}))}))})),this.setState({validationErrors:i,attributeValidationErrors:s});var a=!0;return s.forEach((e=>{if(!a)return a;a=Object.values(e.attributeValidationErrors).every((function(e){return""===e}))})),a&&(a=Object.values(i).every((function(e){return""===e}))),a&&n.messageResultDetails.length>0?(this.props.onSaved(e,"update",n),!1):a}catch(n){return console.log("Error in Validate save",n),!1}}createPipelineDispatch(e){this.handleAuthenticationClose();try{var t=[{key:x.Cg,value:e.PipelineDispatchCode}],i={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:x.Cg,KeyCodes:t,Entity:e},s={messageType:"critical",message:"PipelineShipmentCompDetail_SavedSuccess",messageResultDetails:[{keyFields:["PipelineDispatch_DispatchCode"],keyValues:[e.PipelineDispatchCode],isSuccess:!1,errorMessage:""}]};g()(S.PFX,d.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{var i=t.data;if(s.messageType=i.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess)this.getPipelineDispatch({Common_Code:e.PipelineDispatchCode});else{s.messageResultDetails[0].errorMessage=i.ErrorList[0];let e=this.getDispatchUpdateStates();this.setState({saveEnabled:e.indexOf(this.state.pipelineDispatch.PipelineDispatchStatus)>-1&&d.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.modify,f.dK)}),console.log("Error in CreatePipelineDispatch:",i.ErrorList)}this.props.onSaved(e,"add",s)})).catch((t=>{let i=this.getDispatchUpdateStates();this.setState({saveEnabled:i.indexOf(this.state.pipelineDispatch.PipelineDispatchStatus)>-1&&d.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.modify,f.dK)}),s.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"add",s)}))}catch(a){console.log("Error in Pipeline Create",a)}}updatePipelineDispatch(e){this.handleAuthenticationClose();try{var t=[{key:x.Cg,value:e.PipelineDispatchCode}],i={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:x.Cg,KeyCodes:t,Entity:e},s={messageType:"critical",message:"PipelineShipmentCompDetail_SavedSuccess",messageResultDetails:[{keyFields:["PipelineDispatch_DispatchCode"],keyValues:[e.PipelineDispatchCode],isSuccess:!1,errorMessage:""}]};g()(S.qU6,d.tW(i,this.props.tokenDetails.tokenInfo)).then((t=>{var i=t.data;if(s.messageType=i.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess)this.getPipelineDispatch({Common_Code:e.PipelineDispatchCode});else{s.messageResultDetails[0].errorMessage=i.ErrorList[0];let e=this.getDispatchUpdateStates();this.setState({saveEnabled:e.indexOf(this.state.pipelineDispatch.PipelineDispatchStatus)>-1&&d.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.modify,f.dK)}),console.log("Error in updatePipelineDispatch:",i.ErrorList)}this.props.onSaved(e,"update",s)})).catch((t=>{let i=this.getDispatchUpdateStates();this.setState({saveEnabled:i.indexOf(this.state.pipelineDispatch.PipelineDispatchStatus)>-1&&d.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.modify,f.dK)}),s.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"modify",s)}))}catch(a){console.log("Error in Pipeline Update",a)}}handleResetAttributeValidationError(){try{var e=R().cloneDeep(this.state.attributeMetaDataList);this.setState({attributeValidationErrors:d.Fl(e)})}catch(t){console.log("handleAttributeValidationError:Error occured on handleReset",t)}}getPipelineMeter(e,t){try{var i=[{key:x.pL,value:e},{key:x.uw,value:this.props.userDetails.EntityResult.IsEnterpriseNode?t:null}],s={keyDataCode:x.pL,KeyCodes:i};g()(S.WQk,d.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;let i=[],s=R().cloneDeep(this.state.modPipelineDispatch),a=R().cloneDeep(this.state.validationErrors);!0===t.IsSuccess&&null!==t.EntityResult&&null!==t.EntityResult.AssociatedMeterCodes&&Array.isArray(t.EntityResult.AssociatedMeterCodes)&&(i=t.EntityResult.AssociatedMeterCodes,this.state.isMeterRequired&&1===t.EntityResult.AssociatedMeterCodes.length&&""!==s.PipelineHeaderCode&&null!==s.PipelineHeaderCode&&void 0!==s.PipelineHeaderCode&&(s.PipelineHeaderMeterCode=t.EntityResult.AssociatedMeterCodes[0],a.PipelineHeaderMeterCode="")),this.setState({pipelineHeaderMeterOptions:i,validationErrors:a,modPipelineDispatch:s})})).catch((e=>{console.log("Error while getPipelineMeter:",e)}))}catch(a){console.log("Error while getPipelineMeter:",a)}}getTank(e){try{var t=this.props.userDetails.EntityResult.PrimaryShareholder;g()(S.eX4+"?ShareholderCode="+t,d.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var i=t.data;if(!0===i.IsSuccess){var s=[],a=i.EntityResult.Table;if(null!==a&&Array.isArray(a))if(this.props.userDetails.EntityResult.IsEnterpriseNode){a=a.filter((t=>t.TerminalCode===e));for(let e=0;e<a.length;e++)s.push(a[e].Common_Code)}else for(let e=0;e<a.length;e++)s.push(a[e].Common_Code);if(null!==s&&Array.isArray(s)){let e=d.Zj(s);this.setState({tankOptions:e})}}else console.log("Error in getTankList:",i.ErrorList)})).catch((e=>{console.log("Error in getTankList:",e)}))}catch(i){}}getKPIList(e,t){if(!0===d.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.view,f.bL)){let i={PageName:w.Ux,TransportationType:T.LY.PIPELINE,InputParameters:[{key:"ShareholderCode",value:e},{key:"ShipmentCode",value:t}]};g()(S.dxq,d.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({pipelineDispatchKPIList:t.EntityResult.ListKPIDetails}):(this.setState({pipelineDispatchKPIList:[]}),console.log("Error in pipeline KPIList:",t.ErrorList))})).catch((e=>{console.log("Error while getting PipelineDispatch KPIList:",e)}))}}render(){const e={quantityUOM:this.state.quantityUOMOptions,pipelineHeaderOptions:this.state.pipelineHeaderOptions,pipelineHeaderMeterOptions:this.state.pipelineHeaderMeterOptions,tankCodeOptions:this.state.tankOptions,terminalCodes:this.props.terminalCodes,customerOptions:this.state.customerOptions,destinationOptions:this.state.destinationOptions,finishedProductOptions:this.state.finishedProductOptions},t=[{fieldName:"PipelineDispatch_LastUpdatedTime",fieldValue:new Date(this.state.modPipelineDispatch.LastUpdatedTime).toLocaleDateString()+" "+new Date(this.state.modPipelineDispatch.LastUpdatedTime).toLocaleTimeString()},{fieldName:"PipelineDispatch_CreatedTime",fieldValue:new Date(this.state.modPipelineDispatch.CreatedTime).toLocaleDateString()+" "+new Date(this.state.modPipelineDispatch.CreatedTime).toLocaleTimeString()},{fieldName:"PipelineDispatch_LastUpdatedBy",fieldValue:this.state.modPipelineDispatch.LastUpdatedBy}];return this.state.isReadyToRender?(0,p.jsxs)("div",{children:[(0,p.jsx)(l.TranslationConsumer,{children:e=>(0,p.jsx)(r.A,{children:(0,p.jsx)(b.A,{entityCode:this.state.isManualEntry?this.state.pipelineDispatch.PipelineDispatchCode+" - "+e("LoadingDetailsEntry_Title"):this.state.pipelineDispatch.PipelineDispatchCode,newEntityName:"PipelineDispatch_NewDispatch",popUpContents:t})})}),this.state.isManualEntry?(0,p.jsx)("div",{children:(0,p.jsx)(r.A,{children:(0,p.jsx)(M.default,{pipelineDispatch:this.state.modPipelineDispatch,handleBack:this.onBack,selectedShareholder:this.props.selectedShareholder,UOMS:this.state.UOMS,isMeterRequired:this.state.isMeterRequired,isTankRequired:this.state.isTankRequired,pipelineHeaderMeterOptions:this.state.pipelineHeaderMeterOptions})})}):this.state.isViewAuditTrail?(0,p.jsx)(r.A,{children:(0,p.jsx)(_.z,{DispatchCode:this.state.pipelineDispatch.PipelineDispatchCode,auditTrailList:this.state.auditTrailList,modAuditTrailList:this.state.modAuditTrailList,Attributes:void 0!==this.state.auditTrailList&&this.state.auditTrailList.length>0?this.state.auditTrailList[0].AttributesforUI:[],handleBack:this.onBack})}):(0,p.jsxs)("div",{children:[(0,p.jsx)(O.A,{KPIList:this.state.pipelineDispatchKPIList,children:" "}),(0,p.jsxs)("div",{className:""!==this.state.pipelineDispatch.PipelineDispatchCode?this.state.drawerStatus?"drawerClose":"showShipmentStatusRightPane":"",children:[(0,p.jsx)(r.A,{children:(0,p.jsx)(h,{pipelineDispatch:this.state.pipelineDispatch,modPipelineDispatch:this.state.modPipelineDispatch,validationErrors:this.state.validationErrors,selectedCompRow:this.state.selectedCompRow,listOptions:e,onFieldChange:this.handleChange,handleRowSelectionChange:this.handleRowSelectionChange,handleCellDataEdit:this.handleCellDataEdit,handleAddCompartment:this.handleAddCompartment,handleDeleteCompartment:this.handleDeleteCompartment,handlePipelineHeaderChange:this.handlePipelineHeaderChange,isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,handleTerminalChange:this.handleTerminalChange,activeTab:this.state.activeTab,onTabChange:this.handleTabChange,loadingDetailsTab:""!==this.state.pipelineDispatch.PipelineDispatchCode&&void 0!==this.state.loadingDetails&&null!==this.state.loadingDetails?[""]:[],modAttributeMetaDataList:this.state.modAttributeMetaDataList,attributeValidationErrors:this.state.attributeValidationErrors,onAttributeDataChange:this.handleAttributeDataChange,loadingDetails:this.state.loadingDetails,isMeterRequired:this.state.isMeterRequired,isTankRequired:this.state.isTankRequired,pipelineSnapShotInfo:this.state.pipelineSnapShotInfo,handleCellCheck:this.handleCellCheck,onDateTextChange:this.handleDateTextChange})}),(0,p.jsx)(r.A,{children:(0,p.jsx)(u.q,{handleBack:this.props.onBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.saveEnabled})}),this.state.showAuthenticationLayout?(0,p.jsx)(V.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:""===this.state.pipelineDispatch.PipelineDispatchCode?f.i.add:f.i.modify,functionGroup:f.dK,handleOperation:this.addUpdatePipelineDispatch,handleClose:this.handleAuthenticationClose}):null]}),""!==this.state.pipelineDispatch.PipelineDispatchCode?(0,p.jsx)("div",{className:this.state.drawerStatus?"marineStatusLeftPane":"",children:(0,p.jsx)(I.A,{title:"ViewAllPipeline_Details",selectedItem:[{Common_Code:this.state.pipelineDispatch.PipelineDispatchCode}],shipmentNextOperations:this.state.shipmentNextOperations,handleOperationButtonClick:this.handleOperationClick,currentStatuses:this.state.currentDispatchStatus,unAllowedOperations:["Authorize_ManualEntry_Update","Authorize_Scada_Update","PipelineDispatch_BtnManualEntry","PipelineDispatch_BtnClosed","PipelineDispatch_BtnSubmit"],webPortalAllowedOperations:["PipelineDispatchList_btnViewTransactionReport","PipelineDispatch_BtnAuditTrail"],isDetails:!0,isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,isWebPortalUser:this.props.userDetails.EntityResult.IsWebPortalUser,handleDrawer:this.handleDrawer})}):""]}),this.state.commentsPopUp?this.handleCommentsModal():null]}):(0,p.jsx)(k.A,{message:"Loading"})}}const F=(0,y.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})),(e=>({userActions:(0,E.zH)(P,e)})))(Q)},87770:(e,t,i)=>{i.d(t,{z:()=>h});var s=i(65043),a=i(67907),n=i(72711),l=i(69062),o=i(78374),r=i(45127),c=i(728),d=i(7523),p=i(70579);function h(e){let{DispatchCode:t,auditTrailList:i,handleBack:c,modAuditTrailList:h,Attributes:u}=e;const[m,D]=(0,s.useState)(!1),C=e=>{const t=e.rowData.AttributesforUI.filter((t=>t.AttributeName===e.name))[0];return t.DataType.toLowerCase()===d.pe.STRING.toLowerCase()||t.DataType.toLowerCase()===d.pe.INT.toLowerCase()||t.DataType.toLowerCase()===d.pe.LONG.toLowerCase()||t.DataType.toLowerCase()===d.pe.FLOAT.toLowerCase()?(0,p.jsx)("label",{children:t.AttributeValue}):t.DataType.toLowerCase()===d.pe.BOOL.toLowerCase()?(0,p.jsx)(n.Checkbox,{checked:"true"===t.AttributeValue.toString().toLowerCase(),disabled:!0}):(0,p.jsx)("label",{children:new Date(t.AttributeValue).toLocaleDateString()})},g=e=>(0,p.jsx)(a.TranslationConsumer,{children:t=>(0,p.jsx)("label",{children:t(e.rowData.PipelineDispatchStatus)})}),S=(e,t)=>{try{t.cls=null,e.fontSize="10px",t.text=(0,l.cd)(d.xx,t.val)}catch(i){console.log("Error in formatter",i)}return t};return(0,p.jsxs)("div",{children:[(0,p.jsx)(a.TranslationConsumer,{children:e=>(0,p.jsx)("div",{children:(0,p.jsxs)("div",{className:"detailsContainer",children:[(0,p.jsxs)("div",{id:"printTable",children:[(0,p.jsx)("div",{className:"row",children:(0,p.jsx)("div",{className:"col-12",children:(0,p.jsx)("h3",{children:e("Transaction_AuditTrail_Heading")+" : "+t})})}),(0,p.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,p.jsx)("div",{className:"col-12 container-fluid",children:(0,p.jsxs)(r.IO,{itemsSource:h,chartType:"Line",bindingX:"UpdatedTime",palette:["red"],style:{width:"100%",minWidth:"1000px",height:"550px"},plotMargin:"50 10 120 150 ",children:[(0,p.jsx)(r.tN,{position:"Bottom"}),(0,p.jsx)(r.vc,{wjProperty:"axisY",majorUnit:1,max:9,min:0,itemFormatter:S,axisLine:!0}),(0,p.jsx)(r.t3,{binding:"PipelineDispatchStatus",name:e("PipelineDispatch_DispatchStatus")})]})})}),(0,p.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(o.bQ,{data:i,scrollable:!0,children:[(0,p.jsx)(o.bQ.Column,{className:"compColHeight colminWidth",field:"PipelineDispatchStatus",header:e("PipelineDispatch_DispatchStatus"),editable:!1,editFieldType:"text",renderer:e=>g(e)},"PipelineDispatchStatus"),(0,p.jsx)(o.bQ.Column,{className:"compColHeight colminWidth",field:"UpdatedTime",header:e("ViewAuditTrail_UpdatedTime"),editable:!1,editFieldType:"text"},"UpdatedTime"),u.map((t=>(0,p.jsx)(o.bQ.Column,{className:"compColHeight colminWidth",header:e(t.AttributeName),editable:!1,renderer:C})))]})})})]}),(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col-12 col-sm-6 col-lg-8",children:(0,p.jsx)(n.Button,{className:"backButton",onClick:c,content:e("Back")})}),(0,p.jsx)("div",{className:"col-12 col-sm-6 col-lg-4",style:{textAlign:"right"},children:(0,p.jsx)(n.Button,{className:"printButton",onClick:()=>{D(!0)},content:e("ViewAuditTrail_PrintAuditTrail")})})]})]})})}),(0,p.jsx)(a.TranslationConsumer,{children:e=>(0,p.jsx)(n.Modal,{open:m,className:"marineModalPrint",children:(0,p.jsxs)(n.Modal.Content,{children:[(0,p.jsxs)("div",{style:{display:"flex",flexWrap:"wrap"},children:[(0,p.jsx)("div",{className:"col col-lg-8",children:(0,p.jsx)("h3",{children:e("Transaction_AuditTrail_Heading")+" : "+t})}),(0,p.jsx)("div",{className:"col col-lg-4",style:{textAlign:"right"},children:(0,p.jsx)("div",{onClick:()=>{D(!1)},children:(0,p.jsx)(n.Icon,{root:"common",name:"close"})})})]}),(0,p.jsx)("div",{className:"col-md-10 container-fluid",children:(0,p.jsxs)(r.IO,{itemsSource:h,chartType:"Line",bindingX:"UpdatedTime",palette:["blue"],style:{width:"100%",height:"550px"},plotMargin:"50 0 100 150 ",children:[(0,p.jsx)(r.tN,{position:"Bottom"}),(0,p.jsx)(r.vc,{wjProperty:"axisY",majorUnit:1,max:9,min:0,itemFormatter:S,axisLine:!0}),(0,p.jsx)(r.t3,{binding:"PipelineDispatchStatus",name:e("PipelineDispatch_DispatchStatus")})]})}),(0,p.jsx)("div",{className:"col-12 detailsTable",children:(0,p.jsxs)(o.bQ,{data:i,children:[(0,p.jsx)(o.bQ.Column,{className:"compColHeight",field:"PipelineDispatchStatus",header:e("PipelineDispatch_DispatchStatus"),editable:!1,editFieldType:"text",renderer:e=>g(e)},"PipelineDispatchStatus"),(0,p.jsx)(o.bQ.Column,{className:"compColHeight",field:"UpdatedTime",header:e("ViewAuditTrail_UpdatedTime"),editable:!1,editFieldType:"text"},"UpdatedTime"),u.map((t=>(0,p.jsx)(o.bQ.Column,{className:"compColHeight",header:e(t.AttributeName),editable:!1,renderer:C})))]})}),(0,p.jsxs)(n.Modal.Footer,{children:[(0,p.jsx)(n.Button,{type:"primary",size:"small",content:e("ViewAuditTrail_Print"),onClick:()=>{let e=window.document.getElementById("printTable").innerHTML;const t=window.document.createElement("IFRAME");let i=null;window.document.body.appendChild(t),i=t.contentWindow.document;const s=e.substring(0,e.indexOf("<table")+6),a=e.substring(e.indexOf("<table")+6,e.length);e=s+' border="1" cellspacing="1"'+a,i.write(e),i.close(),t.contentWindow.focus(),t.contentWindow.print(),setTimeout((()=>{window.document.body.removeChild(t)}),2e3)}}),(0,p.jsx)(n.Button,{type:"primary",size:"small",content:e("MarineEOD_Close"),onClick:()=>{D(!1)}})]})]})})})]})}c.setLicenseKey(d.yQ),h.defaultProps={}}}]);
//# sourceMappingURL=3672.a249a2f5.chunk.js.map