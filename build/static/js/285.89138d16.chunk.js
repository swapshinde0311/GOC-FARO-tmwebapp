"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[285],{62672:(e,t,i)=>{i.r(t),i.d(t,{AllowDragging:()=>he,AllowMerging:()=>V,AllowPinning:()=>I,AllowResizing:()=>le,AllowSorting:()=>P,AutoSizeMode:()=>ae,CellEditEndingEventArgs:()=>E,CellFactory:()=>X,CellRange:()=>m,CellRangeEventArgs:()=>C,CellType:()=>_,ClipStringOptions:()=>T,Column:()=>j,ColumnCollection:()=>A,ColumnGroup:()=>B,ColumnGroupCollection:()=>F,DataMap:()=>g,DataMapEditor:()=>o,FlexGrid:()=>N,FormatItemEventArgs:()=>x,GridPanel:()=>w,GroupRow:()=>M,HeadersVisibility:()=>R,HitTestInfo:()=>U,KeyAction:()=>oe,MergeManager:()=>q,Row:()=>k,RowCol:()=>H,RowColCollection:()=>O,RowColFlags:()=>S,RowCollection:()=>L,SelMove:()=>y,SelectedState:()=>b,SelectionMode:()=>v,_AddNewHandler:()=>G,_ColumnGroupHandler:()=>z,_CustomEditor:()=>se,_EditHandler:()=>re,_ImeHandler:()=>K,_KeyboardHandler:()=>ce,_MouseHandler:()=>pe,_NewRowTemplate:()=>W,_SelectionHandler:()=>D,_getSafariVer:()=>u,softInput:()=>Y});var n,o,r,s=i(728),l=i(38074),a=i(62672),h=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),c=null;function u(){return c}if((0,s.isSafari)()){var d=navigator.userAgent.match(/version\/([\d\.]+)/i);if(null!=d){var p=d[1],f=(d=p.match(/(\d+)/g)).map((function(e){return parseInt(e)}));c={full:p,major:f[0],minor:f[1]}}}(r=o||(o={}))[r.AutoComplete=0]="AutoComplete",r[r.DropDownList=1]="DropDownList",r[r.RadioButtons=2]="RadioButtons";var _,g=function(){function e(e,t,i){this._keyPath="",this._displayPath="",this._sortByVal=!0,this._editable=!1,this._serK=!0,this.mapChanged=new s.Event,!(0,s.isArray)(e)||t||i||(e=e.map((function(e){return{value:e}})),t=i="value"),this._cv=(0,s.asCollectionView)(e),this._keyPath=(0,s.asString)(t,!1),this._displayPath=(0,s.asString)(i,!1),this._cv.collectionChanged.addHandler(this.onMapChanged,this)}return Object.defineProperty(e.prototype,"sortByDisplayValues",{get:function(){return this._sortByVal},set:function(e){this._sortByVal=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serializeKeys",{get:function(){return this._serK},set:function(e){if((e=(0,s.asBoolean)(e))!==this._serK){var t=this._map,i=t&&t.size;this._map=null,this._serK=e,i&&this.onMapChanged(s.EventArgs.empty)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedValuePath",{get:function(){return this._keyPath},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayMemberPath",{get:function(){return this._displayPath},enumerable:!0,configurable:!0}),e.prototype.getDataItem=function(e){var t=this;if(!this._map){var i=this._cv.sourceCollection,n=new s._Map(this.serializeKeys);(0,s.isArray)(i)&&this._keyPath&&i.forEach((function(e){var i=e[t._keyPath];n.has(i)||n.set(i,e)})),this._map=n}return this._map.get(e)},e.prototype.getDisplayValue=function(e){var t=this._displayPath,i=this.getDataItem(e);return t&&i?i[t]:e},e.prototype.getKeyValue=function(e,t){var i=this._displayPath,n=this._indexOf(e,i,t,!0);return n<0&&(n=this._indexOf(e,i,t,!1)),n>-1?this._cv.sourceCollection[n][this._keyPath]:null},e.prototype.getDisplayValues=function(e){var t=this;return this._cv&&this._displayPath?this._cv.items.map((function(e){return e[t._displayPath]})):[]},e.prototype.getKeyValues=function(){var e=this;return this._cv&&this._keyPath?this._cv.items.map((function(t){return t[e._keyPath]})):[]},Object.defineProperty(e.prototype,"isEditable",{get:function(){return this._editable},set:function(e){this._editable=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"search",{get:function(){return this._search},set:function(e){this._search=(0,s.asFunction)(e)},enumerable:!0,configurable:!0}),e.prototype.onMapChanged=function(e){this._map=null,this.mapChanged.raise(this,e)},e.prototype._indexOf=function(e,t,i,n){var o=-1,r=-1;if(this._cv&&t){var l=null!=e?e.toString():"";l&&i&&(e=(0,s.toPlainText)(l));for(var a=n?l:l.toLowerCase(),h=this._cv.sourceCollection,c=0;c<h.length;c++){var u=h[c],d=u[t];if(i&&(0,s.isString)(d)&&(d=(0,s.toPlainText)(d)),d==e?o=c:n||d.length!=a.length||d.toLowerCase()!=a?null!=d&&d.toString()==l&&(o=c):o=c,o==c){if(!this._cv.filter||this._cv.filter(u))return o;r<0&&(r=o)}}}return r},e}(),m=function(){function e(e,t,i,n){void 0===e&&(e=-1),void 0===t&&(t=-1),void 0===i&&(i=e),void 0===n&&(n=t),this.setRange(e,t,i,n)}return e.prototype.setRange=function(e,t,i,n){void 0===e&&(e=-1),void 0===t&&(t=-1),void 0===i&&(i=e),void 0===n&&(n=t),this._row=(0,s.asInt)(e),this._col=(0,s.asInt)(t),this._row2=(0,s.asInt)(i),this._col2=(0,s.asInt)(n)},Object.defineProperty(e.prototype,"row",{get:function(){return this._row},set:function(e){this._row=(0,s.asInt)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"col",{get:function(){return this._col},set:function(e){this._col=(0,s.asInt)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"row2",{get:function(){return this._row2},set:function(e){this._row2=(0,s.asInt)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"col2",{get:function(){return this._col2},set:function(e){this._col2=(0,s.asInt)(e)},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._row,this._col,this._row2,this._col2)},e.prototype.copy=function(e){this.setRange(e._row,e._col,e._row2,e._col2)},Object.defineProperty(e.prototype,"rowSpan",{get:function(){return Math.abs(this._row2-this._row)+1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnSpan",{get:function(){return Math.abs(this._col2-this._col)+1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRow",{get:function(){return Math.min(this._row,this._row2)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRow",{get:function(){return Math.max(this._row,this._row2)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftCol",{get:function(){return Math.min(this._col,this._col2)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightCol",{get:function(){return Math.max(this._col,this._col2)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isValid",{get:function(){return this._row>-1&&this._col>-1&&this._row2>-1&&this._col2>-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSingleCell",{get:function(){return this._row==this._row2&&this._col==this._col2},enumerable:!0,configurable:!0}),e.prototype.contains=function(t,i){var n=(0,s.tryCast)(t,e);if(n)return n.topRow>=this.topRow&&n.bottomRow<=this.bottomRow&&n.leftCol>=this.leftCol&&n.rightCol<=this.rightCol;if((0,s.isInt)(t)&&(0,s.isInt)(i))return t>=this.topRow&&t<=this.bottomRow&&i>=this.leftCol&&i<=this.rightCol;throw"contains expects a CellRange or row/column indices."},e.prototype.containsRow=function(e){return(0,s.asInt)(e)>=this.topRow&&e<=this.bottomRow},e.prototype.containsColumn=function(e){return(0,s.asInt)(e)>=this.leftCol&&e<=this.rightCol},e.prototype.intersects=function(e){return this.intersectsRow(e)&&this.intersectsColumn(e)},e.prototype.intersectsRow=function(e){return e&&!(this.bottomRow<e.topRow||this.topRow>e.bottomRow)},e.prototype.intersectsColumn=function(e){return e&&!(this.rightCol<e.leftCol||this.leftCol>e.rightCol)},e.prototype.getRenderSize=function(e){var t=new s.Size(0,0);if(this.isValid){for(var i=this.topRow;i<=this.bottomRow;i++)t.height+=e.rows[i].renderSize;for(var n=this.leftCol;n<=this.rightCol;n++)t.width+=e.columns[n].renderSize}return t},e.prototype.equals=function(t){return t instanceof e&&this._row==t._row&&this._col==t._col&&this._row2==t._row2&&this._col2==t._col2},e.prototype.combine=function(t){return t?new e(Math.min(this.topRow,t.topRow),Math.min(this.leftCol,t.leftCol),Math.max(this.bottomRow,t.bottomRow),Math.max(this.rightCol,t.rightCol)):this},e.prototype.toString=function(){return(0,s.format)("({row}, {col})-({row2}, {col2})",this)},e}();!function(e){e[e.None=0]="None",e[e.Cell=1]="Cell",e[e.ColumnHeader=2]="ColumnHeader",e[e.RowHeader=3]="RowHeader",e[e.TopLeft=4]="TopLeft",e[e.ColumnFooter=5]="ColumnFooter",e[e.BottomLeft=6]="BottomLeft"}(_||(_={}));var v,b,y,w=function(){function e(e,t,i,n,o){this._offsetY=0,this._rng=new m,this._g=(0,s.asType)(e,N),this._ct=(0,s.asInt)(t),this._rows=(0,s.asType)(i,L),this._cols=(0,s.asType)(n,A),this._e=(0,s.asType)(o,HTMLElement),this._vrb=new m}return Object.defineProperty(e.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellType",{get:function(){return this._ct},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewRange",{get:function(){return this._getViewRange()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._cols.getTotalSize()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._rows.getTotalSize()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return this._cols},enumerable:!0,configurable:!0}),e.prototype.getCellData=function(e,t,i){var n,o=this._g,r=this._rows[(0,s.asNumber)(e,!1,!0)],l=null;if(!r)return null;t=this._toIndex(t),n=this._cols[(0,s.asNumber)(t,!1,!0)];var a=o?o._getBindingColumn(this,e,n):n,h=null;if(r instanceof M&&r.dataItem instanceof s.CollectionViewGroup&&!o.childItemsPath&&(h=r.dataItem),a.binding&&r.dataItem&&!h?l=a._binding.getValue(r.dataItem):r._ubv&&(l=r._ubv[n._hash]),null==l){var c=_;switch(this._ct){case c.TopLeft:case c.ColumnHeader:e!=this._rows.length-1&&a==n||(l=a.header);break;case c.ColumnFooter:if(r instanceof M&&a.aggregate!=s.Aggregate.None){var u=this._g.collectionView;if(u){var d=(0,s.tryCast)(u,s.CollectionView);l=d?d.getAggregate(a.aggregate,a.binding):(0,s.getAggregate)(a.aggregate,u.items,a.binding)}}break;case c.Cell:r instanceof M&&(t==this._cols.firstVisibleIndex?l=r.getGroupHeader():h&&a.aggregate!=s.Aggregate.None&&(l=h.getAggregate(a.aggregate,a.binding,this._g.collectionView)))}}if(i){var p=a.dataMap||r.dataMap;this.cellType==_.Cell&&p&&(l=p.getDisplayValue(l)),l=null!=l?s.Globalize.format(l,a.format||r.format):""}return l},e.prototype.setCellData=function(e,t,i,n,o){void 0===n&&(n=!0),void 0===o&&(o=!0);var r=this._g,l=this._rows[(0,s.asNumber)(e,!1,!0)],a=this._cols[(0,s.asNumber)(this._toIndex(t),!1,!0)],h=s.DataType;if(!l)return!1;var c=r?r._getBindingColumn(this,e,a):a,u=c.dataMap||l.dataMap;if(this._ct==_.Cell){var d=c.getIsRequired(l),p=c.isContentHtml||l.isContentHtml;if(u&&null!=i){var f=u.getKeyValue(i,p);if(null==f&&null==u.getDisplayValue(null)){if(u.getDisplayValue(i)!=i);else if(!u.isEditable||u.displayMemberPath!=u.selectedValuePath){if(""!=i||d)return!1;i=null}}else i=f}var g=h.Object,m=c.dataType||l.dataType,v=this.getCellData(e,t,!1);if(g=m||(0,s.getType)(v),null==i||""===i&&n&&!u){if(d)return!1;g!=h.String&&(i=null),n=!1}if(n){var b=c.format||l.format;if(b||g!=h.Date||(b="d"),c.mask&&(0,s.isString)(i)&&g!=h.String&&(i=i.replace(/_/g,"")),i=(0,s.changeType)(i,g,b,v),g!=h.Object&&(0,s.getType)(i)!=g)return!1}}if(l.dataItem&&c.binding){var y=c._binding,w=l.dataItem,C=y.getValue(w);if(i!==C&&(u&&!u.serializeKeys||!s.DateTime.equals(i,C))){var x=r.collectionView,E=x instanceof s.CollectionView&&w!=x.currentEditItem&&x.trackChanges,S=null;if(E&&(S=x._extend({},w)),y.setValue(w,i),E){var D=new s.NotifyCollectionChangedEventArgs(s.NotifyCollectionChangedAction.Change,w,x.items.indexOf(w));x.onCollectionChanged(D),x._trackItemChanged(w,S)}}}else l._ubv||(l._ubv={}),l._ubv[a._hash]=i;return o&&r&&r.invalidate(),!0},e.prototype.getCellBoundingRect=function(e,t,i){var n=this._g,o=this.rows[e],r=this.columns[this._toIndex(t)],l=new s.Rect(r.pos,o.pos,r.renderSize,o.renderSize);if(n.rightToLeft&&(l.left=this.hostElement.clientWidth-l.right,(0,s.isIE)()||(l.left-=n._root.offsetWidth-n._root.clientWidth)),!i){var a=this.hostElement.getBoundingClientRect();l.left+=a.left,l.top+=a.top-this._offsetY}return e<this.rows.frozen&&(l.top-=n.scrollPosition.y),t<this.columns.frozen&&(l.left-=n.scrollPosition.x*(n.rightToLeft?-1:1)),l},e.prototype.getCellElement=function(t,i){var n=this.hostElement.children,o=Math.min(t+2,n.length);i=this._toIndex(i);for(var r=0;r<o;r++)for(var s=n[r].children,l=Math.min(i+2,s.length),a=0;a<l;a++){var h=s[a],c=h[e._INDEX_KEY];if(c&&(c.row==t&&c.col==i||c.rng&&c.rng.contains(t,i)))return h}return null},e.prototype.getSelectedState=function(e,t,i){var n=this._g,o=n.selectionMode,r=n._selHdl.selection,s=v,l=b;if(o==s.None)return l.None;switch(t=this._toIndex(t),this._ct){case _.Cell:if(i||(i=n.getMergedRange(this,e,t)),i){if(i.contains(r.row,r.col))return n.showMarquee?l.Active:l.Cursor;if(i.intersects(r)&&o!=s.ListBox)return l.Selected;for(var a=i.leftCol;a<=i.rightCol;a++)if(n.columns[a].isSelected)return l.Selected;for(var h=i.topRow;h<=i.bottomRow;h++)if(n.rows[h].isSelected)return l.Selected}if(r.row==e&&r.col==t)return n.showMarquee?l.Active:l.Cursor;if(n.rows[e].isSelected||n.columns[t].isSelected)return l.Selected;if(o==s.MultiRange)for(var c=n._selHdl.extendedSelection,u=0;u<c.length;u++)if(c[u].contains(e,t)||i&&i.intersects(c[u]))return l.Selected;if(i)switch(o){case s.Row:case s.RowRange:if(i.containsRow(r.row))return l.Selected}return o==s.ListBox?l.None:(r=this._getAdjustedSelection(r)).containsRow(e)&&r.containsColumn(t)?l.Selected:l.None;case _.ColumnHeader:if(n.showSelectedHeaders&R.Column&&(n.columns[t].isSelected||r.containsColumn(t)||r.intersectsColumn(i))&&(i&&(e=i.bottomRow),e==this.rows.length-1))return l.Selected;break;case _.RowHeader:if(n.showSelectedHeaders&R.Row&&(n.rows[e].isSelected||r.containsRow(e)||r.intersectsRow(i))&&(i&&(t=i.rightCol),t==this.columns.length-1))return l.Selected}return l.None},Object.defineProperty(e.prototype,"hostElement",{get:function(){return this._e},enumerable:!0,configurable:!0}),e.prototype._toIndex=function(e){if((0,s.isString)(e)&&(e=this._cols.indexOf(e))<0)throw"Invalid column name or binding.";return e},e.prototype._getAdjustedSelection=function(e){var t=this._g,i=this._rng,n=v;switch(t.selectionMode){case n.Cell:i.setRange(e.row,e.col,e.row,e.col);break;case n.Row:i.setRange(e.row,0,e.row,t.columns.length-1);break;case n.RowRange:case n.ListBox:i.setRange(e.row,0,e.row2,t.columns.length-1);break;default:i.copy(e)}return i},e.prototype._getOffsetY=function(){return this._offsetY},e.prototype._updateContent=function(e,t,i){var n=this._g,o=this._e,r=this._rows,l=this._cols,a=this._ct;if(a==_.ColumnHeader||a==_.ColumnFooter||a==_.RowHeader){var h=n._ptScrl,c=o.style;a==_.RowHeader?c.top=h.y+"px":n.rightToLeft?c.right=h.x+"px":c.left=h.x+"px"}this._offsetY!=i&&(e=!1,this._offsetY=i);var u=this._getViewRange(),d=u;if(d.isValid){var p=r.length<=n._vtRows?r.length:0,f=l.length<=n._vtCols?l.length:0;d=new m(Math.max(u.row-p,r.frozen),Math.max(u.col-f,l.frozen),Math.min(u.row2+p,r.length-1),Math.min(u.col2+f,l.length-1))}if(e&&!t&&this._vrb.contains(u)&&!r.frozen&&!l.frozen)return this._activeCell;e&&d.equals(this._vrb)||(t=!1),e&&!t&&this._ct!=_.TopLeft&&this._reorderCells(d,this._vrb),this._activeCell=null,this._vru=u,this._vrb=d,this._recycle=e;var g=0;this._ct==_.Cell&&(g=this._renderColHdrRow(d,t));for(var v=0;v<r.frozen&&v<r.length;v++)g=this._renderRow(v,d,t,g);for(v=d.topRow;v<=d.bottomRow&&v>-1;v++)g=this._renderRow(v,d,t,g);for(;o.childElementCount>g;){var b=o.lastElementChild;(0,s.removeChild)(b),this._removeExtraCells(b,0)}return this._activeCell},e.prototype._clearCells=function(){for(var e=this.hostElement,t=this._g.cellFactory,i=e.childElementCount-1;i>=0;i--){var n=e.children[i];(0,s.removeChild)(n);for(var o=n.childElementCount-1;o>=0;o--)t.disposeCell(n.children[o])}},e.prototype._reorderCells=function(e,t){var i=this;if(this._g._reorderCells&&t.isValid&&e.isValid&&e.intersects(t)){var n,o=function(e,t,n,o,r,l){(0,s.assert)(n<0,"Scroll delta must be a negative number");var a,h,c=-n,u=t+(o-r+1),d=e.childElementCount-u;if(d<c?(a=d,h=c-d):(a=c,h=0),a>0){var p=i._createRange(e,u,u+a);p&&e.insertBefore(p.extractContents(),e.children[t])}if(h>0)for(var f=e.children[t],_=0;_<h;_++){var g=document.createElement("div");g.className=l,e.insertBefore(g,f)}};if(e.row!=t.row){var r=this._e;if(0!=(n=e.row-t.row)){var l=this._ct==_.Cell?1:0,a=r.childElementCount;if(l+=this.rows.frozen,n>0){var h=l,c=Math.min(l+n,a);(p=this._createRange(r,h,c))&&r.appendChild(p.extractContents())}else o(r,l,n,e.row2,t.row,"wj-row")}}if(e.col!=t.col)if(r=this._e,0!=(n=e.col-t.col)){l=this._ct==_.Cell&&this._g.rowHeaderPath?1:0,l+=this.columns.frozen;for(var u=0;u<r.children.length;u++){var d=r.children[u];if(a=d.children.length,(0,s.hasClass)(d,"wj-row"))if(n>0){var p;h=l,c=Math.min(l+n,a),(p=this._createRange(d,h,c))&&d.appendChild(p.extractContents())}else o(d,l,n,e.col2,t.col,"wj-cell")}}}},e.prototype._createRange=function(e,t,i){if(i>t&&i<=e.children.length&&t>-1){this._docRange||(this._docRange=document.createRange());var n=this._docRange;return n.setStart(e,t),n.setEnd(e,i),n}return null},e.prototype._renderColHdrRow=function(e,t){if(t)return 1;var i=this._e.children[0];i||(i=(0,s.createElement)('<div class="wj-row" role="row"></div>',this._e));var n=this._g,o=n?n.columnHeaders.rows.ariaLabel:null;(0,s.setAttribute)(i,"aria-label",o),(0,s.setAttribute)(i,"aria-selected",null);var r=0,l=this._g._getRowHeaderPath();l&&(r=this._renderRowHdrCell(i,-1,l.path));for(var a=0;a<this.columns.frozen&&a<this.columns.length;a++)r=this._renderColHdrCell(i,a,e,t,r);for(a=e.leftCol;a<=e.rightCol&&a>-1;a++)r=this._renderColHdrCell(i,a,e,t,r);return this._removeExtraCells(i,r),1},e.prototype._renderColHdrCell=function(t,i,n,o,r){var l=this.grid,a=this.columns[i];if(a.renderSize<=0)return r;if(o)return r+1;var h=t.children[r];if(h||(h=(0,s.createElement)(e._HTML_CELL,t)),(0,s.setAttribute)(h,"role","columnheader"),h&&this._recycle&&l._lazyRender){var c=h[e._INDEX_KEY];if(c&&-1==c.row&&c.col==i&&i>=this.columns.frozen)return r+1}if(h.textContent=this.columns[i].header,(0,s.setCss)(h,{position:"fixed",left:a.pos,top:-32e3,width:a.renderSize,height:.1,overflow:"hidden",opacity:"0",pointerEvents:"none"}),a.describedById||this.columns.describedById){var u=[a.describedById,this.columns.describedById].join(" ").trim();(0,s.setAttribute)(h,"aria-describedby",u||null)}if(l.allowSorting){var d="none";switch(l._getBindingColumn(this,0,a).currentSort){case"+":d="ascending";break;case"-":d="descending"}(0,s.setAttribute)(h,"aria-sort",d)}return l.isReadOnly||((0,s.setAttribute)(h,"aria-readonly",a.isReadOnly),(0,s.setAttribute)(h,"aria-required",a.getIsRequired())),h[e._INDEX_KEY]={row:-1,col:i,panel:this},r+1},e.prototype._renderRowHdrCell=function(t,i,n){var o=t.children[0];return o||(o=(0,s.createElement)(e._HTML_CELL,t)),o.setAttribute("role",i<0?"columnheader":"rowheader"),o.textContent=n?n.toString():"",(0,s.setCss)(o,{position:"fixed",left:-32e3,top:-32e3,width:.1,height:.1,overflow:"hidden",opacity:"0"}),o[e._INDEX_KEY]={row:i,col:-1,panel:this},1},e.prototype._renderRow=function(e,t,i,n){var o=this._g,r=this.rows[e];if(r.renderSize<=0)return n;var l=this._e.children[n];if(l||(l=(0,s.createElement)('<div class="wj-row"></div>',this._e)),this._ct==_.Cell){l.setAttribute("role","row");var a=v,h=r.isSelected;switch(o.selectionMode){case a.Row:case a.RowRange:h=h||this._g._selHdl.selection.containsRow(e)}(0,s.setAttribute)(l,"aria-selected",!!h||null),(0,s.setAttribute)(l,"aria-level",r instanceof M?r.level+1:null),(0,s.setAttribute)(l,"aria-expanded",r instanceof M?!r.isCollapsed:null),this.rows.ariaLabel&&(0,s.setAttribute)(l,"aria-label",this.rows.ariaLabel)}var c=0;if(this._ct==_.Cell){var u=this._g._getRowHeaderPath();u&&(c=this._renderRowHdrCell(l,e,u.getValue(r.dataItem)))}for(var d=0;d<this.columns.frozen&&d<this.columns.length;d++)c=this._renderCell(l,e,d,t,i,c);for(d=t.leftCol;d<=t.rightCol&&d>-1;d++)c=this._renderCell(l,e,d,t,i,c);return this._removeExtraCells(l,c),n+1},e.prototype._renderCell=function(t,i,n,o,r,l){var a=this._g,h=this._ct==_.Cell?a.getMergedRange(this,i,n,!1):a.getMergedRange(this,i,n);if(h){for(var c=Math.max(o.row,h.row);c<i;c++)if(this.rows[c].renderSize)return l;for(c=Math.max(o.col,h.col);c<n;c++)if(this.columns[c].renderSize)return l;var u=this.columns.frozen;if(u&&h.col<u&&h.col2>=u&&n>h.col)return l}var d=this.columns[n];if(d.renderSize<=0&&(!h||h.getRenderSize(this).width<=0))return l;var p=t.children[l];if(p&&!r&&this._recycle&&a._lazyRender&&!a.activeEditor){var f=p[e._INDEX_KEY];f&&f.row==i&&f.col==n&&f.rng==h&&i>=this.rows.frozen&&n>=this.columns.frozen&&(r=!0)}var g=b,m=this.getSelectedState(i,n,h),v=m==g.Cursor||m==g.Active;return p&&r?((0,s.toggleClass)(p,"wj-state-active",v),(0,s.toggleClass)(p,"wj-state-selected",m==g.Cursor),(0,s.toggleClass)(p,"wj-state-multi-selected",m==g.Selected),(0,s.setAttribute)(p,"aria-selected",!(!v&&m==g.None)||null),v&&(this._activeCell=p),l+1):(p||(p=(0,s.createElement)(e._HTML_CELL,t)),v&&(this._activeCell=p),this._ct==_.Cell&&((0,s.setAttribute)(p,"role","gridcell"),(0,s.setAttribute)(p,"aria-selected",!(m==g.None&&!v)||null),(0,s.setAttribute)(p,"aria-readonly",!a.canEditCell(i,n)||null),(0,s.setAttribute)(p,"aria-required",d.getIsRequired())),a.cellFactory.updateCell(this,i,n,p,h),p[e._INDEX_KEY]={row:i,col:n,rng:h,panel:this},l+1)},e.prototype._removeExtraCells=function(e,t){for(var i=this._g.cellFactory;e.childElementCount>t;){var n=e.lastElementChild;(0,s.removeChild)(n),i.disposeCell(n)}for(var o=e.childElementCount-1;o>-1;--o){var r=[e.children[o],e.children[o-1]],l=r[1];if((n=r[0])&&l){var a=n.getAttribute("style")===l.getAttribute("style"),h=n.innerHTML===l.innerHTML;a&&h&&((0,s.removeChild)(n),i.disposeCell(n))}}},e.prototype._getViewRange=function(){var e=this._g,t=e._ptScrl,i=e._szClientSB,n=this._rows,o=this._cols,r=new m(0,0,n.length-1,o.length-1);if(this._ct==_.Cell||this._ct==_.RowHeader){var s=-t.y+this._offsetY,l=i.height;(u=Math.min(n.frozen,n.length-1))>0&&(s+=d=n[u-1].pos,l-=d),u>0&&n[u].pos>i.height?r.row=r.row2=-1:(r.row=Math.min(n.length-1,Math.max(u,n.getItemAt(s))),r.row2=Math.max(r.row,n.getItemAt(s+l)));var a=e.hostElement;if(e._clipToScreen&&a){var h=a.getBoundingClientRect(),c=-h.top-e.cells._e.offsetTop;h.top<0&&(r.row=Math.max(r.row,n.getItemAt(c)-1)),h.bottom>innerHeight&&(r.row2=Math.min(r.row2,n.getItemAt(c+innerHeight)+1))}}if(this._ct==_.Cell||this._ct==_.ColumnHeader){var u,d,p=-t.x,f=i.width;if((u=Math.min(o.frozen,o.length-1))>0)p+=d=o[u-1].pos,f-=d;u>0&&o[u].pos>i.width?r.col=r.col2=-1:(r.col=Math.min(o.length-1,Math.max(u,o.getItemAt(p))),r.col2=Math.max(r.col,o.getItemAt(p+f)))}return n.length<=n.frozen&&(r.row=r.row2=-1),o.length<=o.frozen&&(r.col=r.col2=-1),r},e.prototype._getFrozenPos=function(){var e=this._rows.frozen,t=this._cols.frozen,i=e>0?this._rows[e-1]:null,n=t>0?this._cols[t-1]:null,o=i?i.pos+i.renderSize:0,r=n?n.pos+n.renderSize:0;return new s.Point(r,o)},e._INDEX_KEY="wj-cell-index",e._HTML_CELL='<div class="wj-cell" tabindex="-1"></div>',e}(),C=function(e){function t(t,i,n){var o=e.call(this)||this;return o._p=(0,s.asType)(t,w,!0),o._rng=(0,s.asType)(i,m,!0),o._data=n,o}return h(t,e),Object.defineProperty(t.prototype,"panel",{get:function(){return this._p},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"range",{get:function(){return this._rng.clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"row",{get:function(){return this._rng.row},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"col",{get:function(){return this._rng.col},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),t.prototype.getRow=function(){return this._p&&this.row>-1?this._p.rows[this.row]:null},t.prototype.getColumn=function(e){var t=this._p,i=t&&this.col>-1?t.columns[this.col]:null;if(i&&e){var n=t.grid;i=t.cellType===_.ColumnHeader&&n._hasColumnGroups()?n._getColumnGroup(this.row,this.col):t.grid._getBindingColumn(t,this.row,i)}return i},t}(s.CancelEventArgs),x=function(e){function t(t,i,n,o){void 0===o&&(o=!0);var r=e.call(this,t,i)||this;return r._updateContent=!0,r._cell=(0,s.asType)(n,HTMLElement),r}return h(t,e),Object.defineProperty(t.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updateContent",{get:function(){return this._updateContent},enumerable:!0,configurable:!0}),t}(C),E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._stayInEditMode=!1,t._refresh=!0,t}return h(t,e),Object.defineProperty(t.prototype,"stayInEditMode",{get:function(){return this._stayInEditMode},set:function(e){this._stayInEditMode=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"refresh",{get:function(){return this._refresh},set:function(e){this._refresh=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),t}(C);!function(e){e[e.None=0]="None",e[e.Cell=1]="Cell",e[e.CellRange=2]="CellRange",e[e.Row=3]="Row",e[e.RowRange=4]="RowRange",e[e.ListBox=5]="ListBox",e[e.MultiRange=6]="MultiRange"}(v||(v={})),function(e){e[e.None=0]="None",e[e.Selected=1]="Selected",e[e.Cursor=2]="Cursor",e[e.Active=3]="Active"}(b||(b={})),function(e){e[e.None=0]="None",e[e.Next=1]="Next",e[e.Prev=2]="Prev",e[e.NextPage=3]="NextPage",e[e.PrevPage=4]="PrevPage",e[e.Home=5]="Home",e[e.End=6]="End",e[e.NextCell=7]="NextCell",e[e.PrevCell=8]="PrevCell",e[e.NextEditableCell=9]="NextEditableCell",e[e.PrevEditableCell=10]="PrevEditableCell"}(y||(y={}));var S,D=function(){function e(e){this._sel=new m(0,0),this._xSel=new s.ObservableArray,this._mode=v.CellRange,this._g=e,this._e=new C(e.cells,new m(0,0)),this._xSel.collectionChanged.addHandler((function(){e.invalidate()}))}return Object.defineProperty(e.prototype,"selectionMode",{get:function(){return this._mode},set:function(e){e!=this._mode&&this._setSelectionMode(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this._sel},set:function(e){this.select(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extendedSelection",{get:function(){return this._xSel},enumerable:!0,configurable:!0}),e.prototype.select=function(e,t,i){void 0===t&&(t=!0),void 0===i&&(i=!1);var n=this._g,o=this._e.range,r=this._sel,l=o,a=!1,h=v;if((0,s.isNumber)(e)&&(0,s.isString)(t)){var c=n.columns.indexOf(t);if(c<0)throw"Invalid column name or binding.";o.setRange(e,c),t=!0}else(0,s.isNumber)(e)&&(0,s.isNumber)(t)?(o.setRange(e,t),t=!0):e instanceof m?o.copy(e):(0,s.assert)(!1,"CellRange expected");switch(n.selectionMode){case h.Cell:l.row2=l.row,l.col2=l.col;break;case h.Row:l.row2=l.row;break;case h.ListBox:a=!0}var u=l.equals(r);if(u&&a)for(var d=0;d<n.rows.length;d++)if(n.rows[d].isSelected!==l.containsRow(d)){u=!1;break}if(u)return t&&n.isRangeValid(l)&&this._showSelection(),!0;var p=s.Control.getControl((0,s.closest)((0,s.getActiveElement)(),".wj-flexgrid"));if(p&&p.activeEditor&&!p.finishEditing())return!1;var f=this._e;if(f._rng=l,f.cancel=!1,!n.onSelectionChanging(f)&&!i)return!1;a&&n.rows.forEach((function(e,t){e._setFlag(S.Selected,l.containsRow(t),!0)})),l.row=Math.min(l.row,n.rows.length-1),l.row2=Math.min(l.row2,n.rows.length-1),this._sel.copy(l),n.refreshCells(!1,!0,!0),t&&this._showSelection();var _=n.collectionView;if(_){var g=n._getCvIndex(l.row);_.moveCurrentToPosition(g)}return n.onSelectionChanged(f),!0},e.prototype.moveSelection=function(e,t,i){var n=this._g,o=this._sel,r=i&&n.anchorCursor?new m(o.row2,o.col2):new m(o.row,o.col);this._adjustReferenceCell(r,e,t);var s=r.row,l=r.col,a=n.columns,h=Math.max(0,n._szClient.height-n.columnHeaders.height),c=y;switch(t){case c.NextCell:case c.NextEditableCell:(l=this._getNextColumnCell(s,l,t))==r.col&&(s=this._getNextRowCell(s,l,t))>r.row&&(l=this._getNextColumnCell(s,0,t),l=this._getNextColumnCell(s,l,t==c.NextCell?c.PrevCell:c.PrevEditableCell)),n.select(s,l);break;case c.PrevCell:case c.PrevEditableCell:(l=this._getNextColumnCell(s,r.col,t))==r.col&&(s=this._getNextRowCell(s,l,t))<r.row&&(l=this._getNextColumnCell(s,a.length-1,t),l=this._getNextColumnCell(s,l,t==c.PrevCell?c.NextCell:c.NextEditableCell)),n.select(s,l);break;default:s=this._getNextRowCell(s,l,e,h),l=this._getNextColumnCell(s,l,t,h),i?n.selection=n.anchorCursor?new m(o.row,o.col,s,l):new m(s,l,o.row2,o.col2):n.select(s,l)}},e.prototype._getNextColumnCell=function(e,t,i,n){return void 0===n&&(n=0),this._g.columns.getNextCell(t,i,n)},e.prototype._getNextRowCell=function(e,t,i,n){return void 0===n&&(n=0),this._g.rows.getNextCell(e,i,n)},e.prototype._setSelectionMode=function(e){var t=this._g,i=t.rows;this._mode=e,this._xSel.clear(),i.length&&(this._adjustSelection(this._sel,e,!0),t.invalidate())},e.prototype._adjustSelection=function(e,t,i){void 0===i&&(i=!1);for(var n=this._g.rows,o=v,r=0;r<n.length;r++)n[r]._setFlag(S.Selected,!1,!0);var s=e.clone();switch(t){case o.None:s=new m;break;case o.Cell:s=new m(e.row,e.col);break;case o.ListBox:for(r=0;r<n.length;r++)n[r]._setFlag(S.Selected,s.containsRow(r),!0)}this.select(s,!1,i)},e.prototype._expandSelection=function(){var e=this._g,t=e.selectionMode;if(e.expandSelectionOnCopyPaste&&t){var i=this.selection,n=v;switch(t){case n.Cell:case n.Row:break;case n.ListBox:this._expandSelectedRows();break;case n.RowRange:i=new m(i.topRow,0,i.bottomRow,e.columns.length-1);default:var o=this._expandSelectionRange(i);o&&this.select(o,!1)}}},e.prototype._deselectRange=function(e){var t=this.selection,i=this.extendedSelection;if(t.contains(e)){var n=i.length;return this._sel=n?i[n-1]:new m,n&&i.removeAt(n-1),!0}for(var o=0;o<i.length;o++)if(i[o].contains(e))return i.removeAt(o),!0;return!1},e.prototype._expandSelectedRows=function(){(0,s.assert)(this.selectionMode==v.ListBox,"ListBox mode expected");for(var e=this._g,t=e.selectedRows.map((function(e){return e.index})),i=[],n=0;n<t.length;n++)for(var o=new m(t[n],0,t[n],e.columns.length-1),r=this._expandSelectionRange(o)||o,l=r.topRow;l<=r.bottomRow;l++)-1===i.indexOf(l)&&i.push(l);i.sort(),this._selectRows(i)},e.prototype._expandSelectionRange=function(e){var t=this._g,i=t.cells,n=t.getMergedRange(i,e.topRow,e.leftCol,!1),o=t.getMergedRange(i,e.bottomRow,e.leftCol,!1),r=t.getMergedRange(i,e.topRow,e.rightCol,!1),s=t.getMergedRange(i,e.bottomRow,e.rightCol,!1);return n||o||r||s?(n=n||new m(e.topRow,e.leftCol),o=o||new m(e.bottomRow,e.leftCol),r=r||new m(e.topRow,e.rightCol),s=s||new m(e.bottomRow,e.rightCol),new m(Math.min(n.topRow,o.topRow,r.topRow,s.topRow),Math.min(n.leftCol,o.leftCol,r.leftCol,s.leftCol),Math.max(n.bottomRow,o.bottomRow,r.bottomRow,s.bottomRow),Math.max(n.rightCol,o.rightCol,r.rightCol,s.rightCol))):null},e.prototype._selectRows=function(e){(0,s.assert)(this.selectionMode==v.ListBox,"ListBox mode expected");for(var t=this._g,i=0,n=!0;i<t.rows.length;i++){var o=t.rows[i],r=e&&e.indexOf(o.index)>-1;r&&n&&(n=!1,this.select(i,this.selection.col)),o.isSelected=r}},e.prototype._showSelection=function(){var e=this._g,t=this._sel;e.anchorCursor?e.scrollIntoView(t.row2,t.col2):e.scrollIntoView(t.row,t.col)},e.prototype._adjustReferenceCell=function(e,t,i){var n=this._g,o=n.getMergedRange(n.cells,e.row,e.col);if(o&&!o.isSingleCell){var r=y;switch(t){case r.Next:case r.NextCell:case r.NextEditableCell:e.row=o.bottomRow;break;case r.Prev:case r.PrevCell:case r.PrevEditableCell:e.row=o.topRow}switch(i){case r.Next:case r.NextCell:case r.NextEditableCell:e.col=o.rightCol;break;case r.Prev:case r.PrevCell:case r.PrevEditableCell:e.col=o.leftCol}}},e}();!function(e){e[e.Visible=1]="Visible",e[e.AllowResizing=2]="AllowResizing",e[e.AllowDragging=4]="AllowDragging",e[e.AllowMerging=8]="AllowMerging",e[e.AllowSorting=16]="AllowSorting",e[e.AutoGenerated=32]="AutoGenerated",e[e.Collapsed=64]="Collapsed",e[e.ParentCollapsed=128]="ParentCollapsed",e[e.Selected=256]="Selected",e[e.ReadOnly=512]="ReadOnly",e[e.HtmlContent=1024]="HtmlContent",e[e.WordWrap=2048]="WordWrap",e[e.MultiLine=4096]="MultiLine",e[e.HasTemplate=8192]="HasTemplate",e[e.RowDefault=3]="RowDefault",e[e.ColumnDefault=23]="ColumnDefault"}(S||(S={}));var P,I,R,T,H=function(){function e(){this._type=null,this._align=null,this._inpType=null,this._mask=null,this._maxLen=null,this._required=null,this._fmt=null,this._map=null,this._ddCssClass=null,this._cssClass=null,this._cssClassAll=null,this._szMin=null,this._szMax=null,this._sz=null,this._pos=0,this._idx=-1,this._idxVis=-1,this._idxData=-1,this.gridChanged=new s.Event}return Object.defineProperty(e.prototype,"binding",{get:function(){return this._binding?this._binding.path:null},set:function(e){if(e!=this.binding){var t=(0,s.asString)(e);if(this._binding=t?new s.Binding(t):null,!this._type&&this.grid&&this._binding){var i=this.grid.collectionView;if(i&&i.sourceCollection&&i.sourceCollection.length){var n=i.sourceCollection[0];this._type=(0,s.getType)(this._binding.getValue(n))}}this.onPropertyChanged()}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sortMemberPath",{get:function(){return this._bindingSort?this._bindingSort.path:null},set:function(e){if(e!=this.sortMemberPath){var t=(0,s.asString)(e);this._bindingSort=t?new s.Binding(t):null,this.onPropertyChanged()}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataType",{get:function(){return this._type},set:function(e){e=(0,s.asEnum)(e,s.DataType,!0),this._type!=e&&(this._type=e,this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputType",{get:function(){return this._inpType},set:function(e){this._inpType=(0,s.asString)(e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(e){this._mask=(0,s.asString)(e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxLength",{get:function(){return this._maxLen},set:function(e){this._maxLen=(0,s.asNumber)(e,!0,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(e){this._align!=e&&(this._align=e,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"format",{get:function(){return this._fmt},set:function(e){this._fmt!=e&&(this._fmt=e,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataMap",{get:function(){return this._map},set:function(e){this._map!=e&&(this._map&&this._map.mapChanged.removeHandler(this.onPropertyChanged,this),(0,s.isArray)(e)&&(e=new g(e,null,null)),this._map=(0,s.asType)(e,g,!0),this._map&&this._map.mapChanged.addHandler(this.onPropertyChanged,this),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataMapEditor",{get:function(){return null!=this._mapEditor?this._mapEditor:o.DropDownList},set:function(e){e!=this._mapEditor&&(this._mapEditor=(0,s.asEnum)(e,o),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showDropDown",{get:function(){return this.dataMapEditor==o.DropDownList},set:function(e){(0,s._deprecated)("showDropDown","dataMapEditor"),this.dataMapEditor=e?o.DropDownList:o.AutoComplete},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropDownCssClass",{get:function(){return this._ddCssClass},set:function(e){this._ddCssClass=(0,s.asString)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._getFlag(S.Visible)},set:function(e){this._setFlag(S.Visible,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){return!!this._getFlag(S.Visible)&&(!this._getFlag(S.ParentCollapsed)||this instanceof W)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pos",{get:function(){return this._list&&this._list._dirty&&this._list._update(),this._pos},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._list&&this._list._dirty&&this._list._update(),this._idx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visibleIndex",{get:function(){return this._list&&this._list._dirty&&this._list._update(),this.isVisible?this._idxVis:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._sz},set:function(e){e!=this._sz&&(this._sz=(0,s.asNumber)(e,!0),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderSize",{get:function(){var e=0,t=this._list;return this.isVisible&&((null==(e=this._sz)||e<0)&&(e=t?t.defaultSize:0),t&&null!=t.minSize&&e<t.minSize&&(e=t.minSize),t&&null!=t.maxSize&&e>t.maxSize&&(e=t.maxSize),null!=this._szMin&&e<this._szMin&&(e=this._szMin),null!=this._szMax&&e>this._szMax&&(e=this._szMax)),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowResizing",{get:function(){return this._getFlag(S.AllowResizing)},set:function(e){this._setFlag(S.AllowResizing,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowDragging",{get:function(){return this._getFlag(S.AllowDragging)},set:function(e){this._setFlag(S.AllowDragging,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowMerging",{get:function(){return this._getFlag(S.AllowMerging)},set:function(e){this._setFlag(S.AllowMerging,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSelected",{get:function(){return this._getFlag(S.Selected)},set:function(e){if(!!e!=this.isSelected){var t=this.grid;if(t){var i=this instanceof k?new m(this.index,-1):new m(-1,this.index),n=new C(t?t.cells:null,i);t.onSelectionChanging(n)&&this._setFlag(S.Selected,e,!0)&&(t.refreshCells(!1,!0,!0),t.onSelectionChanged(n))}else this._setFlag(S.Selected,e)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isReadOnly",{get:function(){return this._getFlag(S.ReadOnly)},set:function(e){this._setFlag(S.ReadOnly,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRequired",{get:function(){return this._required},set:function(e){this._required=(0,s.asBoolean)(e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isContentHtml",{get:function(){return this._getFlag(S.HtmlContent)},set:function(e){this.isContentHtml!=e&&(this._setFlag(S.HtmlContent,e),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wordWrap",{get:function(){return this._getFlag(S.WordWrap)},set:function(e){this._setFlag(S.WordWrap,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiLine",{get:function(){return this._getFlag(S.MultiLine)},set:function(e){this._setFlag(S.MultiLine,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cssClass",{get:function(){return this._cssClass},set:function(e){e!=this._cssClass&&(this._cssClass=(0,s.asString)(e),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cssClassAll",{get:function(){return this._cssClassAll},set:function(e){e!=this._cssClassAll&&(this._cssClassAll=(0,s.asString)(e),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){return this._list?this._list._g:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"collectionView",{get:function(){return this.grid?this.grid.collectionView:null},enumerable:!0,configurable:!0}),e.prototype.onPropertyChanged=function(){this._list&&(this._list._dirty=!0,this.grid.invalidate())},e.prototype.onGridChanged=function(e){this.gridChanged.raise(this,e)},e.prototype._setList=function(e){e!=this._list&&(this._list=e,this.onGridChanged())},e.prototype._getFlag=function(e){return 0!=(this._f&e)},e.prototype._setFlag=function(e,t,i){return!!t!=this._getFlag(e)&&(this._f=t?this._f|e:this._f&~e,i||this.onPropertyChanged(),!0)},e}(),j=function(e){function t(i){var n=e.call(this)||this;return n._hdr=null,n._name=null,n._agg=null,n._quickSize=null,n._descById=null,n._tpl=null,n._f=S.ColumnDefault,n._hash=t._ctr.toString(36),t._ctr++,(0,s.copy)(n,i),n}return h(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return null!=this._szStar?this._szStar:this.size},set:function(e){null!=t._parseStarSize(e)?(this._szStar=e,this.onPropertyChanged()):(this._szStar=null,this.size=(0,s.asNumber)(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minWidth",{get:function(){return this._szMin},set:function(e){e!=this._szMin&&(this._szMin=(0,s.asNumber)(e,!0,!0),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this._szMax},set:function(e){e!=this._szMax&&(this._szMax=(0,s.asNumber)(e,!0,!0),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"quickAutoSize",{get:function(){return this._quickSize},set:function(e){this._quickSize=(0,s.asBoolean)(e,!0)},enumerable:!0,configurable:!0}),t.prototype._getQuickAutoSize=function(){return!!this.grid._getQuickAutoSize()&&((0,s.isBoolean)(this._quickSize)?this._quickSize:!(this.isContentHtml||this.wordWrap||this.multiLine||this._getFlag(S.HasTemplate)))},Object.defineProperty(t.prototype,"renderWidth",{get:function(){return this.renderSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"header",{get:function(){return this._hdr?this._hdr:this.binding},set:function(e){this._hdr!=e&&(this._hdr=e,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellTemplate",{get:function(){return this._tpl},set:function(e){e!=this._tpl&&((0,s.assert)(null==e||(0,s.isString)(e)||(0,s.isFunction)(e),"cellTemplate should be a string or an ICellTemplateFunction."),this._tpl=e,this._setFlag(S.HasTemplate,null!=e&&""!=e),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editor",{get:function(){var e=this._edt;return e?e.control:null},set:function(e){e!=this.editor&&(this._edt&&(this._edt.dispose(),this._edt=null),null!=e&&(e=(0,s.asType)(e,s.Control),this._edt=new se(this,e)))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowSorting",{get:function(){return this._getFlag(S.AllowSorting)},set:function(e){this._setFlag(S.AllowSorting,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentSort",{get:function(){var e=this.currentSortIndex;return e>-1?this.grid.collectionView.sortDescriptions[e].ascending?"+":"-":null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentSortIndex",{get:function(){var e=this.grid?this.grid.collectionView:null,t=e?e.sortDescriptions:null,i=t&&t.length?this._getBindingSort():null;if(i)for(var n=0;n<t.length;n++)if(t[n].property==i)return n;return-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aggregate",{get:function(){return null!=this._agg?this._agg:s.Aggregate.None},set:function(e){(e=(0,s.asEnum)(e,s.Aggregate))!=this._agg&&(this._agg=e,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"describedById",{get:function(){return this._descById},set:function(e){e!=this._descById&&(this._descById=(0,s.asString)(e),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),t.prototype.getIsRequired=function(e){return null!=this._required?this._required:e&&null!=e.isRequired?e.isRequired:this.dataType==s.DataType.String?null!=this.dataMap||null!=this._mask&&this._mask.length>0:!e||e.dataType!=s.DataType.String||null!=e.dataMap||null!=e.mask&&e.mask.length>0},t.prototype.getAlignment=function(e){if(null!=this._align)return this._align;if(e&&null!=e.align)return e.align;if(!this._map)switch(this.dataType){case s.DataType.Boolean:return"center";case s.DataType.Number:return"right"}if(e&&!e.dataMap)switch(e.dataType){case s.DataType.Boolean:return"center";case s.DataType.Number:return"right"}return""},t.prototype._getBindingSort=function(){return this.sortMemberPath?this.sortMemberPath:this.binding?this.binding:null},t._parseStarSize=function(e){if((0,s.isString)(e)){var t=e.length;if(t>0&&"*"==e[t-1]){var i=1==t?1:parseFloat(e);if(i>0&&!isNaN(i))return i}}return null},t._ctr=0,t}(H),k=function(e){function t(t){var i=e.call(this)||this;return i._f=S.ColumnDefault,i._data=t||null,i}return h(t,e),Object.defineProperty(t.prototype,"dataItem",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataIndex",{get:function(){return this._list&&this._list._dirty&&this._list._update(),this._idxData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderHeight",{get:function(){return this.renderSize},enumerable:!0,configurable:!0}),t}(H),M=function(e){function t(t){var i=e.call(this,t)||this;return i._level=-1,i.level=t instanceof s.CollectionViewGroup?t.level:-1,i.isReadOnly=!0,i}return h(t,e),Object.defineProperty(t.prototype,"level",{get:function(){return this._level},set:function(e){(0,s.asInt)(e),e!=this._level&&(this._level=e,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasChildren",{get:function(){if(null!=this.grid&&null!=this._list){this._list._update();var e=this.index<this._list.length-1?this._list[this.index+1]:null,i=(0,s.tryCast)(e,t),n=(0,s.tryCast)(e,W);return null!=e&&null==n&&(null==i||i.level>this.level)}return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCollapsed",{get:function(){return this._getFlag(S.Collapsed)},set:function(e){!!e!=this.isCollapsed&&null!=this._list&&this._setCollapsed((0,s.asBoolean)(e))},enumerable:!0,configurable:!0}),t.prototype.getGroupHeader=function(){var e=this.grid,t=e.groupHeaderFormat||s.culture.FlexGrid.groupHeaderFormat,i=this.dataItem;if(i instanceof s.CollectionViewGroup&&t&&e.showGroups&&!e.childItemsPath){var n=i.groupDescription.propertyName,o=i.name,r=e.getColumn(n),l=this.isContentHtml;if(r){l=l||r.isContentHtml,r.header&&(n=r.header);var a=r.dataMap;a&&(o=a.getDisplayValue(o)),r.dataType==(0,s.getType)(o)&&(o=s.Globalize.format(o,r.format))}else n=(0,s.toHeaderCase)(n);var h=i.getAggregate(s.Aggregate.CntAll,null,e.collectionView);return(0,s.format)(t,{name:(0,s.escapeHtml)(n),value:l?o:(0,s.escapeHtml)(o),level:i.level,count:h})}return""},t.prototype._setCollapsed=function(e){var i=this,n=this.grid,o=n.rows,r=this.getCellRange(),s=new C(n.cells,new m(this.index,-1));n.onGroupCollapsedChanging(s)&&(n.deferUpdate((function(){o.deferUpdate((function(){i._setFlag(S.Collapsed,e,!0);for(var n=r.topRow+1;n<=r.bottomRow&&n>-1&&n<o.length;n++){o[n]._setFlag(S.ParentCollapsed,e,!0);var s=o[n];s instanceof t&&s.isCollapsed&&(n=s.getCellRange().bottomRow)}}))})),n.onGroupCollapsedChanged(s))},t.prototype.getCellRange=function(){for(var e=this._list,i=this.index,n=e.length-1,o=i+1;o<=n;o++){var r=e[o];if(r instanceof t&&r.level<=this.level){n=o-1;break}}return new m(i,0,n,this.grid.columns.length-1)},t}(k),O=function(e){function t(t,i){var n=e.call(this)||this;return n._frozen=0,n._lastFrozen=-1,n._firstVisible=-1,n._vlen=0,n._szDef=28,n._szTot=0,n._szCustom=!1,n._dirty=!1,n._g=(0,s.asType)(t,N),n._szDef=(0,s.asNumber)(i,!1,!0),n}return h(t,e),Object.defineProperty(t.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultSize",{get:function(){return this._szDef},set:function(e){this._szCustom=!0,this._szDef!=e&&(this._szDef=(0,s.asNumber)(e,!1,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"frozen",{get:function(){return this._frozen},set:function(e){e!=this._frozen&&(this._frozen=(0,s.asNumber)(e,!1,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),t.prototype.isFrozen=function(e){return e<this.frozen},Object.defineProperty(t.prototype,"minSize",{get:function(){return this._szMin},set:function(e){e!=this._szMin&&(this._szMin=(0,s.asNumber)(e,!0,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxSize",{get:function(){return this._szMax},set:function(e){e!=this._szMax&&(this._szMax=(0,s.asNumber)(e,!0,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),t.prototype.getTotalSize=function(){return this._dirty&&this._update(),this._szTot},Object.defineProperty(t.prototype,"visibleLength",{get:function(){return this._dirty&&this._update(),this._vlen},enumerable:!0,configurable:!0}),t.prototype.getItemAt=function(e){if(this._dirty&&this._update(),e<=0&&this.length>0&&this[0].renderSize)return 0;for(var t,i,n=this.length,o=0,r=n-1;o<=r;)if((i=this[t=o+r>>>1])._pos>=e&&t>0)r=t-1;else{if(!(i._pos+i.renderSize<=e&&t<n-1)){for(;t>0&&!this[t].renderSize;)t--;for(;t<n-1&&!this[t].renderSize;)t++;return t}o=t+1}return r},t.prototype.getNextCell=function(e,t,i){void 0===i&&(i=0);var n,o=y;switch(t){case o.Next:case o.NextCell:for(n=e+1;n<this.length;n++)if(this[n].renderSize>0)return n;break;case o.NextEditableCell:for(n=e+1;n<this.length;n++)if(this[n].renderSize>0&&!this[n].isReadOnly)return n;break;case o.Prev:case o.PrevCell:for(n=e-1;n>=0;n--)if(this[n].renderSize>0)return n;break;case o.PrevEditableCell:for(n=e-1;n>=0;n--)if(this[n].renderSize>0&&!this[n].isReadOnly)return n;break;case o.End:for(n=this.length-1;n>=0;n--)if(this[n].renderSize>0)return n;break;case o.Home:for(n=0;n<this.length;n++)if(this[n].renderSize>0)return n;break;case o.NextPage:return(n=this.getItemAt(this[e].pos+this[e].renderSize+i))<0?this.getNextCell(e,y.End,i):n==e&&n<this.length-1&&this[n+1].renderSize?n+1:n;case o.PrevPage:return(n=this.getItemAt(this[e].pos-i))<0?this.getNextCell(e,y.Home,i):n==e&&n>0&&this[n-1].renderSize?n-1:n}return e},t.prototype.canMoveElement=function(e,t,i){if(void 0===i&&(i=!0),t==e)return!1;if(e<0||e>=this.length||t>=this.length)return!1;if(i){t<0&&(t=this.length-1);for(var n=Math.min(e,t),o=Math.max(e,t),r=n;r<=o;r++)if(!this[r].allowDragging)return!1}return!(this[t]instanceof W)},t.prototype.moveElement=function(e,t,i){if(void 0===i&&(i=!0),this.canMoveElement(e,t,i)){var n=this[e];if(this.removeAt(e),t<0&&(t=this.length),this.insert(t,n),i){var o=this.frozen;e<o&&t>=o?this.frozen--:e>=o&&t<o&&this.frozen++}return!0}return!1},t.prototype.onCollectionChanged=function(t){void 0===t&&(t=s.NotifyCollectionChangedEventArgs.reset),this._dirty=!0,this._g.invalidate(),e.prototype.onCollectionChanged.call(this,t)},t.prototype.push=function(t){return t._setList(this),e.prototype.push.call(this,t)},t.prototype.splice=function(t,i){for(var n=this,o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];for(var s=t;s<t+i&&s<this.length;s++){var l=this[s];l instanceof H&&l._setList(null)}return o.forEach((function(e){return e._setList(n)})),e.prototype.splice.apply(this,[t,i].concat(o))},t.prototype.beginUpdate=function(){this._update(),e.prototype.beginUpdate.call(this)},t.prototype._setDefaultSize=function(e){this._szCustom||(this.defaultSize=e,this._szCustom=!1)},t.prototype._update=function(){if(this._dirty&&!this.isUpdating){this._dirty=!1,this._lastFrozen=-1,this._firstVisible=-1;for(var e=0,t=0,i=void 0,n=void 0,o=0;o<this.length;o++)(n=this[o])._idx=o,n._idxVis=e,n._pos=t,n._setList(this),(i=n.renderSize)>0&&(t+=i,e++,o<this._frozen&&(this._lastFrozen=o)),this._firstVisible<0&&n.visible&&(this._firstVisible=o);return this._vlen=e,this._szTot=t,!0}return!1},t}(s.ObservableArray),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.getColumn=function(e){var t=(0,s.isNumber)(e)?e:this.indexOf(e);return t>-1?this[t]:null},t.prototype.indexOf=function(t){if(t instanceof j)return e.prototype.indexOf.call(this,t);for(var i=0;i<this.length;i++)if(this[i].name==t)return i;for(i=0;i<this.length;i++)if(this[i].binding==t)return i;return-1},Object.defineProperty(t.prototype,"describedById",{get:function(){return this._descById},set:function(e){e!=this._descById&&(this._descById=(0,s.asString)(e),this._g&&this._g.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstVisibleIndex",{get:function(){return this._dirty&&this._update(),this._firstVisible},enumerable:!0,configurable:!0}),t.prototype._updateStarSizes=function(e){var t,i=!1,n=0;e-=.5;for(var o=0;o<this.length;o++)(s=this[o]).isVisible&&(s._szStar?(n+=j._parseStarSize(s._szStar),t=s):e-=s.renderWidth);if(t){var r=e;for(o=0;o<this.length;o++){var s;if((s=this[o]).isVisible&&s._szStar){var l=s._sz;s==t&&r>0?l=r:r-=l=Math.max(0,Math.round(j._parseStarSize(s._szStar)/n*e)),l!=s._sz&&(s._sz=l,i=!0)}}return i&&(this._dirty=!0,this._update()),i}return!1},t}(O),L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._maxLevel=-1,t}return h(t,e),Object.defineProperty(t.prototype,"ariaLabel",{get:function(){return this._ariaLabel},set:function(e){e!=this.ariaLabel&&(this._ariaLabel=(0,s.asString)(e),this._g&&this._g.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxGroupLevel",{get:function(){return this._dirty&&this._update(),this._maxLevel},enumerable:!0,configurable:!0}),t.prototype._update=function(){var t=this;if(e.prototype._update.call(this)){var i=this.grid?this.grid.collectionView:null,n=i?i.items:null,o=0;return this._maxLevel=-1,this.forEach((function(e){e instanceof M&&e.level>t._maxLevel&&(t._maxLevel=e.level);var i=e.dataItem;i&&n?i===n[o]?e._idxData=o:i===n[o+1]?e._idxData=++o:i!==n[e._idxData]&&(e._idxData=-1):e._idxData=-1})),!0}return!1},t}(O),z=function(){function e(e){this._updatingCollection=0,this._initialized=!1,this._grid=e,this._initializeColumnGroups(),this._initialized=!0}return Object.defineProperty(e.prototype,"columnGroups",{get:function(){return this._colGroups},enumerable:!0,configurable:!0}),e.prototype.createColumnGroups=function(e){this._initialized=!1,this._createColumnGroups(e),this._initialized=!0},e.prototype.hasColumnGroups=function(){return null!=this._colGroups&&this._colGroups.length>0},e.prototype.getGroupDefinitions=function(){return this._groupDefs},e.prototype.getColumnGroup=function(e,t){return this._getColumnGroup(e,t)},e.prototype.canMoveColumnGroup=function(e,t,i,n){if(e==i&&t==n)return!1;var o=this._grid,r=o.columnHeaders.rows,s=o.columns;if(e<0||e>=r.length||t<0||t>=s.length||i<0||i>=r.length||n<0||n>=s.length)return!1;var l=this._getColumnGroup(e,t),a=this._getColumnGroup(i,n);if(!l||!a||l==a)return!1;if(l.level<a.level&&l._containsGroup(a))return!1;var h=l.parentGroup,c=a.parentGroup;return!h||h===c||!h._isCollapseTo(l)},e.prototype.moveColumnGroup=function(e,t,i,n,o){if(this.canMoveColumnGroup(e,t,i,n)){var r=this._getColumnGroup(e,t),s=this._getColumnGroup(i,n);if(!r||!s||r==s)return!1;if(o&&!s.isEmpty)return!1;var l=this._getCollection(r),a=o?s.columns:this._getCollection(s);if(!l||!a)return!1;var h=o?0:a.indexOf(s);return!(h<0)&&(!o&&l!=a&&n>t&&h++,this._deferCollectionUpdate((function(){if(!l.remove(r))return!1;a.insert(h,r)})),!0)}return!1},e.prototype.handleCollectionChange=function(){this._initialized&&!this._updatingCollection&&(this._initialized=!1,this._buildColumnGroups(),this._initialized=!0)},e.prototype.handlePropertyChange=function(e){if(e&&this._initialized){var t=this._grid,i=e._rng,n=e.header;if(n!=e._curr_header)for(var o=i.topRow;o<=i.bottomRow;o++)for(var r=i.leftCol;r<=i.rightCol;r++)t.columnHeaders.setCellData(o,r,n),e._curr_header=n;e.columns.length>0&&t.invalidate()}},e.prototype._initializeColumnGroups=function(){var e=this._grid,t=new F;this._groupDefs=t,this._colGroups=t,this._colGroups._setOwner(e),this._colGroups._setChangeHandler(this)},e.prototype._createColumnGroups=function(e){this._grid,this._groupDefs=(0,s.asArray)(e),this._colGroups&&this._colGroups._setOwner(null),this._colGroups=F._parse(e),this._buildColumnGroups()},e.prototype._buildColumnGroups=function(){var e=this,t=this._grid;this._colGroups._removeChangeHandler(),this._assertColumnGroups(this._colGroups),t.autoGenerateColumns=!1,t.columns.clear(),this._colGroups._setOwner(t),this._colGroups.forEach((function(e){e._beginBuild()}));var i=0;this._colGroups.forEach((function(t){e._addColumnGroup(t),i=Math.max(i,t._getMaxLevel())})),this._colGroups.forEach((function(e){e._expandRange(i)}));var n=t.columnHeaders.rows;n.clear();for(var o=0;o<=i;o++){var r=new k;n.splice(o,0,r),o<i&&(r.cssClassAll="wj-colgroup")}for(o=0;o<n.length;o++)for(var l=0;l<t.columns.length;l++){var a=this._getColumnGroup(o,l);if(a){var h=a.header||(0,s.toHeaderCase)(a.binding);t.columnHeaders.setCellData(o,l,h),a._curr_header=a.header}}this._colGroups._setChangeHandler(this),this._colGroups.forEach((function(e){e._checkIfCollapsed()}))},e.prototype._getColumnGroup=function(e,t){var i=this._grid;if(e<i.columnHeaders.rows.length&&t<i.columns.length)for(var n=this._colGroups;n;){for(var o=n,r=0;r<n.length;r++){var s=n[r],l=s._rng;if(l.containsColumn(t)){if(l.containsRow(e)||0==s.columns.length)return s;n=s.columns;break}}if(n==o)break}return null},e.prototype._getCollection=function(e){var t=e.parentGroup;return t?t.columns:this._colGroups},e.prototype._assertColumnGroups=function(e){var t=this;(0,s.assert)(e instanceof F,"column groups contain items of invalid collection type"),e.forEach((function(e){(0,s.assert)(e instanceof B,"column groups contain items of invalid type"),t._assertColumnGroups(e.columns)}))},e.prototype._addColumnGroup=function(e){var t=this,i=this._grid;e._rng.col=i.columns.length,0==e.columns.length?i.columns.push(e):e.columns.forEach((function(e){t._addColumnGroup(e)})),e._rng.col2=i.columns.length-1},e.prototype._beginCollectionUpdate=function(){this._updatingCollection++},e.prototype._endCollectionUpdate=function(){this._updatingCollection--,this._updatingCollection<=0&&this.handleCollectionChange()},e.prototype._deferCollectionUpdate=function(e){try{this._beginCollectionUpdate(),e()}finally{this._endCollectionUpdate()}},e}(),B=function(e){function t(t,i){var n=e.call(this)||this;n._rng=new m(0,-1),n._lvl=0,n._collapsed=!1,n._cols=new F,(0,s.copy)(n,t);var o=i&&i.columns;return o&&o.indexOf(n)<0&&o.push(n),n}return h(t,e),t.prototype._copy=function(e,t){if("columns"==e){var i=(0,s.asArray)(t);return this._cols=F._parse(i),!0}return!1},Object.defineProperty(t.prototype,"columns",{get:function(){return this._cols},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnGroups",{get:function(){return this._cols},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return 0===this._cols.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentGroup",{get:function(){var e=this._ownerList,i=e&&e.owner;return i instanceof t?i:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){for(var e=this,t=0;e.parentGroup;)e=e.parentGroup,t++;return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collapseTo",{get:function(){return this._collTo},set:function(e){(0,s.assert)((0,s.isArray)(e)||(0,s.isString)(e),"collapseTo should be an array or a string."),this._collTo!=e&&(this._collTo=e,this._updateCollapsedState())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCollapsed",{get:function(){return this._collapsed},set:function(e){var t=this.grid,i=null;e!=this._collapsed&&(t?(i=new C(t.columnHeaders,this._rng,this),t.onColumnGroupCollapsedChanging(i)?this._collapsed=(0,s.asBoolean)(e):i=null):this._collapsed=(0,s.asBoolean)(e)),this._updateCollapsedState(),t&&i&&t.onColumnGroupCollapsedChanged(i)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){var e=this._ownerList,i=e&&e.owner;return i instanceof t?i.grid:i instanceof N?i:null},enumerable:!0,configurable:!0}),t.prototype._beginBuild=function(){this._lvl=0;for(var e=this.parentGroup;e;e=e.parentGroup)this._lvl++;this._rng=new m(0,-1),this._rng.row=this._rng.row2=this._lvl,this._cols.forEach((function(e){e._beginBuild()}))},t.prototype._setChangeHandler=function(e){this._changeHdl=e,this._cols._setChangeHandler(e)},t.prototype._removeChangeHandler=function(){this._changeHdl=null,this._cols._removeChangeHandler()},t.prototype._setOwnerList=function(e){e!=this._ownerList&&(this._ownerList=e)},t.prototype._checkIfCollapsed=function(){var e=this.grid;e&&e.columns&&(this._collapsed?this._updateCollapsedState():this._cols.forEach((function(e){e._checkIfCollapsed()})))},t.prototype._updateCollapsedState=function(){var e=this.grid,i=e?e.columns:null,n=this._rng,o=this._collapsed;if(i){this._cols.forEach((function(e){e instanceof t&&(e._collapsed=o,e._updateCollapsedState())}));for(var r=this._getCollapseToIndices(),s=n.leftCol;s<=n.rightCol;s++){var l=!o||r.indexOf(s)>-1;i[s]._setFlag(S.ParentCollapsed,!l)}}},t.prototype._getMaxLevel=function(){var e=this._lvl;return this.columns.forEach((function(t){e=Math.max(e,t._getMaxLevel())})),e},t.prototype._expandRange=function(e){var t=e-this._getMaxLevel();t>0&&(this._rng.row2+=t,this._cols.forEach((function(e){e._shiftRange(t)})));for(var i=this.grid.columns,n=this._rng,o=n.col;o<=n.col2;o++)i[o]._rng.row2=e},t.prototype._shiftRange=function(e){this._rng.row+=e,this._rng.row2+=e,this._cols.forEach((function(t){t._shiftRange(e)}))},t.prototype._containsGroup=function(e){for(var t=0;t<this._cols.length;t++){var i=this._cols[t];if(i==e||i._containsGroup(e))return!0}return!1},t.prototype._isCollapseTo=function(e){var t=this.grid,i=t?t.columns:null;if(!e||!i)return!1;var n=this._getCollapseToBindings();if(n&&n.length)for(var o=0;o<n.length;o++)switch(n[o]){case"$first":case"$last":continue;default:if(e===i.getColumn(n[o]))return!0}return!1},t.prototype._getCollapseToBindings=function(){var e=this.collapseTo;return(0,s.isString)(e)?[e]:e},t.prototype._getCollapseToIndices=function(){var e=this.grid,t=this._rng,i=this._getCollapseToBindings();if(i&&i.length){for(var n=[],o=e.columns,r=0;r<i.length;r++)switch(i[r]){case"$first":n.push(t.leftCol);break;case"$last":n.push(t.rightCol);break;default:var s=o.getColumn(i[r]),l=o.indexOf(s);s&&t.containsColumn(l)&&n.push(l)}if(n.length)return n}return[t.rightCol]},t.prototype.onPropertyChanged=function(){var t=this._changeHdl;t&&t.handlePropertyChange(this),e.prototype.onPropertyChanged.call(this)},t}(j),F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.getColumn=function(e){return(0,s.isNumber)(e)?this._getColByIdx(e):this._findColByProp("name",e)||this._findColByProp("binding",e)},Object.defineProperty(t.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),t.prototype.push=function(t){return t._setOwnerList(this),e.prototype.push.call(this,t)},t.prototype.splice=function(t,i){for(var n=this,o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];for(var s=t;s<t+i&&s<this.length;s++){var l=this[s];l instanceof B&&l._setOwnerList(null)}return o.forEach((function(e){return e._setOwnerList(n)})),e.prototype.splice.apply(this,[t,i].concat(o))},t._parse=function(e){var i=null;return e?e instanceof t?i=e:(i=new t,e.forEach((function(e){var t=e instanceof B?e:new B(e);i.indexOf(t)<0&&i.push(t)}))):i=new t,i},t.prototype._setChangeHandler=function(e){this._changeHdl=e,this.forEach((function(t){return t._setChangeHandler(e)}))},t.prototype._removeChangeHandler=function(){this._changeHdl=null,this.forEach((function(e){return e._removeChangeHandler()}))},t.prototype._setOwner=function(e){this._owner=e,this.forEach((function(e){return e.columns._setOwner(e)}))},t.prototype._getColByIdx=function(e){return e>-1&&e<this.length?this[e]:null},t.prototype._findColByProp=function(e,t){for(var i=0;i<this.length;i++){var n=this[i];if(n[e]===t)return n;if(null!==(n=n.columns._findColByProp(e,t)))return n}return null},t.prototype.onCollectionChanged=function(t){void 0===t&&(t=s.NotifyCollectionChangedEventArgs.reset);var i=this._changeHdl;i&&i.handleCollectionChange(),e.prototype.onCollectionChanged.call(this,t)},t}(s.ObservableArray);(0,s._addCultureInfo)("FlexGrid",{groupHeaderFormat:"{name}: <b>{value}</b> ({count:n0} items)",ariaLabels:{toggleDropDown:"Toggle Dropdown",toggleGroup:"Toggle Group"}}),function(e){e[e.None=0]="None",e[e.SingleColumn=1]="SingleColumn",e[e.MultiColumn=2]="MultiColumn"}(P||(P={})),function(e){e[e.None=0]="None",e[e.SingleColumn=1]="SingleColumn",e[e.ColumnRange=2]="ColumnRange",e[e.Both=3]="Both"}(I||(I={})),function(e){e[e.None=0]="None",e[e.Column=1]="Column",e[e.Row=2]="Row",e[e.All=3]="All"}(R||(R={})),function(e){e[e.Default=0]="Default",e[e.CSV=1]="CSV",e[e.QuoteAll=2]="QuoteAll",e[e.SkipMerged=4]="SkipMerged",e[e.Unformatted=8]="Unformatted",e[e.InvisibleRows=16]="InvisibleRows",e[e.InvisibleColumns=32]="InvisibleColumns",e[e.InvisibleCells=48]="InvisibleCells"}(T||(T={}));var V,N=function(e){function t(t,i){var n=e.call(this,t,null,!0)||this;n._activeCell=null,n._szClient=new s.Size(0,0),n._szClientSB=new s.Size(0,0),n._offsetY=0,n._cssPage=0,n._ptScrl=new s.Point(0,0),n._cellPadLeft=3,n._cellPadHorz=3,n._cellPadVert=0,n._clipToScreen=!1,n._autoGenCols=!0,n._autoClipboard=!0,n._xOnCopyPaste=!0,n._autoScroll=!0,n._autoSearch=!1,n._caseSensitive=!1,n._readOnly=!1,n._indent=14,n._autoSizeMode=ae.Both,n._autoHeights=!1,n._quickSize=null,n._hdrVis=R.All,n._alSorting=P.SingleColumn,n._alPinning=I.None,n._alAddNew=!1,n._alDelete=!1,n._alResizing=le.Columns,n._alDragging=he.Columns,n._alMerging=V.None,n._ssHdr=R.None,n._shSort=!0,n._shGroups=!0,n._shMarquee=!1,n._shPlcHld=!1,n._altStep=1,n._shErr=!0,n._shDropDown=!0,n._valEdt=!0,n._gHdrFmt=null,n._childItemsPath=null,n._sortRowIndex=null,n._editColIndex=null,n._deferResizing=!1,n._pSel=!0,n._pOutline=!0,n._stickyHdr=!1,n._anchorCursor=!1,n._copyHeaders=R.None,n._bigChecks=!1,n._fzClone=null,n._vt=0,n._vtRows=0,n._vtCols=0,n._lazyRender=!0,n._refreshOnEdit=!0,n._reorderCells=!0,n._isISChanging=!1,n._touchEdit=!1,n.itemsSourceChanging=new s.Event,n.itemsSourceChanged=new s.Event,n.scrollPositionChanged=new s.Event,n.selectionChanging=new s.Event,n.selectionChanged=new s.Event,n.loadingRows=new s.Event,n.loadedRows=new s.Event,n.updatingLayout=new s.Event,n.updatedLayout=new s.Event,n.resizingColumn=new s.Event,n.resizedColumn=new s.Event,n.autoSizingColumn=new s.Event,n.autoSizedColumn=new s.Event,n.starSizedColumns=new s.Event,n.draggingColumn=new s.Event,n.draggingColumnOver=new s.Event,n.draggedColumn=new s.Event,n.pinningColumn=new s.Event,n.pinnedColumn=new s.Event,n.resizingRow=new s.Event,n.resizedRow=new s.Event,n.autoSizingRow=new s.Event,n.autoSizedRow=new s.Event,n.draggingRow=new s.Event,n.draggingRowOver=new s.Event,n.draggedRow=new s.Event,n.groupCollapsedChanging=new s.Event,n.groupCollapsedChanged=new s.Event,n.columnGroupCollapsedChanging=new s.Event,n.columnGroupCollapsedChanged=new s.Event,n.sortingColumn=new s.Event,n.sortedColumn=new s.Event,n.beginningEdit=new s.Event,n.prepareCellForEdit=new s.Event,n.cellEditEnding=new s.Event,n.cellEditEnded=new s.Event,n.rowEditStarting=new s.Event,n.rowEditStarted=new s.Event,n.rowEditEnding=new s.Event,n.rowEditEnded=new s.Event,n.rowAdded=new s.Event,n.deletingRow=new s.Event,n.deletedRow=new s.Event,n.copying=new s.Event,n.copied=new s.Event,n.pasting=new s.Event,n.pasted=new s.Event,n.pastingCell=new s.Event,n.pastedCell=new s.Event,n.formatItem=new s.Event((function(){n._clearCells()})),n.updatingView=new s.Event,n.updatedView=new s.Event,n._mappedColumns=null;var o=n.hostElement;(0,s.isIE)()&&(o.style.borderRadius="0");var r=n.getTemplate();if(n.applyTemplate("wj-control wj-content wj-flexgrid",r,{_root:"root",_eSz:"sz",_eCt:"cells",_fCt:"fcells",_eTL:"tl",_eBL:"bl",_eCHdr:"ch",_eRHdr:"rh",_eCFtr:"cf",_eTLCt:"tlcells",_eBLCt:"blcells",_eCHdrCt:"chcells",_eCFtrCt:"cfcells",_eRHdrCt:"rhcells",_eMarquee:"marquee",_eFocus:"focus"}),(0,s.setCss)(n._root.parentElement,{position:"relative",left:"0",top:"0",width:"100%",height:"100%",overflow:"hidden",minWidth:"inherit",minHeight:"inherit",maxWidth:"inherit",maxHeight:"inherit"}),(0,s.setCss)(n._root,{position:"absolute",left:"0",top:"0",width:"100%",height:"100%",minWidth:"inherit",minHeight:"inherit",maxWidth:"inherit",maxHeight:"inherit",overflow:"auto",webkitOverflowScrolling:"touch"}),(0,s.setCss)(n._eCt,{position:"absolute"}),(0,s.setCss)(n._eMarquee,{display:"none"}),(0,s.setCss)(n._eMarquee.firstChild,{width:"100%",height:"100%"}),(0,s.setCss)(n._fCt,{position:"absolute",left:"0",top:"0",overflow:"hidden",pointerEvents:"none"}),(0,s.setCss)(n._eFocus,{position:"fixed",left:"-32000px"}),(0,s.setCss)(n._eSz,{position:"relative",visibility:"hidden"}),[n._eRHdr,n._eCFtr,n._eCHdr,n._eBL,n._eTL].forEach((function(e){(0,s.setAttribute)(e,"aria-hidden",!0),(0,s.setCss)(e,{position:"absolute",overflow:"hidden",outline:"none"}),(0,s.setCss)(e.firstElementChild,{position:"relative"})})),[n._eFocus,n._eMarquee,n._fCt,n._eSz].forEach((function(e){(0,s.setAttribute)(e,"aria-hidden",!0)})),(0,s.isIE9)()||(0,s.isIE10)()){var l=n._eMarquee;["click","dblclick","mousedown","mouseup"].forEach((function(e){n.addEventListener(l,e,(function(t){var i=l.style.display;l.style.display="none";var n=document.elementFromPoint(t.clientX,t.clientY);l.style.display=i;var o=document.createEvent("Event");for(var r in o.initEvent(e,!0,!0),t)try{o[r]=t[r]}catch(e){}n.dispatchEvent(o)}))}))}return o.tabIndex=-1,n.deferUpdate((function(){var e=n._getDefaultRowHeight();n._rows=new L(n,e),n._cols=new A(n,4*e),n._hdrRows=new L(n,e),n._hdrCols=new A(n,Math.round(1.25*e)),n._ftrRows=new L(n,e);var t=_;n._gpTL=new w(n,t.TopLeft,n._hdrRows,n._hdrCols,n._eTLCt),n._gpCHdr=new w(n,t.ColumnHeader,n._hdrRows,n._cols,n._eCHdrCt),n._gpRHdr=new w(n,t.RowHeader,n._rows,n._hdrCols,n._eRHdrCt),n._gpCells=new w(n,t.Cell,n._rows,n._cols,n._eCt),n._gpBL=new w(n,t.BottomLeft,n._ftrRows,n._hdrCols,n._eBLCt),n._gpCFtr=new w(n,t.ColumnFooter,n._ftrRows,n._cols,n._eCFtrCt),n._hdrRows.push(new k),n._hdrCols.push(new j({align:"center"})),n._cf=new X,n._keyHdl=new ce(n),n._mouseHdl=new pe(n),n._edtHdl=new re(n),n._selHdl=n._createSelHdl(),n._addHdl=new G(n),n._grpHdl=new z(n),n._mrgMgr=new q,n._bndSortConverter=n._sortConverter.bind(n),n._errorTip=new s.Tooltip({isContentHtml:!1,showDelay:0,cssClass:"wj-error-tip"}),(0,s.setAttribute)(n.cells.hostElement,"role","grid"),n.selectionMode=v.CellRange,n._root.tabIndex=-1,n.initialize(i)})),n.addEventListener(n._root,"scroll",(function(e){if(n._updateScrollPosition()||n._forceScrollUpdate){var t=n.activeEditor,i=n.activeCell,o=i?i.className:null;n._forceScrollUpdate||n.finishEditing(),n._forceScrollUpdate=!1,n._updateContent(!0);var r=n.activeEditor,s=n.activeCell;r&&s&&t&&o?(r.value=t.value,s.className=o,n._setFocusNoScroll(r)):r&&!s&&n.finishEditing(!0),n.frozenColumns&&setTimeout((function(){var e=n.columnHeaders.hostElement.style,t=parseInt(e.left),i=n._ptScrl.x;Math.abs(t-i)>1&&n.invalidate()}))}})),n.addEventListener(o,"focus",(function(e){if(o.tabIndex>-1){var t=e.target;t instanceof HTMLElement&&t.tabIndex<0&&n._setFocus(!0)}}),!0),n}return h(t,e),t.prototype._handleResize=function(){var t=this;this._rcBounds=null,this.activeEditor&&this.isTouching||this._touchEdit?setTimeout((function(){t.activeEditor||(t._touchEdit=!0,t.startEditing(!0))}),50):e.prototype._handleResize.call(this),this._touchEdit=!1},Object.defineProperty(t.prototype,"headersVisibility",{get:function(){return this._hdrVis},set:function(e){(e=(0,s.asEnum)(e,R))!=this._hdrVis&&(this._hdrVis=e,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stickyHeaders",{get:function(){return this._stickyHdr},set:function(e){e!=this._stickyHdr&&(this._stickyHdr=(0,s.asBoolean)(e),this._updateStickyHeaders(),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preserveSelectedState",{get:function(){return this._pSel},set:function(e){this._pSel=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preserveOutlineState",{get:function(){return this._pOutline},set:function(e){this._pOutline=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchorCursor",{get:function(){return this._anchorCursor},set:function(e){this._anchorCursor=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"copyHeaders",{get:function(){return this._copyHeaders},set:function(e){this._copyHeaders=(0,s.asEnum)(e,R)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lazyRender",{get:function(){return this._lazyRender},set:function(e){this._lazyRender=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"refreshOnEdit",{get:function(){return this._refreshOnEdit},set:function(e){this._refreshOnEdit=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"virtualizationThreshold",{get:function(){return this._vt},set:function(e){this._vt=e,(0,s.isNumber)(e)?this._vtRows=this._vtCols=(0,s.asNumber)(e):e?(0,s.isArray)(e)&&2==e.length?(this._vtRows=(0,s.asNumber)(e[0]),this._vtCols=(0,s.asNumber)(e[1])):(0,s.assert)(!1,"virtualizationThreshold should be a number or an array with two numbers."):this._vtRows=this._vtCols=0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoGenerateColumns",{get:function(){return this._autoGenCols},set:function(e){this._autoGenCols=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoClipboard",{get:function(){return this._autoClipboard},set:function(e){this._autoClipboard=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"expandSelectionOnCopyPaste",{get:function(){return this._xOnCopyPaste},set:function(e){this._xOnCopyPaste=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoScroll",{get:function(){return this._autoScroll},set:function(e){this._autoScroll=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoSearch",{get:function(){return this._autoSearch},set:function(e){this._autoSearch=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"caseSensitiveSearch",{get:function(){return this._caseSensitive},set:function(e){this._caseSensitive=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnLayout",{get:function(){var e,i=this._hasColumnGroups(),n=i?B:j,o=i?"columnGroups":"columns",r=t._getSerializableProperties(n),l=i?["collapseTo"]:[],a=["size"],h=new n,c=i?this.getColumnGroups():this.columns,u=function(e){var t=[];return e.forEach((function(e){var n={};if(r.forEach((function(t){var i=e[t];(function(e,t){return t!=h[e]&&a.indexOf(e)<0&&((0,s.isPrimitive)(t)||l.indexOf(e)>-1)})(t,i)&&(n[t]=i)})),i){var o=e.columns;o.length&&(n.columns=u(o))}t.push(n)})),t},d=u(c);return JSON.stringify(((e={})[o]=d,e))},set:function(e){var t=this,i=JSON.parse((0,s.asString)(e));(0,s.assert)(i,"Invalid columnLayout data."),this.columns.deferUpdate((function(){t.columns.clear(),t._hasColumnGroups()&&(t.columnGroups=new F),t.initialize(i)}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnGroups",{get:function(){return this._grpHdl.getGroupDefinitions()},set:function(e){this.columns.clear(),this._grpHdl.createColumnGroups((0,s.asArray)(e))},enumerable:!0,configurable:!0}),t.prototype.getColumnGroups=function(){return this._grpHdl.columnGroups},Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(e){e!=this._readOnly&&(this._readOnly=(0,s.asBoolean)(e),this.finishEditing(),this.invalidate(!0),this._addHdl.updateNewRowTemplate(),(0,s.toggleClass)(this.hostElement,"wj-state-readonly",this.isReadOnly),this._setAria("readonly",this.isReadOnly?"true":null))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bigCheckboxes",{get:function(){return this._bigChecks},set:function(e){this._bigChecks=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDisabled",{get:function(){return this._e&&null!=this._e.getAttribute("disabled")},set:function(e){if((e=(0,s.asBoolean)(e,!0))!=this.isDisabled){var t=this._e;t&&((0,s.enable)(t,!e),this._updateTabIndex(),this.invalidate())}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imeEnabled",{get:function(){return null!=this._imeHdl},set:function(e){if((0,s.asBoolean)(e)!=this.imeEnabled&&this.finishEditing()){var t=this.containsFocus();this._imeHdl&&(this._imeHdl.dispose(),this._imeHdl=null),e&&(this._imeHdl=new K(this)),t&&this.focus()}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowResizing",{get:function(){return this._alResizing},set:function(e){this._alResizing=(0,s.asEnum)(e,le)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deferResizing",{get:function(){return this._deferResizing},set:function(e){this._deferResizing=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoSizeMode",{get:function(){return this._autoSizeMode},set:function(e){this._autoSizeMode=(0,s.asEnum)(e,ae)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoRowHeights",{get:function(){return this._autoHeights},set:function(e){this._autoHeights=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"quickAutoSize",{get:function(){return this._quickSize},set:function(e){this._quickSize=(0,s.asBoolean)(e,!0)},enumerable:!0,configurable:!0}),t.prototype._getQuickAutoSize=function(){return(0,s.isBoolean)(this._quickSize)?this._quickSize:!this.formatItem.hasHandlers&&null==this.itemFormatter},Object.defineProperty(t.prototype,"allowSorting",{get:function(){return this._alSorting},set:function(e){(0,s.isBoolean)(e)&&(e=e?P.SingleColumn:P.None),this._alSorting=(0,s.asEnum)(e,P)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowPinning",{get:function(){return this._alPinning},set:function(e){e!=this._alPinning&&((0,s.isBoolean)(e)&&(e=e?I.SingleColumn:I.None),this._alPinning=(0,s.asEnum)(e,I),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowAddNew",{get:function(){return this._alAddNew},set:function(e){e!=this._alAddNew&&(this._alAddNew=(0,s.asBoolean)(e),this._addHdl.updateNewRowTemplate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"newRowAtTop",{get:function(){return this._addHdl.newRowAtTop},set:function(e){this._addHdl.newRowAtTop=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowDelete",{get:function(){return this._alDelete},set:function(e){e!=this._alDelete&&(this._alDelete=(0,s.asBoolean)(e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowMerging",{get:function(){return this._alMerging},set:function(e){(e=(0,s.asEnum)(e,V))!=this._alMerging&&(this._alMerging=e,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showSelectedHeaders",{get:function(){return this._ssHdr},set:function(e){(e=(0,s.asEnum)(e,R))!=this._ssHdr&&(this._ssHdr=e,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showMarquee",{get:function(){return this._shMarquee},set:function(e){e!=this._shMarquee&&(this._shMarquee=(0,s.asBoolean)(e),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showPlaceholders",{get:function(){return this._shPlcHld},set:function(e){this._shPlcHld=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showSort",{get:function(){return this._shSort},set:function(e){e!=this._shSort&&(this._shSort=(0,s.asBoolean)(e),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showGroups",{get:function(){return this._shGroups},set:function(e){e!=this._shGroups&&(this._shGroups=(0,s.asBoolean)(e),this._bindGrid(!1))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alternatingRowStep",{get:function(){return this._altStep},set:function(e){e!=this._altStep&&(this._altStep=(0,s.asInt)(e,!1,!0),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showAlternatingRows",{get:function(){return this._altStep>0},set:function(e){(0,s._deprecated)("showAlternatingRows","alternatingRowStep"),this.alternatingRowStep=e?1:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showErrors",{get:function(){return this._shErr},set:function(e){e!=this._shErr&&(this._clearCells(),this._shErr=(0,s.asBoolean)(e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorTip",{get:function(){return this._errorTip},set:function(e){e!=this._errorTip&&(this._clearCells(),this._errorTip=(0,s.asType)(e,s.Tooltip,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemValidator",{get:function(){return this._itemValidator},set:function(e){e!=this.itemValidator&&(this._itemValidator=(0,s.asFunction)(e),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"validateEdits",{get:function(){return this._valEdt},set:function(e){this._valEdt=(0,s.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groupHeaderFormat",{get:function(){return this._gHdrFmt},set:function(e){e!=this._gHdrFmt&&(this._gHdrFmt=(0,s.asString)(e),this._bindGrid(!1))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowDragging",{get:function(){return this._alDragging},set:function(e){(e=(0,s.asEnum)(e,he))!=this._alDragging&&(this._alDragging=e,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemsSource",{get:function(){return this._items},set:function(e){var t=this;if(e!=this._items){var i=new s.CancelEventArgs;if(this.onItemsSourceChanging(i)){var n;if(this._cv&&((n=this._cv).currentChanged.removeHandler(null,this),n.collectionChanged.removeHandler(null,this),n instanceof s.CollectionView&&n.sortConverter==this._bndSortConverter&&(n.sortConverter=null),this._cv=null),this._items=e,this._cv=this._getCollectionView(e),this._lastCount=0,this._cv)(n=this._cv).currentChanged.addHandler((function(e,i){return t._cvCurrentChanged(e,i)}),this),n.collectionChanged.addHandler((function(e,i){return t._cvCollectionChanged(e,i)}),this),n instanceof s.CollectionView&&!n.sortConverter&&(n.sortConverter=this._bndSortConverter);this._isISChanging=!0,this._bindGrid(!0),this._isISChanging=!1,this.onItemsSourceChanged(i)}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editableCollectionView",{get:function(){return(0,s.tryCast)(this._cv,"IEditableCollectionView")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childItemsPath",{get:function(){return this._childItemsPath},set:function(e){e!=this._childItemsPath&&((0,s.assert)(null==e||(0,s.isArray)(e)||(0,s.isString)(e),"childItemsPath should be an array or a string."),this._childItemsPath=e,this._bindGrid(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowHeaderPath",{get:function(){return this._rowHdrPath?this._rowHdrPath.path:null},set:function(e){e!=this.rowHeaderPath&&(e=(0,s.asString)(e),this._rowHdrPath=e?new s.Binding(e):null,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cells",{get:function(){return this._gpCells},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnHeaders",{get:function(){return this._gpCHdr},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnFooters",{get:function(){return this._gpCFtr},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowHeaders",{get:function(){return this._gpRHdr},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeftCells",{get:function(){return this._gpTL},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomLeftCells",{get:function(){return this._gpBL},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this._cols},enumerable:!0,configurable:!0}),t.prototype.getColumn=function(e,t){if(this._hasColumnGroups()&&t){var i=this.getColumnGroups();return null!==i?i.getColumn(e):null}return this.columns.getColumn(e)},Object.defineProperty(t.prototype,"frozenRows",{get:function(){return this.rows.frozen},set:function(e){this.rows.frozen=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"frozenColumns",{get:function(){return this.columns.frozen},set:function(e){this.columns.frozen=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cloneFrozenCells",{get:function(){return this._fzClone},set:function(e){e!=this._fzClone&&((0,s.setText)(this._fCt,null),this._fzClone=(0,s.asBoolean)(e,!0),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sortRowIndex",{get:function(){return this._sortRowIndex},set:function(e){e!=this._sortRowIndex&&(this._sortRowIndex=(0,s.asNumber)(e,!0),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editColumnIndex",{get:function(){return this._editColIndex},set:function(e){e!=this._editColIndex&&(this._editColIndex=(0,s.asNumber)(e,!0),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scrollPosition",{get:function(){return this._ptScrl.clone()},set:function(e){var i=this._root,n=-e.x;if(this.rightToLeft)switch(t._getRtlMode()){case"rev":n=i.scrollWidth-i.clientWidth+e.x;break;case"neg":n=e.x;break;default:n=-e.x}i.scrollLeft=n,i.scrollTop=-e.y,this._updateScrollPosition()&&(this._forceScrollUpdate=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clientSize",{get:function(){return this._szClient},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"controlRect",{get:function(){return this._rcBounds||(this._rcBounds=(0,s.getElementRect)(this._root)),this._rcBounds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scrollSize",{get:function(){return new s.Size(this._gpCells.width,this._heightBrowser)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewRange",{get:function(){return this._gpCells.viewRange},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellFactory",{get:function(){return this._cf},set:function(e){e!=this._cf&&(this._clearCells(),this._cf=(0,s.asType)(e,X,!1))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemFormatter",{get:function(){return this._itemFormatter},set:function(e){e!=this._itemFormatter&&(this._clearCells(),this._itemFormatter=(0,s.asFunction)(e))},enumerable:!0,configurable:!0}),t.prototype.canEditCell=function(e,t){return this._edtHdl._allowEdit(e,t)},t.prototype.getCellData=function(e,t,i){return this.cells.getCellData(e,t,i)},t.prototype.getCellBoundingRect=function(e,t,i){return this.cells.getCellBoundingRect(e,t,i)},t.prototype.setCellData=function(e,t,i,n,o){return void 0===n&&(n=!0),void 0===o&&(o=!0),this.cells.setCellData(e,t,i,n,o)},t.prototype.hitTest=function(e,t){return(0,s.isNumber)(e)&&(0,s.isNumber)(t)&&(e=new s.Point(e,t)),(0,s.isBoolean)(t)&&t&&(this._rcBounds=null),new U(this,e)},t.prototype.getClipString=function(e,t,i,n){var o;o=null==t||(0,s.isBoolean)(t)?t?T.CSV:T.Default:t,(0,s.assert)((0,s.isNumber)(o),"Unexpected value for ClipStringOptions parameter.");var r=this.selection,l=this.getMergedRange(this.cells,r.row,r.col,!1);return l&&(l.columnSpan>1||l.rowSpan>1)&&(o|=T.SkipMerged),this._edtHdl.getClipString(e,o,i,n)},t.prototype.setClipString=function(e,t){this._edtHdl.setClipString(e,t)},t.prototype.focus=function(e){this.isDisabled||this._setFocus(e)},t.prototype.dispose=function(){this.finishEditing(!0),this.itemsSource=null,e.prototype.dispose.call(this)},t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this.finishEditing(),t&&(this._updateColumnTypes(),this.scrollPosition=this._ptScrl,this._updateDefaultSizes(),clearTimeout(this._toInv),this._toInv=null),this.refreshCells(t);var i=this._e;i&&(this._szCtl=new s.Size(i.offsetWidth,i.offsetHeight))},t.prototype.refreshCells=function(e,t,i){this.isUpdating||(e?this._updateLayout():this._updateContent(t,i))},t.prototype.refreshRange=function(e){for(var t=e.topRow;t<=e.bottomRow;t++)for(var i=e.leftCol;i<=e.rightCol;i++){var n=this.cells.getCellElement(t,i);if(n){var o=n[w._INDEX_KEY];this.cellFactory.updateCell(this.cells,t,i,n,o.rng)}}},t.prototype.autoSizeColumn=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=4),this.autoSizeColumns(e,e,t,i)},t.prototype.autoSizeColumns=function(e,i,n,o){var r=this;void 0===n&&(n=!1),void 0===o&&(o=4);var l=0,a=n?this.topLeftCells:this.columnHeaders,h=n?this.bottomLeftCells:this.columnFooters,c=n?this.rowHeaders:this.cells,u=this.viewRange;e=null==e?0:(0,s.asInt)(e),i=null==i?c.columns.length-1:(0,s.asInt)(i),u.row=Math.max(0,u.row-1e3),u.row2=Math.min(u.row2+1e3,this.rows.length-1),this.finishEditing()&&this.columns.deferUpdate((function(){(0,s.setCss)(r._eCt,{width:r._gpCells.width});for(var n=(0,s.createElement)("<div "+t._WJS_MEASURE+'="true"/>',c.hostElement,{visibility:"hidden"}),d=r._getCanvasContext(),p=e;p<=i&&p>-1&&p<c.columns.length;p++){var f=c.columns[p];if(f.isVisible){if(l=0,r.autoSizeMode&ae.Headers){for(var _=0;_<a.rows.length;_++)a.rows[_].isVisible&&(l=Math.max(r._getDesiredWidth(a,_,p,n),l));for(_=0;_<h.rows.length;_++)h.rows[_].isVisible&&(l=Math.max(r._getDesiredWidth(h,_,p,n),l))}if(r.autoSizeMode&ae.Cells&&u.row>-1&&u.row2>-1)if(f._getQuickAutoSize())_=r._getWidestRow(c,u,p,d),l=Math.max(r._getDesiredWidth(c,_,p,n),l);else for(_=u.row;_<=u.row2&&_<c.rows.length;_++)c.rows[_].isVisible&&(l=Math.max(r._getDesiredWidth(c,_,p,n),l));l>0&&(f.width=l+o+2)}}r.cellFactory.disposeCell(n),(0,s.removeChild)(n)}))},t.prototype.autoSizeRow=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=0),this.autoSizeRows(e,e,t,i)},t.prototype.autoSizeRows=function(e,i,n,o){var r=this;void 0===n&&(n=!1),void 0===o&&(o=0);var l=0,a=1==n?this.topLeftCells:null==n?this.bottomLeftCells:this.rowHeaders,h=1==n?this.columnHeaders:null==n?this.columnFooters:this.cells;if(o=(0,s.asNumber)(o),e=null==e?0:(0,s.asInt)(e),(i=null==i?h.rows.length-1:(0,s.asInt)(i))>=e&&this.finishEditing()){(0,s.setCss)(this._eCt,{width:this._gpCells.width});var c=(0,s.createElement)("<div "+t._WJS_MEASURE+'="true"/>',h.hostElement,{visibility:"hidden"});this.rows.deferUpdate((function(){for(var t={},n=r._autoSizeMode,s=ae,u=e;u<=i&&u>-1&&u<h.rows.length;u++)h.rows[u].isVisible&&(l=0,n&s.Headers&&(l=r._getDesiredRowHeight(a,u,c,t)),n&s.Cells&&(l=Math.max(r._getDesiredRowHeight(h,u,c,t),l)),l>0&&(h.rows[u].height=l+o))})),this.cellFactory.disposeCell(c),(0,s.removeChild)(c)}},Object.defineProperty(t.prototype,"treeIndent",{get:function(){return this._indent},set:function(e){e!=this._indent&&(this._indent=(0,s.asNumber)(e,!1,!0),this.columns.onCollectionChanged())},enumerable:!0,configurable:!0}),t.prototype.collapseGroupsToLevel=function(e){var t=this;this.finishEditing()&&this.deferUpdate((function(){var i=t.rows;i.deferUpdate((function(){for(var t=0;t<i.length;t++){var n=i[t];n instanceof M&&(n.isCollapsed=n.level>=e)}}))}))},Object.defineProperty(t.prototype,"selectionMode",{get:function(){return this._selHdl.selectionMode},set:function(e){(e=(0,s.asEnum)(e,v))!=this.selectionMode&&(this._selHdl.selectionMode=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selection",{get:function(){return this._selHdl.selection.clone()},set:function(e){this._selHdl.selection=e},enumerable:!0,configurable:!0}),t.prototype.select=function(e,t){return void 0===t&&(t=!0),this._selHdl.select(e,t)},t.prototype.selectAll=function(){var e=this.rows.length,t=this.columns.length;return!(!e||!t)&&this.select(new m(0,0,e-1,t-1),!1)},t.prototype.getSelectedState=function(e,t){return this.cells.getSelectedState(e,t)},Object.defineProperty(t.prototype,"selectedRows",{get:function(){var e=this,t=this.selectionMode,i=this.rows.filter((function(e){return e.isSelected}));if(0==i.length&&t!=v.None){var n=[];this.selectedRanges.forEach((function(t){for(var i=t.topRow;i<=t.bottomRow&&i>-1&&i<e.rows.length;i++)n.indexOf(i)<0&&n.push(i)})),n.sort(),i=n.map((function(t){return e.rows[t]}))}return i},set:function(e){var t=this;(0,s.assert)(this.selectionMode==v.ListBox,"This property can be set only in ListBox mode."),e=(0,s.asArray)(e),this.deferUpdate((function(){for(var i=0,n=!0;i<t.rows.length;i++){var o=t.rows[i],r=e&&e.indexOf(o)>-1;r&&n&&(n=!1,t.select(i,t.selection.col)),o.isSelected=r}}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedItems",{get:function(){var e=[];return this.selectedRows.forEach((function(t){var i=t?t.dataItem:null;i&&e.indexOf(i)<0&&e.push(i)})),e},set:function(e){var t=this;(0,s.assert)(this.selectionMode==v.ListBox,"This property can be set only in ListBox mode."),e=(0,s.asArray)(e),this.deferUpdate((function(){for(var i=0,n=!0;i<t.rows.length;i++){var o=t.rows[i],r=e&&e.indexOf(o.dataItem)>-1;r&&n&&(n=!1,t.select(i,t.selection.col)),o.isSelected=r}}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedRanges",{get:function(){var e=[this.selection];return this._selHdl.extendedSelection.forEach((function(t){e.push(t)})),e},set:function(e){if((e=(0,s.asArray)(e))&&e.length>0&&(this.select(e[0]),this.selectionMode==v.MultiRange)){var t=this._selHdl.extendedSelection;t.deferUpdate((function(){t.clear();for(var i=1;i<e.length;i++)t.push(e[i])}))}},enumerable:!0,configurable:!0}),t.prototype.scrollIntoView=function(e,t,i){(null==this._maxOffsetY||this._rows._dirty||this._cols._dirty)&&this._updateLayout();var n=this.scrollPosition,o=this._szClient,r=o.width,l=o.height-this._gpCFtr.rows.getTotalSize(),a=this.cells._getFrozenPos();if((e=(0,s.asInt)(e))>-1&&e<this._rows.length&&e>=this._rows.frozen){var h=this._rows[e],c=this._getCssPage(h.pos);if(c!=this._cssPage){for(var u=this._maxOffsetY,d=Math.round(u*c);d>h.pos;c-=.1)d=Math.round(u*c);this._offsetY=d}var p=h.pos-this._offsetY,f=p+h.renderSize;f>l-n.y&&(n.y=Math.max(-p,l-f)),p-a.y<-n.y&&(n.y=-(p-a.y)),c!=this._cssPage&&(this._cssPage=this._getCssPage(-n.y))}if((0,s.isString)(t)&&(t=this.columns.indexOf(t)),(t=(0,s.asInt)(t))>-1&&t<this._cols.length&&t>=this._cols.frozen){var _=this._cols[t],g=_.pos+_.renderSize;g>-n.x+r&&(n.x=Math.max(-_.pos,r-g)),_.pos-a.x<-n.x&&(n.x=-(_.pos-a.x))}if(!n.equals(this._ptScrl))return this.scrollPosition=n,i&&(this._updateScrollPosition(),this._forceScrollUpdate=!1,this.refresh()),!0;if(this._activeCell&&e>-1&&t>-1){var m=this._root,v=m.scrollWidth==m.clientWidth,b=m.scrollHeight==m.clientHeight;if(v||b){var y=this._activeCell.getBoundingClientRect(),w=innerWidth,C=innerHeight,x=y.right<0||y.left>w,E=y.bottom<0||y.top>C;n.x=pageXOffset+(y.left<0?y.left:y.right>w?y.right-w:0),n.y=pageYOffset+(y.top<0?y.top:y.bottom>C?y.bottom-C:0),x&&v&&E&&b?scrollTo(n.x,n.y):x&&v?scrollTo(n.x,document.documentElement.scrollLeft):E&&b&&scrollTo(document.documentElement.scrollTop,n.y)}}return!1},t.prototype.isRangeValid=function(e){return e&&e.isValid&&e.bottomRow<this.rows.length&&e.rightCol<this.columns.length},t.prototype.startEditing=function(e,t,i,n,o){return void 0===e&&(e=!0),this._edtHdl.startEditing(e,t,i,n,o)},t.prototype.finishEditing=function(e){return this._edtHdl.finishEditing(e)},Object.defineProperty(t.prototype,"activeCell",{get:function(){return this._activeCell},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activeEditor",{get:function(){var e=this._edtHdl;return e?e.activeEditor:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editRange",{get:function(){var e=this._edtHdl.editRange;return e?e.clone():null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mergeManager",{get:function(){return this._mrgMgr},set:function(e){e!=this._mrgMgr&&(this._mrgMgr=(0,s.asType)(e,q,!0),this.invalidate())},enumerable:!0,configurable:!0}),t.prototype.getMergedRange=function(e,t,i,n){return void 0===n&&(n=!0),this._mrgMgr?this._mrgMgr.getMergedRange(e,t,i,n):null},Object.defineProperty(t.prototype,"keyActionTab",{get:function(){return this._keyHdl._kaTab},set:function(e){this._keyHdl._kaTab=(0,s.asEnum)(e,oe)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keyActionEnter",{get:function(){return this._keyHdl._kaEnter},set:function(e){this._keyHdl._kaEnter=(0,s.asEnum)(e,oe)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preserveWhiteSpace",{get:function(){return(0,s.hasClass)(this.hostElement,t._WJS_WSPRE)},set:function(e){(0,s.toggleClass)(this.hostElement,t._WJS_WSPRE,(0,s.asBoolean)(e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showDropDown",{get:function(){return this._shDropDown},set:function(e){e!=this._shDropDown&&(this._shDropDown=(0,s.asBoolean)(e,!0),this.invalidate())},enumerable:!0,configurable:!0}),t.prototype.toggleDropDownList=function(){return this._tglDropDown||(this._tglDropDown=!0,this._edtHdl._toggleListBox(null),this._tglDropDown=!1),null!=this._edtHdl._lbx},Object.defineProperty(t,"defaultTypeWidth",{get:function(){return t._defTypeWidth},enumerable:!0,configurable:!0}),t.prototype.onItemsSourceChanging=function(e){return this.itemsSourceChanging.raise(this,e),!e.cancel},t.prototype.onItemsSourceChanged=function(e){this.itemsSourceChanged.raise(this,e)},t.prototype.onScrollPositionChanged=function(e){this.scrollPositionChanged.raise(this,e)},t.prototype.onSelectionChanging=function(e){return this.selectionChanging.raise(this,e),!e.cancel},t.prototype.onSelectionChanged=function(e){this.selectionChanged.raise(this,e)},t.prototype.onLoadingRows=function(e){return this.loadingRows.raise(this,e),!e.cancel},t.prototype.onLoadedRows=function(e){this.loadedRows.raise(this,e),this._autoRowHeights()},t.prototype.onUpdatingLayout=function(e){return this.updatingLayout.raise(this,e),!e.cancel},t.prototype.onUpdatedLayout=function(e){this.updatedLayout.raise(this,e)},t.prototype.onResizingColumn=function(e){return this.resizingColumn.raise(this,e),!e.cancel},t.prototype.onResizedColumn=function(e){this.resizedColumn.raise(this,e),this._autoRowHeights()},t.prototype.onAutoSizingColumn=function(e){return this.autoSizingColumn.raise(this,e),!e.cancel},t.prototype.onAutoSizedColumn=function(e){this.autoSizedColumn.raise(this,e)},t.prototype.onStarSizedColumns=function(e){this.starSizedColumns.raise(this,e),this._autoRowHeights()},t.prototype.onDraggingColumn=function(e){return this.draggingColumn.raise(this,e),!e.cancel},t.prototype.onDraggingColumnOver=function(e){return this.draggingColumnOver.raise(this,e),!e.cancel},t.prototype.onDraggedColumn=function(e){this.draggedColumn.raise(this,e)},t.prototype.onPinningColumn=function(e){return this.pinningColumn.raise(this,e),!e.cancel},t.prototype.onPinnedColumn=function(e){this.pinnedColumn.raise(this,e)},t.prototype.onResizingRow=function(e){return this.resizingRow.raise(this,e),!e.cancel},t.prototype.onResizedRow=function(e){this.resizedRow.raise(this,e)},t.prototype.onAutoSizingRow=function(e){return this.autoSizingRow.raise(this,e),!e.cancel},t.prototype.onAutoSizedRow=function(e){this.autoSizedRow.raise(this,e)},t.prototype.onDraggingRow=function(e){return this.draggingRow.raise(this,e),!e.cancel},t.prototype.onDraggingRowOver=function(e){return this.draggingRowOver.raise(this,e),!e.cancel},t.prototype.onDraggedRow=function(e){this.draggedRow.raise(this,e)},t.prototype.onGroupCollapsedChanging=function(e){return this.groupCollapsedChanging.raise(this,e),!e.cancel},t.prototype.onGroupCollapsedChanged=function(e){this.groupCollapsedChanged.raise(this,e)},t.prototype.onColumnGroupCollapsedChanging=function(e){return this.columnGroupCollapsedChanging.raise(this,e),!e.cancel},t.prototype.onColumnGroupCollapsedChanged=function(e){this.columnGroupCollapsedChanged.raise(this,e)},t.prototype.onSortingColumn=function(e){return this.sortingColumn.raise(this,e),!e.cancel},t.prototype.onSortedColumn=function(e){this.sortedColumn.raise(this,e)},t.prototype.onBeginningEdit=function(e){return this._addHdl._beginningEdit(this,e),e.cancel||this.beginningEdit.raise(this,e),!e.cancel},t.prototype.onPrepareCellForEdit=function(e){this.prepareCellForEdit.raise(this,e)},t.prototype.onCellEditEnding=function(e){return this.cellEditEnding.raise(this,e),!e.cancel&&!e.stayInEditMode},t.prototype.onCellEditEnded=function(e){this.cellEditEnded.raise(this,e),this._autoRowHeights()},t.prototype.onRowEditStarting=function(e){return this._addHdl._rowEditStarting(this,e),e.cancel||this.rowEditStarting.raise(this,e),!e.cancel},t.prototype.onRowEditStarted=function(e){this.rowEditStarted.raise(this,e)},t.prototype.onRowEditEnding=function(e){this._addHdl._rowEditEnding(this,e),this.rowEditEnding.raise(this,e)},t.prototype.onRowEditEnded=function(e){this.rowEditEnded.raise(this,e),this._addHdl._rowEditEnded(this,e),this._autoRowHeights()},t.prototype.onRowAdded=function(e){return this.rowAdded.raise(this,e),!e.cancel},t.prototype.onDeletingRow=function(e){return this.deletingRow.raise(this,e),!e.cancel},t.prototype.onDeletedRow=function(e){this.deletedRow.raise(this,e)},t.prototype.onCopying=function(e){return this.copying.raise(this,e),!e.cancel},t.prototype.onCopied=function(e){this.copied.raise(this,e)},t.prototype.onPasting=function(e){return this.pasting.raise(this,e),!e.cancel},t.prototype.onPasted=function(e){this.pasted.raise(this,e)},t.prototype.onPastingCell=function(e){return this.pastingCell.raise(this,e),!e.cancel},t.prototype.onPastedCell=function(e){this.pastedCell.raise(this,e)},t.prototype.onFormatItem=function(e){this.formatItem.raise(this,e)},t.prototype.onUpdatingView=function(e){return this.updatingView.raise(this,e),!e.cancel},t.prototype.onUpdatedView=function(e){this.updatedView.raise(this,e)},t.prototype._createSelHdl=function(){return new D(this)},t.prototype._getTabIndex=function(){return this._orgTabIndex},t.prototype._setTabOrder=function(e){this._orgTabIndex=e,this._updateTabIndex()},t.prototype._updateTabIndex=function(){var e=this.isDisabled?-1:this._orgTabIndex,t=this._imeHdl;t&&t._updateImeFocus();var i=this._activeCell,n=this._eFocus;i?(i.tabIndex=e,n.tabIndex=-1):n.tabIndex=e},t.prototype._autoRowHeights=function(){var e=this;this._autoHeights&&(this.rows.length>100&&[this.columnHeaders,this.rowHeaders].forEach((function(e){e._updateContent(!0,!1,e._getOffsetY())})),clearTimeout(this._toAutoHeights),this._toAutoHeights=setTimeout((function(){e._toAutoHeights=null,e.editRange||e._autoSizeRows()}),s.Control._REFRESH_INTERVAL))},t.prototype._autoSizeRows=function(){var e=this.autoSizeMode,t=ae;e&t.Headers&&(this._autoSizeMode=t.Both,this.autoSizeRows(0,this.columnHeaders.rows.length-1,!0),this._autoSizeMode=e),e&t.Cells&&this.autoSizeRows()},t.prototype._getShowErrors=function(){return this.showErrors&&this._hasValidation},t.prototype._getHasValidation=function(){return this._hasValidation},t.prototype._getError=function(e,t,i,n){if((0,s.isFunction)(this.itemValidator)){if(e==this.cells)return this.itemValidator(t,i,n);if(e==this.rowHeaders)for(i=0;i<this.columns.length;i++)if(c=this.itemValidator(t,i,n))return c}var o=this._cv,r=o?o.getError:null;if((0,s.isFunction)(r)){var l=e.rows,a=this.columns,h=l[t].dataItem;if(h&&!(h instanceof s.CollectionViewGroup))if(e==this.cells)for(;t<l.length&&l[t].dataItem==h;t++)return r(h,this._getBindingColumn(this.cells,t,a[i]).binding,n);else if(e==this.rowHeaders){var c;if(!(c=r(h,null,!1))){for(var u=[];t<l.length&&l[t].dataItem==h;t++)for(i=0;i<a.length;i++)(c=r(h,this._getBindingColumn(this.cells,t,a[i]).binding,!1))&&u.indexOf(c)<0&&u.push(c);if(u.length){var d=this.errorTip,p=!!d&&d.isContentHtml;c=u.join(p?"<br/>":"\n")}}return c}}return null},t.prototype._setAria=function(e,t){(0,s.setAttribute)(this.cells.hostElement,"aria-"+e,t)},t.prototype._setFocus=function(e){if(this.hostElement&&(e||!this.containsFocus())){var t=(0,s.getActiveElement)(),i=this.activeEditor,n=this._activeCell,o=this._eFocus,r=this._root,l=this._getTabIndex();i?(0,s.contains)(i,t)||(i.focus(),o.tabIndex=-1):n?(0,s.contains)(n,t)||t==this._root||((0,s.isIE)()&&(0,s.hasClass)(n,"wj-group")&&(n=n.querySelector("."+X._WJC_COLLAPSE)||n),n.tabIndex=l,this._setFocusNoScroll(n),o.tabIndex=-1):(0,s.contains)(o,t)||t==r||(o.tabIndex=l,this._setFocusNoScroll(o)),this.containsFocus()||(o.tabIndex=l,this._setFocusNoScroll(o))}},t.prototype._setFocusNoScroll=function(e){if((0,s.getActiveElement)()!=e){if((0,s.supportsFocusOptions)())e.focus({preventScroll:!0});else{var t=this.scrollPosition,i=e.style,n=i.position;i.position="fixed",e.focus(),i.position=n,this.scrollPosition=t}this._fixScroll()}},t.prototype._updateDefaultSizes=function(){var e=this._getDefaultRowHeight();return this._rows._setDefaultSize(e),this._cols._setDefaultSize(4*e),this._hdrRows._setDefaultSize(e),this._hdrCols._setDefaultSize(Math.round(1.25*e)),this._ftrRows._setDefaultSize(e),e},t.prototype._getDefaultRowHeight=function(){var e=this.hostElement,t=this._eFocus,i=null;t.offsetHeight||(i=(0,s.createElement)('<div><div class="wj-cell">0</div></div>',document.body),e&&i.setAttribute("class",e.getAttribute("class")),t=i.children[0]);var n=t.offsetHeight;return(isNaN(n)||n<=6)&&(n=28),(0,s.removeChild)(i),n},t.prototype._getCollectionView=function(e){return(0,s.asCollectionView)(e)},t.prototype._getCanvasContext=function(){var e=document.createElement("canvas").getContext("2d"),t=getComputedStyle(this.hostElement);return e.font=t.fontSize+" "+t.fontFamily.split(",")[0],e},t.prototype._getWidestRow=function(e,t,i,n){for(var o=0,r=0,l=1===this._getRowsPerItem()&&e.columns[i].dataType==s.DataType.Boolean,a=t.row;a<=t.row2;a++)if(e.rows[a].isVisible){var h=e.getCellData(a,i,!0),c=n.measureText(h).width,u=this.getMergedRange(e,a,i,!1);if(u&&u.columnSpan>1&&(c/=u.columnSpan),c>r&&(r=c,o=a),l)break;a+=u?u.rowSpan-1:0}return o},t.prototype._getDesiredWidth=function(e,t,i,n){var o=this.getMergedRange(e,t,i,!1),r=n.style;return this.cellFactory.updateCell(e,t,i,n,o),r.width=r.top=r.left="",n.offsetWidth/(o&&o.columnSpan>1?o.columnSpan:1)},t.prototype._getDesiredHeight=function(e,t,i,n){var o=n.style,r=this.getMergedRange(e,t,i,!1),s=r?r.rowSpan:1;return this.cellFactory.updateCell(e,t,i,n,r),n.innerHTML.trim()||(n.innerHTML="&nbsp;"),o.height=o.top=o.left="",n.offsetHeight/s},t.prototype._getDesiredRowHeight=function(e,t,i,n){for(var o=0,r=(e.rows[t],this._getQuickAutoSize()),s=0;s<e.columns.length;s++)if(e.columns[s].isVisible){var l=this.getMergedRange(e,t,s,!1),a=void 0;if(r){var h={ct:e.cellType,col:s,spr:l&&l.rowSpan>1?l.rowSpan:1,spc:l&&l.columnSpan>1?l.columnSpan:1,data:e.getCellData(t,s,!0)||"1"},c=JSON.stringify(h);null==(a=n[c])&&(a=this._getDesiredHeight(e,t,s,i),n[c]=a)}else a=this._getDesiredHeight(e,t,s,i);o=Math.max(a,o),s+=l?l.columnSpan-1:0}return o},t.prototype._getSortRowIndex=function(){return null!=this._sortRowIndex?this._sortRowIndex:this.columnHeaders.rows.length-1},t.prototype._getDeleteColumnIndex=function(){return 0},t.prototype._getEditColumnIndex=function(){return null!=this._editColIndex?this._editColIndex:this.rowHeaders.columns.length-1},t.prototype._sortConverter=function(e,t,i,n){var o,r=this;if(n&&(this._mappedColumns=null,this._cv&&this._cv.sortDescriptions.forEach((function(e){(o=r.getColumn(e.property))&&o.dataMap&&(r._mappedColumns||(r._mappedColumns={}),r._mappedColumns[o.binding]=o.dataMap)})),this._mouseHdl._htDown&&this._mouseHdl._htDown.col>-1&&(o=this.columns[this._mouseHdl._htDown.col],this._mappedColumns&&o.dataMap&&(this._mappedColumns[o.binding]=o.dataMap))),this._mappedColumns){var s=this._mappedColumns[e.property];s&&s.sortByDisplayValues&&(i=s.getDisplayValue(i))}return i},t.prototype._bindGrid=function(e){var t=this;if(this.finishEditing(),this.deferUpdate((function(){var i,n;if(t.autoGenerateColumns&&0==t._lastCount&&(0,s.hasItems)(t._cv)&&(e=!0),t.preserveSelectedState&&(i=t._getMap())&&t.rows.forEach((function(e){e.isSelected&&e.dataItem&&i.set(e.dataItem,!0)})),t.preserveOutlineState&&t.rows.maxGroupLevel>-1&&(n=t._getMap()))for(var o=0;o<t.rows.length;o++){var r=t.rows[o];if(r instanceof M&&r.isCollapsed&&r.dataItem){var l=r.dataItem;l instanceof s.CollectionViewGroup&&(l=l._path),n.set(l,!0)}}e&&t.columns.deferUpdate((function(){t._bindColumns()}));var a=new s.CancelEventArgs;t.onLoadingRows(a)&&(t.rows.deferUpdate((function(){t._bindRows()})),t.onLoadedRows(a)),t._selHdl.extendedSelection.clear();var h=0;if(i&&i.size&&t.rows.forEach((function(e){var t=e.dataItem;t&&i.has(t)&&(e.isSelected=!0,h++)})),0==h&&t.selectionMode==v.ListBox){var c=t.selection;for(o=c.topRow;o<=c.bottomRow&&o>-1&&o<t.rows.length;o++)t.rows[o]._setFlag(S.Selected,!0,!0)}if(n&&n.size&&t.rows.deferUpdate((function(){t.rows.forEach((function(e){if(e instanceof M){var t=e.dataItem;t instanceof s.CollectionViewGroup&&(t=t._path),n.has(t)&&(e.isCollapsed=!0)}}))})),!t._lastCount){var u=t._cv;u&&u.items&&(t._lastCount=u.items.length)}})),this._cv){var i=e&&!this._toInv;this._syncSelection(i)}else{var n=this.selection,o=new m(-1,n.col,-1,n.col2);this._selHdl._adjustSelection(o,this.selectionMode)}},t.prototype._getMap=function(){return window.Map?new Map:null},t.prototype._cvCollectionChanged=function(e,t){if(this.autoGenerateColumns&&0==this.columns.length)this._bindGrid(!0);else{var i=s.NotifyCollectionChangedAction;if(this.childItemsPath&&t.action!=i.Change)this._bindGrid(!1);else{switch(t.action){case i.Change:return void this.invalidate();case i.Add:if(t.index==this._cv.items.length-1){var n=this.rows.length;return this.rows[n-1]instanceof W&&n--,void this.rows.insert(n,new k(t.item))}(0,s.assert)(!1,"added item should be the last one.");break;case i.Remove:var o=this._findRow(t.item);if(o>-1)return this.rows.removeAt(o),void this._syncSelection(!1);(0,s.assert)(!1,"removed item not found on grid.")}this._bindGrid(!1)}}},t.prototype._cvCurrentChanged=function(e,t){this._syncSelection(!1)},t.prototype._syncSelection=function(e){if(this._cv&&this.selectionMode!=v.None){var t=this._selHdl,i=t.selection,n=i.row>-1&&i.row<this.rows.length?this.rows[i.row]:null,o=n?n.dataItem:null,r=this._cv;if(r instanceof s.CollectionView&&r.isUpdating)return;if(this.newRowAtTop&&n instanceof W)return;o instanceof s.CollectionViewGroup&&(o=null);var l=this._isISChanging;if(e||o!=r.currentItem||i.row>=this.rows.length||l&&i.row!==i.row2){var a=this.editableCollectionView;if(!this.childItemsPath||!a||!a.currentAddItem){var h=this._getRowIndex(r.currentPosition);if(h!=i.row||!this.childItemsPath){var c=l?i.col:i.col2;i=new m(h,i.col,h,c),t._adjustSelection(i,this.selectionMode),this.selectionMode&&!this._updating&&this.scrollIntoView(i.row,-1)}}}}},t.prototype._getRowIndex=function(e){if(this._cv){var t=this.rows;if(e>-1){for(var i=this._cv.items[e];e<t.length;e++)if(t[e].dataItem===i)return e;return-1}if(1==t.length&&t[0]instanceof W)return 0;var n=this.selection.row,o=n>-1?t[n]:null;return o&&(o instanceof M||null==o.dataItem)?n:-1}return this.selection.row},t.prototype._getCvIndex=function(e){return e>-1&&e<this.rows.length?this.rows[e].dataIndex:-1},t.prototype._findRow=function(e){for(var t=0;t<this.rows.length;t++)if(this.rows[t].dataItem==e)return t;return-1},t.prototype._updateLayout=function(){var e=new s.CancelEventArgs;if(this.onUpdatingLayout(e)){var i=this._hdrVis&R.Row?this._hdrCols.getTotalSize():0,n=this._hdrVis&R.Column?this._hdrRows.getTotalSize():0,o=this._ftrRows.getTotalSize(),r=this._rows.getTotalSize()+o;r<1&&(r=1),this._heightReal=r,this._heightBrowser=Math.min(r,t._getMaxSupportedCssHeight()),this._maxOffsetY=Math.max(0,r-this._heightBrowser);var l=getComputedStyle(this._eFocus);this._cellPadVert=parseInt(l.paddingTop)+parseInt(l.paddingBottom),this._cellPadHorz=parseInt(l.paddingLeft)+parseInt(l.paddingRight),this._cellPadLeft=parseInt(this.rightToLeft?l.paddingRight:l.paddingLeft);var a=this._heightBrowser+n-o,h=this._gpCells.width,c=this._heightBrowser;!h&&this.rows.length&&(h=.1),!c&&this.columns.length&&(c=.1),this.rightToLeft?((0,s.setCss)(this._eTL,{right:0,top:0,width:i,height:n}),(0,s.setCss)(this._eCHdr,{right:i,top:0,height:n}),(0,s.setCss)(this._eRHdr,{right:0,top:n,width:i}),(0,s.setCss)(this._eCt,{right:i,top:n,width:h,height:c}),(0,s.setCss)(this._fCt,{right:i,top:n}),(0,s.setCss)(this._eBL,{right:0,top:a,width:i,height:o}),(0,s.setCss)(this._eCFtr,{right:i,top:a,height:o})):((0,s.setCss)(this._eTL,{left:0,top:0,width:i,height:n}),(0,s.setCss)(this._eCHdr,{left:i,top:0,height:n}),(0,s.setCss)(this._eRHdr,{left:0,top:n,width:i}),(0,s.setCss)(this._eCt,{left:i,top:n,width:h,height:c}),(0,s.setCss)(this._fCt,{left:i,top:n}),(0,s.setCss)(this._eBL,{left:0,top:a,width:i,height:o}),(0,s.setCss)(this._eCFtr,{left:i,top:a,height:o})),this._stickyHdr&&this._updateStickyHeaders();var u=this.frozenRows||this.frozenColumns?"3":"";(0,s.setCss)([this._eTL,this._eBL,this._eCHdr,this._eCFtr,this._eRHdr,this._eMarquee],{zIndex:u}),(0,s.isIE)()&&(this._fCt.style.zIndex=u?"2":"");var d=this._root,p=d.offsetWidth-d.clientWidth,f=d.offsetHeight-d.clientHeight;(0,s.setCss)(this._eSz,{width:i+p+this._gpCells.width,height:n+f+this._heightBrowser});var _=null;this.columns._updateStarSizes(d.clientWidth-i)&&(_=d.clientWidth,(0,s.setCss)(this._eCt,{width:this._gpCells.width}),this.onStarSizedColumns()),this._szClient=new s.Size(d.clientWidth-i,d.clientHeight-n),this._szClientSB=new s.Size(d.offsetWidth-i,d.offsetHeight-n),this._rcBounds=null,this._updateScrollHandler(),this._updateContent(!1),p=d.offsetWidth-d.clientWidth,f=d.offsetHeight-d.clientHeight,(0,s.setCss)(this._eSz,{width:i+p+this._gpCells.width,height:n+f+this._heightBrowser}),this._szClient=new s.Size(d.clientWidth-i,d.clientHeight-n),_&&_!=d.clientWidth&&this.columns._updateStarSizes(d.clientWidth-i)&&((0,s.setCss)(this._eCt,{width:this._gpCells.width}),this._updateContent(!1)),(0,s.setCss)([this._eCHdr,this._eCFtr,this._fCt],{width:this._szClient.width}),(0,s.setCss)([this._eRHdr,this._fCt],{height:this._szClient.height}),o&&(a=Math.min(a,this._szClient.height+n-o),(0,s.setCss)([this._eBL,this._eCFtr],{top:a})),this.onUpdatedLayout(e)}},t.prototype._updateStickyHeaders=function(){var e=!1,i=0;if(this._stickyHdr){for(var n=0,o=null,r=this.hostElement;r;r=r.parentElement)if("inline"!=getComputedStyle(r).display){var l=r.getBoundingClientRect();null==o&&(o=l.top),n=Math.max(n,l.top)}i=-(o=Math.max(0,n-o-1)),e=o>0,this._rcBounds=null}this._eTL.style.top=this._eCHdr.style.top=e?-i+"px":"",(0,s.toggleClass)(this._eTL,t._WJS_STICKY,e),(0,s.toggleClass)(this._eCHdr,t._WJS_STICKY,e)},t.prototype._updateScrollHandler=function(){this._clipToScreen=this._getClipToScreen();var e=this._stickyHdr||this._clipToScreen;e!=this._scrollHandlerAttached&&(this._scrollHandlerAttached=e,e?this.addEventListener(window,"scroll",this._scroll.bind(this),!0):this.removeEventListener(window,"scroll"))},t.prototype._getClipToScreen=function(){if(this.rows.length<=t._MIN_VIRT_ROWS)return!1;if(this._root.scrollHeight>this._root.clientHeight)return!1;for(var e=this.hostElement;e&&e!=document.documentElement;e=e.parentElement)if("auto"==getComputedStyle(e).overflow)return!1;return!0},t.prototype._scroll=function(e){var t=this;(0,s.contains)(e.target,this.hostElement)&&(this._clipToScreen&&(this._afClip&&cancelAnimationFrame(this._afClip),this._afClip=requestAnimationFrame((function(){t._afClip=null,t.finishEditing(),t._updateContent(!0)}))),this._stickyHdr&&(this._afSticky&&cancelAnimationFrame(this._afSticky),this._afSticky=requestAnimationFrame((function(){t._afSticky=null;var e=new s.CancelEventArgs;t.onUpdatingLayout(e)&&(t._updateStickyHeaders(),t.onUpdatedLayout(e))}))))},t.prototype._getCssPage=function(e){if(this._heightReal>this._heightBrowser){var t=this._szClient.height-this._gpCFtr.rows.getTotalSize();if(this._heightBrowser>t)return(0,s.clamp)(Math.round(e/(this._heightBrowser-t)*10)/10,0,1)}return 0},t.prototype._updateScrollPosition=function(){var e=this._root,i=e.scrollTop,n=e.scrollLeft;this.rightToLeft&&"rev"==t._getRtlMode()&&(n=e.scrollWidth-e.clientWidth-n);var o=new s.Point(-Math.abs(n),-i);return!this._ptScrl.equals(o)&&(this._ptScrl=o,this.onScrollPositionChanged(),!0)},t.prototype._updateContent=function(e,t){var i=this,n=this._root,o=this.hostElement,r=this.cells.hostElement,l=this._activeCell,a=(0,s.getActiveElement)(),h=(0,s.contains)(o,a),c=(0,s.closest)(a,".wj-flexgrid")==o?a:null,u=new s.CancelEventArgs;if(this.onUpdatingView(u)){(0,s.setAttribute)(r,"role",this.rows.maxGroupLevel<0?"grid":"treegrid"),this._hasValidation=(0,s.isFunction)(this._itemValidator)||this._cv&&(0,s.isFunction)(this._cv.getError);var d=!t&&this._errorTip&&this._errorTip._tips.length,p=this._getCssPage(-this._ptScrl.y);p!=this._cssPage&&(this._cssPage=p,this._offsetY=Math.round(this._maxOffsetY*p)),this._updateScrollPosition(),this._updateMarquee();var f=this._gpCells._updateContent(e,t,this._offsetY),_=this._hdrVis;if(_&R.Column&&(!t||this._ssHdr&_)&&(this._gpCHdr._updateContent(e,t,0),this.rightToLeft||(this._eCHdr.scrollLeft=0)),_&R.Row&&(!t||this._ssHdr&_)&&(this._gpRHdr._updateContent(e,t,this._offsetY),this._eRHdr.scrollTop=0),_&&!t&&this._gpTL._updateContent(e,t,0),this._gpCFtr.rows.length&&(this._gpBL._updateContent(e,t,0),this._gpCFtr._updateContent(e,t,0)),d&&this._errorTip&&this._errorTip._tips.length&&(clearTimeout(this._toErrorTips),this._toErrorTips=setTimeout((function(){var e=i._errorTip;if(e){e.hide();for(var t=e._tips,n=0;n<t.length;n++){var o=t[n].element;o.offsetHeight&&(0,s.hasClass)(o,"wj-state-invalid")||(e.setTooltip(o,null),n--)}}}),250)),this._useFrozenDiv()&&(this._updateFrozenCells(t),f&&(0,s.hasClass)(f,"wj-frozen")&&(f=null)),this._fCt.style.display=this._fCt.childElementCount?"":"none",this._activeCell=f,c)if(c!=n&&c!=this._eFocus&&(0,s.contains)(o,c)&&!(0,s.contains)(r,c)){if((0,s.getActiveElement)()!==c&&c.focus(),(0,s.isIE)()&&c instanceof HTMLInputElement&&!c.type.match(/checkbox|radio|range/i)){var g=c.selectionStart,m=c.selectionEnd;c.setSelectionRange(g,m)}}else{var v=f!==l;this._setFocus(v)}!c&&f&&(f.tabIndex=this.isDisabled?-1:this._orgTabIndex),l&&l!=f&&(l.tabIndex=-1),this._eFocus.tabIndex=null!=f||this.isDisabled?-1:this._orgTabIndex,h&&this.focus(),this._fixScroll(),this._rcBounds=null,this.onUpdatedView(u)}},t.prototype._fixScroll=function(){var e=this._root;if(!this._updating){var t=this.hostElement,i=e?e.parentElement:null,n=this.rightToLeft;t&&(t.scrollTop&&(t.scrollTop=0),t.scrollLeft&&!n&&(t.scrollLeft=0)),i&&(i.scrollTop&&(i.scrollTop=0),i.scrollLeft&&!n&&(i.scrollLeft=0))}var o=u();e&&o&&14==o.major&&o.minor>=1&&(e.style.transform="",e.style.transform="translateZ(0)")},t.prototype._clearCells=function(){for(var e in this)if("_"==e[0]){var t=this[e];t instanceof w&&t._clearCells()}this.invalidate()},t.prototype._useFrozenDiv=function(){return(0,s.isBoolean)(this._fzClone)?this._fzClone:(0,s.isIE)()||(0,s.isFirefox)()||(0,s.isSafari)()||(0,s.isMobile)()},t.prototype._updateFrozenCells=function(e){var t=this._fCt;if(this.frozenRows||this.frozenColumns){var i=this._eCt.querySelectorAll(".wj-frozen");if(e&&t.children.length==i.length){for(var n=0;n<i.length;n++)t.children[n].className=i[n].className;return}if((0,s.setText)(t,null),!this.activeEditor){var o=this._errorTip,r=navigator.userAgent.indexOf("MSIE")>=0;for(n=0;n<i.length;n++){var l=i[n];if((0,s.closest)(l,".wj-flexgrid")==this.hostElement){var a=l[w._INDEX_KEY],h=l.firstElementChild,c=null;if(a&&h){var u=a.panel,d=this._getBindingColumn(u,a.row,u.columns[a.col]);c=(0,s.isFunction)(d.cellTemplate)?h.onclick:null}if(r){var p="input[type=checkbox]",f=l.querySelector(p);l=l.cloneNode(!0),f&&(l.querySelector(p).checked=f.checked)}else l=l.cloneNode(!0);if(h=l.firstElementChild,c&&h&&(h.onclick=c),l[w._INDEX_KEY]=a,o){var _=o.getTooltip(i[n]);_&&o.setTooltip(l,_)}t.appendChild(l)}}}}else(0,s.setText)(t,null)},t.prototype._updateMarquee=function(){var e=this._eMarquee,t=this._getMarqueeRect();if(t&&t.width&&t.height){var i=e.firstChild,n=e.offsetWidth-i.offsetWidth,o=e.offsetHeight-i.offsetHeight,r=this.cells.hostElement;(0,s.setCss)(e,{left:t.left+r.offsetLeft-n/2,top:t.top+r.offsetTop-o/2,width:t.width+n,height:t.height+o,display:""})}else e.style.display="none"},t.prototype._getMarqueeRect=function(){if(!this._shMarquee||!this.selectionMode)return null;var e=this._selHdl.selection;if(!this.isRangeValid(e))return null;e=(e=(e=this.cells._getAdjustedSelection(e)).combine(this.getMergedRange(this.cells,e.topRow,e.leftCol,!1))).combine(this.getMergedRange(this.cells,e.bottomRow,e.rightCol,!1));var t=this.cells.getCellBoundingRect(e.topRow,e.leftCol,!0),i=this.cells.getCellBoundingRect(e.bottomRow,e.rightCol,!0);if(this.rows.frozen){var n=Math.min(this.rows.length,this.rows.frozen),o=this.cells.getCellBoundingRect(n-1,0,!0);e.topRow>=n&&t.top<o.bottom&&(t.top=o.bottom),e.bottomRow>=n&&i.bottom<o.bottom&&(i.height=o.bottom-i.top)}if(this.columns.frozen){var r=Math.min(this.columns.length,this.columns.frozen);o=this.cells.getCellBoundingRect(0,r-1,!0),this.rightToLeft?(e.leftCol>=r&&t.right>o.left&&(t.left=o.left-t.width),e.rightCol>=r&&i.left>o.left&&(i.left=o.left)):(e.leftCol>=r&&t.left<o.right&&(t.left=o.right),e.rightCol>=r&&i.right<o.right&&(i.width=o.right-i.left))}return this.rightToLeft?new s.Rect(i.left,t.top,t.right-i.left,i.bottom-t.top):new s.Rect(t.left,t.top,i.right-t.left,i.bottom-t.top)},t.prototype._bindColumns=function(){for(var e=this.columns,i=0;i<e.length;i++)e[i]._getFlag(S.AutoGenerated)&&(e.removeAt(i),i--);var n=this._cv,o=n?n.items:null;o&&o.length&&this.autoGenerateColumns&&this._getColumnTypes(o).forEach((function(i){var n=new j(i);n._setFlag(S.AutoGenerated,!0),n.name=n.binding,n.header=(0,s.toHeaderCase)(n.binding);var o=t._defTypeWidth[n.dataType];if(null!=o){if((0,s.isString)(o)){var r=Math.round(parseFloat(o));o=o.indexOf("*")>-1?r*e.defaultSize:r}(0,s.isNumber)(o)&&o>0&&(n.width=o)}e.push(n)})),this._updateColumnTypes()},t.prototype._getColumnTypes=function(e){return(0,s.getTypes)(e)},t.prototype._updateColumnTypes=function(){var e=this._cv;if((0,s.hasItems)(e)){var t=e.items[0];this.columns.forEach((function(e){null==e.dataType&&e._binding&&(e.dataType=(0,s.getType)(e._binding.getValue(t)))}))}},t.prototype._getMapEditor=function(e,t){return t.editor?null!=t.editor.isDroppedDown?t.dataMapEditor:null:!e.dataMap||e instanceof M?t.dataMap?t.dataMapEditor:null:e.dataMapEditor},t.prototype._getBindingColumn=function(e,t,i){return i},t.prototype._getBindingColumns=function(){return this.columns},t.prototype._getRowsPerItem=function(){return 1},t.prototype._isTransposed=function(){return!1},t.prototype._getRowHeaderPath=function(){return this._rowHdrPath},t.prototype._bindRows=function(){this.rows.clear();var e=this._cv;if(e&&e.items){var t=e.items,i=e.groups;if(this.childItemsPath)for(var n=0;n<t.length;n++)this._addNode(t,n,0);else if(null!=i&&i.length>0&&this.showGroups)for(n=0;n<i.length;n++)this._addGroup(i[n]);else for(n=0;n<t.length;n++)this._addBoundRow(t,n)}},t.prototype._addBoundRow=function(e,t){var i=new k(e[t]),n=this.rows;i._list=n,n[n.length++]=i},t.prototype._addGroupRow=function(e){this.rows.push(new M(e))},t.prototype._addNode=function(e,t,i){var n=e[t],o=this.childItemsPath,r=n[(0,s.isArray)(o)?o[i]:o],l=new M(n);if(l.level=i,this.rows.push(l),(0,s.isArray)(r))for(var a=0;a<r.length;a++)this._addNode(r,a,i+1)},t.prototype._addGroup=function(e){if(this._addGroupRow(e),e.isBottomLevel)for(var t=e.items,i=0;i<t.length;i++)this._addBoundRow(t,i);else for(i=0;i<e.groups.length;i++)this._addGroup(e.groups[i])},t._getSerializableProperties=function(e){var t=[];for(e=e.prototype;e!=Object.prototype;e=Object.getPrototypeOf(e))for(var i=Object.getOwnPropertyNames(e),n=0;n<i.length;n++){var o=i[n],r=Object.getOwnPropertyDescriptor(e,o);r&&r.set&&r.get&&"_"!=o[0]&&!o.match(/^(disabled|required|showDropDown)$/)&&t.push(o)}return t},t.prototype._hasColumnGroups=function(){return this._grpHdl.hasColumnGroups()},t.prototype._getColumnGroup=function(e,t){return this._grpHdl.getColumnGroup(e,t)},t.prototype._canMoveColumnGroup=function(e,t,i,n){return this._grpHdl.canMoveColumnGroup(e,t,i,n)},t.prototype._moveColumnGroup=function(e,t,i,n,o){return this._grpHdl.moveColumnGroup(e,t,i,n,o)},t.prototype._copy=function(e,t){var i=this;if("columns"==e){var n=(0,s.asArray)(t);return n.some((function(e){return null!=e.columns}))?this.columnGroups=n:(this.columns.clear(),n.forEach((function(e){var t=new j(e);i.columns.push(t)}))),!0}return!1},t.prototype._isInputElement=function(e){return e instanceof HTMLElement&&!(0,s.hasClass)(e,"wj-btn-glyph")&&("true"==e.contentEditable||null!=e.tagName.match(/^(INPUT|TEXTAREA|BUTTON|A|SELECT|OPTION)$/i))},t.prototype._isNativeCheckbox=function(e){return e instanceof HTMLInputElement&&"checkbox"==e.type&&!e.disabled&&!e.readOnly&&(0,s.hasClass)(e,X._WJC_CHECKBOX)&&(0,s.closest)(e,".wj-flexgrid")==this.hostElement},t.prototype._wantsInput=function(e){return this._isInputElement(e)&&!this.activeEditor&&!this._isNativeCheckbox(e)&&!(0,s.hasClass)(e,"wj-grid-ime")&&(0,s.contains)(document.body,e)},t._getMaxSupportedCssHeight=function(){if(!t._maxCssHeight){var e=265e5;(0,s.isIE)()?e=15e5:(0,s.isFirefox)()&&(e=175e5),t._maxCssHeight=e}return t._maxCssHeight},t._getRtlMode=function(){if(!t._rtlMode){var e=(0,s.createElement)('<div dir="rtl"><div></div></div>');(0,s.setCss)(e,{visibility:"hidden",width:100,height:100,overflow:"auto"}),(0,s.setCss)(e.firstChild,{width:2e3,height:2e3}),document.body.appendChild(e);var i=e.scrollLeft;e.scrollLeft=-1e3;var n=e.scrollLeft;(0,s.removeChild)(e),t._rtlMode=n<0?"neg":i>0?"rev":"std"}return t._rtlMode},t._WJS_STICKY="wj-state-sticky",t._WJS_MEASURE="wj-state-measuring",t._WJS_UPDATING="wj-state-updating",t._WJS_WSPRE="wj-whitespace-pre",t._MIN_VIRT_ROWS=200,t._defTypeWidth=((n={})[s.DataType.Number]="0.714285714*",n),t.controlTemplate='<div><div wj-part="root"><div wj-part="cells" class="wj-cells"></div><div wj-part="marquee" class="wj-marquee"><div></div></div></div><div wj-part="fcells" aria-hidden="true" class="wj-cells wj-frozen-clone"></div><div wj-part="rh"><div wj-part="rhcells" class="wj-rowheaders"></div></div><div wj-part="cf"><div wj-part="cfcells" class="wj-colfooters"></div></div><div wj-part="ch"><div wj-part="chcells" class="wj-colheaders"></div></div><div wj-part="bl"><div wj-part="blcells" class="wj-bottomleft"></div></div><div wj-part="tl"><div wj-part="tlcells" class="wj-topleft"></div></div><div wj-part="focus" class="wj-cell">0</div><div wj-part="sz"></div></div>',t}(s.Control),K=function(){function e(t){var i=this;this._updateImeFocusAsyncBnd=this._updateImeFocusAsync.bind(this),this._cmpstartBnd=this._compositionstart.bind(this),this._keypressBnd=this._keypress.bind(this),this._g=t;var n=(0,s.createElement)('<textarea class="wj-grid-editor wj-form-control wj-grid-ime" aria-hidden="true"/>');(0,s.setCss)(n,e._cssHidden),(0,s.disableAutoComplete)(n),n.tabIndex=-1,this._tbx=n,this._maskProvider=new s._MaskProvider(n),t._root.appendChild(n),this._updateImeFocus();var o=t.hostElement,r=t.addEventListener.bind(t),l=this._updateImeFocusAsyncBnd;r(o,"blur",l,!0),r(o,"focus",l,!0),r(n,"compositionstart",this._cmpstartBnd),(0,s.isiOS)()&&r(o,"keypress",this._keypressBnd),t.selectionChanged.addHandler(l,this),t.cellEditEnded.addHandler(this._cellEditEnded,this),t.cellEditEnding.addHandler(this._cellEditEnding,this),r(o,"mousedown",(function(e){(0,s.closest)((0,s.getActiveElement)(),".wj-flexgrid")==t.hostElement&&t.hitTest(e).panel==t.cells&&(0,s.hasClass)(t.hitTest(e).target,"wj-cell")&&e.preventDefault()})),t.gotFocus.addHandler((function(){return i._updateImeFocus()}))}return e.prototype.dispose=function(){var e=this._g,t=e.hostElement,i=this._tbx,n=e.removeEventListener.bind(e),o=this._updateImeFocusAsyncBnd;n(t,"blur",o),n(t,"focus",o),n(t,"keypress",this._keypressBnd),n(i,"compositionstart",this._cmpstartBnd),e.selectionChanged.removeHandler(o),e.cellEditEnded.removeHandler(this._cellEditEnded),e.cellEditEnding.removeHandler(this._cellEditEnding),(0,s.removeChild)(i)},e.prototype._compositionstart=function(e){var t=this._g;if(!t.activeEditor){var i=t._selHdl.selection;if(t.startEditing(!1,i.row,i.col,!1,e)&&t.activeEditor&&"checkbox"!=t.activeEditor.type){i=t.editRange;var n=t._getBindingColumn(t.cells,i.row,t.columns[i.col]),o=n&&n._edt,r=t.activeEditor,l=this._tbx,a=t.cells.hostElement,h=t.columns[i.col].pos+a.offsetLeft,c=t.rows[i.row].pos+a.offsetTop,u=t.getCellBoundingRect(i.row,i.col),d=(0,s.closest)(r,".wj-cell");u.width=d.offsetWidth,u.height=d.offsetHeight,i.row<t.frozenRows&&(c+=t._root.scrollTop),i.col<t.frozenColumns&&(h+=t._root.scrollLeft);var p=d.querySelector(".wj-btn.wj-right");p&&(u.width-=p.offsetWidth),"minLength,maxLength,pattern".split(",").forEach((function(e){(0,s.setAttribute)(l,e,r.getAttribute(e))}));var f=r instanceof HTMLTextAreaElement;(0,s.setAttribute)(l,"wrap",f?"soft":"off");var _=getComputedStyle(d),g=_.paddingTop;if(i.rowSpan>1&&!f){var m=parseFloat(_.lineHeight);isNaN(m)&&(m=1.2*parseFloat(_.fontSize)),g=Math.max(0,(u.height-m)/2)+"px"}var v={position:"absolute",left:h,top:c,width:u.width-1,height:u.height-1,paddingTop:g,paddingLeft:_.paddingLeft,paddingRight:_.paddingRight,textAlign:_.textAlign,zIndex:d.style.zIndex};if(t.rightToLeft&&(v.right=parseInt(d.style.right)+parseInt(t.cells.hostElement.style.right),v.left=""),(0,s.setCss)(l,v),o){var b=o._tbx.getBoundingClientRect(),y=l.getBoundingClientRect(),w=window.getComputedStyle(l),C=parseFloat(w.left),x=parseFloat(w.top);(0,s.setCss)(l,{left:C+b.left-y.left+"px",top:x+b.top-y.top+"px",width:b.width+"px",height:b.height+"px"})}t._edtHdl._edt=l,l.select();var E=r.value;setTimeout((function(){"\u3000"!=l.value&&" "!=l.value||(l.value=E),(0,s.setSelectionRange)(l,l.value.length)}),20),l.placeholder=r.placeholder,r.placeholder="",r.value=""}}},e.prototype._cellEditEnding=function(){var e=this._maskProvider;e&&e.mask&&e._valueChanged()},e.prototype._cellEditEnded=function(){var t=this._tbx;t.value="",s.isIE&&(t.innerText=""),(0,s.setCss)(t,e._cssHidden),this._updateImeFocus()},e.prototype._keypress=function(e){e.defaultPrevented||e.target!=this._tbx||e.ctrlKey||e.altKey||e.metaKey||27==e.keyCode||this._g.activeEditor||(this._tbx.value="",this._compositionstart(e),e.stopPropagation())},e.prototype._updateImeFocus=function(){var e=this._g,t=this._tbx,i=(0,s.getActiveElement)(),n=e._getTabIndex();if(e.activeEditor||(0,s.closest)(i,".wj-flexgrid")!=e.hostElement)(e.isDisabled||n<0)&&t.tabIndex>=0&&(t.tabIndex=-1);else if(this._enableIme()&&!e._wantsInput(i)){i!=t&&(e.activeCell&&(e.activeCell.tabIndex=-1),t.tabIndex=n,t.disabled=!1,t.value="",(0,s.setSelectionRange)(t,0),t.focus());var o=e._selHdl.selection,r=o.isValid?e._getBindingColumn(e.cells,o.row,e.columns[o.col]):null;this._maskProvider.mask=r?r.mask:null}else if(t.tabIndex=-1,t.disabled=!0,t.value="",i==t){t.blur();var l=e.activeCell;l?(l.tabIndex=n,l.focus()):e.focus()}},e.prototype._updateImeFocusAsync=function(){var e=this;this._toFocus&&clearTimeout(this._toFocus),this._toFocus=setTimeout((function(){e._toFocus=null,e._updateImeFocus()}),100)},e.prototype._enableIme=function(){var e=this._g,t=e._selHdl.selection;if(!e.canEditCell(t.row,t.col))return!1;var i=t.isValid?e._getBindingColumn(e.cells,t.row,e.columns[t.col]):null;return!(!i||i.dataType==s.DataType.Boolean)&&(!i||!i.dataMap||i.dataMapEditor!=o.RadioButtons)},e._cssHidden={position:"fixed",width:"1px",left:-32e3,top:-32e3,overflow:"hidden"},e}(),G=function(){function e(e){this._nrt=new W,this._top=!1,this._keydownBnd=this._keydown.bind(this),this._committing=!1,this._pasting=!1,this._g=e,this._attach()}return Object.defineProperty(e.prototype,"newRowAtTop",{get:function(){return this._top},set:function(e){if(e!=this.newRowAtTop){this._top=(0,s.asBoolean)(e),this.updateNewRowTemplate();var t=this._g;this._top&&t.selectionMode==v.ListBox&&(t.rows.forEach((function(e,t){e._setFlag(S.Selected,0==t,!0)})),t.select(0,t.selection.col))}},enumerable:!0,configurable:!0}),e.prototype.updateNewRowTemplate=function(){var e=this._g,t=e.editableCollectionView,i=e.rows,n=this._nrt,o=t&&t.canAddNew&&e.allowAddNew&&!e.isReadOnly,r=i.indexOf(n),s=this._top?0:i.length-1,l=!1;if(!o&&r>-1){var a=e.selection;a.row==r&&e.select(a.row-1,a.col),i.removeAt(r)}else o&&(r<0?l=!0:r!=s&&(i.removeAt(r),l=!0),l&&(this._top?i.insert(0,n):i.push(n)),n&&(n._ubv=null,n._setFlag(S.ParentCollapsed,!1),this._top&&e.selectionMode==v.ListBox||n._setFlag(S.Selected,!1)))},e.prototype._attach=function(){var e=this._g;e&&(e.pasting.addHandler(this._pastingData,this),e.pasted.addHandler(this._pastedData,this),e.loadedRows.addHandler(this.updateNewRowTemplate,this),e.hostElement.addEventListener("keydown",this._keydownBnd,!0))},e.prototype._detach=function(){var e=this._g;e&&(e.pasting.removeHandler(this._pastingData,this),e.pasted.removeHandler(this._pastedData,this),e.loadedRows.removeHandler(this.updateNewRowTemplate),e.hostElement.removeEventListener("keydown",this._keydownBnd,!0))},e.prototype._keydown=function(e){!e.defaultPrevented&&e.keyCode==s.Key.Escape&&null==this._g.activeEditor&&this._top&&this._nrt.dataItem&&(this._nrt.dataItem=null,this._g.invalidate())},e.prototype._beginningEdit=function(e,t){if(!t.cancel){var i=e.rows[t.row];i instanceof W&&this._handleEditStarting(e,t,i)}},e.prototype._pastingData=function(e,t){t.cancel||(this._pasting=!0)},e.prototype._pastedData=function(e,t){this._pasting=!1},e.prototype._rowEditStarting=function(e,t){if(this._pasting){var i=e.rows[t.row];i instanceof W&&this._handleEditStarting(e,t,i)}},e.prototype._rowEditEnding=function(e,t){var i=e.editableCollectionView,n=this._nrt.dataItem;if(i&&this._top&&n&&!t.cancel){var o=i.currentAddItem;if(!o||o!=n)for(var r in o=i.addNew(),n)o[r]=n[r]}},e.prototype._rowEditEnded=function(e,t){var i=this,n=e.editableCollectionView;if(n&&!this._committing)if(this._top){if(t.cancel)return;var o=this._nrt.dataItem;if(o){this._committing=!0,this._nrt.dataItem=null;var r=this._g.rows,s=n.items.indexOf(o)+1;s<r.length&&t._rng.setRange(s,-1),e.onRowAdded(t)?n.commitNew():n.cancelNew(),this._committing=!1}var l=e.rows[t.row];setTimeout((function(){l instanceof W&&e.select(0,e.columns.firstVisibleIndex),i.updateNewRowTemplate()}),20)}else n.isAddingNew&&n.commitNew()},e.prototype._handleEditStarting=function(e,t,i){var n=e.editableCollectionView;if(n&&n.canAddNew)if(this._top)if(null==this._nrt.dataItem){var o=null,r=n.sourceCollection,l=n.newItemCreator;o=(0,s.isFunction)(l)?l():r&&r.length?new r[0].constructor:{},this._nrt.dataItem=o}else n.currentAddItem&&(e.onRowAdded(t)||n.cancelNew());else{o=n.currentAddItem&&n.currentAddItem==i.dataItem?n.currentAddItem:n.addNew(),n.moveCurrentTo(o);var a=this._nrt.isSelected;this.updateNewRowTemplate(),a&&t.row>-1&&(e.rows[t.row].isSelected=!0),e.isUpdating||e.refresh(!0),e.onRowAdded(t)||n.cancelNew()}},e}(),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t}(k);!function(e){e[e.None=0]="None",e[e.Cells=1]="Cells",e[e.ColumnHeaders=2]="ColumnHeaders",e[e.RowHeaders=4]="RowHeaders",e[e.AllHeaders=6]="AllHeaders",e[e.All=7]="All"}(V||(V={}));var q=function(){function e(e){null!=e&&console.error('** WARNING: the "grid" parameter has been deprecated. Please remove it.')}return e.prototype.getMergedRange=function(e,t,i,n){void 0===n&&(n=!0);var o=e.grid,r=e.cellType,l=e.columns,a=e.rows,h=a[t],c=l[i];if(h instanceof W)return null;if(!(h instanceof k&&c instanceof j))return null;if(e==o.columnHeaders){var u=o._getColumnGroup(t,i);if(u){var d=u._rng,p=e.columns;return p.isFrozen(d.col)!=p.isFrozen(d.col2)&&(d=d.clone(),p.isFrozen(i)?d.col2=p.frozen-1:d.col=p.frozen),d}}if(o.showGroups&&!o.childItemsPath&&h instanceof M&&h.dataItem instanceof s.CollectionViewGroup&&r==_.Cell){if(d=new m(t,i),c.aggregate==s.Aggregate.None){for(;d.col>0&&l[d.col-1].aggregate==s.Aggregate.None&&d.col!=l.frozen;)d.col--;for(;d.col2<l.length-1&&l[d.col2+1].aggregate==s.Aggregate.None&&d.col2+1!=l.frozen;)d.col2++}for(;d.col<i&&!l[d.col].visible;)d.col++;return d.isSingleCell?null:d}var f=!1,g=V,v=_;switch(o.allowMerging){case g.None:f=!0;break;case g.Cells:f=r!=v.Cell;break;case g.ColumnHeaders:f=r!=v.ColumnHeader&&r!=v.TopLeft;break;case g.RowHeaders:f=r!=v.RowHeader&&r!=v.TopLeft;break;case g.AllHeaders:f=r==v.Cell}if(f)return null;if(r==v.Cell){var b=o.editableCollectionView,y=b?b.currentAddItem:null;if(y&&h.dataItem==y)return null}if(l[i].allowMerging){d=new m(t,i);var w=e._vrb,C=0,x=a.length-1;t>=a.frozen?n&&(r==_.Cell||r==_.RowHeader)&&o._vtRows<a.length&&w&&(C=w.topRow,x=w.bottomRow):a.length>a.frozen&&(x=a.frozen-1);for(var E=t-1;E>=C&&this._mergeCell(e,E,i,t,i);E--)d.row=E;for(var S=t+1;S<=x&&this._mergeCell(e,t,i,S,i);S++)d.row2=S;for(;d.row<t&&!a[d.row].visible;)d.row++;if(!d.isSingleCell)return d}if(a[t].allowMerging){d=new m(t,i),w=e._vrb;var D=0,P=l.length-1;i>=l.frozen?n&&(r==_.Cell||r==_.ColumnHeader)&&o._vtCols<l.length&&w&&(D=w.leftCol,P=w.rightCol):P=l.frozen-1;for(var I=i-1;I>=D&&this._mergeCell(e,t,I,t,i);I--)d.col=I;for(var R=i+1;R<=P&&this._mergeCell(e,t,i,t,R);R++)d.col2=R;for(;d.col<i&&!l[d.col].visible;)d.col++;if(!d.isSingleCell)return d}return null},e.prototype._mergeCell=function(e,t,i,n,o){var r=e.rows[t],s=e.rows[n];if(!r||!s)return!1;if(r instanceof M||r instanceof W||s instanceof M||s instanceof W)return!1;var l=e.grid.editableCollectionView,a=l?l.currentAddItem:null;if(a&&(r.dataItem==a||s.dataItem==a))return!1;if(t!=n&&e.rows.isFrozen(t)!=e.rows.isFrozen(n))return!1;if(i!=o&&e.columns.isFrozen(i)!=e.columns.isFrozen(o))return!1;if(t!=n){if(i>0&&(r.allowMerging&&this._mergeCell(e,t,i-1,t,i)||s.allowMerging&&this._mergeCell(e,n,i-1,n,i)))return!1;if(o<e.columns.length-1&&(r.allowMerging&&this._mergeCell(e,t,o,t,o+1)||s.allowMerging&&this._mergeCell(e,n,o,n,o+1)))return!1}return e.getCellData(t,i,!0)==e.getCellData(n,o,!0)},e}(),U=function(){function e(t,i){var n;if(this._row=-1,this._col=-1,this._edge=0,i instanceof Element){if((0,s.closest)(i,".wj-flexgrid")!=t.hostElement)return;t=i,this._target=i}if(!(t instanceof Element)||t instanceof N){if(t instanceof N)this._target=t.hostElement,n=this._g=t;else{if(!(t instanceof w))throw"First parameter should be a FlexGrid or GridPanel.";this._target=t.hostElement,this._p=t,n=this._g=this._p.grid}i instanceof MouseEvent&&(this._target=i.target,"mousedown"==i.type&&(n._rcBounds=null)),i=(0,s.mouseToPage)(i),this._pt=i.clone();var o=n.controlRect,r=n._szClient,l=n.topLeftCells,a=n._eTL,h=n.headersVisibility,c=R,u=h&c.Row?l.columns.getTotalSize():0,d=h&c.Column?l.rows.getTotalSize():0,p=h&c.Column?d+a.offsetTop:0,f=n._eBL,g=f.offsetHeight;if(i.x-=o.left,i.y-=o.top,n.rightToLeft&&(i.x=o.width-i.x),this._p||i.x>=0&&i.y>=a.offsetTop&&r&&i.x<=r.width+u&&i.y<=r.height+d&&(i.y<p?this._p=i.x<u?n.topLeftCells:n.columnHeaders:i.y<f.offsetTop?this._p=i.x<u?n.rowHeaders:n.cells:this._p=i.x<u?n.bottomLeftCells:n.columnFooters),null!=this._p){var m=this._p.rows,v=this._p.columns,b=this._p.cellType,y=_,C=this._p._getFrozenPos(),x=b==y.TopLeft||b==y.ColumnHeader?d:b==y.BottomLeft||b==y.ColumnFooter?g:m.getTotalSize(),E=b==y.TopLeft||b==y.BottomLeft||b==y.RowHeader?u:v.getTotalSize();b==y.RowHeader||b==y.Cell?(i.y-=d,(i.y>C.y||C.y<=0)&&(i.y-=n._ptScrl.y,i.y+=this._p._getOffsetY())):b!=y.BottomLeft&&b!=y.ColumnFooter||(i.y-=f.offsetTop),b!=y.ColumnHeader&&b!=y.Cell&&b!=y.ColumnFooter||(i.x-=u,(i.x>C.x||C.x<=0)&&(i.x-=n._ptScrl.x)),b!=y.ColumnHeader&&b!=y.TopLeft||(i.y-=p-d),this._edge=0;var S=e._SZEDGE[this._g.isTouching?1:0];if(this._g.isTouching&&(S=e._SZEDGE[1],i.x-=S/2),this._row=i.y>x?-1:m.getItemAt(i.y),this._col=i.x>E?-1:v.getItemAt(i.x),this._row<0||this._col<0)return void(this._p=null);if(this._col>-1){var D=v[this._col];i.x-D.pos<=S&&(this._edge|=1);var P=D.pos+D.renderSize-i.x;P<=S&&(this._edge|=4,P<=S/2&&(this._edge|=16))}if(this._row>-1){var I=m[this._row];i.y-I.pos<=S&&(this._edge|=2);var T=I.pos+I.renderSize-i.y;T<=S&&(this._edge|=8,T<=S/2&&(this._edge|=32))}}}else{var H=(0,s.closest)(t,".wj-cell"),j=H?H[w._INDEX_KEY]:null;j&&(this._target=t,this._row=j.row,this._col=j.col,this._rng=j.rng,this._p=j.panel,this._g=j.panel.grid)}}return Object.defineProperty(e.prototype,"point",{get:function(){return this._pt},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellType",{get:function(){return this._p?this._p.cellType:_.None},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"panel",{get:function(){return this._p},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){return this._p?this._p.grid:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!0,configurable:!0}),e.prototype.getRow=function(){return this._p&&this._row>-1?this._p.rows[this._row]:null},Object.defineProperty(e.prototype,"col",{get:function(){return this._col},enumerable:!0,configurable:!0}),e.prototype.getColumn=function(e){var t=this._p,i=t&&this._col>-1?t.columns[this._col]:null;if(i&&e){var n=t.grid;i=t.cellType===_.ColumnHeader&&n._hasColumnGroups()?n._getColumnGroup(this._row,this._col):n._getBindingColumn(t,this._row,i)}return i},Object.defineProperty(e.prototype,"range",{get:function(){return this._rng||(this._rng=new m(this._row,this._col)),this._rng},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"edgeLeft",{get:function(){return 0!=(1&this._edge)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"edgeTop",{get:function(){return 0!=(2&this._edge)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"edgeRight",{get:function(){return 0!=(4&this._edge)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"edgeFarRight",{get:function(){return 0!=(16&this._edge)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"edgeBottom",{get:function(){return 0!=(8&this._edge)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"edgeFarBottom",{get:function(){return 0!=(32&this._edge)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),e._SZEDGE=[6,30],e}();function Y(){return(0,s._getModule)("wijmo.input")}var J="$WJ-MSKP",X=function(){function e(){}return e.prototype.updateCell=function(t,i,n,r,l,a){var h=t.grid,c=h.rightToLeft,u=t.rows,d=t.columns,p=u[i],f=d[n],g=i,v=n,y=p instanceof M?p:null,w=p instanceof W?p:null,C=f.renderWidth,E=p.renderHeight,S=t.cellType,D="wj-cell",P="",I={display:""},R=_;0!=a&&r.firstElementChild&&(1==r.childNodes.length&&"checkbox"==r.firstElementChild.type||(r.textContent="")),l&&!l.isSingleCell&&(i=l.row,n=l.col,g=l.row2,v=l.col2,p=u[i],f=d[n],y=p instanceof M?p:null,E=(K=l.getRenderSize(t)).height,C=K.width);var T=h._getBindingColumn(t,i,f),H=T.dataType||p.dataType,j=T.dataMap||p.dataMap,k=S==R.Cell?h._getMapEditor(p,T):null,O=S==R.RowHeader||S==R.Cell&&(!y||h.childItemsPath),A=O&&k==o.RadioButtons,L=H==s.DataType.Boolean&&!j,z=T.isContentHtml||p.isContentHtml,B=f.pos,F=p.pos,V=h._ptScrl;if(h._useFrozenDiv()&&S==R.Cell&&!h.editRange)n<d.frozen&&g>=u.frozen?F+=V.y:i<u.frozen&&v>=d.frozen&&(B+=V.x);else{var K=h._szClient;g<u.frozen&&(F=Math.min(F,K.height),E=Math.min(E,Math.max(0,K.height-F)),F-=V.y),v<d.frozen&&(B=Math.min(B,K.width),C=Math.min(C,Math.max(0,K.width-B)),B-=V.x)}c?I.right=B+"px":I.left=B+"px",g>=u.frozen&&(F-=t._getOffsetY()),I.top=F+"px",I.width=C+"px",I.height=E+"px",I.zIndex="",(i<u.frozen||n<d.frozen)&&(I.zIndex=i<u.frozen&&n<d.frozen?2:1);var G=!1,q=h.alternatingRowStep;if(!q||l&&l.row!=l.row2||(G=p.visibleIndex%(q+1)==0,1==q&&(G=!G)),S==R.Cell)y&&(D+=" wj-group"),G&&(D+=" wj-alt"),(i<u.frozen||n<d.frozen)&&(D+=" wj-frozen"),w&&(D+=" wj-new"),p.cssClass&&(D+=" "+p.cssClass),T.cssClass&&(D+=" "+T.cssClass);else{D+=" wj-header",G&&(D+=" wj-header-alt"),p.cssClass&&S==R.ColumnHeader&&(D+=" "+p.cssClass),T.cssClass&&S==R.RowHeader&&(D+=" "+T.cssClass);var U=!1;S!=R.ColumnHeader&&S!=R.TopLeft||h.allowResizing&le.Columns&&(U=null!=h._mouseHdl._getResizeCol(t,v)),U||S!=R.RowHeader||h.allowResizing&le.Rows&&(U=null!=h._mouseHdl._getResizeRow(t,g)),U&&(D+=" wj-big-header")}p.cssClassAll&&(D+=" "+p.cssClassAll),T.cssClassAll&&(D+=" "+T.cssClassAll);var X=b,ne=t.getSelectedState(i,n,l);switch(ne!=X.None&&S==R.Cell&&!L&&h.editRange&&h.editRange.contains(i,n)&&(ne=X.None),ne){case X.Active:D+=" wj-state-active";break;case X.Cursor:D+=" wj-state-selected wj-state-active";break;case X.Selected:D+=" wj-state-multi-selected"}g==u._lastFrozen&&(D+=" wj-frozen-row"),v==d._lastFrozen&&(D+=" wj-frozen-col"),(T.wordWrap||p.wordWrap)&&(D+=" wj-wrap"),(T.multiLine||p.multiLine)&&(D+=" wj-multiline");var oe=T.getAlignment(p);oe&&(P=" wj-align-"+oe);var re=S,se=h._isTransposed(),ae=(re==R.ColumnHeader&&!se||re==R.RowHeader&&se)&&h._hasColumnGroups()?h._getColumnGroup(i,n):null;if(ae&&ae.align&&(P=" wj-align-"+ae.align),I.paddingLeft=I.paddingRight=I.paddingTop=I.paddingBottom="",S==R.Cell&&h.rows.maxGroupLevel>-1&&n==d.firstVisibleIndex&&h.treeIndent){var ce=y?Math.max(0,y.level):u.maxGroupLevel+1,ue=Math.min(h.treeIndent*ce+h._cellPadLeft,C-h._cellPadHorz)+"px";c?I.paddingRight=ue:I.paddingLeft=ue}C<=h._cellPadHorz&&null==r.getAttribute(N._WJS_MEASURE)&&(I.paddingLeft=I.paddingRight=0);var de=S==R.Cell&&n==d.firstVisibleIndex&&y&&y.hasChildren&&!Q(h,i,n);if(de&&(P=""),0!=a){var pe=t.getCellData(i,n,!1),fe=t.getCellData(i,n,!0);if(de){var _e=te(y);fe=y.getGroupHeader()||(0,s.escapeHtml)(fe),r.innerHTML=_e.outerHTML+" "+fe}else if(S!=R.ColumnHeader||g!=h._getSortRowIndex()&&T==f)if(S==R.RowHeader&&!fe&&function(){var e=!1;if(n==h._getEditColumnIndex()){var t=h.editableCollectionView,i=t?t.currentEditItem:null;fe=r.innerHTML=i&&p.dataItem==i?ie("pencil"):p instanceof W?ie("asterisk"):"",e=!0}var o=T._tpl;return o&&(Z(o,r,pe,fe,p,T),e=!0),e}());else if(S!=R.Cell||H!=s.DataType.Boolean||j||y&&!(0,s.isBoolean)(pe))if(S==R.Cell&&!A&&Q(h,i,n)){var ge=T.inputType||p.inputType;if(ge||(ge=H!=s.DataType.Number||j?"text":"tel"),!j&&!T.mask&&!p.mask){var me=t.getCellData(i,n,!1);(0,s.isNumber)(me)&&(fe=function(e,t){t=t||"n";var i=s.Globalize._parseNumericFormat(t);switch(i.spec){case"d":case"x":break;case"e":t=t.replace(/[0-9]/g,"");break;default:t="p"==i.spec?"P15":"r",i.scale&&(t+=Array(i.scale/3+1).join(","))}return s.Globalize.formatNumber(e,t,!0)}(me,T.format||p.format))}r.innerHTML=(T.multiLine||p.multiLine)&&"checkbox"!=ge?'<textarea wrap="soft"></textarea>':'<input type="'+ge+'"/>';var ve=r.children[0];(0,s.addClass)(ve,"wj-grid-editor wj-form-control"),(0,s.disableAutoComplete)(ve),z&&j&&!j.isEditable&&(fe=(0,s.toPlainText)(fe)),ve.value=fe,ve.tabIndex=-1,ve.required=T.getIsRequired(p),(0,s.setAttribute)(ve,"aria-required",ve.required);var be=T.maxLength||p.maxLength;be&&(ve.maxLength=be),ve.style.textAlign=T.getAlignment(p);var ye=T.mask||p.mask;ye&&(ve[J]=new s._MaskProvider(ve,ye)),h.showPlaceholders&&(ve.placeholder=T.header),h._edtHdl._edt=ve}else{if(A){var we=[],Ce=t.getCellData(i,n,!1);j.getDisplayValues(p.dataItem).forEach((function(e){var t=j.getKeyValue(e)==Ce?" checked":"",i=h.isReadOnly||p.isReadOnly||f.isReadOnly?" disabled":"",n=(0,s.escapeHtml)(e);we.push('<label><input type="radio" tabindex="-1"'+t+i+' value="'+n+'"><span>'+n+"</span></label>")})),r.innerHTML=we.join(" "),D+=" "+e._WJC_RADIOMAP}var xe=O?T._tpl:null;if(xe?Z(xe,r,pe,fe,p,T):A||(S==R.Cell&&z?r.innerHTML=fe:r.textContent=fe||""),ae&&ae.collapseTo){var Ee=ae._rng;if(Ee&&(S==R.ColumnHeader&&Ee.columnSpan>1||S==R.RowHeader&&Ee.rowSpan>1)){var Se=ae.isCollapsed;r.innerHTML='<div role="button" class="'+e._WJC_COLLAPSE+'">'+ie(Se?"plus":"minus")+"</div>&nbsp;"+r.innerHTML,Se&&(0,s.addClass)(r,"wj-state-collapsed")}}}else{var De=r.firstChild;h._isNativeCheckbox(De)||(r.innerHTML='<label><input type="checkbox" class="'+e._WJC_CHECKBOX+'" tabindex="-1"/><span></span></label>',De=r.querySelector("input")),(0,s.setChecked)(De,pe),De.disabled=!h.canEditCell(i,n),De.disabled&&(De.style.cursor="default"),h.editRange&&h.editRange.contains(i,n)&&(h._edtHdl._edt=De)}else{r.innerHTML=(0,s.escapeHtml)(fe);var Pe=T.currentSort;Pe&&h.showSort&&(D+=" wj-sort-"+("+"==Pe?"asc":"desc"),r.innerHTML+="&nbsp;"+function(e){var t=ie("+"==e.currentSort?"up":"down"),i=e.grid.collectionView;if(i&&i.sortDescriptions.length>1){var n=e.currentSortIndex;n>-1&&(t+='<span class="wj-sort-index">'+(n+1)+"</span>")}return t}(T)),h.allowPinning&&(0,s.contains)(h.hostElement,r)&&ee(r,n<h.frozenColumns)}if(k==o.DropDownList&&h.showDropDown&&h.canEditCell(i,n)&&Y()){var Ie=$();r.insertBefore(Ie,r.firstChild),Q(h,i,n)&&(D+=" wj-hasdropdown")}}if(S==R.RowHeader||S==R.ColumnHeader){var Re=S==R.RowHeader?!y&&!w&&p.allowDragging&&0!=(h.allowDragging&he.Rows):(ae||f).allowDragging&&0!=(h.allowDragging&he.Columns);(0,s.setAttribute)(r,"draggable",Re?"true":null)}D+=P,r.className!=D&&(r.className=D);var Te=r.style;for(var He in I)Te[He]!==I[He]&&(Te[He]=I[He]);if(h._edtHdl._edt&&h._edtHdl._edt.parentElement==r){var je=h._root,ke=je.getBoundingClientRect(),Me=r.getBoundingClientRect(),Oe=ke.top+je.clientHeight-Me.top,Ae=ke.left+je.clientWidth-Me.left;Me.height>Oe&&(r.style.height=Oe+"px"),Me.width>Ae&&(r.style.width=Ae+"px")}if((S==R.Cell||S==R.RowHeader)&&h._getShowErrors()){var Le=h._getError(t,i,n,!1);h._edtHdl._setCellError(r,Le)}if(h.itemFormatter&&h.itemFormatter(t,i,n,r),h.formatItem.hasHandlers){var ze=e._fmtItemArgs;ze?(ze._p=t,ze._rng.setRange(i,n,g,v),ze._cell=r):ze=e._fmtItemArgs=new x(t,new m(i,n,g,v),r),ze._updateContent=!1!==a,h.onFormatItem(ze)}},e.prototype.disposeCell=function(e){},e.prototype.getEditorValue=function(e){var t=e._edtHdl._edt;if(t instanceof HTMLInputElement)switch(t.type){case"checkbox":return t.checked;case"radio":return t.value}if(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement){var i=t[J],n=i?i._applyMask():t.value,o=t.maxLength;if((0,s.isNumber)(o)&&o>-1&&n.length>o){var r=s.culture.Globalize.numberFormat["%"]||"%",l=n.length&&n[n.length-1]==r;n=n.substr(0,o),l&&n.indexOf(r)<0&&(n+=r)}return n}return null},e._WJC_RADIOMAP="wj-radio-map",e._WJC_CHECKBOX="wj-cell-check",e._WJC_COLLAPSE="wj-elem-collapse",e._WJC_DROPDOWN="wj-elem-dropdown",e._WJC_PIN="wj-elem-pin",e._tplDdBtn=ne(e._WJC_DROPDOWN,"down"),e._tplCtx={row:null,col:null,value:null,text:null,item:null},e}();function Z(e,t,i,n,o,r){var l=X._tplCtx;l.value=i,l.text=n,l.item=o.dataItem,l.row=o,l.col=r;var a=(0,s.isString)(e)?(0,s.evalTemplate)(e,l):e(l,t);null!=a&&(t.innerHTML=a)}function Q(e,t,i){return e.editRange&&e.editRange.contains(t,i)}function $(){var e=X._ddBtn;return e||(e=X._ddBtn=(0,s.createElement)(X._tplDdBtn),(0,s.setAriaLabel)(e,s.culture.FlexGrid.ariaLabels.toggleDropDown),(0,s.setAttribute)(e,"aria-expanded",!1)),e.cloneNode(!0)}function ee(e,t){var i=ne(X._WJC_PIN,"pin"),n=(0,s.createElement)(i);(0,s.toggleClass)(n,"wj-state-pinned",t),(0,s.setAttribute)(n,"aria-pressed",t),e.insertBefore(n,e.firstChild)}function te(e){var t=X._WJC_COLLAPSE,i=(e.isCollapsed?"":"down-")+(e.grid.rightToLeft?"left":"right"),n=(0,s.createElement)('<button class="wj-btn wj-btn-glyph '+t+'" type="button" tabindex="-1">'+ie(i)+"</button>");return(0,s.setAriaLabel)(n,s.culture.FlexGrid.ariaLabels.toggleGroup),(0,s.setAttribute)(n,"aria-expanded",!e.isCollapsed),n}function ie(e){return'<span class="wj-glyph-'+e+'"></span>'}function ne(e,t){return'<button class="wj-btn wj-btn-glyph wj-right {cls}" type="button" tabindex="-1">{glyph}</button>'.replace("{cls}",e).replace("{glyph}",ie(t))}var oe,re=function(){function e(e){var t=this;this._rng=null,this._edt=null,this._edItem=null,this._edtCanceled=!1,this._list=null,this._mapSearch=null,this._fullEdit=!1,this._evtInput=null,this._evtChange=null,this._cstEdtValue=null,this._validating=!1,this._composing=!1,this._g=e,this._evtInput=document.createEvent("HTMLEvents"),this._evtInput.initEvent("input",!0,!1),this._evtChange=document.createEvent("HTMLEvents"),this._evtChange.initEvent("change",!0,!1),e.selectionChanging.addHandler((function(i,n){if(t.finishEditing()){var o=e._selHdl.selection.row;if(o!=n.row){var r=e.rows.length;(o>-1&&o<r?e.rows[o].dataItem:null)!=(n.row>-1&&n.row<r?e.rows[n.row].dataItem:null)&&t._commitRowEdits()}}else n.cancel=!0})),e.lostFocus.addHandler((function(){var e=(0,s.getActiveElement)();e&&"fixed"==getComputedStyle(e).position?t.finishEditing():t._commitRowEdits()}));var i=e.hostElement;e.addEventListener(i,"mousedown",(function(i){if(!i.defaultPrevented&&0==i.button&&!e._mouseHdl._szRowCol){var n=e.hitTest(i);n.cellType!=_.Cell&&n.cellType!=_.None&&(t.finishEditing()||t.finishEditing(!0))}}),!0),e.addEventListener(i,"compositionend",(function(){t._composing=!1,t._keypress.bind(t)})),e.addEventListener(i,"compositionstart",(function(){t._composing=!0}))}return e.prototype.startEditing=function(e,t,i,n,r){void 0===e&&(e=!0);var l=this._g,a=l._selHdl.selection;if(t=(0,s.asNumber)(t,!0,!0),i=(0,s.isString)(i)?l.columns.indexOf(i):(0,s.asNumber)(i,!0,!0),null==t&&(t=a.row),null==i&&(i=a.col),null==n&&(n=!0),!this._allowEdit(t,i))return!1;var h=l.getMergedRange(l.cells,t,i,!1);h||(h=new m(t,i));var c=l.rows[t].dataItem;if(l.scrollIntoView(h.row,h.col,!0),!l.select(h,!0))return!1;if(!l.rows[t]||c!=l.rows[t].dataItem)return!1;if(this.activeEditor){if(h.equals(this._rng))return!0;if(!this.finishEditing())return!1}var u=new C(l.cells,h,r);if(!l.onBeginningEdit(u))return!1;var d=l.editableCollectionView,p=!1;d&&((p=(c=l.rows[t].dataItem)!=d.currentEditItem)&&l.onRowEditStarting(u),d.editItem(c),p&&(l.onRowEditStarted(u),this._edItem=c));var f=l.rows[t],_=l._getBindingColumn(l.cells,t,l.columns[i]),g=_.dataMap||f.dataMap,v=o.RadioButtons,b=f.dataMap&&f.dataMapEditor==v||_.dataMap&&_.dataMapEditor==v;if(this._fullEdit=(0,s.asBoolean)(e),this._rng=h,this._list=null,g&&!b&&!_.editor){var y=g.getDisplayValues(c);(_.isContentHtml||f.isContentHtml)&&(y=y.map((function(e){return(0,s.toPlainText)(e)}))),this._list=y,this._mapSearch=g.search}if(b){var w=l._activeCell||l.hostElement.querySelector(".wj-cell.wj-state-active");if(w){var x=r?r.target:null;x instanceof HTMLSpanElement&&(x=(0,s.closest)(x,"label")),x instanceof HTMLLabelElement&&(x=x.querySelector("input")),this._edt=x instanceof HTMLInputElement?x:w.querySelector("input"),this._updateRowHeaderCell(t)}}else h.isSingleCell?this._updateEditorCell(t,i,p):l.refresh(!1);var E=this._edt;if(E){if("checkbox"==E.type||"radio"==E.type)this._fullEdit=!1;else if(n){var S=0,D=E.value.length,P=!1,I=s.culture.Globalize.numberFormat["%"]||"%",R=l.getCellData(t,i,!1);if((0,s.isNumber)(R)?P=E.value.indexOf(I)>-1:null==R&&(P=/^p/i.test(_.format))&&E.value.indexOf(I)<0&&(E.value+=I),P){var T=E.value;for(S=0,D=T.length;D>0&&(T[D-1]==I||" "==T[D-1]);)D--;for(;S<D&&T[S]==I;)S++}r&&"keydown"==r.type&&r.keyCode==s.Key.Space&&(S=D),(0,s.setSelectionRange)(E,S,D),(0,s.isIE)()&&"right"==E.style.textAlign&&(E.style.paddingRight="1px")}l.onPrepareCellForEdit(u)}return n&&!l.containsFocus()&&l.focus(),null!=E&&!E.disabled&&!E.readOnly},e.prototype.finishEditing=function(e){var t=this._edt;if(!t)return this._removeListBox(),!0;var i=this._g,n=this._rng,o=new E(i.cells,n),r=i.containsFocus();if(!e){var l=i.hostElement.querySelector(".wj-control.wj-state-focused");if(l){var a=s.Control.getControl(l);a&&(a.containsFocus()||a._focus)&&a.onLostFocus(o)}}if(o.cancel=e,!e&&i.validateEdits&&(f=this._getValidationError())){o.cancel=!0;var h=i.cells.getCellElement(n.row,n.col);h&&(this._setCellError(h,f),o.stayInEditMode=!0)}if(this._cstEdtValue=null,o.data=i.cells.getCellData(n.topRow,n.leftCol,!1),!i.onCellEditEnding(o)&&o.stayInEditMode)return r?setTimeout((function(){t.select()})):t.select(),this._fullEdit=!0,!1;if(!o.cancel){for(var c=this._cstEdtValue,u=c&&!(0,s.isUndefined)(c.value)?c.value:i.cellFactory.getEditorValue(i),d=n.topRow;d<=n.bottomRow&&d<i.rows.length;d++)for(var p=n.leftCol;p<=n.rightCol&&p<i.columns.length;p++){var f,_=i._getBindingColumn(i.cells,d,i.columns[p]),g=i.rows[d],m=_&&_.dataMap||g&&g.dataMap,v=!m||m.serializeKeys;if(!i.cells.setCellData(d,p,u,v,!1)&&i.validateEdits)if(f=this._getValidationError(!0)){o.cancel=!0;var b=i.cells.getCellElement(n.row,n.col);return b&&(this._setCellError(b,f),o.stayInEditMode=!0),!1}}t.value==this._edtValue&&t.dispatchEvent(this._evtChange)}this._edt=null,this._rng=null,this._list=null,this._edtValue=null,this._edtCanceled=o.cancel,this._removeListBox();var y=(0,s.closest)(t,".wj-cell");return(0,s.contains)(y,(0,s.getActiveElement)())&&i._setFocusNoScroll(y),!o.cancel&&o.refresh&&i._refreshOnEdit?i.refresh(!1):this._updateEditorCell(n.row,n.col,!1),r&&i.focus(),i.onCellEditEnded(o),!0},e.prototype._setCustomEditorValue=function(e){this._cstEdtValue={value:e}},e.prototype._setCellError=function(e,t){var i=this._g;""==t&&(t=null),(0,s.toggleClass)(e,"wj-state-invalid",null!=t);var n=i.errorTip,o=i.activeEditor;n?(n.setTooltip(e,t),o&&(0,s.contains)(e,o)&&(0,s.setAttribute)(o,"title","")):(0,s.setAttribute)(e,"title",t),o&&e==i.activeCell&&!(0,s.contains)(e,o)&&n&&n.setTooltip(o,t)},Object.defineProperty(e.prototype,"activeEditor",{get:function(){return this._edt},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editRange",{get:function(){return this._rng},enumerable:!0,configurable:!0}),e.prototype.getClipString=function(e,t,i,n){var o,r=this,l=this._g,a=l.selectionMode,h=[],c=0!=(t&T.CSV),u=c?"\r\n":"\n",d=c?",":"\t",p=0!=(t&T.InvisibleRows),f=v,_=null!=e;if(!e&&a!=f.ListBox)for(var g=l.rows,m=0;m<g.length;m++)if(g[m].isSelected){a=f.ListBox;break}if(!e)switch(l._selHdl._expandSelection(),e=l.selection,a){case f.Row:case f.RowRange:case f.ListBox:e.col=0,e.col2=l.columns.length-1;break;case f.MultiRange:var b=l.selectedRanges;if(b.length>1){var y=this._sameCols(b),w=this._sameRows(b);if(y||w){(b=b.slice()).sort((function(e,t){return e.topRow-t.topRow||e.leftCol-t.leftCol}));for(var C=0;C<b.length;C++)for(var x=b[C],E=C+1;E<b.length;E++)x.contains(b[E])&&(b.splice(E,1),E--);if(y){var S=[];return b.forEach((function(e){S.push(r.getClipString(e,t,i,n)),i=!1})),S.join(u)}var D;if(w)return b.forEach((function(e){var o=r.getClipString(e,t,i,n).split(u);null==D?(D=o,n=!1):o.forEach((function(e,t){D[t]+=d+e}))})),D.join(u)}}}var P=e.col>-1&&e.col2>-1;if(i&&P&&(o=l.columnHeaders).rows.forEach((function(i,s){if(p||i.isVisible){var l=r._getRowClipString(o,s,e,t,n);h.push(l)}})),e.row>-1&&e.row2>-1)if(o=l.cells,a!=f.ListBox||_){for((0,s.assert)(e.bottomRow<o.rows.length,"Row index must be less than the number of rows."),C=e.topRow;C<=e.bottomRow;C++)if(p||o.rows[C].isVisible){var I=this._getRowClipString(o,C,e,t,n);h.push(I)}}else o.rows.forEach((function(i,s){if(i.isSelected&&(p||i.isVisible)){var l=r._getRowClipString(o,s,e,t,n);h.push(l)}}));return h.join(u)},e.prototype._getRowClipString=function(e,t,i,n,o){var r=[],l=e.rows[t],a=T,h=0!=(n&a.CSV),c=0!=(n&a.InvisibleColumns),u=0==(n&a.Unformatted),d=0!=(n&a.SkipMerged);if(l.isVisible){if(o)for(var p=e.cellType==_.ColumnHeader?e.grid.topLeftCells:e.grid.rowHeaders,f=0;f<p.columns.length;f++)if(c||p.columns[f].isVisible){var g=p.getCellData(t,f,!0);d&&this._skipMergedCell(e,null,t,f)&&(g=""),r.push(this._getCellClipString(g,n))}if(i.col>-1&&i.col2>-1)for((0,s.assert)(i.rightCol<e.columns.length,"Column index must be less than the number of columns."),f=i.leftCol;f<=i.rightCol;f++)(c||e.columns[f].isVisible)&&(!(g=e.getCellData(t,f,u))&&l instanceof M&&f==e.columns.firstVisibleIndex&&(g=(0,s.toPlainText)(l.getGroupHeader())),d&&this._skipMergedCell(e,null,t,f)&&(g=""),r.push(this._getCellClipString(g,n)))}return r.join(h?",":"\t")},e.prototype._skipMergedCell=function(e,t,i,n){var o=e.grid.getMergedRange(e,i,n,!1);return!(!o||(t&&(o.row=Math.max(t.topRow,o.row),o.col=Math.max(t.leftCol,o.col)),o.row==i&&o.col==n))},e.prototype._getCellClipString=function(e,t){(0,s.isString)(e)||(e=(0,s.isDate)(e)?e.toJSON():null!=e?e.toString():""),e=e.replace(/\t/g," ");var i=0!=(t&T.QuoteAll);return(i=i||/\n|^"|"$/.test(e))||0==(t&T.CSV)||(i=e.indexOf(",")>-1),i&&(e='"'+(e=e.replace(/"/g,'""'))+'"'),e},e.prototype._sameRows=function(e){for(var t=e[0],i=1;i<e.length;i++)if(e[i].topRow!=t.topRow||e[i].bottomRow!=t.bottomRow)return!1;return!0},e.prototype._sameCols=function(e){for(var t=e[0],i=1;i<e.length;i++)if(e[i].leftCol!=t.leftCol||e[i].rightCol!=t.rightCol)return!1;return!0},e.prototype.setClipString=function(e,t){var i=this,n=this._g,o=n.editableCollectionView,r=null==t,l=v;if(r)switch(n._selHdl._expandSelection(),t=n.selection,n.selectionMode){case l.Row:case l.RowRange:case l.ListBox:t.col=0,t.col2=n.columns.length-1;break;case l.MultiRange:var a=n.selectedRanges;if(a.length>1)return o&&o.beginUpdate(),a.forEach((function(t){n.setClipString(e,t)})),o&&o.endUpdate(),void(n.selectedRanges=a)}t=(0,s.asType)(t,m);var h=this._parseClipString((0,s.asString)(e));!r&&h.length>t.rowSpan&&(h=h.slice(0,t.rowSpan)),this._expandClipRows(h,t);var c=0;if(h.length)for(var u=t.leftCol,d=n.columns.length,p=0;p<h[0].length;p++)for(var f=u+p+c;f<d&&!n.columns[f].visible;)c++,f++;var _=r?new m(t.topRow,t.leftCol,Math.min(t.topRow+h.length-1,n.rows.length-1),Math.min(t.leftCol+h[0].length-1+c,n.columns.length-1)):t,g=new C(n.cells,_,e);if(!n.onPasting(g))return!1;_=new m(t.topRow,t.leftCol);var b=new C(n.cells,new m(t.topRow,-1)),y=n.rows.slice(t.topRow,t.bottomRow+1).some((function(e){return!0===e.isReadOnly})),w=!1,x=0,E=t.topRow,S=n.rows,D=n.columns,P=n._getRowsPerItem(),I=h.length>P,R=this._deferPaste(t,h.length);if((0,s.assert)(P>=1,"Invalid RPI value = "+P),n.deferUpdate((function(){if(!y){var e=-1;o&&R&&(e=o.currentPosition,o.beginUpdate());for(var r=0;r<h.length&&E<S.length;r++,E++){var l=S[E];if(l.isVisible){var a=l.dataItem,c=o?o.currentEditItem:null;if(c&&a!=c&&(n.onRowEditEnding(b),n.onRowEditEnded(b)),l instanceof W&&o){if(R){if(l.dataItem=o.addNew(),b._rng.setRange(n.newRowAtTop?0:E,-1),!n.onRowEditStarting(b)){E--,o.cancelNew();continue}n.onRowEditStarted(b)}else if(1==P||(E+1)%P==1){if(b._rng.setRange(n.newRowAtTop?E%P:E,-1),!n.onRowEditStarting(b)){E--;continue}n.onRowEditStarted(b)}}else a!=c&&(b._rng.setRange(E,-1),n.onRowEditStarting(b),n.onRowEditStarted(b));for(var u=h[r],d=t.leftCol,p=0;p<u.length&&d<D.length;p++,d++){var f=D[d];if(f.isVisible){var g=n.getMergedRange(n.cells,E,d,!1);if((!g||g.leftCol==d&&g.topRow==E)&&i._allowEdit(E,d)){var v=u[p],T=v.length;T>1&&'"'==v[0]&&'"'==v[T-1]&&v.indexOf("\n")>-1&&(v=v.substr(1,T-2));var H=f.maxLength||l.maxLength;H&&(v=v.substr(0,H));var j=new C(n.cells,new m(E+x,d),v);if(n.onPastingCell(j)){o&&(o.editItem(a),i._edItem=o.currentEditItem);var k=n.getCellData(E,d,!1),M=j.data,O=Y();if(O){var A=n._getBindingColumn(n.cells,E,n.columns[d]),L=A.editor,z=null,B=null;L instanceof O.InputNumber?(z=L.clamp.bind(L),B=s.DataType.Number):(L instanceof O.InputDate||L instanceof O.InputTime)&&(z=L._clamp.bind(L),B=s.DataType.Date),z&&(M=(0,s.changeType)(M,B,A.format,k),(0,s.getType)(M)==B&&(M=z(M)))}n.setCellData(E,d,M)&&(j.data=k,n.onPastedCell(j),w=!0)}_.row2=Math.max(_.row2,E+x),_.col2=Math.max(_.col2,d)}}else p--}if(i._edItem&&o instanceof s.CollectionView){var F=new s.NotifyCollectionChangedEventArgs(s.NotifyCollectionChangedAction.Change,i._edItem,E);o.onCollectionChanged(F)}l instanceof W&&o&&(R?(l.dataItem=null,w?(b._rng.setRange(n.newRowAtTop?0:E,-1),n.onRowEditEnding(b),n.onRowEditEnded(b),E--,x++,o.commitNew()):o.cancelNew()):I&&P>1&&(E+1)%P==0&&w&&(b._rng.setRange(n.newRowAtTop?E%P:E,-1),n.onRowEditEnding(b),n.onRowEditEnded(b),E-=P,x++))}else r--}if(o)if(R)o.currentEditItem&&(o.commitEdit(),n.onRowEditEnding(b),n.onRowEditEnded(b)),o.moveCurrentToPosition(e),o.endUpdate(!0);else{var V=o.currentAddItem;!V&&0==t.row&&n.newRowAtTop&&S[0]instanceof W&&(V=S[0].dataItem),V&&(o.editItem(V),i._edItem=V)}}_.rowSpan>1&&0==_.topRow&&S[0]instanceof W&&(_.row=_.row2=0),n.select(_)})),n.onPasted(g),w&&(0,s.closest)(n.hostElement,"form")){var T=document.createEvent("HTMLEvents"),H=(0,s.createElement)("<input>",n.hostElement);T.initEvent("change",!0,!1),H.dispatchEvent(T),(0,s.removeChild)(H)}},e.prototype._deferPaste=function(e,t){var i=this._g.rows,n=i.length;if(t>1){if(n>1&&i[0].dataItem!=i[1].dataItem)return!0;if(1==n&&i[0]instanceof W)return!0}return!1},e.prototype._parseClipString=function(e){var t=[],i=(e=(e=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n")).replace(/\n$/,"")).length,n=function(e){return"\n"===e||"\t"===e},o=0,r=0;for(o=0;o<i;o++){var s=!1,l=!1,a=!1;if('"'===e[o]){for(var h=!1,c=!1,u=o+1;u<i;u++){var d=e[u];if('"'===d){var p=u+1;p<i?n(e[p])&&(c=!0):c=!0}else!h&&n(d)&&(h=!0);if(c)break}c&&h&&(s=!0)}for(r=o;r<i&&!a;r++){var f=e[r];'"'===f?s&&(l=!l):n(f)&&!l&&(this._parseClipCell(t,e,o,r,"\n"==f),o=r,r==i-1&&(o=r+1),a=!0)}if(r==i){this._parseClipCell(t,e,o,r,!1);break}}return 0==t.length&&t.push([""]),t},e.prototype._parseClipCell=function(e,t,i,n,o){e.length||e.push([]);var r=t.substr(i,n-i),s=r.length;if(s>2&&'"'==r[0]&&'"'==r[s-1]){var l=r.substr(1,s-2),a=function(e){return l.indexOf(e)>-1};(a('""')||a("\t")||a("\n"))&&(r=l.replace(/""/g,'"'))}else"\t"==r&&(r="");e[e.length-1].push(r),o&&e.push([])},e.prototype._expandClipRows=function(e,t){for(var i=e.length,n=0,o=0;o<i;o++)n=Math.max(n,e[o].length);for(var r=this._g,s=0,l=0,a=t.topRow;a<=t.bottomRow;a++)r.rows[a].isVisible&&s++;for(var h=t.leftCol;h<=t.rightCol;h++)r.columns[h].isVisible&&l++;if((s>1||l>1)&&(1==s&&(s=i),1==l&&(l=n),l%n==0&&s%i==0)){for(h=n;h<l;h++)for(a=0;a<i;a++)e[a].push(e[a%i][h%n]);for(a=i;a<s;a++)e.push(e[a%i])}},e.prototype._updateEditorCell=function(e,t,i){var n=this._g,o=n.cells.getCellElement(e,t),r=n._useFrozenDiv()&&(e<n.frozenRows||t<n.frozenColumns);!o||r||n._hasPendingUpdates()?n.refresh(!1):n.onUpdatingView(new s.CancelEventArgs)&&(this._updateCell(o),(i||n._getHasValidation())&&this._updateRowHeaderCell(e),n.onUpdatedView())},e.prototype._updateRowHeaderCell=function(e){var t=this._g;if(t.headersVisibility&R.Row){var i=t.rowHeaders,n=t._getEditColumnIndex(),o=i.getCellElement(e,n);o&&this._updateCell(o)}},e.prototype._updateCell=function(e){var t=new U(e,null),i=N._WJS_UPDATING;t.panel&&((0,s.addClass)(e,i),t.grid.cellFactory.updateCell(t.panel,t.row,t.col,e,t.range),(0,s.removeClass)(e,i))},e.prototype._getValidationError=function(e){var t=this,i=this._g,n="";if(i&&this._rng&&!this._validating){var o=this._rng.row,r=this._rng.col,l=i.activeEditor,a=i.cellFactory.getEditorValue(i),h=i.getCellData(o,r,!1);if(e&&(n=i._getError(i.cells,o,r,!0)),!n&&i._getHasValidation()){if(l&&(n=l.validationMessage),!n){var c=i.columns[r],u=i.rows[o];!i._getBindingColumn(i.cells,o,c).getIsRequired(u)||null!=a&&""!==a||(n=this._getRequiredMsg())}!n&&i.setCellData(o,r,a,!0,!1)&&(n=i._getError(i.cells,o,r,!1),i.setCellData(o,r,h,!1,!1))}if(!n){var d=s.Control.getControl((0,s.closest)(l,".wj-control"));if(d&&d!=i&&d.invalidInput.hasHandlers){var p=function(e,s){s.cancel&&(n=i._getError(i.cells,o,r,!0)||t._getBadInputMsg(),s.cancel=!1)};this._validating=!0;var f=l.value;if(d.invalidInput.addHandler(p),d._containsFocus()){var _=(0,s.closest)(d.hostElement,".wj-cell");_&&_.focus()}d.onLostFocus(),d.invalidInput.removeHandler(p),l.value=f,n&&l.select(),this._validating=!1}}}return n},e.prototype._getRequiredMsg=function(){if(!e._msgRequired){var t=document.createElement("input");t.required=!0,e._msgRequired=t.validationMessage}return e._msgRequired},e.prototype._getBadInputMsg=function(){if(!e._msgBadInput){var t=document.createElement("input");t.pattern="x",t.value="a",e._msgBadInput=t.validationMessage||"Bad Input"}return e._msgBadInput},e.prototype._allowEdit=function(e,t){var i=this._g;if(i.isReadOnly||i.selectionMode==v.None)return!1;if(i.collectionView&&!i.editableCollectionView)return!1;if(null!=e){if(e<0||e>=i.rows.length)return!1;var n=i.rows[e];if(!n||n.isReadOnly||!n.isVisible)return!1}if(null!=t){if(t<0||t>=i.columns.length)return!1;var o=i._getBindingColumn(i.cells,e,i.columns[t]);if(!o||o.isReadOnly||!o.isVisible)return!1}return!0},e.prototype._commitRowEdits=function(){var e=this._g;if(this.finishEditing()&&this._edItem){var t=e.editableCollectionView;if(t&&(t.currentEditItem||t.currentAddItem)){var i=new C(e.cells,e.selection);e.onRowEditEnding(i),t.commitEdit(),e.onRowEditEnded(i)}this._edItem=null}},e.prototype._keydown=function(e){var t=this._edt;switch(e.keyCode){case s.Key.F2:return this._fullEdit=!this._fullEdit,e.preventDefault(),!0;case s.Key.F4:return this._toggleListBox(e),e.preventDefault(),!0;case s.Key.Space:return!t||"checkbox"!=t.type||t.disabled||t.readOnly||((0,s.setChecked)(t,t.indeterminate||!t.checked),this.finishEditing(),e.preventDefault()),!0;case s.Key.Enter:if(e.preventDefault(),t&&e.altKey){if(!this._composing){var i=e.target;if(i instanceof HTMLTextAreaElement&&"soft"==i.wrap){i.style.setProperty("ime-mode","auto","important");var n=i.value,o=i.selectionStart,r=i.selectionEnd;i.value=n.substr(0,o)+"\n"+n.substr(r),(0,s.setSelectionRange)(i,o+1),i.style.imeMode=""}}return!0}return t&&this._lbx?(this._toggleListBox(e),!0):!this.finishEditing();case s.Key.Tab:return e.preventDefault(),!this.finishEditing();case s.Key.Escape:return e.preventDefault(),this.finishEditing(!0),!0;case s.Key.Up:case s.Key.Down:case s.Key.Left:case s.Key.Right:case s.Key.PageUp:case s.Key.PageDown:case s.Key.Home:case s.Key.End:if(this._lbx)return this._keydownListBox(e);if(e.altKey)switch(e.keyCode){case s.Key.Up:case s.Key.Down:return this._toggleListBox(e),e.preventDefault(),!0}if(this._fullEdit)switch(e.keyCode){case s.Key.PageUp:case s.Key.PageDown:e.preventDefault()}else if(this.finishEditing())return!1}return!0},e.prototype._keydownListBox=function(e){var t=!0;if(this._lbx)switch(e.keyCode){case s.Key.Up:e.altKey?this._toggleListBox(e):this._lbx.selectedIndex>0&&this._lbx.selectedIndex--;break;case s.Key.Down:e.altKey?this._toggleListBox(e):this._lbx.selectedIndex++;break;case s.Key.Home:case s.Key.PageUp:this._lbx.selectedIndex=0;break;case s.Key.End:case s.Key.PageDown:this._lbx.selectedIndex=this._lbx.collectionView.items.length-1;break;default:t=!1}return!!t&&(e.preventDefault(),!0)},e.prototype._keypress=function(e){if("AltLeft"!=e.code&&"AltRight"!=e.code){var t=this._edt,i=e.charCode||32,n=this._list;if(t&&"checkbox"!=t.type&&(0,s.getActiveElement)()==t&&n&&n.length>0&&i>=32){var o=t.selectionStart,r=t.value.substr(0,o);e.target==t&&e.charCode&&(r+=String.fromCharCode(e.charCode),o++);var l=this._mapSearch,a=-1;if(l)for(var h=0;h<n.length;h++){var c=n[h];if(l(null==c?c:c.toString(),r)){a=h;break}}else(a=this._findString(n,r,!0))<0&&!this._g.caseSensitiveSearch&&(a=this._findString(n,r,!1));if(a>-1){var u=this._lbx;u&&(u.selectedIndex=a),t.value=n[a],(0,s.setSelectionRange)(t,o,t.value.length),t.dispatchEvent(this._evtInput),e.preventDefault&&e.preventDefault()}}}else e.preventDefault()},e.prototype._findString=function(e,t,i){i||(t=t.toLowerCase());for(var n=0;n<e.length;n++){var o=e[n];if(null!=o&&(o=o.toString(),i||(o=o.toLowerCase()),0==o.indexOf(t)))return n}return-1},e.prototype._toggleListBox=function(e,t){var i=this._g,n=i._selHdl.selection,r=i.isTouching;if(t||(t=n),this._lbx&&(this._removeListBox(),n.intersects(t)))return i.activeEditor?i.activeEditor.focus():i.containsFocus()||i.focus(),!0;if(!t.isValid)return!1;var s=i.rows[t.row],l=i._getBindingColumn(i.cells,t.row,i.columns[t.col]),a=s.dataMap||l.dataMap,h=i._getMapEditor(s,l);if(!a||h!=o.DropDownList||!Y())return!1;if(null!=l.editor)return!1;if(!t.intersects(i.editRange)&&!this.startEditing(!0,t.row,t.col,!r,e))return!1;var c=this._lbx=this._createListBox();return requestAnimationFrame((function(){return c.showSelection()})),r&&c.focus(),!0},e.prototype._createListBox=function(){var e=this,t=this._g,i=t.activeEditor,n=this._rng,o=t.rows[n.row],r=t._getBindingColumn(t.cells,n.row,t.columns[n.col]),a=r.isContentHtml||o.isContentHtml,h=r.dataMap||o.dataMap,c=r.dropDownCssClass||o.dropDownCssClass,u=document.createElement("div");this._removeListBox(),(0,s.addClass)(u,"wj-dropdown-panel wj-grid-listbox"),(0,s.addClass)(u,c);var d=i?i.value:t.getCellData(n.row,n.col,!0),p=new l.ListBox(u,{maxHeight:4*o.renderHeight,isContentHtml:a,itemsSource:h.getDisplayValues(o.dataItem),selectedValue:d});p.addEventListener(u,"keydown",(function(i){switch(i.keyCode){case s.Key.Enter:case s.Key.Escape:e._removeListBox(),t.focus()}})),p.addEventListener(u,"click",(function(){e._removeListBox(),t.focus(),e.finishEditing()})),p.gotFocus.addHandler((function(){p.containsFocus()&&i&&i.focus()})),p.selectedIndexChanged.addHandler((function(){var i=t.activeEditor;i&&(i.value=e._list[p.selectedIndex],i.dispatchEvent(e._evtInput),(0,s.setSelectionRange)(i,0,i.value.length))}));var f=t.cells.getCellElement(n.row,n.col);if(f){(0,s.showPopup)(u,f,!1,!1,!1);var _=f.querySelector("."+X._WJC_DROPDOWN);(0,s.setAttribute)(_,"aria-expanded",!0)}else(0,s.showPopup)(u,t.getCellBoundingRect(n.row,n.col)),u[s.Control._OWNR_KEY]=t.hostElement;return p},e.prototype._removeListBox=function(){var e=this._lbx;e&&(this._lbx=null,(0,s.hidePopup)(e.hostElement,(function(){e.dispose()})))},e._msgRequired="",e._msgBadInput="",e}(),se=function(){function e(e,t){this._col=(0,s.asType)(e,j),this._ctl=t,this._tbx=t.hostElement.querySelector("input"),(0,s.assert)(this._col instanceof j,"Invalid Column"),(0,s.assert)(this._ctl instanceof s.Control,"Invalid edit control"),(0,s.assert)(this._tbx instanceof HTMLInputElement,"Input element not found in editor");var i=this._ctl;this._prop=(0,s.isUndefined)(i.value)?(0,s.isUndefined)(i.checkedItems)?(0,s.isUndefined)(i.text)?null:"text":"checkedItems":"value",(0,s.assert)(null!=this._prop,"value, text properties not found in editor");var n=Y();n&&(this._isDropDown=i instanceof n.DropDown,this._isComboBox=i instanceof n.ComboBox,this._isAutoComplete=i instanceof n.AutoComplete,this._isInputDateTime=i instanceof n.InputDateTime,this._isInputMask=i instanceof n.InputMask),this._updateFocusBnd=this._updateFocus.bind(this),this._keydownBnd=this._keydown.bind(this),this._cmpstartBnd=this._cmpstart.bind(this),this._mousedownBnd=this._mousedown.bind(this),this._connect(),this._col.gridChanged.addHandler(this._connect,this),this._hideEditor(),this._updateFocus()}return Object.defineProperty(e.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"control",{get:function(){return this._ctl},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._disconnect(),this._isDropDown&&(this._isDropDown=!1),this._g=this._col=this._ctl=this._tbx=null},e.prototype._connect=function(){var e=this._col?this._col.grid:null;if(e!=this._g&&(this._disconnect(),e)){var t=e.hostElement,i=e.addEventListener.bind(e),n=this._updateFocusBnd;this._g=e,this._hideEditor(),this._updateFocus(),i(t,"keydown",this._keydownBnd,!0),i(t,"mousedown",this._mousedownBnd,!0),i(t,"mouseup",n,!0),i(t,"blur",n,!0),i(t,"focus",n),i(this._tbx,"compositionstart",this._cmpstartBnd),e.gotFocus.addHandler(n,this),e.selectionChanged.addHandler(n,this),e.prepareCellForEdit.addHandler(this._prepareCellForEdit,this),e.cellEditEnding.addHandler(this._cellEditEnding,this),e.cellEditEnded.addHandler(this._cellEditEnded,this)}},e.prototype._disconnect=function(){var e=this._g;if(e){var t=e.hostElement,i=e.removeEventListener.bind(e),n=this._updateFocusBnd;i(t,"keydown",this._keydownBnd),i(t,"mousedown",this._mousedownBnd),i(t,"mouseup",n),i(t,"blur",n),i(t,"focus",n),i(this._tbx,"compositionstart",this._cmpstartBnd),e.gotFocus.removeHandler(n,this),e.selectionChanged.removeHandler(n,this),e.prepareCellForEdit.removeHandler(this._prepareCellForEdit,this),e.cellEditEnding.removeHandler(this._cellEditEnding,this),e.cellEditEnded.removeHandler(this._cellEditEnded,this),this._g=null}},e.prototype._prepareCellForEdit=function(e,t){if(!t.cancel&&t.getColumn(!0)==this._col){var i=this.grid,n=this._ctl,o=this._tbx,r=this._prop,l=t.range,a=t.data,h=a?a.type:"",c=i.getCellData(l.row,l.col,"text"==r||this._isInputMask),u=!1;switch(this._isComboBox&&(this._isAutoComplete&&(n._oldText=""),n.isRequired||(n.selectedIndex=-1,o.value=""),this._isInputDateTime&&n._setDropdown(n._ddDate)),"checkedItems"==r&&(n.showFilterInput&&(n.showFilterInput=!1,n.showFilterInput=!0),null!=c&&0!=c.length||(n[r]=[],n.selectedIndex=0)),null==c&&n.isRequired||(n[r]=c,this._isAutoComplete&&(clearTimeout(n._toSearch),(d=n.collectionView)&&(d.filter||n._rxHighlight)&&(n._rxHighlight=null,d.filter=null),c&&(n.selectedIndex=n._findNext(c,1,-1)))),h){case"keydown":case"mousedown":var d;if((0,s.isUndefined)(a.keyCode)||a.keyCode==s.Key.F4||a.altKey)if(u=this._isDropDown,this._isAutoComplete&&(null==c||(0,s.isString)(c)))(d=n.collectionView)&&((d.filter||n._rxHighlight)&&(n._rxHighlight=null,d.filter=null),n.selectedIndex=c?n._findNext(c,1,-1):-1)}if(i.showPlaceholders&&!n.placeholder&&(o.placeholder=this._col.header),this._showEditor(),i._edtHdl._fullEdit=!0,0==h.indexOf("key")&&32==a.keyCode&&((0,s.setSelectionRange)(o,o.value.length),a.preventDefault()),(0,s.isIE)()&&!i.imeEnabled)if("keypress"==h&&a.key)setTimeout((function(){o.value=a.key,(0,s.setSelectionRange)(o,1);var e=document.createEvent("HTMLEvents");e.initEvent("input",!0,!1),o.dispatchEvent(e)})),a.preventDefault();else if("compositionstart"==h){var p=o.value.length;(0,s.setSelectionRange)(o,p)}this._isDropDown&&(n.isDroppedDown=u)}},e.prototype._cellEditEnding=function(e,t){if(!t.cancel&&t.getColumn(!0)==this._col){var i=this.grid,n=this._ctl,o=this._prop;if(this._isAutoComplete){var r=n.selectedIndex;if((0,s.isNumber)(r)&&r<0){var l=n.collectionView;l&&1==l.items.length?n.selectedIndex=0:this._col.isRequired&&(t.cancel=!0)}}!t.cancel&&o&&i._edtHdl._setCustomEditorValue(n[o])}},e.prototype._cellEditEnded=function(e,t){this._hideEditor(),this._updateFocus()},e.prototype._cmpstart=function(e){var t=this;(0,s.isIE)()?setTimeout((function(){t._activateEditor(e)})):this._activateEditor(e)},e.prototype._keydown=function(e){if(!e.defaultPrevented&&this._checkColumn(e.target))if(this.grid.activeEditor){if(e.keyCode==s.Key.Enter&&this._isDropDown){var t=this._ctl;t.isDroppedDown&&(t.isDroppedDown=!1,e.preventDefault(),e.stopImmediatePropagation())}}else if(this._isDropDown){var i=e.keyCode;switch(i){case s.Key.F4:case s.Key.Up:case s.Key.Down:(i==s.Key.F4||e.altKey)&&(this._activateEditor(e),e.preventDefault())}}},e.prototype._checkColumn=function(e){var t=this._g;if((0,s.contains)(e,this._tbx)||null!=e&&this._imeEditor()===e){var i=t._selHdl.selection;return t._getBindingColumn(t.cells,i.row,t.columns[i.col])==this._col}return!1},e.prototype._mousedown=function(e){if(!e.defaultPrevented&&0==e.button&&!e.shiftKey&&!e.ctrlKey&&!e.metaKey&&this._isDropDown&&(0,s.closestClass)(e.target,X._WJC_DROPDOWN)){var t=this.grid,i=t.hitTest(e);i.getColumn(!0)==this._col&&(t.select(i.range),t.refresh(),this._activateEditor(e),e.preventDefault())}},e.prototype._activateEditor=function(e){var t=this.grid;if(!t.activeEditor){var i=t._selHdl.selection;if(i.isValid)return t.startEditing(!0,i.row,i.col,!0,e)}return!1},e.prototype._showEditor=function(){var t=this.grid,i=t.activeEditor,n=(0,s.closest)(i,".wj-cell");if(n){var o=this._tbx,r=this._ctl.hostElement;(0,s.setCss)(r,e._cssVisible),(0,s.toggleClass)(o,"wj-grid-ime",!1),n.innerHTML="",n.appendChild(r),t._edtHdl._edt=o,this._imeEditor()?this._initImeEditInput():(o.select(),o.focus(),i.value="")}},e.prototype._hideEditor=function(){var t=this.grid,i=this._ctl.hostElement,n=this._tbx;this._isDropDown&&(this._ctl.isDroppedDown=!1),n.setCustomValidity("");var o=n.value;n.value=o+" ",n.value=o,(0,s.setCss)(i,e._cssHidden),(0,s.toggleClass)(n,"wj-grid-ime",!0),t&&i.parentElement!=t._root&&t._root.appendChild(i)},e.prototype._updateFocus=function(){var e=this.grid;if(e&&!e.activeEditor){var t=e.hostElement,i=".wj-flexgrid",n=this._tbx,o=(0,s.getActiveElement)(),r=e._getTabIndex();if((0,s.closest)(o,i)==t)if((0,s.closest)(n,i)!=t)this._hideEditor();else if(e.imeEnabled)n.tabIndex>-1&&(n.tabIndex=-1);else{var l=e._selHdl.selection,a=e._getBindingColumn(e.cells,l.row,e.columns[l.col]);a&&a==this._col&&e.canEditCell(l.row,l.col)?o!==n&&(e.activeCell&&(e.activeCell.tabIndex=-1),n.tabIndex=r,e.isTouching||(n.select(),n.focus())):n.tabIndex>-1&&(n.tabIndex=-1,o==n&&e.focus(!0))}}},e.prototype._initImeEditInput=function(){var t=this,i=this._imeEditor();if(i){var n=this._tbx,o=n&&n.style.color,r=this._ctl,l=function(){if(i.removeEventListener("compositionend",l),(0,s.setCss)(i,K._cssHidden),n){n.style.color=o;var a=function(){r.gotFocus.removeHandler(a),t._g._edtHdl._edt=n;var o=i.value;if(o){n.value=o,e._setSelectionRange(n,o.length,o.length);var s=document.createEvent("HTMLEvents");s.initEvent("input",!0,!1),n.dispatchEvent(s)}};r.gotFocus.addHandler(a),n.focus()}};i.addEventListener("compositionend",l),n&&(n.style.color="transparent")}},e._setSelectionRange=function(e,t,i){if(void 0===i&&(i=t),(0,s.contains)(document.body,e)&&!e.disabled&&"none"!=e.style.display)try{e.setSelectionRange((0,s.asNumber)(t),(0,s.asNumber)(i),(0,s.isIE)()?null:"backward"),e.focus()}catch(e){}},e.prototype._imeEditor=function(){var e=this.grid;if(e&&e.imeEnabled){var t=(0,s.getActiveElement)();if(t&&(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement)&&(0,s.hasClass)(t,"wj-grid-ime"))return t}return null},e._cssHidden={position:"fixed",left:-32e3,top:-32e3,width:"1px",height:"1px",overflow:"hidden",border:"none"},e._cssVisible={position:"absolute",left:0,top:0,width:"100%",height:"100%"},e}();!function(e){e[e.None=0]="None",e[e.MoveDown=1]="MoveDown",e[e.MoveAcross=2]="MoveAcross",e[e.Cycle=3]="Cycle",e[e.CycleOut=4]="CycleOut",e[e.CycleEditable=5]="CycleEditable"}(oe||(oe={}));var le,ae,he,ce=function(){function e(e){this._kaTab=oe.None,this._kaEnter=oe.MoveDown,this._g=e;var t=e.hostElement;e.addEventListener(t,"keypress",this._keypress.bind(this)),e.addEventListener(t,"keydown",this._keydown.bind(this))}return e.prototype._keydown=function(e){var t=this._g,i=t._edtHdl,n=t.selection,o=e.ctrlKey||e.metaKey,r=e.shiftKey,l=e.altKey,a=e.target,h=e.char||e.key,c=!0;if(!o&&!l&&h&&1==h.length&&(0,s.closest)(a,".wj-cell")&&a.firstElementChild&&(" "!=h||!r)){var u=a.querySelectorAll("."+X._WJC_RADIOMAP+" label input");if(u&&u.length){for(var d=-1,p=0;p<u.length;p++)if(u[p].checked){d=p;break}for(h=h.toLowerCase(),p=0;p<u.length;p++){var f=u[(d+p+1)%u.length];if(" "==h||f.value.toLowerCase()[0]==h){f.click();break}}return void e.preventDefault()}}if(!t._wantsInput(a)){var _=(0,s.tryCast)(t.rows[n.row],M),g=t.editableCollectionView,b=t._getKeyCode(e),w=y,x=v,E=e.defaultPrevented&&!(a instanceof HTMLInputElement);if((t.isRangeValid(n)&&!E||o&&65==b)&&(!t.activeEditor||!i._keydown(e)||t._isNativeCheckbox(t.activeEditor))){if(t.autoClipboard){if(o&&(67==b||45==b)){var S=new C(t.cells,n);if(t.onCopying(S)){var D=R,P=0!=(t.copyHeaders&D.Column),I=0!=(t.copyHeaders&D.Row),T=t.getClipString(null,!1,P,I)+"\r\n";t._eFocus.focus(),s.Clipboard.copy(T),t.onCopied(S)}return void e.stopPropagation()}if(o&&86==b||r&&45==b)return t.isReadOnly||s.Clipboard.paste((function(e){t.setClipString(e)})),void e.stopPropagation()}switch((r||o)&&"Space"==e.code&&(b=s.Key.Space),b){case s.Key.Space:if(r&&n.isValid)switch(t.selectionMode){case x.CellRange:case x.MultiRange:case x.Row:case x.RowRange:case x.ListBox:t.select(new m(n.row,0,n.row,t.columns.length-1),!1)}else if(o&&n.isValid)switch(t.selectionMode){case x.CellRange:case x.MultiRange:t.select(new m(0,n.col,t.rows.length-1,n.col),!1)}else(c=this._startEditing(!0,e))&&setTimeout((function(){var e=t.activeEditor;e&&(e.disabled||e.readOnly&&!(0,s.closest)(e,".wj-control")?t.finishEditing():"checkbox"==e.type&&((0,s.setChecked)(e,e.indeterminate||!e.checked),t.finishEditing()))})),c=!0;break;case 65:if(o)switch(t.selectionMode){case x.None:case x.Cell:break;default:t.selectAll()}else c=!1;break;case s.Key.Left:o||l?c=!1:n.isValid&&0==n.leftCol&&_&&!_.isCollapsed&&_.hasChildren?_.isCollapsed=!0:this._moveSel(w.None,o?w.Home:w.Prev,r);break;case s.Key.Right:o||e.altKey?c=!1:n.isValid&&0==n.leftCol&&_&&_.isCollapsed?_.isCollapsed=!1:this._moveSel(w.None,o?w.End:w.Next,r);break;case s.Key.Up:o?c=!1:e.altKey&&i._toggleListBox(e)?c=!0:this._moveSel(w.Prev,w.None,r);break;case s.Key.Down:o?c=!1:e.altKey&&i._toggleListBox(e)?c=!0:this._moveSel(w.Next,w.None,r);break;case s.Key.PageUp:if(this._moveSel(e.altKey?w.Home:w.PrevPage,w.None,r),t.rows.frozen&&t.selection.row<t.rows.frozen){var H=t.scrollPosition;H.y&&(t.scrollPosition=new s.Point(H.x,0))}break;case s.Key.PageDown:this._moveSel(e.altKey?w.End:w.NextPage,w.None,r);break;case s.Key.Home:this._moveSel(o?w.Home:w.None,w.Home,r);break;case s.Key.End:this._moveSel(o?w.End:w.None,w.End,r);break;case s.Key.Tab:c=this._performKeyAction(t.keyActionTab,r);break;case s.Key.Enter:c=this._performKeyAction(t.keyActionEnter,r),!r&&g&&null!=g.currentEditItem&&i._commitRowEdits();break;case s.Key.Escape:if(c=!1,g&&(g.currentAddItem||g.currentEditItem)){var j=new C(t.cells,t.selection);j.cancel=!0,t.onRowEditEnding(j),g.currentAddItem&&g.cancelNew(),g.currentEditItem&&g.cancelEdit(),t.onRowEditEnded(j),c=!0}t._mouseHdl.resetMouseState();break;case s.Key.Delete:case s.Key.Back:c=this._deleteSel(e);break;case s.Key.F2:c=this._startEditing(!0,e);break;case s.Key.F4:c=i._toggleListBox(e);break;default:c=!1}c&&(t.containsFocus()||t.focus(),e.preventDefault(),e.stopPropagation())}}},e.prototype._performKeyAction=function(e,t){var i=oe,n=y;switch(e){case i.MoveDown:return this._moveSel(t?n.Prev:n.Next,n.None,!1),!0;case i.MoveAcross:return this._moveSel(n.None,t?n.Prev:n.Next,!1),!0;case i.Cycle:return this._moveSel(n.None,t?n.PrevCell:n.NextCell,!1),!0;case i.CycleEditable:return this._moveSel(n.None,t?n.PrevEditableCell:n.NextEditableCell,!1),!0;case i.CycleOut:var o=this._g.selection;return this._moveSel(n.None,t?n.PrevCell:n.NextCell,!1),!o.equals(this._g.selection)}return!1},e.prototype._keypress=function(e){var t=this,i=this._g;if(!i._wantsInput(e.target)&&!e.defaultPrevented){var n=i._edtHdl;if(i.activeEditor)n._keypress(e);else if(e.charCode>s.Key.Space&&"AltLeft"!=e.code&&"AltRight"!=e.code)if(this._startEditing(!1,e)&&i.activeEditor){var o=(0,s.getActiveElement)();if(o instanceof HTMLInputElement&&"checkbox"!=o.type||o instanceof HTMLTextAreaElement){var r=i._selHdl.selection,l=i.getCellData(r.row,r.col,!0),a=i.getCellData(r.row,r.col,!1),h=s.culture.Globalize.numberFormat["%"]||"%",c=String.fromCharCode(e.charCode),u=(0,s.isNumber)(a)&&l.indexOf(h)>-1||""==l&&o.value==h,d=!0,p=function(){o.value=u?c+h:c,(0,s.setSelectionRange)(o,1),o.dispatchEvent(n._evtInput),n._keypress(e),n._edtValue=o.value!=l?o.value:null};if(i.imeEnabled){var f=i._getBindingColumn(i.cells,r.row,i.columns[r.col]),_=f&&f._edt,g=_&&_.control;if(g&&!g._focus){var m=function(){g.gotFocus.removeHandler(m),d=!1,p()};g.gotFocus.addHandler(m)}}d&&p(),e.preventDefault()}}else if(i.autoSearch){var v=!1;if(r=i._selHdl.selection,e.charCode>32||32==e.charCode&&this._search){e.preventDefault(),this._search+=String.fromCharCode(e.charCode),this._toSearch&&clearTimeout(this._toSearch),this._toSearch=setTimeout((function(){t._toSearch=null,t._search=""}),s.Control._SEARCH_DELAY);var b=this._findNext(r.row,r.col);b<0&&this._search.length>1&&(this._search=this._search[this._search.length-1],b=this._findNext(r.row,r.col)),b>-1&&(v=!0,i.select(b,r.col))}v||(this._search="")}}},e.prototype._findNext=function(e,t){var i=this._g,n=i.rows.length;(e<0||1==this._search.length)&&e++;var o=this._search,r=i.caseSensitiveSearch;r||(o=o.toLowerCase());for(var l=i.columns[t].isContentHtml,a=0;a<n;a++){var h=(e+a)%n,c=i.getCellData(h,t,!0).trim();if(l&&(c=(0,s.toPlainText)(c)),r||(c=c.toLowerCase()),0==c.indexOf(o))return h}return-1},e.prototype._moveSel=function(e,t,i){var n=this._g,o=n.selectionMode,r=n._selHdl;o!=v.None&&(o==v.MultiRange&&r.extendedSelection.clear(),r.moveSelection(e,t,i))},e.prototype._deleteSel=function(e){var t=this,i=this._g,n=i.rows,o=i.editableCollectionView,r=i.selection,s=[],l=new m,a=new E(i.cells,l,e),h=v;if(!i._edtHdl._allowEdit())return!1;if(i.allowDelete&&(null==o||o.canRemove&&!o.isAddingNew&&!o.isEditingItem)&&0==(s=n.filter((function(e){return e.isSelected}))).length)switch(i.selectionMode){case h.CellRange:case h.MultiRange:var c=i._getDeleteColumnIndex();i.selectedRanges.forEach((function(e){if(e.leftCol==c&&e.rightCol==i.columns.length-1)for(var t=e.topRow;t>-1&&t<=e.bottomRow;t++){var o=n[t];s.indexOf(o)<0&&s.push(o)}}));break;case h.Row:r.topRow>-1&&s.push(n[r.topRow]);break;case h.RowRange:for(var u=r.topRow;u>-1&&u<=r.bottomRow;u++)s.push(n[u])}if(s.length>0){var d=0;if(i.deferUpdate((function(){o&&o.beginUpdate();for(var e=s.length-1;e>=0;e--){var t=s[e];t instanceof W||(l.setRange(t.index,-1),i.onDeletingRow(a)&&(o&&t.dataItem?o.remove(t.dataItem):i.rows.removeAt(t.index),d++,i.onDeletedRow(a)))}o&&o.endUpdate(!1)})),d>0){var p=r.topRow;for(p=Math.min(p,i.rows.length-1);p>0&&i.rows[p]instanceof W;)p--;r.row=r.row2=p,i.select(r,!1),i.childItemsPath&&o&&o.refresh()}return!0}return 0==s.length&&(i.deferUpdate((function(){var l=i.scrollPosition,a=-1;s=n.filter((function(e){return e.isSelected}));var c=i.selectedRanges.length>1||s.length>1||r.isValid&&n[r.row].dataItem!=n[r.row2].dataItem;if(o&&o.beginUpdate(),s.length){var u=new m(0,0,0,i.columns.length-1);s.forEach((function(i){u.row=u.row2=i.index,t._deleteRange(e,u),a=u.bottomRow}))}else t._deleteRange(e,r),a=r.bottomRow,i.selectionMode==h.MultiRange&&i._selHdl.extendedSelection.forEach((function(i){t._deleteRange(e,i),a=i.bottomRow}));if(i.select(r,!1),i.scrollPosition=l,o){if(c&&o.currentEditItem){o.commitEdit();var d=new C(i.cells,new m(a,-1));i.onRowEditEnding(d),i.onRowEditEnded(d)}o.endUpdate(!1)}})),!0)},e.prototype._deleteRange=function(e,t){for(var i=this._g,n=i.editableCollectionView,o=new m,r=new E(i.cells,o,e),s=new C(i.cells,new m(t.topRow,-1)),l=t.topRow;l<=t.bottomRow;l++){var a=i.rows[l];if(!a.isReadOnly)for(var h=t.leftCol;h<=t.rightCol;h++){var c=i._getBindingColumn(i.cells,l,i.columns[h]);if(!c.getIsRequired(a)&&!c.isReadOnly&&i.getCellData(l,h,!0)&&(o.setRange(l,h),r.cancel=!1,i.onBeginningEdit(r))){var u=a.dataItem,d=n?n.currentEditItem:null;d&&u!=d&&(i.onRowEditEnding(s),i.onRowEditEnded(s)),u!=d&&(s._rng.setRange(l,-1),i.onRowEditStarting(s),i.onRowEditStarted(s)),n&&(n.editItem(u),i._edtHdl._edItem=u),i.setCellData(l,h,"",!0,!1),i.onCellEditEnding(r),i.onCellEditEnded(r)}}}},e.prototype._startEditing=function(e,t,i,n){return this._g._edtHdl.startEditing(e,i,n,!0,t)},e}(),ue="wj-state-dragsrc",de="wj-flexgrid";!function(e){e[e.None=0]="None",e[e.Columns=1]="Columns",e[e.Rows=2]="Rows",e[e.Both=3]="Both",e[e.ColumnsAllCells=4|e.Columns]="ColumnsAllCells",e[e.RowsAllCells=4|e.Rows]="RowsAllCells",e[e.BothAllCells=4|e.Both]="BothAllCells"}(le||(le={})),function(e){e[e.None=0]="None",e[e.Headers=1]="Headers",e[e.Cells=2]="Cells",e[e.Both=3]="Both"}(ae||(ae={})),function(e){e[e.None=0]="None",e[e.Columns=1]="Columns",e[e.Rows=2]="Rows",e[e.Both=3]="Both"}(he||(he={}));var pe=function(){function e(e){var t=this,i=e.hostElement,n=e.addEventListener.bind(e),o=e.removeEventListener.bind(e);this._g=e,this._dvMarker=(0,s.createElement)('<div class="wj-marker">&nbsp;</div>'),n(i,"mousedown",(function(i){if(e._rcBounds=null,!i.defaultPrevented&&0==i.button){var a=i.target;if(!e.containsFocus()){var h=a instanceof HTMLElement&&a.tabIndex>-1?a:e._eFocus;e._setFocusNoScroll(h)}setTimeout((function(){i.defaultPrevented||e.focus()}));var c=(0,s.closestClass)(a,de);if(c&&c!=e.hostElement||!e.activeEditor&&e._isInputElement(a)&&!t._hasRadioMap(i)&&!e._isNativeCheckbox(a)){var u=e.hitTest(i),d=_;switch(u.cellType){case d.Cell:e.select(u.range,!1),a instanceof HTMLElement&&"root"!=a.getAttribute("wj-part")&&a.focus();break;case d.ColumnHeader:case d.ColumnFooter:e.scrollIntoView(-1,u.col);break;case d.RowHeader:e.scrollIntoView(u.row,-1)}return void((0,s.isIE)()&&u.cellType!=d.Cell&&e._isInputElement(a)&&a.focus())}var p=document;o(p,"mousemove"),o(p,"mouseup"),n(p,"mousemove",r),n(p,"mouseup",l),t._isDown=!0,t._mousedown(i)}}));var r=function(e){t._mousemove(e)},l=function(e){t._isDown=!1,o(document,"mousemove"),o(document,"mouseup"),t._mouseup(e)};n(i,"mouseenter",(function(t){e._rcBounds=null})),n(i,"mousemove",this._hover.bind(this)),n(i,"dblclick",this._dblclick.bind(this)),n(i,"click",this._click.bind(this)),n(i,"selectstart",(function(t){e._isInputElement(t.target)||t.preventDefault()})),n(i,"wheel",(function(t){if(!t.defaultPrevented&&t.deltaY&&!t.ctrlKey&&!t.metaKey){var i=e._root,n=t.deltaY;if((t.shiftKey?i.scrollWidth>i.clientWidth:i.scrollHeight>i.clientHeight)&&(0,s.closestClass)(t.target,de)==e.hostElement){switch(t.deltaMode){case 1:n=e.rows.defaultSize*(n<0?-1:1);break;case 2:n=(t.shiftKey?i.clientWidth:i.clientHeight)*(n<0?-1:1);break;default:(0,s.isSafari)()&&(n=(0,s.clamp)(n,-150,150))}e.finishEditing(!1)&&(t.shiftKey?i.scrollLeft+=n:i.scrollTop+=n),t.preventDefault(),t.stopImmediatePropagation()}}})),n(i,"dragstart",this._dragstart.bind(this)),n(i,"dragover",this._dragover.bind(this)),n(i,"dragleave",this._dragleave.bind(this)),n(i,"drop",this._drop.bind(this)),n(i,"dragend",this._dragend.bind(this))}return e.prototype.resetMouseState=function(){var e=this._g,t=e.hostElement;this._updating&&(this._updating=!1,e.endUpdate()),this._dragSrc&&(0,s.removeClass)(this._dragSrc,ue),this._showDragMarker(null),t&&(t.style.cursor=""),(0,s.isSafari)()&&this._szRowCol&&e.invalidate(),e.removeEventListener(document,"mousemove"),e.removeEventListener(document,"mouseup"),this._eMouse=null,this._isDown=null,this._htDown=null,this._lbSelState=null,this._szRowCol=null,this._szArgs=null,e._rcBounds=null},e.prototype._mousedown=function(e){var t=this._g,i=e.target,n=t.hitTest(e),o=n.cellType,r=_,l=e.ctrlKey||e.metaKey;if(this._selDown=t.selection,this._ignoreClick=!1,n.panel==t.cells){if((0,s.closestClass)(i,X._WJC_DROPDOWN)){var a=t.hitTest(i);return t._edtHdl._toggleListBox(e,a.range),e.preventDefault(),void(this._ignoreClick=!0)}var h=t.editRange;if(h&&h.contains(n.range))return}var c=(0,s.getActiveElement)();if(i!=c||!t._isInputElement(i))if(o!=r.None)if(this._htDown=n,this._eMouse=e,null==this._szRowCol){var u=t.allowResizing,d=le;if((o==r.RowHeader||o==r.TopLeft)&&n.edgeBottom&&u&d.Rows&&this._getResizeRowHt(n))this._ignoreClick=!0;else if((o==r.ColumnHeader||o==r.TopLeft)&&n.edgeRight&&u&d.Columns&&this._getResizeColHt(n))this._ignoreClick=!0;else{var p=t.allowDragging,f=he;switch(o){case r.Cell:case r.RowHeader:l&&t.selectionMode==v.ListBox&&(this._lbSelState=t.rows[n.row].isSelected,(0,s.closest)(i,".wj-elem-collapse")&&(this._lbSelState=!1)),this._mouseSelect(e,e.shiftKey),o!=r.RowHeader||p&f.Rows||(e.preventDefault(),t.focus());break;case r.ColumnHeader:t.allowSorting||p&f.Columns||(0,s.closest)(i,"button")||this._mouseSelect(e,e.shiftKey)}}}else{var g=t._eFocus;c!=g&&(g.tabIndex=0,g.focus()),this._ignoreClick=!0,this._handleResizing(e)}else t.finishEditing(),i!=t._root&&i!=t._fCt&&t._edtHdl._commitRowEdits()},e.prototype._mousemove=function(e){if(this._htDown&&!e.defaultPrevented){if(0==e.buttons&&this._eMouse&&e.timeStamp-this._eMouse.timeStamp>600)return void this.resetMouseState();if(this._eMouse=e,this._szRowCol)this._handleResizing(e);else{var t=this._g,i=t.allowDragging,n=he,o=_;switch(this._htDown.cellType){case o.Cell:this._mouseSelect(e,!0);break;case o.RowHeader:i&n.Rows||this._mouseSelect(e,!0);break;case o.ColumnHeader:i&n.Columns||t.allowSorting||this._mouseSelect(e,!0)}}}},e.prototype._mouseup=function(e){var t=this._g;if(!t.isTouching||!(this._dragSrc||e.target instanceof HTMLHtmlElement)){var i=t.hitTest(e),n=this._htDown;if(n&&!e.defaultPrevented&&(this._szArgs&&this._finishResizing(e),!this._szArgs&&i.panel==n.panel&&i.row==n.row&&i.col==n.col)){var o=i.getColumn();if(o&&(!o._getFlag(S.HasTemplate)||o.cellTemplate)){var r=i.target;if(r!=n.target&&r instanceof HTMLElement){if(n.target instanceof HTMLInputElement){var s=i.point,l=n.point;Math.abs(s.x-l.x)+Math.abs(s.y-l.y)<10&&(r=r.querySelector("input")||r)}var a=document.createEvent("Event");for(var h in a.initEvent("click",!0,!0),e)/Key$|X$|Y$|^button|^(x|y|which)$/.test(h)&&(a[h]=e[h]);r.dispatchEvent(a)}}}this.resetMouseState()}},e.prototype._click=function(e){if(this._ignoreClick&&(this._ignoreClick=!1,e.preventDefault()),!e.defaultPrevented){var t=this._g,i=e.target,n=t.hitTest(i),o=(0,s.tryCast)(i,HTMLInputElement),r="input."+X._WJC_CHECKBOX;if(!o){var l=(0,s.closest)(i,"label");l&&(o=l.querySelector(r))}if(!o&&t.bigCheckboxes&&(o=i.querySelector(r)),o!=t.activeEditor&&t._isNativeCheckbox(o)){if(n.panel==t.cells){var a=t.getCellData(n.row,n.col,!1);t.startEditing(!1,n.row,n.col,!1,e)?(t.activeEditor.checked=!a,t.finishEditing(),t.focus()):o.checked=a}return}if(this._hasRadioMap(e))return void this._handleClick(e);var h=e.ctrlKey||e.metaKey;if(t.rows.maxGroupLevel>-1&&(0,s.closestClass)(i,X._WJC_COLLAPSE)){var c=t.rows[n.row];if(n.panel==t.cells&&c instanceof M)return void(h?t.collapseGroupsToLevel(c.isCollapsed?c.level+1:c.level):c.isCollapsed=!c.isCollapsed)}if(!h&&!e.shiftKey&&!t.activeEditor&&n.panel==t.cells){var u=t._selHdl.selection;if(u.equals(this._selDown)&&n.range.contains(u))return void t.startEditing(!0,null,null,!0,e)}this._handleClick(e)}},e.prototype._handleClick=function(e){var t=this._g,i=e.target,n=t.hitTest(i),o=e.ctrlKey||e.metaKey,r=n.panel;if(!e.defaultPrevented&&n.grid==t){if(r==t.cells&&this._hasRadioMap(e)){var l=(0,s.closest)(i,"label"),a=l&&l.querySelector("input");return void(a&&!a.disabled&&t.startEditing(!1,n.row,n.col,!1,e)&&t.finishEditing()&&(t._edtHdl._edtCanceled?e.preventDefault():t.setCellData(n.row,n.col,l.textContent,!0,t.refreshOnEdit)))}if(!t._isInputElement(i)){if(r==t.topLeftCells){var h=v;switch(t.selectionMode){case h.None:case h.Cell:break;default:t.selectAll()}return}if(r==t.columnHeaders){if(t.allowPinning&&(0,s.closestClass)(i,X._WJC_PIN))this._clickPin(e,n);else if(!t._isTransposed()&&(0,s.closestClass)(e.target,X._WJC_COLLAPSE)){if(f=t._getColumnGroup(n.row,n.col))if(o)for(var c=f.isCollapsed,u=f.level,d=[],p=0;p<t.columns.length;p++)(f=t._getColumnGroup(n.row,p))&&f.collapseTo&&f.level==u&&d.indexOf(f)<0&&(d.push(f),f.isCollapsed=!c);else f.isCollapsed=!f.isCollapsed}else i instanceof HTMLSpanElement&&i.parentElement instanceof HTMLLabelElement&&(i=i.parentElement.querySelector("input")),i instanceof HTMLInputElement||this._clickSort(e,n),t.focus();return}if(r==t.rowHeaders){var f;if(t._isTransposed()&&(0,s.closestClass)(e.target,X._WJC_COLLAPSE))if(f=t._getColumnGroup(n.row,n.col))if(o){c=f.isCollapsed,u=f.level,d=[];for(var _=0;_<t.rows.length;_++)(f=t._getColumnGroup(_,n.col))&&f.collapseTo&&f.level==u&&d.indexOf(f)<0&&(d.push(f),f.isCollapsed=!c)}else f.isCollapsed=!f.isCollapsed;return}if(r==t.cells){if(n.row<0)return void this._clickSort(e,n);if((0,s.closestClass)(i,X._WJC_COLLAPSE)){var g=t.rows[n.row];return void(g instanceof M&&(o?t.collapseGroupsToLevel(g.isCollapsed?g.level+1:g.level):g.isCollapsed=!g.isCollapsed))}(0,s.closestClass)(i,X._WJC_DROPDOWN)&&t._edtHdl._toggleListBox(e,n.range)}}}},e.prototype._hasRadioMap=function(e){var t=e.target;if((0,s.closest)(t,"label")){var i=(0,s.closestClass)(t,X._WJC_RADIOMAP);return(0,s.closestClass)(i,de)==this._g.hostElement}return!1},e.prototype._clickSort=function(e,t){var i=this._g,n=i.allowSorting,o=i.collectionView,r=o?o.sortDescriptions:null,l=e.ctrlKey||e.metaKey,a=e.shiftKey;if(o&&o.canSort&&n!=P.None){var h=t.panel.columns[t.col],c=i._getBindingColumn(t.panel,t.row,h),u=c?c._getBindingSort():null;if(c.allowSorting&&u){if(h==c){var d=i.getMergedRange(t.panel,t.row,t.col,!1);if(d&&d.columnSpan>1)return}var p=new C(t.panel,t.range,e);if(i.onSortingColumn(p)){i._edtHdl._commitRowEdits();for(var f=-1,_=null,g=0;g<r.length;g++)if(r[g].property==u){f=g,_=r[g];break}r.deferUpdate((function(){if(l&&a)r.clear();else if(_){var e=l;!e&&i.isTouching&&(e=0==_.ascending),e?r.removeAt(f):r[f]=new s.SortDescription(u,!_.ascending)}else{n!=P.MultiColumn&&r.clear();var t=new s.SortDescription(u,!0);r.push(t)}})),i.onSortedColumn(p)}}}},e.prototype._clickPin=function(e,t){var i=this._g,n=i.columns,o=n.frozen,r=i.allowPinning;r==I.Both&&(r=e.shiftKey?I.ColumnRange:I.SingleColumn);var s=new C(i.cells,t.range);i.onPinningColumn(s)&&(r==I.SingleColumn&&(t.col>=o?(n.moveElement(t.col,o,!1),n.frozen++):(n.moveElement(t.col,o-1,!1),n.frozen--)),r==I.ColumnRange&&(t.col+1!=o?n.frozen=t.col+1:n.frozen=0),i.onPinnedColumn(s))},e.prototype._dblclick=function(e){if(!e.defaultPrevented){var t,i=this._g,n=i.hitTest(e),o=e.ctrlKey||e.metaKey,r=n.range,s=n.cellType,l=_,a=i.selection,h=i.allowResizing,c=le;if(n.edgeRight&&h&c.Columns){if(s==l.TopLeft)n.panel.columns[n.col].allowResizing&&(t=new C(n.panel,new m(-1,n.col)),i.onAutoSizingColumn(t)&&i.onResizingColumn(t)&&(this._ignoreClick=!0,i.autoSizeColumn(n.col,!0),i.onAutoSizedColumn(t),i.onResizedColumn(t),e.preventDefault()));else if(s==l.ColumnHeader||4&h){s==l.ColumnHeader&&o&&a.containsColumn(n.col)&&(r=a);for(var u=s==l.RowHeader||s==l.BottomLeft,d=r.leftCol;d<=r.rightCol;d++)n.panel.columns[d].allowResizing&&(t=new C(n.panel,new m(-1,d)),i.onAutoSizingColumn(t)&&i.onResizingColumn(t)&&(this._ignoreClick=!0,i.autoSizeColumn(d,u),i.onResizedColumn(t),i.onAutoSizedColumn(t),e.preventDefault()))}this.resetMouseState()}else if(n.edgeBottom&&h&c.Rows){if(s==l.TopLeft||s==l.BottomLeft)n.getRow().allowResizing&&(u=s==l.TopLeft||null,t=new C(n.panel,new m(n.row,-1)),i.onAutoSizingRow(t)&&i.onResizingRow(t)&&(this._ignoreClick=!0,i.autoSizeRow(n.row,u),i.onResizedRow(t),i.onAutoSizedRow(t),e.preventDefault()));else if(s==l.RowHeader||4&h){var p=n.panel;u=p==i.columnHeaders||p==i.columnFooters&&null,o&&a.containsRow(n.row)&&p==i.cells&&(r=a);for(var f=r.topRow;f<=r.bottomRow;f++)p.rows[f].allowResizing&&(t=new C(p,new m(f,-1)),i.onAutoSizingRow(t)&&i.onResizingRow(t)&&(this._ignoreClick=!0,i.autoSizeRow(f,u),i.onResizedRow(t),i.onAutoSizedRow(t),e.preventDefault()))}this.resetMouseState()}}},e.prototype._hover=function(e){if(!this._isDown){var t=this._g,i=t.hitTest(e),n="";return this._szRowCol=this._getResizeColHt(i)||this._getResizeRowHt(i),this._szRowCol instanceof j?n="col-resize":this._szRowCol instanceof k&&(n="row-resize"),this._szStart=this._szRowCol?this._szRowCol.renderSize:0,t.hostElement.style.cursor=n,i}return null},e.prototype._getResizeColHt=function(e){var t,i=this._g.allowResizing,n=e.cellType,o=_;return i&le.Columns&&(n==o.ColumnHeader||n==o.TopLeft||4&i)&&(e.edgeRight&&(t=e.getColumn()),e.edgeFarRight&&(t=this._getResizeCol(e.panel,e.col)||e.getColumn()),e.edgeLeft&&(t=this._getResizeCol(e.panel,e.col,!0)||t)),t&&t.allowResizing?t:null},e.prototype._getResizeRowHt=function(e){var t,i=this._g.allowResizing,n=le,o=e.cellType,r=_;return i&n.Rows&&(o==r.RowHeader||o==r.TopLeft||4&i)&&(e.edgeBottom&&(t=e.getRow()),e.edgeFarBottom&&(t=this._getResizeRow(e.panel,e.row)||e.getRow()),e.edgeTop&&(t=this._getResizeRow(e.panel,e.row,!0)||t)),t&&t.allowResizing?t:null},e.prototype._getResizeCol=function(e,t,i){void 0===i&&(i=!1);var n=this._g,o=e.columns;if(i){for(var r=t-1;r>=0;r--)if((s=o[r]).isVisible)return this._asResizable(s);if(o==n.columns&&0!=(n.headersVisibility&R.Row))for(r=(o=n.rowHeaders.columns).length-1;r>=0;r--)if((s=o[r]).isVisible)return this._asResizable(s);return null}for(r=t+1;r<o.length;r++)if((s=o[r]).isVisible)return this._asResizable(s);if(t==o.length-1&&o==n.rowHeaders.columns)for(o=n.columns,r=0;r<o.length;r++){var s;if((s=o[r]).isVisible)return this._asResizable(s)}return null},e.prototype._getResizeRow=function(e,t,i){void 0===i&&(i=!1);var n=this._g,o=e.rows;if(i){for(var r=t-1;r>=0;r--)if((s=o[r]).isVisible)return this._asResizable(s);if(o==n.rows&&0!=(n.headersVisibility&R.Column))for(r=(o=n.columnHeaders.rows).length-1;r>=0;r--)if((s=o[r]).isVisible)return this._asResizable(s);return null}for(r=t+1;r<o.length;r++)if((s=o[r]).isVisible)return this._asResizable(s);if(t==o.length-1&&o==n.columnHeaders.rows)for(o=n.rows,r=0;r<o.length;r++){var s;if((s=o[r]).isVisible)return this._asResizable(s)}return null},e.prototype._asResizable=function(e){return 0==e.renderSize&&e.allowResizing?e:null},e.prototype._mouseSelect=function(e,t){var i=this,n=this._g;if(e&&this._htDown&&this._htDown.panel&&n.selectionMode!=v.None){var o=new U(this._htDown.panel,e);this._handleSelection(o,t),!(0,s.isIE9)()&&e.button>=0&&e.target!=n._root&&((o=new U(n,e)).panel||setTimeout((function(){i._isDown&&i._eMouse&&i._mouseSelect(i._eMouse,t)}),100))}},e.prototype._handleResizing=function(t){"mousedown"==t.type&&((0,s.isSafari)()?(0,s.setAttribute)(t.target,"draggable",null):t.preventDefault());var i=this._szRowCol;if(i instanceof j){var n=this._g,o=(0,s.mouseToPage)(t).x,r=Math.round(Math.max(e._SZ_MIN,this._szStart+(o-this._htDown.point.x)*(n.rightToLeft?-1:1)));if(i.renderSize!=r){if(null==this._szArgs){var l=n.rowHeaders.columns.indexOf(i)>-1?n.rowHeaders:n.cells;this._szArgs=new C(l,new m(-1,i.index))}this._szArgs.cancel=!1,n.onResizingColumn(this._szArgs)&&(n.deferResizing?this._showResizeMarker(r):i.width=r)}}var a=this._szRowCol;if(a instanceof k){n=this._g;var h=(0,s.mouseToPage)(t).y;r=Math.round(Math.max(e._SZ_MIN,this._szStart+(h-this._htDown.point.y))),a.renderSize!=r&&(null==this._szArgs&&(l=n.columnHeaders.rows.indexOf(a)>-1?n.columnHeaders:n.columnFooters.rows.indexOf(a)>-1?n.columnFooters:n.cells,this._szArgs=new C(l,new m(a.index,-1))),this._szArgs.cancel=!1,n.onResizingRow(this._szArgs)&&(n.deferResizing?this._showResizeMarker(r):a.height=r))}this._szArgs&&t.preventDefault()},e.prototype._dragstart=function(e){var t=this._g,i=this._htDown,n=he,o=_;if(i){if(this._dragSrc=null,this._htDrag=null,this._chldColGrpMarker=!1,!this._szRowCol){var r=new C(i.panel,i.range),l=t.allowDragging,a=i.cellType,h=i.panel.rows,c=i.getColumn(!0);if(c&&c.allowDragging&&(a==o.ColumnHeader||a==o.TopLeft)&&l&n.Columns&&(t.onDraggingColumn(r)?this._dragSrc=e.target:e.preventDefault()),!this._dragSrc&&i.row>-1&&h[i.row].allowDragging){var u=h[i.row];u instanceof M||u instanceof W||a==o.RowHeader&&l&n.Rows&&(t.onDraggingRow(r)?this._dragSrc=e.target:e.preventDefault())}}this._dragSrc&&e.dataTransfer&&!e.defaultPrevented&&(this._htDrag=i,(0,s._startDrag)(e.dataTransfer,"move"),e.stopPropagation(),(0,s.addClass)(this._dragSrc,ue),t.beginUpdate(),this._updating=!0)}},e.prototype._dragend=function(e){this._dragSrc=null,this._htDrag=null,this.resetMouseState()},e.prototype._dragover=function(e){var t=this._g,i=this._hitTest(e),n=this._dragSrc?this._htDrag:null,o=_,r=!1;if(n&&i.cellType==n.cellType){var l=new C(i.panel,i.range,n);i.cellType==o.ColumnHeader&&t._hasColumnGroups()?(l.cancel=!t._canMoveColumnGroup(n.row,n.col,i.row,i.col),r=t.onDraggingColumnOver(l)):i.cellType==o.ColumnHeader?(l.cancel=!t.columns.canMoveElement(n.col,i.col),r=t.onDraggingColumnOver(l)):i.cellType==o.RowHeader?(l.cancel=!t.rows.canMoveElement(n.row,i.row),r=t.onDraggingRowOver(l)):i.cellType==o.TopLeft&&(l.cancel=!t.topLeftCells.columns.canMoveElement(n.col,i.col),r=t.onDraggingColumnOver(l))}if(r?(e.dataTransfer.dropEffect="move",e.preventDefault(),e.stopPropagation(),this._showDragMarker(i)):this._showDragMarker(null),n&&t.autoScroll){var a=t.controlRect,h=t.scrollPosition,c=s.Control._DRAG_SCROLL_EDGE,u=s.Control._DRAG_SCROLL_STEP;n.panel==t.columnHeaders?(e.pageX-a.left<c&&(h.x+=u),a.right-e.pageX<c&&(h.x-=u)):n.panel==t.rowHeaders&&(e.pageY-a.top<c&&(h.y+=u),a.bottom-e.pageY<c&&(h.y-=u)),h.equals(t._ptScrl)||(t.scrollPosition=h,t._rcBounds=null)}},e.prototype._dragleave=function(e){this._showDragMarker(null)},e.prototype._drop=function(e){var t=this._g,i=this._hitTest(e),n=this._dragSrc?this._htDrag:null,o=_;if(n&&i.cellType==n.cellType){var r=t.selection,s=new C(i.panel,i.range,n);i.cellType==o.ColumnHeader&&t._hasColumnGroups()?(t._moveColumnGroup(n.row,n.col,i.row,i.col,this._chldColGrpMarker),t.select(r.row,i.col),t.onDraggedColumn(s)):i.cellType==o.ColumnHeader?(t.columns.moveElement(n.col,i.col),t.select(r.row,i.col),t.onDraggedColumn(s)):i.cellType==o.RowHeader?(t.rows.moveElement(n.row,i.row),t.select(i.row,r.col),t.onDraggedRow(s)):i.cellType==o.TopLeft&&(t.topLeftCells.columns.moveElement(n.col,i.col),t.onDraggedColumn(s))}this.resetMouseState()},e.prototype._hitTest=function(e){var t=this._g;return t._rcBounds=null,t.hitTest(e)},e.prototype._showResizeMarker=function(e){var t,i=this._g,n=i._ptScrl,o=this._szArgs.panel.cellType,r=_,l=this._dvMarker,a=i.cells.hostElement;l.parentElement!=a&&a.appendChild(l),this._szRowCol instanceof j?(t={left:this._szRowCol.pos+e-1,top:-1e3,right:"",bottom:0,width:3,height:""},o!=r.TopLeft&&o!=r.RowHeader||(t.left-=i._eTL.offsetWidth+n.x),o==r.Cell&&this._szRowCol.index<i.frozenColumns&&(t.left-=n.x),i.rightToLeft&&(t.left=a.clientWidth-t.left-t.width)):(t={left:-1e3,top:this._szRowCol.pos+e-1,right:0,bottom:"",width:"",height:3},o!=r.TopLeft&&o!=r.ColumnHeader||(t.top-=i._eTL.offsetHeight+n.y),o==r.Cell&&this._szRowCol.index<i.frozenRows&&(t.top-=n.y)),(0,s.setCss)(l,t)},e.prototype._showDragMarker=function(t){var i=this._dvMarker;if(t&&t.panel){if(!t.range.equals(this._rngTarget)){this._rngTarget=t.range;var n=t.panel.hostElement;i.parentElement!=n&&n.appendChild(i);var o=this._g,r=o._ptScrl,l=_,a={left:0,top:0,width:6,height:6,right:"",bottom:""};switch(t.cellType){case l.ColumnHeader:var h=o._getColumnGroup(t.row,t.col);if(h){var c=h._rng,u=t.panel.rows,d=t.panel.columns;if(h.isEmpty&&null===h.binding){var p=u[c.bottomRow],f=d[c.leftCol],g=o.rightToLeft,m=g?i.parentElement.clientWidth-t.point.x:t.point.x,v=Math.max(f.renderWidth/5,e._SZ_MAX_COLGRP_EDGE),b=f.pos+v,y=f.pos+f.renderWidth-v,w=this._htDown&&t.col>this._htDown.col;if(!w&&m>b||w&&m<y){a.top=p.pos-a.height/2+p.renderHeight,a.left=g?i.parentElement.clientWidth-f.pos-f.renderWidth:f.pos,a.width=f.renderWidth,this._chldColGrpMarker=!0;break}}this._chldColGrpMarker=!1,a.top=0,a.height=0;for(var C=0;C<c.topRow;C++)a.top+=u[C].renderHeight;for(C=c.topRow;C<=c.bottomRow;C++)a.height+=u[C].renderHeight;if(a.left=0,this._htDown&&t.col>this._htDown.col){var x=d[c.rightCol];a.left=x.pos-a.width/2+x.renderWidth}else{var E=d[c.leftCol];a.left=E.pos-a.width/2}o.rightToLeft&&(a.left=i.parentElement.clientWidth-a.left-a.width);break}case l.TopLeft:case l.ColumnHeader:var S=t.panel.columns[t.col];a.left=S.pos-a.width/2,a.height=t.panel.height,this._htDown&&t.col>this._htDown.col&&(a.left+=S.renderWidth),t.cellType==l.ColumnHeader&&t.col<o.frozenColumns&&(a.left-=r.x),o.rightToLeft&&(a.left=i.parentElement.clientWidth-a.left-a.width);break;case l.RowHeader:var D=t.getRow();a.top=D.pos-a.height/2,a.width=t.panel.width,t.row>this._htDown.row&&(a.top+=D.renderHeight),t.row<o.frozenRows&&(a.top-=r.y)}(0,s.setCss)(i,a)}}else(0,s.removeChild)(i),this._rngTarget=null},e.prototype._finishResizing=function(t){var i=this._g,n=i.selection,o=this._szArgs,r=this._eMouse,l=r&&(r.ctrlKey||r.metaKey),a=_;if(o&&!o.cancel){if(o.col>-1){var h=o.col,c=(0,s.mouseToPage)(t).x,u=Math.round(Math.max(e._SZ_MIN,this._szStart+(c-this._htDown.point.x)*(this._g.rightToLeft?-1:1)));if(o.panel.columns[h].width=Math.round(u),i.onResizedColumn(o),l&&this._htDown.cellType==a.ColumnHeader&&n.containsColumn(h))for(var d=n.leftCol;d<=n.rightCol;d++)i.columns[d].allowResizing&&d!=h&&(o=new C(i.cells,new m(-1,d)),i.onResizingColumn(o)&&(i.columns[d].size=i.columns[h].size,i.onResizedColumn(o)));t.preventDefault()}if(o.row>-1){var p=o.row,f=(0,s.mouseToPage)(t).y;if(u=Math.round(Math.max(e._SZ_MIN,this._szStart+(f-this._htDown.point.y))),o.getRow().height=Math.round(u),i.onResizedRow(o),l&&this._htDown.cellType==a.RowHeader&&n.containsRow(p))for(var g=n.topRow;g<=n.bottomRow;g++)i.rows[g].allowResizing&&g!=p&&(o=new C(i.cells,new m(g,-1)),i.onResizingRow(o)&&(i.rows[g].size=i.rows[p].size,i.onResizedRow(o)));t.preventDefault()}}},e.prototype._handleSelection=function(e,t){var i=this._g,n=i._selHdl.selection,o=new m(e.row,e.col),r=_,l=v;if(o.isValid)if(null==this._lbSelState){switch(e.cellType){case r.RowHeader:o.col=0,o.col2=i.columns.length-1;break;case r.ColumnHeader:switch(i.selectionMode){case l.Row:case l.Cell:o.row=o.row2=n.row,t=!1;break;default:o.row=0,o.row2=i.rows.length-1}}if(t&&(i.anchorCursor?(o.row=n.row,o.col=n.col):(o.row2=n.row2,o.col2=n.col2),!o.isValid)){var a=this._htDown;a&&(o=new m(a.row,a.col))}if(i.selectionMode==v.MultiRange){var h=i._mouseHdl._eMouse,c=h&&(h.ctrlKey||h.metaKey),u=i._selHdl,d=u.selection,p=u.extendedSelection,f=e.panel!=i.cells;(0,s.closest)(h.target,".wj-elem-collapse")&&(c=!1),c?!t&&u._deselectRange(o)?u.selection.isValid&&(o=null):!d.isValid||!f&&d.intersects(o)||(f?this._splitRange(d):[d.clone()]).forEach((function(e){for(var t=!1,i=0;i<p.length&&!t;i++)p[i].equals(e)&&(t=!0);t||p.push(e)})):p.clear()}if(o)switch(i.select(o,!1),e.cellType){case r.RowHeader:i.scrollIntoView(e.row,-1);break;case r.ColumnHeader:i.scrollIntoView(-1,e.col);break;default:i.scrollIntoView(e.row,e.col)}else{var g=new C(i.cells,new m(e.row,e.col));i.onSelectionChanging(g),i.onSelectionChanged(g),i.invalidate()}}else i.rows[e.row].isSelected=!this._lbSelState,i.scrollIntoView(e.row,e.col)},e.prototype._splitRange=function(e){var t=this._g,i=t.columns.length,n=t.rows.length,o=[];if(e.columnSpan==i)for(var r=e.topRow;r<=e.bottomRow;r++)o.push(new m(r,0,r,i-1));else if(e.rowSpan==n)for(var s=e.leftCol;s<=e.rightCol;s++)o.push(new m(0,s,n-1,s));else o.push(e.clone());return o},e._SZ_MIN=0,e._SZ_MAX_COLGRP_EDGE=50,e}();(0,s._registerModule)("wijmo.grid",a)},38074:(e,t,i)=>{i.r(t),i.d(t,{AutoComplete:()=>H,Calendar:()=>m,ClickAction:()=>g,CollectionViewNavigator:()=>h,ColorPicker:()=>a,ComboBox:()=>D,DateSelectionMode:()=>d,DropDown:()=>y,FormatItemEventArgs:()=>u,InputColor:()=>S,InputDate:()=>x,InputDateRange:()=>E,InputDateTime:()=>T,InputMask:()=>l,InputNumber:()=>s,InputTime:()=>R,ListBox:()=>c,Menu:()=>I,MultiAutoComplete:()=>j,MultiSelect:()=>P,MultiSelectListBox:()=>_,Popup:()=>w,PopupBoundsChangingEventArgs:()=>C,PopupTrigger:()=>b,ShowMonthPicker:()=>f});var n=i(728),o=i(38074),r=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();(0,n._addCultureInfo)("InputNumber",{ariaLabels:{incVal:"Increase Value",decVal:"Decrease Value"}});var s=function(e){function t(t,i){var o=e.call(this,t)||this;o._value=null,o._min=null,o._max=null,o._format="",o._step=null,o._showBtn=!0,o._readOnly=!1,o._handleWheel=!0,o._oldText="",o._fromKb=!0,o.textChanged=new n.Event,o.valueChanged=new n.Event;var r=o.hostElement;(0,n.setAttribute)(r,"role","spinbutton",!0);var s=o.getTemplate();o.applyTemplate("wj-control wj-content wj-inputnumber",s,{_tbx:"input",_btnUp:"btn-inc",_btnDn:"btn-dec"},"input");var l=n.culture.InputNumber.ariaLabels;(0,n.setAriaLabel)(o._btnUp.querySelector("button"),l.incVal),(0,n.setAriaLabel)(o._btnDn.querySelector("button"),l.decVal),o._tbx.type.match(/number/i)&&(o.inputType="");var a=o._tbx;a.autocomplete="off",a.spellcheck=!1,o._updateSymbols();var h=o.addEventListener.bind(o);h(a,"keypress",o._keypress.bind(o)),h(a,"keydown",o._keydown.bind(o)),h(a,"input",o._input.bind(o)),h(a,"blur",(function(){o.text!=o._oldText&&o._setText(o.text)})),h(a,"paste",(function(){o._fromKb=!1})),h(a,"compositionstart",(function(){o._composing=!0})),h(a,"compositionend",(function(){o._composing=!1,setTimeout((function(){var e=o.text,t=o._oldText,i=o._chrPct;t&&t.indexOf(i)>-1&&e.indexOf(i)<0&&(e+=i),o._setText(e)}))}));var c=o._clickSpinner.bind(o);return h(o._btnUp,"click",c),h(o._btnDn,"click",c),o._rptUp=new n._ClickRepeater(o._btnUp.querySelector("button")),o._rptDn=new n._ClickRepeater(o._btnDn.querySelector("button")),h(a,"wheel",(function(e){if(o.handleWheel&&!e.defaultPrevented&&!e.ctrlKey&&o._isEditable()&&o.containsFocus()){var t=(0,n.clamp)(-e.deltaY,-1,1);o._increment((o.step||1)*t),setTimeout((function(){return o.selectAll()})),e.preventDefault()}})),o.value=0,o.isRequired=!0,o.initialize(i),o}return r(t,e),Object.defineProperty(t.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputType",{get:function(){return this._tbx.type},set:function(e){this._tbx.type=(0,n.asString)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){if(e!=this._value)if(null==(e=(0,n.asNumber)(e,!this.isRequired||null==e&&null==this._value)))this._setText("");else if(!isNaN(e)){var t=n.Globalize.format(e,this.format);this._setText(t)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRequired",{get:function(){return this._tbx.required},set:function(e){this._tbx.required=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(e){this._readOnly=(0,n.asBoolean)(e),this.inputElement.readOnly=this._readOnly,(0,n.toggleClass)(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"handleWheel",{get:function(){return this._handleWheel},set:function(e){this._handleWheel=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return this._min},set:function(e){e!=this._min&&(this._min=(0,n.asNumber)(e,!0),this._updateAria())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},set:function(e){e!=this._max&&(this._max=(0,n.asNumber)(e,!0),this._updateAria())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"step",{get:function(){return this._step},set:function(e){this._step=(0,n.asNumber)(e,!0),this._updateBtn()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"format",{get:function(){return this._format},set:function(e){e!=this.format&&(this._format=(0,n.asString)(e),this.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._tbx.value},set:function(e){e!=this.text&&(this._oldText=null,this._setText(e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return this._tbx.placeholder},set:function(e){this._tbx.placeholder=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showSpinner",{get:function(){return this._showBtn},set:function(e){this._showBtn=(0,n.asBoolean)(e),this._updateBtn()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"repeatButtons",{get:function(){return!this._rptUp.disabled},set:function(e){this._rptUp.disabled=this._rptDn.disabled=!(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),t.prototype.selectAll=function(){var e=this._tbx;(0,n.setSelectionRange)(e,0,e.value.length)},t.prototype.clamp=function(e){return(0,n.clamp)(e,this.min,this.max)},t.prototype.onTextChanged=function(e){this.textChanged.raise(this,e),this._updateState()},t.prototype.onValueChanged=function(e){this._updateAria(),this.valueChanged.raise(this,e)},t.prototype.dispose=function(){this._rptUp.element=null,this._rptDn.element=null,e.prototype.dispose.call(this)},t.prototype.onGotFocus=function(t){this._oldValue=this.value,this.isTouching||(this._tbx.focus(),this.selectAll()),e.prototype.onGotFocus.call(this,t)},t.prototype.onLostFocus=function(t){if(this._composing&&(this._composing=!1,this._setText(this.text)),this._isEditable()){var i=this.clamp(this.value);if(i==this.value||this.onInvalidInput(new n.CancelEventArgs)){var o=n.Globalize.format(i,this.format);this._setText(o)}}e.prototype.onLostFocus.call(this,t)},t.prototype.refresh=function(t){if(void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this.hostElement){this._updateSymbols();var i=n.Globalize.format(this.value,this.format);this._setText(i)}},t.prototype._isEditable=function(){return!this.isReadOnly&&!this.isDisabled},t.prototype._updateSymbols=function(){var e=n.culture.Globalize.numberFormat,t=n.Globalize._parseNumericFormat(this.format);this._chrDec=e["."]||".",this._chrTho=e[","]||",",this._chrNeg=e["-"]||"-",this._chrPls=e["+"]||"+",this._chrPct=e["%"]||"%",this._chrCur=t.curr||e.currency.symbol||"$",this._fmtSpc=t.spec,this._fmtPrc=t.prec,this._rxSym=new RegExp("^[%+\\-() \\"+this._chrDec+"\\"+this._chrCur+"\\"+this._chrNeg+"\\"+this._chrPls+"\\"+this._chrPct+"]*$"),this._rxNeg=new RegExp("^\\s*(\\-|\\"+this._chrNeg+")|([^e](\\-|\\"+this._chrNeg+")|\\()")},t.prototype._isNumeric=function(e,t){var i=e==this._chrDec||e>="0"&&e<="9",n="x"==this._fmtSpc;return!i&&n&&(i=e>="a"&&e<="f"||e>="A"&&e<="F"),i||t||n||(i=e==this._chrPls||e==this._chrNeg||"("==e||")"==e),i},t.prototype._getInputRange=function(e){for(var t=[0,0],i=this.text,n=!1,o=0;o<i.length;o++)this._isNumeric(i[o],e)&&(n||(t[0]=o,n=!0),t[1]=o+1);return t},t.prototype._flipSign=function(){var e=this._getSelStartDigits();this.value*=-1,this._setSelStartDigits(e)},t.prototype._getSelStartDigits=function(){for(var e=0,t=this._tbx.selectionStart,i=this._tbx.value,n=0;n<i.length&&n<t;n++)this._isNumeric(i[n],!0)&&e++;return e},t.prototype._setSelStartDigits=function(e){for(var t=this._tbx.value,i=0;i<t.length&&e>=0;i++)if(this._isNumeric(t[i],!0)){if(!e){(0,n.setSelectionRange)(this._tbx,i);break}e--}else if(!e){(0,n.setSelectionRange)(this._tbx,i);break}},t.prototype._increment=function(e){if(e){var t=this.clamp((0,n.isNumber)(this.value)?this.value+e:0),i=n.Globalize.format(t,this.format,!1,!1);this._setText(i)}},t.prototype._updateBtn=function(){var e=this.showSpinner&&!!this.step,t=e;(0,n.setCss)([this._btnUp,this._btnDn],{display:e?"":"none"}),(0,n.toggleClass)(this.hostElement,"wj-input-show-spinner",e),(0,n.enable)(this._btnUp,t),(0,n.enable)(this._btnDn,t),this._updateAria()},t.prototype._setText=function(e,t){if(void 0===t&&(t=!1),!this._composing){var i=this._tbx,o=this._chrDec,r=this._rxNeg.test(e),s=this._delKey,l=this.containsFocus();if(e&&this._rxSym.test(e)&&l&&(e=this.isRequired||!s?(r?"-0":"0")+(e.indexOf(o)>-1?o:""):""),this._delKey=!1,s&&0==this.value&&!this.isRequired&&(e=""),!e){if(!this.isRequired)return i.value="",null!=this._value&&(this._value=null,this.onValueChanged()),this._oldText&&(this._oldText=e,this.onTextChanged()),void this._updateBtn();e="0"}var a=e.indexOf(o),h=this._format||(a>-1?"n2":"n0"),c=n.Globalize.parseFloat(e,h);if(isFinite(c)||(c=this.clamp(c)),isNaN(c))this.onInvalidInput(new n.CancelEventArgs)?i.value=this._oldText:this.focus();else{var u=l&&a>-1?2:null,d=n.Globalize.format(c,h,!1,t,u);r&&c>=0&&!s&&(d=this._chrNeg+d),l&&a>-1&&"g"==this._fmtSpc&&0!=this._fmtPrc&&(d=e).indexOf(o)<0&&(d+=o),i.value!=d&&(i.value=d,c=n.Globalize.parseFloat(d,h)),c!=this._value&&(this._value=c,this.onValueChanged()),this.text!=this._oldText&&(this._oldText=this.text,this.onTextChanged()),this._updateBtn(),this._updateState()}}},t.prototype._keypress=function(e){if(!e.defaultPrevented&&!this._composing&&this._isEditable()&&e.charCode&&!e.ctrlKey&&!e.metaKey&&e.keyCode!=n.Key.Enter){var t=this._tbx,i=String.fromCharCode(e.charCode);if(this._isNumeric(i,!1)){var o=t.maxLength;if(o>-1&&t.value.length>=o&&t.selectionEnd==t.selectionStart)return void e.preventDefault();var r=this._getInputRange(!0),s=t.selectionStart,l=t.selectionEnd;if(s<r[0]&&l<t.value.length&&(l=Math.max(l,r[0]),(0,n.setSelectionRange)(t,r[0],l)),s>=r[1]){var a=null!=this._fmtPrc?this._fmtPrc:2,h=t.value.indexOf(this._chrDec);h>-1&&s-h>a&&e.preventDefault()}}else e.preventDefault();switch(i){case"-":case this._chrNeg:this.clamp(-1)>=0?this.value<0&&this._flipSign():this.value&&t.selectionStart==t.selectionEnd?this._flipSign():this.clamp(-1)<0&&(t.value=this._chrNeg,(0,n.setSelectionRange)(t,1)),e.preventDefault();break;case"+":case this._chrPls:this.value<0&&this._flipSign(),e.preventDefault();break;case".":case this._chrDec:if(0==this._fmtPrc)e.preventDefault();else{var c=t.value.indexOf(this._chrDec);c>-1&&(t.selectionStart<=c&&c++,(0,n.setSelectionRange)(t,c),e.preventDefault())}}if(!e.defaultPrevented&&(0,n.isIE)()){var u=t.value;(s=t.selectionStart)==(l=t.selectionEnd)&&(t.value=u.substr(0,s)+i+u.substr(l),(0,n.setSelectionRange)(t,s+1),e.preventDefault(),this._input())}}},t.prototype._keydown=function(e){var t=this;if(this._delKey=!1,!e.defaultPrevented&&!this._composing&&!(0,n.hasClass)(this._tbx,"wj-grid-ime")){var i=this._tbx,o=i.value,r=i.selectionStart,s=i.selectionEnd;switch(e.keyCode){case 65:e.ctrlKey&&(setTimeout((function(){t.selectAll()})),e.preventDefault());break;case n.Key.Up:case n.Key.Down:this.step&&this._isEditable()&&(this._increment(this.step*(e.keyCode==n.Key.Up?1:-1)),setTimeout((function(){t.selectAll()})),e.preventDefault());break;case n.Key.Back:if(this._delKey=!0,s-r<2&&this._isEditable()){var l=o[s-1];l!=this._chrDec&&l!=this._chrPct&&l!=this._chrTho&&")"!=l||(setTimeout((function(){s=l==t._chrPct?t._getInputRange(!0)[1]:s-1,(0,n.setSelectionRange)(i,s)})),e.preventDefault())}break;case n.Key.Delete:if(this._delKey=!0,s-r<2&&this._isEditable())if("0"==o&&1==r)(0,n.setSelectionRange)(i,0);else{var a=o[r];a!=this._chrDec&&a!=this._chrPct||(setTimeout((function(){(0,n.setSelectionRange)(i,r+1)})),e.preventDefault())}break;case n.Key.Escape:this.value=this._oldValue,this.selectAll()}}},t.prototype._input=function(){var e=this;this._composing?this._fromKb=!0:setTimeout((function(){var t=e._tbx,i=t.value,o=i.indexOf(e._chrDec),r=t.selectionStart,s=e._getSelStartDigits();if("p"==e._fmtSpc&&i.length&&i.indexOf(e._chrPct)<0&&(i+=e._chrPct),e._setText(i,e._fromKb),e._fromKb=!0,e.containsFocus()){var l=t.value,a=l.indexOf(e._chrDec),h=e._getInputRange(!0);if(i==e._chrNeg+e._chrDec&&a>-1)return void(0,n.setSelectionRange)(t,a+1);if(i[0]==e._chrNeg&&l[0]!=e._chrNeg)return void(1==l.length?(0,n.setSelectionRange)(t,1):e._setSelStartDigits(s));i?i==e._chrDec&&a>-1?r=a+1:r<=o&&a>-1||o<0&&a<0?r+=l.length-i.length:o<0&&a>-1&&(r=a):r=a>-1?a:h[1],r=(0,n.clamp)(r,h[0],h[1]),(0,n.setSelectionRange)(t,r)}}))},t.prototype._clickSpinner=function(e){var t=this;!e.defaultPrevented&&this._isEditable()&&this.step&&(this._increment(this.step*((0,n.contains)(this._btnUp,e.target)?1:-1)),this.isTouching||setTimeout((function(){return t.selectAll()})))},t.prototype._updateAria=function(){var e=this.hostElement;e&&((0,n.setAttribute)(e,"aria-valuemin",this.min),(0,n.setAttribute)(e,"aria-valuemax",this.max),(0,n.setAttribute)(e,"aria-valuenow",this.value),(0,n.enable)(this._btnDn,null==this.min||this.value>this.min),(0,n.enable)(this._btnUp,null==this.max||this.value<this.max))},t.controlTemplate='<div class="wj-template"><div class="wj-input"><div class="wj-input-group"><span wj-part="btn-dec" class="wj-input-group-btn" tabindex="-1"><button class="wj-btn wj-btn-default" tabindex="-1">-</button></span><input type="tel" wj-part="input" class="wj-form-control wj-numeric"/><span wj-part="btn-inc" class="wj-input-group-btn" tabindex="-1"><button class="wj-btn wj-btn-default" tabindex="-1">+</button></span></div></div></div>',t}(n.Control),l=function(e){function t(t,i){var o=e.call(this,t)||this;o.valueChanged=new n.Event;var r=o.getTemplate();if(o.applyTemplate("wj-control wj-content wj-inputmask",r,{_tbx:"input"},"input"),"INPUT"==o._orgTag){var s=o._tbx.getAttribute("value");s&&(o.value=s)}return o._msk=new n._MaskProvider(o._tbx),o.isRequired=!0,o.initialize(i),o.addEventListener(o._tbx,"input",(function(){o.onValueChanged()})),o.addEventListener(o._tbx,"blur",o._commitText.bind(o)),o.addEventListener(o._tbx,"keydown",(function(e){e.keyCode==n.Key.Enter&&o._commitText()})),o}return r(t,e),Object.defineProperty(t.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputType",{get:function(){return this._tbx.type},set:function(e){this._tbx.type=(0,n.asString)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._tbx.value},set:function(e){e!=this.value&&(this._tbx.value=(0,n.asString)(e),e=this._msk._applyMask(),this._tbx.value=e,this.onValueChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rawValue",{get:function(){return this._msk.getRawValue()},set:function(e){e!=this.rawValue&&(this.value=(0,n.asString)(e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mask",{get:function(){return this._msk.mask||""},set:function(e){var t=this.value;this._msk.mask=(0,n.asString)(e),this.value!=t&&this.onValueChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promptChar",{get:function(){return this._msk.promptChar},set:function(e){var t=this.value;this._msk.promptChar=e,this.value!=t&&this.onValueChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"overwriteMode",{get:function(){return this._msk.overwriteMode},set:function(e){this._msk.overwriteMode=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return this._tbx.placeholder},set:function(e){this._tbx.placeholder=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maskFull",{get:function(){return this._msk.maskFull},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRequired",{get:function(){return this._tbx.required},set:function(e){this._tbx.required=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this._tbx.readOnly},set:function(e){this._tbx.readOnly=(0,n.asBoolean)(e),(0,n.toggleClass)(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0}),t.prototype.selectAll=function(){var e=this._msk.getMaskRange();(0,n.setSelectionRange)(this._tbx,e[0],e[1]+1)},t.prototype.onValueChanged=function(e){this.value!=this._oldValue&&(this._oldValue=this.value,this.valueChanged.raise(this,e)),this._updateState()},t.prototype._commitText=function(){(this.rawValue||this.isRequired)&&(this.maskFull||this.onInvalidInput(new n.CancelEventArgs)),this._updateState()},t.prototype.dispose=function(){this._msk.input=null,e.prototype.dispose.call(this)},t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this.hostElement&&this._msk.refresh()},t.prototype.onGotFocus=function(t){e.prototype.onGotFocus.call(this,t),this.selectAll()},t.controlTemplate='<div class="wj-input"><div class="wj-input-group"><input wj-part="input" class="wj-form-control"/></div></div>',t}(n.Control),a=function(e){function t(i,o){var r=e.call(this,i)||this;r._hsb=[.5,1,1],r._alpha=1,r.valueChanged=new n.Event;var s=r.getTemplate();r.applyTemplate("wj-control wj-content wj-colorpicker",s,{_eSB:"div-sb",_eHue:"div-hue",_eAlpha:"div-alpha",_ePreview:"div-pv",_ePal:"div-pal",_eText:"div-text"}),r._palette="#FFF,#000,#F00,#FFC000,#FFFF00,#92D050,#00B050,#00B0F0,#0070C0,#7030A0".split(","),r._updatePalette(),r._eHue.style.backgroundImage="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAD4CAIAAACi6hsPAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAAGvSURBVDhPXdBPaM9xHMfxz4pWaxcmtoOhpdXSVpiyHWxqmVpDjaU5rK34XfypjTJ/p+ZPay6jhsOsRrKwaJElf9IQq03WIkv4FeMwMq221tfje1ByeFzfvd7PEKWGEKWTQRZLySWfVRRTQjmVbKWGOhLsZT+HaeY0bbTTQSfdXOcWffTzmAFeMcwoYyT5ygS/mA5hNgphip98J8kHRnnNSwZ4yH1uc4OrdHGR87RximYO0cgedlLLdqqoYAPrWMtKVrCcJSxiPmnMJUQp/Bsyk2xyyKOAQooopYwKtlDNDur5G7SBJo7RQiv/B+2hl3s84CkvGGKEOOYnxolj/mYmhBmDJ5ngCx95xxsGecYj4pB3iENeoZMO2mmlhaMcpIE4ZII6aqhmM3HMMkooopB88sghm0wySCeVlCjMCVFIYx4LWUwOeRSwhmLWU84mqqihll3sppEmjnOSs5zjEl1c4yZ99POE5wwxwns+840fTDFLFKaZZIJxkozxlmEGGSC+GF++Sy89dHOZC8Rr4lVnOMERDrCPBPXEX22jko2UEn+/mnxyWUYWC0gnNUQh/AEc0HJs6cex0gAAAABJRU5ErkJggg==)",r._eHue.style.backgroundSize="contain",navigator.appVersion.indexOf("MSIE 9")>-1&&(r._eSB.children[0].style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr=#ffffffff,endColorstr=#00ffffff,GradientType=1)",r._eSB.children[1].style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr=#00000000,endColorstr=#ff000000,GradientType=0)"),s=t._tplCursor,r._cSB=(0,n.createElement)(s),r._cHue=(0,n.createElement)(s),r._cHue.style.width="100%",r._cAlpha=(0,n.createElement)(s),r._cAlpha.style.height="100%",r._eSB.appendChild(r._cSB),r._eHue.appendChild(r._cHue),r._eAlpha.appendChild(r._cAlpha);var l=r.addEventListener.bind(r),a=r.removeEventListener.bind(r),h=document;l(r.hostElement,"mousedown",(function(e){l(h,"mousemove",c),l(h,"mouseup",u),r._mouseDown(e)})),l(r.hostElement,"touchstart",(function(e){l(h,"touchmove",c),l(h,"touchend",u),r._mouseDown(e)}));var c=function(e){r._mouseMove(e)},u=function(e){a(h,"mousemove",c),a(h,"mouseup",u),a(h,"touchmove",c),a(h,"touchend",u),r._mouseUp(e)};return l(r.hostElement,"click",(function(e){var t=e.target;if(t&&"DIV"==t.tagName&&(0,n.contains)(r._ePal,t)){var i=t.style.backgroundColor;i&&(r.value=new n.Color(i).toString())}})),r.value="#ffffff",r.initialize(o),r._updatePanels(),r}return r(t,e),Object.defineProperty(t.prototype,"showAlphaChannel",{get:function(){return"none"!=this._eAlpha.parentElement.style.display},set:function(e){this._eAlpha.parentElement.style.display=(0,n.asBoolean)(e)?"":"none"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showColorString",{get:function(){return"none"!=this._eText.style.display},set:function(e){this._eText.style.display=(0,n.asBoolean)(e)?"":"none"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){if(e!=this.value){e=(0,n.asString)(e);var t=n.Color.fromString(e);if(t){this._value=e,this._eText.innerText=e;var i=t.getHsb();this._hsb[0]==i[0]&&this._hsb[1]==i[1]&&this._hsb[2]==i[2]&&this._alpha==t.a||(0==i[2]?(i[0]=this._hsb[0],i[1]=this._hsb[1]):0==i[1]&&(i[0]=this._hsb[0]),this._hsb=i,this._alpha=t.a,this._updatePanels(),this.onValueChanged())}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"palette",{get:function(){return this._palette},set:function(e){(e=(e=(0,n.asArray)(e)).slice(0,10)).every((function(e){return null!=n.Color.fromString(e)}))&&(this._palette=e,this._updatePalette())},enumerable:!0,configurable:!0}),t.prototype.onValueChanged=function(e){this._updatePanels(),this.valueChanged.raise(this,e)},t.prototype._mouseDown=function(e){this._htDown=this._getTargetPanel(e),this._htDown&&(e.preventDefault(),this.focus(),this._mouseMove(e))},t.prototype._mouseMove=function(e){var t=e.touches?e.touches[0]:e,i=this._htDown;if(i){var o=i.getBoundingClientRect(),r=this._hsb;i==this._eHue?r[0]=(0,n.clamp)((t.clientY-o.top)/o.height,0,.99):i==this._eSB?(r[1]=(0,n.clamp)((t.clientX-o.left)/o.width,0,1),r[2]=(0,n.clamp)(1-(t.clientY-o.top)/o.height,0,1)):i==this._eAlpha&&(this._alpha=(0,n.clamp)((t.clientX-o.left)/o.width,0,1)),this._updateColor()}},t.prototype._mouseUp=function(e){this._htDown=null},t.prototype._updateColor=function(){var e=n.Color.fromHsb(this._hsb[0],this._hsb[1],this._hsb[2],this._alpha);this.value=e.toString(),this._updatePanels()},t.prototype._updatePalette=function(){var e=new n.Color("#fff"),t=new n.Color("#000");this._ePal.innerHTML="";for(var i=0;i<this._palette.length;i++){var o=(0,n.createElement)('<div style="float:left;width:10%;box-sizing:border-box;padding:1px">'),r=new n.Color(this._palette[i]),s=r.getHsb();o.appendChild(this._makePalEntry(r,4));for(var l=0;l<5;l++){if(0==s[1]){var a=.1*l+(s[2]>.5?.05:.55);r=n.Color.interpolate(e,t,a)}else r=n.Color.fromHsb(s[0],.1+.2*l,1-.1*l);o.appendChild(this._makePalEntry(r,0))}this._ePal.appendChild(o)}},t.prototype._makePalEntry=function(e,t){var i=document.createElement("div");return(0,n.setCss)(i,{cursor:"pointer",backgroundColor:e.toString(),marginBottom:t||""}),i.innerHTML="&nbsp",i},t.prototype._updatePanels=function(){var e=n.Color.fromHsb(this._hsb[0],1,1,1),t=n.Color.fromHsb(this._hsb[0],this._hsb[1],this._hsb[2],1);this._eSB.style.backgroundColor=e.toString(),this._eAlpha.style.background="linear-gradient(to right, transparent 0%, "+t.toString()+" 100%)",navigator.appVersion.indexOf("MSIE 9")>-1&&(this._eAlpha.style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr=#00000000,endColorstr="+t.toString()+", GradientType = 1)"),this._ePreview.style.backgroundColor=this.value,this._cHue.style.top=(100*this._hsb[0]).toFixed(0)+"%",this._cSB.style.left=(100*this._hsb[1]).toFixed(0)+"%",this._cSB.style.top=(100-100*this._hsb[2]).toFixed(0)+"%",this._cAlpha.style.left=(100*this._alpha).toFixed(0)+"%"},t.prototype._getTargetPanel=function(e){var t=e.target;return(0,n.contains)(this._eSB,t)?this._eSB:(0,n.contains)(this._eHue,t)?this._eHue:(0,n.contains)(this._eAlpha,t)?this._eAlpha:null},t.controlTemplate='<div style="position:relative;width:100%;height:100%"><div style="float:left;width:50%;height:100%;box-sizing:border-box;padding:2px"><div wj-part="div-pal"><div style="float:left;width:10%;box-sizing:border-box;padding:2px"><div style="background-color:black;width:100%">&nbsp;</div><div style="height:6px"></div></div></div><div wj-part="div-text" style="position:absolute;bottom:0px;display:none"></div></div><div style="float:left;width:50%;height:100%;box-sizing:border-box;padding:2px"><div wj-part="div-sb" class="wj-colorbox" style="float:left;width:89%;height:89%"><div style="position:absolute;width:100%;height:100%;background:linear-gradient(to right, white 0%,transparent 100%)"></div><div style="position:absolute;width:100%;height:100%;background:linear-gradient(to top, black 0%,transparent 100%)"></div></div><div style="float:left;width:1%;height:89%"></div><div style="float:left;width:10%;height:89%"><div wj-part="div-hue" class="wj-colorbox"></div></div><div style="float:left;width:89%;height:1%"></div><div style="float:left;width:89%;height:10%"><div style="width:100%;height:100%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAAAcSURBVBhXY/iPBBYgAWpKQGkwgMqDAdUk/v8HAM7Mm6GatDUYAAAAAElFTkSuQmCC)"><div wj-part="div-alpha" class="wj-colorbox"></div></div></div><div style="float:left;width:1%;height:10%"></div><div style="float:left;width:10%;height:10%"><div wj-part="div-pv" class="wj-colorbox" style="position:static"></div></div></div></div>',t._tplCursor='<div style="position:absolute;left:50%;top:50%;width:7px;height:7px;transform:translate(-50%,-50%);border:2px solid #f0f0f0;border-radius:50px;box-shadow:0px 0px 4px 2px #0f0f0f"></div>',t}(n.Control),h=function(e){function t(t,i){var o=e.call(this,t)||this;o._view=null,o._byPage=!1,o._fmt="{current:n0} / {count:n0}";var r=o.getTemplate();return o.applyTemplate("wj-control wj-content wj-pager wj-collectionview-navigator",r,{_btnFirst:"btn-first",_btnPrev:"btn-prev",_txtCurr:"txt-curr",_btnNext:"btn-next",_btnLast:"btn-last"},"input"),o._rptNext=new n._ClickRepeater(o._btnNext.querySelector("button")),o._rptPrev=new n._ClickRepeater(o._btnPrev.querySelector("button")),o.addEventListener(o.hostElement,"click",o._click.bind(o)),o.initialize(i),o._update(),o}return r(t,e),Object.defineProperty(t.prototype,"cv",{get:function(){return this._view},set:function(e){if(e!=this._view){var t=this._view;t&&(t.collectionChanged.removeHandler(this._collectionChanged),t.currentChanged.removeHandler(this._currentChanged)),t=this._view=(0,n.asType)(e,"ICollectionView",!0),this._update(),t&&(t.collectionChanged.addHandler(this._collectionChanged,this),t.currentChanged.addHandler(this._currentChanged,this))}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"byPage",{get:function(){return this._byPage},set:function(e){e!=this._byPage&&(this._byPage=(0,n.asBoolean)(e),this._update())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"headerFormat",{get:function(){return this._fmt},set:function(e){e!=this._fmt&&(this._fmt=(0,n.asString)(e),this._update())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"repeatButtons",{get:function(){return!this._rptNext.disabled},set:function(e){this._rptNext.disabled=this._rptPrev.disabled=!(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),t.prototype._update=function(){var e=this._view,t=this._byPage,i=e?t?e.pageIndex:e.currentPosition:0,o=e?t?e.pageCount:e.itemCount:0;(0,n.enable)(this._btnFirst,e&&i>0),(0,n.enable)(this._btnPrev,e&&i>0),(0,n.enable)(this._txtCurr,null!=e),(0,n.enable)(this._btnNext,e&&i<o-1),(0,n.enable)(this._btnLast,e&&i<o-1),this._txtCurr.value=(0,n.format)(this._fmt,{current:e?i+1:0,count:e?o:0,currentItem:e?e.currentPosition+1:0,itemCount:e?e.itemCount:0,currentPage:e?e.pageIndex+1:0,pageCount:e?e.pageCount:0})},t.prototype._currentChanged=function(){this._update()},t.prototype._collectionChanged=function(){this._update()},t.prototype._click=function(e){var t=e.target,i=this._view,o=this._byPage;i&&((0,n.contains)(this._btnFirst,t)?o?i.moveToFirstPage():i.moveCurrentToFirst():(0,n.contains)(this._btnPrev,t)?o?i.moveToPreviousPage():i.moveCurrentToPrevious():(0,n.contains)(this._btnNext,t)?o?i.moveToNextPage():i.moveCurrentToNext():(0,n.contains)(this._btnLast,t)&&(o?i.moveToLastPage():i.moveCurrentToLast()),e.preventDefault())},t.controlTemplate='<div class="wj-input-group"><span wj-part="btn-first" class="wj-input-group-btn"><button class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-step-backward"></span></button></span><span wj-part="btn-prev" class="wj-input-group-btn"> <button class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-left"></span> </button></span><input wj-part="txt-curr" class="wj-form-control" readonly><span wj-part="btn-next" class="wj-input-group-btn"><button class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-right"></span></button></span><span wj-part="btn-last" class="wj-input-group-btn"><button class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-step-forward"></span></button></span></div>',t}(n.Control),c=function(e){function t(i,o){var r=e.call(this,i,null,!0)||this;r._cv=null,r._itemFormatter=null,r._pathDisplay=new n.Binding(""),r._pathValue=new n.Binding(""),r._pathChecked=new n.Binding(""),r._html=!1,r._shGroups=!1,r._checkedItems=[],r._itemRole="option",r._caseSensitive=!1,r._vThreshold=t._VTHRESH,r._isVirtual=!1,r._children=[],r._clientHeight=-1,r._itemHeight=30,r._itemsAbove=-1,r._itemsBelow=-1,r._eSizer=document.createElement("div"),r._ePadTop=document.createElement("div"),r._ePadBot=document.createElement("div"),r._checking=!1,r._search="",r._fmtItemHandlers=0,r._itemCount=0,r._oldSel=null,r._container=null,r.selectedIndexChanged=new n.Event,r.itemsChanged=new n.Event,r.loadingItems=new n.Event,r.loadedItems=new n.Event,r.itemChecked=new n.Event,r.checkedItemsChanged=new n.Event,r.formatItem=new n.Event((function(){r.invalidate()})),r.applyTemplate("wj-control wj-content wj-listbox",null,null);var s=r.hostElement;return(0,n.setAttribute)(s,"role","listbox",!0),"SELECT"==r._orgTag&&r._initFromSelect(r.hostElement),r.addEventListener(s,"click",r._click.bind(r)),r.addEventListener(s,"keydown",r._keydown.bind(r)),r.addEventListener(s,"keypress",r._keypress.bind(r)),r.addEventListener(s,"wheel",(function(e){s.scrollHeight>s.offsetHeight&&(e.deltaY<0&&0==s.scrollTop||e.deltaY>0&&s.scrollTop+s.offsetHeight>=s.scrollHeight)&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation())})),[r._eSizer,r._ePadTop,r._ePadBot].forEach((function(e){e.tabIndex=-1,(0,n.setAttribute)(e,"aria-hidden",!0),(0,n.setCss)(e,{pointerEvents:"none",opacity:"0"})})),r.initialize(o),r._updateViewRange(),r.hostElement.addEventListener("scroll",(function(e){r._updateViewRange()})),r}return r(t,e),Object.defineProperty(t.prototype,"itemsSource",{get:function(){return this._items},set:function(e){this._items!=e&&(this._cv&&(this._cv.currentChanged.removeHandler(this._cvCurrentChanged,this),this._cv.collectionChanged.removeHandler(this._cvCollectionChanged,this),this._cv=null),this._items=e,this._cv=(0,n.asCollectionView)(e),null!=this._cv&&(this._cv.currentChanged.addHandler(this._cvCurrentChanged,this),this._cv.collectionChanged.addHandler(this._cvCollectionChanged,this)),this._populateList(),this.onItemsChanged(),this.onSelectedIndexChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"virtualizationThreshold",{get:function(){return this._vThreshold},set:function(e){if(e!=this._vThreshold){var t=this._getVirtual();this._vThreshold=(0,n.asNumber)(e,!1,!0),t!=this._getVirtual()&&this._populateList()}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showGroups",{get:function(){return this._shGroups},set:function(e){e!=this._shGroups&&(this._shGroups=(0,n.asBoolean)(e),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isContentHtml",{get:function(){return this._html},set:function(e){e!=this._html&&(this._html=(0,n.asBoolean)(e),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemFormatter",{get:function(){return this._itemFormatter},set:function(e){e!=this._itemFormatter&&(this._itemFormatter=(0,n.asFunction)(e),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayMemberPath",{get:function(){return this._pathDisplay.path},set:function(e){e!=this.displayMemberPath&&(this._pathDisplay.path=(0,n.asString)(e),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedValuePath",{get:function(){return this._pathValue.path},set:function(e){this._pathValue.path=(0,n.asString)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checkedMemberPath",{get:function(){return this._pathChecked.path},set:function(e){e!=this.checkedMemberPath&&(this._pathChecked.path=(0,n.asString)(e),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"caseSensitiveSearch",{get:function(){return this._caseSensitive},set:function(e){this._caseSensitive=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemRole",{get:function(){return this._itemRole},set:function(e){e!=this.itemRole&&(this._itemRole=(0,n.asString)(e),this._populateList())},enumerable:!0,configurable:!0}),t.prototype.getDisplayValue=function(e){var t=null;e>-1&&(0,n.hasItems)(this._cv)&&(t=this._cv.items[e],this.displayMemberPath&&(t=this._pathDisplay.getValue(t)));var i=null!=t?t.toString():"";return this._itemFormatter&&(i=this._itemFormatter(e,i)),i},t.prototype.getDisplayText=function(e){var t=this._getChild(e);return null!=t?t.textContent:""},t.prototype.isItemEnabled=function(e){var t=this._getChild(e);return null!=t&&!t.hasAttribute("disabled")&&!(0,n.hasClass)(t,"wj-state-disabled")&&!(0,n.hasClass)(t,"wj-separator")},Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return this._cv?this._cv.currentPosition:-1},set:function(e){this._cv&&this._cv.moveCurrentToPosition((0,n.asNumber)(e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedItem",{get:function(){return this._cv?this._cv.currentItem:null},set:function(e){this._cv&&this._cv.moveCurrentTo(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedValue",{get:function(){var e=this.selectedItem;return e&&this.selectedValuePath&&(e=this._pathValue.getValue(e)),e},set:function(e){var t=this._cv,i=t?t.items:null,o=this.selectedValuePath,r=-1;if(i){for(var s=0;s<i.length;s++){var l=i[s],a=o?this._pathValue.getValue(l):l;if(a===e||n.DateTime.equals(a,e)){r=s;break}if(this.isContentHtml&&(0,n.isString)(a)&&a.indexOf("<")>-1&&(0,n.toPlainText)(a)===e){r=s;break}}this.selectedIndex=r}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxHeight",{get:function(){var e=this.hostElement,t=e?parseFloat(e.style.maxHeight):null;return isNaN(t)?null:t},set:function(e){var t=this.hostElement;t&&(e=(0,n.asNumber)(e,!0),t.style.maxHeight=null==e?"":e+"px")},enumerable:!0,configurable:!0}),t.prototype.showSelection=function(e){void 0===e&&(e=this.containsFocus());var t=this.hostElement,i=this._children,o=this._getSelectedElement(!1),r=new n.Rect(0,0,0,0);o!=this._oldSel&&(this._updateItemAttributes(o,!0),this._updateItemAttributes(this._oldSel,!1),this._oldSel=o),o instanceof HTMLElement?r=this._getBoundingClientRect(o):this._children.length>0&&(r=this._getBoundingClientRect(this._getChild(0)));var s=this._getBoundingClientRect(t),l=0;if(this._shGroups&&(l=this._itemHeight,!this._isVirtual)){var a=i[0];a.offsetHeight&&(0,n.hasClass)(a,"wj-header")&&(l=a.offsetHeight)}r.bottom>s.bottom?t.scrollTop+=r.bottom-s.bottom:r.top<s.top+l&&(t.scrollTop-=s.top+l-r.top),this._updateViewRange(),o=this._getSelectedElement(!0),e&&(o&&!(0,n.contains)(o,(0,n.getActiveElement)())?o:t).focus(),t.tabIndex=o?-1:this._orgTabIndex},t.prototype.loadList=function(){this._populateList()},t.prototype.getItemChecked=function(e){var t=this._cv.items[e],i=this._pathChecked;if((0,n.isObject)(t)&&i.path)return i.getValue(t);var o=this._getCheckbox(e);return!!o&&o.checked},t.prototype.setItemChecked=function(e,t){this._setItemChecked(e,t,!0)},t.prototype.toggleItemChecked=function(e){this.setItemChecked(e,!this.getItemChecked(e))},Object.defineProperty(t.prototype,"checkedItems",{get:function(){return this._checkedItems},set:function(e){var t=(0,n.asArray)(e,!1);this._arrayEquals(t,this._checkedItems)||(this._updateCheckedList(t),this._arrayEquals(t,this._checkedItems)||(this._checkedItems=t,this.onCheckedItemsChanged()))},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(e){return(e=(0,n.closest)(e,".wj-listbox-item"))?e[t._DIDX_KEY]:-1},t.prototype.onSelectedIndexChanged=function(e){this.selectedIndexChanged.raise(this,e)},t.prototype.onItemsChanged=function(e){this.itemsChanged.raise(this,e)},t.prototype.onLoadingItems=function(e){this.loadingItems.raise(this,e)},t.prototype.onLoadedItems=function(e){this.loadedItems.raise(this,e)},t.prototype.onItemChecked=function(e){this.itemChecked.raise(this,e)},t.prototype.onCheckedItemsChanged=function(e){this.checkedItemsChanged.raise(this,e)},t.prototype.onFormatItem=function(e){this.formatItem.raise(this,e)},t.prototype.refresh=function(t){if(void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this.hostElement){var i=this._cv?this._cv.items.length:0,n=this.formatItem.handlerCount;i!=this._itemCount||n!=this._fmtItemHandlers?(this._fmtItemHandlers=n,this._populateList()):this._updateViewRange()}},t.prototype._updateCheckedList=function(e){var t=this,i=this._cv,o=this._pathChecked,r=new Map;if(o&&i){var s=i.sourceCollection;if(s&&s.length){(0,n.isObject)(s[0])||(o=null),e.forEach((function(e){return r.set(e,!0)})),this._checking=!0;var l=[];s.forEach((function(e){var t=r.has(e);t&&l.push(e),o&&o.setValue(e,t)})),this._checking=!1,e=l}i.items.forEach((function(e,i){t._setItemChecked(i,r.has(e),!1)}))}},t.prototype._getBoundingClientRect=function(e){if(!e.offsetHeight){var t=this.indexOf(e),i=this.hostElement;if(t>-1&&i){t=this._getElementIndex(t);var o=i.getBoundingClientRect();return new n.Rect(0,o.top-i.scrollTop+t*this._itemHeight,o.width,this._itemHeight)}}return n.Rect.fromBoundingRect(e.getBoundingClientRect())},t.prototype._updateItemAttributes=function(e,t){if(e){var i=this.checkedMemberPath?this._getCheckbox(this.indexOf(e)):null,o=i?i.checked:null;(0,n.toggleClass)(e,"wj-state-selected",t),(0,n.setAttribute)(e,"aria-selected",this._getAriaSelected(t,o)),e.tabIndex=t?this._orgTabIndex:-1}},t.prototype._getCheckedItems=function(){var e=this,t=this._cv,i=this._pathChecked,o=[];return t&&i&&i.path&&(o=t.sourceCollection.filter((function(o,r){if(t.filter&&!t.filter(o))return!1;if((0,n.isObject)(o))return i.getValue(o);var s=t.items[r]==o?r:t.items.indexOf(o);return e.getItemChecked(s)}))),o},t.prototype._arrayEquals=function(e,t){if(e==t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0},t.prototype._getChild=function(e){return e=this._getElementIndex(e),this._children[e]},t.prototype._getElementIndex=function(e){if(this._shGroups)for(var t=this._children,i=0;i<=e&&i<t.length;i++){var o=t[i];(0,n.hasClass)(o,"wj-header")&&e++}return e},t.prototype._setItemChecked=function(e,t,i){void 0===i&&(i=!0);var o=this._cv.items[e],r=this._pathChecked,s=!1,l=this.selectedIndex,a=this._checking;if((0,n.isObject)(o)&&r.path){if(!!r.getValue(o)!=t){var h=(0,n.tryCast)(this._cv,"IEditableCollectionView");s=!0,this._checking=!0,h?(h.editItem(o),r.setValue(o,t),h.commitEdit()):(r.setValue(o,t),h.refresh()),this._checking=a}}else if(i){var c=this._checkedItems.indexOf(o);(t&&c<0||!t&&c>=0)&&(s=!0)}var u=this._getCheckbox(e);if(u){u.checked=t;var d=(0,n.closest)(u,".wj-listbox-item");d&&((0,n.toggleClass)(d,"wj-state-checked",t),(0,n.setAttribute)(d,"aria-selected",!!t||null))}return i&&(s&&(this._checkedItems=this._checkedItemsUpdate(o,t),this.onItemChecked(),this.onCheckedItemsChanged()),l!=this.selectedIndex&&this.onSelectedIndexChanged()),s},t.prototype._checkedItemsUpdate=function(e,t){var i=this._cv.sourceCollection,n=this._checkedItems,o=0,r=0;if(!t){var s=n.indexOf(e);return n.slice(0,s).concat(n.slice(s+1))}for(;;o++){var l=i[o];if(l===n[r])r++;else if(l===e)return n.slice(0,r).concat([e]).concat(n.slice(r))}},t.prototype._cvCollectionChanged=function(){this._checking||(this._populateList(),this.onItemsChanged())},t.prototype._cvCurrentChanged=function(){this._checking||(this.showSelection(),this.onSelectedIndexChanged())},t.prototype._populateList=function(){var e=this.hostElement,i=this._cv;if(this._itemCount=i?i.items.length:0,this._isVirtual=this._getVirtual(),this._oldSel=null,this._itemsAbove=-1,this._itemsBelow=-1,e){var o=this.containsFocus(),r=void 0;this.onLoadingItems();var s=this._children=[];if(e.textContent="",i){var l=0,a=void 0,h=[];if(this._shGroups&&i.groups&&i.groups.length){r={};for(var c=0;c<i.groups.length;c++){var d=i.groups[c];r[l]=d,a=this._createHeaderItem(d),h.push(a);for(var p=0;p<d.items.length;p++,l++)a=this._createItem(l),h.push(a)}}else for(p=0;p<i.items.length;p++,l++)a=this._createItem(l),h.push(a);var f=this._isVirtual?document.createElement("div"):e,_=0;for(f.innerHTML=h.join(""),p=0;p<f.children.length;p++){var g=f.children[p];_==i.currentPosition&&(this._oldSel=g),g[t._DIDX_KEY]=g.className.indexOf("wj-header")<0?_++:-1,s.push(g)}}if(this.formatItem.hasHandlers&&i){l=0;var m=i.items;for(g=new u(0,null,null),p=0;p<s.length;p++)g._item=s[p],this._shGroups&&(0,n.hasClass)(g._item,"wj-header")?(g._index=-1,g._data=r[l]):(g._index=l,g._data=m[l++]),this.onFormatItem(g)}if(this._isVirtual){var v=this._getCanvasContext(),b=null,y=0;for(p=0;p<s.length;p++){a=s[p];var w=v.measureText(a.textContent);w.width>y&&(b=a,y=w.width)}if(b){var C=!1,x=e.style.display,E=e.style.position;e.parentElement||(C=!0,(this._container||document.body).appendChild(e),(0,n.setCss)(e,{display:"",position:"absolute"})),e.appendChild(b);var S=b.style.whiteSpace;b.style.whiteSpace="nowrap",this._ePadTop.style.width=b.offsetWidth+"px",this._itemHeight=b.offsetHeight||this._itemHeight,b.style.whiteSpace=S,this._eSizer.style.height=s.length*this._itemHeight+"px",e.appendChild(this._eSizer),this._clientHeight=e.clientHeight,(0,n.removeChild)(this._eSizer),C&&((0,n.removeChild)(e),(0,n.setCss)(e,{display:x,position:E})),(0,n.removeChild)(b)}else this._ePadTop.style.width="";this._updateViewRange()}this.checkedItems=this._getCheckedItems();var D=this._getSelectedElement(!0);o?(D||e).focus():D&&this.showSelection(),e.tabIndex=D?-1:this._orgTabIndex,this.onLoadedItems()}},t.prototype._getCanvasContext=function(){var e=document.createElement("canvas").getContext("2d"),t=getComputedStyle(this.hostElement);return t.fontSize&&t.fontFamily&&(e.font=t.fontSize+" "+t.fontFamily.split(",")[0]),e},t.prototype._getVirtual=function(){if(this._itemCount<=this._vThreshold)return!1;var e=this.hostElement;if(e){var t=getComputedStyle(e);if(parseInt(t.columnCount)>1||t.display.indexOf("flex")>-1||t.display.indexOf("grid")>-1)return!1}return!0},t.prototype._getMaxSupportedCssHeight=function(){var e=265e5;return(0,n.isIE)()?e=15e5:(0,n.isFirefox)()&&(e=175e5),e},t.prototype._updateViewRange=function(){var e=this.hostElement,t=this._itemHeight,i=this._children;if(!(e&&e.parentElement&&this._isVirtual&&i))return!1;var o=e.scrollTop;(0,n.assert)(t*i.length<this._getMaxSupportedCssHeight(),"The number of items ("+i.length+") exceeds the maximum number of items ("+Math.floor(this._getMaxSupportedCssHeight()/t)+") allowed for this browser.");var r=Math.max(e.clientHeight,this._clientHeight),s=Math.floor(o/t),l=Math.min(i.length,Math.ceil((o+r)/t)-s),a=Math.max(0,i.length-s-l);if(s==this._itemsAbove&&a==this._itemsBelow)return!1;this._itemsAbove=s,this._itemsBelow=a;var h=document.createDocumentFragment(),c=this.containsFocus();if(this._ePadTop.style.height=s*t+"px",h.appendChild(this._ePadTop),this.showGroups&&!(0,n.hasClass)(i[s],"wj-header"))for(var u=s;u>=0;u--)if((0,n.hasClass)(i[u],"wj-header")){h.appendChild(i[u]);break}for(u=s;u<=s+l&&u<i.length;u++)h.appendChild(i[u]);this._ePadBot.style.height=a*t+"px",h.appendChild(this._ePadBot),e.textContent="",e.appendChild(h);var d=(s+l+a)*t-e.scrollHeight;this._ePadBot.style.height=this._ePadBot.offsetHeight-d+"px";var p=this._getSelectedElement(!0);return c&&(p||e).focus({preventScroll:!0}),e.tabIndex=p?-1:this._orgTabIndex,!0},t.prototype._getSelectedElement=function(e){var t=this.selectedIndex,i=this._getElementIndex(t),n=i>-1?this._children[i]:null;return e&&n&&!n.offsetHeight&&(n=null),n},t.prototype._handleResize=function(){this._updateViewRange()},t.prototype._createItem=function(e){var t=this._cv.items[e],i=e==this._cv.currentPosition,o=this.getDisplayValue(e);1!=this._html&&(o=(0,n.escapeHtml)(o));var r=null;this.checkedMemberPath&&(r=!1,(0,n.isObject)(t)?r=!!this._pathChecked.getValue(t):this._checkedItems&&(r=this._checkedItems.indexOf(t)>-1),o='<label><input type="checkbox" tabindex="-1"'+(r?" checked":"")+"><span></span> "+o+"</label>");var s="wj-listbox-item";if(i&&(s+=" wj-state-selected"),r&&(s+=" wj-state-checked"),this._html){var l=["wj-separator","wj-state-disabled"];if(o.indexOf(l[0])>-1||o.indexOf(l[1])>-1){var a=(0,n.createElement)(o);l.forEach((function(e){(0,n.hasClass)(a,e)&&(s+=" "+e)}))}}return'<div class="'+s+'" role="'+this.itemRole+'" '+(this._getAriaSelected(i,r)?'aria-selected="true" ':"")+'tabindex="'+(i&&!this.isDisabled?this._orgTabIndex:-1)+'">'+o+"</div>"},t.prototype._getAriaSelected=function(e,t){return!!(null!=t?t:e)||null},t.prototype._createHeaderItem=function(e){return'<div class="wj-listbox-item wj-header wj-state-disabled" role="presentation" tabindex="-1">'+(0,n.escapeHtml)(e.name)+"</div>"},t.prototype._click=function(e){if(0==e.button&&!e.defaultPrevented){var t=this.indexOf(e.target);if(t>-1)if(this.selectedIndex=t,this.checkedMemberPath){var i=this._getCheckbox(t),o=(0,n.closest)(i,".wj-listbox-item");e.target!=i&&e.target!=o||(o.focus({preventScroll:!0}),this.setItemChecked(t,i.checked))}else(o=(0,n.closest)(e.target,".wj-listbox-item")).focus({preventScroll:!0})}},t.prototype._keydown=function(e){var t=this.selectedIndex;if(!e.defaultPrevented){if(65==e.keyCode&&(e.ctrlKey||e.metaKey)){var i=this.collectionView;if(this.checkedMemberPath&&(0,n.hasItems)(i))return this.checkedItems=this.checkedItems.length!=i.items.length?i.items:[],void e.preventDefault()}if(!(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey))switch(e.keyCode){case n.Key.Down:e.preventDefault(),this._selectNext();break;case n.Key.Up:e.preventDefault(),this._selectPrev();break;case n.Key.Home:e.preventDefault(),this._selectFirst();break;case n.Key.End:e.preventDefault(),this._selectLast();break;case n.Key.PageDown:e.preventDefault(),this._selectNextPage();break;case n.Key.PageUp:e.preventDefault(),this._selectPrevPage();break;case n.Key.Space:if(this.checkedMemberPath&&t>-1){var o=this._getCheckbox(t);o&&this.isItemEnabled(t)&&(this.setItemChecked(t,!o.checked),e.preventDefault())}}}},t.prototype._keypress=function(e){var t=this;if(!e.defaultPrevented&&!(e.target instanceof HTMLInputElement)&&(e.charCode>32||32==e.charCode&&this._search)){e.preventDefault(),this._search+=String.fromCharCode(e.charCode),this._toSearch&&clearTimeout(this._toSearch),this._toSearch=setTimeout((function(){t._toSearch=null,t._search=""}),n.Control._SEARCH_DELAY);var i=this._findNext();i<0&&this._search.length>1&&(this._search=this._search[this._search.length-1],i=this._findNext()),i>-1&&(this.selectedIndex=i)}},t.prototype._selectNext=function(){for(var e=this.selectedIndex+1;e<this._children.length;e++)if(this.isItemEnabled(e))return this.selectedIndex=e,!0;return!1},t.prototype._selectPrev=function(){for(var e=this.selectedIndex-1;e>=0;e--)if(this.isItemEnabled(e))return this.selectedIndex=e,!0;return!1},t.prototype._selectFirst=function(){for(var e=0;e<this._children.length;e++)if(this.isItemEnabled(e))return this.selectedIndex=e,!0;return!1},t.prototype._selectLast=function(){for(var e=this._children.length-1;e>=0;e--)if(this.isItemEnabled(e))return this.selectedIndex=e,!0;return!1},t.prototype._selectNextPage=function(){var e=this.hostElement.offsetHeight,t=this._children,i=this._cv?this._cv.items.length:0,n=0;if(e>0)for(var o=this.selectedIndex+1;o<i;o++){var r=t[o].scrollHeight||this._itemHeight;if(n+r>e&&this.isItemEnabled(o))return this.selectedIndex=o,!0;n+=r}return this._selectLast()},t.prototype._selectPrevPage=function(){var e=this.hostElement.offsetHeight,t=this._children,i=0;if(e>0)for(var n=this.selectedIndex-1;n>0;n--){var o=t[n].scrollHeight||this._itemHeight;if(i+o>e&&this.isItemEnabled(n))return this.selectedIndex=n,!0;i+=o}return this._selectFirst()},t.prototype._findNext=function(){if(this.hostElement){var e=this._children.length,t=this.selectedIndex;(t<0||1==this._search.length)&&t++;var i=this._search,n=this.caseSensitiveSearch;n||(i=i.toLowerCase());for(var o=0;o<e;o++){var r=(t+o)%e;if(this.isItemEnabled(r)){var s=this.getDisplayText(r).trim();if(n||(s=s.toLowerCase()),0==s.indexOf(i))return r}}}return-1},t.prototype._getCheckbox=function(e){var t=this._children;return e=this._getElementIndex(e),this.hostElement&&e>-1&&e<t.length?t[e].querySelector("input[type=checkbox]"):null},t.prototype._initFromSelect=function(e){for(var t=e.children,i=[],n=-1,o=0;o<t.length;o++){var r=t[o];"OPTION"==r.tagName&&(r.hasAttribute("selected")&&(n=i.length),r.innerHTML?i.push({hdr:r.innerHTML,val:r.getAttribute("value"),cmdParam:r.getAttribute("cmd-param")}):i.push({hdr:'<div class="wj-separator"></div>'}),e.removeChild(r),o--)}i&&(this.displayMemberPath="hdr",this.selectedValuePath="val",this.itemsSource=i,this.selectedIndex=n)},t.prototype._setIsDisabled=function(t){e.prototype._setIsDisabled.call(this,t),this._updateTabIndex()},t.prototype._setTabOrder=function(t){e.prototype._setTabOrder.call(this,t),this.isDisabled||this._updateTabIndex()},t.prototype._updateTabIndex=function(){var e=this.hostElement,t=this._getSelectedElement(!0);t?(t.tabIndex=this.isDisabled?-1:this._orgTabIndex,e.tabIndex=-1):e.tabIndex=this.isDisabled?-1:this._orgTabIndex},t._DIDX_KEY="$WJ-DIDX",t._VTHRESH=Number.MAX_VALUE/2,t}(n.Control),u=function(e){function t(t,i,o){var r=e.call(this)||this;return r._index=(0,n.asNumber)(t),r._data=i,r._item=(0,n.asType)(o,HTMLElement,!0),r}return r(t,e),Object.defineProperty(t.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"item",{get:function(){return this._item},enumerable:!0,configurable:!0}),t}(n.EventArgs);(0,n._addCultureInfo)("MultiSelectListBox",{filterPlaceholder:"Filter",selectAll:"Select All"});var d,p,f,_=function(e){function t(i,o){var r=e.call(this,i)||this;r._selectAllLabel=null,r._filterPlaceholder=null,r._filterText="",r._checkOnFilter=!0,r._delay=n.Control._SEARCH_DELAY,r.checkedItemsChanged=new n.Event,r.selectedIndexChanged=new n.Event;var s=r.getTemplate();r.applyTemplate("wj-control wj-content wj-multiselectlistbox",s,{_selectAll:"select-all",_filter:"filter",_lbHost:"list-box"}),r._selectAll.style.display="none",r._filter.style.display="none",r._lbx=new c(r._lbHost,{checkedMemberPath:t._DEF_CHECKED_PATH,loadedItems:function(){return r._updateCheckAllCheckbox()},checkedItemsChanged:function(){return r.onCheckedItemsChanged()},selectedIndexChanged:function(){return r.onSelectedIndexChanged()}}),r._cbSelectAll=r._selectAll.querySelector("input[type=checkbox]"),r._spSelectAll=r._selectAll.querySelector("label>span");var l=n.culture.MultiSelectListBox;return(0,n.setText)(r._spSelectAll,l.selectAll),r._filter.placeholder=l.filterPlaceholder,r.initialize(o),r.addEventListener(r._filter,"input",(function(){r._filter.value!=r._filterText&&(r._filterText=r._filter.value,r._toSearch&&clearTimeout(r._toSearch),r._toSearch=setTimeout((function(){r._toSearch=null,r._applyFilter()}),r.delay))})),r.addEventListener(r._cbSelectAll,"click",(function(e){var t=r._lbx.collectionView;(0,n.hasItems)(t)&&(r.checkedItems=e.target.checked?t.items:[])})),r.addEventListener(r.hostElement,"keydown",(function(e){var t=r.showFilterInput?r._filter:null,i=r._lbx;if(t&&e.keyCode==n.Key.F3&&((0,n.setSelectionRange)(t,0,t.value.length),e.preventDefault()),(0,n.getActiveElement)()==t){var o=!e.altKey;switch(e.keyCode){case n.Key.Escape:case n.Key.F4:o=!1}o&&e.stopPropagation()}if(!i.containsFocus())switch(e.keyCode){case n.Key.Up:case n.Key.Down:r._lbx.focus();var s=i.selectedIndex+(e.keyCode==n.Key.Up?-1:1);i.selectedIndex=Math.max(0,s),e.preventDefault()}}),!0),r.hostElement.tabIndex=-1,r._lbx.tabOrder=r._orgTabIndex,r}return r(t,e),Object.defineProperty(t.prototype,"itemsSource",{get:function(){return this._lbx.itemsSource},set:function(e){this._lbx.itemsSource=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collectionView",{get:function(){return this._lbx.collectionView},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"virtualizationThreshold",{get:function(){return this._lbx.virtualizationThreshold},set:function(e){this._lbx.virtualizationThreshold=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayMemberPath",{get:function(){return this._lbx.displayMemberPath},set:function(e){this._lbx.displayMemberPath=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isContentHtml",{get:function(){return this._lbx.isContentHtml},set:function(e){this._lbx.isContentHtml=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"caseSensitiveSearch",{get:function(){return this._lbx.caseSensitiveSearch},set:function(e){this._lbx.caseSensitiveSearch=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"delay",{get:function(){return this._delay},set:function(e){this._delay=(0,n.asNumber)(e,!1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showGroups",{get:function(){return this._lbx.showGroups},set:function(e){this._lbx.showGroups=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checkOnFilter",{get:function(){return this._checkOnFilter},set:function(e){e!=this.checkOnFilter&&(this._checkOnFilter=(0,n.asBoolean)(e),this.checkedItems=[])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return this._lbx.selectedIndex},set:function(e){this._lbx.selectedIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"listBox",{get:function(){return this._lbx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showFilterInput",{get:function(){return""==this._filter.style.display},set:function(e){e!=this.showFilterInput&&(this._filter.style.display=(0,n.asBoolean)(e)?"":"none",this.showFilterInput||(this._filter.value="",this._applyFilter()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filterInputPlaceholder",{get:function(){return this._filterPlaceholder},set:function(e){e!=this._filterPlaceholder&&(this._filterPlaceholder=(0,n.asString)(e),this.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showSelectAllCheckbox",{get:function(){return""==this._selectAll.style.display},set:function(e){this._selectAll.style.display=(0,n.asBoolean)(e)?"":"none"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectAllLabel",{get:function(){return this._selectAllLabel},set:function(e){e!=this._selectAllLabel&&(this._selectAllLabel=(0,n.asString)(e),this.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checkedMemberPath",{get:function(){var e=this.listBox.checkedMemberPath;return e!=t._DEF_CHECKED_PATH?e:null},set:function(e){e=(0,n.asString)(e),this.listBox.checkedMemberPath=e||t._DEF_CHECKED_PATH},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checkedItems",{get:function(){return this.listBox.checkedItems},set:function(e){this.listBox.checkedItems=(0,n.asArray)(e)},enumerable:!0,configurable:!0}),t.prototype.onCheckedItemsChanged=function(e){this._updateCheckAllCheckbox(),this.checkedItemsChanged.raise(this,e)},t.prototype.onSelectedIndexChanged=function(e){this.selectedIndexChanged.raise(this,e)},t.prototype.refresh=function(t){if(void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this.hostElement){var i=n.culture.MultiSelectListBox;this._filter.placeholder=null!=this._filterPlaceholder?this._filterPlaceholder:i.filterPlaceholder,this._spSelectAll&&(0,n.setText)(this._spSelectAll,null!=this._selectAllLabel?this._selectAllLabel:i.selectAll),this._updateCheckAllCheckbox()}},t.prototype.dispose=function(){this.listBox.dispose(),e.prototype.dispose.call(this)},t.prototype._applyFilter=function(){var e=this,t=this._lbx,i=t.collectionView,o=this._filter.value,r=o?new RegExp((0,n.escapeRegExp)(o),t.caseSensitiveSearch?"":"i"):null,s=this.displayMemberPath,l=s?new n.Binding(s):null,a=this.checkOnFilter?null:this.checkedItems;i.filter=function(t){return null==r||(!!(a&&a.indexOf(t)>-1)||(l&&(t=l.getValue(t)),e.isContentHtml&&(t=(0,n.toPlainText)(t)),null!=t&&r.test(t.toString())))},t.selectedIndex=Math.max(0,t.selectedIndex),this._checkOnFilter&&(this.checkedItems=r?i.items:[])},t.prototype._updateCheckAllCheckbox=function(){var e=this._lbx.collectionView,t=this._cbSelectAll;if((0,n.hasItems)(e)){var i=e.items.length,o=this.checkedItems.length;(0,n.setChecked)(t,o==i||0!=o&&null),t.disabled=!1}else(0,n.setChecked)(t,!1),t.checked=!1,t.disabled=!0},t.prototype._setIsDisabled=function(t){e.prototype._setIsDisabled.call(this,t),this.hostElement.tabIndex=-1,this.isDisabled?this._lbx.tabOrder=-1:this._lbx.tabOrder=this._orgTabIndex},t.prototype._setTabOrder=function(e){this._orgTabIndex=e,this._lbx.tabOrder=e},t._DEF_CHECKED_PATH="$checked",t.controlTemplate='<div class="wj-template wj-listbox"><input wj-part="filter" class="wj-form-control" tabindex="-1"><div wj-part="select-all" class="wj-header wj-select-all wj-listbox-item"><label><input type="checkbox" tabindex="-1"> <span></span></label></div><div wj-part="list-box"/></div>',t}(n.Control);(0,n._addCultureInfo)("Calendar",{ariaLabels:{calendar:"Calendar",monthView:"Month View",yearView:"Year View",prvMo:"Previous Month",today:"Today",nxtMo:"Next Month",prvYr:"Previous Year",currMo:"Current Month",nxtYr:"Next Year"}}),(p=d||(d={}))[p.None=0]="None",p[p.Day=1]="Day",p[p.Month=2]="Month",p[p.Range=3]="Range",function(e){e[e.None=0]="None",e[e.FirstMonth=1]="FirstMonth",e[e.LastMonth=2]="LastMonth",e[e.FirstAndLastMonths=3]="FirstAndLastMonths",e[e.AllMonths=4]="AllMonths",e[e.Outside=5]="Outside"}(f||(f={}));var g,m=function(e){function t(t,i){var o=e.call(this,t)||this;o._yrPicker=!0,o._mtPicker=f.FirstMonth,o._wksBefore=0,o._wksAfter=0,o._rngMin=0,o._rngMax=0,o._min=null,o._max=null,o._readOnly=!1,o._handleWheel=!0,o._fdw=null,o._selMode=d.Day,o._tmYrHidden=0,o._fmtYrMo="y",o._fmtYr="yyyy",o._fmtDayHdr="ddd",o._fmtDay="d ",o._fmtMonths="MMM",o.valueChanged=new n.Event,o.rangeEndChanged=new n.Event,o.rangeChanged=new n.Event,o.displayMonthChanged=new n.Event,o.formatItem=new n.Event((function(){o.invalidate()})),o._value=o._rngEnd=n.DateTime.newDate(),o._month=o._getMonth(o._value),o._cals=[o],o._createChildren(),o._createYearPicker();var r=o.hostElement,s=o.addEventListener.bind(o);return s(r,"keydown",o._keydown.bind(o)),s(r,"click",o._click.bind(o)),o._rptUp=new n._ClickRepeater(o._btnPrv),o._rptDn=new n._ClickRepeater(o._btnNxt),o.addEventListener(r,"wheel",(function(e){o.handleWheel&&!e.defaultPrevented&&!o.isReadOnly&&o.containsFocus()&&(e.deltaY<0?o._btnPrv.click():o._btnNxt.click(),e.preventDefault())})),o.initialize(i),o.refresh(!0),o}return r(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){if(e!==this._value&&(this._clearingRangeEnd=!n.DateTime.equals(this._value,e),this.rangeEnd=null,this._clearingRangeEnd=!1,e=(0,n.asDate)(e,!0),e=this._clamp(e),(this._valid(e)||null==e)&&(this.ensureVisible(e||new Date),n.DateTime.equals(this._value,e)||(this._value=e,this.invalidate(!1),this.onValueChanged())),!this.value)){var t=this.min,i=this.max,o=this.displayMonth;i&&i<o?this.ensureVisible(i):t&&t>o&&this.ensureVisible(t)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rangeEnd",{get:function(){return this._rngEnd},set:function(e){if(e=(0,n.asDate)(e,!0),(e=this._clamp(e))&&this._value&&this._rngMode()){e<this._value&&(e=this._value);var t=this._rngMin,i=this._rngMax;if(t&&t>0||i&&i>0){var o=this._value,r=Math.ceil((e.getTime()-o.getTime())/864e5)+1;t&&t>0&&r<t&&(e=n.DateTime.addDays(o,t-1)),i&&i>0&&r>i&&(e=n.DateTime.addDays(o,i-1))}}!this._valid(e)&&null!=e||n.DateTime.equals(this._rngEnd,e)||(this._rngEnd=e,this.ensureVisible(e),this.invalidate(!1),this.onRangeEndChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rangeMin",{get:function(){return this._rngMin},set:function(e){(e=(0,n.asNumber)(e,!0,!0))!=this._rngMin&&(this._rngMin=e,this._syncProp(this,"rangeMin"),this._rngMode()&&this._rngEnd&&(this.rangeEnd=this._rngEnd))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rangeMax",{get:function(){return this._rngMax},set:function(e){(e=(0,n.asNumber)(e,!0,!0))!=this._rngMax&&(this._rngMax=e,this._syncProp(this,"rangeMax"),this._rngMode()&&this._rngEnd&&(this.rangeEnd=this._rngEnd))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return this._min},set:function(e){(e=(0,n.asDate)(e,!0))!=this.min&&(this._min=e,this._syncProp(this,"min"),this.refresh(),!this.value&&e&&e>this.displayMonth&&this.ensureVisible(e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},set:function(e){(e=(0,n.asDate)(e,!0))!=this.max&&(this._max=e,this._syncProp(this,"max"),this.refresh(),!this.value&&e&&e<this.displayMonth&&this.ensureVisible(e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectionMode",{get:function(){return this._selMode},set:function(e){var t=d;(e=(0,n.asEnum)(e,t))!=this._selMode&&(this._selMode=e,this._mthMode()&&(this.monthView=!1),this._rngEnd=e==t.Range?this._value:null,this.refresh(),this._syncProp(this,"selectionMode"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(e){this._readOnly=(0,n.asBoolean)(e),(0,n.toggleClass)(this.hostElement,"wj-state-readonly",this.isReadOnly),this._syncProp(this,"isReadOnly")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"handleWheel",{get:function(){return this._handleWheel},set:function(e){this._handleWheel=(0,n.asBoolean)(e),this._syncProp(this,"handleWheel")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"repeatButtons",{get:function(){return!this._rptUp.disabled},set:function(e){this._rptUp.disabled=this._rptDn.disabled=!(0,n.asBoolean)(e),this._syncProp(this,"repeatButtons")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showYearPicker",{get:function(){return this._yrPicker},set:function(e){e!=this._yrPicker&&(this._yrPicker=(0,n.asBoolean)(e),this._syncProp(this,"showYearPicker"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showMonthPicker",{get:function(){return this._mtPicker},set:function(e){if(e!=this._mtPicker){var t=f;(0,n.isBoolean)(e)&&(e=e?t.FirstMonth:t.None),this._mtPicker=(0,n.asEnum)(e,t),(0,n.toggleClass)(this.hostElement,"wj-btns-outside",this._getShowMonthPicker()==t.Outside),this.refresh(),this._syncProp(this,"showMonthPicker")}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstDayOfWeek",{get:function(){return this._fdw},set:function(e){if(e!=this._fdw){if((e=(0,n.asNumber)(e,!0))&&(e>6||e<0))throw"firstDayOfWeek must be between 0 and 6 (Sunday to Saturday).";this._fdw=e,this.refresh(),this._syncProp(this,"firstDayOfWeek")}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayMonth",{get:function(){return this._month},set:function(e){e=(0,n.asDate)(e),e=this._getMonth(e);var t=this._getDisplayMonthRange();t.to&&e>t.to&&(e=t.to),t.from&&e<t.from&&(e=t.from),n.DateTime.equals(this.displayMonth,e)||(this._month=e,this.invalidate(!0),this.onDisplayMonthChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"monthCount",{get:function(){var e=this.hostElement;return e?e.querySelectorAll(".wj-calendar").length+1:0},set:function(e){var i=this,o=this.hostElement;if(e!=this.monthCount&&o){var r=o.querySelectorAll(".wj-calendar");e=(0,n.asInt)(e,!1),(0,n.assert)(e>0,"monthCount must be >= 1."),(0,n.assert)(1==e||!(0,n.closest)(o.parentElement,".wj-calendar"),"Only top-level calendars can set monthCount.");for(var s=0;s<r.length;s++){var l=r[s];(0,n.removeChild)(l),this._getCalendar(l).dispose()}for(this._cals=[this],s=1;s<e;s++){for(var a in(l=new t(document.createElement("div"),{itemFormatter:this.itemFormatter,itemValidator:this.itemValidator,formatItem:function(e,t){return i.onFormatItem(t)}}))._selMode=this._selMode,l._value=this._value,l._rngEnd=this._rngEnd,this)if(!/^(_.*|constructor|displayMonth|monthCount|hostElement|rightToLeft|isUpdating|isTouching)$/.test(a)){var h=this[a];(0,n.isFunction)(h)||h instanceof n.Event||(l[a]=h)}this._cals.push(l),o.appendChild(l.hostElement)}(0,n.toggleClass)(o,"wj-calendar-multimonth",e>1),this._syncProp(this,"displayMonth")}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formatYearMonth",{get:function(){return this._fmtYrMo},set:function(e){e!=this._fmtYrMo&&(this._fmtYrMo=(0,n.asString)(e),this._syncProp(this,"formatYearMonth"),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formatDayHeaders",{get:function(){return this._fmtDayHdr},set:function(e){e!=this._fmtDayHdr&&(this._fmtDayHdr=(0,n.asString)(e),this._syncProp(this,"formatDayHeaders"),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formatDays",{get:function(){return this._fmtDay},set:function(e){e!=this._fmtDay&&(this._fmtDay=(0,n.asString)(e),this._syncProp(this,"formatDays"),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formatYear",{get:function(){return this._fmtYr},set:function(e){e!=this._fmtYr&&(this._fmtYr=(0,n.asString)(e),this._syncProp(this,"formatYear"),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formatMonths",{get:function(){return this._fmtMonths},set:function(e){e!=this._fmtMonths&&(this._fmtMonths=(0,n.asString)(e),this._syncProp(this,"formatMonths"),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showHeader",{get:function(){return"none"!=this._tbHdr.style.display},set:function(e){e!=this.showHeader&&(this._tbHdr.style.display=(0,n.asBoolean)(e)?"":"none",this._syncProp(this,"showHeader"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"monthView",{get:function(){return"none"!=this._tbMth.style.display},set:function(e){if(e!=this.monthView){this._tbMth.style.display=e?"":"none",this._tbYr.style.display=e?"none":"",this.refresh();var t=n.culture.Calendar.ariaLabels;(0,n.setAriaLabel)(this._btnPrv,e?t.prvMo:t.prvYr),(0,n.setAriaLabel)(this._btnTdy,e?t.today:t.currMo),(0,n.setAriaLabel)(this._btnNxt,e?t.nxtMo:t.nxtYr),(0,n.setAriaLabel)(this._btnMth,e?t.monthView:t.yearView),this._syncProp(this,"monthView")}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weeksBefore",{get:function(){return this._wksBefore},set:function(e){e!=this._wksBefore&&(this._wksBefore=Math.floor((0,n.asNumber)(e,!1,!0)),this._syncProp(this,"weeksBefore"),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weeksAfter",{get:function(){return this._wksAfter},set:function(e){e!=this._wksAfter&&(this._wksAfter=Math.floor((0,n.asNumber)(e,!1,!0)),this._syncProp(this,"weeksAfter"),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemFormatter",{get:function(){return this._itemFormatter},set:function(e){e!=this._itemFormatter&&(this._itemFormatter=(0,n.asFunction)(e),this._syncProp(this,"itemFormatter"),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemValidator",{get:function(){return this._itemValidator},set:function(e){e!=this._itemValidator&&(this._itemValidator=(0,n.asFunction)(e),this._syncProp(this,"itemValidator"),this.invalidate())},enumerable:!0,configurable:!0}),t.prototype.hitTest=function(e){var i=e instanceof MouseEvent?e.target:e instanceof Element?e:null;return(0,n.assert)(null!=i,"MouseEvent or Element expected"),i?i[t._DATE_KEY]:null},t.prototype.ensureVisible=function(e){if(null!=e){var t=this._getCalendars(),i=t.indexOf(this),o=t[0],r=t[t.length-1];e<o.displayMonth?this.displayMonth=n.DateTime.addMonths(this._getMonth(e),i):e>r.displayMonth&&(this.displayMonth=n.DateTime.addMonths(this._getMonth(e),i-t.length+1))}},t.prototype.onValueChanged=function(e){this.valueChanged.raise(this,e),this._syncProp(this,"value")},t.prototype.onRangeEndChanged=function(e){this.rangeEndChanged.raise(this,e),this._syncProp(this,"rangeEnd"),this._value&&this._rngEnd&&this.onRangeChanged(e)},t.prototype.onRangeChanged=function(e){this.rangeChanged.raise(this,e)},t.prototype.onDisplayMonthChanged=function(e){this.displayMonthChanged.raise(this,e),this._syncProp(this,"displayMonth")},t.prototype.onFormatItem=function(e){this.formatItem.raise(this,e)},t.prototype._containsFocusImpl=function(t){return e.prototype._containsFocusImpl.call(this,t)||this._lbYears._containsFocusImpl(t)},t.prototype.dispose=function(){this._rptUp.element=null,this._rptDn.element=null,this._lbYears.dispose(),e.prototype.dispose.call(this)},t.prototype.refresh=function(t){void 0===t&&(t=!0);var i=this.hostElement,o=this.containsFocus();if(i){e.prototype.refresh.call(this,t),t&&this._updateContent(),this._updateSelection();var r=this._getDisplayMonthRange(),s=this.displayMonth;if((0,n.enable)(this._btnPrv,null==r.from||s>r.from),(0,n.enable)(this._btnNxt,null==r.to||s<r.to),o){var l=(this.monthView?this._tbMth:this._tbYr).querySelector("td.wj-state-selected")||i;l&&l.focus()}var a=this._getCalendars();a.length>1&&this==a[0]&&a.forEach((function(e,i){i>0&&e.refresh(t)}))}},t.prototype._getShowMonthPicker=function(){var e=f,t=this._getCalendars(),i=t.indexOf(this),n=this.showMonthPicker;switch(n){case e.FirstMonth:case e.Outside:return 0==i?n:0;case e.LastMonth:return i==t.length-1?n:0;case e.FirstAndLastMonths:return 0==i||i==t.length-1?n:0;case e.AllMonths:return n}return 0},t.prototype._getDisplayMonthRange=function(){var e={from:null,to:null};if(this.min||this.max){var t=this._getCalendars(),i=t.indexOf(this),o=this._mthMode()?n.DateTime.addYears:n.DateTime.addMonths;this.min&&(e.from=o(this._getMonth(this.min),i)),this.max&&(e.to=o(this._getMonth(this.max),i-t.length+1))}return e},t.prototype._getCalendar=function(e){return n.Control.getControl(e)},t.prototype._getCalendars=function(){var e=(0,n.closest)(this.hostElement,".wj-calendar-multimonth");return(e?this._getCalendar(e):this)._cals},t.prototype._syncProp=function(e,t){var i=this;if(!this._syncing){var o=this._getCalendars();if(o&&o.length>1){var r=e[t],s=this._mthMode()?n.DateTime.addYears:n.DateTime.addMonths;"displayMonth"==t&&(r=s(r,-o.indexOf(e))),o[0].deferUpdate((function(){i._syncing=!0,o.forEach((function(n,o){if(n!=e){var l=n.displayMonth;n[t]="displayMonth"==t?s(r,o):r,"value"==t&&(n.displayMonth=l,i._rngMode()&&(n.rangeEnd=null))}})),i._syncing=!1}))}}},t.prototype._updateContent=function(){var e=this.displayMonth,i=n.Globalize.format,o=n.DateTime,r=this._getShowMonthPicker();(0,n.setText)(this._spMth,i(e,this._fmtYrMo));var s=this._btnMth.querySelector(".wj-glyph-down");s&&(s.style.display=this._mthMode()||!r?"none":"");var l=(0,n.closest)(this._btnTdy,".wj-btn-group");l&&(l.style.display=r?"":"none");for(var a=null!=this._fdw?this._fdw:n.Globalize.getFirstDayOfWeek(),h=o.addDays(e,-(e.getDay()-a+7)%7),c=o.monthLast(e),u=this._tbMth.querySelectorAll("td"),d=0;d<7&&d<u.length;d++){var p=o.addDays(h,d);(0,n.setText)(u[d],i(p,this._fmtDayHdr))}var f=this._tbMth.querySelectorAll("tr");for(d=1;d<f.length;d++)(0,n.removeChild)(f[d]);var _=o.addDays(h,-7*this._wksBefore);for(d=0;d<this._wksBefore;d++)_=this._addWeek(_,"wj-week-before");for(;_<=c;)_=this._addWeek(_);for(d=0;d<this._wksAfter;d++)_=this._addWeek(_,"wj-week-after");for((u=this._tbYr.querySelectorAll("td")).length&&(0,n.setText)(u[0],i(e,this._fmtYr)),d=1;d<u.length;d++){_=o.newDate(e.getFullYear(),d-1,1);var g=u[d],m=!this._monthInValidRange(_);g[t._DATE_KEY]=_,(0,n.setText)(g,i(_,this._fmtMonths)),(0,n.toggleClass)(g,"wj-state-disabled",m),(0,n.setAriaLabel)(g,n.Globalize.format(_,"MMMM yyyy"))}},t.prototype._updateSelection=function(){for(var e=t._DATE_KEY,i=n.DateTime,o=this._tbMth.querySelectorAll("td"),r=7;r<o.length;r++){var s=(d=o[r])[e],l=this.value,a=this.rangeEnd,h=this._selMode&&null!=l&&i.sameDate(s,l),c=this._selMode&&null!=l&&i.sameDate(s,a),u=this._selMode&&null!=l&&s>l&&null!=a&&s<=a;(0,n.toggleClass)(d,"wj-state-selected",h),(0,n.toggleClass)(d,"wj-state-multi-selected",u),(0,n.toggleClass)(d,"wj-state-last-selected",c),(0,n.setAttribute)(d,"aria-selected",!!h||null),this._customizeCell(r,s,d)}for(o=this._tbYr.querySelectorAll("td"),r=0;r<o.length;r++){var d;s=(d=o[r])[e],h=this._sameMonth(s,this.value),(0,n.toggleClass)(d,"wj-state-selected",h),(0,n.setAttribute)(d,"aria-selected",!!h||null)}},t.prototype._addWeek=function(e,i){for(var o=this._createElement("tr",this._tbMth,i),r=n.DateTime,s=0;s<7;s++){var l=this._createElement("td",o),a=r.addDays(e,s);l[t._DATE_KEY]=a,(0,n.setText)(l,n.Globalize.format(a,this._fmtDay)),(0,n.setAriaLabel)(l,n.Globalize.format(a,"D"));var h=!this._valid(a),c=a.getDay(),u=a.getMonth()!=this.displayMonth.getMonth();(0,n.toggleClass)(l,"wj-day-today",r.sameDate(a,r.newDate())),(0,n.toggleClass)(l,"wj-day-weekend",0==c||6==c),(0,n.toggleClass)(l,"wj-day-othermonth",u||!this._inValidRange(a)||h),(0,n.toggleClass)(l,"wj-state-invalid",h)}return r.addDays(e,7)},t.prototype._customizeCell=function(e,t,i){if((0,n.isFunction)(this.itemFormatter)&&this.itemFormatter(t,i),this.formatItem.hasHandlers){var o=new u(e,t,i);this.onFormatItem(o)}},t.prototype._canChangeValue=function(){return!this._readOnly&&this._selMode!=d.None},t.prototype._valid=function(e){return!(!(0,n.isDate)(e)||!n.DateTime.sameDate(e,this._clamp(e)))&&(!(0,n.isFunction)(this.itemValidator)||this.itemValidator(e))},t.prototype._inValidRange=function(e){var t=n.DateTime.fromDateTime;return!(this.min&&e<t(this.min,e))&&!(this.max&&e>t(this.max,e))},t.prototype._monthInValidRange=function(e){if(this.min||this.max){var t=e.getFullYear(),i=e.getMonth(),o=n.DateTime,r=o.newDate(t,i,1),s=o.newDate(t,i+1,0);if(this.min&&this.min>s)return!1;if(this.max&&this.max<r)return!1}return!0},t.prototype._sameMonth=function(e,t){return(0,n.isDate)(e)&&(0,n.isDate)(t)&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()},t.prototype._getValidDate=function(e,t){if((0,n.isDate)(e))for(var i=e.getFullYear(),o=e.getMonth()+(t?0:1),r=t?1:0,s=n.DateTime,l=s.newDate(i,o,r),a=t?1:-1,h=0;h<31;h++){if(this._valid(l))return l;l=s.addDays(l,a)}return null},t.prototype._clamp=function(e){if(e){var t=n.DateTime.fromDateTime;if(this.min){var i=t(this.min,e);e<i&&(e=i)}if(this.max){var o=t(this.max,e);e>o&&(e=o)}}return e},t.prototype._createChildren=function(){var e=this.getTemplate();this.applyTemplate("wj-control wj-calendar",e,{_tbHdr:"tbl-header",_btnMth:"btn-month",_spMth:"span-month",_btnPrv:"btn-prev",_btnTdy:"btn-today",_btnNxt:"btn-next",_tbMth:"tbl-month",_tbYr:"tbl-year"}),this._tbYr.style.display="none";var t=n.culture.Calendar.ariaLabels;(0,n.setAriaLabel)(this._tbMth,t.calendar),(0,n.setAriaLabel)(this._tbYr,t.calendar),(0,n.setAriaLabel)(this._btnPrv,t.calendar),(0,n.setAriaLabel)(this._btnMth,t.monthView),(0,n.setAriaLabel)(this._btnPrv,t.prvMo),(0,n.setAriaLabel)(this._btnTdy,t.today),(0,n.setAriaLabel)(this._btnNxt,t.nxtMo);for(var i=this._createElement("tr",this._tbMth,"wj-header"),o=0;o<7;o++)this._createElement("td",i);i=this._createElement("tr",this._tbYr,"wj-header"),this._createElement("td",i).setAttribute("colspan","4");for(var r=0;r<3;r++){i=this._createElement("tr",this._tbYr);for(var s=0;s<4;s++)this._createElement("td",i)}},t.prototype._createYearPicker=function(){var e=this,t=this.hostElement,i=this._createElement("div",null,"wj-dropdown-panel wj-yearpicker");i.tabIndex=this._orgTabIndex,this._lbYears=new c(i,{lostFocus:function(t){if((0,n.hidePopup)(i),e._tmYrHidden=Date.now(),e.removeEventListener(window,"touchstart"),t.selectedIndex>-1){var o=n.DateTime.clone(e.displayMonth);o.setFullYear(t.selectedIndex+t.itemsSource[0]),e.displayMonth=o}}}),this.addEventListener(i,"keydown",(function(i){switch(i.keyCode){case n.Key.Enter:t.focus();break;case n.Key.Escape:e._lbYears.selectedIndex=-1,t.focus()}i.defaultPrevented&&i.stopPropagation()})),this.addEventListener(i,"click",(function(e){t.focus()}))},t.prototype._createElement=function(e,t,i){var o=document.createElement(e);return i&&(0,n.addClass)(o,i),t&&t.appendChild(o),o},t.prototype._click=function(e){var t=this;if(!e.defaultPrevented&&0==e.button){var i=!1,o=e.target;if((0,n.contains)(this._btnMth,o)&&!this._mthMode()&&this._getShowMonthPicker()?(this.monthView=!this.monthView,i=!0):(0,n.contains)(this._btnPrv,o)?(this._navigate(-1),i=!0):(0,n.contains)(this._btnNxt,o)?(this._navigate(1),i=!0):(0,n.contains)(this._btnTdy,o)&&(this._navigate(0),i=!0),o&&!i&&this._yrPicker&&(0,n.contains)(this._tbYr,o)&&(0,n.closest)(o,".wj-header")){if(Date.now()-this._tmYrHidden<600)return void e.preventDefault();for(var r=this.displayMonth.getFullYear(),s=this.min?this.min.getFullYear():r-100,l=this.max?this.max.getFullYear():r+100,a=[],h=s;h<=l;h++)a.push(h);var c=this._lbYears,u=c.hostElement,d=(0,n.closest)(o,".wj-header"),p=this.hostElement,f=(0,n.closest)(p,".wj-inputdate-dropdown")||p;return c.itemsSource=a,c.selectedIndex=r-a[0],(0,n.setAttribute)(u,"dir",this.rightToLeft?"rtl":null),(0,n.setCss)(u,{minWidth:"",width:d.offsetWidth}),(0,n.showPopup)(u,d,!1,!1,f),requestAnimationFrame((function(){c.showSelection(!0)})),this.addEventListener(window,"touchstart",(function(e){(0,n.contains)(u,e.target)||((0,n.hidePopup)(u),t._tmYrHidden=Date.now(),t.removeEventListener(window,"touchstart"))})),void e.preventDefault()}if(o&&!i){var _=(0,n.closest)(o,"td");if(_){var g=this.hitTest(_),m=n.DateTime.fromDateTime;if(this.monthView){if(g&&this._canChangeValue()){var v=m(g,this._value);this._inValidRange(v)&&this._valid(v)&&(this._rngMode()&&this.value&&!this.rangeEnd&&v>=this.value?this.rangeEnd=v:this.value=v),i=!0}}else g&&(this.displayMonth=g,this._mthMode()?this._canChangeValue()&&(v=m(this.displayMonth,this.value),this._inValidRange(v)&&(this.value=v)):this.monthView=!0,i=!0)}}i&&(e.preventDefault(),this.focus())}},t.prototype._keydown=function(e){if(!e.defaultPrevented){if(e.altKey)switch(e.keyCode){case n.Key.Up:case n.Key.Down:return;case n.Key.End:return this._navigate(0),void e.preventDefault()}if(!(e.ctrlKey||e.metaKey||e.shiftKey&&!this._rngMode())){var t=this._getKeyCode(e),i=0,o=0,r=!0;if(this.monthView)switch(t){case n.Key.Left:i=-1;break;case n.Key.Right:i=1;break;case n.Key.Up:i=-7;break;case n.Key.Down:i=7;break;case n.Key.PageDown:o=e.altKey?12:1;break;case n.Key.PageUp:o=e.altKey?-12:-1;break;case n.Key.Home:case n.Key.End:if(this._canChangeValue()&&!e.shiftKey){var s=this.value||this.displayMonth;(a=this._getValidDate(s,t==n.Key.Home))&&(this.value=n.DateTime.fromDateTime(a,this.value),this._rngEnd=null)}break;default:r=!1}else switch(t){case n.Key.Left:o=-1;break;case n.Key.Right:o=1;break;case n.Key.Up:o=-4;break;case n.Key.Down:o=4;break;case n.Key.PageDown:o=e.altKey?120:12;break;case n.Key.PageUp:o=e.altKey?-120:-12;break;case n.Key.Home:o=this.value?-this.value.getMonth():0;break;case n.Key.End:o=this.value?11-this.value.getMonth():0;break;case n.Key.Enter:this._mthMode()?r=!1:this.monthView=!0;break;default:r=!1}if(this._canChangeValue()&&(i||o)){var l=e.shiftKey&&null!=this.rangeEnd?this.rangeEnd:this.value,a=n.DateTime;if(l?(l=a.addDays(l,i),l=a.addMonths(l,o)):l=this._getValidDate(new Date,!0),o&&!this._valid(l)){s=l.getMonth();for(var h=1;h<31&&!this._valid(l);h++){var c=a.addDays(l,+h),u=a.addDays(l,-h);this._valid(c)&&c.getMonth()==s?l=c:this._valid(u)&&u.getMonth()==s&&(l=u)}}for(h=0;h<31&&!this._valid(l);h++)l=a.addDays(l,i>0||o>0?1:-1);e.shiftKey&&l>this.value?this.rangeEnd=l:this.value=l}r&&e.preventDefault()}}},t.prototype._getMonth=function(e){var t=n.DateTime;return e=e||t.newDate(),t.newDate(e.getFullYear(),e.getMonth(),1)},t.prototype._mthMode=function(){return this.selectionMode==d.Month},t.prototype._rngMode=function(){return this.selectionMode==d.Range},t.prototype._navigate=function(e){var t=this.monthView,i=this.displayMonth,o=n.DateTime;switch(e){case 0:var r=o.newDate();this._canChangeValue()&&(this.value=t?o.fromDateTime(r,this.value):this._getMonth(r)),i=this._getMonth(r);break;case 1:i=o.addMonths(i,t?1:12);break;case-1:i=o.addMonths(i,t?-1:-12)}this.displayMonth=i},t.prototype._setTabOrder=function(t){e.prototype._setTabOrder.call(this,t),this._lbYears.tabOrder=this._orgTabIndex},t._DATE_KEY="$WJ-DATE",t.controlTemplate='<div class="wj-content wj-calendar-outer"><div wj-part="tbl-header" class="wj-calendar-header"><div wj-part="btn-month" class="wj-month-select" role="button"><span wj-part="span-month"></span> <span class="wj-glyph-down"></span></div><div class="wj-btn-group"><button wj-part="btn-prev" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-left"></span></button><button wj-part="btn-today" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-circle"></span></button><button wj-part="btn-next" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-right"></span></button></div></div><table wj-part="tbl-month" class="wj-calendar-month" role="grid"></table><table wj-part="tbl-year" class="wj-calendar-year" role="grid"></table></div>',t}(n.Control);(0,n._addCultureInfo)("DropDown",{ariaLabels:{tgl:"Toggle Dropdown"}}),function(e){e[e.Select=0]="Select",e[e.Open=1]="Open",e[e.Toggle=2]="Toggle"}(g||(g={}));var v,b,y=function(e){function t(t,i){var o=e.call(this,t)||this;o._clickAction=g.Select,o._showBtn=!0,o._autoExpand=!0,o._animate=!1,o._oldText="",o.textChanged=new n.Event,o.isDroppedDownChanging=new n.Event,o.isDroppedDownChanged=new n.Event;var r=o.getTemplate();o.applyTemplate("wj-control wj-content wj-dropdown",r,{_tbx:"input",_btn:"btn",_dropDown:"dropdown"},"input"),o._dropDown.style.display="none";var s=n.culture.DropDown.ariaLabels;(0,n.setAriaLabel)(o._btn.querySelector("button"),s.tgl);var l=o._elRef=o._tbx;(0,n.disableAutoComplete)(l),o._createDropDown(),o._updateBtn();var a=o.hostElement;(0,n.addClass)(a,"wj-state-collapsed"),o.addEventListener(window,"resize",(function(){o.isDroppedDown&&o.invalidate()}));var h=o.dropDown,c=o.addEventListener.bind(o),u=o._updateFocusState.bind(o);c(h,"blur",u,!0),c(h,"focus",u);var d=o._keydown.bind(o);c(a,"keydown",d),c(h,"keydown",d);var p=o._keypress.bind(o);return c(a,"keypress",p,!0),c(h,"keypress",p,!0),c(l,"input",(function(){o._setText(o.text,!1)})),c(l,"blur",(function(){o._commitText(!0)}),!0),c(l,"click",(function(){o._autoExpand&&o._expandSelection()})),c(l,"mousedown",(function(e){switch(o._clickAction){case g.Open:o.isDroppedDown||(e.preventDefault(),o.focus(),o.isDroppedDown=!0);break;case g.Toggle:e.preventDefault(),o.focus(),o.isDroppedDown=!o.isDroppedDown}})),c(o._btn,"mousedown",(function(e){o._btnclick(e)})),(0,n.removeChild)(h),(0,n.isIE)()&&o._elRef==o._tbx&&c(a,"mouseup",(function(e){if(!e.defaultPrevented&&0==e.button&&(0,n.hasClass)(e.target,"wj-btn")){var t=(0,n.getActiveElement)();t&&t!=e.target&&setTimeout((function(){t.focus()}))}})),(0,n.isIE9)()&&c(l,"keyup",(function(){o._setText(o.text,!1)})),c(h,"click",o._dropDownClick.bind(o)),o}return r(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this._tbx.value},set:function(e){e!=this.text&&(this._setText(e,!0),this._commitText())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputType",{get:function(){return this._tbx.type},set:function(e){this._tbx.type=(0,n.asString)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this._tbx.readOnly},set:function(e){this._tbx.readOnly=(0,n.asBoolean)(e),(0,n.toggleClass)(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRequired",{get:function(){return this._tbx.required},set:function(e){this._tbx.required=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return this._tbx.placeholder},set:function(e){this._tbx.placeholder=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clickAction",{get:function(){return this._clickAction},set:function(e){this._clickAction=(0,n.asEnum)(e,g)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDroppedDown",{get:function(){var e=this._dropDown;return e&&"none"!=e.style.display},set:function(e){var t=this,i=this.hostElement,o=this._dropDown,r=this.containsFocus();i&&o&&(e=(0,n.asBoolean)(e)&&!this.isDisabled&&!this.isReadOnly&&i.offsetWidth>0)!=this.isDroppedDown&&this.onIsDroppedDownChanging(new n.CancelEventArgs)&&(e?(this._minWidthDropdown=o.style.minWidth,o.style.display="",this._updateDropDown(),this.addEventListener(window,"touchstart",(function(e){for(var o=e.target;o;){if(o==i)return;o=o[n.Control._OWNR_KEY]||o.parentNode}n.Control._touching=!0,t.isDroppedDown=!1,n.Control._touching=!1}))):(this.removeEventListener(window,"touchstart"),(0,n.hidePopup)(o),o.style.minWidth=this._minWidthDropdown),r&&(this.isTouching&&this.showDropDownButton?i.focus():this.selectAll()),this._updateFocusState(),(0,n.toggleClass)(i,"wj-state-collapsed",!this.isDroppedDown),this.onIsDroppedDownChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropDown",{get:function(){return this._dropDown},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropDownCssClass",{get:function(){return this._cssClass},set:function(e){e!=this._cssClass&&((0,n.removeClass)(this._dropDown,this._cssClass),this._cssClass=(0,n.asString)(e),(0,n.addClass)(this._dropDown,this._cssClass))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showDropDownButton",{get:function(){return this._showBtn},set:function(e){this._showBtn=(0,n.asBoolean)(e),this._updateBtn()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoExpandSelection",{get:function(){return this._autoExpand},set:function(e){this._autoExpand=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAnimated",{get:function(){return this._animate},set:function(e){this._animate=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),t.prototype.selectAll=function(){var e=this._tbx;this._elRef==e&&(0,n.setSelectionRange)(e,0,this.text.length),this.containsFocus()||this.focus()},t.prototype.onTextChanged=function(e){this.textChanged.raise(this,e),this._updateState()},t.prototype.onIsDroppedDownChanging=function(e){return this.isDroppedDownChanging.raise(this,e),!e.cancel},t.prototype.onIsDroppedDownChanged=function(e){this.isDroppedDownChanged.raise(this,e)},t.prototype.onGotFocus=function(t){this.isTouching||(0,n.contains)(this._dropDown,(0,n.getActiveElement)())||this.selectAll(),e.prototype.onGotFocus.call(this,t)},t.prototype.onLostFocus=function(t){this._commitText(),this.isDroppedDown=!1,e.prototype.onLostFocus.call(this,t)},t.prototype._containsFocusImpl=function(t){return e.prototype._containsFocusImpl.call(this,t)||this.isDroppedDown&&(0,n.contains)(this._dropDown,t)},t.prototype.dispose=function(){this.isDroppedDown=!1;var t=this._dropDown;if(t){this._dropDown=null,(0,n.removeChild)(t);var i=n.Control.getControl(t);i&&i.dispose()}e.prototype.dispose.call(this)},t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t);var i=this.hostElement;if(i&&i.offsetHeight&&this.isDroppedDown){var o=(0,n.getActiveElement)();this.isAnimated&&""!=this._dropDown.style.opacity||(0,n.showPopup)(this._dropDown,i,!1,!1,null==this.dropDownCssClass),o instanceof HTMLElement&&o!=(0,n.getActiveElement)()&&o.focus()}},t.prototype._handleResize=function(){this.isDroppedDown&&this.refresh()},t.prototype._dropDownClick=function(e){e.stopPropagation()},t.prototype._expandSelection=function(){var e=this._tbx,t=e.value,i=e.selectionStart,o=e.selectionEnd;if(t&&i==o){var r=this._getCharType(t,i);if(r>-1){for(;o<t.length&&this._getCharType(t,o)==r;o++);for(;i>0&&this._getCharType(t,i-1)==r;i--);i!=o&&(0,n.setSelectionRange)(e,i,o)}}},t.prototype._getCharType=function(e,t){var i=e[t];return i>="0"&&i<="9"?0:i>="a"&&i<="z"||i>="A"&&i<="Z"?1:-1},t.prototype._keydown=function(e){if(!e.defaultPrevented&&!this._isHiddenEditor()){switch(e.keyCode){case n.Key.Tab:case n.Key.Escape:case n.Key.Enter:this.isDroppedDown&&(this.isDroppedDown=!1,e.keyCode==n.Key.Tab||this.containsFocus()||this.focus(),e.preventDefault());break;case n.Key.F4:case n.Key.Up:case n.Key.Down:if(e.keyCode==n.Key.F4||e.altKey){var t=this.hostElement;t&&t.offsetHeight&&(this.isDroppedDown=!this.isDroppedDown,e.preventDefault())}}if(!e.defaultPrevented&&e.keyCode==n.Key.Escape&&(0,n.isIE)()){var i=this._tbx;if(e.target==i){var o=i.value;i.value=o+" ",i.value=o}}}},t.prototype._isHiddenEditor=function(){return(0,n.hasClass)(this._tbx,"wj-grid-ime")},t.prototype._keypress=function(e){"AltLeft"!=e.code&&"AltRight"!=e.code||e.preventDefault()},t.prototype._btnclick=function(e){e.defaultPrevented||0!=e.button||(e.preventDefault(),this.isTouching?this._containsFocus()||this.hostElement.focus():this.focus(),this.isDroppedDown=!this.isDroppedDown)},t.prototype._setText=function(e,t){(e=(e||"").toString())!=this._tbx.value&&(this._tbx.value=e),e!=this._oldText&&(this._oldText=e,this.onTextChanged()),this._updateState()},t.prototype._updateBtn=function(){this._btn.style.display=this._showBtn?"":"none"},t.prototype._createDropDown=function(){},t.prototype._commitText=function(e){},t.prototype._updateDropDown=function(){if(this.isDroppedDown){this._commitText();var e=this.dropDown;(0,n.setAttribute)(e,"dir",this.rightToLeft?"rtl":null),(0,n.showPopup)(e,this.hostElement,!1,this._animate,null==this.dropDownCssClass)}},t.controlTemplate='<div class="wj-template"><div class="wj-input"><div class="wj-input-group wj-input-btn-visible"><input wj-part="input" type="text" class="wj-form-control"><span wj-part="btn" class="wj-input-group-btn"><button class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-down"></span></button></span></div></div><div wj-part="dropdown" class="wj-content wj-dropdown-panel"></div></div>',t}(n.Control);!function(e){e[e.None=0]="None",e[e.ClickOwner=1]="ClickOwner",e[e.ClickPopup=2]="ClickPopup",e[e.Click=3]="Click",e[e.BlurOwner=4]="BlurOwner",e[e.BlurPopup=8]="BlurPopup",e[e.Blur=12]="Blur",e[e.ClickOrBlur=15]="ClickOrBlur",e[e.DownOwner=16]="DownOwner",e[e.DownPopup=32]="DownPopup",e[e.Down=48]="Down",e[e.EnterOwner=64]="EnterOwner",e[e.EnterPopup=128]="EnterPopup",e[e.Enter=192]="Enter",e[e.LeaveOwner=256]="LeaveOwner",e[e.LeavePopup=512]="LeavePopup",e[e.Leave=768]="Leave"}(b||(b={})),function(e){e[e.None=0]="None",e[e.Left=1]="Left",e[e.Top=2]="Top",e[e.Right=4]="Right",e[e.Bottom=8]="Bottom",e[e.LeftTop=3]="LeftTop",e[e.RightTop=6]="RightTop",e[e.RightBottom=12]="RightBottom",e[e.LeftBottom=9]="LeftBottom"}(v||(v={}));var w=function(e){function t(t,i){var o=e.call(this,t)||this;o._owner=null,o._modal=!1,o._position=n.PopupPosition.BelowLeft,o._showTrigger=b.ClickOwner,o._hideTrigger=b.Blur,o._hideAnim=[],o._fadeIn=!0,o._fadeOut=!0,o._removeOnHide=!0,o._draggable=!1,o._resizable=!1,o._result=null,o._resultEnter=null,o._resultSubmit=null,o._callback=null,o._visible=!1,o._ownerClickBnd=o._ownerClick.bind(o),o._ownerDownBnd=o._ownerDown.bind(o),o._ownerBlurBnd=o._ownerBlur.bind(o),o._ownerEnterBnd=o._ownerEnter.bind(o),o._ownerLeaveBnd=o._ownerLeave.bind(o),o._mousedownBnd=o._mousedown.bind(o),o._mousemoveBnd=o._mousemove.bind(o),o._mousedragBnd=o._mousedrag.bind(o),o._mouseupBnd=o._mouseup.bind(o),o._hideBnd=o.hide.bind(o),o._lastShow=0,o.showing=new n.Event,o.shown=new n.Event,o.hiding=new n.Event,o.hidden=new n.Event,o.resizing=new n.Event,o.resized=new n.Event,o.dragging=new n.Event,o.dragged=new n.Event,o.sizeChanging=new n.Event,o.sizeChanged=new n.Event,o.positionChanging=new n.Event,o.positionChanged=new n.Event;var r=o.hostElement;(0,n.addClass)(r,"wj-control wj-content wj-popup"),r.getAttribute("tabindex")||(r.tabIndex=0),(0,n.hidePopup)(r,!1);var s=o.addEventListener.bind(o);s(r,"compositionstart",(function(){o._composing=!0})),s(r,"compositionend",(function(){o._composing=!1})),s(window,"resize",(function(){!o.isVisible||o._dragged||o.isTouching||o.invalidate()})),s(r,"keydown",(function(e){if(!e.defaultPrevented){if(e.keyCode!=n.Key.Escape||o._composing||(e.preventDefault(),o.hide()),e.keyCode==n.Key.Enter&&!o._composing){var t=o.dialogResultEnter;t&&(e.preventDefault(),o._validateAndHide(t))}e.keyCode==n.Key.Tab&&o.modal&&(e.preventDefault(),(0,n.moveFocus)(r,e.shiftKey?-1:1))}})),s(r,"click",(function(e){var t=e.target;if(t instanceof HTMLElement){if(t instanceof HTMLButtonElement&&"submit"==t.type){var i=o.hostElement,n=o.dialogResultSubmit;i instanceof HTMLFormElement&&n&&i.reportValidity()&&(e.preventDefault(),o.hide(n))}var r=t.className.match(/\bwj-hide[\S]*\b/);r&&r.length>0&&(e.preventDefault(),e.stopPropagation(),o.hide(r[0]))}}));var l=o._toggle.bind(o),a=b;return o.addEventListener(r,"click",(function(e){o._ignoreClick||l(e,a.ClickPopup)}),!0),o.addEventListener(r,"mousedown",(function(e){o._ignoreClick=!1,l(e,a.DownPopup)}),!0),o.addEventListener(r,"mouseenter",(function(e){e.target==r&&l(e,a.EnterPopup)}),!0),o.addEventListener(r,"mouseleave",(function(e){e.target==r&&l(e,a.LeavePopup)}),!0),o.addEventListener(r,"blur",(function(e){o.containsFocus()||l(e,a.BlurPopup)}),!0),s(document,"wheel",(function(e){if(o.isVisible&&o._modal){for(var t=e.target;t&&t!=document.body;t=t.parentElement)if(t.scrollHeight>t.clientHeight)return;e.preventDefault()}})),o.initialize(i),o}return r(t,e),Object.defineProperty(t.prototype,"owner",{get:function(){return this._owner},set:function(e){var t=this._owner;t&&(this.removeEventListener(t,"click"),this.removeEventListener(t,"mousedown"),this.removeEventListener(t,"mouseenter"),this.removeEventListener(t,"mouseleave"),this.removeEventListener(t,"blur")),(t=this._owner=null!=e?(0,n.getElement)(e):null)&&(this.addEventListener(t,"click",this._ownerClickBnd,!0),this.addEventListener(t,"mousedown",this._ownerDownBnd,!0),this.addEventListener(t,"mouseenter",this._ownerEnterBnd,!0),this.addEventListener(t,"mouseleave",this._ownerLeaveBnd,!0),this.addEventListener(t,"blur",this._ownerBlurBnd,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(e){this._position=(0,n.asEnum)(e,n.PopupPosition)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return this.hostElement.firstElementChild},set:function(e){e!=this.content&&(this.hostElement.innerHTML="",e instanceof HTMLElement&&this.hostElement.appendChild(e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showTrigger",{get:function(){return this._showTrigger},set:function(e){this._showTrigger=(0,n.asEnum)(e,b)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hideTrigger",{get:function(){return this._hideTrigger},set:function(e){this._hideTrigger=(0,n.asEnum)(e,b)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fadeIn",{get:function(){return this._fadeIn},set:function(e){this._fadeIn=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fadeOut",{get:function(){return this._fadeOut},set:function(e){this._fadeOut=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"removeOnHide",{get:function(){return this._removeOnHide},set:function(e){if((e=(0,n.asBoolean)(e))!=this.removeOnHide&&(this._removeOnHide=e,!this.isVisible)){var t=this.hostElement;e?(0,n.removeChild)(t):t&&document.body&&(t.style.display="none",document.body.appendChild(t))}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"modal",{get:function(){return this._modal},set:function(e){this._modal=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDraggable",{get:function(){return this._draggable},set:function(e){this._draggable=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isResizable",{get:function(){return this._resizable},set:function(e){this._resizable=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogResult",{get:function(){return this._result},set:function(e){this._result=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogResultEnter",{get:function(){return this._resultEnter},set:function(e){this._resultEnter=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogResultSubmit",{get:function(){return this._resultSubmit},set:function(e){this._resultSubmit=(0,n.asString)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){var e=this.hostElement;return this._visible&&null!=e&&e.offsetHeight>0},enumerable:!0,configurable:!0}),t.prototype.show=function(e,t){var i=this;if(this._lastShow=Date.now(),!this.isVisible){var o=this.hostElement;this.dialogResult=null,this._callback=null,this._oldFocus=null,this._myFocus=null,this._hideAnim.forEach((function(e){clearInterval(e)})),this._hideAnim.length>0&&(this._hideAnim.length=0,this._bkDrop&&((0,n.hidePopup)(this._bkDrop,this.removeOnHide),this._bkDrop.style.opacity=""),(0,n.hidePopup)(o,this.removeOnHide),o.style.opacity="");var r=new n.CancelEventArgs;this.onShowing(r)&&(null!=e&&(this.modal=(0,n.asBoolean)(e)),null!=t&&(this._callback=(0,n.asFunction)(t)),this._oldFocus=(0,n.getActiveElement)(),(0,n.showPopup)(o,this._owner,this._position,this._fadeIn,!1,this._hideBnd),this._modal&&this._showBackdrop(),this._composing=!1,this._visible=!0,this.onShown(r),this._clearTimeouts(),this.modal&&(this.addEventListener(window,"focus",(function(){if(!i.containsFocus()){var e=i._myFocus;e&&e.offsetHeight?e.focus():(0,n.moveFocus)(o,0)}})),this.addEventListener(o,"focusin",(function(){var e=(0,n.getActiveElement)();e&&(0,n.contains)(o,e)&&(e.tabIndex>-1||!i._myFocus)&&(i._myFocus=e)}))),this._resized=this._dragged=this._ignoreClick=!1,this._handleDragResize(!0),this.addEventListener(window,"touchstart",(function(e){i._hideTrigger&b.Blur&&!(0,n.contains)(o,e.target,!0)&&i.hide()})),setTimeout((function(){i.addEventListener(window,"click",(function(e){i._hideTrigger&b.BlurPopup&&i.isDisabled&&!(0,n.contains)(o,e.target,!0)&&i.hide()}))})),setTimeout((function(){if(!i.isDisabled&&!i.containsFocus()&&!i.isTouching){var e=o.querySelector("[autofocus]");e&&e.clientHeight>0&&!e.disabled&&e.tabIndex>-1&&!(0,n.closest)(e,"[disabled],.wj-state-disabled")?(e.focus(),(0,n.isFunction)(e.select)&&e.select()):(0,n.moveFocus)(o,0)}i.isDisabled||i.containsFocus()||(o.tabIndex=0,o.focus())}),100))}},t.prototype.hide=function(e){var i=this;if(this._handleDragResize(!1),this.removeEventListener(window,"touchstart"),this.removeEventListener(window,"click"),this.isVisible){(0,n.isUndefined)(e)||(this.dialogResult=e);var o=new n.CancelEventArgs,r=this.hostElement;if(this.onHiding(o)){for(var s=this.containsFocus()?this._oldFocus:null,l=r.querySelectorAll(".wj-control.wj-dropdown"),a=0;a<l.length;a++){var h=n.Control.getControl(l[a]);h instanceof y&&(h.isDroppedDown=!1)}var c=this.removeOnHide,u=this.fadeOut;setTimeout((function(){if(i._updateState(),i.onHidden(o),i._callback&&i._callback(i),i.hideTrigger&b.LeavePopup){var e=n.Control.getControl((0,n.closest)(i.owner,".wj-popup"));if(e instanceof t&&0!=(e.hideTrigger&b.Leave)){var r=t._evtHover,s=r?document.elementFromPoint(r.clientX,r.clientY):null,l=n.Control.getControl((0,n.closest)(s,".wj-popup"));l instanceof t&&!l.isVisible&&(s=null),s&&(0,n.contains)(e.hostElement,s,!0)||e.hide()}}}),n.Control._FOCUS_INTERVAL+50),this._bkDrop&&this._hideAnim.push((0,n.hidePopup)(this._bkDrop,c,u)),this._hideAnim.push((0,n.hidePopup)(r,c,u)),this._visible=!1,this._oldFocus=null,this._myFocus=null,this.removeEventListener(window,"focus"),this.removeEventListener(r,"focusin"),this.containsFocus()&&(0,n.getActiveElement)().blur(),this._clearTimeouts(),!this.isVisible&&s&&s.offsetHeight&&s.focus()}}},t.prototype.onShowing=function(e){return this.showing.raise(this,e),!e.cancel},t.prototype.onShown=function(e){this.shown.raise(this,e)},t.prototype.onHiding=function(e){return this.hiding.raise(this,e),!e.cancel},t.prototype.onHidden=function(e){this._wasVisible=!1,this.hidden.raise(this,e)},t.prototype.onResizing=function(e){return this.resizing.raise(this,e),!e.cancel},t.prototype.onResized=function(e){this.resized.raise(this,e)},t.prototype.onDragging=function(e){return this.dragging.raise(this,e),!e.cancel},t.prototype.onDragged=function(e){this.dragged.raise(this,e)},t.prototype.onSizeChanging=function(e){return this.sizeChanging.raise(this,e),!e.cancel},t.prototype.onSizeChanged=function(e){this.sizeChanged.raise(this,e)},t.prototype.onPositionChanging=function(e){return this.positionChanging.raise(this,e),!e.cancel},t.prototype.onPositionChanged=function(e){this.positionChanged.raise(this,e)},t.prototype.onLostFocus=function(t){if(e.prototype.onLostFocus.call(this,t),this._hideTrigger&b.BlurPopup&&!this.containsFocus()){var i=document.createEvent("Event");i.initEvent("blur",!0,!0),this._toggle(i,b.BlurPopup)}},t.prototype.dispose=function(){this.owner=null,e.prototype.dispose.call(this)},t.prototype.refresh=function(t){void 0===t&&(t=!0);var i=this.hostElement;if(e.prototype.refresh.call(this,t),this.isVisible&&!this._refreshing&&i){this._refreshing=!0;for(var o=(0,n.getActiveElement)(),r=this._owner?this._owner.getBoundingClientRect():null,s=[],l=i.querySelectorAll(".wj-dropdown"),a=0;a<l.length;a++){var h=n.Control.getControl(l[a]);h instanceof y&&h.isDroppedDown&&(s.push(h),h.dropDown.style.display="none")}(0,n.showPopup)(i,r,this._position),s.forEach((function(e){e.dropDown.style.display="",e._updateDropDown()})),this._modal&&o instanceof HTMLElement&&o!=(0,n.getActiveElement)()&&o.focus(),this._refreshing=!1}},t.prototype._clearTimeouts=function(){this._toShow&&(clearTimeout(this._toShow),this._toShow=null),this._toHideLeave&&(clearTimeout(this._toHideLeave),this._toHideLeave=null),this._toHideBlur&&(clearTimeout(this._toHideBlur),this._toHideBlur=null)},t.prototype._handleDragResize=function(e){var t=this.hostElement,i=this._draggable?this._getHeaderElement():null,n=this.addEventListener.bind(this),o=this.removeEventListener.bind(this),r=this._mousemoveBnd,s=this._mousedownBnd;e?(n(t,"mousemove",r),n(t,"mousedown",s),n(t,"touchstart",s),i&&(i.style.touchAction="none")):(this._mousedownEvt=null,this._rcBounds=null,o(t,"mousemove",r),o(t,"mousedown",s),o(t,"touchstart",s),o(document,"mousemove",this._mousedragBnd),o(document,"mouseup",this._mouseupBnd),i&&(i.style.touchAction=""))},t.prototype._mousemove=function(e){if(!this._mousedownEvt){var t=this.hostElement,i=this._getEdges(t,e),n="",o=v;this._edges=i,this._resizable&&(i==o.LeftTop||i==o.RightBottom?n="nwse-resize":i==o.LeftBottom||i==o.RightTop?n="nesw-resize":i==o.Left||i==o.Right?n="ew-resize":i!=o.Top&&i!=o.Bottom||(n="ns-resize")),this._draggable&&!n&&this._getClosestHeader(e.target)&&(n="move"),t.style.cursor=n}},t.prototype._mousedown=function(e){if(!e.defaultPrevented){var t=e.touches&&e.touches.length>0?e.touches[0]:e;if(this._edges=this._getEdges(this.hostElement,t),this._edges||this._draggable&&this._getClosestHeader(e.target)){var i=new n.CancelEventArgs;if(this._edges?this.onResizing(i):this.onDragging(i)){this._mousedownEvt=t,this._rcBounds=this.hostElement.getBoundingClientRect();var o=this.addEventListener.bind(this),r=document,s=this._mousedragBnd,l=this._mouseupBnd;o(r,"mousemove",s),o(r,"touchmove",s),o(r,"mouseup",l),o(r,"touchend",l)}}this._ignoreClick=!1}},t.prototype._mouseup=function(){this._mousedownEvt=null,this._rcBounds=null;var e=this.removeEventListener.bind(this),t=document,i=this._mousedragBnd,n=this._mouseupBnd;e(t,"mousemove",i),e(t,"touchmove",i),e(t,"mouseup",n),e(t,"touchend",n),this._resized?this.onResized():this._dragged&&this.onDragged(),this._resized=this._dragged=this._ignoreClick=!1},t.prototype._mousedrag=function(e){if(!e.defaultPrevented){var i=this.hostElement,o=this._mousedownEvt,r=e.touches&&e.touches.length>0?e.touches[0]:e,s=r.clientX-o.clientX,l=r.clientY-o.clientY,a=this._rcBounds,h=this._edges,c=t._SZ_MIN,u=n.Rect.fromBoundingRect(a);if(h){if(h&v.Left?(u.left=a.left+s+(r.pageX-r.clientX),u.width=Math.max(a.width-s,c)):h&v.Right&&(u.left=a.left,u.width=Math.max(a.width+s,c)),h&v.Top?(u.top=a.top+l+(r.pageY-r.clientY),u.height=Math.max(a.height-l,c)):h&v.Bottom&&(u.top=a.top,u.height=Math.max(a.height+l,c)),this.onSizeChanging(new C(u))&&((0,n.setCss)(i,{left:u.left,top:u.top,width:u.width,height:u.height}),this._resized=this._dragged=this._ignoreClick=!0,this.onSizeChanged()),!window.ResizeObserver)for(var d=this.hostElement.children,p=0;p<d.length;p++)n.Control.invalidateAll(d[p])}else this._draggable&&(this._dragged||Math.abs(s)+Math.abs(l)>t._DRAG_THRESHOLD)&&(u.left=Math.max(a.left+s+(r.pageX-r.clientX),50-a.width),u.top=Math.max(a.top+l+(r.pageY-r.clientY),0),this.onPositionChanging(new C(u))&&((0,n.setCss)(i,{left:u.left,top:u.top}),this._dragged=this._ignoreClick=!0,this.onPositionChanged()))}},t.prototype._getEdges=function(e,i){var n=0;if(this._resizable){var o=e.getBoundingClientRect(),r=t._SZ_EDGE;i.clientX-o.left<r&&(n|=v.Left),i.clientY-o.top<r&&(n|=v.Top),o.right-i.clientX<r&&(n|=v.Right),o.bottom-i.clientY<r&&(n|=v.Bottom)}return n},t.prototype._ownerClick=function(e){this._toggle(e,b.ClickOwner)},t.prototype._ownerDown=function(e){this._wasVisible=this.isVisible,this._toggle(e,b.DownOwner)},t.prototype._ownerBlur=function(e){(0,n.contains)(this._owner,(0,n.getActiveElement)())||this._toggle(e,b.BlurOwner)},t.prototype._ownerEnter=function(e){e.target==this._owner&&this._toggle(e,b.EnterOwner)},t.prototype._ownerLeave=function(e){e.target==this._owner&&this._toggle(e,b.LeaveOwner)},t.prototype._toggle=function(e,i){var o=this;if(e instanceof MouseEvent&&(t._evtHover=e),!("mouseenter"==e.type&&Date.now()-this._lastShow<300||e.defaultPrevented)){var r=0!=(this._hideTrigger&i),s=0!=(this._showTrigger&i),l=b;(r||s)&&this._clearTimeouts(),r&&this.isVisible&&(i&l.Leave?this._toHideLeave=setTimeout((function(){var e=t._evtHover,i=e?document.elementFromPoint(e.clientX,e.clientY):null;i&&(0,n.contains)(o.hostElement,i,!0)||o.hide()}),n.Control._LEAVE_DELAY):i&l.Blur?this._toHideBlur=setTimeout((function(){o.containsFocus()||(0,n.contains)(o._owner,(0,n.getActiveElement)())||o.hide()}),n.Control._FOCUS_INTERVAL+50):this.hide()),s&&i!=l.ClickPopup&&(this._wasVisible||(i&l.Enter?this._toShow=setTimeout((function(){o.show()}),n.Control._HOVER_DELAY):this.show()))}},t.prototype._getHeaderElement=function(){var e=this.hostElement;return e.querySelector(".wj-dialog-header")||e.querySelector(".modal-header")},t.prototype._getClosestHeader=function(e){return(0,n.closest)(e,".wj-dialog-header")||(0,n.closest)(e,".modal-header")},t.prototype._showBackdrop=function(){var e=this;this._bkDrop||(this._bkDrop=document.createElement("div"),this._bkDrop.tabIndex=-1,(0,n.addClass)(this._bkDrop,"wj-popup-backdrop"),this.addEventListener(this._bkDrop,"mousedown",(function(t){t.preventDefault(),t.stopPropagation(),e.hostElement.focus(),e.hideTrigger&b.Blur&&e.hide()}))),(0,n.setCss)(this._bkDrop,{zIndex:n.Control._POPUP_ZINDEX,display:""});var t=this.hostElement;t.parentElement.insertBefore(this._bkDrop,t)},t.prototype._validateAndHide=function(e){var t=this.hostElement;if(t instanceof HTMLFormElement)t.reportValidity()&&this.hide(e);else{var i=this.hostElement.querySelector(":invalid");i?i.focus():this.hide(e)}},t._DRAG_THRESHOLD=6,t._SZ_EDGE=10,t._SZ_MIN=40,t}(n.Control),C=function(e){function t(t){var i=e.call(this)||this;return i._rc=t,i}return r(t,e),Object.defineProperty(t.prototype,"bounds",{get:function(){return this._rc},enumerable:!0,configurable:!0}),t}(n.CancelEventArgs),x=function(e){function t(t,i){var o=e.call(this,t)||this;o._fmt="d",o._sep=" - ",o._rngs=null,o._showCal=!1,o._clsOnSel=!0,o._handleWheel=!0,o._clicked=!1,o._rangeChanged=!1,o.valueChanged=new n.Event,o.rangeEndChanged=new n.Event,o.rangeChanged=new n.Event,(0,n.addClass)(o.hostElement,"wj-inputdate"),o._msk=new n._MaskProvider(o._tbx),(0,n.isIE9)()||(o.inputType="tel"),o._tbx.type.match(/^(tel|text|)$/i)||(o.inputType="text"),o.addEventListener(o.hostElement,"wheel",(function(e){if(o.handleWheel&&!e.defaultPrevented&&!o.isDroppedDown&&o.containsFocus()&&null!=o.value&&o._canChangeValue()){var t=(0,n.clamp)(-e.deltaY,-1,1),i=o.value;o.value=o.selectionMode==d.Month?n.DateTime.addMonths(i,t):n.DateTime.addDays(i,t),o.selectAll(),e.preventDefault()}}));var r=o._lbx=new c(document.createElement("div"),{displayMemberPath:"name",selectedIndexChanged:function(e){var t=e.selectedItem,i=n.DateTime.fromDateTime;if(t&&t.from&&t.to){var r=o.value;o.value=i(t.from,r),o.rangeEnd=i(t.to,r),o._selectAll()}else o._cal.hostElement.style.display=""}}),s=o._cal=new m(document.createElement("div")),l=o._dropDown;if((0,n.addClass)(l,"wj-inputdate-dropdown"),l.appendChild(r.hostElement),l.appendChild(s.hostElement),o.addEventListener(l,"click",(function(){o._clicked=!0,setTimeout((function(){o._clicked=!1}),50)}),!0),"INPUT"==o._orgTag){var a=o._tbx.getAttribute("value");a&&(s.value=s.rangeEnd=n.Globalize.parseDate(a,"yyyy-MM-dd"))}return o.isRequired=!0,o.initialize(i),o._tbx.value=o._oldText=o._getText(),o._updateState(),s.valueChanged.addHandler((function(e,t){o._refreshText(),o.onValueChanged(t),o._closeOnChange()})),s.rangeEndChanged.addHandler((function(e,t){s._rngMode()&&(o.onRangeEndChanged(t),o._closeOnChange(),s._clearingRangeEnd||o._refreshText())})),s.hostElement.addEventListener("click",(function(e){if(s.selectionMode&&!s._rngMode()){var t=e.target,i=s.hitTest(t);(n.DateTime.sameDate(o.value,i)||(0,n.closest)(t,"[wj-part=btn-today]"))&&(o._closeOnChange(),o._refreshText())}})),o}return r(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._cal.value},set:function(e){this._cal.value=e,this._refreshText()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rangeEnd",{get:function(){return this._cal.rangeEnd},set:function(e){this._cal.rangeEnd=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rangeMin",{get:function(){return this._cal.rangeMin},set:function(e){this._cal.rangeMin=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rangeMax",{get:function(){return this._cal.rangeMax},set:function(e){this._cal.rangeMax=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._tbx.value},set:function(e){var t=(e||"").toString();t!=this.text&&(t!=this._tbx.value&&(this._tbx.value=t),t!=this._oldText&&(this._oldText=t),this._commitText(),this.onTextChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"format",{get:function(){return this._fmt},set:function(e){e!=this.format&&(this._fmt=(0,n.asString)(e),this._refreshText())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"separator",{get:function(){return this._sep},set:function(e){e!=this._sep&&(this._sep=(0,n.asString)(e,!1),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mask",{get:function(){return this._msk.mask},set:function(e){this._msk.mask=(0,n.asString)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"closeOnSelection",{get:function(){return this._clsOnSel},set:function(e){this._clsOnSel=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"handleWheel",{get:function(){return this._handleWheel},set:function(e){e=(0,n.asBoolean)(e),this._handleWheel=e,e||(this.calendar.handleWheel=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"predefinedRanges",{get:function(){return this._rngs},set:function(e){this._rngs!=e&&((0,n.assert)(null==e||(0,n.isObject)(e),"Object expected"),this._rngs=e,this._lbx.itemsSource=this._getRanges(e),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alwaysShowCalendar",{get:function(){return this._showCal},set:function(e){this._showCal=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return this._cal.min},set:function(e){this._cal.min=(0,n.asDate)(e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._cal.max},set:function(e){this._cal.max=(0,n.asDate)(e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"repeatButtons",{get:function(){return this._cal.repeatButtons},set:function(e){this._cal.repeatButtons=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showYearPicker",{get:function(){return this._cal.showYearPicker},set:function(e){this._cal.showYearPicker=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showMonthPicker",{get:function(){return this._cal.showMonthPicker},set:function(e){this._cal.showMonthPicker=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showHeader",{get:function(){return this._cal.showHeader},set:function(e){this._cal.showHeader=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weeksBefore",{get:function(){return this._cal.weeksBefore},set:function(e){this._cal.weeksBefore=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weeksAfter",{get:function(){return this._cal.weeksAfter},set:function(e){this._cal.weeksAfter=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectionMode",{get:function(){return this._cal.selectionMode},set:function(e){e!=this.selectionMode&&(this._cal.selectionMode=e,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"monthCount",{get:function(){return this._cal.monthCount},set:function(e){this._cal.monthCount=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"calendar",{get:function(){return this._cal},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputType",{get:function(){return this._tbx.type},set:function(e){this._tbx.type=(0,n.asString)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemValidator",{get:function(){return this._cal.itemValidator},set:function(e){e!=this.itemValidator&&(this._cal.itemValidator=(0,n.asFunction)(e),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemFormatter",{get:function(){return this._cal.itemFormatter},set:function(e){this._cal.itemFormatter=(0,n.asFunction)(e)},enumerable:!0,configurable:!0}),t.prototype.onValueChanged=function(e){this.valueChanged.raise(this,e)},t.prototype.onRangeEndChanged=function(e){this.rangeEndChanged.raise(this,e),this.rangeEnd&&(this.isDroppedDown?this._rangeChanged=!0:this.onRangeChanged(e))},t.prototype.onRangeChanged=function(e){this._rangeChanged=!1,this.rangeChanged.raise(this,e)},t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this.hostElement&&(this._msk&&this._msk.refresh(),this._cal&&this._cal.refresh(),this._refreshText())},t.prototype.onIsDroppedDownChanging=function(t){if(this.isDroppedDown)(o=this._cal)._rngMode()&&o.value&&!o.rangeEnd&&(o.rangeEnd=o.value);else{var i=this._lbx,o=this._cal,r=i.collectionView,s=i.hostElement.style,l=o.hostElement.style;if(o._rngMode()&&(0,n.hasItems)(r)){var a=this._updateRangeSelection();s.display="",l.display=!this._showCal&&a&&a.from&&r.items.some((function(e){return!e.to}))?"none":""}else s.display="none",l.display="";o._mthMode()||(o.monthView=!0)}return e.prototype.onIsDroppedDownChanging.call(this,t)},t.prototype.onIsDroppedDownChanged=function(t){e.prototype.onIsDroppedDownChanged.call(this,t);var i=this.containsFocus();this.isDroppedDown?(i&&(this._tryFocus(this._cal)||this._tryFocus(this._lbx)||this.dropDown.focus()),this._lbx.showSelection(),this._cal.refresh()):(this._commitText(),this._rangeChanged&&this.onRangeChanged())},t.prototype._updateDropDown=function(){this._commitText();var t=getComputedStyle(this.hostElement);this._dropDown.style.minWidth=18*parseFloat(t.fontSize)+"px",this._cal.refresh(),e.prototype._updateDropDown.call(this)},t.prototype._keydown=function(t){if(!(t.defaultPrevented||t.altKey||t.ctrlKey||t.metaKey)){if(this._isHiddenEditor())return;switch(t.keyCode){case n.Key.Enter:this.isDroppedDown?this._refreshText():this._commitText();break;case n.Key.Escape:this.text=this._getText(),this.selectAll();break;case n.Key.Tab:if(this._cal._rngMode()){var i=this._tbx,o=this._sep,r=i.value,s=r.indexOf(o);if(s>-1){var l=r.length,a=i.selectionStart,h=i.selectionEnd,c=null;i.selectionEnd<=s&&!t.shiftKey?c=0==a&&0==h:t.shiftKey&&i.selectionStart>=s+o.length&&(c=a<l||h<l),null!=c&&(c?(0,n.setSelectionRange)(i,0,s):(0,n.setSelectionRange)(i,s+o.length,l),t.preventDefault())}}break;case n.Key.Up:case n.Key.Down:if(!this.isDroppedDown&&this.value&&this._canChangeValue()){var u=t.keyCode==n.Key.Up?1:-1,p=this.selectionMode==d.Month?n.DateTime.addMonths(this.value,u):n.DateTime.addDays(this.value,u);this.value=this._fromDateTime(p),this.selectAll(),t.preventDefault()}}}e.prototype._keydown.call(this,t)},t.prototype._expandSelection=function(){if(this._cal._rngMode()){var t=this._tbx,i=t.value,o=t.selectionStart,r=t.selectionEnd,s=this._sep,l=i.indexOf(s);l>-1&&o==r&&(r<=l?(0,n.setSelectionRange)(t,0,l):o>=l+s.length&&(0,n.setSelectionRange)(t,l+s.length,t.value.length))}else e.prototype._expandSelection.call(this)},t.prototype._refreshText=function(){var e=this._getText();e!=this.text&&(this._tbx.value=this._oldText=e,this.onTextChanged())},t.prototype._selectAll=function(){this.isDroppedDown||!this.containsFocus()||this.isTouching||this.selectAll()},t.prototype._closeOnChange=function(){var e=this;if(this._clsOnSel&&this._clicked){var t=this._cal;(!t._rngMode()||t.value&&t.rangeEnd)&&setTimeout((function(){e.isDroppedDown=!1}))}},t.prototype._tryFocus=function(e){var t=e.hostElement;return!(!t||!t.offsetHeight)&&(t.focus(),!0)},t.prototype._clamp=function(e){return this._cal._clamp(e)},t.prototype._getText=function(){var e=n.Globalize.format,t=this._fmt,i=e(this.value,t);return this._cal._rngMode()&&i&&(i+=this._sep+e(this.rangeEnd,t)),i},t.prototype._commitText=function(e){var t=this._tbx.value;if(t!=this._getText()){var i=!1,o=this._fmt,r=this._cal,s=n.Globalize.parseDate;if(t||this.isRequired)if(r._rngMode()){var l=t.split(this._sep);if(2==l.length&&l[0]&&(h=s(l[0],o,this.value))){var a=s(l[1],o,this.value);r.value=this._fromDateTime(h),r.rangeEnd=a&&a>=h?this._fromDateTime(a):h,i=!0}}else{var h;(h=s(t,o,this.value))&&(this.value=this._fromDateTime(h),i=!0)}else this.value=this.rangeEnd=null,i=!0;(i||!this._containsFocus()&&this.onInvalidInput(new n.CancelEventArgs))&&(this.text=this._getText())}e||this._selectAll()},t.prototype._fromDateTime=function(e){return n.DateTime.fromDateTime(e,this.value)},t.prototype._canChangeValue=function(){return!this.isReadOnly&&!this.isDisabled&&this.selectionMode!=d.None},t.prototype._isValidDate=function(e){if(e){if(this._clamp(e)!=e)return!1;if(this.itemValidator&&!this.itemValidator(e))return!1}return!0},t.prototype._getRanges=function(e){var t=[];if((0,n.isObject)(e))for(var i in e){var o=e[i];t.push({name:i,from:o?o[0]:null,to:o?o[1]:null})}return new n.CollectionView(t,{currentItem:null})},t.prototype._updateRangeSelection=function(){var e=this._lbx,t=-1;if((0,n.hasItems)(e.collectionView))for(var i=this._lbx.collectionView.items,o=n.DateTime.sameDate,r=0;r<i.length;r++){var s=i[r];if(s.from){if(o(s.from,this.value)&&o(s.to,this.rangeEnd)){t=r;break}}else t=r}return e.selectedIndex=t,e.selectedItem},t}(y),E=function(e){function t(t,i){var o=e.call(this,t,{selectionMode:d.Range,showMonthPicker:"Outside",monthCount:2})||this;return(0,n.addClass)(o.hostElement,"wj-inputdaterange"),o.initialize(i),o}return r(t,e),Object.defineProperty(t.prototype,"selectionMode",{get:function(){return this.calendar.selectionMode},set:function(e){e=(0,n.asEnum)(e,d),(0,n.assert)(e==d.Range,'InputDateRange.selectionMode must be "Range"'),this.calendar.selectionMode=e},enumerable:!0,configurable:!0}),t}(x),S=function(e){function t(t,i){var o=e.call(this,t)||this;return o.valueChanged=new n.Event,(0,n.addClass)(o.hostElement,"wj-inputcolor"),o._ePreview=(0,n.createElement)('<div class="wj-inputcolorbox"></div>',o.hostElement.firstElementChild),"INPUT"==o._orgTag&&(o._tbx.type="",o._commitText()),o.value="#ffffff",o.isRequired=!0,o.initialize(i),o.addEventListener(o._colorPicker.hostElement,"click",(function(e){var t=e.target;t&&"DIV"==t.tagName&&((0,n.closest)(t,'[wj-part="div-pal"]')||(0,n.closest)(t,'[wj-part="div-pv"]'))&&t.style.backgroundColor&&(o.isDroppedDown=!1)})),o}return r(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this.text=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._tbx.value},set:function(e){(e=(0,n.asString)(e))==this.text||!e&&this.isRequired||e&&!n.Color.fromString(e)||(this._setText(e,!0),this._commitText())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showAlphaChannel",{get:function(){return this._colorPicker.showAlphaChannel},set:function(e){this._colorPicker.showAlphaChannel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showColorString",{get:function(){return this._colorPicker.showColorString},set:function(e){this._colorPicker.showColorString=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"palette",{get:function(){return this._colorPicker.palette},set:function(e){this._colorPicker.palette=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"colorPicker",{get:function(){return this._colorPicker},enumerable:!0,configurable:!0}),t.prototype.onValueChanged=function(e){this.valueChanged.raise(this,e)},t.prototype.onIsDroppedDownChanged=function(t){e.prototype.onIsDroppedDownChanged.call(this,t),this.isDroppedDown&&!this.isTouching&&this.selectAll()},t.prototype._createDropDown=function(){var e=this;this._colorPicker=new a(this._dropDown),(0,n.setCss)(this._dropDown,{minWidth:420,minHeight:200}),this._colorPicker.valueChanged.addHandler((function(){e.value=e._colorPicker.value}))},t.prototype._keydown=function(t){if(!t.defaultPrevented)switch(t.keyCode){case n.Key.Enter:this._commitText(),this.selectAll();break;case n.Key.Escape:this.text=this.value,this.selectAll()}e.prototype._keydown.call(this,t)},t.prototype._commitText=function(){if(this._value!=this.text){if(!this.isRequired&&!this.text)return this._value=this.text,this._ePreview.style.backgroundColor="",void this.onValueChanged();if(n.Color.fromString(this.text)){var e=this._colorPicker;e.value=this.text,this._value=e.value,this._ePreview.style.backgroundColor=this.value,this.onValueChanged()}else this.onInvalidInput(new n.CancelEventArgs)&&(this.text=this._value?this._value:"")}},t}(y),D=function(e){function t(t,i){var o=e.call(this,t)||this;o._editable=!1,o._trimText=!0,o._handleWheel=!0,o._delKey=0,o._pathHdr=new n.Binding(null),o._bsCollapse=!0,o._fmtItemHandlers=0,o.itemsSourceChanged=new n.Event,o.selectedIndexChanged=new n.Event;var r=o.hostElement;(0,n.addClass)(r,"wj-combobox"),o.dropDown.id=(0,n.getUniqueId)(r.id+"_dropdown"),o.autoExpandSelection=!1;var s=o._tbx;o.addEventListener(s,"compositionstart",(function(){o._composing=!0})),o.addEventListener(s,"compositionend",(function(){o._composing=!1,o._setText(o.text,!0)})),o.addEventListener(r,"wheel",o._wheel.bind(o)),"SELECT"==o._orgTag&&o._lbx._initFromSelect(r);var l=o._lbx;return l.loadedItems.addHandler((function(e){o.selectedIndex>-1&&(o.selectedIndex=l.selectedIndex)})),o.isRequired=!0,o.initialize(i),o}return r(t,e),Object.defineProperty(t.prototype,"itemsSource",{get:function(){return this._lbx.itemsSource},set:function(e){this._lbx.itemsSource!=e&&(this._lbx.itemsSource=e,this.onItemsSourceChanged()),this._updateBtn()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collectionView",{get:function(){return this._lbx.collectionView},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"virtualizationThreshold",{get:function(){return this._lbx.virtualizationThreshold},set:function(e){this._lbx.virtualizationThreshold=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showGroups",{get:function(){return this._lbx.showGroups},set:function(e){this._lbx.showGroups=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayMemberPath",{get:function(){return this._lbx.displayMemberPath},set:function(e){this._lbx.displayMemberPath=e;var t=this.getDisplayText();this.text!=t&&this._setText(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"headerPath",{get:function(){return this._pathHdr.path},set:function(e){this._pathHdr.path=(0,n.asString)(e);var t=this.getDisplayText();this.text!=t&&this._setText(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedValuePath",{get:function(){return this._lbx.selectedValuePath},set:function(e){this._lbx.selectedValuePath=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isContentHtml",{get:function(){return this._lbx.isContentHtml},set:function(e){if(e!=this.isContentHtml){this._lbx.isContentHtml=(0,n.asBoolean)(e);var t=this.getDisplayText();this.text!=t&&this._setText(t,!0)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"caseSensitiveSearch",{get:function(){return this._lbx.caseSensitiveSearch},set:function(e){this._lbx.caseSensitiveSearch=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trimText",{get:function(){return this._trimText},set:function(e){e!=this._trimText&&(this._trimText=(0,n.asBoolean)(e),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemFormatter",{get:function(){return this._lbx.itemFormatter},set:function(e){this._lbx.itemFormatter=(0,n.asFunction)(e),this.selectedIndex=this._lbx.selectedIndex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formatItem",{get:function(){return this._lbx.formatItem},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return this._lbx.selectedIndex},set:function(e){e!=this.selectedIndex&&(0,n.isNumber)(e)&&(this._lbx.selectedIndex=e),e=this.selectedIndex;var t=this.getDisplayText(e);this.text!=t&&this._setText(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedItem",{get:function(){return this._lbx.selectedItem},set:function(e){this._lbx.selectedItem=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedValue",{get:function(){return this.collectionView?this._lbx.selectedValue:this.text},set:function(e){this.collectionView?this._lbx.selectedValue=e:null!=e&&(this.text=e.toString())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEditable",{get:function(){return this._editable},set:function(e){this._editable=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"handleWheel",{get:function(){return this._handleWheel},set:function(e){this._handleWheel=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxDropDownHeight",{get:function(){return this._lbx.maxHeight},set:function(e){this._lbx.maxHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxDropDownWidth",{get:function(){var e=this._dropDown,t=e?parseInt(e.style.maxWidth):null;return isNaN(t)?null:t},set:function(e){var t=this._dropDown.style;e=(0,n.asNumber)(e,!0),t.maxWidth=null==e?"":e+"px",t.minWidth=""},enumerable:!0,configurable:!0}),t.prototype.getDisplayText=function(e,t){void 0===e&&(e=this.selectedIndex),void 0===t&&(t=this._trimText);var i,o=this.collectionView;if(this.headerPath&&e>-1&&(0,n.hasItems)(o)){var r=o.items[e];i=null!=(i=r?this._pathHdr.getValue(r):null)?i.toString():"",this.isContentHtml&&(i=(0,n.toPlainText)(i))}else i=this._lbx.getDisplayText(e);return t?i.trim():i},t.prototype.indexOf=function(e,t){var i=this.collectionView,o=this.caseSensitiveSearch;if((0,n.hasItems)(i)&&null!=e){e=e.toString(),o||(e=e.toLowerCase()),this._trimText&&(e=e.trim());var r=this.selectedIndex,s=this.getDisplayText(r);if(t&&(o||(s=s.toLowerCase()),e==s))return r;for(var l=0;l<i.items.length;l++)if(this._lbx.isItemEnabled(l))if(s=this.getDisplayText(l),o||(s=s.toLowerCase()),t){if(s==e)return l}else if(e&&0==s.indexOf(e))return l}return-1},Object.defineProperty(t.prototype,"listBox",{get:function(){return this._lbx},enumerable:!0,configurable:!0}),t.prototype.onItemsSourceChanged=function(e){this.itemsSourceChanged.raise(this,e)},t.prototype.onSelectedIndexChanged=function(e){this._updateBtn(),this.selectedIndexChanged.raise(this,e)},t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this.hostElement&&(0,n.hasItems)(this.collectionView)&&(this._lbx.refresh(),this.selectedIndex>-1&&(this.selectedIndex=this._lbx.selectedIndex))},t.prototype.onLostFocus=function(t){this._composing&&(this._composing=!1,this._setText(this.text,!0)),this.isEditable&&this.isRequired&&!this.text&&(0,n.hasItems)(this.collectionView)&&(this.selectedIndex=0),e.prototype.onLostFocus.call(this,t)},t.prototype.onIsDroppedDownChanging=function(t){return this.isDroppedDown||this._hasItems()?e.prototype.onIsDroppedDownChanging.call(this,t):(t.cancel=!0,!1)},t.prototype.onIsDroppedDownChanged=function(t){e.prototype.onIsDroppedDownChanged.call(this,t),this.isDroppedDown&&(this._fmtItemHandlers=this.formatItem.handlerCount,this._lbx.showSelection()),this._updateAria()},t.prototype._setIsDisabled=function(t){e.prototype._setIsDisabled.call(this,t),this._updateBtn()},t.prototype._updateBtn=function(){var t=this.collectionView,i=this._tbx,o=this._hasItems();e.prototype._updateBtn.call(this),this._btn.style.display=this._showBtn&&null!=t?"":"none",(0,n.enable)(this._btn,o&&!this.isDisabled),(0,n.setAttribute)(i,"role",o?"combobox":null),(0,n.setAttribute)(i,"aria-autocomplete",o?"both":null),this._updateAria()},t.prototype._hasItems=function(){return(0,n.hasItems)(this.collectionView)},t.prototype._updateAria=function(){var e=this._tbx,t=this.isDroppedDown,i=this.dropDown?this.dropDown.id:null,o=i&&(0,n.hasItems)(this.collectionView);(0,n.setAttribute)(e,"aria-owns",o&&t?i:null),(0,n.setAttribute)(e,"aria-expanded",o?t:null)},t.prototype._createDropDown=function(){var e=this;this._lbx||(this._lbx=new c(this._dropDown),this._lbx._container=this.hostElement),this._lbx.maxHeight=200,this._lbx.selectedIndexChanged.addHandler((function(){e._updateBtn();var t=e._lbx.selectedIndex,i=e._lbx.hostElement.children,o=t>-1&&t<i.length?i[t].id:null;(0,n.setAttribute)(e._tbx,"aria-activedescendant",o&&o.length?o:null),e.selectedIndex=t,e.onSelectedIndexChanged()})),this._lbx.itemsChanged.addHandler((function(){e._updateBtn()}))},t.prototype._wheel=function(e){if(this.handleWheel&&!e.defaultPrevented&&!this.isDroppedDown&&!this.isReadOnly&&this.containsFocus()&&this.selectedIndex>-1){var t=this._findNext("",e.deltaY>0?1:-1);t>-1&&(this.selectedIndex=t),e.preventDefault()}},t.prototype._dropDownClick=function(t){t.defaultPrevented||t.target!=this._dropDown&&(this.isDroppedDown=!1),e.prototype._dropDownClick.call(this,t)},t.prototype._setText=function(t,i){if(!this._composing&&!this._settingText){if(this._settingText=!0,this.containsFocus()){var o=this.formatItem.handlerCount;this._fmtItemHandlers!=o&&(this._fmtItemHandlers=o,this._lbx.loadList())}null==t&&(t=""),t=t.toString();var r=this.selectedIndex,s=this.collectionView,l=this._getSelStart(),a=-1,h=!0;if(this.isEditable&&(this._delKey||this._getSelEnd()<t.length||!this.containsFocus())&&(i=!0,h=!1),r=this.indexOf(t,i),h&&(r<0&&i&&(r=this.indexOf(t,!1)),r<0&&l>0&&(r=this.indexOf(t.substr(0,l),!1))),r<0&&!this.isEditable&&(0,n.hasItems)(s)&&(this.isRequired||t)){var c=this._oldText||"";r=Math.max(0,this.indexOf(c,!1)),l=0;for(var u=0;u<t.length&&u<c.length;u++)if(t[u]!=c[u]){l=u;break}}r>-1&&(a=l,t=this.getDisplayText(r));var d=this._tbx;t!=d.value&&(d.value=t),a>-1&&this.containsFocus()&&!this.isTouching&&this._updateInputSelection(a),s&&s.moveCurrentToPosition(r),this._delKey=0,this._settingText=!1,e.prototype._setText.call(this,t,i)}},t.prototype._findNext=function(e,t,i){void 0===i&&(i=this.selectedIndex);var n=this.collectionView,o=n?n.items.length:0,r=this._lbx,s=this.caseSensitiveSearch;if(n&&o&&t){s||(e=e.toLowerCase());for(var l=i+t;l>-1&&l<o;l+=t){var a=this.getDisplayText(l);if(s||(a=a.toLowerCase()),0==a.indexOf(e)&&(!this.dropDown.children[l]||r.isItemEnabled(l)))return l}}return i},t.prototype._keydown=function(t){if(e.prototype._keydown.call(this,t),!t.defaultPrevented&&!this.isReadOnly&&!t.altKey&&(0,n.hasItems)(this.collectionView)&&this._elRef==this._tbx&&!this._isHiddenEditor()){this._delKey=0;var i=this._getSelStart();switch(t.keyCode){case n.Key.Back:if(this._bsCollapse&&!this.isEditable){var o=this._getSelEnd();i>0&&o==this._tbx.value.length&&(0,n.hasItems)(this.collectionView)&&this._setSelRange(i-1,o)}this._delKey=t.keyCode;break;case n.Key.Delete:this._delKey=t.keyCode;break;case n.Key.Up:case n.Key.Down:i==this.text.length&&(i=0),this.selectedIndex=this._findNext(this.text.substr(0,i),t.keyCode==n.Key.Up?-1:1),this._setSelRange(i,this.text.length),t.preventDefault();break;case n.Key.PageUp:this._lbx._selectPrevPage(),this.selectAll(),t.preventDefault();break;case n.Key.PageDown:this._lbx._selectNextPage(),this.selectAll(),t.preventDefault()}}},t.prototype._updateInputSelection=function(e){var t=this._tbx;this._elRef==t&&this._setSelRange(e,t.value.length)},t.prototype._getSelStart=function(){var e=this._tbx;return e&&e.value?e.selectionStart:0},t.prototype._getSelEnd=function(){var e=this._tbx;return e&&e.value?e.selectionEnd:0},t.prototype._setSelRange=function(e,t){var i=this._tbx;this._elRef!=i||i.readOnly||(0,n.setSelectionRange)(i,e,t)},t}(y);(0,n._addCultureInfo)("MultiSelect",{itemsSelected:"{count:n0} items selected",selectAll:"Select All"});var P=function(e){function t(t,i){var o=e.call(this,t)||this;return o._maxHdrItems=2,o._readOnly=!1,o._hdrFmt=null,o.checkedItemsChanged=new n.Event,(0,n.addClass)(o.hostElement,"wj-multiselect"),o._tbx.readOnly=!0,o.checkedMemberPath=null,o.removeEventListener(o.dropDown,"click"),o._lbx.itemsChanged.addHandler((function(){o._updateHeader(!1)})),o._lbx.checkedItemsChanged.addHandler((function(){o._updateHeader(!1),o.onCheckedItemsChanged()})),o.clickAction=g.Toggle,o.initialize(i),o}return r(t,e),Object.defineProperty(t.prototype,"showSelectAllCheckbox",{get:function(){return this._msLbx.showSelectAllCheckbox},set:function(e){this._msLbx.showSelectAllCheckbox=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showFilterInput",{get:function(){return this._msLbx.showFilterInput},set:function(e){this._msLbx.showFilterInput=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"delay",{get:function(){return this._msLbx.delay},set:function(e){this._msLbx.delay=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"caseSensitiveSearch",{get:function(){return this._msLbx.caseSensitiveSearch},set:function(e){this._msLbx.caseSensitiveSearch=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filterInputPlaceholder",{get:function(){return this._msLbx.filterInputPlaceholder},set:function(e){this._msLbx.filterInputPlaceholder=(0,n.asString)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checkOnFilter",{get:function(){return this._msLbx.checkOnFilter},set:function(e){e!=this.checkOnFilter&&(this._msLbx.checkOnFilter=(0,n.asBoolean)(e),this.checkedItems=[])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectAllLabel",{get:function(){return this._msLbx.selectAllLabel},set:function(e){this._msLbx.selectAllLabel=(0,n.asString)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checkedMemberPath",{get:function(){return this._msLbx.checkedMemberPath},set:function(e){this._msLbx.checkedMemberPath=(0,n.asString)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxHeaderItems",{get:function(){return this._maxHdrItems},set:function(e){this._maxHdrItems!=e&&(this._maxHdrItems=(0,n.asNumber)(e),this._updateHeader())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"headerFormat",{get:function(){return this._hdrFmt},set:function(e){e!=this._hdrFmt&&(this._hdrFmt=(0,n.asString)(e),this._updateHeader())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"headerFormatter",{get:function(){return this._hdrFormatter},set:function(e){e!=this._hdrFormatter&&(this._hdrFormatter=(0,n.asFunction)(e),this._updateHeader())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checkedItems",{get:function(){return this._msLbx.checkedItems},set:function(e){this._msLbx.checkedItems=null==e?[]:(0,n.asArray)(e),this._updateHeader()},enumerable:!0,configurable:!0}),t.prototype.onCheckedItemsChanged=function(e){this.checkedItemsChanged.raise(this,e)},t.prototype.dispose=function(){this._lbx.dispose(),e.prototype.dispose.call(this)},t.prototype.onIsDroppedDownChanged=function(t){var i=this;e.prototype.onIsDroppedDownChanged.call(this,t),setTimeout((function(){if(i.isDroppedDown&&i.containsFocus())if(i.showFilterInput&&!i.isTouching)i._msLbx._filter.focus();else{var e=i.listBox;if(e.selectedIndex<0){var t=0,n=e.checkedItems;n.length&&(t=e.collectionView.items.indexOf(n[0])),e.selectedIndex=Math.max(0,t)}e.showSelection(!0),e.focus()}}))},t.prototype._createDropDown=function(){var t=(0,n.createElement)("<div></div>",this._dropDown);this._msLbx=new _(t),this._lbx=this._msLbx.listBox,e.prototype._createDropDown.call(this)},Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(e){this._readOnly=(0,n.asBoolean)(e),(0,n.toggleClass)(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0}),t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this.hostElement&&this._updateHeader()},t.prototype._setText=function(e,t){},t.prototype._keydown=function(t){e.prototype._keydown.call(this,t),(0,n.hasClass)(this._tbx,"wj-grid-ime")||!t.defaultPrevented&&(0,n.hasItems)(this.collectionView)&&t.keyCode>32&&(this.isDroppedDown=!0)},t.prototype._hasItems=function(){var e=this.collectionView,t=e?e.sourceCollection:null;return(0,n.hasItems)(e)||t&&t.length&&this.showFilterInput},t.prototype._updateHeader=function(e){void 0===e&&(e=!0);var t="";if((0,n.isFunction)(this._hdrFormatter))t=this._hdrFormatter(this);else{var i=this.checkedItems;if(i.length>0)if(i.length<=this._maxHdrItems){if(this.headerPath){var o=new n.Binding(this.headerPath);i=i.map((function(e){return o.getValue(e)}))}else if(this.displayMemberPath){var r=new n.Binding(this.displayMemberPath);i=i.map((function(e){return r.getValue(e)}))}this.isContentHtml&&(i=i.map((function(e){return(0,n.toPlainText)(e)}))),this.trimText&&(i=i.map((function(e){return e?e.toString().trim():""}))),t=i.join(", ")}else t=(0,n.format)(this.headerFormat||n.culture.MultiSelect.itemsSelected,{count:i.length})}var s=this.inputElement;t!=s.value&&(s.value=t,this.onTextChanged()),e&&this._lbx._updateCheckedList(this.checkedItems),this._updateState()},t._DEF_CHECKED_PATH="$checked",t}(D),I=function(e){function t(t,i){var o=e.call(this,t)||this;o._closing=!1,o._cmd=null,o._cmdPath=null,o._cmdParamPath=null,o._subPath=null,o._owner=null,o._isButton=!1,o._openOnHover=!1,o._closeOnLeave=!0,o._subMenu=null,o._hoverEnterBnd=o._hoverEnter.bind(o),o._hoverLeaveBnd=o._hoverLeave.bind(o),o._hoverOverBnd=o._hoverOver.bind(o),o.itemClicked=new n.Event;var r=o.hostElement,s=o._tbx,l=o._lbx,a=o.dropDown;return(0,n.addClass)(r,"wj-menu"),s.style.display="none",o._hdr=o._elRef=(0,n.createElement)('<div wj-part="header" class="wj-form-control"/>'),s.parentElement.insertBefore(o._hdr,o._tbx),r.tabIndex=o.isDisabled?-1:o._orgTabIndex,o.isRequired=!1,(0,n.setAttribute)(r,"role","menubar",!0),(0,n.setAttribute)(s,"role",null),(0,n.setAttribute)(s,"aria-autocomplete",null),(0,n.setAttribute)(s,"aria-owns",null),(0,n.setAttribute)(a,"role","menu"),l.itemRole="menuitem","SELECT"==o._orgTag&&(o.header=r.getAttribute("header"),o._lbx.itemsSource&&(o.commandParameterPath="cmdParam")),o.isContentHtml=!0,o.maxDropDownHeight=500,o.addEventListener(o._hdr,"click",(function(e){e.defaultPrevented||(o._clearHover(e),o._isButton?(o.isDroppedDown=!1,o._raiseCommand()):o.isDroppedDown=!o.isDroppedDown)})),l.lostFocus.addHandler((function(){o.containsFocus()||(o.isDroppedDown=!1)})),(0,n.addClass)(a,"wj-menu-items"),l.formatItem.addHandler(o._formatMenuItem.bind(o)),o.initialize(i),o}return r(t,e),Object.defineProperty(t.prototype,"header",{get:function(){return this._hdr.innerHTML},set:function(e){this._hdr.innerHTML=(0,n.asString)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"command",{get:function(){return this._cmd},set:function(e){this._cmd=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"commandPath",{get:function(){return this._cmdPath},set:function(e){this._cmdPath=(0,n.asString)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"commandParameterPath",{get:function(){return this._cmdParamPath},set:function(e){this._cmdParamPath=(0,n.asString)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subItemsPath",{get:function(){return this._subPath},set:function(e){e!=this._subPath&&(this._subPath=e,this.refresh(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"openOnHover",{get:function(){return this._openOnHover},set:function(e){this._openOnHover=(0,n.asBoolean)(e),this._updateHoverEvents()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"closeOnLeave",{get:function(){return this._closeOnLeave},set:function(e){this._closeOnLeave=(0,n.asBoolean)(e),this._updateHoverEvents()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isButton",{get:function(){return this._isButton},set:function(e){this._isButton=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"owner",{get:function(){return this._owner},set:function(e){this._owner=(0,n.asType)(e,HTMLElement,!0),this._enableDisableItems()},enumerable:!0,configurable:!0}),t.prototype.show=function(e){if(!this.isDroppedDown&&(this.selectedIndex=-1,this.onIsDroppedDownChanging(new n.CancelEventArgs))){var t=this.dropDown,i=this.owner;!i&&e instanceof MouseEvent&&(i=e.target),i instanceof HTMLElement&&(t[n.Control._OWNR_KEY]=i),e instanceof MouseEvent&&this.openOnHover&&this.closeOnLeave&&(e=new n.Point(e.pageX-pageXOffset-2,e.pageY-pageYOffset-2)),(0,n.showPopup)(t,e,!1,this.isAnimated),this.onIsDroppedDownChanged(),t.focus()}},t.prototype.hide=function(){this.isDroppedDown&&this.onIsDroppedDownChanging(new n.CancelEventArgs)&&((0,n.hidePopup)(this.dropDown),this.onIsDroppedDownChanged())},t.prototype.onItemClicked=function(e){this.itemClicked.raise(this,e)},t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this.hostElement&&this._enableDisableItems()},t.prototype.onIsDroppedDownChanged=function(t){if(e.prototype.onIsDroppedDownChanged.call(this,t),this.isDroppedDown)this._closing=!0,this._defaultItem=this.selectedItem,this.isRequired=!1,this.selectedIndex=-1,this._enableDisableItems(),this._closing=!1,this.dropDown.focus();else{this.selectedItem||(this.selectedItem=this._defaultItem);var i=this._subMenu;i&&(i.isDroppedDown=!1)}},t.prototype._updateHoverEvents=function(){var e=this.hostElement,t=this.dropDown,i=this.addEventListener.bind(this),n=this.removeEventListener.bind(this),o="mouseleave";n(e,"mouseenter",this._hoverEnterBnd),n(e,o,this._hoverLeaveBnd),n(t,"mouseover",this._hoverOverBnd),n(t,o,this._hoverLeaveBnd),this._openOnHover&&(i(e,"mouseenter",this._hoverEnterBnd),i(t,"mouseover",this._hoverOverBnd),this._closeOnLeave&&(i(e,o,this._hoverLeaveBnd),i(t,o,this._hoverLeaveBnd)))},t.prototype._getSubItems=function(e){var t=this.subItemsPath,i=e&&t?e[t]:null;return(0,n.isArray)(i)&&i.length?i:null},t.prototype._formatMenuItem=function(e,t){var i=t.item;this._getSubItems(t.data)?(0,n.addClass)(i,"wj-subitems"):"-"==i.innerHTML&&(i.innerHTML="",(0,n.addClass)(i,"wj-separator"))},t.prototype._keydown=function(i){if(!i.defaultPrevented){var o=this._getKeyCode(i);if(this.isDroppedDown)switch(o){case n.Key.Enter:case n.Key.Right:if(this._showSubMenu())return void i.preventDefault();break;case n.Key.Left:var r=n.Control.getControl(this.owner);if(r instanceof t){var s=r.dropDown,l=r.selectedIndex;return(l>-1?s.children[l]:s).focus(),void i.preventDefault()}}o==n.Key.Enter&&(this.isDroppedDown?this.selectedIndex>-1&&this._raiseCommand():(this.isDroppedDown=!0,i.preventDefault()))}e.prototype._keydown.call(this,i)},t.prototype._dropDownClick=function(t){if(!t.defaultPrevented&&t.target!=this.dropDown){if(this._clearHover(t),this._showSubMenu())return void t.preventDefault();this.selectedIndex>-1&&this._raiseCommand()}e.prototype._dropDownClick.call(this,t)},t.prototype._showSubMenu=function(){var e=this,i=this._getSubItems(this.selectedItem);if(!i)return null;var o=this.dropDown.children[this.selectedIndex].getBoundingClientRect(),r=new n.Point(o.right,o.top);if(0==o.height)return null;var s=this.rightToLeft||"rtl"==this.dropDown.getAttribute("dir");s&&(r.x=o.left);var l=this._subMenu;l&&(l.isDroppedDown=!1),l=new t(document.createElement("div"),{owner:this.hostElement,itemsSource:i,itemClicked:function(t,i){e.itemClicked.raise(t,i)},formatItem:function(t,i){e.formatItem.raise(t,i)}});var a=this.collectionView,h=l.collectionView;a&&a.filter&&h&&!h.filter&&(h.filter=a.filter),"displayMemberPath,selectedValuePath,isContentHtml,command,commandPath,commandParameterPath,maxDropDownWidth,maxDropDownHeight,dropDownCssClass,isAnimated,subItemsPath,openOnHover,closeOnLeave".split(",").forEach((function(t){l[t]=e[t]}));var c=l.dropDown;return(0,n.setAttribute)(c,"dir",s?"rtl":null),l.show(r),c[n.Control._OWNR_KEY]=this.dropDown,c.focus(),l},t.prototype._raiseCommand=function(e){var i=this.selectedItem,o=this._getSubItems(i),r=this._getCommand(i);if(r&&!o){var s=this._getCommandParm(i);if(!this._canExecuteCommand(r,s))return;this._executeCommand(r,s)}var l=this.headerPath;if(l){var a=new n.Binding(l).getValue(i);a=null==a?"":a.toString(),this.header=this.isContentHtml?a:(0,n.escapeHtml)(a)}if(this.onItemClicked(e),this.containsFocus()){for(var h=this;h&&h.owner;){var c=n.Control.getControl(h.owner);if(!(c instanceof t))break;h=c}var u=h.owner;if(!u&&h.dropDown&&(u=h.dropDown[n.Control._OWNR_KEY]),h.isDroppedDown=!1,h.focus(),!h.containsFocus()&&u instanceof HTMLElement&&u.offsetHeight)if(n.isIE){var d=document.documentElement,p=d.scrollLeft,f=d.scrollTop;u.focus(),d.scrollLeft=p,d.scrollTop=f}else u.focus()}},t.prototype._getCommand=function(e){return(e&&this._cmdPath?e[this._cmdPath]:null)||this._cmd},t.prototype._getCommandParm=function(e){var t=this._cmdParamPath;return e&&t?e[t]:e},t.prototype._executeCommand=function(e,t){e&&!(0,n.isFunction)(e)&&(e=e.executeCommand),(0,n.isFunction)(e)&&e(t)},t.prototype._canExecuteCommand=function(e,t){if(e){var i=e.canExecuteCommand;if((0,n.isFunction)(i))return i(t)}return!0},t.prototype._enableDisableItems=function(){if(this.collectionView&&(this._cmd||this._cmdPath))for(var e=this.collectionView.items,t=0;t<e.length;t++){var i=e[t],o=this._getCommand(i);if(o){var r=this._lbx.hostElement.children[t],s=this._getCommandParm(i);(0,n.toggleClass)(r,"wj-state-disabled",!this._canExecuteCommand(o,s))}}},t.prototype._clearHover=function(e){this._toHover&&clearTimeout(this._toHover),this._toHover=null,t._evtHover=e},t.prototype._isTargetDisabled=function(e){return(0,n.hasClass)(e.target,"wj-state-disabled")},t.prototype._hoverEnter=function(e){var t=this;this._clearHover(e),this._toHover=setTimeout((function(){t._toHover=null,t.isDroppedDown=!0}),n.Control._HOVER_DELAY)},t.prototype._hoverOver=function(e){var t=this;this._clearHover(e),this._toHover=setTimeout((function(){t._toHover=null;var i=t.listBox.indexOf(e.target);i>-1&&!(0,n.hasClass)(e.target,"wj-state-disabled")&&(t.selectedIndex=i,t._subMenu=t._showSubMenu())}),n.Control._HOVER_DELAY)},t.prototype._hoverLeave=function(e){var i=this;this._clearHover(e),this.isDroppedDown&&(this._toHover=setTimeout((function(){var o=(e=t._evtHover)?document.elementFromPoint(e.clientX,e.clientY):null,r=(0,n.closest)(o,".wj-listbox.wj-menu-items"),s=i._subMenu;r||(0,n.contains)(i.hostElement,o,!0)||(i.isDroppedDown=!1,s&&(s.isDroppedDown=!1))}),n.Control._LEAVE_DELAY))},t.prototype._setIsDisabled=function(t){e.prototype._setIsDisabled.call(this,t),this.hostElement.tabIndex=this.isDisabled?-1:this._orgTabIndex},t.prototype._setTabOrder=function(t){e.prototype._setTabOrder.call(this,t),this.hostElement.tabIndex=this.isDisabled?-1:this._orgTabIndex},t}(D),R=function(e){function t(t,i){var o=e.call(this,t)||this;if(o._format="t",o.valueChanged=new n.Event,(0,n.addClass)(o.hostElement,"wj-inputtime"),o.isEditable=!0,o._value=n.DateTime.newDate(),o._min=o._max=null,o._msk=new n._MaskProvider(o._tbx),(0,n.isIE9)()||(o._tbx.type="tel"),"INPUT"==o._orgTag){var r=o._tbx.getAttribute("value");r&&(o.value=n.Globalize.parseDate(r,"HH:mm:ss"))}return o.step=15,o.autoExpandSelection=!0,o.initialize(i),o}return r(t,e),Object.defineProperty(t.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputType",{get:function(){return this._tbx.type},set:function(e){this._tbx.type=(0,n.asString)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){(e=(0,n.asDate)(e,!this.isRequired))&&(e=this._clamp(e)),this._setText(e?n.Globalize.format(e,this.format):"",!0),this.selectedItem&&this.selectedItem.value&&(e=n.DateTime.fromDateTime(e,this.selectedItem.value)),e==this._value||n.DateTime.equals(e,this._value)||(this._value=e,this.onValueChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._tbx.value},set:function(e){e!=this.text&&(this._setText(e,!0),this._commitText())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return this._min},set:function(e){this._min=(0,n.asDate)(e,!0),this.isDroppedDown=!1,this._updateItems()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},set:function(e){this._max=(0,n.asDate)(e,!0),this.isDroppedDown=!1,this._updateItems()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"step",{get:function(){return this._step},set:function(e){e!=this.step&&(this._step=(0,n.asNumber)(e,!0),this.isDroppedDown=!1,this._updateItems())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"format",{get:function(){return this._format},set:function(e){e!=this.format&&(this._format=(0,n.asString)(e),this._tbx.value=n.Globalize.format(this.value,this.format),(0,n.hasItems)(this.collectionView)&&this._updateItems())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mask",{get:function(){return this._msk.mask},set:function(e){this._msk.mask=(0,n.asString)(e)},enumerable:!0,configurable:!0}),t.prototype.onValueChanged=function(e){this.valueChanged.raise(this,e)},t.prototype.onItemsSourceChanged=function(t){e.prototype.onItemsSourceChanged.call(this,t),this._hasCustomItems=null!=this.itemsSource},t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this.hostElement&&(this._msk.refresh(),this._tbx.value=n.Globalize.format(this.value,this.format),this._updateItems())},t.prototype.onSelectedIndexChanged=function(t){if(this.selectedIndex>-1&&!this._settingText){var i=this.value?this.value:n.DateTime.newDate(),o=null!=this.selectedItem.value?this.selectedItem.value:n.Globalize.parseDate(this.text,this.format,this.value);this.value=n.DateTime.fromDateTime(i,o)}e.prototype.onSelectedIndexChanged.call(this,t)},t.prototype._clamp=function(e){return null!=this._min&&this._getTime(e)<this._getTime(this._min)&&(e=n.DateTime.fromDateTime(e,this._min)),null!=this._max&&this._getTime(e)>this._getTime(this._max)&&(e=n.DateTime.fromDateTime(e,this._max)),e},t.prototype._wheel=function(t){if(!t.defaultPrevented&&!this.isDroppedDown&&!this.isReadOnly&&this.containsFocus()&&this.selectedIndex<0&&this.value&&(0,n.isNumber)(this.step)&&this.step>0){var i=n.DateTime.addMinutes(this.value,this.step*(0,n.clamp)(t.deltaY,-1,1));this.value=this._clamp(i),this.selectAll(),t.preventDefault()}e.prototype._wheel.call(this,t)},t.prototype._updateInputSelection=function(t){if(this._delKey)e.prototype._updateInputSelection.call(this,t);else{for(var i=this._tbx.value;t<i.length&&!i[t].match(/[a-z0-9]/i);)t++;(0,n.setSelectionRange)(this._tbx,t,this._tbx.value.length)}},t.prototype._updateItems=function(){if(!this._hasCustomItems){var e=[],t=new Date(2020,0),i=new Date(2020,0,1,23,59,59),o=this.step;if(this.min&&t.setHours(this.min.getHours(),this.min.getMinutes(),this.min.getSeconds()),this.max&&i.setHours(this.max.getHours(),this.max.getMinutes(),this.max.getSeconds()),(0,n.isNumber)(o)&&o>=1)for(var r=t;r<=i;r=n.DateTime.addMinutes(r,o))e.push({value:r,text:n.Globalize.format(r,this.format)});var s=this.value;this._settingText=!0,this.displayMemberPath="text",this.selectedValuePath="text",this.itemsSource=e,this._hasCustomItems=!1,this._settingText=!1,!s&&this.isRequired||(this.value=s)}},t.prototype._getTime=function(e){return 3600*e.getHours()+60*e.getMinutes()+e.getSeconds()},t.prototype._keydown=function(t){if(e.prototype._keydown.call(this,t),!t.defaultPrevented)switch(t.keyCode){case n.Key.Enter:this.isDroppedDown||(this._commitText(),this.selectAll());break;case n.Key.Escape:this.text=n.Globalize.format(this.value,this.format),this.selectAll()}},t.prototype._commitText=function(){if(this.text||this.isRequired){var e=this.value?n.Globalize.format(this.value,this.format):"";if(this.text!=e){var t=this.selectedItem&&this.selectedItem.value?this.selectedItem.value:n.Globalize.parseDate(this.text,this.format,this.value);t?(n.DateTime.sameTime(t,this._clamp(t))||this.onInvalidInput(new n.CancelEventArgs))&&(this.value=n.DateTime.fromDateTime(this.value,t)):this.onInvalidInput(new n.CancelEventArgs)&&(this.text=e)}}else this.value=null},t}(D);(0,n._addCultureInfo)("InputDateTime",{ariaLabels:{tglDate:"Toggle Calendar",tglTime:"Toggle Time List"}});var T=function(e){function t(t,i){var o=e.call(this,t)||this;(0,n.addClass)(o.hostElement,"wj-inputdatetime");var r=n.culture.InputDateTime.ariaLabels;(0,n.setAriaLabel)(o._btn,r.tglDate),(0,n.setAriaLabel)(o._btnTm,r.tglTime),o.value=new Date,o.format="g",o._inputTime=new R(document.createElement("div"),{valueChanged:function(e){var t=o.rangeEnd;o.value=n.DateTime.fromDateTime(o.value,e.value),o.calendar._rngMode()&&t&&(o.rangeEnd=n.DateTime.fromDateTime(t,e.value))},isDroppedDownChanged:function(e){e.listBox.containsFocus()&&o.inputElement.focus(),o._selectAll()}});var s=o.addEventListener.bind(o);o._btnTm=o.hostElement.querySelector('[wj-part="btn-tm"]'),s(o._btnTm,"mousedown",(function(e){o._btnclick(e)})),o._ddDate=o._dropDown;var l=o._ddTime=o._inputTime.dropDown;return s(l,"keydown",o._keydown.bind(o),!0),s(l,"blur",(function(){o._updateFocusState()}),!0),s(l,"click",(function(e){e.defaultPrevented||e.target!=l&&o.hostElement.focus()}),!0),o.initialize(i),o.text=o._getText(),o}return r(t,e),Object.defineProperty(t.prototype,"timeMin",{get:function(){return this._inputTime.min},set:function(e){this._inputTime.min=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeMax",{get:function(){return this._inputTime.max},set:function(e){this._inputTime.max=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeFormat",{get:function(){return this._inputTime.format},set:function(e){this._inputTime.format=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeStep",{get:function(){return this._inputTime.step},set:function(e){this._inputTime.step=e,this._btnTm.style.display=(0,n.isNumber)(e)&&e>0?"":"none"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputTime",{get:function(){return this._inputTime},enumerable:!0,configurable:!0}),t.prototype._fromDateTime=function(e){return e},t.prototype._btnclick=function(t){var i=(0,n.closest)(t.target,"button")==this._btn?this._ddDate:this._ddTime;this._setDropdown(i),e.prototype._btnclick.call(this,t)},t.prototype.dispose=function(){this._setDropdown(this._ddDate),e.prototype.dispose.call(this),this._inputTime.dispose()},t.prototype.refresh=function(t){void 0===t&&(t=!0),this._inputTime.refresh(),e.prototype.refresh.call(this,t)},t.prototype._updateBtn=function(){e.prototype._updateBtn.call(this),this._btnTm&&(this._btnTm.tabIndex=this._btn.tabIndex,this._btnTm.parentElement.style.display=this._btn.style.display)},t.prototype._setDropdown=function(e){if(this._dropDown==e)return!1;this.isDroppedDown&&(this.isDroppedDown=!1);var t=this.dropDownCssClass;return this.dropDownCssClass="",this._dropDown=e,this.dropDownCssClass=t,!0},t.prototype._updateDropDown=function(){var t=this._inputTime;this._dropDown==t.dropDown?(this._commitText(),e.prototype._updateDropDown.call(this),t.isRequired=this.isRequired&&null!=this.value,t.value=this.value,this.isDroppedDown&&t.listBox.showSelection()):e.prototype._updateDropDown.call(this)},t.controlTemplate='<div class="wj-template"><div class="wj-input"><div class="wj-input-group wj-input-btn-visible"><input wj-part="input" type="text" class="wj-form-control"/><span class="wj-input-group-btn"><button wj-part="btn" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-calendar"></span></button><button wj-part="btn-tm" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-clock"></span></button></span></div></div><div wj-part="dropdown" class="wj-content wj-dropdown-panel"></div></div>',t}(x),H=function(e){function t(t,i){var o=e.call(this,t)||this;return o._cssMatch="wj-state-match",o._minLength=2,o._maxItems=6,o._itemCount=0,o._beginsWith=!1,o._delay=n.Control._SEARCH_DELAY,o._query="",o._inCallback=!1,o._srchProps=[],(0,n.addClass)(o.hostElement,"wj-autocomplete"),o._bsCollapse=!1,o.isEditable=!0,o.isRequired=!1,o.listBox.formatItem.addHandler(o._formatListItem,o),o._itemsSourceFnCallbackBnd=o._itemSourceFunctionCallback.bind(o),o.initialize(i),o}return r(t,e),Object.defineProperty(t.prototype,"minLength",{get:function(){return this._minLength},set:function(e){this._minLength=(0,n.asNumber)(e,!1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"beginsWithSearch",{get:function(){return this._beginsWith},set:function(e){this._beginsWith=(0,n.asBoolean)(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxItems",{get:function(){return this._maxItems},set:function(e){this._maxItems=(0,n.asNumber)(e,!1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"delay",{get:function(){return this._delay},set:function(e){this._delay=(0,n.asNumber)(e,!1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"searchMemberPath",{get:function(){return this._srchProp},set:function(e){this._srchProp=(0,n.asString)(e),this._srchProps=e?e.trim().split(/\s*,\s*/):[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemsSourceFunction",{get:function(){return this._itemsSourceFn},set:function(e){this._itemsSourceFn=(0,n.asFunction)(e),(0,n.isFunction)(this._itemsSourceFn)&&this.itemsSourceFunction(this.text,this.maxItems,this._itemsSourceFnCallbackBnd)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cssMatch",{get:function(){return this._cssMatch},set:function(e){this._cssMatch=(0,n.asString)(e)},enumerable:!0,configurable:!0}),t.prototype._keydown=function(t){if(!t.defaultPrevented&&this.isDroppedDown)switch(t.keyCode){case n.Key.Up:case n.Key.Down:this.selectAll()}e.prototype._keydown.call(this,t)},t.prototype._setText=function(e){var t=this;if(!(this._inCallback||this._composing||this._settingText)){if(this.selectedIndex>-1&&this.getDisplayText()!=e&&(this._settingText=!0,this.selectedIndex=-1,this._settingText=!1),e!=this._oldText){var i=this._tbx;i.value!=e&&(i.value=e),this._oldText=e,this.onTextChanged();var o=this.collectionView;if(!e&&o){(this._query||this.selectedIndex<0)&&(this.isDroppedDown=!1),this._query=this._rxHighlight=null,o.filter=null;var r=this.itemsSourceFunction;return void((0,n.isFunction)(r)&&(this.isDroppedDown=!1,r(this._query,this.maxItems,this._itemsSourceFnCallbackBnd)))}}this._toSearch&&clearTimeout(this._toSearch),e!=this.getDisplayText()&&(this._toSearch=setTimeout((function(){t._toSearch=null;var e=t.text.trim();if(e.length>=t._minLength&&e!=t._query){t._query=e,e=(0,n.escapeRegExp)(e);var i=(0,n.escapeHtml)(e),o=t.caseSensitiveSearch?"":"i";t._beginsWith||(o+="g"),t._rxSrch=t._beginsWith?new RegExp("^"+e+".*",o):new RegExp("(?=.*"+e.replace(/ /g,")(?=.*")+")",o),t._rxHighlight=new RegExp("("+i.replace(/\s+/g,"|")+")",o);var r=t.itemsSourceFunction;(0,n.isFunction)(r)?r(t._query,t.maxItems,t._itemsSourceFnCallbackBnd):t._updateItems()}}),this._delay))}},t.prototype._itemSourceFunctionCallback=function(e){this._inCallback=!0;var t=(0,n.asCollectionView)(e||[]);if(t.moveCurrentToPosition(-1),this.itemsSource=t,this._inCallback=!1,this.containsFocus()){var i=this._tbx,o=i.selectionStart,r=i.selectionEnd,s=this.collectionView;this.isDroppedDown=null!=s&&s.items.length>0,(0,n.setSelectionRange)(i,o,r),this.refresh()}},t.prototype.onIsDroppedDownChanged=function(t){if(e.prototype.onIsDroppedDownChanged.call(this,t),this.containsFocus()&&!this.isTouching){var i=this.collectionView;if(this.selectedIndex<0&&i){var o=i.items,r=this.text;1==o.length&&o[0]==r?this.selectedIndex=0:(0,n.setSelectionRange)(this._tbx,r.length)}}this._query=""},t.prototype._updateItems=function(){var e=this.collectionView;if(e){this._inCallback=!0,e.beginUpdate(),this._itemCount=0,e.filter=this._filter.bind(this),e.moveCurrentToPosition(-1),e.endUpdate(),this._inCallback=!1;var t=e.items.length,i=this._tbx,o=i.selectionStart,r=i.selectionEnd;if(this.isDroppedDown=t>0&&this.containsFocus(),t||this.isEditable||(this.selectedIndex=-1),1==t&&this.selectedIndex<0){var s=this._getItemText(e.items[0],!1),l=i.value;this.caseSensitiveSearch||(s=s.toLowerCase(),l=l.toLowerCase()),s==l&&(this.selectedIndex=0)}this.isDroppedDown&&(0,n.setSelectionRange)(i,o,r),this.refresh()}},t.prototype._filter=function(e){if(this._itemCount>=this._maxItems)return!1;var t=[this._getItemText(e,!1)];this._srchProps&&this._srchProps.forEach((function(i){var n=e[i];null!=n&&t.push(n)})),this.isContentHtml&&(t=t.map((function(e){return e.replace(/(<[^>]*>|&[^;]*;)/g,"")})));for(var i=0;i<t.length;i++)if(this._rxSrch.test(t[i]))return this._itemCount++,!0;return!1},t.prototype._getItemText=function(e,t){var i=e?e.toString():"",n=t&&this.headerPath?this._pathHdr:this._lbx._pathDisplay;return n&&(i=null!=(i=n.getValue(e))?i.toString():""),i},t.prototype._formatListItem=function(e,t){var i=this;this._cssMatch&&this._rxHighlight&&(t.item.innerHTML=t.item.innerHTML.replace(this._rxHighlight,(function(e,t,n,o){return i._enclosed(o,n,"<",">")||i._enclosed(o,n,"&",";")?e:'<span class="'+i._cssMatch+'">'+e+"</span>"})))},t.prototype._enclosed=function(e,t,i,n){for(var o=t;o>=0&&e[o]!=n;o--)if(e[o]==i)for(var r=t;r<e.length&&e[r]!=i;r++)if(e[r]==n)return!0;return!1},t}(D),j=function(e){function t(t,i){var o=e.call(this,t)||this;return o._selItems=[],o._maxSelItems=null,o._lastInputValue="",o._selPath=new n.Binding(null),o._notAddItm=!1,o.selectedItemsChanged=new n.Event,(0,n.addClass)(o.hostElement,"wj-multi-autocomplete"),o._wjTpl=o.hostElement.querySelector(".wj-template"),o._wjInput=o.hostElement.querySelector(".wj-input"),o.showDropDownButton=!1,o.initialize(i),o.addEventListener(o.hostElement,"keyup",o._keyup.bind(o),!0),o.addEventListener(window,"resize",o._adjustInputWidth.bind(o)),o.addEventListener(o._tbx,"focus",(function(){o._itemOff()})),o._addHelperInput(),o._initSeltems(),o.listBox.itemsChanged.addHandler((function(){return o.selectedIndex=-1})),o._refreshHeader(),o._updateTabIndex(),o}return r(t,e),Object.defineProperty(t.prototype,"showDropDownButton",{set:function(e){this._showBtn=!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxSelectedItems",{get:function(){return this._maxSelItems},set:function(e){this._maxSelItems!=e&&(this._maxSelItems=(0,n.asNumber)(e,!0),this._updateMaxItems(),this._refreshHeader(),this._clearSelIndex())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedMemberPath",{get:function(){return this._selPath.path},set:function(e){(e=(0,n.asString)(e))!==this.selectedMemberPath&&(this._selPath.path=e,this._initSeltems(),this._refreshHeader(),this.onSelectedItemsChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedItems",{get:function(){return this._selItems},set:function(e){if(this._selItems=(0,n.asArray)(e),this.selectedMemberPath&&""!==this.selectedMemberPath&&this._selItems)for(var t=0;t<this._selItems.length;t++){var i=this._selItems[t];this._setSelItem(i,!1)}this._updateMaxItems(),this.onSelectedItemsChanged(),this._refreshHeader(),this._clearSelIndex()},enumerable:!0,configurable:!0}),t.prototype.onSelectedItemsChanged=function(e){this.selectedItemsChanged.raise(this,e)},t.prototype.onIsDroppedDownChanged=function(t){!this.isDroppedDown&&this.selectedIndex>-1&&!this._notAddItm&&this._addItem(!0),this._notAddItm=!1,e.prototype.onIsDroppedDownChanged.call(this,t)},t.prototype.refresh=function(t){void 0===t&&(t=!0),e.prototype.refresh.call(this,t),this.hostElement&&(this._initSeltems(),this.isDroppedDown||this._refreshHeader())},t.prototype._keydown=function(t){if(!this.isReadOnly){if(!t.defaultPrevented)switch(t.keyCode){case n.Key.Back:this._lastInputValue=this._tbx.value;break;case n.Key.Enter:this._itemOff(),this._addItem(!0),(0,n.isIE)()&&(0,n.setSelectionRange)(this._tbx,this._tbx.textContent.length,this._tbx.textContent.length);break;case n.Key.Tab:this.isDroppedDown?(this._addItem(!1),this._tbx.value="",this._lbx.selectedIndex=-1,t.preventDefault()):this._updateFocus();break;case n.Key.Space:if(""!==this._tbx.value)return;this.isDroppedDown||this._tbx.disabled||(this.isDroppedDown=!0,this._clearSelIndex());break;case n.Key.Escape:this.isDroppedDown&&(this._notAddItm=!0);break;case n.Key.Left:this._itemOn(!this.rightToLeft);break;case n.Key.Right:this._itemOn(!!this.rightToLeft);break;case n.Key.Up:case n.Key.Down:var i=(0,n.getActiveElement)();if(t.altKey){if(this._tbx==i)return this.isDroppedDown=!this.isDroppedDown,this.isDroppedDown||this._tbx.focus(),void t.preventDefault()}else if(this._tbx!==i)return;default:if(t.keyCode===n.Key.Back||t.keyCode===n.Key.Delete)return;this._itemOff(),null!=this._maxSelItems&&this._selItems.length>=this._maxSelItems&&t.preventDefault()}this._tbx.disabled||e.prototype._keydown.call(this,t)}},t.prototype._updateState=function(){e.prototype._updateState.call(this),this._wjTpl&&((0,n.hasClass)(this.hostElement,"wj-state-focused")||this._itemOff())},t.prototype._keyup=function(e){if(!this.isReadOnly&&!e.defaultPrevented)switch(e.keyCode){case n.Key.Back:0===this._tbx.value.length&&0===this._lastInputValue.length&&this._delItem(!1);break;case n.Key.Delete:this._delItem(!0)}},t.prototype._addHelperInput=function(){var e=document.createElement("input");e.type="text",e.tabIndex=-1,e.className="wj-token-helper",e.readOnly=!0,this._wjTpl.insertBefore(e,this._wjInput),this._helperInput=e},t.prototype._refreshHeader=function(){for(var e=this.hostElement.querySelectorAll(".wj-token"),t=0;t<e.length;t++)this._wjTpl.removeChild(e[t]);var i=this.selectedItems;if(i&&0!==i.length){for(t=0;t<i.length;t++)this._insertToken(i[t]);this._wjInput.style.cssFloat=this.rightToLeft?"right":"left",this._adjustInputWidth()}else this._wjInput.style.cssFloat=this.rightToLeft?"right":"left",this._adjustInputWidth()},t.prototype._insertToken=function(e){var t=this._getItemText(e,!0);this.isContentHtml||(t=(0,n.escapeHtml)(t)),this._wjTpl.insertBefore(this._createItem(t),this._wjInput)},t.prototype._updateMaxItems=function(){null!=this._maxSelItems&&this._selItems&&this._selItems.length>this._maxSelItems&&(this._selItems=this._selItems.slice(0,this._maxSelItems))},t.prototype._updateFocus=function(){var e=this,i=this._wjTpl.querySelector("."+t._clsActive);i?((0,n.removeClass)(i,t._clsActive),setTimeout((function(){e._tbx.focus()}))):this._clearSelIndex()},t.prototype._addItem=function(e){this.selectedItems.indexOf(this.selectedItem)>-1?this._clearSelIndex():this.selectedIndex>-1&&(this._updateSelItems(this.selectedItem,!0),this._refreshHeader(),e&&this._clearSelIndex(),this._disableInput(!0))},t.prototype._delItem=function(e){var i,n,o=this._wjTpl.querySelector("."+t._clsActive),r=!1;e&&!o||(o?(n=this._getItemIndex(o))>-1&&(i=this._selItems[n],r=!0):this._selItems.length>0&&(i=this._selItems[this._selItems.length-1],r=!0),r&&(this._updateSelItems(i,!1),this._refreshHeader(),this._clearSelIndex(),this._disableInput(!1)),this._tbx.focus())},t.prototype._updateSelItems=function(e,t){if(t){if(this._selItems&&0!==this._selItems.length||(this._selItems=[]),null!=this._maxSelItems&&this._selItems.length>=this._maxSelItems)return;this._selItems.push(e)}else{var i=this._selItems.indexOf(e);this._selItems.splice(i,1)}this._hasSelectedMemeberPath()&&this._setSelItem(e,t),this.onSelectedItemsChanged()},t.prototype._createItem=function(e){var i=this,o=document.createElement("div"),r=document.createElement("span"),s=document.createElement("a");return o.appendChild(r),o.appendChild(s),o.className="wj-token",r.className="wj-token-label",r.innerHTML=e,s.className="wj-token-close",s.href="#",s.tabIndex=-1,s.text="\xd7",o.style.cssFloat=this.rightToLeft?"right":"left",this.addEventListener(o,"click",(function(e){i._helperInput.focus();var r=i._wjTpl.querySelector("."+t._clsActive);r&&(0,n.removeClass)(r,t._clsActive),(0,n.addClass)(o,t._clsActive),e.stopPropagation(),e.preventDefault()})),this.addEventListener(s,"click",(function(e){if(!i.isReadOnly){var t=i._getItemIndex(o);if(t>-1){var n=i._selItems[t];i._updateSelItems(n,!1)}i._wjTpl.removeChild(o),i._adjustInputWidth(),i._disableInput(!1),i._tbx.focus(),e.stopPropagation(),e.preventDefault()}})),o},t.prototype._itemOn=function(e){var i,o,r,s=(0,n.getActiveElement)();if((this._tbx!=s||0===this._tbx.value.length)&&0!==(i=this._wjTpl.querySelectorAll(".wj-token")).length)if(o=this._wjTpl.querySelector("."+t._clsActive),r=this._getItemIndex(o),e){if(0===r)return;-1===r?((0,n.addClass)(i[i.length-1],t._clsActive),this._helperInput.focus()):((0,n.removeClass)(o,t._clsActive),(0,n.addClass)(i[r-1],t._clsActive),this._helperInput.focus())}else if(!e){if(-1===r)return;r!==i.length-1?((0,n.removeClass)(o,t._clsActive),(0,n.addClass)(i[r+1],t._clsActive),this._helperInput.focus()):((0,n.removeClass)(o,t._clsActive),this._tbx.focus())}},t.prototype._itemOff=function(){var e=this._wjTpl.querySelector("."+t._clsActive);e&&(0,n.removeClass)(e,t._clsActive)},t.prototype._initSeltems=function(){if(this.selectedMemberPath){this._selItems.splice(0,this._selItems.length);var e=this.collectionView;if(e)for(var t=0;t<e.sourceCollection.length;t++)this._getSelItem(t)&&this._selItems.push(e.sourceCollection[t])}},t.prototype._getSelItem=function(e){var t=this.collectionView,i=t?t.sourceCollection[e]:null;return!(!(0,n.isObject)(i)||!this.selectedMemberPath)&&this._selPath.getValue(i)},t.prototype._setSelItem=function(e,t){this.itemsSource,(0,n.isObject)(e)&&this._selPath.getValue(e)!=t&&this._selPath.setValue(e,t)},t.prototype._clearSelIndex=function(){this.selectedIndex=-1},t.prototype._hasSelectedMemeberPath=function(){return this.selectedMemberPath&&""!==this.selectedMemberPath},t.prototype._disableInput=function(e){null!=this._maxSelItems&&(this._selItems.length<this._maxSelItems?(this._tbx.disabled=!1,this._tbx.focus()):(this._tbx.disabled=!0,this.hostElement.focus()))},t.prototype._adjustInputWidth=function(){this._tbx.style.width="60px";var e,t=(0,n.getElementRect)(this.hostElement),i=(0,n.getElementRect)(this._tbx),o=getComputedStyle(this._tbx),r=parseInt(o.paddingLeft,10),s=parseInt(o.paddingRight,10);e=this.rightToLeft?i.left+i.width-t.left-r-s-8:t.left+t.width-i.left-r-s-8,this._tbx.style.width=e+"px"},t.prototype._getItemIndex=function(e){for(var t=this.hostElement.querySelectorAll(".wj-token"),i=0;i<t.length;i++)if(e===t[i])return i;return-1},t.prototype._setIsDisabled=function(t){e.prototype._setIsDisabled.call(this,t),this._updateTabIndex()},t.prototype._setTabOrder=function(e){this._orgTabIndex=e,this._updateTabIndex()},t.prototype._updateTabIndex=function(){var e=this.hostElement;this._tbx.tabIndex=this.isDisabled?-1:this._orgTabIndex,e.tabIndex=-1},t._clsActive="wj-token-active",t}(H);(0,n._registerModule)("wijmo.input",o)},6890:(e,t,i)=>{i.d(t,{x:()=>s});var n=i(728),o=i(65043),r=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),s=function(e){function t(i,r,s){var l=e.call(this,i)||this;l._objPropHash={},l._isMounted=!1,l._mountedCBs=[],l._hostRef=function(e){return l._hostRefValue=e},l._beforeRender=new n.Event,l._afterRender=new n.Event,l._beforeWillUnmount=new n.Event,l._afterWillUnmount=new n.Event,l._beforeDidUpdate=new n.Event,l._afterDidUpdate=new n.Event,t._reactMajorVersion||(t._reactMajorVersion=parseInt(o.version)),l.props=i,l.controlType=r;for(var a=0,h=s&&s.objectProps||[];a<h.length;a++){var c=h[a];l._objPropHash[c]=!0}return l}return r(t,e),t.prototype.render=function(){this._onBeforeRender();var e=this._renderImpl();return this._onAfterRender(),e},t.prototype.componentDidMount=function(){var e=this;if(this._isChild()){var i=this.props[t._propsParent];i&&i._mountedCB((function(){e._setParent(i)}))}else this._prepareControl();return this.control},t.prototype.componentWillUnmount=function(){this._onBeforeWillUnmount(),this._siblingInsertedEH&&this._getElement().removeEventListener("DOMNodeInserted",this._siblingInsertedEH);var e=this.control;if(e)if(this._isChild()){var t=this._getParentProp();if(t){var i=this.parent.control[t];if((0,n.isArray)(i)){var o=i.indexOf(e);o>-1&&i.splice(o,1)}}}else e instanceof n.Control&&setTimeout((function(){e.hostElement&&(e._orgOuter=null,e.dispose())}));this._onAfterWillUnmount()},t.prototype.shouldComponentUpdate=function(e){return!0},t.prototype.componentDidUpdate=function(e){this._onBeforeDidUpdate();var t=this.control;this._copy(t,this.props,e),this._onAfterDidUpdate()},t.prototype._mountedCB=function(e){this._isMounted?e():this._mountedCBs.push(e)},t.prototype._renderImpl=function(){var e={};e[t._propsParent]=this;var i=o.Children.map(this.props.children,(function(t){return t&&o.cloneElement(t,e)})),n={ref:this._hostRef};return this._isChild()&&(n.style={display:"none"}),o.createElement("div",n,i)},t.prototype._onBeforeRender=function(e){this._beforeRender.raise(this,e)},t.prototype._onAfterRender=function(e){this._afterRender.raise(this,e)},t.prototype._onBeforeWillUnmount=function(e){this._beforeWillUnmount.raise(this,e)},t.prototype._onAfterWillUnmount=function(e){this._afterWillUnmount.raise(this,e)},t.prototype._onBeforeDidUpdate=function(e){this._beforeDidUpdate.raise(this,e)},t.prototype._onAfterDidUpdate=function(e){this._afterDidUpdate.raise(this,e)},t.prototype._createControl=function(){var e=this._isChild()?this._isParentInCtor()?this.parent.control:void 0:this._getElement();return new this.controlType(e)},t.prototype._prepareControl=function(){var e=this._getElement(),i=this.props;e&&!this._isChild()&&t._copyAttrs(e,i,n.Control._rxInputAtts);var o=this.control=this._createControl(),r=o instanceof n.Control,s=t;this._siblingId||(null==this.constructor[s._typeSiblingIdProp]&&(this.constructor[s._typeSiblingIdProp]=++s._siblingDirId+""),this._siblingId=this.constructor[s._typeSiblingIdProp]),e.setAttribute(s._typeSiblingIdProp,this._siblingId);var l={};for(var a in i){var h=i[a];this._ignoreProp(a)||(0,n.isUndefined)(h)||(a in o?l[a]=h:this._setHostAttribute(e,a,h))}r?o.initialize(l):this._copy(o,l,null,!0),this._isMounted=!0;var c=this._mountedCBs;this._mountedCBs=[];for(var u=0,d=c;u<d.length;u++)(0,d[u])();(0,n.isFunction)(i.initialized)&&i.initialized(o)},t.prototype._initParent=function(){var e=this._getParentProp();if(e){var t=this.parent.control,i=t[e];if((0,n.isArray)(i)){var o=this._getSiblingIndex();(o<0||o>=i.length)&&(o=i.length),i.splice(o,0,this.control),this._siblingInsertedEH=this._siblingInserted.bind(this),this._getElement().addEventListener("DOMNodeInserted",this._siblingInsertedEH)}else t[e]=this.control}},t.prototype._setParent=function(e){if(e!==this.parent){if(this.parent)throw"Wijmo child component is already attached to a different parent.";this.parent=e,this._prepareControl(),this._initParent()}},t.prototype._isChild=function(){return null!=this._parentProp||null!=this._parentInCtor},t.prototype._isParentInCtor=function(){return!0===this._parentInCtor},t.prototype._getParentProp=function(){return this.props.wjProperty||this._parentProp},t.prototype._getSiblingIndex=function(){var e=this._getElement(),i=e.parentElement;if(!i)return-1;for(var n=i.childNodes,o=-1,r=this._siblingId,s=0;s<n.length;s++){var l=n[s];if(1==l.nodeType&&l.getAttribute(t._typeSiblingIdProp)==r&&(++o,l===e))return o}return-1},t.prototype._siblingInserted=function(e){if(e.target===this._getElement()){var t=this._getSiblingIndex(),i=this.control,n=this.parent.control[this._getParentProp()],o=n.indexOf(i);t>=0&&o>=0&&t!==o&&(n.splice(o,1),t=Math.min(t,n.length),n.splice(t,0,i))}},t.prototype._copy=function(e,t,i,o){if(void 0===o&&(o=!1),e&&t){var r,s=e===this.control;for(var l in t)if(!this._ignoreProp(l)||!s){var a=t[l];if(l in e){if(this._isEvent(e,l))o&&(0,n.isFunction)(a)&&e[l].addHandler(a);else if(!i||!this._sameValue(i[l],a))if(null==a)e[l]=a;else if((0,n.isPrimitive)(a)||(0,n.isFunction)(a)||this._objPropHash[l]&&e===(r||(r=this.control)))e[l]=a;else if((0,n.isArray)(a)&&(0,n.isArray)(e[l])){var h=e[l],c=a;if(c.length==h.length)for(var u=0;u<c.length;u++)this._copy(h[u],c[u])}else(0,n.isObject)(a)&&this._copy(e[l],t[l])}else this._setHostAttribute(e.hostElement,l,t[l])}}},t.prototype._setHostAttribute=function(e,t,i){if(e)switch(t){case"className":var o=this._appliedClassName;o!==i&&((0,n.removeClass)(e,o),(0,n.addClass)(e,i),this._appliedClassName=i);break;case"style":(0,n.setCss)(e,i);break;default:null!=e[t]?e[t]=i:"string"==typeof i&&"$"!==t[0]&&e.setAttribute(t,i)}},t.prototype._sameValue=function(e,t){return e==t||n.DateTime.equals(e,t)},t.prototype._isEvent=function(e,t){var i=e&&e[t];return null!=i&&i instanceof n.Event},t.prototype._getElement=function(){return this._hostRefValue},t.prototype._ignoreProp=function(e){return"children"===e},t._copyAttrs=function(e,t,i){if(e)for(var n in t)n.match(i)&&e.setAttribute(n,t[n])},t.isInStrictMode=function(e){return!!(e.hasOwnProperty("_reactInternalFiber")&&1&e._reactInternalFiber.mode)},t._propsParent="$parent",t._typeSiblingIdProp="_wjSiblingIdProp",t._siblingDirId=0,t}(o.Component)},60663:()=>{}}]);
//# sourceMappingURL=285.89138d16.chunk.js.map