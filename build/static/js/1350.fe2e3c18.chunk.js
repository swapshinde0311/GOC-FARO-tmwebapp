"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[1350],{31350:(e,t,s)=>{s.r(t),s.d(t,{default:()=>j});var o=s(65043),r=s(69062),a=s(40854),n=s.n(a),i=s(72067),l=s(9256),c=s(46100),d=s(97508),h=(s(38726),s(65187)),u=s(43503),m=s(72711),C=s(67907),p=s(78374),g=s(70579);function f(e){let{modCustomerstockTransfer:t,CustomerAgreementItems:s,onFieldChange:o,listOptions:r,handleCellDataEdit:a,handleDeleteAssociation:n,handleAddAssociation:i,handleRowSelectionChange:l,selectedAssociations:c,validationErrors:d}=e;const[h]=(0,C.useTranslation)(),u=(e,t)=>(0,g.jsx)(m.Select,{className:"selectDropwdown",value:s[e.rowIndex][e.field],fluid:!0,options:t,onChange:t=>a(t,e),indicator:"required",reserveSpace:!1,search:!0,noResultsMessage:h("noResultsMessage")}),f=e=>(0,g.jsx)(m.Input,{fluid:!0,value:s[e.rowIndex][e.field],onChange:t=>a(t,e),reserveSpace:!1});return(0,g.jsx)(C.TranslationConsumer,{children:(e,a)=>(0,g.jsxs)("div",{className:"detailsContainer",children:[(0,g.jsxs)("div",{className:"row",children:[(0,g.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,g.jsx)(m.Input,{fluid:!0,value:t.Code,indicator:"required",onChange:e=>o("Code",e),label:e("CustomerAgreement_TransferReferenceCode"),reserveSpace:!1,error:e(d.Code)},a)}),(0,g.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,g.jsx)(m.Select,{fluid:!0,placeholder:"Select",indicator:"required",value:t.LenderShareholderCode,label:e("ExchangeAgreementDetails_lenderShareHolder"),options:r.shareholders,onChange:e=>o("LenderShareholderCode",e),reserveSpace:!1,search:!0,onResultsMessage:e("noResultsMessage"),error:e(d.LenderShareholderCode)})}),(0,g.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,g.jsx)(m.Select,{fluid:!0,indicator:"required",label:e("CustomerAgreement_FromCustomerCode"),value:null===t.LenderCustomerCode?"":t.LenderCustomerCode,onChange:e=>o("LenderCustomerCode",e),options:r.LendercustomerOptions,reserveSpace:!1,error:e(d.LenderCustomerCode)})}),(0,g.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,g.jsx)(m.Select,{fluid:!0,placeholder:"Select",value:t.RequestorShareholderCode,label:e("CustomerAgreement_ToShareholder"),options:r.shareholders,onChange:e=>o("RequestorShareholderCode",e),reserveSpace:!1,search:!0,onResultsMessage:e("noResultsMessage"),indicator:"required",error:e(d.RequestorShareholderCode)})}),(0,g.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,g.jsx)(m.Select,{fluid:!0,indicator:"required",placeholder:"Select",label:e("CustomerAgreement_ToCustomer"),value:null===t.RequestorCustomerCode?"":t.RequestorCustomerCode,onChange:e=>o("RequestorCustomerCode",e),options:r.RequestercustomerOptions,reserveSpace:!1,error:e(d.RequestorCustomerCode)})})]}),(0,g.jsxs)("div",{className:"row compartmentRow",children:[(0,g.jsxs)("h3",{children:[e("CustomerAgreement_TransferDetails")," "]}),(0,g.jsx)("div",{className:"col",children:(0,g.jsxs)("div",{className:"compartmentIconContainer",children:[(0,g.jsxs)("div",{onClick:i,className:"compartmentIcon",children:[(0,g.jsx)("div",{children:(0,g.jsx)(m.Icon,{root:"common",name:"badge-plus",size:"medium"})}),(0,g.jsx)("div",{className:"margin_l10",children:(0,g.jsx)("h5",{className:"font14",children:e("TrailerInfo_Add")})})]}),(0,g.jsxs)("div",{onClick:n,className:"compartmentIcon margin_l30",children:[(0,g.jsx)("div",{children:(0,g.jsx)(m.Icon,{root:"common",name:"delete",size:"medium"})}),(0,g.jsx)("div",{className:"margin_l10",children:(0,g.jsx)("h5",{className:"font14",children:e("TrailerInfo_Delete")})})]})]})}),(0,g.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,g.jsx)("div",{className:"col-12 detailsTable",children:(0,g.jsxs)(p.bQ,{data:s,selectionMode:"multiple",selection:c,onSelectionChange:l,scrollable:!0,scrollHeight:"320px",children:[(0,g.jsx)(p.bQ.Column,{className:"compColHeight colminWidth",field:"BaseProductCode",header:e("ExchangeAgreementDetailsItem_Product"),editFieldType:"text",editable:!0,customEditRenderer:e=>u(e,r.baseProductOptions)},"BaseProductCode"),(0,g.jsx)(p.bQ.Column,{className:"compColHeight colminWidth",field:"Quantity",header:e("ExchangeAgreementDetailsItem_Qty"),editable:!0,editFieldType:"text",renderer:e=>(e=>{const{value:t}=e;return"number"===typeof t?t.toLocaleString():t})(e),customEditRenderer:f},"Quantity"),(0,g.jsx)(p.bQ.Column,{className:"compColHeight colminWidth",field:"QuantityUOM",header:e("ExchangeAgreementDetailsItem_UOM"),editable:!0,editFieldType:"text",customEditRenderer:e=>u(e,r.quantityUOMOptions)},"QuantityUOM")]})})})]})]})})}f.defaultProps={listOptions:{quantityUOMOptions:[],baseProductOptions:[],customerOptions:[],LendercustomerOptions:[],RequestercustomerOptions:[],shareholders:[]}};var S=s(93779),v=s(40252),y=s(53536),A=s.n(y),R=s(80312),E=s(44192),k=s(62900);class D extends o.Component{constructor(){super(...arguments),this.state={customerstockTransfer:A().cloneDeep(c.zW),validationErrors:r.Th(E.Gm),modCustomerstockTransfer:{},CustomerAgreementItems:[],isReadyToRender:!1,saveEnabled:!1,LendercustomerOptions:[],RequestercustomerOptions:[],shareholders:this.getShareholders(),baseProductOptions:[],quantityUOMOptions:[],selectedAssociations:[],showAuthenticationLayout:!1,tempCustomerstockTransfer:{}},this.handleChange=(e,t)=>{try{const s=A().cloneDeep(this.state.modCustomerstockTransfer);s[e]=t,this.setState({modCustomerstockTransfer:s}),"LenderShareholderCode"===e&&this.getCustomerList(t,"LenderShareholderCode"),"RequestorShareholderCode"===e&&this.getCustomerList(t,"RequestorShareholderCode");const o=A().cloneDeep(this.state.validationErrors);void 0!==E.Gm[e]&&(o[e]=r.jr(E.Gm[e],t),this.setState({validationErrors:o}))}catch(s){console.log("CustomerstocktransferDetailsComposite:Error occured on handleChange",s)}},this.handleCellDataEdit=(e,t)=>{try{let s=A().cloneDeep(this.state.CustomerAgreementItems);s[t.rowIndex][t.field]=e,this.setState({CustomerAgreementItems:s})}catch(s){console.log("errror in handlecelledit",s)}},this.handleAssociationSelectionChange=e=>{this.setState({selectedAssociations:e})},this.handleAddAssociation=()=>{try{let e=A().cloneDeep(this.state.CustomerAgreementItems),t={BaseProductCode:"",Quantity:0,QuantityUOM:""};e.push(t),this.setState({CustomerAgreementItems:e,selectedAssociations:[]})}catch(e){console.log("CustomerstockTransferDetailsComposite:Error occured on handleAddAssociation",e)}},this.handleDeleteAssociation=()=>{try{try{if(null!=this.state.selectedAssociations&&this.state.selectedAssociations.length>0&&this.state.CustomerAgreementItems.length>0){let e=A().cloneDeep(this.state.CustomerAgreementItems);this.state.selectedAssociations.forEach(((t,s)=>{e=e.filter(((e,s)=>e.BaseProductCode!==t.BaseProductCode))})),this.setState({CustomerAgreementItems:e})}this.setState({selectedAssociations:[]})}catch(e){console.log("customerstocltransferDetailsComposite:Error occured on handleDeleteAssociation",e)}}catch(e){console.log("error in handle Delete Association",e)}},this.handleReset=()=>{try{const e=A().cloneDeep(this.state.customerstockTransfer);this.setState({modCustomerstockTransfer:{...e}})}catch(e){console.log("CustomerStocktransferDetailsComposite:Error occured on handleReset",e)}},this.saveCustomerStockTransfer=()=>{try{this.setState({saveEnabled:!1});let e=A().cloneDeep(this.state.tempCustomerstockTransfer);e.TransferDate=new Date,e.CustomerAgreementItems=this.fillDetails(this.state.CustomerAgreementItems),this.CreateCustomerStockTransfer(e)}catch(e){console.log("CustomerstockTransferDetailsComposite : Error in saveBaseProduct")}},this.handleSave=()=>{try{let e=A().cloneDeep(this.state.modCustomerstockTransfer);if(e.TransferDate=new Date,e.CustomerAgreementItems=this.fillDetails(this.state.CustomerAgreementItems),this.setState({saveEnabled:!1}),this.validateSave(e)){let t=A().cloneDeep(e);t.CustomerAgreementItems=this.fillDetails(this.state.CustomerAgreementItems);let s=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showAuthenticationLayout:s,tempCustomerstockTransfer:t},(()=>{!1===s&&this.saveCustomerStockTransfer()}))}else this.setState({saveEnabled:!0})}catch(e){console.log("error in handleSave",e)}},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentDidMount(){try{r.pJ(this.props.userDetails.EntityResult.IsArchived),this.getCustomerStockTransfer(this.props.selectedRow),this.getBaseProducts(),this.GetUOMList()}catch(e){console.log("customertransferDetailsComposite:Error occured on componentDidMount",e)}}componentWillReceiveProps(e){try{""!==this.state.customerstockTransfer.Code&&void 0===e.selectedRow.CustomerAgreement_TransferReferenceCode&&this.props.tokenDetails.tokenInfo===e.tokenDetails.tokenInfo&&this.getCustomerStockTransfer(e.selectedRow)}catch(t){console.log("customertransferDetailsComposite:Error occured on componentWillReceiveProps",t)}}getShareholders(){return r.Zj(this.props.userDetails.EntityResult.ShareholderList)}getCustomerList(e,t){try{void 0!==e&&""!==e&&n()(i.E6k+"?ShareholderCode="+e+"&TransportationType=",r.Jm(this.props.tokenDetails.tokenInfo)).then((s=>{var o=s.data;if(!0===o.IsSuccess)if(Array.isArray(o.EntityResult)){let s=o.EntityResult.filter((t=>t.ShareholderCode===e));if("RequestorShareholderCode"===t){if(s.length>0){let e=s[0].CustomerDestinationsList,t=[];null!==e&&(t=Object.keys(e),t=r.Zj(t)),this.setState({RequestercustomerOptions:t})}}else if("LenderShareholderCode"===t){if(s.length>0){let e=s[0].CustomerDestinationsList,t=[];null!==e&&(t=Object.keys(e),t=r.Zj(t)),this.setState({LendercustomerOptions:t})}}else console.log("CustomerStockTransferDetailsComposite:no customers identified for shareholder")}else console.log("CustomerStockTransferDetailsComposite:customerdestinations not identified for shareholder")}))}catch(s){console.log("error in requestorcustomerlist",s)}}getBaseProducts(){try{n()(i.Odh+"?TerminalCode=",r.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){let e=r.Zj(t.EntityResult);this.setState({baseProductOptions:e})}}else console.log("Error in getBaseProducts:",t.ErrorList)})).catch((e=>{console.log("Error while getting BaseProducts:",e)}))}catch(e){console.log("Error while getting BaseProducts:",e)}}GetUOMList(){try{n()(i.WFM,r.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){let e=[];if(Array.isArray(t.EntityResult.VOLUME)&&(e=r.Zj(t.EntityResult.VOLUME)),Array.isArray(t.EntityResult.MASS)){r.Zj(t.EntityResult.MASS).forEach((t=>e.push(t)))}this.setState({quantityUOMOptions:e})}}else console.log("Error in GetUOMList:",t.ErrorList)})).catch((e=>{console.log("Error while getting GetUOMList:",e)}))}catch(e){console.log("Error while getting GetUOMList:",e)}}getCustomerStockTransfer(e){try{if(void 0===e.CustomerAgreement_TransferReferenceCode)return void this.setState({customerstockTransfer:A().cloneDeep(c.zW),modCustomerstockTransfer:A().cloneDeep(c.zW),isReadyToRender:!0,selectedAttributeList:[],CustomerAgreementItems:[],saveEnabled:r.ab(this.props.userDetails.EntityResult.FunctionsList,R.i.add,R.Hq)});var t=[{key:S.ij,value:e.CustomerAgreement_TransferReferenceCode}],s={TransferReferenceCode:e.CustomerAgreement_TransferReferenceCode,keyDataCode:S.ij,KeyCodes:t};n()(i.uee,r.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){let e=A().cloneDeep(t.EntityResult);this.setState({isReadyToRender:!0,customerstockTransfer:A().cloneDeep(t.EntityResult),modCustomerstockTransfer:e,CustomerAgreementItems:e.CustomerAgreementItems,saveEnabled:!1},(()=>{void 0!==e.RequestorShareholderCode&&this.getCustomerList(e.RequestorShareholderCode,"RequestorShareholderCode"),void 0!==e.LenderShareholderCode&&this.getCustomerList(e.LenderShareholderCode,"LenderShareholderCode")}))}else this.setState({customerstockTransfer:A().cloneDeep(c.zW),modCustomerstockTransfer:A().cloneDeep(c.zW),isReadyToRender:!0}),console.log("Error in getcustomerstock:",t.ErrorList)})).catch((t=>{console.log("Error while getcustomerstock:",t,e)}))}catch(o){console.log("Error while getcustomerstock:",o)}}fillDetails(e){let t=[];try{Array.isArray(e)&&e.forEach((e=>{(null!==e.BaseProductCode&&""!==e.BaseProductCode||null!==e.Quantity&&""!==e.Quantity)&&t.push({BaseProductCode:e.BaseProductCode,Quantity:e.Quantity,QuantityUOM:e.QuantityUOM})}))}catch(s){console.log("Error while making filldetails:",s)}return t}validateSave(e){try{var t=A().cloneDeep(this.state.validationErrors);Object.keys(E.Gm).forEach((function(s){t[s]=r.jr(E.Gm[s],e[s])}));let o={messageType:"critical",message:["CustomerStockTransfer_SavedStatus"],messageResultDetails:[]};this.setState({validationErrors:t});var s=!0;return s&&(s=Object.values(t).every((function(e){return""===e}))),o.messageResultDetails.length>0?(this.props.onSaved(this.state.modCustomerstockTransfer,"update",o),!1):s}catch(o){console.log("Error while Validate Save",o)}}CreateCustomerStockTransfer(e){try{let t={Entity:e},s={messageType:"critical",message:"CustomerStockTransfer_SavedStatus",messageResultDetails:[{keyFields:["CustomerAgreement_TransferReferenceCode"],keyValues:[e.Code],isSuccess:!1,errorMessage:""}]};n()(i.KxR,r.tW(t,this.props.tokenDetails.tokenInfo)).then((t=>{let o=t.data;s.messageType=o.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=o.IsSuccess,!0===o.IsSuccess?(this.setState({saveEnabled:!1}),this.getCustomerStockTransfer({CustomerAgreement_TransferReferenceCode:e.Code})):(s.messageResultDetails[0].errorMessage=o.ErrorList[0],this.setState({saveEnabled:!0}),console.log("Error in CustomerstockTransfer:",o.ErrorList)),this.props.onSaved(e,"add",s)})).catch((t=>{this.setState({saveEnabled:!0}),s.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"add",s)}))}catch(t){console.log("Error in CustomerstockTransfer:",t)}}render(){const e={shareholders:this.state.shareholders,RequestercustomerOptions:this.state.RequestercustomerOptions,LendercustomerOptions:this.state.LendercustomerOptions,baseProductOptions:this.state.baseProductOptions,quantityUOMOptions:this.state.quantityUOMOptions};return this.state.isReadyToRender?(0,g.jsxs)("div",{children:[(0,g.jsx)(h.A,{children:(0,g.jsx)(u.A,{entityCode:this.state.customerstockTransfer.Code,newEntityName:"CustomerAgreement_DetailsPageTitle"})}),(0,g.jsx)(h.A,{children:(0,g.jsx)(f,{modCustomerstockTransfer:this.state.modCustomerstockTransfer,CustomerAgreementItems:this.state.CustomerAgreementItems,listOptions:e,handleCellDataEdit:this.handleCellDataEdit,onFieldChange:this.handleChange,handleAddAssociation:this.handleAddAssociation,handleDeleteAssociation:this.handleDeleteAssociation,selectedAssociations:this.state.selectedAssociations,handleRowSelectionChange:this.handleAssociationSelectionChange,validationErrors:this.state.validationErrors})}),(0,g.jsx)(h.A,{children:(0,g.jsx)(l.q,{handleBack:this.props.onBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.saveEnabled})}),this.state.showAuthenticationLayout?(0,g.jsx)(k.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:R.i.add,functionGroup:R.Hq,handleOperation:this.saveCustomerStockTransfer,handleClose:this.handleAuthenticationClose}):null]}):(0,g.jsx)(v.A,{message:"Loading"})}}const j=(0,d.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(D)},43503:(e,t,s)=>{s.d(t,{A:()=>i});s(65043);var o=s(67907),r=s(72711),a=s(70579);function n(e){let{entityCode:t,newEntityName:s,popUpContents:n}=e;return(0,a.jsx)(o.TranslationConsumer,{children:e=>(0,a.jsx)("div",{className:"headerContainer",children:(0,a.jsxs)("div",{className:"row headerSpacing",children:[(0,a.jsx)("div",{className:"col paddingHeaderItemLeft",children:(0,a.jsx)("span",{style:{margin:"auto"},className:"headerLabel",children:""===t||void 0===t?e(s):t})}),""!==t&&void 0!==t&&n.length>0?(0,a.jsx)("div",{className:"headerItemRight",children:(0,a.jsx)(r.Popup,{element:(0,a.jsxs)("div",{children:[e(n[0].fieldName)+" ",":"," "+n[0].fieldValue,(0,a.jsx)(r.Icon,{style:{marginLeft:"10px"},root:"common",name:"caret-down",size:"small"})]}),position:"bottom left",children:(0,a.jsx)(r.List,{className:"detailsHeaderPopUp",children:n.map((t=>(0,a.jsxs)(r.List.Content,{className:"detailsHeaderPopUpListPadding",children:[e(t.fieldName)+" ",":"," "+t.fieldValue]},"content.fieldName")))})})}):""]})})})}n.defaultProps={entityCode:"",newEntityName:"",popUpContents:[]};const i=n},9256:(e,t,s)=>{s.d(t,{q:()=>n});s(65043);var o=s(72711),r=s(67907),a=s(70579);function n(e){let{handleBack:t,handleSave:s,handleReset:n,saveEnabled:i}=e;return(0,a.jsx)(r.TranslationConsumer,{children:e=>(0,a.jsxs)("div",{className:"row userActionPosition",children:[(0,a.jsx)("div",{className:"col-12 col-md-3 col-lg-4",children:(0,a.jsx)(o.Button,{className:"backButton",onClick:t,content:e("Back")})}),(0,a.jsx)("div",{className:"col-12 col-md-9 col-lg-8",children:(0,a.jsxs)("div",{style:{float:"right"},children:[(0,a.jsx)(o.Button,{content:e("LookUpData_btnReset"),className:"cancelButton",onClick:n}),(0,a.jsx)(o.Button,{content:e("Save"),disabled:!i,onClick:s})]})})]})})}n.defaultProps={saveEnabled:!1}}}]);
//# sourceMappingURL=1350.fe2e3c18.chunk.js.map