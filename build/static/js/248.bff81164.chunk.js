"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[248],{979:(e,t,a)=>{a.d(t,{A:()=>C});var s=a(65043),i=a(16432),o=a(65187),n=a(72711),l=a(67907),r=a(97508),c=a(40854),h=a.n(c),d=a(72067),p=a(69062),y=a(53536),m=a.n(y),u=a(7523),g=a(70579);class x extends s.Component{constructor(){super(...arguments),this.state={searchBayResult:"",pageIndex:1,pageSize:1},this.onBaySearchChange=e=>{this.setState({searchBayResult:e})},this.onCheckboxChange=(e,t)=>{try{this.props.onBaySelect(e,t)}catch(a){console.log("BayQueueComposite:Error occured on onCheckboxChange",a)}}}componentDidMount(){this.getLookUpData()}getLookUpData(){try{h()(d.xAA+"?LookUpTypeCode=BayAllocation",p.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess&&(isNaN(parseInt(t.EntityResult.PageSize))||this.setState({pageSize:parseInt(t.EntityResult.PageSize)}))}))}catch(e){console.log("BayAllocationDetailsComposite:Error occured on getLookUpData",e)}}getBayTooltip(e){return(0,g.jsx)(l.TranslationConsumer,{children:t=>(0,g.jsxs)("div",{children:[t("BayGroupList_BayCode")," : ",e.BayCode," ",(0,g.jsx)("br",{}),t("BayGroupList_LoadingType")," : ",e.LoadingType,(0,g.jsx)("br",{}),t("BayTooltip_QueueSize")," : ",e.MaximumQueue,(0,g.jsx)("br",{}),t("BaySearch_BayMode")," : ",e.IsManual?"Manual Bay":"Auto",(0,g.jsx)("br",{}),t("TankGroupInfo_Active")," : ",e.Active?"true":"false"]})})}getBayShipmentTooltip(e){return(0,g.jsx)(l.TranslationConsumer,{children:t=>(0,g.jsxs)("div",{children:[null===e.ShipmentCode?t("Receipt_Code"):t("ViewShipmentStatus_ShipmentCode")," ",": ",e.Code," ",(0,g.jsx)("br",{}),t("Receipt_Shareholder")," : ",e.ShareholderCode,(0,g.jsx)("br",{}),t("ViewReceipt_CarrierCompany")," : ",e.CarrierCode,(0,g.jsx)("br",{}),t("ViewReceipt_Vehicle")," : ",e.VehicleCode,(0,g.jsx)("br",{}),t("DriverInfo_Driver")," : ",e.DriverCode,(0,g.jsx)("br",{}),t("ScheduledDate")," :"," ",new Date(e.ScheduledDate).toLocaleDateString()]})})}getBayTypeTooltip(e){return(0,g.jsx)(l.TranslationConsumer,{children:t=>(0,g.jsxs)("div",{children:[t("BayType_Title")," :"," ","BOTH"===e.BayType?t("BayType_Both"):e.BayType]})})}getTransactionIdentifier(e,t){return e+u.uV+t}render(){let{searchBayResult:e}=this.state,t=this.props.bayData.filter((t=>t.BayCode.toLowerCase().includes(e.toLowerCase())||t.ShipmentReceiptItem.some((function(t){return t.Code.toLowerCase().includes(e.toLowerCase())})))),a=[],s=m().cloneDeep(this.state.pageIndex);this.state.pageSize>=t.length&&(s=1);let r=(s-1)*this.state.pageSize,c=r+this.state.pageSize;return c>=t.length&&(c=t.length),a=t.slice(r,c),(0,g.jsx)(l.TranslationConsumer,{children:e=>(0,g.jsxs)("div",{className:"detailsContainer",children:[(0,g.jsxs)("div",{className:"row",children:[(0,g.jsx)("div",{className:"col-4",children:(0,g.jsx)(n.Input,{className:"input-example",placeholder:e("BayAllocation_SearchBay"),search:!0,onChange:e=>this.onBaySearchChange(e)})}),(0,g.jsx)("div",{className:"col-4",children:t.length>this.state.pageSize?(0,g.jsx)(n.Pagination,{totalItems:t.length,itemsPerPage:this.state.pageSize,activePage:this.state.pageIndex,onPageChange:e=>{this.setState({pageIndex:e})}}):""}),(0,g.jsx)("div",{className:"col-4",style:{marginTop:"1rem"},children:(0,g.jsxs)("div",{style:{float:"right"},children:[e("Common_LastUpdated")+" : "+this.props.updatedTime,(0,g.jsx)("span",{style:{marginLeft:"1rem",cursor:"pointer"},onClick:()=>this.props.onRefresh(),children:(0,g.jsx)("img",{style:{width:"6%"},src:"/Refresh.png",alt:""})})]})})]}),(0,g.jsx)(o.A,{children:a.length>0?a.map(((e,t)=>(0,g.jsx)("div",{style:{overflowX:"auto"},children:(0,g.jsxs)(n.Table,{children:[(0,g.jsx)(n.Table.Header,{children:(0,g.jsx)(n.Table.HeaderCell,{colSpan:e.MaximumQueue+2,content:e.BayCode,children:(0,g.jsx)("div",{className:"row",style:{marginBottom:"-1rem"},children:(0,g.jsxs)("div",{style:{display:"flex"},children:[(0,g.jsx)("div",{children:e.MaximumQueue>0&&!0===e.Active&&!0===this.props.isBayAllocation?(0,g.jsx)(n.Checkbox,{label:e.BayCode,checked:!0===e.SelectedBay,onChange:t=>this.onCheckboxChange(e.BayCode,t)}):(0,g.jsx)("div",{style:{whiteSpace:"pre"},children:(0,g.jsx)(n.InputLabel,{label:e.BayCode+"   "})})}),(0,g.jsx)("div",{children:(0,g.jsx)(o.A,{children:(0,g.jsx)(n.Tooltip,{element:(0,g.jsx)(n.Icon,{style:{paddingBottom:"5px"},name:"badge-info",root:"common"}),content:this.getBayTooltip(e),size:"mini",position:"right center"})})}),(0,g.jsx)(o.A,{children:(0,g.jsx)(n.Tooltip,{element:(0,g.jsx)("span",{className:"bayTypeIconPosition",children:(0,g.jsx)("icon",{style:{fontSize:"25px"},className:"BOTH"===e.BayType?"icon-Loading-Unloading":"LOADING"===e.BayType?"icon-Loading":"icon-Unloading"})}),content:this.getBayTypeTooltip(e),size:"mini",position:"right center"})}),!1===this.props.isManualMode?(0,g.jsx)("div",{style:{position:"absolute",right:"18px"},children:(0,g.jsx)("span",{style:{marginTop:"-0.3rem"},children:(0,g.jsx)(n.Icon,{name:"locked",root:"Building"})})}):""]})})})}),(0,g.jsx)(n.Table.Body,{children:(0,g.jsx)(n.Table.Row,{children:(0,g.jsx)(i.gL,{droppableId:e.BayCode,type:"Type1",children:t=>(0,g.jsxs)("div",{ref:t.innerRef,...t.droppableProps,children:[e.ShipmentReceiptItem.length>0?e.ShipmentReceiptItem.map(((t,a)=>(0,g.jsx)(n.Table.Cell,{className:this.props.selectedShipmentReceiptItem.Code===t.Code?"bayAllocationtd tdSelected":"bayAllocationtd",onClick:()=>this.props.isBayAllocation?this.props.onCellClick(a,e.BayCode):"",children:(0,g.jsx)(o.A,{children:(0,g.jsx)(i.sx,{draggableId:this.getTransactionIdentifier(t.Code,t.ShareholderCode),isDragDisabled:!1===this.props.isBayAllocation,children:(e,s)=>(0,g.jsxs)("div",{ref:e.innerRef,...e.draggableProps,...e.dragHandleProps,children:[(0,g.jsxs)("div",{className:"bayAllocationFontSize",children:[t.Code,(0,g.jsx)(o.A,{children:(0,g.jsx)(n.Tooltip,{element:(0,g.jsx)("span",{className:"bayAllocationInfoIcon",children:(0,g.jsx)(n.Icon,{name:"badge-info",root:"common"})}),content:this.getBayShipmentTooltip(t),size:"mini",position:"right center"})})]}),(0,g.jsx)("div",{className:"bayAllocationFontSize",children:t.VehicleCode}),a>0?(0,g.jsx)("div",{children:(0,g.jsx)("img",{className:"bayAllocationImagePosition",src:"/Vehicle.png",alt:"",title:"Vehicle"})}):(0,g.jsx)("div",{children:(0,g.jsx)("img",{className:"bayAllocationImagePosition",src:"/VehiclewithBay.png",alt:"",title:"Vehicle"})})]})})})}))):(0,g.jsx)(n.Table.Cell,{className:"bayAllocationtd",children:(0,g.jsx)("img",{className:"bayAllocationImagePosition",src:"/BayEmpty.png",alt:"",title:"Bay"})}),e.MaximumQueue>0?[...Array.from(Array(e.MaximumQueue-(0===e.ShipmentReceiptItem.length?1:e.ShipmentReceiptItem.length)).keys())].map(((e,t)=>(0,g.jsx)(n.Table.Cell,{className:"bayAllocationtd"}))):"",(0,g.jsx)(n.Table.Cell,{})]})})})})]})}))):e("BaySearch_NoResult")})]})})}}const C=(0,r.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(x)},60248:(e,t,a)=>{a.r(t),a.d(t,{default:()=>g});var s=a(65043),i=a(97508),o=a(67907),n=a(72711),l=a(40854),r=a.n(l),c=a(72067),h=a(69062),d=a(40252),p=a(979),y=a(16432),m=a(70579);class u extends s.Component{constructor(){super(...arguments),this.refreshTimer=null,this.state={bayData:[],isReadyToRender:!1,isInitialLoad:!0,lastUpdatedTime:"",isManualMode:!0,refreshTime:1e4,selectedShipmentReceiptItem:{}},this.startRefreshTimer=()=>{this.refreshTimer=setInterval((()=>{this.setState({isReadyToRender:!1},(()=>{this.getBays()}))}),this.state.refreshTime)},this.stopRefreshTimer=()=>{null!==this.refreshTimer&&clearInterval(this.refreshTimer)},this.handleRefresh=()=>{this.setState({isReadyToRender:!1},(()=>{this.getBays()}))}}componentDidMount(){try{this.getBays(),this.getBayAllocationType(),this.getLookUpData()}catch(e){console.log("BayQueueDetailsComposite:Error occured on componentDidMount",e)}}componentWillUnmount(){this.stopRefreshTimer()}getBays(){try{r()(c.ytI,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{let t=(new Date).toLocaleDateString()+" "+(new Date).toLocaleTimeString();var a=e.data;if(this.stopRefreshTimer(),!0===a.IsSuccess){let e=[];Array.isArray(a.EntityResult.BayData.Table)&&a.EntityResult.BayData.Table.forEach((t=>{t.ShipmentReceiptItem=[];let s=[];Array.isArray(a.EntityResult.lstBayAllocationQueue)&&(s=a.EntityResult.lstBayAllocationQueue.filter((e=>e.BayCode===t.BayCode))),s.length>0&&s[0].AllocationItems.sort(((e,t)=>e.QueueNumber>t.QueueNumber?1:-1)).forEach((e=>{if(Array.isArray(a.EntityResult.BayData.Table2)){let s=a.EntityResult.BayData.Table2.filter((t=>null!==e.ShipmentCode&&e.ShipmentCode===t.ShipmentCode||null!==e.ReceiptCode&&e.ReceiptCode===t.Code));t.ShipmentReceiptItem.push(s[0])}})),e.push(t)})),this.setState({bayData:e,isReadyToRender:!0,isInitialLoad:!1,lastUpdatedTime:t})}else this.setState({bayData:[],isReadyToRender:!0,isInitialLoad:!1,lastUpdatedTime:t}),console.log("Error in getBays:",a.ErrorList);this.startRefreshTimer()})).catch((e=>{this.setState({bayData:[],isReadyToRender:!0,isInitialLoad:!1}),console.log("Error while getBays:",e)}))}catch(e){console.log("BayQueueDetailsComposite:Error occured on getBays",e)}}getBayAllocationType(){try{r()(c.NJd,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data,a=!0;!0===t.IsSuccess&&"false"===t.EntityResult.toLowerCase()&&(a=!1),this.setState({isManualMode:a})})).catch((e=>{console.log("Error while getBayAllocationType:",e)}))}catch(e){console.log("BayQueueDetailsComposite:Error occured on getBayAllocationType",e)}}getLookUpData(){try{r()(c.xAA+"?LookUpTypeCode=BayAllocation",h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess&&(isNaN(parseInt(t.EntityResult.BayQueueMonitorRefreshInterval))||this.setState({refreshTime:parseInt(t.EntityResult.BayQueueMonitorRefreshInterval)}))}))}catch(e){console.log("BayQueueDetailsComposite:Error occured on getLookUpData",e)}}render(){return this.state.isInitialLoad?(0,m.jsx)(d.A,{message:"Loading"}):(0,m.jsx)(o.TranslationConsumer,{children:e=>(0,m.jsxs)("div",{children:[this.state.isReadyToRender?"":(0,m.jsx)("div",{className:"authLoading parameterLoader",children:(0,m.jsx)(n.Loader,{text:" ",className:"globalLoaderPositionPosition"})}),(0,m.jsx)("div",{className:"bayQueueMonitorContainer",children:(0,m.jsx)(y.JY,{children:(0,m.jsx)(p.A,{bayData:this.state.bayData,onBaySelect:this.handleBaySelect,isManualMode:this.state.isManualMode,onRefresh:this.handleRefresh,updatedTime:this.state.lastUpdatedTime,onCellClick:this.handleCellClick,selectedShipmentReceiptItem:this.state.selectedShipmentReceiptItem,isBayAllocation:!1})})})]})})}}const g=(0,i.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(u)}}]);
//# sourceMappingURL=248.bff81164.chunk.js.map