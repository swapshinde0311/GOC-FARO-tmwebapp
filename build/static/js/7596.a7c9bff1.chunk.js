"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[7596],{67596:(e,t,s)=>{s.r(t),s.d(t,{default:()=>I});var i=s(65043),a=s(72711),o=s(78374),l=s(67907),n=s(85800),r=s(65187),d=s(7523),c=s(70579);function h(e){let{loadingArm:t,modLoadingArm:s,modAssociations:i,listOptions:h,selectedRows:u,handleRowSelectionChange:m,handleCellDataEdit:p,validationErrors:g,onFieldChange:A,onActiveStatusChange:y,attributeValidationErrors:C,selectedAttributeList:L,handleAttributeCellDataEdit:S,deviceModel:v,IsDualBay:D,possibleSwingArmList:b,selectedSwingArmAssociations:E,onSwingArmAssociationSelectionChange:f}=e;const R=(e,t)=>{let s=[];return s=e.find((e=>e.TerminalCode===t)),s.attributeValidationErrors},[w]=(0,l.useTranslation)(),T=e=>(0,c.jsx)(a.Input,{fluid:!0,value:i[e.rowIndex][e.field],onChange:t=>p(t,e),reserveSpace:!1});return(0,c.jsx)("div",{className:"detailsContainer",children:(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,c.jsx)(a.Input,{fluid:!0,value:s.Code,label:w("Loadingrm_Code"),indicator:"required",disabled:""!==t.Code,onChange:e=>A("Code",e),error:w(g.Code),reserveSpace:!1})}),(0,c.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,c.jsx)(a.Input,{fluid:!0,value:s.Name,label:w("Loadingrm_Name"),indicator:"required",onChange:e=>A("Name",e),error:w(g.Name),reserveSpace:!1})}),(0,c.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,c.jsx)(a.Input,{fluid:!0,value:s.ArmNumberInBCU,label:w("LoadingArmInfo_ArmNoInBCU"),indicator:"required",onChange:e=>A("ArmNumberInBCU",e),error:w(g.ArmNumberInBCU),reserveSpace:!1})}),(0,c.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,c.jsx)(a.Select,{fluid:!0,placeholder:"Select",label:w("BlendType_Title"),value:s.BlendType,disabled:""!==t.Code,indicator:"required",options:h.deviceBlendOptions,onChange:e=>A("BlendType",e),error:w(g.BlendType)})}),(0,c.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,c.jsx)(a.Select,{fluid:!0,placeholder:"Select",label:w("LoadingArm_ArmLoadingType"),value:s.ArmLoadingType,disabled:""!==t.Code,indicator:"required",options:[{text:"BOTH",value:"BOTH"},{text:"LOADING",value:"LOADING"},{text:"UNLOADING",value:"UNLOADING"}],onChange:e=>A("ArmLoadingType",e),error:w(g.ArmLoadingType)})}),(0,c.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,c.jsx)(a.Input,{fluid:!0,label:w("BCU_NodeAddress"),value:s.NodeAddress,onChange:e=>A("NodeAddress",e),reserveSpace:!1,indicator:"Accuload-IV"===v||"Accuload-III"===v?"required":"",error:w(g.NodeAddress)})}),(0,c.jsxs)("div",{className:"col-12 col-md-6 col-lg-4",children:[(0,c.jsx)(a.InputLabel,{label:w("LoadingArm_CLFQty"),indicator:"required"}),(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{className:"col-12 col-md-8 col-xl-9 pr-0",children:(0,c.jsx)(a.Input,{fluid:!0,value:s.CleanLineFinishQuantity,onChange:e=>A("CleanLineFinishQuantity",e),error:w(g.CleanLineFinishQuantity),reserveSpace:!1})}),(0,c.jsx)("div",{className:"col-12 col-md-4 col-xl-3 pl-0",children:(0,c.jsx)(a.Select,{fluid:!0,placeholder:w("Common_Select"),value:s.CleanLineFinishQuantityUOM,options:h.densityUOMOptions,onChange:e=>A("CleanLineFinishQuantityUOM",e),indicator:"required",reserveSpace:!1,search:!1,noResultsMessage:w("noResultsMessage")})})]})]}),(0,c.jsxs)("div",{className:"col-12 col-md-6 col-lg-4",children:[(0,c.jsx)(a.InputLabel,{label:w("LoadingArm_MLQty"),indicator:"required"}),(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{className:"col-12 col-md-8 col-xl-9 pr-0",children:(0,c.jsx)(a.Input,{fluid:!0,value:s.MinimumLoadableQuantity,onChange:e=>A("MinimumLoadableQuantity",e),error:w(g.MinimumLoadableQuantity),reserveSpace:!1})}),(0,c.jsx)("div",{className:"col-12 col-md-4 col-xl-3 pl-0",children:(0,c.jsx)(a.Select,{fluid:!0,placeholder:w("Common_Select"),value:s.MLQtyUOM,options:h.densityUOMOptions,onChange:e=>A("MLQtyUOM",e),indicator:"required",reserveSpace:!1,search:!1,noResultsMessage:w("noResultsMessage")})})]})]}),(0,c.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,c.jsx)(a.Input,{fluid:!0,label:w("BCU_MainLineMeters"),disabled:!0,value:s.MainlineMeters,onChange:e=>A("MainlineMeters",e),reserveSpace:!1})}),(0,c.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,c.jsx)(a.Input,{fluid:!0,disabled:!0,label:w("BCU_AdditiveMeters"),value:s.AdditiveMeters,onChange:e=>A("AdditiveMeters",e),reserveSpace:!1})}),(0,c.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,c.jsx)(a.Input,{fluid:!0,value:null===s.Description?"":s.Description,label:w("FinishedProductList_Description"),onChange:e=>A("Description",e),error:w(g.Description),reserveSpace:!1})}),(0,c.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,c.jsx)(a.Select,{fluid:!0,placeholder:w("FinishedProductInfo_Select"),label:w("Cust_Status"),value:s.Status,options:[{text:w("ViewShipment_Ok"),value:!0},{text:w("ViewShipmentStatus_Inactive"),value:!1}],onChange:e=>y(e)})}),(0,c.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,c.jsx)(a.Input,{fluid:!0,value:null===s.Remarks?"":s.Remarks,label:w("Cust_Remarks"),onChange:e=>A("Remarks",e),indicator:s.Status!==t.Status?"required":"",error:w(g.Remarks),reserveSpace:!1})}),!0===D?(0,c.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,c.jsx)(a.Select,{fluid:!0,placeholder:w("Common_Select"),label:w("LoadingArm_SelectAssociatedBay"),value:s.AssociatedBay,options:d.HX,onChange:e=>A("AssociatedBay",e),indicator:"required",disabled:!0===s.Swingable,reserveSpace:!1,search:!1,noResultsMessage:w("noResultsMessage")})}):"","LOADING"!==s.ArmLoadingType&&"BOTH"!==s.ArmLoadingType||v===d.RG.Microload?null:(0,c.jsx)("div",{className:"col-12 col-md-6 col-lg-4 ",children:(0,c.jsx)(a.Checkbox,{className:"deviceDualandTransCheckBox",label:w("Loadingarm_Swingable"),checked:s.Swingable,onChange:e=>A("Swingable",e)})}),s.Swingable&&!D&&v!==d.RG.Microload?(0,c.jsxs)("div",{className:"col-12",children:[(0,c.jsx)("h5",{children:w("LoadingArms_SwingArmAssociations")}),(0,c.jsxs)(o.bQ,{data:b,selectionMode:"multiple",scrollable:!0,selection:E,onSelectionChange:f,onSelectAll:f,className:"swing-arm-association",scrollHeight:"100px",children:[(0,c.jsx)(o.bQ.Column,{header:w("BCU_Code"),field:"BCUCode"},"BCUCode"),(0,c.jsx)(o.bQ.Column,{header:w("LoadingArmCode"),field:"LoadArmCode"},"LoadArmCode")]})]}):null,(0,c.jsx)("div",{className:"col-12 pb-0",children:L.length>0?L.map((e=>(0,c.jsx)("div",{className:"bayAccordian",children:(0,c.jsx)(r.A,{children:(0,c.jsx)(a.Accordion,{className:"",children:(0,c.jsx)(a.Accordion.Content,{title:w("Attributes_Header"),children:(0,c.jsx)(n.n,{selectedAttributeList:e.attributeMetaDataList,handleCellDataEdit:S,attributeValidationErrors:R(C,e.TerminalCode)})})})})}))):null}),(0,c.jsxs)("div",{className:"col-12 pb-0 pt-3",children:[(0,c.jsx)("h5",{children:w("BCU_FP")}),(0,c.jsxs)(o.bQ,{data:i,selectionMode:"multiple",selection:u,onSelectionChange:m,scrollable:!0,scrollHeight:"100px",children:[(0,c.jsx)(o.bQ.Column,{className:"compColHeight",field:"Shareholdercode",header:w("BCU_shareHolder"),sortable:!0,editFieldType:"text",customEditRenderer:T},"Shareholdercode"),(0,c.jsx)(o.bQ.Column,{className:"compColHeight",field:"Code",header:w("LoadingArm_FinishedProduct"),sortable:!0,editFieldType:"text",customEditRenderer:T},"Code")]})]})]})})}var u=s(80432),m=s(40252),p=s(93779),g=s(72067),A=s(97508),y=s(40854),C=s.n(y),L=s(53536),S=s.n(L),v=s(69062),D=s(43503),b=s(44192),E=s(46100),f=s(80312),R=s(15417),w=s(62900);class T extends i.Component{constructor(){super(...arguments),this.state={loadingArm:{},modLoadingArm:{},isReadyToRender:!1,saveEnabled:!1,isDeleteEnabled:!1,selectedLocationType:"",checkedDevices:[],deviceBlendOptions:[],loadingTypeOptions:[],deviceModel:"",IsTransloading:!1,densityUOMOptions:[],modAssociations:[],selectedRows:[],unselectedRows:[],attributeMetaDataList:[],selectedAttributeList:[],attributeValidationErrors:[],validationErrors:v.Th(b.jU),IsDualBay:!1,possibleFps:[],deniedFPs:[],showDeleteAuthenticationLayout:!1,showSaveAuthenticationLayout:!1,tempLoadingArm:{},possibleSwingArmAssociations:[],selectedSwingArmAssociations:[]},this.handleCellDataEdit=(e,t)=>{let s=S().cloneDeep(this.state.modAssociations);s[t.rowIndex][t.field]=e,this.setState({modAssociations:s})},this.handleRowSelectionChange=e=>{this.setState({selectedRows:e})},this.handleChange=(e,t)=>{try{let s=S().cloneDeep(this.state.modLoadingArm);s[e]=t;const i={...this.state.validationErrors};s.Status===this.state.loadingArm.Status&&(this.state.loadingArm.Remarks!==s.Remarks&&""!==s.Remarks||(i.Remarks=""),""===s.Remarks&&(s.Remarks=this.state.loadingArm.Remarks)),!0===s.Swingable&&(s.AssociatedBay=0),"Status"===e&&s.Status!==this.state.loadingArm.Status&&(s.Remarks=""),void 0!==b.jU[e]&&(i[e]=v.jr(b.jU[e],t)),this.setState({validationErrors:i,modLoadingArm:s})}catch(s){console.log("LoadingArmDetailsComposite:Error occured on handleChange",s)}},this.handleActiveStatusChange=e=>{try{let t=S().cloneDeep(this.state.modLoadingArm);t.Status=e,t.Status!==this.state.loadingArm.Status&&(t.Remarks=""),this.setState({modLoadingArm:t})}catch(t){console.log("LoadingArmDetailsComposite:Error occured on handleActiveStatusChange",t)}},this.saveLoadingArm=()=>{try{this.setState({saveEnabled:!1});let e=S().cloneDeep(this.state.tempLoadingArm);""===this.state.loadingArm.Code?this.createLoadingArm(e):this.updateLoadingArm(e)}catch(e){console.log("GantryComposite : Error in saveGantry")}},this.handleSave=()=>{try{let e=this.fillDetails(),t=v.pI(this.state.selectedAttributeList);if(this.validateSave(e,t)){e=this.fillAttributeDetails(e,t);let s=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,i=S().cloneDeep(e);this.setState({showSaveAuthenticationLayout:s,tempLoadingArm:i},(()=>{!1===s&&this.saveLoadingArm()}))}else this.setState({saveEnabled:!0})}catch(e){console.log("LoadingArmDetailsComposite:Error occured on handleSave",e)}},this.handleDelete=()=>{try{var e=[],t=this.state.modLoadingArm.Code,s={keyDataCode:0,ShareHolderCode:"",KeyCodes:[{Key:p.Y4,Value:t},{Key:p.Ln,Value:this.props.transportationtype},{Key:p.uw,Value:this.props.selectedTerminal}]};e.push(s),C()(g.yuA,v.tW(e,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data,s=t.IsSuccess;null!==t.ResultDataList&&void 0!==t.ResultDataList&&(s=t.ResultDataList.filter((function(e){return!e.IsSuccess})).length!==t.ResultDataList.length);var i=v.Cy(t,["LoadingArmDeletionSuccess"],["LoadingArmCode"]);s?(this.getLoadingArm({loadingArmCode:this.state.modLoadingArm.Code,selectedTerminal:this.props.selectedTerminal,isClone:!1}),this.setState({isDeleteEnabled:!1,showDeleteAuthenticationLayout:!1})):this.setState({isDeleteEnabled:!0,showDeleteAuthenticationLayout:!1}),i.messageResultDetails.forEach((e=>{e.keyFields.length>0&&(e.keyFields[0]=["Loadingrm_Code"])})),this.props.onDelete(this.state.modLoadingArm,"delete",i)}))}catch(i){console.log("LoadingArmDetailsComposite:Error occured on handleDelete",i)}},this.handleAttributeCellDataEdit=(e,t)=>{try{e.DefaultValue=t,this.setState({attribute:e});const s=S().cloneDeep(this.state.attributeValidationErrors);s.forEach((s=>{s.TerminalCode===e.TerminalCode&&(s.attributeValidationErrors[e.Code]=v.I5(e,t))})),this.setState({attributeValidationErrors:s})}catch(s){console.log("LoadingArmDetailsComposite:Error occured on handleCellDataEdit",s)}},this.authenticateDelete=()=>{try{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showDeleteAuthenticationLayout:e}),!1===e&&this.handleDelete()}catch(e){console.log("LoadingArmComposite : Error in authenticateDelete")}},this.handleAuthenticationClose=()=>{this.setState({showSaveAuthenticationLayout:!1,showDeleteAuthenticationLayout:!1})},this.fetchPossibleSwingArmAssociation=()=>{let e={ShareHolderCode:"",keyDataCode:p.Y4,KeyCodes:[{key:p.Y4,value:this.state.loadingArm.Code},{key:p.Ln,value:this.props.transportationtype},{key:p.uw,value:this.props.selectedTerminal},{key:p.wX,value:this.props.deviceCode}]};C()(g.FAX,v.tW(e,this.props.tokenDetails.tokenInfo)).then((e=>{if(e.data.IsSuccess){let t=[];Array.isArray(this.state.loadingArm.AssociatedArmCollection)&&Array.isArray(e.data.EntityResult)&&e.data.EntityResult.forEach((e=>{this.state.loadingArm.AssociatedArmCollection.includes(e.LoadArmCode)&&t.push(e)})),this.setState({possibleSwingArmAssociations:e.data.EntityResult,selectedSwingArmAssociations:t})}})).catch((e=>{this.setState({possibleSwingArmAssociations:[],selectedSwingArmAssociations:[]}),console.log("Error fetching possible swing arm associations: ",e)}))},this.handleSwingArmAssociationSelectionChange=e=>{this.setState({selectedSwingArmAssociations:e})}}componentDidMount(){try{v.pJ(this.props.userDetails.EntityResult.IsArchived),this.getBCUDeviceDetails(this.props.deviceCode),this.getLoadingTypes(),this.getBlendTypes(this.state.deviceModel),this.getUOMList(),this.getAttributes(this.props)}catch(e){console.log("LoadingArmDetailsComposite:Error occured on componentDidMount",e)}}componentWillReceiveProps(e){try{if(void 0===e.LocationCode&&this.props.tokenDetails.tokenInfo===e.tokenDetails.tokenInfo){this.getAttributes(e);let t={...this.state.validationErrors};Object.keys(t).forEach((e=>{t[e]=""})),this.setState({validationErrors:t})}}catch(t){console.log("LoadingArmDetailsComposite:Error occured on componentWillReceiveProps",t)}}getAttributes(e){try{C()(g.fKH,v.tW([R.kI],this.props.tokenDetails.tokenInfo)).then((t=>{var s=t.data;!0===s.IsSuccess?this.setState({attributeMetaDataList:S().cloneDeep(s.EntityResult),attributeValidationErrors:v.Fl(s.EntityResult.loadingArm)},(()=>this.getLoadingArm(e))):console.log("Error in getAttributes:")}))}catch(t){console.log("Error while getAttributes:",t)}}getBlendTypes(e){try{C()(g.Jdj+e,v.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){var s=v.Zj(t.EntityResult);this.setState({deviceBlendOptions:s})}}else console.log("Error in getDeviceTypes:",t.ErrorList)}))}catch(t){console.log("LoadingArmDetailsComposite:Error while getting getBlendTypes")}}getBCUDeviceDetails(e){try{var t=[{key:p.wX,value:e},{key:p.uw,value:this.props.selectedTerminal}],s={ShareHolderCode:"",keyDataCode:p.wX,KeyCodes:t};C()(g.T1y,v.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;!0===t.IsSuccess&&(this.setState({deviceModel:t.EntityResult.Model,IsTransloading:t.EntityResult.IsTransloading,IsDualBay:t.EntityResult.IsDualBay}),this.getBlendTypes(this.state.deviceModel))}))}catch(i){console.log("LoadingArmDetailsComposite:Error while getting getBCUDeviceDetails")}}getLoadingArm(e){let t=e.loadingArmCode;!0===S().cloneDeep(this.state.IsTransloading)?(E.mG.BlendType=d.re.NONE,E.mG.ArmLoadingType=d.re.LOADING):(E.mG.BlendType="",E.mG.ArmLoadingType="");try{if(!0===e.isClone)return void this.setState({selectedAttributeList:[],loadingArm:S().cloneDeep(E.mG),modLoadingArm:S().cloneDeep(E.mG),isReadyToRender:!0,modAssociations:[],selectedRows:[],isDeleteEnabled:!1,saveEnabled:v.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.add,v.k5(this.props.transportationtype))},(()=>{this.localNodeAttribute(),this.state.IsDualBay||this.fetchPossibleSwingArmAssociation()}));if(void 0===t||""===t)return void this.setState({selectedAttributeList:[],loadingArm:S().cloneDeep(E.mG),modLoadingArm:S().cloneDeep(E.mG),modAssociations:[],selectedRows:[],isDeleteEnabled:!1,isReadyToRender:!0,saveEnabled:v.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.add,v.k5(this.props.transportationtype))},(()=>{this.localNodeAttribute(),this.state.IsDualBay||this.fetchPossibleSwingArmAssociation()}));var s=[{key:p.Y4,value:t},{key:p.Ln,value:this.props.transportationtype},{key:p.uw,value:this.props.selectedTerminal}],i={ShareHolderCode:"",keyDataCode:p.Y4,KeyCodes:s};C()(g.b3t,v.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;let s=[],i=[];if(!0===t.IsSuccess){this.setState({selectedAttributeList:[],loadingArm:S().cloneDeep(t.EntityResult),modLoadingArm:S().cloneDeep(t.EntityResult),isReadyToRender:!0,modAssociations:[],selectedRows:[],isDeleteEnabled:v.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.remove,v.k5(this.props.transportationtype)),saveEnabled:v.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.modify,v.k5(this.props.transportationtype))},(()=>{this.state.loadingArm.Swingable&&!this.state.IsDualBay&&this.fetchPossibleSwingArmAssociation(),this.terminalSelectionChange([t.EntityResult.TerminalCode])}));let e=this.state.modLoadingArm;let a=[],o=[];this.state.deviceModel===d.Oe.MSC_L&&e.BlendType===d.Oe.RATIO&&(e.BlendType=d.Oe.RATIO_SEQUENTIAL),null!=t.EntityResult.DeniedFPs&&(o=t.EntityResult.DeniedFPs,o.forEach((e=>{s.push({Code:e.Code,Shareholdercode:e.Shareholdercode})}))),null!=t.EntityResult.PossibleFPs&&(a=t.EntityResult.PossibleFPs,a.forEach((e=>{s.push({Code:e.Code,Shareholdercode:e.Shareholdercode})})),a.forEach((e=>{i.push({Code:e.Code,Shareholdercode:e.Shareholdercode})}))),this.setState({modLoadingArm:e,modAssociations:s,selectedRows:i,possibleFps:a,deniedFPs:o})}else this.setState({loadingArm:S().cloneDeep(E.mG),modLoadingArm:S().cloneDeep(E.mG),isReadyToRender:!0,modAssociations:[],selectedRows:[],isDeleteEnabled:!1})}))}catch(a){console.log("LoadingArmDetailsComposite:Error occured in getLoadingArm",a)}}terminalSelectionChange(e){try{let a=[];var t=[],s=[];t=S().cloneDeep(this.state.attributeMetaDataList),s=S().cloneDeep(this.state.selectedAttributeList);const o=S().cloneDeep(this.state.attributeValidationErrors);var i=S().cloneDeep(this.state.modLoadingArm);e.forEach((e=>{var o=s.find((t=>t.TerminalCode===e));void 0===o?t.loadingArm.forEach((function(t){if(t.TerminalCode===e){var s=i.Attributes.find((t=>t.TerminalCode===e));void 0!==s&&t.attributeMetaDataList.forEach((function(e){var t=s.ListOfAttributeData.find((t=>t.AttributeCode===e.Code));void 0!==t&&(e.DefaultValue=t.AttributeValue)})),a.push(t)}})):a.push(o)})),s=[],s=a,s=v.nQ(s),o.forEach((t=>{void 0===e.find((e=>t.TerminalCode===e))&&Object.keys(t.attributeValidationErrors).forEach((e=>t.attributeValidationErrors[e]=""))})),this.setState({selectedAttributeList:s,attributeValidationErrors:o})}catch(a){console.log("LoadingArmDetailsComposite:Error occured on terminalSelectionChange",a)}}localNodeAttribute(){try{this.terminalSelectionChange([this.props.selectedTerminal])}catch(e){console.log("LoadingArmDetailsComposite:Error occured on localNodeAttribute",e)}}getLoadingTypes(){C()(g.zVP,v.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){var s=v.Zj(t.EntityResult);this.setState({loadingTypeOptions:s})}}else console.log("Error in getLoadingTypes:",t.ErrorList)})).catch((e=>{console.log("Error while getting getLoadingTypes:",e)}))}getUOMList(){try{C()(g.WFM,v.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){let e=[],s=[];Array.isArray(t.EntityResult.VOLUME)&&Array.isArray(t.EntityResult.MASS)&&(s=t.EntityResult.VOLUME.concat(t.EntityResult.MASS)),e=v.Zj(s),this.setState({densityUOMOptions:e})}}else console.log("Error in GetUOMList:",t.ErrorList)}))}catch(e){console.log("LoadingArmDetailsComposite:Error while getting GetUOMList")}}fillDetails(){try{let e=S().cloneDeep(this.state.modLoadingArm),t=S().cloneDeep(this.state.IsDualBay);e.BlendType===d.Oe.RATIO_SEQUENTIAL&&(e.BlendType=d.Oe.RATIO),e.BcuCode=this.props.deviceCode,e.TerminalCode=this.props.selectedTerminal,!0!==t&&(e.AssociatedBay=0),!0===t&&!0===e.Swingable&&(e.AssociatedBay=0);let s=S().cloneDeep(this.state.possibleFps),i=S().cloneDeep(this.state.selectedRows),a=S().cloneDeep(this.state.deniedFPs),o=S().cloneDeep(this.state.modAssociations);if(1===o.length?1===s.length&&0===i.length&&0===a.length?(s.forEach((t=>{e.DeniedFPs.push({Code:t.Code,Shareholdercode:t.Shareholdercode})})),e.PossibleFPs=[]):0===s.length&&1===i.length&&1===a.length&&(a.forEach((t=>{e.PossibleFPs.push({Code:t.Code,Shareholdercode:t.Shareholdercode})})),e.DeniedFPs=[]):o.length===i.length?(e.PossibleFPs=[],i.forEach((t=>{e.PossibleFPs.push({Code:t.Code,Shareholdercode:t.Shareholdercode})})),e.DeniedFPs=[]):0===i.length?(e.DeniedFPs=[],o.forEach((t=>{e.DeniedFPs.push({Code:t.Code,Shareholdercode:t.Shareholdercode})})),e.PossibleFPs=[]):(e.DeniedFPs=[],e.PossibleFPs=[],o.forEach((t=>{0===i.filter((e=>e.Code===t.Code&&e.Shareholdercode===t.Shareholdercode)).length&&e.DeniedFPs.push({Code:t.Code,Shareholdercode:t.Shareholdercode})})),i.forEach((t=>{e.PossibleFPs.push({Code:t.Code,Shareholdercode:t.Shareholdercode})}))),e.Swingable&&!t){let t=[];this.state.possibleSwingArmAssociations.forEach((e=>{this.state.selectedSwingArmAssociations.filter((t=>t.LoadArmCode===e.LoadArmCode)).length>0&&t.push(e.LoadArmCode)})),e.AssociatedArmCollection=[...t]}return e}catch(e){console.log("LoadingArmDetailsComposite:Error occured on filldetails",e)}}fillAttributeDetails(e,t){try{return t=v.SC(t),e.Attributes=[],t.forEach((t=>{let s={ListOfAttributeData:[]};s.TerminalCode=t.TerminalCode,t.attributeMetaDataList.forEach((e=>{s.ListOfAttributeData.push({AttributeCode:e.Code,AttributeValue:e.DefaultValue})})),e.Attributes.push(s)})),e}catch(s){console.log("LoadingArmDetailsComposite:Error occured on fillAttributeDetails",s)}}validateSave(e,t){const s={...this.state.validationErrors};Object.keys(b.jU).forEach((function(t){void 0!==e[t]&&(s[t]=v.jr(b.jU[t],e[t]))})),e.Status!==this.state.loadingArm.Status&&(null!==e.Remarks&&""!==e.Remarks||(s.Remarks="OriginTerminal_RemarksRequired")),"Accuload-IV"===this.state.deviceModel&&(null!==e.NodeAddress&&""!==e.NodeAddress||(s.NodeAddress="CardReader_MandatoryAddress")),null!==e.CleanLineFinishQuantity&&""!==e.CleanLineFinishQuantity||(s.CleanLineFinishQuantity="CleanLineFinishQuantity_Empty_x"),null!==e.MinimumLoadableQuantity&&""!==e.MinimumLoadableQuantity||(s.MinimumLoadableQuantity="MinimumLoadableQuantity_Empty_x");let i={messageType:"critical",message:["LoadingArmSavedSuccess"],messageResultDetails:[]};var a=S().cloneDeep(this.state.attributeValidationErrors);t.forEach((e=>{a.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.attributeMetaDataList.forEach((e=>{t.attributeValidationErrors[e.Code]=v.I5(e,e.DefaultValue)}))}))})),this.setState({validationErrors:s,attributeValidationErrors:a});var o=!0;return a.forEach((e=>{if(!o)return o;o=Object.values(e.attributeValidationErrors).every((function(e){return""===e}))})),o&&(o=Object.values(s).every((function(e){return""===e}))),i.messageResultDetails.length>0?(this.props.onSaved(this.state.modLocation,"update",i),!1):o}createLoadingArm(e){try{let t=[{key:p.Y4,value:e.Code},{key:p.Ln,value:this.props.transportationtype}],s={ShareHolderCode:"",keyDataCode:p.Y4,KeyCodes:t,Entity:e},i={messageType:"critical",message:["LoadingArmCodeSavedSuccess"],messageResultDetails:[{keyFields:["LoadingArmCode"],keyValues:[e.Code],isSuccess:!1,errorMessage:""}]};C()(g.lJO,v.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;i.messageType=t.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?(this.setState({saveEnabled:v.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.add,v.k5(this.props.transportationtype)),showSaveAuthenticationLayout:!1}),this.getLoadingArm({loadingArmCode:this.state.modLoadingArm.Code,selectedTerminal:this.props.selectedTerminal,isClone:!1})):(i.messageResultDetails[0].errorMessage=t.ErrorList[0],this.setState({saveEnabled:v.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.add,v.k5(this.props.transportationtype)),showSaveAuthenticationLayout:!1})),this.props.onSaved(this.state.modLoadingArm,"add",i)}))}catch(t){console.log("LoadingArmDetailsComposite:Error occured on createLoadingArm",t)}}updateLoadingArm(e){try{let t=[{key:p.Y4,value:e.Code},{key:p.Ln,value:this.props.transportationtype}],s={ShareHolderCode:"",keyDataCode:p.Y4,KeyCodes:t,Entity:e},i={messageType:"critical",message:["LoadingArmCodeSavedSuccess"],messageResultDetails:[{keyFields:["LoadingArmCode"],keyValues:[e.Code],isSuccess:!1,errorMessage:""}]};C()(g.Q2W,v.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;i.messageType=t.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?(this.setState({saveEnabled:v.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.modify,v.k5(this.props.transportationtype)),showSaveAuthenticationLayout:!1}),this.getLoadingArm({loadingArmCode:this.state.modLoadingArm.Code,selectedTerminal:this.props.selectedTerminal,isClone:!1})):(i.messageResultDetails[0].errorMessage=t.ErrorList[0],this.setState({saveEnabled:v.ab(this.props.userDetails.EntityResult.FunctionsList,f.i.modify,v.k5(this.props.transportationtype)),showSaveAuthenticationLayout:!1})),this.props.onSaved(this.state.modLocation,"update",i)}))}catch(t){console.log("LoadingArmDetailsComposite:Error occured on updateLoadingArm",t)}}handleOperation(){return this.state.showDeleteAuthenticationLayout?this.handleDelete:this.saveLoadingArm}getFunctionGroupName(){return this.props.transportationtype===d.LY.RAIL?f.Z9:this.props.transportationtype===d.LY.MARINE?f.PP:f.x5}getFunctionName(){return this.state.showDeleteAuthenticationLayout?f.i.remove:""===this.state.loadingArm.Code?f.i.add:f.i.modify}render(){const e=[{fieldName:"DriverInfo_LastUpdated",fieldValue:new Date(this.state.loadingArm.LastUpdated).toLocaleDateString()+" "+new Date(this.state.modLoadingArm.LastUpdated).toLocaleTimeString()},{fieldName:"DriverInfo_LastActive",fieldValue:void 0!==this.state.modLoadingArm.LastActive&&null!==this.state.modLoadingArm.LastActive?new Date(this.state.modLoadingArm.LastActive).toLocaleDateString()+" "+new Date(this.state.modLoadingArm.LastActive).toLocaleTimeString():""},{fieldName:"DriverInfo_CreatedTime",fieldValue:new Date(this.state.modLoadingArm.Created).toLocaleDateString()+" "+new Date(this.state.modLoadingArm.Created).toLocaleTimeString()}];return this.state.isReadyToRender?(0,c.jsxs)("div",{children:[(0,c.jsx)(r.A,{children:(0,c.jsx)(D.A,{entityCode:this.state.loadingArm.Code,newEntityName:"Loadingrm_Headder",popUpContents:e})}),(0,c.jsx)(r.A,{children:(0,c.jsx)(h,{loadingArm:this.state.loadingArm,modLoadingArm:this.state.modLoadingArm,modAssociations:this.state.modAssociations,handleCellDataEdit:this.handleCellDataEdit,IsDualBay:this.state.IsDualBay,deviceModel:this.state.deviceModel,listOptions:{deviceBlendOptions:this.state.deviceBlendOptions,loadingTypeOptions:this.state.loadingTypeOptions,densityUOMOptions:this.state.densityUOMOptions},selectedRows:this.state.selectedRows,handleRowSelectionChange:this.handleRowSelectionChange,validationErrors:this.state.validationErrors,onFieldChange:this.handleChange,selectedAttributeList:this.state.selectedAttributeList,attributeValidationErrors:this.state.attributeValidationErrors,attributeMetaDataList:this.state.attributeMetaDataList,handleAttributeCellDataEdit:this.handleAttributeCellDataEdit,onActiveStatusChange:this.handleActiveStatusChange,possibleSwingArmList:this.state.possibleSwingArmAssociations,selectedSwingArmAssociations:this.state.selectedSwingArmAssociations,onSwingArmAssociationSelectionChange:this.handleSwingArmAssociationSelectionChange})}),(0,c.jsx)(r.A,{children:(0,c.jsx)(u.E,{isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,handleSave:this.handleSave,handleDelete:this.authenticateDelete,saveEnabled:this.state.saveEnabled,isDeleteEnabled:this.state.isDeleteEnabled})}),this.state.showDeleteAuthenticationLayout||this.state.showSaveAuthenticationLayout?(0,c.jsx)(w.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:this.getFunctionName(),functionGroup:this.getFunctionGroupName(),handleClose:this.handleAuthenticationClose,handleOperation:this.handleOperation()}):null]}):(0,c.jsx)(m.A,{message:"Loading"})}}const I=(0,A.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(T)}}]);
//# sourceMappingURL=7596.a7c9bff1.chunk.js.map