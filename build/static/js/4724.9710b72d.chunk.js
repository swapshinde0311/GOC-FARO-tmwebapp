"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[4724],{84724:(e,t,s)=>{s.r(t),s.d(t,{default:()=>j});var i=s(65043),o=s(72711),a=s(67907),r=s(78374),n=s(69062),l=s(70579);function d(e){let{CustomerRecipe:t,modCustomerRecipe:s,validationErrors:i,onFieldChange:d,isEnterpriseNode:c,Customers:u,terminalCodes:h,finishedProducts:m,handleCellDataEdit:p,handleFinishedProductChange:C,handleActiveStatusChange:R,handleTerminalChange:v}=e;const g=e=>(0,l.jsx)(o.Input,{fluid:!0,value:s.FinishedProduct.FinishedProductItems[e.rowIndex][e.field],onChange:t=>p(t,e),reserveSpace:!1});return(0,l.jsx)(a.TranslationConsumer,{children:e=>(0,l.jsxs)("div",{className:"detailsContainer",children:[(0,l.jsxs)("div",{className:"row",children:[(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Input,{fluid:!0,value:s.Code,label:e("CustomerRecipe_Code"),indicator:"required",disabled:""!==t.Code,onChange:e=>d("Code",e),error:e(i.Code),reserveSpace:!1})}),c?(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Select,{fluid:!0,placeholder:"Select",value:s.TerminalCode,disabled:""!==t.TerminalCode,label:e("CustomerRecipe_AssociatedTerminal"),indicator:"required",options:n.Zj(h),onChange:e=>{d("TerminalCode",e),v(e)},error:e(i.TerminalCode),multiple:!1,reserveSpace:!1,search:!0,noResultsMessage:e("noResultsMessage")})}):"",(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Select,{fluid:!0,placeholder:"Select",value:void 0!==s.FinishedProduct&&null!==s.FinishedProduct?s.FinishedProduct.Code:"",label:e("CustomerRecipe_FinishedProduct"),indicator:"required",options:m,onChange:e=>{d("CustomerRecipefinishedProducts",e),C(e)},disabled:""!==t.Code,multiple:!1,reserveSpace:!1,search:!0,error:e(i.CustomerRecipefinishedProducts),noResultsMessage:e("noResultsMessage")})}),(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Select,{fluid:!0,placeholder:"Select",value:s.CustomerCodes,label:e("CustomerRecipe_AssociatedCustomers"),indicator:"required",options:u,onChange:e=>d("CustomerCodes",e),multiple:!0,reserveSpace:!1,search:!0,error:e(i.CustomerCodes),noResultsMessage:e("noResultsMessage")})}),(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Select,{fluid:!0,placeholder:"Select",label:e("CustomerRecipe_Status"),value:s.Status,options:[{text:e("ViewShipment_Ok"),value:!0},{text:e("ViewShipmentStatus_Inactive"),value:!1}],onChange:e=>R(e)})}),(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Input,{fluid:!0,value:s.Remarks,label:e("CustomerRecipe_Remarks"),indicator:s.Status!==t.Status?"required":"",error:e(i.Remarks),onChange:e=>d("Remarks",e),reserveSpace:!1})})]}),(0,l.jsx)("div",{className:"row compartmentRow",children:(0,l.jsx)("div",{className:"col col-md-8 col-lg-9 col col-xl-9",children:(0,l.jsx)("h4",{children:e("CustomerRecipe_AssociatedBaseProducts")})})}),(0,l.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,l.jsx)("div",{className:"col-12 detailsTable",children:(0,l.jsxs)(r.bQ,{data:void 0!==s.FinishedProduct&&null!==s.FinishedProduct&&void 0!==s.FinishedProduct.FinishedProductItems&&null!==s.FinishedProduct.FinishedProductItems?s.FinishedProduct.FinishedProductItems:[],scrollable:!0,scrollHeight:"320px",children:[(0,l.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",renderer:e=>null!==e.rowData.BaseProductCode&&void 0!==e.rowData.BaseProductCode&&""!==e.rowData.BaseProductCode&&0!==e.rowData.Version?e.rowData.BaseProductCode:e.rowData.AdditiveCode,header:e("CustomerRecipe_BaseProductCode"),editFieldType:"text"},"BaseProductCode"),(0,l.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",header:e("CustomerRecipe_IsAdditive"),renderer:e=>null!==e.rowData.BaseProductCode&&void 0!==e.rowData.BaseProductCode&&""!==e.rowData.BaseProductCode&&0!==e.rowData.Version?"N":"Y",editFieldType:"text"},"IsAdditive"),(0,l.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"Quantity",header:e("CustomerRecipe_AbsoluteNumber"),editable:!0,editFieldType:"text",customEditRenderer:g},"Quantity")]})})})]})})}d.defaultProps={isEnterpriseNode:!1};var c=s(9256),u=s(44192),h=s(46100),m=s(40854),p=s.n(m),C=s(72067),R=s(97508),v=s(65187),g=s(43503),y=s(93779),S=s(80312),D=s(53536),E=s.n(D),P=s(40252),F=s(62900),f=s(28882),b=s(14159),x=s(11981);class T extends i.Component{constructor(){super(...arguments),this.state={CustomerRecipe:E().cloneDeep(h.Uv),modCustomerRecipe:{},validationErrors:n.Th(u.HO),isReadyToRender:!1,saveEnabled:!1,customerKPIList:[],Customers:[],terminalCodes:this.props.userDetails.EntityResult.IsEnterpriseNode?this.getTerminalList():[],finishedProducts:[],showAuthenticationLayout:!1},this.handleChange=(e,t)=>{try{const s=E().cloneDeep(this.state.modCustomerRecipe),i=E().cloneDeep(this.state.validationErrors);s[e]=t,this.setState({modCustomerRecipe:s}),void 0!==u.HO[e]&&(i[e]=n.jr(u.HO[e],t),this.setState({validationErrors:i})),void 0!==u.HO[e]&&(i[e]=n.jr(u.HO[e],t)),this.setState({modCustomerRecipe:s,validationErrors:i})}catch(s){console.log("CustomerRecipeDetailsComposite:Error occured on handleChange",s)}},this.handleTerminalChange=e=>{this.getFinishedProductList(e),this.getcustomerList(e)},this.handleFinishedProductChange=e=>{try{let t=E().cloneDeep(this.state.modCustomerRecipe);t.FinishedProduct.Code=e,this.getFinishedProduct(e,this.props.selectedShareholder),this.setState({modCustomerRecipe:t})}catch(t){console.log(t)}},this.handleActiveStatusChange=e=>{try{let t=E().cloneDeep(this.state.modCustomerRecipe);t.Status=e,t.Status!==this.state.CustomerRecipe.Status&&(t.Remarks=""),this.setState({modCustomerRecipe:t})}catch(t){console.log(t)}},this.saveCustomerRecipe=()=>{try{this.setState({saveEnabled:!1});let e=E().cloneDeep(this.state.CustomerRecipe),t=E().cloneDeep(this.state.modCustomerRecipe);""===e.Code?this.createCustomerRecipe(t):this.updateCustomerRecipe(t)}catch(e){console.log("CustomerRecipeDetailsComposite : Error in saveCustomerRecipe")}},this.handleSave=()=>{try{let e=E().cloneDeep(this.state.modCustomerRecipe);if(this.validateSave(e)){let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showAuthenticationLayout:e},(()=>{!1===e&&this.saveCustomerRecipe()}))}else this.setState({saveEnabled:!0})}catch(e){console.log("CustomerRecipeDetailsComposite:Error occured on handleSave",e)}},this.handleReset=()=>{try{const t={...this.state.validationErrors},s=E().cloneDeep(this.state.CustomerRecipe);if(Object.keys(t).forEach((function(e){t[e]=""})),this.setState({modCustomerRecipe:{...s},validationErrors:t}),""===this.state.CustomerRecipe.Code){var e=this.state.terminalCodes;e=[],this.setState({terminalCodes:e})}}catch(t){console.log("CustomerRecipeDetailsComposite:Error occured on handleReset",t)}},this.handleCellDataEdit=(e,t)=>{let s=E().cloneDeep(this.state.modCustomerRecipe);s.FinishedProduct.FinishedProductItems[t.rowIndex][t.field]=e,this.setState({modCustomerRecipe:s})},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}getFinishedProduct(e,t){var s=[{key:y.xf,value:e}],i={ShareHolderCode:t,keyDataCode:y.xf,KeyCodes:s};p()(C.cfM,n.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data,s=E().cloneDeep(this.state.modCustomerRecipe);t.IsSuccess?Array.isArray(t.EntityResult.FinishedProductItems)&&t.EntityResult.FinishedProductItems.length>0&&(s.FinishedProduct.FinishedProductItems=t.EntityResult.FinishedProductItems,this.setState({modCustomerRecipe:s})):console.log("Error in getFinishedProduct:",t.ErrorList)})).catch((e=>{console.log("Error while getting Finished Product:",e)}))}componentWillReceiveProps(e){try{""!==this.state.CustomerRecipe.Code&&void 0===e.selectedRow.CustomerRecipe_Code&&this.props.tokenDetails.tokenInfo===e.tokenDetails.tokenInfo&&this.getCustomerRecipe(e.selectedRow)}catch(t){console.log("CustomerRecipeDetailsComposite:Error occured on componentWillReceiveProps",t)}}componentDidMount(){try{n.pJ(this.props.userDetails.EntityResult.IsArchived),this.getCustomerRecipe(this.props.selectedRow)}catch(e){console.log("CustomerRecipeDetailsComposite:Error occured on componentDidMount",e)}}getTerminalList(){return this.props.terminalList}getFinishedProductList(e){this.setState({finishedProducts:[]}),p()(C.w43+"?ShareholderCode="+this.props.selectedShareholder+"&TerminalCode="+e,n.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess&&Array.isArray(t.EntityResult)&&t.EntityResult.length>0){let e=n.Zj(t.EntityResult);this.setState({finishedProducts:e})}}))}getcustomerList(e){this.setState({Customers:[]}),p()(C.mHO+"?ShareholderCode="+this.props.selectedShareholder,n.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{let s=t.data,i=this.props.userDetails.EntityResult.IsEnterpriseNode;if(!0===s.IsSuccess){let t=[];s.EntityResult.Table.forEach((s=>{i&&s.TerminalCodes.indexOf(e)>-1?t.push(s.Common_Code):i||t.push(s.Common_Code)}));let o=n.Zj(t);this.setState({Customers:o,isReadyToRender:!0})}else this.setState({Customers:[],isReadyToRender:!0}),console.log("Error in GetCustomerListForRole:",s.ErrorList)})).catch((e=>{this.setState({Customers:[],isReadyToRender:!0}),console.log("Error while getting Customer List:",e)}))}initialFPAndCustomer(e){this.getFinishedProductList(e),this.getcustomerList(e)}getCustomerRecipe(e){let t=this.props.userDetails.EntityResult.IsEnterpriseNode?e.TerminalCode:this.props.userDetails.EntityResult.TerminalCode;if(h.Uv.ShareholderCode=this.props.selectedShareholder,void 0===e.CustomerRecipe_Code)return this.props.userDetails.EntityResult.IsEnterpriseNode||this.initialFPAndCustomer(t),void this.setState({CustomerRecipe:E().cloneDeep(h.Uv),modCustomerRecipe:E().cloneDeep(h.Uv),isReadyToRender:!0,customerKPIList:[],saveEnabled:n.ab(this.props.userDetails.EntityResult.FunctionsList,S.i.add,S.b0)});var s=[{key:y.iH,value:e.CustomerRecipe_Code},{key:y.uw,value:t},{key:y.xf,value:e.FinishedProduct_Code}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:y.iH,KeyCodes:s};p()(C.Xbf,n.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){let e=E().cloneDeep(t.EntityResult);this.initialFPAndCustomer(e.TerminalCode),this.setState({isReadyToRender:!0,CustomerRecipe:e,modCustomerRecipe:e,saveEnabled:n.ab(this.props.userDetails.EntityResult.FunctionsList,S.i.modify,S.b0)})}else this.setState({CustomerRecipe:E().cloneDeep(h.Uv),modCustomerRecipe:E().cloneDeep(h.Uv),isReadyToRender:!0}),console.log("Error in GetCustomer:",t.ErrorList)})).catch((t=>{console.log("Error while getting Customer:",t,e)}))}validateSave(e){var t=E().cloneDeep(this.state.validationErrors);Object.keys(u.HO).forEach((function(s){t[s]=n.jr(u.HO[s],e[s])})),e.Status!==this.state.CustomerRecipe.Status&&(null!==e.Remarks&&""!==e.Remarks||(t.Remarks="OriginTerminal_RemarksRequired")),""===e.FinishedProduct.Code||void 0===e.FinishedProduct.Code||null===e.FinishedProduct.Code?t.CustomerRecipefinishedProducts="CustomerRecipeDetails_reqFinishedProduct":t.CustomerRecipefinishedProducts="",this.props.userDetails.EntityResult.IsEnterpriseNode||(t.TerminalCode="");var s;s=Object.values(t).every((function(e){return""===e})),this.setState({validationErrors:t});let i={messageType:"critical",message:"CUSTOMERRECIPE_SavedStatus",messageResultDetails:[]};return e.FinishedProduct.FinishedProductItems.length>0&&e.FinishedProduct.FinishedProductItems.forEach((e=>{let t="";void 0!==f.lD[0].validator&&(t=n.jr(f.lD[0].validator,e.Quantity)),""!==t&&i.messageResultDetails.push({keyFields:[f.lD[0].displayName],keyValues:[e[f.lD[0].field]],isSuccess:!1,errorMessage:t})})),i.messageResultDetails.length>0?((0,b.toast)((0,l.jsx)(v.A,{children:(0,l.jsx)(x.A,{notificationMessage:i})}),{autoClose:"success"===i.messageType&&1e4}),!1):s}convertStringtoDecimal(e){try{return null!==e.Density&&""!==e.Density&&(e.Density=n.bo(e.Density)),null!==e.ToleranceQuantity&&""!==e.ToleranceQuantity&&(e.ToleranceQuantity=n.bo(e.ToleranceQuantity)),null!==e.ToleranceQuantityForMarine&&""!==e.ToleranceQuantityForMarine&&(e.ToleranceQuantityForMarine=n.bo(e.ToleranceQuantityForMarine)),null!==e.ToleranceQuantityForPipeline&&""!==e.ToleranceQuantityForPipeline&&(e.ToleranceQuantityForPipeline=n.bo(e.ToleranceQuantityForPipeline)),null!==e.ToleranceQuantityForRail&&""!==e.ToleranceQuantityForRail&&(e.ToleranceQuantityForRail=n.bo(e.ToleranceQuantityForRail)),this.state.hazardousEnabled&&null!==e.SFLPercent&&""!==e.SFLPercent&&(e.SFLPercent=n.bo(e.SFLPercent)),e}catch(t){console.log("convertStringtoDecimal error finishedProduct details",t)}}createCustomerRecipe(e){e.FinishedProduct=this.convertStringtoDecimal(e.FinishedProduct);var t=[{key:y.iH,value:e.Code}],s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:y.iH,KeyCodes:t,Entity:e},i={messageType:"critical",message:"CustomerRecipeDetails_SavedStatus",messageResultDetails:[{keyFields:["CustomerRecipe_Code"],keyValues:[e.Code],isSuccess:!1,errorMessage:""}]};p()(C.vsn,n.tW(s,this.props.tokenDetails.tokenInfo)).then((t=>{var s=t.data;i.messageType=s.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?this.setState({saveEnabled:n.ab(this.props.userDetails.EntityResult.FunctionsList,S.i.modify,S.b0),showAuthenticationLayout:!1},(()=>this.getCustomerRecipe({CustomerRecipe_Code:e.Code,FinishedProduct_Code:e.FinishedProduct.Code,TerminalCode:e.TerminalCode}))):(i.messageResultDetails[0].errorMessage=s.ErrorList[0],this.setState({saveEnabled:n.ab(this.props.userDetails.EntityResult.FunctionsList,S.i.add,S.b0),showAuthenticationLayout:!1}),console.log("Error in CreateCustomer:",s.ErrorList)),this.props.onSaved(e,"add",i)})).catch((t=>{this.setState({saveEnabled:n.ab(this.props.userDetails.EntityResult.FunctionsList,S.i.add,S.b0),showAuthenticationLayout:!1}),i.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"add",i)}))}updateCustomerRecipe(e){let t=[{key:y.iH,value:e.Code}],s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:y.iH,KeyCodes:t,Entity:e},i={messageType:"critical",message:"CustomerRecipeDetails_SavedStatus",messageResultDetails:[{keyFields:["CustomerRecipe_Code"],keyValues:[e.Code],isSuccess:!1,errorMessage:""}]};p()(C.k63,n.tW(s,this.props.tokenDetails.tokenInfo)).then((t=>{var s=t.data;i.messageType=s.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?this.setState({saveEnabled:n.ab(this.props.userDetails.EntityResult.FunctionsList,S.i.modify,S.b0),showAuthenticationLayout:!1},(()=>this.getCustomerRecipe({CustomerRecipe_Code:e.Code,FinishedProduct_Code:e.FinishedProduct.Code,TerminalCode:e.TerminalCode}))):(i.messageResultDetails[0].errorMessage=s.ErrorList[0],this.setState({saveEnabled:n.ab(this.props.userDetails.EntityResult.FunctionsList,S.i.modify,S.b0),showAuthenticationLayout:!1}),console.log("Error in UpdateCustomerRecipe:",s.ErrorList)),this.props.onSaved(e,"update",i)})).catch((t=>{i.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"modify",i),this.setState({saveEnabled:n.ab(this.props.userDetails.EntityResult.FunctionsList,S.i.modify,S.b0),showAuthenticationLayout:!1})}))}render(){const e=[{fieldName:"Cust_LastUpDt",fieldValue:new Date(this.state.modCustomerRecipe.LastUpdatedTime).toLocaleDateString()+" "+new Date(this.state.modCustomerRecipe.LastUpdatedTime).toLocaleTimeString()},{fieldName:"Cust_CreateDt",fieldValue:new Date(this.state.modCustomerRecipe.CreatedTime).toLocaleDateString()+" "+new Date(this.state.modCustomerRecipe.CreatedTime).toLocaleTimeString()}];return this.state.isReadyToRender?(0,l.jsxs)("div",{children:[(0,l.jsx)(v.A,{children:(0,l.jsx)(g.A,{entityCode:this.state.CustomerRecipe.Code,newEntityName:"CustomerRecipe_Title",popUpContents:e})}),(0,l.jsx)(v.A,{children:(0,l.jsx)(d,{CustomerRecipe:this.state.CustomerRecipe,modCustomerRecipe:this.state.modCustomerRecipe,validationErrors:this.state.validationErrors,Customers:this.state.Customers,terminalCodes:this.state.terminalCodes,finishedProducts:this.state.finishedProducts,onFieldChange:this.handleChange,handleFinishedProductChange:this.handleFinishedProductChange,handleActiveStatusChange:this.handleActiveStatusChange,handleTerminalChange:this.handleTerminalChange,isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,handleCellDataEdit:this.handleCellDataEdit})}),(0,l.jsx)(v.A,{children:(0,l.jsx)(c.q,{handleBack:this.props.onBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.saveEnabled})}),this.state.showAuthenticationLayout?(0,l.jsx)(F.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:""===this.state.CustomerRecipe.Code?S.i.add:S.i.modify,functionGroup:S.b0,handleOperation:this.saveCustomerRecipe,handleClose:this.handleAuthenticationClose}):null]}):(0,l.jsx)(P.A,{message:"Loading"})}}const j=(0,R.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(T)},43503:(e,t,s)=>{s.d(t,{A:()=>n});s(65043);var i=s(67907),o=s(72711),a=s(70579);function r(e){let{entityCode:t,newEntityName:s,popUpContents:r}=e;return(0,a.jsx)(i.TranslationConsumer,{children:e=>(0,a.jsx)("div",{className:"headerContainer",children:(0,a.jsxs)("div",{className:"row headerSpacing",children:[(0,a.jsx)("div",{className:"col paddingHeaderItemLeft",children:(0,a.jsx)("span",{style:{margin:"auto"},className:"headerLabel",children:""===t||void 0===t?e(s):t})}),""!==t&&void 0!==t&&r.length>0?(0,a.jsx)("div",{className:"headerItemRight",children:(0,a.jsx)(o.Popup,{element:(0,a.jsxs)("div",{children:[e(r[0].fieldName)+" ",":"," "+r[0].fieldValue,(0,a.jsx)(o.Icon,{style:{marginLeft:"10px"},root:"common",name:"caret-down",size:"small"})]}),position:"bottom left",children:(0,a.jsx)(o.List,{className:"detailsHeaderPopUp",children:r.map((t=>(0,a.jsxs)(o.List.Content,{className:"detailsHeaderPopUpListPadding",children:[e(t.fieldName)+" ",":"," "+t.fieldValue]},"content.fieldName")))})})}):""]})})})}r.defaultProps={entityCode:"",newEntityName:"",popUpContents:[]};const n=r},9256:(e,t,s)=>{s.d(t,{q:()=>r});s(65043);var i=s(72711),o=s(67907),a=s(70579);function r(e){let{handleBack:t,handleSave:s,handleReset:r,saveEnabled:n}=e;return(0,a.jsx)(o.TranslationConsumer,{children:e=>(0,a.jsxs)("div",{className:"row userActionPosition",children:[(0,a.jsx)("div",{className:"col-12 col-md-3 col-lg-4",children:(0,a.jsx)(i.Button,{className:"backButton",onClick:t,content:e("Back")})}),(0,a.jsx)("div",{className:"col-12 col-md-9 col-lg-8",children:(0,a.jsxs)("div",{style:{float:"right"},children:[(0,a.jsx)(i.Button,{content:e("LookUpData_btnReset"),className:"cancelButton",onClick:r}),(0,a.jsx)(i.Button,{content:e("Save"),disabled:!n,onClick:s})]})})]})})}r.defaultProps={saveEnabled:!1}}}]);
//# sourceMappingURL=4724.9710b72d.chunk.js.map