"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[4947],{24947:(e,t,a)=>{a.r(t),a.d(t,{default:()=>k});var s=a(65043),r=a(97508),i=a(65187),n=a(11981),o=a(14159),l=a(93779),d=a(40854),u=a.n(d),c=a(7523),p=a(72067),h=a(67907),m=a(72711),M=a(69062),T=a(35861),S=a(85800),E=a(70579);function C(e){let{modPipelineSnapshotInfo:t,modPipelineTankTransactionSnapshotInfo:a,modPipelineMeterTransactionSnapshotInfo:s,tankValidationErrors:r,meterValidationErrors:n,listOptions:o,modAttributeMetaDataList:l,attributeValidationErrors:d,onFieldChange:u,onTabChange:c,onAttributeDataChange:p,activeIndex:C,receipt:y,isMeterRequired:D,isTankRequired:v,onDateTextChange:U}=e;const P=(e,t)=>{let a=[];return void 0!==e&&(a=e.find((e=>e.TerminalCode===t))),a.attributeValidationErrors};return(0,E.jsx)(h.TranslationConsumer,{children:e=>(0,E.jsx)("div",{children:(0,E.jsxs)("div",{className:"detailsContainer",children:[(0,E.jsxs)("div",{className:"row",children:[(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:y.FinishedProductCode,label:e("PipelineDispatch_FinishedProductCode"),disabled:!0,reserveSpace:!1})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:y.PipelineReceiptCode,label:e("PipelineEntry_PipelineReceiptCode"),disabled:!0,reserveSpace:!1})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:y.PipelineHeaderCode,label:e("PipelineEntry_PipelineHeaderCode"),disabled:!0,reserveSpace:!1})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Select,{fluid:!0,value:o.tankCodes,label:e("PipelineEntry_PlanedTank"),options:M.Zj(o.tankCodes),disabled:!0,multiple:!0,reserveSpace:!1})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Select,{fluid:!0,value:o.meterCodes,label:e("PipelineEntry_PlanedMeter"),options:M.Zj(o.meterCodes),disabled:!0,multiple:!0,reserveSpace:!1})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.DatePicker,{fluid:!0,value:new Date(a.ScanStartTime),label:e("PipelineEntry_CaptureStartTime"),type:"datetime",displayFormat:(0,T.F1)(),disablePast:!1,disableFuture:!0,indicator:"required",onChange:e=>u("Tank","ScanStartTime",e),onTextChange:(e,t)=>{U("ScanStartTime",e,t)},error:e(r.ScanStartTime),reserveSpace:!1})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.DatePicker,{fluid:!0,value:new Date(a.ScanEndTime),label:e("PipelineEntry_CaptureEndTime"),type:"datetime",displayFormat:(0,T.F1)(),disablePast:!1,disableFuture:!0,indicator:"required",onChange:e=>u("Tank","ScanEndTime",e),onTextChange:(e,t)=>{U("ScanEndTime",e,t)},error:e(r.ScanEndTime),reserveSpace:!1})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:t.Remarks,label:e("LoadingDetailsEntry_Remarks"),onChange:e=>u("Remarks",e),reserveSpace:!1,error:e(r.Remarks)})})]}),l.length>0?l.map((t=>(0,E.jsx)(i.A,{children:(0,E.jsx)(m.Accordion,{children:(0,E.jsx)(m.Accordion.Content,{className:"attributeAccordian",title:e("Attributes_Header"),children:(0,E.jsx)(S.n,{selectedAttributeList:t.attributeMetaDataList,handleCellDataEdit:p,attributeValidationErrors:P(d,t.TerminalCode)})})})}))):null,(0,E.jsxs)(m.Tab,{activeIndex:C,onTabChange:e=>c(e),children:[(0,E.jsx)(m.Tab.Pane,{title:e("Pipeline_Header_meter_Level_Trasaction"),children:(0,E.jsxs)("div",{className:"row",children:[(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("PipelineEntry_PipelineMeterCode"),value:s.MeterCode,onChange:e=>u("Meter","MeterCode",e),indicator:D?"required":null,error:e(n.MeterCode),options:M.Zj(o.meterCodes),reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:s.GrossStartTotalizer,label:e("PipelineMeter_StartGrossTotalizer"),onChange:e=>u("Meter","GrossStartTotalizer",e),reserveSpace:!1,error:e(n.GrossStartTotalizer),indicator:""!==s.MeterCode?"required":null})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:s.NetStartTotalizer,label:e("PipelineMeter_StartNetTotalizer"),onChange:e=>u("Meter","NetStartTotalizer",e),reserveSpace:!1,error:e(n.NetStartTotalizer),indicator:""!==s.MeterCode?"required":null})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:s.GrossEndTotalizer,label:e("PipelineMeter_EndGrossTotalizer"),onChange:e=>u("Meter","GrossEndTotalizer",e),reserveSpace:!1,error:e(n.GrossEndTotalizer),indicator:""!==s.MeterCode?"required":null})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:s.NetEndTotalizer,label:e("TankMeter_EndNetTotalizer"),onChange:e=>u("Meter","NetEndTotalizer",e),reserveSpace:!1,error:e(n.NetEndTotalizer),indicator:""!==s.MeterCode?"required":null})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:s.Temperature,label:e("LoadingDetailsEntry_Temperature"),onChange:e=>u("Meter","Temperature",e),reserveSpace:!1,error:e(n.Temperature)})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Select,{fluid:!0,value:s.TemperatureUOM,options:o.temperatureUOMs,placeholder:"Select",label:e("MarineDispatchManualEntry_TemperatureUOM"),onChange:e=>u("Meter","TemperatureUOM",e),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(n.TemperatureUOM),indicator:""!==s.Temperature?"required":null})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:s.Density,label:e("Density"),onChange:e=>u("Meter","Density",e),reserveSpace:!1,error:e(n.Density)})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Select,{fluid:!0,value:s.DensityUOM,options:o.densityUOMS,placeholder:"Select",label:e("BaseProductInfox_UOM"),onChange:e=>u("Meter","DensityUOM",e),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(n.DensityUOM),indicator:""!==s.Density?"required":null})})]})}),(0,E.jsx)(m.Tab.Pane,{title:e("Pipeline_Tank_Level_Trasaction"),children:(0,E.jsxs)("div",{className:"row",children:[(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("AtgConfigure_TankCode"),value:a.TankCode,onChange:e=>u("Tank","TankCode",e),indicator:v?"required":null,error:e(r.TankCode),options:M.Zj(o.tankCodes),reserveSpace:!1,noResultsMessage:e("noResultsMessage")})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:a.GrossMass,label:e("TankInfo_GrossMass"),onChange:e=>u("Tank","GrossMass",e),reserveSpace:!1,error:e(r.GrossMass)})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Select,{fluid:!0,value:a.MassUOM,options:o.quantityUOMOptions,placeholder:"Select",label:e("TankEODEntry_MassQuantityUOM"),onChange:e=>u("Tank","MassUOM",e),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(r.MassUOM),indicator:""!==a.GrossMass?"required":null})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:a.GrossStartVolume,label:e("Gross_start_Volume"),onChange:e=>u("Tank","GrossStartVolume",e),reserveSpace:!1,error:e(r.GrossStartVolume),indicator:""!==a.TankCode?"required":null})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:a.NetStartVolume,label:e("Net_start_Volume"),onChange:e=>u("Tank","NetStartVolume",e),reserveSpace:!1,error:e(r.NetStartVolume),indicator:""!==a.TankCode?"required":null})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:a.GrossEndVolume,label:e("Gross_end_Volume"),onChange:e=>u("Tank","GrossEndVolume",e),reserveSpace:!1,error:e(r.GrossEndVolume),indicator:""!==a.TankCode?"required":null})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:a.NetEndVolume,label:e("Net_end_Volume"),onChange:e=>u("Tank","NetEndVolume",e),reserveSpace:!1,error:e(r.NetEndVolume),indicator:""!==a.TankCode?"required":null})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Select,{fluid:!0,value:a.VolumeUOM,options:o.volumeUOMs,placeholder:"Select",label:e("TankTransaction_VolumeUom"),onChange:e=>u("Tank","VolumeUOM",e),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(r.VolumeUOM),indicator:""!==a.TankCode?"required":null})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:a.Temperature,label:e("LoadingDetailsEntry_Temperature"),onChange:e=>u("Tank","Temperature",e),reserveSpace:!1,error:e(r.Temperature)})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Select,{fluid:!0,value:a.TemperatureUOM,options:o.temperatureUOMs,placeholder:"Select",label:e("MarineDispatchManualEntry_TemperatureUOM"),onChange:e=>u("Tank","TemperatureUOM",e),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(r.TemperatureUOM),indicator:""!==a.Temperature?"required":null})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:a.Density,label:e("Density"),onChange:e=>u("Tank","Density",e),reserveSpace:!1,error:e(r.Density)})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Select,{fluid:!0,value:a.DensityUOM,options:o.densityUOMS,placeholder:"Select",label:e("BaseProductInfox_UOM"),onChange:e=>u("Tank","DensityUOM",e),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(r.DensityUOM),indicator:""!==a.Density?"required":null})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Input,{fluid:!0,value:a.Pressure,label:e("LoadingDetailsEntry_Pressure"),onChange:e=>u("Tank","Pressure",e),reserveSpace:!1,error:e(r.Pressure)})}),(0,E.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,E.jsx)(m.Select,{fluid:!0,value:a.PressureUOM,options:o.pressureUOMs,placeholder:"Select",label:e("BCU_PressureUOM"),onChange:e=>u("Tank","PressureUOM",e),multiple:!1,reserveSpace:!1,search:!1,noResultsMessage:e("noResultsMessage"),error:e(r.PressureUOM),indicator:""!==a.Pressure?"required":null})})]})})]})]})})})}var y=a(9256),D=a(46100),v=a(53536),U=a.n(v),P=a(44192),g=a(15417),O=a(80312),b=a(62900);class f extends s.Component{constructor(){var e;super(...arguments),e=this,this.state={modPipelineSnapshotInfo:U().cloneDeep(D.uk),modPipelineTankTransactionSnapshotInfo:U().cloneDeep(D.$U),modPipelineMeterTransactionSnapshotInfo:U().cloneDeep(D.$U),quantityUOMOptions:[],densityUOMS:[],temperatureUOMs:[],volumeUOMs:[],pressureUOMs:[],tankCodes:[],meterCodes:[],tankValidationErrors:M.Th(P.nN),meterValidationErrors:M.Th(P.nN),attributeMetaDataList:[],modAttributeMetaDataList:[],attributeValidationErrors:[],activeIndex:0,manualEntrySaveEnable:!0,showAuthenticationLayout:!1,tempPipelineSnapshotInfo:{}},this.addUnLoadingDetails=()=>{try{this.setState({saveEnabled:!1});let e=U().cloneDeep(this.state.tempPipelineSnapshotInfo);this.CreateManualEntry(e)}catch(e){console.log("Pipeline Receipt Manual Entry Composite : Error in addUnLoadingDetails")}},this.handleSave=()=>{try{let e=M.pI(this.state.modAttributeMetaDataList);if(this.validateSave(e)){let t=this.fillDetails(e),a=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,s=U().cloneDeep(t);this.setState({showAuthenticationLayout:a,tempPipelineSnapshotInfo:s},(()=>{!1===a&&this.addUnLoadingDetails()}))}else this.setState({manualEntrySaveEnable:!0})}catch(e){console.log("PipelineReceiptManualEntryDetailsComposite:Error occured on handleSave",e)}},this.handleReset=()=>{try{let e=U().cloneDeep(D.$U),t=U().cloneDeep(D.$U);this.state.isMeterRequired&&null!==this.state.meterCodes&&1===this.state.meterCodes.length&&(t.MeterCode=this.state.meterCodes[0]);const a={...this.state.tankValidationErrors},s={...this.state.meterValidationErrors};Object.keys(a).forEach((function(e){a[e]=""})),Object.keys(s).forEach((function(e){s[e]=""})),this.setState({modPipelineMeterTransactionSnapshotInfo:t,modPipelineTankTransactionSnapshotInfo:e,tankValidationErrors:a,meterValidationErrors:s},(()=>{this.setDefaultValues()}))}catch(e){console.log("PipelineReceiptManualEntryDetailsComposite: Error in reset")}},this.handleChange=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0;try{if("Tank"===t){let t=U().cloneDeep(e.state.modPipelineTankTransactionSnapshotInfo);const r=U().cloneDeep(e.state.tankValidationErrors);t[a]=s,"TankCode"===a?e.getTankDetails(t):"ScanEndTime"===a?(r.ScanStartTime="",e.setState({modPipelineTankTransactionSnapshotInfo:t})):e.setState({modPipelineTankTransactionSnapshotInfo:t}),void 0!==P.nN[a]&&(r[a]=M.jr(P.nN[a],s),e.setState({tankValidationErrors:r}))}else if("Meter"===t){let t=U().cloneDeep(e.state.modPipelineMeterTransactionSnapshotInfo);t[a]=s;const r=U().cloneDeep(e.state.meterValidationErrors);void 0!==P.nN[a]&&(r[a]=M.jr(P.nN[a],s)),e.setState({modPipelineMeterTransactionSnapshotInfo:t,meterValidationErrors:r})}else{let t=U().clone(e.state.modPipelineSnapshotInfo);t[a]=s;const r=U().cloneDeep(e.state.tankValidationErrors);void 0!==P.nN[a]&&(r[a]=M.jr(P.nN[a],s),e.setState({modPipelineSnapshotInfo:t,tankValidationErrors:r}))}}catch(r){console.log("PipelineReceiptManualEntryDetailsComposite : Error in handle change")}},this.handleDateTextChange=(e,t,a)=>{try{let s=U().cloneDeep(this.state.modPipelineTankTransactionSnapshotInfo);const r=U().cloneDeep(this.state.tankValidationErrors);r[e]=a,s[e]=t,this.setState({tankValidationErrors:r,modPipelineTankTransactionSnapshotInfo:s})}catch(a){console.log("PipelineReceiptManualEntryDetailsComposite:Error occured on handleDateTextChange",a)}},this.handleTabChange=e=>{this.setState({activeIndex:e})},this.handleAttributeDataChange=(e,t)=>{try{let a=[],s=U().cloneDeep(this.state.modAttributeMetaDataList),r=s.filter((t=>t.TerminalCode===e.TerminalCode));r.length>0&&Array.isArray(r[0].attributeMetaDataList)&&(a=r[0].attributeMetaDataList.filter((t=>t.Code===e.Code))),a.length>0&&(a[0].DefaultValue=t);const i=U().cloneDeep(this.state.attributeValidationErrors);i.forEach((a=>{a.TerminalCode===e.TerminalCode&&(a.attributeValidationErrors[e.Code]=M.I5(e,t))})),this.setState({attributeValidationErrors:i,modAttributeMetaDataList:s})}catch(a){console.log("PipelineDispatchtManualEntryDetailsComposite:Error occured on handleAttributeCellDataEditFP",a)}},this.handleTabChange=e=>{this.setState({activeIndex:e})},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})}}componentDidMount(){try{M.pJ(this.props.userDetails.EntityResult.IsArchived),this.GetUOMList(),this.getAttributes(),this.setDefaultValues()}catch(e){console.log("PipelineReceiptManualEntryDetailsComposite : Error occured on componentDidMount",e)}}setDefaultValues(){try{let e=U().cloneDeep(this.state.modPipelineTankTransactionSnapshotInfo),t=U().cloneDeep(this.state.modPipelineMeterTransactionSnapshotInfo);e.VolumeUOM=this.props.receipt.QuantityUOM,e.ScanStartTime=new Date,e.ScanEndTime=new Date,t.TemperatureUOM=this.props.userDetails.EntityResult.PageAttibutes.DefaultUOMS.TemperatureUOM,t.DensityUOM=this.props.userDetails.EntityResult.PageAttibutes.DefaultUOMS.DensityUOM,this.setState({modPipelineTankTransactionSnapshotInfo:e,modPipelineMeterTransactionSnapshotInfo:t},(()=>{this.getmeterCodes(),this.getTankCodes()}))}catch(e){console.log("PipelineReceiptManualEntryDetailsComposite : Error occured while setting default values",e)}}getTankDetails(e){try{var t=[{key:l.E7,value:e.TankCode},{key:l.uw,value:null!==this.props.receipt.TerminalCodes&&this.props.receipt.TerminalCodes.length>0?this.props.receipt.TerminalCodes[0]:null}],a={keyDataCode:l.E7,KeyCodes:t};u()(p.vQz,M.tW(a,this.props.tokenDetails.tokenInfo)).then((t=>{let a=t.data;if(a.IsSuccess){let t=a.EntityResult;e.PressureUOM=t.PressureUOM,e.MassUOM=t.GrossMassUOM,e.DensityUOM=t.DensityUOM,e.TemperatureUOM=t.TemperatureUOM,this.setState({modPipelineTankTransactionSnapshotInfo:e})}else this.setState({modPipelineTankTransactionSnapshotInfo:e})})).catch((e=>{console.log("PipelineReceiptManualEntryDetailsComposite : Error while getting Tank Details",e)}))}catch(s){console.log("PipelineReceiptManualEntryDetailsComposite : Error in getting Tank Details",s)}}getmeterCodes(){try{let e=U().cloneDeep(this.props.receipt);this.setState({meterCodes:[e.PipelineHeaderMeterCode]},(()=>{if(this.props.isMeterRequired&&1===this.state.meterCodes.length){let e=U().cloneDeep(this.state.modPipelineMeterTransactionSnapshotInfo);e.MeterCode=this.state.meterCodes[0],this.setState({modPipelineMeterTransactionSnapshotInfo:e})}}))}catch(e){console.log("PipelineReceiptManualEntryDetailsComposite : Error in getting meter codes",e)}}getTankCodes(){try{let e=null===this.props.receipt.FinishedProductCode||void 0===this.props.receipt.FinishedProductCode?"":this.props.receipt.FinishedProductCode,t=this.props.selectedShareholder;u()(p.gQ7+"?shCode="+t+"&finishedProductCode="+e,M.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){let e=[];e=t.EntityResult,this.setState({tankCodes:e},(()=>{if(this.props.isTankRequired&&1===e.length){let t=U().cloneDeep(this.state.modPipelineTankTransactionSnapshotInfo);t.TankCode=e[0],this.getTankDetails(t)}}))}}else console.log("PipelineReceiptManualEntryDetailsComposite: Error in getTankCodes:",t.ErrorList)})).catch((e=>{console.log("PipelineReceiptManualEntryDetailsComposite: Error while getting getTankCodes:",e)}))}catch(e){console.log("PipelineReceiptManualEntryDetailsComposite : error in getting tank codes")}}CreateManualEntry(e){this.handleAuthenticationClose();var t=[{key:l.FR,value:this.props.selectedShareholder},{key:l.ml,value:this.props.receipt.PipelineReceiptCode}],a={messageType:"critical",message:"PipelineReceipt_ManualEntryCreateStatus",messageResultDetails:[{keyFields:["PipelineReceiptDetails_ReceiptCode"],keyValues:[this.props.receipt.PipelineReceiptCode],isSuccess:!1,errorMessage:""}]},s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:l._C,KeyCodes:t,Entity:e};u()(p.F4O,M.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;a.messageType=t.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.setState({manualEntrySaveEnable:!0,modPipelineMeterTransactionSnapshotInfo:U().cloneDeep(D.$U),modPipelineTankTransactionSnapshotInfo:U().cloneDeep(D.$U)},(()=>{this.setDefaultValues();var e=U().cloneDeep(this.state.attributeMetaDataList);this.formAttributesForUI(e)})):(a.message="MarineDispatchManualEntry_SaveFailure",a.messageResultDetails[0].errorMessage=t.ErrorList[0],this.setState({manualEntrySaveEnable:!0,modPipelineMeterTransactionSnapshotInfo:U().cloneDeep(D.$U),modPipelineTankTransactionSnapshotInfo:U().cloneDeep(D.$U)},(()=>{this.setDefaultValues();var e=U().cloneDeep(this.state.attributeMetaDataList);this.formAttributesForUI(e)}))),(0,o.toast)((0,E.jsx)(i.A,{children:(0,E.jsx)(n.A,{notificationMessage:a})}),{autoClose:"success"===a.messageType&&1e4})})).catch((e=>{a.messageResultDetails[0].errorMessage=e,console.log("PipelineReceiptManualEntryDetailsComposite: Error while creating Manual Entry:",e)}))}fillDetails(e){let t={pipelineSnapshotInfoList:[],commonTransactionSnapshotInfoList:[]};try{e=M.SC(e);let a=M.Gh(e),s=U().cloneDeep(this.state.modPipelineSnapshotInfo),r=[];s.PlanCode=null===this.props.receipt.PipelineReceiptCode||""===this.props.receipt.PipelineReceiptCode?"":this.props.receipt.PipelineReceiptCode,s.PipelineHeaderCode=null===this.props.receipt.PipelineHeaderCode||""===this.props.receipt.PipelineHeaderCode?"":this.props.receipt.PipelineHeaderCode,s.TransactionType=c.Br.RECEIPT,s.ShareholderCode=null===this.props.selectedShareholder||""===this.props.selectedShareholder?"":this.props.selectedShareholder,r.push(s);let i=[],n=U().cloneDeep(this.state.modPipelineTankTransactionSnapshotInfo);if(""!==n.TankCode&&null!==n.TankCode){let e=U().cloneDeep(D.$U),t=U().cloneDeep(D.$U);e.TransactionType=c.Br.RECEIPT,t.TransactionType=c.Br.RECEIPT,e.ScanTime=n.ScanStartTime,t.ScanTime=n.ScanEndTime,null!==s.PipelineHeaderCode&&""!==s.PipelineHeaderCode&&(e.PipelineHeaderCode=s.PipelineHeaderCode,t.PipelineHeaderCode=s.PipelineHeaderCode),""!==n.TankCode&&null!==n.TankCode&&(e.TankCode=n.TankCode,t.TankCode=n.TankCode),""!==n.MeterCode&&null!==n.MeterCode&&(e.MeterCode=n.MeterCode,t.MeterCode=n.MeterCode),""!==n.FlowRate&&null!==n.FlowRate&&(e.FlowRate=M.bo(n.FlowRate),t.FlowRate=M.bo(n.FlowRate)),e.FlowRateUOM=n.FlowRateUOM,t.FlowRateUOM=n.FlowRateUOM,""!==n.GrossStartTotalizer&&null!==n.GrossStartTotalizer&&(e.GrossTotalizer=M.bo(n.GrossStartTotalizer),t.GrossTotalizer=M.bo(n.GrossEndTotalizer)),""!==n.NetStartTotalizer&&null!==n.NetStartTotalizer&&(e.NetTotalizer=M.bo(n.NetStartTotalizer),t.NetTotalizer=M.bo(n.NetEndTotalizer)),""!==n.NetEndTotalizer&&null!==n.NetEndTotalizer&&(t.NetTotalizer=M.bo(n.NetEndTotalizer)),""!==n.GrossStartVolume&&null!==n.GrossStartVolume&&(e.GrossVolume=M.bo(n.GrossStartVolume)),""!==n.GrossEndVolume&&null!==n.GrossEndVolume&&(t.GrossVolume=M.bo(n.GrossEndVolume)),""!==n.NetStartVolume&&null!==n.NetStartVolume&&(e.NetVolume=M.bo(n.NetStartVolume)),""!==n.NetEndVolume&&null!==n.NetEndVolume&&(t.NetVolume=M.bo(n.NetEndVolume)),""!==n.Temperature&&null!==n.Temperature&&(e.Temperature=M.bo(n.Temperature),t.Temperature=M.bo(n.Temperature)),""!==n.TemperatureUOM&&null!==n.TemperatureUOM&&(e.TemperatureUOM=n.TemperatureUOM,t.TemperatureUOM=n.TemperatureUOM),""!==n.Density&&null!==n.Density&&(e.Density=M.bo(n.Density),t.Density=M.bo(n.Density)),""!==n.DensityUOM&&null!==n.DensityUOM&&(e.DensityUOM=n.DensityUOM,t.DensityUOM=n.DensityUOM),""!==n.GrossMass&&null!==n.GrossMass&&(e.GrossMass=M.bo(n.GrossMass),t.GrossMass=M.bo(n.GrossMass),e.MassUOM=n.MassUOM,t.MassUOM=n.MassUOM),""!==n.Pressure&&null!==n.Pressure&&(e.Pressure=M.bo(n.Pressure),t.Pressure=M.bo(n.Pressure)),""!==n.PressureUOM&&null!==n.PressureUOM&&(e.PressureUOM=n.PressureUOM,t.PressureUOM=n.PressureUOM),e.IsManualEntry=!0,t.IsManualEntry=!0,e.LastUpdatedBy=this.props.userDetails.EntityResult.Firstname+" "+this.props.userDetails.EntityResult.LastName,t.LastUpdatedBy=this.props.userDetails.EntityResult.Firstname+" "+this.props.userDetails.EntityResult.LastName,e.Attributes=a,t.Attributes=a,""!==n.VolumeUOM&&null!==n.VolumeUOM&&(e.IsStart=!0,e.IsEnd=!1,t.IsStart=!1,t.IsEnd=!0,e.VolumeUOM=n.VolumeUOM,t.VolumeUOM=n.VolumeUOM),i.push(e),i.push(t)}let o=U().cloneDeep(this.state.modPipelineMeterTransactionSnapshotInfo);if(""!==o.MeterCode&&void 0!==o.MeterCode){let e=U().cloneDeep(D.$U),t=U().cloneDeep(D.$U);e.TransactionType=c.Br.RECEIPT,t.TransactionType=c.Br.RECEIPT,null!==s.PipelineHeaderCode&&""!==s.PipelineHeaderCode?(e.PipelineHeaderCode=s.PipelineHeaderCode,t.PipelineHeaderCode=s.PipelineHeaderCode):(e.PipelineHeaderCode="",t.PipelineHeaderCode=""),""!==o.Density&&null!==o.Density?(e.Density=M.bo(o.Density),t.Density=M.bo(o.Density)):(e.Density=0,t.Density=0),e.DensityUOM=o.DensityUOM,t.DensityUOM=o.DensityUOM,e.IsManualEntry=!0,t.IsManualEntry=!0,""!==o.MeterCode&&null!==o.MeterCode&&(e.MeterCode=o.MeterCode,t.MeterCode=o.MeterCode),""!==o.Temperature&&null!==o.Temperature&&(e.Temperature=M.bo(o.Temperature),t.Temperature=M.bo(o.Temperature)),e.TemperatureUOM=o.TemperatureUOM,t.TemperatureUOM=o.TemperatureUOM,""!==o.GrossStartTotalizer&&null!==o.GrossEndTotalizer&&(e.GrossTotalizer=M.bo(o.GrossStartTotalizer),t.GrossTotalizer=M.bo(o.GrossEndTotalizer)),""!==o.NetStartTotalizer&&null!==o.NetEndTotalizer&&(e.NetTotalizer=M.bo(o.NetStartTotalizer),t.NetTotalizer=M.bo(o.NetEndTotalizer)),e.ScanTime=n.ScanStartTime,t.ScanTime=n.ScanEndTime,e.LastUpdatedBy=this.props.userDetails.EntityResult.Firstname+" "+this.props.userDetails.EntityResult.LastName,t.LastUpdatedBy=this.props.userDetails.EntityResult.Firstname+" "+this.props.userDetails.EntityResult.LastName,e.Attributes=a,t.Attributes=a,e.IsStart=!0,e.IsEnd=!1,t.IsStart=!1,t.IsEnd=!0,i.push(e),i.push(t)}t.pipelineSnapshotInfoList=r,t.commonTransactionSnapshotInfoList=i}catch(a){console.log("PipelineReceiptManualEntryDetailsComposite:Error occured on handleSave",a)}return t}validateSave(e){const t={...this.state.tankValidationErrors},a={...this.state.meterValidationErrors};let s=U().cloneDeep(this.state.modPipelineTankTransactionSnapshotInfo),r=U().cloneDeep(this.state.modPipelineMeterTransactionSnapshotInfo);Object.keys(P.nN).forEach((function(e){void 0!==s[e]&&(t[e]=M.jr(P.nN[e],s[e]))})),Object.keys(P.nN).forEach((function(e){void 0!==r[e]&&(a[e]=M.jr(P.nN[e],r[e]))})),s.ScanStartTime>=s.ScanEndTime&&(t.ScanStartTime="MarineDispatchManualEntry_ErrorLoadTime"),""!==r.MeterCode&&null!==r.MeterCode&&void 0!==r.MeterCode||!this.props.isMeterRequired||(a.MeterCode="PipelineReceiptDetails_MandatoryHeaderMeterCode"),""!==r.MeterCode&&null!==r.MeterCode&&void 0!==r.MeterCode&&(""!==r.GrossStartTotalizer&&null!==r.GrossStartTotalizer&&void 0!==r.GrossStartTotalizer||(a.GrossStartTotalizer="PipelineEntry_MandatoryStartGrossTotalizer"),""!==r.GrossEndTotalizer&&null!==r.GrossEndTotalizer&&void 0!==r.GrossEndTotalizer||(a.GrossEndTotalizer="PipelineEntry_MandatoryEndGrossTotalizer"),""!==r.NetStartTotalizer&&null!==r.NetStartTotalizer&&void 0!==r.NetStartTotalizer||(a.NetStartTotalizer="PipelineEntry_MandatoryStartNetTotalizer"),""!==r.NetEndTotalizer&&null!==r.NetEndTotalizer&&void 0!==r.NetEndTotalizer||(a.NetEndTotalizer="PipelineEntry_MandatoryEndNetTotalizer")),""===r.Temperature||null===r.Temperature||void 0===r.Temperature||""!==r.TemperatureUOM&&null!==r.TemperatureUOM&&void 0!==r.TemperatureUOM||(a.TemperatureUOM="BCU_TemperatureUOMRequired"),""===r.Density||null===r.Density||void 0===r.Density||""!==r.DensityUOM&&null!==r.DensityUOM&&void 0!==r.DensityUOM||(a.DensityUOM="Reconciliation_DensityUOMMandatory"),!this.props.isTankRequired||""!==s.TankCode&&null!==s.TankCode&&void 0!==s.TankCode||(t.TankCode="PipelineEntry_MandatoryTankCode"),""!==s.TankCode&&null!==s.TankCode&&void 0!==s.TankCode&&(""!==s.GrossStartVolume&&null!==s.GrossStartVolume&&void 0!==s.GrossStartVolume||(t.GrossStartVolume="PipelineEntry_MandatoryStartGrossVolume"),""!==s.GrossEndVolume&&null!==s.GrossEndVolume&&void 0!==s.GrossEndVolume||(t.GrossEndVolume="PipelineEntry_MandatoryEndGrossVolume"),""!==s.NetStartVolume&&null!==s.NetStartVolume&&void 0!==s.NetStartVolume||(t.NetStartVolume="PipelineEntry_MandatoryStartNetVolume"),""!==s.NetEndVolume&&null!==s.NetEndVolume&&void 0!==s.NetEndVolume||(t.NetEndVolume="PipelineEntry_MandatoryEndNetVolume"),""!==s.VolumeUOM&&null!==s.VolumeUOM&&void 0!==s.VolumeUOM||(t.VolumeUOM="PipelineEntry_MandatoryEndNetTotalizer")),""===s.GrossMass||null===s.GrossMass||void 0===s.GrossMass||""!==s.MassUOM&&null!==s.MassUOM&&void 0!==s.MassUOM||(t.MassUOM="PipelineEntry_MandatoryMassUOM"),""===s.Temperature||null===s.Temperature||void 0===s.Temperature||""!==s.TemperatureUOM&&null!==s.TemperatureUOM&&void 0!==s.TemperatureUOM||(t.TemperatureUOM="BCU_TemperatureUOMRequired"),""===s.Density||null===s.Density||void 0===s.Density||""!==s.DensityUOM&&null!==s.DensityUOM&&void 0!==s.DensityUOM||(t.DensityUOM="Reconciliation_DensityUOMMandatory"),""===s.Pressure||null===s.Pressure||void 0===s.Pressure||""!==s.PressureUOM&&null!==s.PressureUOM&&void 0!==s.PressureUOM||(t.PressureUOM="PipelineEntry_MandatoryPressureUOM");var i=U().cloneDeep(this.state.attributeValidationErrors);e.forEach((e=>{i.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.attributeMetaDataList.forEach((e=>{t.attributeValidationErrors[e.Code]=M.I5(e,e.DefaultValue)}))}))})),this.setState({tankValidationErrors:t,meterValidationErrors:a,attributeValidationErrors:i});var n=!0;return i.forEach((e=>{if(!n)return n;n=Object.values(e.attributeValidationErrors).every((function(e){return""===e}))})),n&&(n=Object.values(t).every((function(e){return""===e}))),n&&(n=Object.values(a).every((function(e){return""===e}))),n}formAttributesForUI(e){try{if(e.PIPELINETRANSACTIONS.length>0){let t=[],a=e.PIPELINETRANSACTIONS[0].TerminalCode;e.PIPELINETRANSACTIONS.forEach((function(e){e.TerminalCode===a&&t.push(e)})),this.setState({modAttributeMetaDataList:t}),U().cloneDeep(this.state.attributeValidationErrors).forEach((e=>{Object.keys(e.attributeValidationErrors).forEach((t=>e.attributeValidationErrors[t]=""))}))}}catch(t){console.log("PipelineDispatchManualEntryDetails : Error in forming attributes for UI")}}getAttributes(){try{u()(p.fKH,M.tW([g.N4],this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({attributeMetaDataList:U().cloneDeep(t.EntityResult),attributeValidationErrors:M.Fl(t.EntityResult.PIPELINETRANSACTIONS)},(()=>{this.formAttributesForUI(t.EntityResult)})):console.log("Failed to get Attributes")}))}catch(e){console.log("Error while getting Attributes:",e)}}GetUOMList(){try{if(null!==this.props.UOMS&&void 0!==this.props.UOMS){let e=this.props.UOMS,t=[],a=[],s=[],r=[],i=[];Array.isArray(e.VOLUME)&&(r=M.Zj(e.VOLUME)),Array.isArray(e.MASS)&&(t=M.Zj(e.MASS)),Array.isArray(e.DENSITY)&&(a=M.Zj(e.DENSITY)),Array.isArray(e.TEMPERATURE)&&(s=M.Zj(e.TEMPERATURE)),Array.isArray(e.PRESSURE)&&(i=M.Zj(e.PRESSURE)),this.setState({quantityUOMOptions:t,densityUOMS:a,temperatureUOMs:s,volumeUOMs:r,pressureUOMs:i})}}catch(e){console.log("PipelineReceiptManualEntryDetailsComposite : Error in getting UOMS")}}render(){const e={quantityUOMOptions:this.state.quantityUOMOptions,densityUOMS:this.state.densityUOMS,temperatureUOMs:this.state.temperatureUOMs,volumeUOMs:this.state.volumeUOMs,pressureUOMs:this.state.pressureUOMs,tankCodes:this.state.tankCodes,meterCodes:this.state.meterCodes};return(0,E.jsx)(h.TranslationConsumer,{children:t=>(0,E.jsxs)("div",{children:[(0,E.jsx)(i.A,{children:(0,E.jsx)(C,{onFieldChange:this.handleChange,onTabChange:this.handleTabChange,listOptions:e,receipt:this.props.receipt,modPipelineSnapshotInfo:this.state.modPipelineSnapshotInfo,modPipelineTankTransactionSnapshotInfo:this.state.modPipelineTankTransactionSnapshotInfo,modPipelineMeterTransactionSnapshotInfo:this.state.modPipelineMeterTransactionSnapshotInfo,tankValidationErrors:this.state.tankValidationErrors,meterValidationErrors:this.state.meterValidationErrors,modAttributeMetaDataList:this.state.modAttributeMetaDataList,onAttributeDataChange:this.handleAttributeDataChange,attributeValidationErrors:this.state.attributeValidationErrors,activeIndex:this.state.activeIndex,isMeterRequired:this.props.isMeterRequired,isTankRequired:this.props.isTankRequired,onDateTextChange:this.handleDateTextChange})}),(0,E.jsx)(i.A,{children:(0,E.jsx)(y.q,{handleBack:this.props.handleBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.manualEntrySaveEnable})}),this.state.showAuthenticationLayout?(0,E.jsx)(b.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:O.i.add,functionGroup:O.JU,handleOperation:this.addUnLoadingDetails,handleClose:this.handleAuthenticationClose}):null]})})}}const k=(0,r.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(f)}}]);
//# sourceMappingURL=4947.3b5adcbb.chunk.js.map