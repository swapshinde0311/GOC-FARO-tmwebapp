"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[5527],{55527:(e,t,a)=>{a.r(t),a.d(t,{default:()=>T});var s=a(65043),o=a(72711),r=a(67907),n=a(35861),l=a(70579);function i(e){let{modLeakageManualEntry:t,validationErrors:a,listOptions:s,onFieldChange:i,onTankSearchChange:d,onMeterSearchChange:c}=e;return(0,l.jsx)(r.TranslationConsumer,{children:e=>(0,l.jsx)("div",{className:"detailsContainer",children:(0,l.jsxs)("div",{className:"row",children:[(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),indicator:"required",label:e("LoadingDetailsEntry_ProductCategory"),value:t.ProductCategory,options:s.productCategory,error:e(a.ProductCategory),onChange:e=>i("ProductCategory",e),noResultsMessage:e("noResultsMessage")})}),(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),indicator:"required",label:e("ProductCode"),value:t.ProductCode,options:s.productCode,error:e(a.ProductCode),onChange:e=>i("ProductCode",e),noResultsMessage:e("noResultsMessage")})}),(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),indicator:"required",label:e("LoadingDetailsEntry_QuantityUOM"),value:t.LeakageQtyUom,options:s.quantityUOM,error:e(a.LeakageQtyUom),onChange:e=>i("LeakageQtyUom",e),noResultsMessage:e("noResultsMessage")})}),(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Input,{fluid:!0,value:t.LeakageQty,label:e("GrossQuantity"),indicator:"required",onChange:e=>i("LeakageQty",e),error:e(a.LeakageQty),reserveSpace:!1})}),(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Input,{fluid:!0,value:t.NetQuantity,label:e("NetQuantity"),onChange:e=>i("NetQuantity",e),error:e(a.NetQuantity),reserveSpace:!1})}),(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Input,{fluid:!0,value:t.Density,label:e("Density"),onChange:e=>i("Density",e),error:e(a.Density),reserveSpace:!1})}),(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("BaseProductInfox_UOM"),value:t.DensityUOM,options:s.densityUOM,onChange:e=>i("DensityUOM",e),noResultsMessage:e("noResultsMessage")})}),(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("TankCode"),indicator:"required",value:t.TankCode,error:e(a.TankCode),options:(0,n.r4)(s.tankCode,e("Common_Select")),onChange:e=>i("TankCode",e),search:!0,reserveSpace:!1,noResultsMessage:e("noResultsMessage"),onSearch:d})}),(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("Meter_Code"),indicator:"required",value:t.MeterCode,error:e(a.MeterCode),options:(0,n.r4)(s.meterCode,e("Common_Select")),onChange:e=>i("MeterCode",e),search:!0,reserveSpace:!1,noResultsMessage:e("noResultsMessage"),onSearch:c})}),(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.DatePicker,{fluid:!0,value:null===t.StartTime?"":new Date(t.StartTime),label:e("StartTime"),type:"datetime",minuteStep:"5",displayFormat:(0,n.F1)(),indicator:"required",onChange:e=>i("StartTime",e),error:e(a.StartTime),reserveSpace:!1})}),(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.DatePicker,{fluid:!0,value:null===t.EndTime?"":new Date(t.EndTime),label:e("EndTime"),type:"datetime",minuteStep:"5",displayFormat:(0,n.F1)(),indicator:"required",onChange:e=>i("EndTime",e),error:e(a.EndTime),reserveSpace:!1})}),(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Input,{fluid:!0,value:t.GrossStartTotalizer,label:e("StartTotalizer"),onChange:e=>i("GrossStartTotalizer",e),error:e(a.GrossStartTotalizer),reserveSpace:!1})}),(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Input,{fluid:!0,value:t.GrossEndTotalizer,label:e("EndTotalizer"),onChange:e=>i("GrossEndTotalizer",e),error:e(a.GrossEndTotalizer),reserveSpace:!1})}),(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Input,{fluid:!0,value:t.NetStartTotalizer,label:e("LoadingDetailsEntry_NetStartTotalizer"),onChange:e=>i("NetStartTotalizer",e),error:e(a.NetStartTotalizer),reserveSpace:!1})}),(0,l.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,l.jsx)(o.Input,{fluid:!0,value:t.NetEndTotalizer,label:e("LoadingDetailsEntry_NetEndTotalizer"),onChange:e=>i("NetEndTotalizer",e),error:e(a.NetEndTotalizer),reserveSpace:!1})})]})})})}i.defaultProps={isEnterpriseNode:!1};var d=a(53536),c=a.n(d),u=a(69062),h=a(9966),g=a(72067),p=a(7523),y=a(40854),C=a.n(y),m=a(44192),E=a(65187),S=a(40252),v=a(46100),M=a(50805),k=a(97508),D=a(80312);class L extends s.Component{constructor(){super(...arguments),this.state={leakageManualEntry:{},modLeakageManualEntry:{},validationErrors:u.Th(m.Xn),isReadyToRender:!1,productCategoryOptions:[],productCodeOptions:[],quantityUOMOptions:[],densityUOMOptions:[],tankCodeOptions:[],tankCodeSearchOptions:[],meterCodeOptions:[],meterCodeSearchOptions:[],saveEnabled:!1},this.handleChange=(e,t)=>{try{let a=c().cloneDeep(this.state.modLeakageManualEntry);a[e]=t,"ProductCategory"===e&&this.getProductCode(t);const s=c().cloneDeep(this.state.validationErrors);void 0!==m.Xn[e]&&(s[e]=u.jr(m.Xn[e],t)),this.setState({validationErrors:s,modLeakageManualEntry:a})}catch(a){console.log("LeakageManualEntryDetailsComposite: Error occurred on handleChange",a)}},this.handleSave=()=>{this.setState({saveEnabled:!1});const e=c().cloneDeep(this.state.modLeakageManualEntry);e.UpdatedTime=new Date,this.validateSave(e)?(e.NetQuantity=u.bo(e.NetQuantity),e.Density=u.bo(e.Density),e.NetEndTotalizer=u.bo(e.NetEndTotalizer),e.NetStartTotalizer=u.bo(e.NetStartTotalizer),e.GrossEndTotalizer=u.bo(e.GrossEndTotalizer),e.GrossStartTotalizer=u.bo(e.GrossStartTotalizer),e.LeakageQty=u.bo(e.LeakageQty),this.createLeakageManualEntry(e)):this.setState({saveEnabled:!0})},this.handleReset=()=>{try{const e=c().cloneDeep(this.state.validationErrors),t=c().cloneDeep(this.state.leakageManualEntry);Object.keys(e).forEach((function(t){e[t]=""})),this.setState({modLeakageManualEntry:t,validationErrors:e})}catch(e){console.log("LeakageManualEntryDetailsComposite: Error occurred on handleReset",e)}},this.handleTankSearchChange=e=>{try{let t=this.state.tankCodeOptions.filter((t=>t.value.toLowerCase().includes(e.toLowerCase())));t.length>p.bM&&(t=t.slice(0,p.bM)),this.setState({tankCodeSearchOptions:t})}catch(t){console.log("LeakageManualEntryDetailsComposite: Error occurred on handleRouteSearchChange",t)}},this.handleMeterSearchChange=e=>{try{let t=this.state.meterCodeOptions.filter((t=>t.value.toLowerCase().includes(e.toLowerCase())));t.length>p.bM&&(t=t.slice(0,p.bM)),this.setState({meterCodeSearchOptions:t})}catch(t){console.log("LeakageManualEntryDetailsComposite: Error occurred on handleMeterSearchChange",t)}},this.handleDateTextChange=(e,t,a)=>{try{const s=c().cloneDeep(this.state.validationErrors),o=c().cloneDeep(this.state.modLeakageManualEntry);s[e]=a,o[e]=t,this.setState({validationErrors:s,modLeakageManualEntry:o})}catch(a){console.log("LeakageManualEntryDetailsComposite: Error occurred on handleDateTextChange",a)}}}componentDidMount(){try{u.pJ(this.props.userDetails.EntityResult.IsArchived),this.getProductCategory(),this.getUOMList(),this.getTankCode(this.props.userDetails.EntityResult.PrimaryShareholder),this.getMeterCode(),this.setNewLeakageManualEntry()}catch(e){console.log("LeakageManualEntryDetailsComposite: Error occurred on componentDidMount",e)}}componentWillReceiveProps(){try{this.setNewLeakageManualEntry()}catch(e){console.log("LeakageManualEntryDetailsComposite:Error occurred on componentWillReceiveProps",e)}}setNewLeakageManualEntry(){this.setState({leakageManualEntry:c().cloneDeep(v.Ym),modLeakageManualEntry:c().cloneDeep(v.Ym),isReadyToRender:!0,saveEnabled:u.ab(this.props.userDetails.EntityResult.FunctionsList,D.i.add,D.$H)})}getProductCategory(){try{const e=[{text:"Base Product",value:"BaseProduct"},{text:"Additive",value:"Additive"}];this.setState({productCategoryOptions:e})}catch(e){console.log("LeakageManualEntryDetailsComposite: Error occurred on getProductCategory",e)}}getProductCode(e){let t;"BaseProduct"===e?t=g.mD_:"Additive"===e&&(t=g.Oyd),C()(t,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&void 0!==t.EntityResult){const e=[];for(let a in t.EntityResult)for(let s of t.EntityResult[a])e.push(s);this.setState({productCodeOptions:u.Zj(e)})}}else console.log("Error in getBaseProductList:",t.ErrorList)})).catch((e=>{console.log("Error while getting Base Product List:",e)}))}getUOMList(){C()(g.WFM,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult.VOLUME)){const e=[...t.EntityResult.VOLUME,...t.EntityResult.MASS];this.setState({quantityUOMOptions:u.Zj(e),densityUOMOptions:u.Zj(t.EntityResult.DENSITY)})}}else console.log("Error in getQuantityUOM:",t.ErrorList)})).catch((e=>{console.log("Error in getQuantityUOM:",e)}))}getTankCode(e){C()(g.Ibp+"?ShareholderCode="+e,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){const e=u.Zj(t.EntityResult);let a=c().cloneDeep(e);a.length>p.bM&&(a=a.slice(0,p.bM)),this.setState({tankCodeOptions:e,tankCodeSearchOptions:a})}}else console.log("Error in getTankCode:",t.ErrorList)})).catch((e=>{console.log("Error in getTankCode:",e)}))}getMeterCode(){C()(g.ndF,u.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){const e=u.Zj(t.EntityResult);let a=c().cloneDeep(e);a.length>p.bM&&(a=a.slice(0,p.bM)),this.setState({meterCodeOptions:e,meterCodeSearchOptions:a})}}else console.log("Error in getMeterCode:",t.ErrorList)})).catch((e=>{console.log("Error in getMeterCode:",e)}))}validateSave(e){const t=c().cloneDeep(this.state.validationErrors);return Object.keys(m.Xn).forEach((a=>{void 0!==e[a]&&(t[a]=u.jr(m.Xn[a],e[a]))})),this.setState({validationErrors:t}),Object.values(t).every((e=>""===e))}createLeakageManualEntry(e){var t={ShareHolderCode:this.props.selectedShareholder,Entity:e},a={messageType:"critical",message:"LeakageManualEntry_SavedStatus",messageResultDetails:[{keyFields:["ProductCode"],keyValues:[e.ProductCode],isSuccess:!1,errorMessage:""}]};C()(g.UCr,u.tW(t,this.props.tokenDetails.tokenInfo)).then((t=>{var s=t.data;a.messageType=s.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?this.setState({saveEnabled:!1}):(a.messageResultDetails[0].errorMessage=s.ErrorList[0],this.setState({saveEnabled:!0}),console.log("Error in CreateLeakageManualEntry: ",s.ErrorList)),this.props.onSaved(e,"add",a)})).catch((t=>{this.setState({saveEnabled:u.ab(this.props.userDetails.EntityResult.FunctionsList,D.i.add,D.$H)}),a.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"add",a)}))}getTankCodeSearchOptions(){let e=c().cloneDeep(this.state.tankCodeSearchOptions),t=this.state.modLeakageManualEntry.TankCode;if(null!==t&&""!==t&&void 0!==t){void 0===e.find((e=>e.value.toLowerCase()===t.toLowerCase()))&&e.push({text:t,value:t})}return e}getMeterCodeSearchOptions(){let e=c().cloneDeep(this.state.meterCodeSearchOptions),t=this.state.modLeakageManualEntry.MeterCode;if(null!==t&&""!==t&&void 0!==t){void 0===e.find((e=>e.value.toLowerCase()===t.toLowerCase()))&&e.push({text:t,value:t})}return e}render(){return this.state.isReadyToRender?(0,l.jsxs)("div",{children:[(0,l.jsx)(E.A,{children:(0,l.jsx)(i,{modLeakageManualEntry:this.state.modLeakageManualEntry,validationErrors:this.state.validationErrors,listOptions:{productCategory:this.state.productCategoryOptions,productCode:this.state.productCodeOptions,quantityUOM:this.state.quantityUOMOptions,densityUOM:this.state.densityUOMOptions,tankCode:this.getTankCodeSearchOptions(),meterCode:this.getMeterCodeSearchOptions()},onFieldChange:this.handleChange,onDateTextChange:this.handleDateTextChange,onTankSearchChange:this.handleTankSearchChange,onMeterSearchChange:this.handleMeterSearchChange,isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode})}),(0,l.jsx)(E.A,{children:(0,l.jsx)(r.TranslationConsumer,{children:e=>(0,l.jsx)("div",{className:"row",children:(0,l.jsxs)("div",{className:"col",style:{textAlign:"right"},children:[(0,l.jsx)(o.Button,{content:e("LookUpData_btnReset"),className:"cancelButton",onClick:this.handleReset}),(0,l.jsx)(o.Button,{content:e("Save"),disabled:!this.state.saveEnabled,onClick:this.handleSave})]})})})})]}):(0,l.jsx)(S.A,{message:"Loading"})}}const T=(0,k.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})),(e=>({userAction:(0,M.zH)(h,e)})))(L)},35861:(e,t,a)=>{a.d(t,{F1:()=>l,i7:()=>i,r4:()=>n});var s=a(86178),o=a.n(s),r=(a(15660),a(65043),a(70579));function n(e,t){if(Array.isArray(e)){0===e.filter((e=>e.text===t)).length&&e.unshift({value:null,text:t})}return e}function l(){let e=window.navigator.userLanguage||window.navigator.language;return o().locale(e),o().localeData().longDateFormat("L")}function i(e){return(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:e}),(0,r.jsx)("div",{class:"ui red circular empty label badge  circle-padding"})]})}}}]);
//# sourceMappingURL=5527.d5d4128f.chunk.js.map