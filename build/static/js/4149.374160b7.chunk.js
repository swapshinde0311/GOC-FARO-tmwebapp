"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[4149,6507],{64149:(e,t,s)=>{s.r(t),s.d(t,{default:()=>B});var i=s(65043),a=s(97508),o=s(275),n=s(72711),l=s(67907),r=s(85800),d=s(78374),h=s(24904),c=s(80312),m=s(35861),p=s(7523),u=s(65187),C=s(69062),S=s(70579);function g(e){let{shipment:t,modShipment:s,modCustomValues:a,modCompartmentPlans:o,modProductPlans:g,modLoadingDetails:y,loadingDetails:D,validationErrors:b,listOptions:T,onFieldChange:A,onDateTextChange:E,onAllTerminalsChange:f,selectedProductPlans:v,selectedCompartmentPlans:x,handleCompartmentPlansSelectionChange:I,handleProductPlansSelectionChange:L,handleCompartmentPlanCellDataEdit:N,handleProductPlanCellDataEdit:w,handleAddCompartmentPlan:R,handleDeleteCompartmentPlan:j,handleAddProductPlan:P,handleDeleteProductPlan:_,onActiveStatusChange:V,onVehicleChange:O,onVehicleSearchChange:M,onDriverSearchChange:U,isEnterpriseNode:k,shipmentType:Q,prodTypeTab:F,compTypeTab:B,LoadTypeTab:q,customerInventoryTab:W,expandedRows:H,toggleExpand:z,attributeValidationErrors:G,handleAttributeCellDataEdit:Y,handleCompAttributeCellDataEdit:K,handleProdPlanAttributeCellDataEdit:J,selectedAttributeList:Z,compartmentDetailsPageSize:X,attributeToggleExpand:$,customerInventory:ee,activeTab:te,onTabChange:se,handleTopUpDecantApproval:ie,isSlotbookinginUI:ae,productAllocationTab:oe,handleCellCheck:ne,handleLoadingDetailsChange:le,productAllocationList:re,productShareholderAllocationList:de,ProdAllocEntity:he,ddlTopUpDecantStatus:ce,isMarineTransloading:me,isRailTransloading:pe,isPlanned:ue,updateTransloadingInfo:Ce,handleTransLoadCompSeq:Se,shipmentSource:ge,isAutoGeneratedShipmentCode:ye,isEnforcingEnabled:De,isBonded:be,overrideSequence:Te,isOverrideSequenceButtonEnabled:Ae,updateShipmentBondNo:Ee,updateShipmentAllowed:fe,ShipmentBay:ve,UpdateShipmentDriver:xe,isWebportalCarrierRoleUser:Ie}=e;const[Le]=(0,l.useTranslation)(),[Ne,we]=(0,i.useState)(!1),[Re,je]=(0,i.useState)({}),[Pe,_e]=(0,i.useState)(!1);"TRUE"===a.EnableTopUpDecant&&"TRUE"===a.TopUpDecantAllow&&"TRUE"===a.f_ViewShipTopUpDecantApprovalAccess&&a.TopUpDecantStatusText===p.Bw.SUBMITTED&&(a.TopUpDecantStatusVisible="FALSE",a.TopUpDecantStatusDropDownVisible="TRUE");let Ve="TRUE"===a.f_ViewShipTopUpDecantApprovalAccess?"ViewShipmentTopUpDecant_AutoApproved":"ViewShipmentTopUpDecant_SubmitForApproved";"TRUE"===a.TopUpDecantApprovalEnabled&&(Ve="ViewShipmentTopUpDecant_AutoApproved");const Oe=(e,t)=>{let s=[];return s=e.find((e=>e.TerminalCode===t)),s.attributeValidationErrors},Me=e=>{const t=e.rowData,s=e=>{var t=e.split("-");return new Date(t[0],t[1]-1,t[2])};try{return t.DataType.toLowerCase()===p.pe.STRING.toLowerCase()||t.DataType.toLowerCase()===p.pe.INT.toLowerCase()||t.DataType.toLowerCase()===p.pe.FLOAT.toLowerCase()||t.DataType.toLowerCase()===p.pe.LONG.toLowerCase()||t.DataType.toLowerCase()===p.pe.DOUBLE.toLowerCase()?(0,S.jsx)(n.Input,{fluid:!0,value:t.AttributeValue,disabled:t.IsReadonly,onChange:s=>t.AttributeType===p.Pm.COMPARTMENT?K(e,s):J(e,s),reserveSpace:!1}):t.DataType.toLowerCase()===p.pe.BOOL.toLowerCase()?(0,S.jsx)(n.Checkbox,{checked:"true"===t.AttributeValue.toString().toLowerCase(),disabled:t.IsReadonly,onChange:s=>t.AttributeType===p.Pm.COMPARTMENT?K(e,s):J(e,s)}):t.DataType.toLowerCase()===p.pe.DATETIME.toLowerCase()?(0,S.jsx)(n.DatePicker,{fluid:!0,value:null===t.AttributeValue||void 0===t.AttributeValue||""===t.AttributeValue?"":s(t.AttributeValue),disabled:t.IsReadonly,showYearSelector:"true",minuteStep:1,onChange:s=>((e,s)=>{var i=new Date(s);s=i.getFullYear()+"-"+("0"+(i.getMonth()+1)).slice(-2)+"-"+("0"+i.getDate()).slice(-2),t.AttributeType===p.Pm.COMPARTMENT?K(e,s):J(e,s)})(e,s),reserveSpace:!1}):null}catch(i){console.log("TruckShipmentDetails:Error occured on handleAttributeType",i)}},Ue=e=>e.rowData.IsMandatory?(0,S.jsxs)("div",{children:[(0,S.jsx)("span",{children:e.rowData.AttributeName}),(0,S.jsx)("div",{class:"ui red circular empty label badge  circle-padding"})]}):(0,S.jsx)("div",{children:(0,S.jsx)("span",{children:e.rowData.AttributeName})}),ke=e=>{const t=H.findIndex((t=>t.SeqNumber===e.rowData.SeqNumber))>=0;return(0,S.jsxs)("div",{onClick:()=>$(e.rowData,t),className:"compartmentIcon gridButtonFontColor",children:[(0,S.jsx)("span",{children:Le(t?"Hide_Attributes":"View_Attributes")}),(0,S.jsx)(n.Icon,{root:"common",name:t?"caret-up":"caret-down",className:"margin_l10"})]})};function Qe(e){return Array.isArray(e.AttributesforUI)&&e.AttributesforUI.length>0?(0,S.jsx)("div",{className:"childTable ChildGridViewAllShipmentLoadingDetails",children:(0,S.jsxs)(d.bQ,{data:e.AttributesforUI,rows:X,children:[k?(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"TerminalCode",header:Le("CompartmentTerminal"),editable:!1},"TerminalCode"):"",(0,S.jsx)(d.bQ.Column,{className:"compColHeight",header:Le("CompartmentAttributeName"),renderer:Ue,editable:!1},"AttributeName"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",header:Le("CompartmentAttributeValue"),renderer:Me}),Array.isArray(e.AttributesforUI)&&e.AttributesforUI.length>X?(0,S.jsx)(d.bQ.Pagination,{}):""]})}):(0,S.jsx)("div",{className:"compartmentIcon",children:(0,S.jsx)("div",{className:"gridButtonAlignLeft",children:Le("CustomerInventory_NoRecordsFound")})})}const Fe=(e,t,s)=>{try{return s===p.Pm.COMPARTMENT?(0,S.jsx)(n.Select,{className:"selectDropwdown",value:o[e.rowIndex][e.field],fluid:!0,options:t,onChange:t=>N(t,e),onFocus:()=>{"TransCompSequenceNumber"===e.field&&null!==o[e.rowIndex].TransReceiptCode&&Se(o[e.rowIndex].TransReceiptCode)},indicator:"required",reserveSpace:!1,search:!0,noResultsMessage:Le("noResultsMessage")}):(0,S.jsx)(n.Select,{className:"selectDropwdown",value:g[e.rowIndex][e.field],fluid:!0,options:t,onChange:t=>w(t,e),indicator:"required",reserveSpace:!1,search:!0,noResultsMessage:Le("noResultsMessage")})}catch(i){console.log(Q+":Error occured on handleCustomEditDropDown",i)}},Be=(e,t)=>{let s=[];return void 0!==T.customerDestinationOptions&&null!==T.customerDestinationOptions&&Object.keys(T.customerDestinationOptions).forEach((e=>s.push({text:e,value:e}))),Fe(e,s,t)},qe=(e,t)=>{let s=[];return void 0!==T.customerDestinationOptions&&null!==T.customerDestinationOptions&&void 0!==T.customerDestinationOptions[e.rowData.CustomerCode]&&Array.isArray(T.customerDestinationOptions[e.rowData.CustomerCode])&&T.customerDestinationOptions[e.rowData.CustomerCode].forEach((e=>s.push({text:e,value:e}))),Fe(e,s,t)},We=(e,t)=>t===p.Pm.COMPARTMENT?(0,S.jsx)(n.Input,{fluid:!0,value:o[e.rowIndex][e.field],onChange:t=>N(t,e),reserveSpace:!1}):(0,S.jsx)(n.Input,{fluid:!0,value:g[e.rowIndex][e.field],onChange:t=>w(t,e),reserveSpace:!1}),He=e=>{const{value:t}=e;return"number"===typeof t&&null!==t?t.toLocaleString():t},ze=e=>{const t=H.findIndex((t=>t.SeqNumber===e.rowData.SeqNumber))>=0;return(0,S.jsx)("div",{onClick:()=>z(e.rowData,t),className:"compartmentIcon gridButtonFontColor",children:(0,S.jsx)(n.Icon,{root:"common",name:t?"slidercontrols-minus":"ellipsis-horizontal",className:"margin_l10"})})},Ge=e=>{let t=!1;return null===e.rowData.Compartment_Status&&void 0===e.rowData.Compartment_Status||(t=p.g5[s.Status]===p.g5.CLOSED||p.bw[e.rowData.Compartment_Status]===p.bw.COMPLETED||p.bw[e.rowData.Compartment_Status]===p.bw.LOADING||p.bw[e.rowData.Compartment_Status]===p.bw.FORCE_COMPLETED),(0,S.jsx)(n.Checkbox,{className:"forceCompleteChkBox",disabled:"FALSE"===a.EnableChkForceCompleted||(null!==e.rowData.Compartment_Status||void 0!==e.rowData.Compartment_Status)&&t,checked:e.rowData.Force_Complete,onChange:t=>{je(e),t?we(!0):ne(e,t)}})},Ye=e=>{let t=e.field,i=D.Table.filter((e=>""!==e.TopUpDecantQuantity&&null!==e.TopUpDecantQuantity&&void 0!==e.TopUpDecantQuantity));return(0,S.jsx)(n.Input,{fluid:!0,value:e.rowData[t],onChange:t=>le(t,e),onFocus:()=>{_e(!1),_e("Top_Up_Decant_Quantity"===t||"Notes"===t)},disabled:"Top_Up_Decant_Quantity"===t||"Notes"===t?"TRUE"!==a.EnableTopUpDecant||p.g5[s.Status]!==p.g5.PARTIALLY_LOADED&&p.g5[s.Status]!==p.g5.MANUALLY_LOADED&&p.g5[s.Status]!==p.g5.AUTO_LOADED||p.bw[e.rowData.Compartment_Status]!==p.bw.COMPLETED&&p.bw[e.rowData.Compartment_Status]!==p.bw.PART_FILLED&&p.bw[e.rowData.Compartment_Status]!==p.bw.OVER_FILLED||0!==i.length:"Adjust_Plan"===t&&p.g5[s.Status]===p.g5.CLOSED,reserveSpace:!1})};function Ke(e){let t=[];return t.push(e),Array.isArray(t)&&t.length>0?(0,S.jsxs)("div",{className:"ChildGridViewAllShipmentLoadingDetails",children:[(0,S.jsxs)(d.bQ,{data:t,children:[(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"Left_Quantity",header:Le("Shipment_Compartment_Left_Quantity")},"Left_Quantity"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"Adjust_Plan",header:Le("ViewShipment_AdjustmentToPlannedQuantity"),renderer:Ye}),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"Top_Up_Decant_Quantity",header:Le("ViewShipment_TopUpDecantQty"),renderer:Ye}),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"Notes",header:Le("ViewShipment_Notes"),renderer:Ye})]}),t[0].BaseProductDetails.map((e=>{let t=[e];return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(d.bQ,{data:t,children:[(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"baseproductcode",header:Le("BaseProductCode"),editable:!1}),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"plannedquantity",header:Le("ViewShipmentCompartment_PlannedQuantity"),editable:!1}),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"revisedplannedquantity",header:Le("ViewShipmentCompartment_AdjustedQuantity"),editable:!1}),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"loadedquantity",header:Le("ContractInfo_LoadedQty"),editable:!1}),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"adjustedquantity",header:Le("ViewAllShipment_AdjustedQuantity"),editable:!1}),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"TotalQuantity",header:Le("TankMeter_TotalQuantity"),editable:!1}),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"LeftQuantity",header:Le("Shipment_Compartment_Left_Quantity"),editable:!1})]}),null!==e.AdditiveProductDetails&&void 0!==e.AdditiveProductDetails&&e.AdditiveProductDetails.length>0?(0,S.jsxs)(d.bQ,{data:e.AdditiveProductDetails,children:[(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"additivecode",header:Le("ViewShipment_AdditiveCode"),editable:!1}),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"plannedquantity",header:Le("ViewShipmentCompartment_PlannedQuantity"),editable:!1}),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"revisedplannedquantity",header:Le("ViewShipmentCompartment_AdjustedQuantity"),editable:!1}),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"loadedquantity",header:Le("ContractInfo_LoadedQty"),editable:!1}),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"adjustedquantity",header:Le("ViewAllShipment_AdjustedQuantity"),editable:!1}),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"TotalQuantity",header:Le("TankMeter_TotalQuantity"),editable:!1}),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"LeftQuantity",header:Le("Shipment_Compartment_Left_Quantity"),editable:!1})]}):""]})}))]}):(0,S.jsx)("div",{className:"compartmentIcon",children:(0,S.jsx)("div",{className:"gridButtonAlignLeft",children:Le("CustomerInventory_NoRecordsFound")})})}return(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"detailsContainer",children:[(0,S.jsxs)("div",{className:"row",children:[(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Input,{fluid:!0,value:s.ShipmentCode,label:Le("ShipmentCompDetail_ShipmentNumber"),indicator:"required",disabled:!!ye||""!==t.ShipmentCode,onChange:e=>A("ShipmentCode",e),error:Le(b.ShipmentCode),reserveSpace:!1})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Input,{fluid:!0,value:null===s.Status?"":s.Status,label:Le("ShipmentCompDetail_ShipmentStatus"),disabled:!0})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.DatePicker,{fluid:!0,value:new Date(s.ScheduledDate),label:Le("ShipmentCompDetail_ScheduledDate"),displayFormat:(0,m.F1)(),type:"datetime",showYearSelector:"true",minuteStep:1,disablePast:null===a.ShipConfigNumberofDaysBeforeOldShipmentsCreationIsAllowed||void 0===a.ShipConfigNumberofDaysBeforeOldShipmentsCreationIsAllowed,indicator:"required",onChange:e=>A("ScheduledDate",e),onTextChange:(e,t)=>{E("ScheduledDate",e,t)},error:Le(b.ScheduledDate),reserveSpace:!1,disabled:""!==t.ShipmentCode&&!0!==fe})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Select,{fluid:!0,placeholder:Le("FinishedProductInfo_Select"),label:Le("ShipmentCompDetail_Vehicle"),value:null===s.VehicleCode?"":s.VehicleCode,options:T.vehicleOptions,onChange:e=>{O(e)},indicator:"required",search:!0,noResultsMessage:Le("noResultsMessage"),error:Le(b.VehicleCode),reserveSpace:!1,disabled:""!==t.ShipmentCode&&!0!==fe,onSearch:M})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Input,{fluid:!0,value:null===s.CarrierCode?"":s.CarrierCode,label:Le("ShipmentCompDetail_CarrierCompany"),disabled:!0,error:Le(b.CarrierCode),reserveSpace:!1})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,S.jsx)(n.Select,{className:Ie?"pr-2":"",fluid:!0,placeholder:Le("FinishedProductInfo_Select"),label:Le("ShipmentCompDetail_Driver"),value:null===s.DriverCode?"":s.DriverCode,options:(0,m.r4)(T.driverOptions,Le("Common_Select")),onChange:e=>{A("DriverCode",e)},search:!0,disabled:(!Ie||s.Status!==p.Mw.READY)&&(""!==t.ShipmentCode&&!0!==fe),noResultsMessage:Le("noResultsMessage"),onSearch:U}),Ie?(0,S.jsx)(n.Tooltip,{content:Le("ShipmentCompDetail_BtnSave"),element:(0,S.jsx)(n.Button,{className:"iconBtn mt-auto",type:"primary",onClick:()=>{xe()},disabled:s.Status!==p.Mw.READY,children:(0,S.jsx)(n.Icon,{root:"building",name:"save",size:"large",className:"mt-auto"})}),position:"left center",event:"hover",hoverable:!0}):""]})}),!0!==me&&!0!==pe||!1!==k||Q!==c.de?null:(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Select,{fluid:!0,placeholder:Le("FinishedProductInfo_Select"),label:Le("Ship_transLoad_source"),value:null===s.TransloadSourceType?"":s.TransloadSourceType,options:C.Zj(T.transloadingOptions),onChange:e=>A("TransloadSourceType",e),reserveSpace:!1,disabled:""!==t.ShipmentCode&&!0!==fe,search:!0,noResultsMessage:Le("noResultsMessage")})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Select,{fluid:!0,placeholder:Le("FinishedProductInfo_Select"),label:Le("ShipmentCompDetail_UOM"),value:null===s.ShipmentQuantityUOM?"":s.ShipmentQuantityUOM,options:T.quantityUOMOptions,onChange:e=>A("ShipmentQuantityUOM",e),indicator:"required",error:Le(b.ShipmentQuantityUOM),reserveSpace:!1,disabled:""!==t.ShipmentCode&&!0!==fe,search:!0,noResultsMessage:Le("noResultsMessage")})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Input,{fluid:!0,value:null===s.Description?"":s.Description,onChange:e=>A("Description",e),label:Le("CarrierDetails_Desc"),error:Le(b.Description),reserveSpace:!1,disabled:""!==t.ShipmentCode&&!0!==fe})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Select,{fluid:!0,placeholder:Le("FinishedProductInfo_Select"),label:Le("ShipmentProdDetail_CreatedFrom"),value:s.CreatedFromEntity,onChange:e=>A("CreatedFromEntity",e),options:T.shipmentFromOptions,disabled:""!==t.ShipmentCode||void 0!==ge})}),De?(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Input,{fluid:!0,value:null===s.PlannedTripNo?"":s.PlannedTripNo,onChange:e=>A("PlannedTripNo",e),label:Le("ShipmentCompDetail_ShipmentSequence"),reserveSpace:!1,disabled:""!==t.ShipmentCode&&!0!==fe})}):"",De?(0,S.jsxs)("div",{className:"col-12 col-md-6 col-lg-4",children:[(0,S.jsxs)("div",{className:"ui single-input fluid disabled",style:{width:"50%",float:"left"},children:[(0,S.jsx)("div",{class:"ui input-label",children:(0,S.jsx)("span",{className:"input-label-message",children:Le("ShipmentCompDetail_OverrideSequence")})}),(0,S.jsx)("div",{className:"input-wrap",children:(0,S.jsx)(n.Checkbox,{checked:s.IsPriority,disabled:!0})})]}),"READY"===t.Status?(0,S.jsx)("div",{style:{width:"50%",float:"right"},children:(0,S.jsx)(n.Button,{className:"shipmentRecordWeightButton",content:s.IsPriority?Le("ShipmentCompDetail_OverrideReset"):Le("ShipmentCompDetail_OverrideSet"),disabled:""===t.ShipmentCode||!Ae,onClick:Te})}):""]}):"",be?(0,S.jsxs)("div",{className:"col-12 col-md-6 col-lg-4",children:[(0,S.jsxs)("div",{className:"ui single-input fluid disabled",style:{width:"30%",float:"left"},children:[(0,S.jsx)("div",{class:"ui input-label",children:(0,S.jsx)("span",{className:"input-label-message",children:Le("VehicleInfo_Bonded")})}),(0,S.jsx)("div",{className:"input-wrap",children:(0,S.jsx)(n.Checkbox,{onChange:e=>A("IsBonded",e),checked:s.IsBonded,disabled:""!==t.ShipmentCode&&!0!==fe})})]}),s.IsBonded?(0,S.jsx)("div",{style:{width:"70%",float:"right"},children:(0,S.jsx)(n.Input,{fluid:!0,value:null===s.ShipmentBondNo?"":s.ShipmentBondNo,onChange:e=>A("ShipmentBondNo",e),label:Le("ShipmentCompDetail_ShipmentBondNo"),reserveSpace:!1,disabled:""!==t.ShipmentCode&&"TRUE"!==a.BondUpdateAllow})}):""]}):"",""!==t.ShipmentCode&&!1!==ue&&s.IsBonded&&be&&"TRUE"===a.BondUpdateAllow?(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Button,{content:Le("ShipmentCompDetail_SaveShipmentBondNo"),disabled:"TRUE"!==a.BondUpdateAllow,onClick:Ee})}):"",""!==t.ShipmentCode&&!1!==ue?(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Input,{fluid:!0,value:a.VehicleAccessCard,editable:!1,label:Le("ViewShipment_VehicleAccessCard"),reserveSpace:!1,disabled:!0})}):"",""!==t.ShipmentCode&&!1!==ue?(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Input,{fluid:!0,value:0===s.ShipmentType?p.Pm.COMPARTMENT:p.Pm.PRODUCT,editable:!1,label:Le("ViewShipmentStatus_ShipmentType"),reserveSpace:!1,disabled:!0})}):"",""!==t.ShipmentCode&&!1!==ue&&"TRUE"===a.TopUpDecantStatusVisible?(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Input,{fluid:!0,value:a.TopUpDecantStatusText,label:Le("ViewShipment_TopUpDecantStatus"),reserveSpace:!1,disabled:!0})}):"",""!==t.ShipmentCode&&!1!==ue&&"TRUE"===a.TopUpDecantStatusDropDownVisible?(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Select,{fluid:!0,placeholder:Le("FinishedProductInfo_Select"),label:Le("ViewShipment_TopUpDecantStatus"),value:ce,options:(0,m.r4)(T.topUpDecantOptions,Le("Common_Select")),onChange:e=>A("ddlTopUpDecant",e),noResultsMessage:Le("noResultsMessage")})}):"",""!==t.ShipmentCode&&!1!==ue?(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Input,{fluid:!0,value:s.ForceClosureReason,label:Le("ViewShipment_CloseHeader"),reserveSpace:!1,disabled:!0})}):"",""!==t.ShipmentCode&&!1!==ue?(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsxs)("div",{className:"ui single-input fluid disabled",children:[(0,S.jsx)("div",{class:"ui input-label",children:(0,S.jsx)("span",{className:"input-label-message",children:Le("ViewShipment_IsForceClosed")})}),(0,S.jsx)("div",{className:"input-wrap",children:(0,S.jsx)(n.Checkbox,{checked:s.ForceClosed,disabled:!0})})]})}):"",""!==t.ShipmentCode&&!1!==ue&&ae?(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4 ddlSelectAll",children:(0,S.jsxs)("div",{className:"ui single-input fluid disabled",children:[(0,S.jsx)("div",{class:"ui input-label",children:(0,S.jsx)("span",{className:"input-label-message",children:Le("ViewShipment_IsSlotBooked")})}),(0,S.jsx)("div",{className:"input-wrap",children:(0,S.jsx)("label",{style:{fontWeight:"bold"},children:s.SlotBooked?"Booked":"Not Booked"})})]})}):"",""!==t.ShipmentCode&&"READY"!==t.Status&&"CLOSE"!==t.Status&&!1!==ue&&null!==ve&&""!==ve&&void 0!==ve?(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4 ddlSelectAll",children:(0,S.jsxs)("div",{className:"ui single-input fluid disabled",children:[(0,S.jsx)("div",{class:"ui input-label",children:(0,S.jsxs)("span",{className:"input-label-message",children:[Le("ViewAllocateBay_AllocatedBay"),":"]})}),(0,S.jsx)("div",{className:"input-wrap",children:(0,S.jsx)("label",{style:{fontWeight:"bold"},children:ve})})]})}):"",""!==t.ShipmentCode&&!1!==ue?(0,S.jsxs)("div",{className:"col-12 col-md-6 col-lg-4",children:[(0,S.jsx)("label",{children:Le("ViewShipment_CompBlendState")}),(0,S.jsx)("br",{}),(0,S.jsxs)("div",{children:[" ",(()=>{let e=[];for(let m=0;m<y.length;m++){var t,s;let u=p.bw.EMPTY;var i,a,o,l,r,d,h,c;if(u=null!==(t=y[m])&&void 0!==t&&t.Compartment_Status?p.bw[null===(s=y[m])||void 0===s?void 0:s.Compartment_Status]:u,u===p.bw.EMPTY)e.push((0,S.jsx)(S.Fragment,{children:(0,S.jsx)(n.Tooltip,{element:(0,S.jsx)(n.Badge,{className:"EmptyLabelStyle",children:null===(i=y[m])||void 0===i?void 0:i.SeqNo}),content:Le("Spec_ToolTip_NotLoaded"),size:"mini"})}));else 1===(null===(a=y[m])||void 0===a?void 0:a.BlendState)?e.push((0,S.jsx)(S.Fragment,{children:(0,S.jsx)(n.Tooltip,{element:(0,S.jsx)(n.Badge,{className:"InSpecLabelStyle",color:"green",children:null===(o=y[m])||void 0===o?void 0:o.SeqNo}),content:Le("Spec_ToolTip_InSpec"),size:"mini"})})):2===(null===(l=y[m])||void 0===l?void 0:l.BlendState)?e.push((0,S.jsx)(S.Fragment,{children:(0,S.jsx)(n.Tooltip,{element:(0,S.jsx)(n.Badge,{className:"OffSpecCorrectableLabelStyle",color:"orange",children:null===(r=y[m])||void 0===r?void 0:r.SeqNo}),content:Le("Spec_ToolTip_OffSpecCorrectable"),size:"mini"})})):3===(null===(d=y[m])||void 0===d?void 0:d.BlendState)?e.push((0,S.jsx)(S.Fragment,{children:(0,S.jsx)(n.Tooltip,{element:(0,S.jsx)(n.Badge,{className:"OffSpecNotCorrectableLabelStyle",color:"red",children:null===(h=y[m])||void 0===h?void 0:h.SeqNo}),content:Le("Spec_ToolTip_OffSpecNotCorrectable"),size:"mini"})})):e.push((0,S.jsx)(S.Fragment,{children:(0,S.jsx)(n.Tooltip,{element:(0,S.jsx)(n.Badge,{className:"EmptyLabelStyle",children:null===(c=y[m])||void 0===c?void 0:c.SeqNo}),content:Le("Spec_ToolTip_NotLoaded"),size:"mini"})}))}return e})()]})]}):"",""!==t.ShipmentCode&&!1!==ue&&"TRUE"===a.VehicleHSEEnabled?(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Input,{fluid:!0,value:(()=>{let e="";try{let t=p.P6.NOT_DONE;s.HSEInspectionStatus&&(t=s.HSEInspectionStatus),e=p.g5[s.Status.toUpperCase()]===p.g5.CLOSED?Object.keys(p.P6).find((e=>p.P6[e]===t)):a.VehicleHSEStatus}catch(t){console.log("Error in getVehicleHSEValue"+t)}return e})(),label:Le("VehHSE_Inspection"),reserveSpace:!1,disabled:!0})}):"",""!==t.ShipmentCode&&!1!==ue?(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Select,{fluid:!0,placeholder:"Select",value:s.ActualTerminalCode,label:Le("Shipment_LoadedTerminal"),options:C.Zj([s.ActualTerminalCode]),disabled:!0,multiple:!0,reserveSpace:!1})}):"",(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Select,{fluid:!0,placeholder:Le("FinishedProductInfo_Select"),label:Le("Cust_Status"),value:s.Active,options:[{text:Le("ViewShipment_Ok"),value:!0},{text:Le("ViewShipmentStatus_Inactive"),value:!1}],onChange:e=>V(e),disabled:!0!==fe||""===t.ShipmentCode})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Input,{fluid:!0,value:null===s.Remarks?"":s.Remarks,label:Le("Cust_Remarks"),onChange:e=>A("Remarks",e),indicator:s.Active!==t.Active?"required":"",error:Le(b.Remarks),reserveSpace:!1,disabled:""!==t.ShipmentCode&&!0!==fe})}),k?(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(h.y,{terminalList:T.terminalCodes,selectedTerminal:s.TerminalCodes,error:Le(b.TerminalCodes),onFieldChange:A,onCheckChange:f})}):""]}),Z.length>0?Z.map((e=>(0,S.jsx)(u.A,{children:(0,S.jsx)(n.Accordion,{children:(0,S.jsx)(n.Accordion.Content,{className:"attributeAccordian",title:k?e.TerminalCode+" - "+Le("Attributes_Header"):Le("Attributes_Header"),children:(0,S.jsx)(r.n,{selectedAttributeList:e.attributeMetaDataList,handleCellDataEdit:Y,attributeValidationErrors:Oe(G,e.TerminalCode)})})})}))):null,(0,S.jsx)("div",{className:"shipmentTabAlignment",children:(0,S.jsxs)(n.Tab,{activeIndex:te,onTabChange:e=>{se(e)},children:[F.map((e=>(0,S.jsxs)(n.Tab.Pane,{title:Le("Shipment_Product_Planning_Tab_Header"),children:[(0,S.jsxs)("div",{className:"row compartmentRow",children:[(0,S.jsx)("div",{className:"col col-md-8 col-lg-9 col col-xl-9"}),(0,S.jsx)("div",{className:"col col-md-4 col-lg-3 col-xl-3",children:(0,S.jsxs)("div",{className:"compartmentIconContainer",children:[(0,S.jsxs)("div",{onClick:P,className:"compartmentIcon",children:[(0,S.jsx)("div",{children:(0,S.jsx)(n.Icon,{root:"common",name:"badge-plus",size:"medium"})}),(0,S.jsx)("div",{className:"margin_l10",children:(0,S.jsx)("h5",{className:"font14",children:Le("FinishedProductInfo_Add")})})]}),(0,S.jsxs)("div",{onClick:_,className:"compartmentIcon margin_l30",children:[(0,S.jsx)("div",{children:(0,S.jsx)(n.Icon,{root:"common",name:"delete",size:"medium"})}),(0,S.jsx)("div",{className:"margin_l10",children:(0,S.jsx)("h5",{className:"font14",children:Le("DestAdd_Delete")})})]})]})})]}),(0,S.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,S.jsx)("div",{className:"col-12 detailsTable",children:(0,S.jsxs)(d.bQ,{data:g,rowExpansionTemplate:Qe,selectionMode:"multiple",selection:v,onSelectionChange:L,scrollable:!0,scrollHeight:"320px",expandedRows:H,children:[(()=>{switch(s.CreatedFromEntity){case 2:return(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"ContractCode",header:(0,m.i7)(Le("ShipmentProdDetail_ContractCode")),editable:s.Status===p.Mw.READY,editFieldType:"text",customEditRenderer:e=>Fe(e,T.contractCodeOptions,p.Pm.PRODUCT)},"ContractCode");case 1:return(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"OrderCode",header:(0,m.i7)(Le("ShipmentCompDetail_OrderCode")),editable:s.Status===p.Mw.READY,editFieldType:"text",customEditRenderer:e=>Fe(e,T.orderCodeOptions,p.Pm.PRODUCT)},"OrderCode");default:return""}})(),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"FinishedProductCode",header:(0,m.i7)(Le("ContractInfo_Product")),editable:s.Status===p.Mw.READY,editFieldType:"text",customEditRenderer:e=>Fe(e,T.finishedProductOptions,p.Pm.PRODUCT)},"FinishedProductCode"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"CustomerCode",header:(0,m.i7)(Le("ShipmentCompDetail_Customer")),editable:s.Status===p.Mw.READY,editFieldType:"text",customEditRenderer:e=>Be(e,p.Pm.PRODUCT)},"CustomerCode"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"DestinationCode",header:(0,m.i7)(Le("ContractInfo_Destination")),editable:s.Status===p.Mw.READY,editFieldType:"text",customEditRenderer:e=>qe(e,p.Pm.PRODUCT)},"DestinationCode"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"Quantity",header:(0,m.i7)(Le("ShipmentCompDetail_Quantity")),editable:s.Status===p.Mw.READY,editFieldType:"text",renderer:e=>He(e),customEditRenderer:e=>We(e,p.Pm.PRODUCT)},"Quantity"),(0,S.jsx)(d.bQ.Column,{initialWidth:"200px",renderer:ke})]})})})]},e))),B.map((e=>(0,S.jsxs)(n.Tab.Pane,{title:Le("Shipment_Compartment_Planning_Tab_Header"),children:[(0,S.jsxs)("div",{className:"row compartmentRow",children:[(0,S.jsx)("div",{className:"col col-md-8 col-lg-9 col col-xl-9"}),(0,S.jsx)("div",{className:"col col-md-4 col-lg-3 col-xl-3",children:(0,S.jsxs)("div",{className:"compartmentIconContainer",children:[(0,S.jsxs)("div",{onClick:R,className:"compartmentIcon",children:[(0,S.jsx)("div",{children:(0,S.jsx)(n.Icon,{root:"common",name:"badge-plus",size:"medium"})}),(0,S.jsx)("div",{className:"margin_l10",children:(0,S.jsx)("h5",{className:"font14",children:Le("FinishedProductInfo_Add")})})]}),(0,S.jsxs)("div",{onClick:j,className:"compartmentIcon margin_l30",children:[(0,S.jsx)("div",{children:(0,S.jsx)(n.Icon,{root:"common",name:"delete",size:"medium"})}),(0,S.jsx)("div",{className:"margin_l10",children:(0,S.jsx)("h5",{className:"font14",children:Le("DestAdd_Delete")})})]})]})})]}),(0,S.jsxs)("div",{className:"row marginRightZero tableScroll",children:[(0,S.jsx)("div",{className:"col-12 detailsTable",children:(0,S.jsxs)(d.bQ,{data:o,rowExpansionTemplate:Qe,selectionMode:"multiple",selection:x,onSelectionChange:I,scrollable:!0,scrollHeight:"320px",expandedRows:H,children:[(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"CompartmentSeqNoInVehicle",header:(0,m.i7)(Le("ShipmentCompDetail_CompSeqInVehicle")),editable:s.Status===p.Mw.READY,editFieldType:"text",customEditRenderer:e=>Fe(e,T.compSeqOptions,p.Pm.COMPARTMENT)},"CompartmentSeqNoInVehicle"),(()=>{switch(s.CreatedFromEntity){case 2:return(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"ContractCode",header:(0,m.i7)(Le("ShipmentProdDetail_ContractCode")),editable:s.Status===p.Mw.READY,editFieldType:"text",customEditRenderer:e=>Fe(e,T.contractCodeOptions,p.Pm.COMPARTMENT)},"ContractCode");case 1:return(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"OrderCode",header:(0,m.i7)(Le("ShipmentCompDetail_OrderCode")),editable:s.Status===p.Mw.READY,editFieldType:"text",customEditRenderer:e=>Fe(e,T.orderCodeOptions,p.Pm.COMPARTMENT)},"OrderCode");default:return""}})(),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"FinishedProductCode",header:(0,m.i7)(Le("ContractInfo_Product")),editable:s.Status===p.Mw.READY,editFieldType:"text",customEditRenderer:e=>Fe(e,T.finishedProductOptions,p.Pm.COMPARTMENT)},"FinishedProductCode"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"CustomerCode",header:(0,m.i7)(Le("ShipmentCompDetail_Customer")),editable:s.Status===p.Mw.READY,editFieldType:"text",customEditRenderer:e=>Be(e,p.Pm.COMPARTMENT)},"CustomerCode"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"DestinationCode",header:(0,m.i7)(Le("ContractInfo_Destination")),editable:s.Status===p.Mw.READY,editFieldType:"text",customEditRenderer:e=>qe(e,p.Pm.COMPARTMENT)},"DestinationCode"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"Quantity",header:(0,m.i7)(Le("ShipmentCompDetail_Quantity")),editable:s.Status===p.Mw.READY,editFieldType:"text",renderer:e=>He(e),customEditRenderer:e=>We(e,p.Pm.COMPARTMENT)},"Quantity"),"MARINE"===s.TransloadSourceType?(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"TransReceiptCode",header:Le("Receipt_Code"),editable:!0,editFieldType:"text",customEditRenderer:e=>Fe(e,T.marineReceiptCodes,p.Pm.COMPARTMENT)},"TransReceiptCode"):"","MARINE"===s.TransloadSourceType?(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"TransCompSequenceNumber",header:Le("Transload_receipt_Comp_No"),editable:!0,editFieldType:"text",customEditRenderer:e=>Fe(e,T.marineReceiptCompCodes,p.Pm.COMPARTMENT)},"TransCompSequenceNumber"):"",(0,S.jsx)(d.bQ.Column,{initialWidth:"200px",renderer:ke})]})}),!k&&me&&null!=s.TransloadSourceType&&"MARINE"===s.TransloadSourceType&&Q===c.de?(0,S.jsx)("div",{className:"col col-md-8 col-lg-9 col col-xl-12",style:{textAlign:"right"},children:(0,S.jsx)(n.Button,{content:Le("shp_trans_receipt_update"),disabled:"TRUE"!==a.f_ShipCompEditAccess||p.g5[s.Status]===p.g5.READY||p.g5[s.Status]===p.g5.LOADING||p.g5[s.Status]===p.g5.AUTO_LOADED||p.g5[s.Status]===p.g5.MANUALLY_LOADED||p.g5[s.Status]===p.g5.CLOSED,onClick:Ce})}):""]})]},e))),q.map((e=>(0,S.jsx)(n.Tab.Pane,{title:Le("Shipment_Compartment_Details_Tab_Header"),children:(0,S.jsxs)("div",{className:"row marginRightZero tableScroll",children:[(0,S.jsx)("div",{className:"col-12 detailsTable",children:(0,S.jsxs)(d.bQ,{data:y,rowExpansionTemplate:Ke,expandedRows:H,scrollable:!0,scrollHeight:"320px",children:[(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"Trailer_Code",header:Le("ShipmentCompDetail_wcTrailerCode")},"Trailer_Code"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"Compartment_Code",header:Le("ShipmentCompDetail_wcCompartmentCode")},"Compartment_Code"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"Compartment_Status",header:Le("ViewShipmentStatus_Status")},"Compartment_Status"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"Finished_Product",header:Le("ViewShipment_FinishedProductCode")},"Finished_Product"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"Planned_Quantity",header:Le("ViewShipmentCompartment_PlannedQuantity")},"Planned_Quantity"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"Revised_Planned_Quantity",header:Le("ViewShipmentCompartment_AdjustedQuantity")},"Revised_Planned_Quantity"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"Loaded_Quantity",header:Le("ReceiptByCompartmentList_LoadedQuantity")},"Loaded_Quantity"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",initialWidth:"135px",header:Le("ViewShipment_ForceComplete"),renderer:Ge}),(0,S.jsx)(d.bQ.Column,{initialWidth:"50px",renderer:ze})]})}),k?"":(0,S.jsx)("div",{className:"col col-md-8 col-lg-9 col col-xl-12",style:{textAlign:"right"},children:(0,S.jsx)(n.Button,{content:Le(Ve),disabled:!Pe,onClick:()=>ie("Approve",Ve)})})]})},e))),W.map((e=>(0,S.jsx)(n.Tab.Pane,{title:Le("CustomerInventory_Details"),children:(0,S.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,S.jsx)("div",{className:"col-12 detailsTable",children:(0,S.jsxs)(d.bQ,{data:ee,scrollable:!0,scrollHeight:"320px",children:[(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"CustomerCode",header:Le("Customer_Code")},"CustomerCode"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"BaseProductCode",header:Le("BaseProductInfo_BaseProdCode")},"BaseProductCode"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"PlannedQuantity",header:Le("ViewShipmentCompartment_PlannedQuantity")},"PlannedQuantity"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"GrossActualQuantity",header:Le("LocalTransactionsMapping_LoadedQuantity")},"GrossActualQuantity")]})})})},e))),oe.map((e=>(0,S.jsxs)(n.Tab.Pane,{title:he.toUpperCase().includes("CUSTOMER")?Le("Product_Allocation_Customer_Header"):Le("Product_Allocation_Carrier_Header"),children:[(0,S.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,S.jsx)("div",{className:"col-12 detailsTable",children:(0,S.jsxs)(d.bQ,{data:re,scrollable:!0,scrollHeight:"320px",children:[(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"customercode",header:he.toUpperCase().includes("CUSTOMER")?Le("Customer_Code"):Le("Entity_Carrier_Code")},"customercode"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"productcode",header:Le("ProductAllocation_Product_Code")},"productcode"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"allocationtype",header:Le("ProductAllocation_Allocation_Type")},"allocationtype"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"allocationperiod",header:Le("ProductAllocationItemInfo_AllocationFrequency")},"allocationperiod"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"startdate",header:Le("ContractInfo_StartDate")},"startdate"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"enddate",header:Le("ContractInfo_EndDate")},"enddate"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"allocatedqty",header:Le("ProductAllocationItemInfo_AllocatedQty")},"allocatedqty"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"blockedqty",header:Le("ProductAllocationItemInfo_BlockedQty")},"blockedqty"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"loadedqty",header:Le("ProductAllocationItemInfo_LoadedQty")},"loadedqty")]})})}),de.length>0?(0,S.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,S.jsx)("div",{className:"col-12 detailsTable",children:(0,S.jsxs)(d.bQ,{data:de,scrollable:!0,scrollHeight:"320px",children:[(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"customercode",header:Le("Customer_Code")},"customercode"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"productcode",header:Le("ProductAllocation_Product_Code")},"productcode"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"allocationtype",header:Le("ProductAllocation_Allocation_Type")},"allocationtype"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"allocationperiod",header:Le("ProductAllocationItemInfo_AllocationFrequency")},"allocationperiod"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"startdate",header:Le("ContractInfo_StartDate")},"startdate"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"enddate",header:Le("ContractInfo_EndDate")},"enddate"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"allocatedqty",header:Le("ProductAllocationItemInfo_AllocatedQty")},"allocatedqty"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"blockedqty",header:Le("ProductAllocationItemInfo_BlockedQty")},"blockedqty"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight colminWidth",field:"loadedqty",header:Le("ProductAllocationItemInfo_LoadedQty")},"loadedqty")]})})}):""]},e)))]})})]}),(0,S.jsxs)(n.Modal,{open:Ne,size:"small",children:[(0,S.jsx)(n.Modal.Content,{children:(0,S.jsx)("div",{children:(0,S.jsx)("b",{children:Le("ForceToComplete")})})}),(0,S.jsxs)(n.Modal.Footer,{children:[(0,S.jsx)(n.Button,{type:"secondary",content:Le("Cancel"),onClick:()=>{we(!1),ne(Re,!1)}}),(0,S.jsx)(n.Button,{type:"primary",content:Le("Confirm"),onClick:()=>{we(!1),ne(Re,!0)}})]})]})]})}g.defaultProps={listOptions:{quantityUOMOptions:[],vehicleOptions:[],terminalCodes:[],driverOptions:[],compSeqOptions:[],finishedProductOptions:[],customerDestinationOptions:{},shipmentFromOptions:[],transloadingOptions:[]},isEnterpriseNode:!1,isDisableSubmitForApproval:!0,isSlotbookinginUI:!1,isEnforcingEnabled:!1,isBonded:!1,ShipmentBay:""};var y=s(44192),D=s(28882),b=s(9256),T=s(43503),A=s(40252),E=s(53536),f=s.n(E),v=s(14159),x=s(11981),I=s(46100),L=s(40854),N=s.n(L),w=s(93779),R=s(61227),j=s(82501);function P(e){let{trailerDetails:t,selectedAttributeList:s,handleBack:i,ShipmentCode:a,compAttributes:o}=e;const[h]=(0,l.useTranslation)(),c=()=>{},m=e=>{const t=e.rowData.AttributesforUI.filter((t=>t.AttributeName===e.name))[0];return t.DataType.toLowerCase()===p.pe.STRING.toLowerCase()||t.DataType.toLowerCase()===p.pe.INT.toLowerCase()||t.DataType.toLowerCase()===p.pe.LONG.toLowerCase()||t.DataType.toLowerCase()===p.pe.FLOAT.toLowerCase()?(0,S.jsx)("label",{children:t.AttributeValue}):t.DataType.toLowerCase()===p.pe.BOOL.toLowerCase()?(0,S.jsx)(n.Checkbox,{checked:"true"===t.AttributeValue.toString().toLowerCase(),disabled:!0}):(0,S.jsx)("label",{children:new Date(t.AttributeValue).toLocaleDateString()})};return(0,S.jsxs)("div",{className:"detailsContainer",children:[(0,S.jsx)("div",{className:"row",children:(0,S.jsx)("div",{className:"col col-md-8 col-lg-9 col col-xl-9",children:(0,S.jsx)("h3",{children:h("Vehicle_TRDetails")+" : "+a})})}),t&&t.length>0?t.map((e=>(0,S.jsx)(u.A,{children:(0,S.jsx)(n.Accordion,{className:"shipmentTrailerAccordion",children:(0,S.jsxs)(n.Accordion.Content,{className:"attributeAccordian",title:e.shipmentTrailerInfo.TrailerName,children:[(0,S.jsxs)("div",{className:"row",children:[(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Input,{fluid:!0,value:e.shipmentTrailerInfo.TrailerCode,label:h("ShipmentCompDetail_wcTrailerCode"),disabled:!0,reserveSpace:!1})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Input,{fluid:!0,value:e.shipmentTrailerInfo.TrailerName,label:h("ShipmentCompDetail_wcTrailerName"),disabled:!0,reserveSpace:!1})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Input,{fluid:!0,value:e.shipmentTrailerInfo.TareWeight,label:h("ViewShipmentTrailer_RegisteredTAREWt"),disabled:!0,reserveSpace:!1})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Input,{fluid:!0,value:e.shipmentTrailerInfo.MaxLoadableWeight,label:h("PrimeMover_MaxLoadWeight"),disabled:!0,reserveSpace:!1})}),(0,S.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,S.jsx)(n.Input,{fluid:!0,value:e.shipmentTrailerInfo.MaxLoadableVolume,label:h("ViewShipmentTrailer_MaxLoadableVolume"),disabled:!0,reserveSpace:!1})})]}),s.length>0?s.map((e=>(0,S.jsx)(u.A,{children:(0,S.jsx)(n.Accordion,{className:"shipmentTrailerAttributeAccordion",children:(0,S.jsx)(n.Accordion.Content,{className:"attributeAccordian",title:h("SHIPMENTTRAILER_Attributes"),children:(0,S.jsx)(r.n,{selectedAttributeList:e.attributeMetaDataList,handleCellDataEdit:c,attributeValidationErrors:c})})})}))):null,(0,S.jsxs)("div",{className:"row",children:[(0,S.jsx)("div",{className:"col-12 detailsTable",children:(0,S.jsxs)(d.bQ,{className:"shipmentTrailerTareWeightTable",data:e.shipmentTrailerTWInfoList,scrollable:!0,scrollHeight:"320px",children:[(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"TareWeightTime",header:h("ViewShipmentTrailerStatus_Time"),editable:!1},"TareWeightTime"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"WeighBridgeCode",header:h("ViewShipmentTrailerStatus_Weighbridge"),editable:!1},"WeighBridgeCode"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"TareWeight",header:h("ViewShipmentTrailerStatus_TareWeight"),editable:!1},"TareWeight"),o?o.map((e=>(0,S.jsx)(d.bQ.Column,{className:"compColHeight",header:h(e.AttributeName),editable:!1,renderer:m}))):null]})}),(0,S.jsx)("div",{className:"col-12 detailsTable",children:(0,S.jsxs)(d.bQ,{className:"shipmentTrailerTareWeightTable",data:e.shipmentTrailerWBInfoList,scrollable:!0,scrollHeight:"320px",children:[(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"EndTime",header:h("ViewShipmentTrailerStatus_Time"),editable:!1},"EndTime"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"WeighBridgeCode",header:h("ViewShipmentTrailerStatus_Weighbridge"),editable:!1},"WeighBridgeCode"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"MeasuredWeight",header:h("ViewShipmentTrailerStatus_MeasuredWeight"),editable:!1},"MeasuredWeight"),(0,S.jsx)(d.bQ.Column,{className:"compColHeight",field:"MaxLoadVol",header:h("ViewShipmentTrailerStatus_ActualLoadedVol"),editable:!1},"MaxLoadVol"),o?o.map((e=>(0,S.jsx)(d.bQ.Column,{className:"compColHeight",header:h(e.AttributeName),editable:!1,renderer:m}))):null]})})]})]})})}))):null,(0,S.jsx)("div",{className:"row",children:(0,S.jsx)("div",{className:"col col-lg-8",children:(0,S.jsx)(n.Button,{className:"backButton",onClick:i,content:h("Back")})})})]})}var _=s(15417),V=s(72067),O=s(2070),M=s(40510),U=s(39424),k=s(56507),Q=s(62900);class F extends i.Component{constructor(){var e;super(...arguments),e=this,this.state={shipment:{},modShipment:{},modCustomValues:{},modCompartmentPlans:[],modProductPlans:[],modLoadingDetails:[],staticLoadingDetails:[],trailerDetails:[],vehicleDetails:{carrierCode:"",vehicleCompartments:[]},modVehicleDetails:{carrierCode:"",vehicleCompartments:[]},validationErrors:C.Th(y.Kh),isReadyToRender:!1,saveEnabled:!1,selectedCompartmentPlans:[],selectedProductPlans:[],vehicleOptions:[],driverOptions:[],quantityUOMOptions:[],finishedProductOptions:[],compSeqOptions:[],customerDestinationOptions:[],vehicleSearchOptions:[],driverSearchOptions:[],expandedRows:[],selectedAttributeList:[],attributeValidationErrors:[],attributeMetaDataList:[],compAttributeMetaDataList:[],prodCompAttributeMetaDataList:[],trailerCompAttributeMetaDataList:[],compAttributeValidationErrors:[],prodCompAttributeValidationErrors:[],customerInventory:[],isPlanned:!1,shipmentNextOperations:[],currentShipmentStatuses:[],isValidationPassed:!0,isManualEntry:!1,isVolumeBased:!1,activeTab:this.props.ShipmentType.toLowerCase()===c.de?1:0,isDisableSubmitForApproval:!0,isViewAuditTrail:!1,isViewTrailerDetails:!1,auditTrailList:[],modAuditTrailList:[],productAllocationList:[],ProdAllocEntity:"",productShareholderAllocationList:[],trailers:[],selectedShipTrailerAttributeList:[],selectedCompAttributes:[],isViewLoadingDetails:!1,modViewLoadingDetails:[],loadingExpandedRows:[],nonConfigColumns:[],isSealCompartments:!1,sealCompartments:[],isRecordWeight:!1,recordWeightList:[],weighBridgeCode:"",scadaValue:"",allowOutofRangeTW:!1,isCloseShipment:!1,isVehicleCrippled:!1,isNotRevised:!1,topUpDecantOptions:[p.Bw.NONE,p.Bw.REQUEST_APPROVE,p.Bw.REQUEST_REJECT],ddlTopUpDecantStatus:null,contractCodeOptions:[],ordertCodeOptions:[],isMarineTransLoading:!1,isRailTransloading:!1,marineReceiptCodes:[],marineReceiptCompCodes:[],drawerStatus:!0===this.props.userDetails.EntityResult.IsWebPortalUser,otherSourceData:[],isAutoGeneratedShipmentCode:!1,isEnforcingEnabled:!1,isBonded:!1,bondExpiryDate:null,isVehicleChanged:!1,autoGeneratedCode:"",isVehicleBonded:!1,vehicleBondPopUp:!1,vehicleBondExpiryPopUp:!1,stockProducts:!1,isLoadingDetailsChanged:!1,truckShipmentKPIList:[],vehicleForRecordWeight:{},isLadenWeightValid:!1,ladenWeightError:"",tempShipment:{},showShipmentAuthenticationLayout:!1,showAuthorizeToLoadAuthenticationLayout:!1,showAllowToLoadAuthenticationLayout:!1,showCloseShipmentAuthenticationLayout:!1,showViewBOLAuthenticationLayout:!1,showPrintBOLAuthenticationLayout:!1,showFANAuthenticationLayout:!1,isAllocateBay:!1,bayData:[],selectBay:[],isDeAllocateBay:!1,ShipmentBay:""},this.handleChange=(e,t)=>{try{const i=f().cloneDeep(this.state.modShipment);i[e]=t;var s={...this.state.validationErrors};void 0!==y.Kh[e]&&(s[e]=C.jr(y.Kh[e],t)),"IsBonded"===e&&(i.ShipmentBondNo=""),this.setState({validationErrors:s,modShipment:i},(()=>{"TerminalCodes"===e&&this.terminalSelectionChange(t)})),"TransloadSourceType"===e&&"MARINE"===t&&this.getMarineTransloadableReceipts(),"ddlTopUpDecant"===e&&this.setState({ddlTopUpDecantStatus:t})}catch(i){console.log(this.props.ShipmentType+":Error occured on handleChange",i)}},this.getMarineReceipt=e=>{var t=[{key:w.UB,value:e},{key:w.v6,value:p.LY.MARINE}],s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.UB,KeyCodes:t};N()(V.t7V,C.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess&&null!==t.EntityResult&&void 0!==t.EntityResult){let e=[];void 0!==t.EntityResult.RailMarineReceiptCompartmentDetailPlanList&&null!==t.EntityResult.RailMarineReceiptCompartmentDetailPlanList&&t.EntityResult.RailMarineReceiptCompartmentDetailPlanList.forEach((t=>{!0===t.IsTransloading&&e.push(t.CompartmentSeqNoInVehicle)})),this.setState({marineReceiptCompCodes:C.Zj(e)})}})).catch((e=>{console.log("Error while getting marineReceipt:",e)}))},this.handleCompartmentPlanCellDataEdit=(e,t)=>{try{let s=f().cloneDeep(this.state.modCompartmentPlans);if(s[t.rowIndex][t.field]=e,"CustomerCode"===t.field){let i=this.state.customerDestinationOptions;void 0!==i&&null!==i&&(void 0!==i[e]&&Array.isArray(i[e])&&1===i[e].length?s[t.rowIndex].DestinationCode=i[e][0]:s[t.rowIndex].DestinationCode="")}else if("CompartmentSeqNoInVehicle"===t.field){let i=this.state.modVehicleDetails.vehicleCompartments.filter((t=>t.vehCompSeq.toString()===e.toString()));i.length>0&&(s[t.rowIndex].Quantity=null!==i[0].SFL&&""!==i[0].SFL?i[0].SFL.toLocaleString():null,s[t.rowIndex].TrailerCode=i[0].trailerCode,s[t.rowIndex].CompartmentCode=i[0].compCode)}this.attributeToggleExpand(s[t.rowIndex],!0,!0),this.setState({modCompartmentPlans:s})}catch(s){console.log(this.props.ShipmentType+":Error occured on handleCompartmentPlanCellDataEdit",s)}},this.handleProductPlanCellDataEdit=(e,t)=>{try{let s=f().cloneDeep(this.state.modProductPlans);if(s[t.rowIndex][t.field]=e,"CustomerCode"===t.field){let i=this.state.customerDestinationOptions;void 0!==i&&null!==i&&(void 0!==i[e]&&Array.isArray(i[e])&&1===i[e].length?s[t.rowIndex].DestinationCode=i[e][0]:s[t.rowIndex].DestinationCode="")}this.attributeToggleExpand(s[t.rowIndex],!0,!0),this.setState({modProductPlans:s})}catch(s){console.log(this.props.ShipmentType+":Error occured on handleProductPlanCellDataEdit",s)}},this.getSiteConfigurationLookUP=()=>{try{N()(V.xAA+"?LookUpTypeCode=SiteConfiguration",C.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){let e=t.EntityResult;this.getWeighBridge(e)}else console.log("Error in getSiteConfigurationLookUP: ",t.ErrorList)})).catch((e=>{console.log("TruckShipmentDetailsComposite: Error occurred on getSiteConfigurationLookUP",e)}))}catch(e){console.log("TruckShipmentDetailsComposite: Error occurred on getSiteConfigurationLookUP",e)}},this.handleSaveShipment=()=>{try{this.setState({saveEnabled:!1});let e=f().cloneDeep(this.state.tempShipment);""===this.state.shipment.ShipmentCode?this.createShipment(e):this.updateShipment(e)}catch(e){console.log("ShipDetailsComposite : Error in handleSaveShipment")}},this.handleSave=()=>{try{let e=""===this.state.shipment.ShipmentCode||"TRUE"===this.state.modCustomValues.ShipmentUpdateAllow&&C.ab(this.props.userDetails.EntityResult.FunctionsList,c.i.modify,this.props.ShipmentType.toLowerCase()),t=f().cloneDeep(this.state.modShipment);e?t.IsBonded?this.state.isVehicleBonded?""!==this.state.bondExpiryDate&&null!==this.state.bondExpiryDate&&void 0!==this.state.bondExpiryDate&&this.setState({vehicleBondExpiryPopUp:!0}):this.setState({vehicleBondPopUp:!0}):this.saveShipment():(this.props.ShipmentType.toLowerCase()===c.yu&&2===this.state.activeTab&&this.state.isLoadingDetailsChanged&&"FALSE"===this.state.modCustomValues.DisableLoadingDetails||this.props.ShipmentType.toLowerCase()===c.de&&1===this.state.activeTab&&this.state.isLoadingDetailsChanged&&"FALSE"===this.state.modCustomValues.DisableLoadingDetails)&&this.handleTopUpDecantApproval("SaveCompartment")}catch(e){console.log(this.props.ShipmentType+":Error occured on handleSave",e)}},this.handleVehicleChange=e=>{try{this.getVehicle(e,!0);let t=f().cloneDeep(this.state.validationErrors);t.VehicleCode="",this.setState({validationErrors:t})}catch(t){console.log(this.props.ShipmentType+":Error occured on handleVehicleChange",t)}},this.handleDriverSearchChange=e=>{try{let t=this.state.driverOptions.filter((t=>t.value.toLowerCase().includes(e.toLowerCase())));t.length>p.bM&&(t=t.slice(0,p.bM)),this.setState({driverSearchOptions:t})}catch(t){console.log(this.props.ShipmentType+":Error occured on handleDriverSearchChange",t)}},this.handleVehicleSearchChange=e=>{try{let t=this.state.vehicleOptions.filter((t=>t.value.toLowerCase().includes(e.toLowerCase())));t.length>p.bM&&(t=t.slice(0,p.bM)),this.setState({vehicleSearchOptions:t})}catch(t){console.log(this.props.ShipmentType+":Error occured on handleVehicleSearchChange",t)}},this.toggleExpand=(e,t)=>{let s=this.state.expandedRows,i=s.findIndex((t=>t.SeqNo===e.SeqNo));t?s.splice(i,1):s.push(e),this.setState({expandedRows:s})},this.loadingToggleExpand=(e,t)=>{let s=this.state.loadingExpandedRows,i=s.findIndex((t=>t.SeqNumber===e.SeqNumber));t?s.splice(i,1):s.push(e),this.setState({loadingExpandedRows:s})},this.attributeToggleExpand=function(t,s){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.state.expandedRows,o=a.findIndex((e=>e.SeqNumber===t.SeqNumber));s?i&&o>=0?(a.splice(o,1),a.push(t)):o>=0&&a.splice(o,1):o>=0?a=a.filter((e=>e.Code!==t.Code&&e.SeqNumber!==t.SeqNumber)):a.push(t),e.setState({expandedRows:a})},this.RecordTareWeight=()=>{try{var e=[{key:w.bW,value:this.state.weighBridgeCode},{key:w.VA,value:this.state.scadaValue},{key:w.ok,value:this.state.shipment.VehicleCode},{key:w.yz,value:this.state.shipment.ShipmentCode},{key:w.Rb,value:this.state.allowOutofRangeTW}];let s={messageType:"critical",message:"ViewAllShipment_Record_Weight",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[this.state.shipment.ShipmentCode],isSuccess:!1,errorMessage:""}]};var t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.bW,KeyCodes:e};N()(V.wVD,C.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{s.messageType=e.data.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=e.data.IsSuccess,e.data.IsSuccess?this.setState({isRecordWeight:!1},(()=>{this.getShipment({Common_Code:this.state.modShipment.ShipmentCode},null,null,s)})):(s.messageResultDetails[0].errorMessage=e.data.ErrorList[0],this.props.onSaved(this.state.modShipment,"update",s))})).catch((e=>{console.log("Error while recording tare weight:",e)}))}catch(s){console.log("Error in GetScadaValue")}},this.getScadaValue=()=>{try{var e=[{key:w.bW,value:this.state.weighBridgeCode}],t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.bW,KeyCodes:e};N()(V.$E2,C.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{let t={messageType:"critical",message:"ViewAllShipment_Record_Weight",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[this.state.shipment.ShipmentCode],isSuccess:!1,errorMessage:""}]};t.messageType=e.data.IsSuccess?"success":"critical",t.messageResultDetails[0].isSuccess=e.data.IsSuccess,e.data.IsSuccess?this.setState({scadaValue:e.data.EntityResult}):(t.messageResultDetails[0].errorMessage=e.data.ErrorList[0],(0,v.toast)((0,S.jsx)(u.A,{children:(0,S.jsx)(x.A,{notificationMessage:t})}),{autoClose:"success"===t.messageType&&1e4}))})).catch((e=>{console.log("Error while getting weigh brdige Scada value:",e)}))}catch(s){console.log("Error in GetScadaValue")}},this.printBOL=()=>{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showPrintBOLAuthenticationLayout:e},(()=>{!1===e&&this.handlePrintBOL()}))},this.handlePrintBOL=()=>{this.handleAuthenticationClose();let e=f().cloneDeep(this.state.modShipment),t={messageType:"critical",message:"ViewShipmentStatus_PrintBOL_status",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[e.ShipmentCode],isSuccess:!1,errorMessage:""}]};this.props.handlePrintBOL(e.ShipmentCode,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{t.messageType=e.IsSuccess?"success":"critical",t.messageResultDetails[0].isSuccess=e.IsSuccess,t.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,v.toast)((0,S.jsx)(u.A,{children:(0,S.jsx)(x.A,{notificationMessage:t})}),{autoClose:"success"===t.messageType&&1e4})}))},this.printFAN=()=>{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showFANAuthenticationLayout:e},(()=>{!1===e&&this.handlePrintFAN()}))},this.handlePrintFAN=()=>{this.handleAuthenticationClose();let e=f().cloneDeep(this.state.modShipment),t={messageType:"critical",message:"ViewShipmentStatus_PrintFAN_status",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[e.ShipmentCode],isSuccess:!1,errorMessage:""}]};this.props.handlePrintFAN(e.ShipmentCode,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{t.messageType=e.IsSuccess?"success":"critical",t.messageResultDetails[0].isSuccess=e.IsSuccess,t.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,v.toast)((0,S.jsx)(u.A,{children:(0,S.jsx)(x.A,{notificationMessage:t})}),{autoClose:"success"===t.messageType&&1e4})}))},this.allowToLoad=()=>{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showAllowToLoadAuthenticationLayout:e},(()=>{!1===e&&this.handleAllowToLoad()}))},this.handleAllowToLoad=()=>{this.handleAuthenticationClose();let e=f().cloneDeep(this.state.modShipment),t={messageType:"critical",message:"ViewShipment_AllowToLoad_status",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[e.ShipmentCode],isSuccess:!1,errorMessage:""}]};this.props.handleAllowToLoad(e,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(s=>{t.messageType=s.IsSuccess?"success":"critical",t.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?this.getShipment({Common_Code:e.ShipmentCode},null,null,t):(t.messageResultDetails[0].errorMessage=s.ErrorList[0],this.props.onSaved(e,"update",t))}))},this.confirmAllowToLoad=()=>(0,S.jsx)(l.TranslationConsumer,{children:e=>(0,S.jsxs)(n.Modal,{open:this.state.isNotRevised,size:"small",children:[(0,S.jsx)(n.Modal.Content,{children:(0,S.jsx)("div",{className:"col col-lg-12",children:(0,S.jsx)("h5",{children:e("ViewShipment_ConfirmAllowToLoad")})})}),(0,S.jsxs)(n.Modal.Footer,{children:[(0,S.jsx)(n.Button,{type:"primary",content:e("AccessCardInfo_Ok"),onClick:()=>{this.setState({isNotRevised:!1},(()=>{this.allowToLoad()}))}}),(0,S.jsx)(n.Button,{type:"primary",content:e("Cancel"),onClick:()=>{this.setState({isNotRevised:!1})}})]})]})}),this.confirmDeAllocateBay=()=>(0,S.jsx)(l.TranslationConsumer,{children:e=>(0,S.jsxs)(n.Modal,{open:this.state.isDeAllocateBay,size:"small",children:[(0,S.jsx)(n.Modal.Content,{children:(0,S.jsx)("div",{className:"col col-lg-12",children:(0,S.jsx)("h5",{children:e("ViewAllocateBay_ConfirmDeallocateBay",[this.state.ShipmentBay,"Shipment"])})})}),(0,S.jsxs)(n.Modal.Footer,{children:[(0,S.jsx)(n.Button,{type:"primary",className:"cancelButton",content:e("Cancel"),onClick:()=>{this.setState({isDeAllocateBay:!1})}}),(0,S.jsx)(n.Button,{type:"primary",content:e("ViewAllocateBay_Deallocate"),onClick:()=>{this.setState({isDeAllocateBay:!1},(()=>{this.DeAllocateBay(this.state.shipment.ShipmentCode,"SHIPMENT",this.state.ShipmentBay)}))}})]})]})}),this.confirmRecordLadenWeight=()=>(0,S.jsx)(l.TranslationConsumer,{children:e=>(0,S.jsxs)(n.Modal,{open:this.state.isLadenWeightValid,size:"small",children:[(0,S.jsx)(n.Modal.Content,{children:(0,S.jsx)("div",{className:"col col-lg-12",children:(0,S.jsx)("h5",{children:e(this.state.ladenWeightError)+e("ConfirmCaptureLadenWeight")})})}),(0,S.jsxs)(n.Modal.Footer,{children:[(0,S.jsx)(n.Button,{type:"primary",content:e("AccessCardInfo_Ok"),onClick:()=>{this.setState({isLadenWeightValid:!1},(()=>{this.RecordLadenWeight()}))}}),(0,S.jsx)(n.Button,{type:"primary",content:e("Cancel"),onClick:()=>{this.setState({isLadenWeightValid:!1})}})]})]})}),this.confirmVehicleBond=()=>(0,S.jsx)(l.TranslationConsumer,{children:e=>(0,S.jsxs)(n.Modal,{open:this.state.vehicleBondPopUp,size:"small",children:[(0,S.jsx)(n.Modal.Content,{children:(0,S.jsx)("div",{className:"col col-lg-12",children:(0,S.jsx)("h5",{children:e("ShipmentBonded_VehicleNonBonded")})})}),(0,S.jsxs)(n.Modal.Footer,{children:[(0,S.jsx)(n.Button,{type:"primary",content:e("AccessCardInfo_Ok"),onClick:()=>{this.setState({vehicleBondPopUp:!1,stockProducts:!0})}}),(0,S.jsx)(n.Button,{type:"primary",content:e("Cancel"),onClick:()=>{this.setState({vehicleBondPopUp:!1})}})]})]})}),this.confirmBondedStockProducts=()=>(0,S.jsx)(l.TranslationConsumer,{children:e=>(0,S.jsxs)(n.Modal,{open:this.state.stockProducts,size:"small",children:[(0,S.jsx)(n.Modal.Content,{children:(0,S.jsx)("div",{className:"col col-lg-12",children:(0,S.jsx)("h5",{children:e("ShipmentBonded_StockProducts")})})}),(0,S.jsx)(n.Modal.Footer,{children:(0,S.jsx)(n.Button,{type:"primary",content:e("AccessCardInfo_Ok"),onClick:()=>{this.setState({stockProducts:!1},(()=>{this.saveShipment()}))}})})]})}),this.confirmVehicleBondExpiryDate=()=>(0,S.jsx)(l.TranslationConsumer,{children:e=>(0,S.jsxs)(n.Modal,{open:this.state.vehicleBondExpiryPopUp,size:"small",children:[(0,S.jsx)(n.Modal.Content,{children:(0,S.jsx)("div",{className:"col col-lg-12",children:(0,S.jsx)("h5",{children:e("ShipmentBonded_VehicleBondExpiryDate")})})}),(0,S.jsxs)(n.Modal.Footer,{children:[(0,S.jsx)(n.Button,{type:"primary",content:e("AccessCardInfo_Ok"),onClick:()=>{this.setState({vehicleBondExpiryPopUp:!1,stockProducts:!0})}}),(0,S.jsx)(n.Button,{type:"primary",content:e("Cancel"),onClick:()=>{this.setState({vehicleBondExpiryPopUp:!1})}})]})]})}),this.handleRecordWeight=()=>(0,S.jsx)(l.TranslationConsumer,{children:e=>(0,S.jsxs)(n.Modal,{open:this.state.isRecordWeight,size:"small",children:[(0,S.jsxs)(n.Modal.Content,{children:[(0,S.jsx)("div",{className:"col col-lg-12",children:(0,S.jsx)("h3",{children:e("ViewAllShipment_RecordWeightShipment")+" : "+this.state.shipment.ShipmentCode})}),(0,S.jsxs)("div",{style:{display:"flex",flexWrap:"wrap"},children:[(0,S.jsx)("div",{className:"col col-lg-9",children:(0,S.jsx)(n.Select,{fluid:!0,placeholder:e("Select_WB"),label:e("ViewShipment_WeighBridgeCode"),value:this.state.weighBridgeCode,options:C.Zj(this.state.recordWeightList),onChange:e=>{this.setState({weighBridgeCode:e},(()=>this.getScadaValue()))}})}),(0,S.jsx)("div",{className:"shipmentRecordWeightButtonDiv",children:(0,S.jsx)(n.Button,{type:"primary",size:"small",className:"shipmentRecordWeightButton",content:e("ViewShipment_ReadWeight"),onClick:()=>this.getScadaValue(),disabled:null===this.state.weighBridgeCode||""===this.state.weighBridgeCode||void 0===this.state.weighBridgeCode})})]}),(0,S.jsx)("div",{style:{display:"flex",flexWrap:"wrap"},children:(0,S.jsx)("div",{className:"col col-lg-12",children:(0,S.jsx)(n.Input,{fluid:!0,value:this.state.scadaValue,label:e("ViewShipment_Weight"),reserveSpace:!1,disabled:!0})})}),(0,S.jsx)("div",{style:{display:"flex",flexWrap:"wrap"},children:(0,S.jsx)("div",{className:"col col-lg-12",children:(0,S.jsx)(n.Checkbox,{className:"LabelEnabled",label:e("Allow_Out_of_Tolerance_for_TW"),checked:this.state.allowOutofRangeTW,onChange:e=>{this.setState({allowOutofRangeTW:e})},disabled:!1})})})]}),(0,S.jsxs)(n.Modal.Footer,{children:[(0,S.jsx)(n.Button,{type:"primary",className:"shipmentRecordWeightOtherbuttons",content:e("ViewShipment_RecordTareWeight"),onClick:()=>this.RecordTareWeight(),disabled:null===this.state.scadaValue||""===this.state.scadaValue||void 0===this.state.scadaValue}),(0,S.jsx)(n.Button,{type:"primary",content:e("ViewShipment_RecordLadenWeight"),className:"shipmentRecordWeightOtherbuttons",onClick:()=>this.getSiteConfigurationLookUP(),disabled:null===this.state.scadaValue||""===this.state.scadaValue||void 0===this.state.scadaValue}),(0,S.jsx)(n.Button,{type:"primary",content:e("Cancel"),className:"shipmentRecordWeightOtherbuttons",onClick:()=>{this.setState({isRecordWeight:!1,weighBridgeCode:"",scadaValue:""})}})]})]})}),this.handleStatus=e=>e===p.bw.EMPTY?"EMPTY":e===p.bw.LOADING?"LOADING":e===p.bw.PART_FILLED?"PART_FILLED":e===p.bw.OVER_FILLED?"OVER_FILLED":e===p.bw.FORCE_COMPLETED?"FORCE_COMPLETED":e===p.bw.COMPLETED?"COMPLETED":e===p.bw.INTERRUPTED?"INTERRUPTED":"",this.closeShipment=()=>{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showCloseShipmentAuthenticationLayout:e},(()=>{!1===e&&this.handleShipmentClose()}))},this.handleShipmentClose=()=>{this.handleAuthenticationClose();try{let s=this.formTopUpDecantRequest(p.Bw.FORCE_COMPLETED,"FORCECLOSE"),i={messageType:"critical",message:"ViewAllShipment_ShipmentClose",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[this.state.shipment.ShipmentCode],isSuccess:!1,errorMessage:""}]};var e=[{key:w.FR,value:this.props.selectedShareholder},{key:w.yz,value:this.state.modShipment.ShipmentCode}],t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.yz,KeyCodes:e,Entity:s};N()(V.dWY,C.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;i.messageType=t.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getShipment({Common_Code:this.state.shipment.ShipmentCode},null,null,i):(i.messageResultDetails[0].errorMessage=t.ErrorList[0],this.props.onSaved(this.state.modShipment,"update",i))})).catch((e=>{console.log("Error while CloseShipment:",e)}))}catch(s){console.log("Error while closing the shipment:",s)}},this.confirmAllocateBay=()=>{let e=f().cloneDeep(this.state.bayData);return(0,S.jsx)(l.TranslationConsumer,{children:t=>(0,S.jsxs)(n.Modal,{open:this.state.isAllocateBay,size:"small",children:[(0,S.jsxs)(n.Modal.Content,{children:[(0,S.jsx)("div",{className:"col col-lg-12",children:(0,S.jsxs)("h3",{children:[t("ViewAllocateBay_AllocateBay")," -"," ",this.state.shipment.ShipmentCode]})}),(0,S.jsx)("div",{className:"col-12 detailsTable",children:(0,S.jsxs)(d.bQ,{className:"iconblock",data:e,selection:this.state.selectBay,selectionMode:"single",showHeader:!0,onSelectionChange:e=>this.setState({selectBay:e}),rows:this.props.userDetails.EntityResult.PageAttibutes.WebPortalListPageSize,resizableColumns:!0,children:[(0,S.jsx)(d.bQ.Column,{className:"compColHeight compColmiddle",field:"BayCode",header:t("ViewAllocateBay_BayCode"),editable:!1}),(0,S.jsx)(d.bQ.Column,{className:"compColHeight compColmiddle",field:"AssociatedProduct",header:t("ViewAllocateBay_FinishProduct"),editable:!1}),(0,S.jsx)(d.bQ.Column,{className:"compColHeight compColmiddle",field:"CurrentQueue",header:t("ViewAllocateBay_CurrentQueue"),editable:!1}),(0,S.jsx)(d.bQ.Column,{className:"compColHeight compColmiddle",field:"MaximumQueue",header:t("ViewAllocateBay_MaximumQueue"),editable:!1}),Array.isArray(e)&&e.length>this.props.userDetails.EntityResult.PageAttibutes.WebPortalListPageSize?(0,S.jsx)(d.bQ.Pagination,{}):""]})})]}),(0,S.jsxs)(n.Modal.Footer,{children:[(0,S.jsx)(n.Button,{type:"primary",content:t("MarineEOD_Close"),className:"cancelButton",onClick:()=>this.setState({isAllocateBay:!1})}),(0,S.jsx)(n.Button,{type:"primary",content:t("ViewAllocateBay_Allocate"),onClick:()=>{if(null===this.state.selectBay||void 0===this.state.selectBay||0===this.state.selectBay.length){let e={messageType:"critical",message:"ViewAllocateBay_Allocate",messageResultDetails:[{keyFields:["BayCode"],keyValues:[],isSuccess:!1,errorMessage:"ViewAllocateBay_bayrequired"}]};(0,v.toast)((0,S.jsx)(u.A,{children:(0,S.jsx)(x.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})}else this.AllocateBay(this.state.shipment.ShipmentCode,this.state.selectBay[0].BayCode,"SHIPMENT")}})]})]})})},this.handleTopUpDecantApproval=(e,t)=>{"SaveCompartment"===e?this.UpdateShipmentCompartmentInfo():"Approve"===e&&this.ApproveTopUpDecant(t)},this.handleCloseShipmentModal=()=>(0,S.jsx)(l.TranslationConsumer,{children:e=>(0,S.jsxs)(n.Modal,{open:this.state.isCloseShipment,size:"mini",children:[(0,S.jsxs)(n.Modal.Content,{children:[(0,S.jsx)("div",{className:"col col-lg-12",children:(0,S.jsx)("h3",{children:e("ViewShipment_CloseHeader")+" : "+this.state.shipment.ShipmentCode})}),(0,S.jsxs)("div",{style:{display:"flex",flexWrap:"wrap"},children:[(0,S.jsx)("div",{className:"col col-lg-9",children:(0,S.jsx)("label",{children:e("CloseShipment_VehicleCrippled")})}),(0,S.jsx)("div",{children:(0,S.jsx)(n.Checkbox,{checked:this.state.isVehicleCrippled,onChange:e=>{this.setState({isVehicleCrippled:e},(()=>{e?this.setState({reasonForClosure:"Crippled"}):this.setState({reasonForClosure:""})}))}})})]}),(0,S.jsx)("div",{style:{display:"flex",flexWrap:"wrap"},children:(0,S.jsx)("div",{className:"col col-lg-12",children:(0,S.jsx)(n.Input,{fluid:!0,value:this.state.reasonForClosure,label:e("ViewShipment_Reason"),disbaled:!!this.state.isVehicleCrippled,reserveSpace:!1,onChange:e=>{this.setState({reasonForClosure:e})}})})})]}),(0,S.jsxs)(n.Modal.Footer,{children:[(0,S.jsx)(n.Button,{type:"primary",content:e("AccessCardInfo_Ok"),onClick:()=>{if(""===this.state.reasonForClosure){let e={messageType:"critical",message:"ViewAllShipment_ShipmentClose",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[this.state.shipment.ShipmentCode],isSuccess:!1,errorMessage:"Enter_ReasonForCloseure"}]};(0,v.toast)((0,S.jsx)(u.A,{children:(0,S.jsx)(x.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})}else this.setState({isCloseShipment:!1},(()=>{this.closeShipment()}))}}),(0,S.jsx)(n.Button,{type:"primary",content:e("Cancel"),onClick:()=>{this.setState({isCloseShipment:!1,isVehicleCrippled:!1,reasonForClosure:""})}})]})]})}),this.authorizeToLoad=()=>{this.handleAuthenticationClose();let e=f().cloneDeep(this.state.modShipment),t={messageType:"critical",message:"ViewShipment_AuthorizeLoad_status",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[e.ShipmentCode],isSuccess:!1,errorMessage:""}]};this.props.handleAuthorizeToLoad(e,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(s=>{t.messageType=s.IsSuccess?"success":"critical",t.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?this.getShipment({Common_Code:e.ShipmentCode},null,null,t):(t.messageResultDetails[0].errorMessage=s.ErrorList[0],this.props.onSaved(e,"update",t))}))},this.handleOperationClick=e=>{let t=f().cloneDeep(this.state.modShipment),s={messageType:"critical",message:e+"_status",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[t.ShipmentCode],isSuccess:!1,errorMessage:""}]};switch(e){case"ViewAllShipment_Trailer_Details":this.getTrailerDetails(this.state.shipment);break;case p.fY.ViewShipment_AuthorizeLoad:let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showAuthorizeToLoadAuthenticationLayout:e},(()=>{!1===e&&this.authorizeToLoad()}));break;case p.fY.ViewShipment_AllowToLoad:f().cloneDeep(this.state.modLoadingDetails).filter((e=>e.Planned_Quantity!==e.Revised_Planned_Quantity)).length<=0?this.setState({isNotRevised:!0}):this.handleAllowToLoad();break;case p.fY.ManualEntry:this.setState({isManualEntry:!0});break;case p.fY.ViewShipment_RecordWeight:this.getRecordWeightList();break;case p.fY.ViewShipment_CloseShipment:this.setState({isCloseShipment:!0});break;case p.fY.ViewShipmentStatus_PrintFAN:this.printFAN();break;case p.fY.ViewShipmentStatus_PrintBOL:this.printBOL();break;case p.fY.ViewShipmentStatus_ViewBOL:let i=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showViewBOLAuthenticationLayout:i},(()=>{!1===i&&this.viewBOL()}));break;case p.fY.ViewAllShipment_SendBOL:this.props.handleSendBOL(t.ShipmentCode,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{s.messageType=e.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=e.IsSuccess,s.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,v.toast)((0,S.jsx)(u.A,{children:(0,S.jsx)(x.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4})}));break;case p.fY.ViewAllShipment_BSIOutbound:this.props.handleBSIOutbound(t.ShipmentCode,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{s.messageType=e.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=e.IsSuccess,s.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,v.toast)((0,S.jsx)(u.A,{children:(0,S.jsx)(x.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4})}));break;case p.fY.ViewShipment_ViewAuditTrail:let a=this.props.ShipmentType.toLowerCase()===c.yu?p.Pm.PRODUCT:p.Pm.COMPARTMENT;this.props.handleViewAuditTrail(this.props.selectedShareholder,t.ShipmentCode,a,this.props.tokenDetails.tokenInfo,(e=>{if(!0===e.IsSuccess){let t=e.EntityResult,s=f().cloneDeep(this.state.attributeMetaDataList.SHIPMENTSTATUSTIME);for(let e=0;e<t.length;e++)t[e].UpdatedTime=new Date(t[e].UpdatedTime).toLocaleDateString()+" "+new Date(t[e].UpdatedTime).toLocaleTimeString();let i=e.EntityResult;for(let e=0;e<i.length;e++)i[e].AttributesforUI=this.formReadonlyCompAttributes(i[e].Attributes,s);this.setState({isViewAuditTrail:!0,auditTrailList:i,modAuditTrailList:t})}else s.messageType=e.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=e.IsSuccess,s.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,v.toast)((0,S.jsx)(u.A,{children:(0,S.jsx)(x.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4})}));break;case p.fY.ViewShipment_ViewLoadingDetails:this.props.handleViewLoadingDetails(t.ShipmentCode,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{if(!0===e.IsSuccess){let t=e.EntityResult,s=[];if(null!==t&&null!==t.Table&&t.Table.length>0){let e=0;t.Table.forEach((t=>{t.seqNo=e,t.endtime=new Date(t.endtime).toLocaleDateString()+" "+new Date(t.endtime).toLocaleTimeString(),t.starttime=new Date(t.starttime).toLocaleDateString()+" "+new Date(t.starttime).toLocaleTimeString(),e++,t.productcode=t.productcode.split("&nbsp;").join(" ")}))}null!==t&&null!==t.Table1&&t.Table1.length>0&&(s=t.Table1[0].NonConfiguredColumns.split(",")),this.setState({modViewLoadingDetails:t,isViewLoadingDetails:!0,nonConfigColumns:s})}else s.messageType=e.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=e.IsSuccess,s.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,v.toast)((0,S.jsx)(u.A,{children:(0,S.jsx)(x.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4})}));break;case p.fY.ViewAllShipment_SealCompartments:this.props.handleSealCompartments(t.ShipmentCode,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{s.messageType=e.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=e.IsSuccess,!0===e.IsSuccess?this.setState({isSealCompartments:!0,sealCompartments:e.EntityResult}):(s.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,v.toast)((0,S.jsx)(u.A,{children:(0,S.jsx)(x.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4}))}));break;case"ViewAllocateBay_AllocateBay":this.getBays();break;case"ViewAllocateBay_DeallocateBay":this.setState({isDeAllocateBay:!0});break;default:return}},this.getBays=()=>{let e=f().cloneDeep(this.state.shipment),t=[];e.ShipmentCompartments.forEach((e=>{t.push(e.FinishedProductCode)}));const s={ShareHolderCode:this.props.selectedShareholder,KeyCodes:[{key:"TransactionType",value:"SHIPMENT"},{key:"TransportationType",value:"ROAD"},{key:"TerminalCode",value:this.state.shipment.ActualTerminalCode},{key:"FinishedProductCode",value:t.toString()}]};N()(V.Fkg,C.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){let e=t.EntityResult;e.forEach((e=>{e.SupportedProducts.forEach((t=>{""===e.AssociatedProduct||void 0===e.AssociatedProduct?e.AssociatedProduct=t.Code:e.AssociatedProduct+=","+t.Code}))})),this.setState({bayData:e,isAllocateBay:!0})}else this.setState({bayData:[],isAllocateBay:!0}),console.log("Error in getBays:",t.ErrorList)})).catch((e=>{this.setState({bayData:[],isReadyToRender:!0}),console.log("Error while getBays:",e)}))},this.handleAttributeDataEdit=(e,t)=>{try{e.DefaultValue=t,this.setState({attribute:e});const s=f().cloneDeep(this.state.attributeValidationErrors);s.forEach((s=>{s.TerminalCode===e.TerminalCode&&(s.attributeValidationErrors[e.Code]=C.I5(e,t))})),this.setState({attributeValidationErrors:s})}catch(s){console.log("TruckShipmentDetailsComposite:Error occured on handleAttributeDataEdit",s)}},this.handleCompAttributeCellDataEdit=(e,t)=>{let s=f().cloneDeep(this.state.modCompartmentPlans),i=s.findIndex((t=>t.SeqNumber===e.rowData.compSequenceNo));i>=0&&(s[i].AttributesforUI[e.rowData.SeqNumber-1].AttributeValue=t),this.setState({modCompartmentPlans:s}),i>=0&&this.attributeToggleExpand(s[i],!0,!0)},this.handleProdPlanAttributeCellDataEdit=(e,t)=>{let s=f().cloneDeep(this.state.modProductPlans),i=s.findIndex((t=>t.SeqNumber===e.rowData.compSequenceNo));i>=0&&(s[i].AttributesforUI[e.rowData.SeqNumber-1].AttributeValue=t),this.setState({modProductPlans:s}),i>=0&&this.attributeToggleExpand(s[i],!0,!0)},this.handleTabChange=e=>{try{this.setState({activeTab:e,expandedRows:[]}),this.state.isPlanned&&(this.props.ShipmentType.toLowerCase()===c.yu&&2===e&&"FALSE"===this.state.modCustomValues.DisableLoadingDetails||this.props.ShipmentType.toLowerCase()===c.de&&1===e&&"FALSE"===this.state.modCustomValues.DisableLoadingDetails?this.setState({saveEnabled:C.ab(this.props.userDetails.EntityResult.FunctionsList,c.i.modify,this.props.ShipmentType.toLowerCase())}):this.setState({saveEnabled:"TRUE"===this.state.modCustomValues.ShipmentUpdateAllow&&C.ab(this.props.userDetails.EntityResult.FunctionsList,c.i.modify,this.props.ShipmentType.toLowerCase())}))}catch(t){console.log("TruckShipmentDetailsComposite: Error occurred on handleTabChange",t)}},this.handleCellCheck=(e,t)=>{let s=f().cloneDeep(this.state.modLoadingDetails),i=f().cloneDeep(this.state.isLoadingDetailsChanged);const a=s.findIndex((t=>t.SeqNo===e.rowData.SeqNo));a>-1&&(s[a].Force_Complete=t,i=!0),this.setState({modLoadingDetails:s,isLoadingDetailsChanged:i})},this.handleLoadingDetailsChange=(e,t)=>{let s=f().cloneDeep(this.state.modLoadingDetails);const i=s.findIndex((e=>e.SeqNo===t.rowData.SeqNo));if(i>-1){s[i][t.field]=e,this.setState({modLoadingDetails:s,isLoadingDetailsChanged:!0});let a=f().cloneDeep(this.state.expandedRows),o=a.findIndex((e=>e.SeqNo===t.SeqNo));o>=0&&(a.splice(o,1),this.setState({expandedRows:a})),this.toggleExpand(s[i],!1)}},this.UpdateShipmentBondNo=()=>{try{var e=[{key:w.yz,value:this.state.modShipment.ShipmentCode},{key:w.x4,value:this.state.modShipment.ShipmentBondNo}],t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.yz,KeyCodes:e};let s={messageType:"critical",message:"ShipmentBondUpdate_Status",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[this.state.modShipment.ShipmentCode],isSuccess:!1,errorMessage:""}]};N()(V.v6m,C.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;s.messageType=t.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getShipment({Common_Code:this.state.modShipment.ShipmentCode}):(s.messageResultDetails[0].errorMessage=t.ErrorList[0],console.log("Error in UpdateShipment:",t.ErrorList)),(0,v.toast)((0,S.jsx)(u.A,{children:(0,S.jsx)(x.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4})})).catch((e=>{console.log("Error while OverrideShipmentSequence:",e)}))}catch(s){console.log("Error while Updating ShipmentSequence:",s)}},this.UpdateShipmentDriver=()=>{try{var e=[{key:w.yz,value:this.state.modShipment.ShipmentCode},{key:w.qF,value:this.state.modShipment.DriverCode}],t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.yz,KeyCodes:e};let s={messageType:"critical",message:"DriverCode_UpdateStatus",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[this.state.modShipment.ShipmentCode],isSuccess:!1,errorMessage:""}]};N()(V.kzF,C.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;s.messageType=t.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getShipment({Common_Code:this.state.modShipment.ShipmentCode}):(s.messageResultDetails[0].errorMessage=t.ErrorList[0],console.log("Error Shipment Driver Update:",t.ErrorList)),(0,v.toast)((0,S.jsx)(u.A,{children:(0,S.jsx)(x.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4})})).catch((e=>{console.log("Error while Shipment Driver Update:",e)}))}catch(s){console.log("Error while Shipment Driver Update:",s)}},this.handleOverrideShipmentSequence=()=>{try{var e=[{key:w.yz,value:this.state.modShipment.ShipmentCode},{key:w.Vk,value:!this.state.modShipment.IsPriority}],t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.yz,KeyCodes:e};let s={messageType:"critical",message:"PrioritySet_Status",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[this.state.modShipment.ShipmentCode],isSuccess:!1,errorMessage:""}]};N()(V.oiL,C.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;s.messageType=t.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getShipment({Common_Code:this.state.modShipment.ShipmentCode}):(s.messageResultDetails[0].errorMessage=t.ErrorList[0],console.log("Error in UpdateShipment:",t.ErrorList)),(0,v.toast)((0,S.jsx)(u.A,{children:(0,S.jsx)(x.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4})})).catch((e=>{console.log("Error while OverrideShipmentSequence:",e)}))}catch(s){console.log("Error while Updating ShipmentSequence:",s)}},this.handleUpdateShipmentTransloading=()=>{try{let s=this.getShipmentDestinationCompartmentsFromModCompartmentPlans(this.state.modCompartmentPlans);var e=[{key:w.FR,value:this.props.selectedShareholder},{key:w.yz,value:this.state.modShipment.ShipmentCode}],t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.yz,KeyCodes:e,Entity:s};let i={messageType:"critical",message:"UpdateTruckTransloading_Status",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[this.state.modShipment.ShipmentCode],isSuccess:!1,errorMessage:""}]};N()(V.eai,C.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;i.messageType=t.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getShipment({Common_Code:this.state.modShipment.ShipmentCode}):(i.messageResultDetails[0].errorMessage=t.ErrorList[0],console.log("Error in UpdateShipment:",t.ErrorList)),(0,v.toast)((0,S.jsx)(u.A,{children:(0,S.jsx)(x.A,{notificationMessage:i})}),{autoClose:"success"===i.messageType&&1e4})})).catch((e=>{console.log("Error while handleUpdateShipmentTransloading:",e)}))}catch(s){console.log("Error while Updating ShipmentTransloading:",s)}},this.handleReset=()=>{try{let t=f().cloneDeep(this.state.vehicleDetails);var e=f().cloneDeep(this.state.shipment);this.props.ShipmentType&&this.props.ShipmentType.toLowerCase()===c.de&&""===e.ShipmentCode&&(e.ShipmentCode=f().cloneDeep(this.state.autoGeneratedCode));let s=[],i=[],a=[];""===this.state.shipment.ShipmentCode?(s=[],i=[],a=[]):(s=this.getShipmentCompartmentFromShipment(this.state.shipment),this.props.ShipmentType.toLowerCase()===c.yu&&(i=this.getShipmentDetailsFromShipment(this.state.shipment)),t.vehicleCompartments.forEach((e=>a.push({text:e.vehCompSeq.toString(),value:e.vehCompSeq.toString()})))),this.setState({modShipment:e,validationErrors:[],modVehicleDetails:f().cloneDeep(this.state.vehicleDetails),selectedAttributeList:[],modCompartmentPlans:s,modProductPlans:i,compSeqOptions:a,isValidationPassed:!0,isEnforcingEnabled:!1},(()=>{this.props.userDetails.EntityResult.IsEnterpriseNode?(this.terminalSelectionChange(e.TerminalCodes),this.handleResetAttributeValidationError()):(this.localNodeAttribute(),this.handleResetAttributeValidationError())}))}catch(t){console.log(this.props.ShipmentType+":Error occured on handleReset",t)}},this.handleAllTerminalsChange=e=>{try{var t=[...this.props.terminalCodes],s=f().cloneDeep(this.state.modShipment);s.TerminalCodes=e?[...t]:[],this.setState({modShipment:s},(()=>this.terminalSelectionChange(s.TerminalCodes)))}catch(i){console.log(this.props.ShipmentType+":Error occured on handleAllTerminasChange",i)}},this.handleAddCompartmentPlan=()=>{let e=f().cloneDeep(this.state.modShipment),t="TRUE"===this.state.modCustomValues.ShipmentUpdateAllow&&C.ab(this.props.userDetails.EntityResult.FunctionsList,c.i.modify,this.props.ShipmentType.toLowerCase());if(!this.props.userDetails.EntityResult.IsArchived&&(""===this.state.shipment.ShipmentCode||!0===t))try{if(this.state.modCompartmentPlans.length<this.state.modVehicleDetails.vehicleCompartments.length){let t=f().cloneDeep(this.state.modCompartmentPlans),s={Attributes:[],ShipmentCode:"",CompartmentCode:null,CompartmentSeqNoInVehicle:null,TrailerCode:null,CompartmentSeqNoInTrailer:null,Quantity:null,UOM:null,OrderCode:null,ContractCode:null,CustomerCode:null,DestinationCode:null,FinishedProductCode:null,ShareholderCode:this.props.selectedShareholder};s.SeqNumber=C.Mz(t),t.push(s),this.setState({modCompartmentPlans:t,selectedCompartmentPlans:[]},(()=>{if(!1===this.props.userDetails.EntityResult.IsEnterpriseNode){var t=f().cloneDeep(this.state.attributeMetaDataList.SHIPMENTDESTINATIONCOMPARTMENT);t.length>0&&this.formCompartmentPlanAttributes([t[0].TerminalCode])}else this.formCompartmentPlanAttributes(e.TerminalCodes)}))}}catch(s){console.log(this.props.ShipmentType+":Error occured on handleAddCompartmentPlan",s)}},this.handleAddProductPlan=()=>{let e=f().clone(this.state.modShipment),t="TRUE"===this.state.modCustomValues.ShipmentUpdateAllow&&C.ab(this.props.userDetails.EntityResult.FunctionsList,c.i.modify,this.props.ShipmentType.toLowerCase());if(!this.props.userDetails.EntityResult.IsArchived&&(""===this.state.shipment.ShipmentCode||!0===t))try{let t=f().cloneDeep(this.state.modProductPlans),s={Attributes:[],Quantity:null,UOM:null,OrderCode:null,ContractCode:null,CustomerCode:null,DestinationCode:"",FinishedProductCode:"",ShareholderCode:this.props.selectedShareholder};s.SeqNumber=C.Mz(t),t.push(s),this.setState({modProductPlans:t,selectedProductPlans:[]},(()=>{if(!1===this.props.userDetails.EntityResult.IsEnterpriseNode){var t=f().cloneDeep(this.state.attributeMetaDataList.SHIPMENTDESTINATIONCOMPARTMENT);t.length>0&&this.formProductPlanAttributes([t[0].TerminalCode])}else this.formProductPlanAttributes(e.TerminalCodes)}))}catch(s){console.log(this.props.ShipmentType+":Error occured on handleAddProductPlan",s)}},this.handleDeleteCompartmentPlan=()=>{if(!this.props.userDetails.EntityResult.IsArchived)try{if(null!=this.state.selectedCompartmentPlans&&this.state.selectedCompartmentPlans.length>0&&this.state.modCompartmentPlans.length>0){let e=f().cloneDeep(this.state.modCompartmentPlans);this.state.selectedCompartmentPlans.forEach(((t,s)=>{e=e.filter(((e,s)=>e.SeqNumber!==t.SeqNumber))})),this.setState({modCompartmentPlans:e,selectedCompartmentPlans:[]})}}catch(e){console.log(this.props.ShipmentType+":Error occured on handleDeleteCompartmentPlan",e)}},this.handleDeleteProductPlan=()=>{if(!this.props.userDetails.EntityResult.IsArchived)try{if(null!=this.state.selectedProductPlans&&this.state.selectedProductPlans.length>0&&this.state.modProductPlans.length>0){let e=f().cloneDeep(this.state.modProductPlans);this.state.selectedProductPlans.forEach((t=>{e=e.filter((e=>e.SeqNumber!==t.SeqNumber))})),this.setState({modProductPlans:e,selectedProductPlans:[]})}}catch(e){console.log(this.props.ShipmentType+":Error occured on handleDeleteProductPlan",e)}},this.handleCompartmentPlansSelectionChange=e=>{this.setState({selectedCompartmentPlans:e})},this.handleProductPlansSelectionChange=e=>{this.setState({selectedProductPlans:e})},this.handleDateTextChange=(e,t,s)=>{try{var i={...this.state.validationErrors},a=f().cloneDeep(this.state.modShipment);i[e]=s,a[e]=t,this.setState({validationErrors:i,modShipment:a})}catch(s){console.log(this.props.ShipmentType+":Error occured on handleDateTextChange",s)}},this.handleActiveStatusChange=e=>{try{let t=f().cloneDeep(this.state.modShipment);t.Active=e,t.Active!==this.state.shipment.Active&&(t.Remarks=""),this.setState({modShipment:t})}catch(t){console.log(t)}},this.onBack=()=>{this.setState({isManualEntry:!1,isViewAuditTrail:!1,isViewTrailerDetails:!1,isViewLoadingDetails:!1,isPlanned:!0,saveEnabled:!1,expandedRows:[],loadingExpandedRows:[],drawerStatus:!1}),this.getShipment({Common_Code:this.state.modShipment.ShipmentCode})},this.handleDrawer=()=>{var e=f().cloneDeep(this.state.drawerStatus);this.setState({drawerStatus:!e})},this.handleSealClose=()=>{this.setState({isSealCompartments:!1,sealCompartments:[]})},this.handleAuthenticationClose=()=>{this.setState({showShipmentAuthenticationLayout:!1,showAuthorizeToLoadAuthenticationLayout:!1,showAllowToLoadAuthenticationLayout:!1,showCloseShipmentAuthenticationLayout:!1,showViewBOLAuthenticationLayout:!1,showPrintBOLAuthenticationLayout:!1,showFANAuthenticationLayout:!1})},this.viewBOL=()=>{this.props.handleViewBOL(),this.handleAuthenticationClose()}}getShipmentStatusOperations(e){try{let t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:0,KeyCodes:null,Entity:e};N()(V.DOP,C.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;let s=[];Object.keys(t.EntityResult).forEach((e=>{t.EntityResult[e]&&s.push(e)})),s.push("ViewAllShipment_Trailer_Details"),this.setState({shipmentNextOperations:s})})).catch((e=>{console.log("Error while getting getShipmentStatusOperations:",e)}))}catch(t){console.log(t)}}getShipmentStatuses(e){try{let t=this.props.ShipmentType.toLowerCase()===c.yu?p.Pm.PRODUCT:p.Pm.COMPARTMENT;N()(V.BpG+"?shCode="+this.props.selectedShareholder+"&shipmentCode="+e.ShipmentCode+"&shipmentType="+t,C.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;this.setState({currentShipmentStatuses:t.EntityResult})})).catch((e=>{console.log("Error while getting getShipmentStatuses:",e)}))}catch(t){console.log(t)}}terminalSelectionChange(e){try{let a=[];var t=[],s=[];t=f().cloneDeep(this.state.attributeMetaDataList.SHIPMENT),s=f().cloneDeep(this.state.selectedAttributeList);const o=f().cloneDeep(this.state.attributeValidationErrors);var i=f().cloneDeep(this.state.modShipment);e.forEach((e=>{var o=s.find((t=>t.TerminalCode===e));void 0===o?t.forEach((function(t){if(t.TerminalCode===e){var s=i.Attributes.find((t=>t.TerminalCode===e));void 0!==s&&t.attributeMetaDataList.forEach((function(e){var t=s.ListOfAttributeData.find((t=>t.AttributeCode===e.Code));void 0!==t&&(e.DefaultValue=t.AttributeValue)})),a.push(t)}})):a.push(o)})),s=[],s=a,o.forEach((t=>{void 0===e.find((e=>t.TerminalCode===e))&&Object.keys(t.attributeValidationErrors).forEach((e=>t.attributeValidationErrors[e]=""))})),this.formCompartmentPlanAttributes(e),this.props.ShipmentType.toLowerCase()===c.yu&&this.formProductPlanAttributes(e),this.setState({selectedAttributeList:s,attributeValidationErrors:o})}catch(a){console.log("TrailerDetailsComposite:Error occured on terminalSelectionChange",a)}}localNodeAttribute(){try{var e=f().cloneDeep(this.state.attributeMetaDataList.SHIPMENT);if(Array.isArray(e)&&e.length>0)this.terminalSelectionChange([e[0].TerminalCode]);else{var t=f().cloneDeep(this.state.attributeMetaDataList.SHIPMENTDESTINATIONCOMPARTMENT),s=f().cloneDeep(this.state.attributeMetaDataList.SHIPMENTDETAILS);Array.isArray(t)&&t.length>0&&this.formCompartmentPlanAttributes([t[0].TerminalCode]),Array.isArray(s)&&s.length>0&&this.formCompartmentPlanAttributes([s[0].TerminalCode])}}catch(i){console.log("TrailerDetailsComposite:Error occured on localNodeAttribute",i)}}formProductPlanAttributes(e){try{let t=f().cloneDeep(this.state.attributeMetaDataList);t=t.SHIPMENTDETAILS.filter((function(t){return e.some((function(e){return t.TerminalCode===e}))}));let s=f().cloneDeep(this.state.modProductPlans);s.forEach((s=>{let i=[];t.forEach((e=>{e.attributeMetaDataList.forEach((e=>{i.push({AttributeCode:e.Code,AttributeName:e.DisplayName,AttributeValue:e.DefaultValue,TerminalCode:e.TerminalCode,IsMandatory:e.IsMandatory,DataType:e.DataType,IsReadonly:e.IsReadonly,MinValue:e.MinValue,MaxValue:e.MaxValue,ValidationFormat:e.ValidationFormat,compSequenceNo:"",AttributeType:p.Pm.PRODUCT})}))}));let a=f().cloneDeep(i);if(null!==s.FinishedProductCode&&void 0!==s.FinishedProductCode&&""!==s.FinishedProductCode||null!==s.AttributesforUI&&void 0!==s.AttributesforUI){null!==s.AttributesforUI&&void 0!==s.AttributesforUI?(s.AttributesforUI=s.AttributesforUI.filter((function(t){return e.some((function(e){return t.TerminalCode===e}))})),i=i.filter((function(e){return!s.AttributesforUI.some((function(t){return e.TerminalCode===t.TerminalCode}))}))):s.AttributesforUI=[];let t=f().cloneDeep(i);if(Array.isArray(s.Attributes)&&null!==s.Attributes&&void 0!==s.Attributes&&s.Attributes.length>0){s.Attributes.filter((function(t){return e.some((function(e){return t.TerminalCode===e}))})).forEach((e=>{e.ListOfAttributeData.forEach((s=>{let i=t.findIndex((t=>t.TerminalCode===e.TerminalCode&&t.AttributeCode===s.AttributeCode));i>=0&&(t[i].AttributeValue=s.AttributeValue)}))})),t.forEach((e=>{e.compSequenceNo=s.SeqNumber,s.AttributesforUI.push(e)}))}else{f().cloneDeep(i).forEach((e=>{e.compSequenceNo=s.SeqNumber,s.AttributesforUI.push(e)}))}}else s.AttributesforUI=[],a.forEach((e=>{e.compSequenceNo=s.SeqNumber,s.AttributesforUI.push(e)}));this.attributeToggleExpand(s,!0,!0),void 0!==s.AttributesforUI&&null!=s.AttributesforUI&&(s.AttributesforUI=C.vt(s.AttributesforUI)),s.AttributesforUI=C.Q3(s.AttributesforUI)})),this.setState({modProductPlans:s})}catch(t){console.log("TruckShipmentDetailsComposite:Error in forming Product Plan Attributes",t)}}formCompartmentPlanAttributes(e){try{let t=f().cloneDeep(this.state.attributeMetaDataList);t=t.SHIPMENTDESTINATIONCOMPARTMENT.filter((function(t){return e.some((function(e){return t.TerminalCode===e}))}));let s=f().cloneDeep(this.state.modCompartmentPlans);s.forEach((s=>{let i=[];t.forEach((e=>{e.attributeMetaDataList.forEach((e=>{i.push({AttributeCode:e.Code,AttributeName:e.DisplayName,AttributeValue:e.DefaultValue,TerminalCode:e.TerminalCode,IsMandatory:e.IsMandatory,DataType:e.DataType,IsReadonly:e.IsReadonly,MinValue:e.MinValue,MaxValue:e.MaxValue,ValidationFormat:e.ValidationFormat,compSequenceNo:"",AttributeType:p.Pm.COMPARTMENT})}))}));let a=f().cloneDeep(i);if(null!==s.FinishedProductCode&&void 0!==s.FinishedProductCode&&""!==s.FinishedProductCode||null!==s.AttributesforUI&&void 0!==s.AttributesforUI){null!==s.AttributesforUI&&void 0!==s.AttributesforUI?(s.AttributesforUI=s.AttributesforUI.filter((function(t){return e.some((function(e){return t.TerminalCode===e}))})),i=i.filter((function(e){return!s.AttributesforUI.some((function(t){return e.TerminalCode===t.TerminalCode}))}))):s.AttributesforUI=[];let t=f().cloneDeep(i);if(Array.isArray(s.Attributes)&&null!==s.Attributes&&void 0!==s.Attributes&&s.Attributes.length>0){s.Attributes.filter((function(t){return e.some((function(e){return t.TerminalCode===e}))})).forEach((e=>{e.ListOfAttributeData.forEach((s=>{let i=t.findIndex((t=>t.TerminalCode===e.TerminalCode&&t.AttributeCode===s.AttributeCode));i>=0&&(t[i].AttributeValue=s.AttributeValue)}))})),t.forEach((e=>{e.compSequenceNo=s.SeqNumber,s.AttributesforUI.push(e)}))}else{f().cloneDeep(i).forEach((e=>{e.compSequenceNo=s.SeqNumber,s.AttributesforUI.push(e)}))}}else s.AttributesforUI=[],a.forEach((e=>{e.compSequenceNo=s.SeqNumber,s.AttributesforUI.push(e)}));this.attributeToggleExpand(s,!0,!0),void 0!==s.AttributesforUI&&null!=s.AttributesforUI&&(s.AttributesforUI=C.vt(s.AttributesforUI)),s.AttributesforUI=C.Q3(s.AttributesforUI)})),this.setState({modCompartmentPlans:s})}catch(t){console.log("TruckShipmentDetailsComposite:Error in forming Compartment Plan Attributes",t)}}fillAttributeDetails(e,t){try{t=C.SC(t),e.Attributes=[],t.forEach((t=>{let s={ListOfAttributeData:[]};s.TerminalCode=t.TerminalCode,t.attributeMetaDataList.forEach((e=>{s.ListOfAttributeData.push({AttributeCode:e.Code,AttributeValue:e.DefaultValue})})),e.Attributes.push(s)})),e.ShipmentDestinationCompartmentsInfo.forEach((t=>{void 0!==t.AttributesforUI&&null!=t.AttributesforUI&&(t.AttributesforUI=C.mr(t.AttributesforUI));let s=[];if(this.props.userDetails.EntityResult.IsEnterpriseNode)s=f().cloneDeep(e.TerminalCodes);else{var i=f().cloneDeep(this.state.attributeMetaDataList.SHIPMENTDESTINATIONCOMPARTMENT);i.length>0&&(s=[i[0].TerminalCode])}let a=[];t.Attributes=[],null!==s&&void 0!==s&&s.forEach((e=>{null!==t.AttributesforUI&&void 0!==t.AttributesforUI&&(a=t.AttributesforUI.filter((function(t){return t.TerminalCode===e})));let s={ListOfAttributeData:[]};s.TerminalCode=e,a.forEach((e=>{""===e.AttributeValue&&!0!==e.IsMandatory||s.ListOfAttributeData.push({AttributeCode:e.AttributeCode,AttributeValue:e.AttributeValue})})),null!==s.ListOfAttributeData&&void 0!==s.ListOfAttributeData&&s.ListOfAttributeData.length>0&&t.Attributes.push(s)}))})),this.props.ShipmentType.toLowerCase()===c.yu&&e.ShipmentDetailsInfo.forEach((t=>{void 0!==t.AttributesforUI&&null!=t.AttributesforUI&&(t.AttributesforUI=C.mr(t.AttributesforUI));let s=[];if(this.props.userDetails.EntityResult.IsEnterpriseNode)s=f().cloneDeep(e.TerminalCodes);else{var i=f().cloneDeep(this.state.attributeMetaDataList.SHIPMENTDETAILS);i.length>0&&(s=[i[0].TerminalCode])}let a=[];t.Attributes=[],null!==s&&void 0!==s&&s.forEach((e=>{null!==t.AttributesforUI&&void 0!==t.AttributesforUI&&(a=t.AttributesforUI.filter((function(t){return t.TerminalCode===e})));let s={ListOfAttributeData:[]};s.TerminalCode=e,a.forEach((e=>{""===e.AttributeValue&&!0!==e.IsMandatory||s.ListOfAttributeData.push({AttributeCode:e.AttributeCode,AttributeValue:e.AttributeValue})})),null!==s.ListOfAttributeData&&void 0!==s.ListOfAttributeData&&s.ListOfAttributeData.length>0&&t.Attributes.push(s)}))}))}catch(s){console.log("TruckShipmentDetailsComposite:Error occured on fillAttributeDetails",s)}return this.setState({modShipment:e}),e}componentWillReceiveProps(e){try{this.GetViewAllShipmentCustomData(),""!==(this.props.ShipmentType.toLowerCase()===c.de?this.state.shipment.Code:this.state.shipment.ShipmentCode)&&void 0===e.selectedRow.Common_Code&&this.props.tokenDetails.tokenInfo===e.tokenDetails.tokenInfo&&(this.setState({isPlanned:!1,isManualEntry:!1,activeTab:0}),this.getShipment(e.selectedRow,e.ShipmentType,0))}catch(t){console.log(this.props.ShipmentType+":Error occured on componentWillReceiveProps",t)}}getShipmentDestinationCompartmentsFromModCompartmentPlans(e){let t=[];return Array.isArray(e)&&e.forEach((e=>{(null!==e.OrderCode&&""!==e.OrderCode||null!==e.ContractCode&&""!==e.ContractCode||null!==e.FinishedProductCode&&""!==e.FinishedProductCode||null!==e.CustomerCode&&""!==e.CustomerCode||null!==e.DestinationCode&&""!==e.DestinationCode)&&(this.props.ShipmentType.toLowerCase()===c.de||this.props.ShipmentType.toLowerCase()===c.yu&&""!==this.state.shipment.ShipmentCode)&&(void 0!==e.AttributesforUI&&null!=e.AttributesforUI&&(e.AttributesforUI=C.BZ(e.AttributesforUI)),t.push({AssociatedOrderItems:null===e.OrderCode?null:[{FinishedProductCode:e.FinishedProductCode,OrderCode:e.OrderCode,OrderItemQuantity:null!==e.Quantity&&""!==e.Quantity?e.Quantity.toLocaleString():null,QuantityUOM:this.state.modShipment.ShipmentQuantityUOM}],AssociatedContractItems:null===e.ContractCode?null:[{FinishedProductCode:e.FinishedProductCode,ContractCode:e.ContractCode,ContractItemQuantity:null!==e.Quantity&&""!==e.Quantity?e.Quantity.toLocaleString():null,QuantityUOM:this.state.modShipment.ShipmentQuantityUOM}],CompartmentCode:e.CompartmentCode,CompartmentSeqNoInVehicle:e.CompartmentSeqNoInVehicle,TrailerCode:e.TrailerCode,CompartmentSeqNoInTrailer:e.CompartmentSeqNoInTrailer,Quantity:null!==e.Quantity&&""!==e.Quantity?e.Quantity.toLocaleString():null,QuantityUOM:this.state.modShipment.ShipmentQuantityUOM,CustomerCode:e.CustomerCode,DestinationCode:e.DestinationCode,FinishedProductCode:e.FinishedProductCode,ShareholderCode:this.props.selectedShareholder,ShipmentCode:this.state.modShipment.ShipmentCode,TerminalCodes:this.state.modShipment.TerminalCodes,Attributes:[],AttributesforUI:e.AttributesforUI,TransReceiptCode:e.TransReceiptCode,TransCompSequenceNumber:e.TransCompSequenceNumber}))})),t}getShipmentDetailsFromModProductPlans(e){let t=[];return Array.isArray(e)&&e.forEach((e=>{if(null!==e.OrderCode&&""!==e.OrderCode||null!==e.ContractCode&&""!==e.ContractCode||null!==e.FinishedProductCode&&""!==e.FinishedProductCode||null!==e.Quantity&&""!==e.Quantity||null!==e.CustomerCode&&""!==e.CustomerCode||null!==e.DestinationCode&&""!==e.DestinationCode){void 0!==e.AttributesforUI&&null!=e.AttributesforUI&&(e.AttributesforUI=C.BZ(e.AttributesforUI));let s={AssociatedOrderItems:null===e.OrderCode?null:[{FinishedProductCode:e.FinishedProductCode,OrderCode:e.OrderCode,OrderItemQuantity:null!==e.Quantity&&""!==e.Quantity?e.Quantity.toLocaleString():null,QuantityUOM:this.state.modShipment.ShipmentQuantityUOM}],AssociatedContractItems:null===e.ContractCode?null:[{FinishedProductCode:e.FinishedProductCode,ContractCode:e.ContractCode,ContractItemQuantity:null!==e.Quantity&&""!==e.Quantity?e.Quantity.toLocaleString():null,QuantityUOM:this.state.modShipment.ShipmentQuantityUOM}],Quantity:null!==e.Quantity&&""!==e.Quantity?e.Quantity.toLocaleString():null,QuantityUOM:this.state.modShipment.ShipmentQuantityUOM,CustomerCode:e.CustomerCode,DestinationCode:e.DestinationCode,FinishedProductCode:e.FinishedProductCode,ShareholderCode:this.props.selectedShareholder,ShipmentCode:this.state.modShipment.ShipmentCode,TerminalCodes:this.state.modShipment.TerminalCodes,Attributes:[],AttributesforUI:e.AttributesforUI},i=!1;t.forEach((t=>{if(t.FinishedProductCode===e.FinishedProductCode&&t.DestinationCode===e.DestinationCode&&t.CustomerCode===e.CustomerCode)if(null!==t.AssociatedOrderItems&&t.AssociatedOrderItems.length>0&&null!==e.OrderCode)for(let s=0;s<t.AssociatedOrderItems.length&&!1===i;s++){let a=t.AssociatedOrderItems[s];e.OrderCode!==a.OrderCode&&(i=!0,t.AssociatedOrderItems.push({FinishedProductCode:e.FinishedProductCode,OrderCode:e.OrderCode,OrderItemQuantity:null!==e.Quantity&&""!==e.Quantity?e.Quantity.toLocaleString():null,QuantityUOM:this.state.modShipment.ShipmentQuantityUOM}),t.Quantity=null!==e.Quantity&&""!==e.Quantity&&null!==t.Quantity&&""!==t.Quantity?(C.bo(t.Quantity)+C.bo(e.Quantity)).toLocaleString():null===e.Quantity||""===e.Quantity||null===t.Quantity&&""===t.Quantity?null===e.Quantity&&""===e.Quantity||null===t.Quantity||""===t.Quantity?null:t.Quantity.toLocaleString():e.Quantity.toLocaleString())}else if(null!==t.AssociatedContractItems&&t.AssociatedContractItems.length>0&&null!==e.ContractCode)for(let s=0;s<t.AssociatedContractItems.length&&!1===i;s++){let a=t.AssociatedContractItems[s];e.ContractCode!==a.ContractCode&&(i=!0,t.AssociatedContractItems.push({FinishedProductCode:e.FinishedProductCode,ContractCode:e.ContractCode,ContractItemQuantity:null!==e.Quantity&&""!==e.Quantity?e.Quantity.toLocaleString():null,QuantityUOM:this.state.modShipment.ShipmentQuantityUOM}),t.Quantity=null!==e.Quantity&&""!==e.Quantity&&null!==t.Quantity&&""!==t.Quantity?(C.bo(t.Quantity)+C.bo(e.Quantity)).toLocaleString():null===e.Quantity||""===e.Quantity||null===t.Quantity&&""===t.Quantity?null===e.Quantity&&""===e.Quantity||null===t.Quantity||""===t.Quantity?null:t.Quantity.toLocaleString():e.Quantity.toLocaleString())}})),!1===i&&t.push(s)}})),t}getMarineTransloadableReceipts(){N()(V.spG,C.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({marineReceiptCodes:C.Zj(t.EntityResult)}):console.log("Error in GetMarineTransloadableReceipts:",t.ErrorList)})).catch((e=>{console.log("Error while geting GetMarineTransloadableReceipts:",e)}))}getTarnsloadingDetails(){N()(V.xAA+"?LookUpTypeCode=Transloading",C.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;!0===t.IsSuccess?null!=t.EntityResult?this.setState({isMarineTransLoading:"TRUE"===t.EntityResult.MarineEnable.toUpperCase(),isRailTransloading:"TRUE"===t.EntityResult.RAILEnable.toUpperCase()}):this.setState({isMarineTransLoading:!1,isRailTransloading:!1}):(this.setState({isMarineTransLoading:!1,isRailTransloading:!1}),console.log("Error in getTarnsloadingDetails: ",t.ErrorList))})).catch((e=>{this.setState({productAllocationList:[],productShareholderAllocationList:[],ProdAllocEntity:""}),console.log("TruckShipmentDetailsComposite: Error occurred on getTarnsloadingDetails",e)}))}getLookUpData(e){N()(V.xAA+"?LookUpTypeCode=ProductAllocation",C.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{const s=t.data;if(!0===s.IsSuccess){let t=s.EntityResult.AllocationEntity;this.setState({ProdAllocEntity:t},(()=>this.getProductAllocationDetails(t,e)))}else this.setState({productAllocationList:[],productShareholderAllocationList:[],ProdAllocEntity:""}),console.log("Error in getLookUpData: ",s.ErrorList)})).catch((e=>{this.setState({productAllocationList:[],productShareholderAllocationList:[],ProdAllocEntity:""}),console.log("TruckShipmentDetailsComposite: Error occurred on getLookUpData",e)}))}IsBonded(){N()(V.xAA+"?LookUpTypeCode=Bonding",C.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){let e=t.EntityResult["EnableBondingNon-Bonding"];this.setState({isBonded:"TRUE"===e.toUpperCase()})}else this.setState({isBonded:!1}),console.log("Error in get IsBonded: ",t.ErrorList)})).catch((e=>{this.setState({isBonded:!1}),console.log("TruckShipmentDetailsComposite: Error occurred on get IsBonded",e)}))}getProductAllocationDetails(e,t){try{N()(V.g8i+"?shCode="+this.props.selectedShareholder+"&shipmentCode="+t+"&transportationType="+p.LY.ROAD,C.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{const s=t.data;if(s.IsSuccess){let t=s.EntityResult,i=[],a=[];e.toUpperCase().includes("SHAREHOLDER")&&(null!==t&&null!==t.Table1&&t.Table1.length>0?(a=t.Table1,a.forEach((e=>{e.startdate=new Date(e.startdate).toLocaleDateString(),e.enddate=new Date(e.enddate).toLocaleDateString(),e.allocatedqty=e.allocatedqty.toString()+" "+e.uom,e.blockedqty=e.blockedqty.toString()+" "+e.uom,e.loadedqty=e.loadedqty.toString()+" "+e.uom}))):null!==t&&null!==t.Table&&t.Table.length>0&&1===Object.keys(t).length&&(a=t.Table,a.forEach((e=>{e.startdate=new Date(e.startdate).toLocaleDateString(),e.enddate=new Date(e.enddate).toLocaleDateString(),e.allocatedqty=e.allocatedqty.toString()+" "+e.uom,e.blockedqty=e.blockedqty.toString()+" "+e.uom,e.loadedqty=e.loadedqty.toString()+" "+e.uom}))),this.setState({productShareholderAllocationList:a})),e.toUpperCase().includes("CUSTOMER")&&(null!==t&&null!==t.Table&&t.Table.length>0&&(i=t.Table,i.forEach((e=>{e.startdate=new Date(e.startdate).toLocaleDateString(),e.enddate=new Date(e.enddate).toLocaleDateString(),e.allocatedqty=e.allocatedqty.toString()+" "+e.uom,e.blockedqty=e.blockedqty.toString()+" "+e.uom,e.loadedqty=e.loadedqty.toString()+" "+e.uom}))),this.setState({productAllocationList:i}))}else this.setState({productAllocationList:[],productShareholderAllocationList:[],ProdAllocEntity:""})})).catch((e=>{this.setState({productAllocationList:[],productShareholderAllocationList:[],ProdAllocEntity:""}),console.log("Error while getting product Allocation Details:",e)}))}catch(s){this.setState({productAllocationList:[],productShareholderAllocationList:[],ProdAllocEntity:""}),console.log("Error in getting product Allocation details",s)}}saveShipment(){let e=f().cloneDeep(this.state.modShipment);e.ShipmentDestinationCompartmentsInfo=this.getShipmentDestinationCompartmentsFromModCompartmentPlans(this.state.modCompartmentPlans),this.props.ShipmentType.toLowerCase()===c.yu?e.ShipmentDetailsInfo=this.getShipmentDetailsFromModProductPlans(this.state.modProductPlans):e.ShipmentDetailsInfo=void 0;let t=C.pI(this.state.selectedAttributeList);if(this.setState({saveEnabled:!1}),this.validateSave(e,t)){this.setState({isValidationPassed:!0}),e=this.ConvertstringToDecimal(e,t);let s=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,i=f().cloneDeep(e);this.setState({showShipmentAuthenticationLayout:s,tempShipment:i},(()=>{!1===s&&this.handleSaveShipment()}))}else this.setState({saveEnabled:!0})}ConvertstringToDecimal(e,t){try{this.props.ShipmentType.toLowerCase()===c.de?e.ShipmentDestinationCompartmentsInfo.forEach((e=>{e.Quantity=C.bo(e.Quantity),Array.isArray(e.AssociatedOrderItems)&&e.AssociatedOrderItems.length>0&&(e.AssociatedOrderItems[0].OrderItemQuantity=C.bo(e.AssociatedOrderItems[0].OrderItemQuantity)),Array.isArray(e.AssociatedContractItems)&&e.AssociatedContractItems.length>0&&(e.AssociatedContractItems[0].ContractItemQuantity=C.bo(e.AssociatedContractItems[0].ContractItemQuantity))})):(null!==e.ShipmentDestinationCompartmentsInfo&&void 0!==e.ShipmentDestinationCompartmentsInfo&&e.ShipmentDestinationCompartmentsInfo.length>0&&e.ShipmentDestinationCompartmentsInfo.forEach((e=>{e.Quantity=C.bo(e.Quantity),Array.isArray(e.AssociatedOrderItems)&&e.AssociatedOrderItems.length>0&&(e.AssociatedOrderItems[0].OrderItemQuantity=C.bo(e.AssociatedOrderItems[0].OrderItemQuantity)),Array.isArray(e.AssociatedContractItems)&&e.AssociatedContractItems.length>0&&(e.AssociatedContractItems[0].ContractItemQuantity=C.bo(e.AssociatedContractItems[0].ContractItemQuantity))})),e.ShipmentDetailsInfo.forEach((e=>{e.Quantity=C.bo(e.Quantity),Array.isArray(e.AssociatedOrderItems)&&e.AssociatedOrderItems.length>0&&(e.AssociatedOrderItems[0].OrderItemQuantity=C.bo(e.AssociatedOrderItems[0].OrderItemQuantity)),Array.isArray(e.AssociatedContractItems)&&e.AssociatedContractItems.length>0&&(e.AssociatedContractItems[0].ContractItemQuantity=C.bo(e.AssociatedContractItems[0].ContractItemQuantity))}))),e=this.fillAttributeDetails(e,t)}catch(s){console.log("convertStringtoDecimal on truck shipment details",s)}return e}validateSave(e,t){const s={...this.state.validationErrors};Object.keys(y.Kh).forEach((function(t){void 0!==e[t]&&(s[t]=C.jr(y.Kh[t],e[t]))})),e.Active!==this.state.shipment.Active&&(null!==e.Remarks&&""!==e.Remarks||(s.Remarks="OriginTerminal_RemarksRequired"));let i={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[]};var a=f().cloneDeep(this.state.attributeValidationErrors);t.forEach((e=>{a.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.attributeMetaDataList.forEach((e=>{t.attributeValidationErrors[e.Code]=C.I5(e,e.DefaultValue)}))}))})),this.setState({validationErrors:s,attributeValidationErrors:a});let o=!0;if(o&&(o=Object.values(s).every((function(e){return""===e}))),a.forEach((e=>{if(!o)return o;o=Object.values(e.attributeValidationErrors).every((function(e){return""===e}))})),!o)return o;if(this.props.ShipmentType.toLowerCase()===c.de){if([...new Set(e.ShipmentDestinationCompartmentsInfo.map((e=>e.CompartmentSeqNoInVehicle)))].length!==e.ShipmentDestinationCompartmentsInfo.length)return i.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"Duplicate_Associated_Customers"}),this.props.onSaved(this.state.modShipment,"update",i),!1;Array.isArray(e.ShipmentDestinationCompartmentsInfo)&&e.ShipmentDestinationCompartmentsInfo.length>0?e.ShipmentDestinationCompartmentsInfo.forEach((t=>{if(e.CreatedFromEntity===p.U6.Order){let e="";if(Array.isArray(t.AssociatedOrderItems)&&t.AssociatedOrderItems.length>0){let s=t.AssociatedOrderItems[0];null!==s&&void 0!==s.OrderCode&&null!==s.OrderCode&&""!==s.OrderCode||(e="ORDER_EMPTY")}else e="ORDER_EMPTY";""!==e&&i.messageResultDetails.push({keyFields:["ShipmentCompDetail_CompSeqInVehicle"],keyValues:[t.CompartmentSeqNoInVehicle],isSuccess:!1,errorMessage:e})}else if(e.CreatedFromEntity===p.U6.Contract){let e="";if(Array.isArray(t.AssociatedContractItems)&&t.AssociatedContractItems.length>0){let s=t.AssociatedContractItems[0];null!==s&&void 0!==s.ContractCode&&null!==s.ContractCode&&""!==s.ContractCode||(e="Contract_Code_Empty")}else e="Contract_Code_Empty";""!==e&&i.messageResultDetails.push({keyFields:["ShipmentCompDetail_CompSeqInVehicle"],keyValues:[t.CompartmentSeqNoInVehicle],isSuccess:!1,errorMessage:e})}D.X3.forEach((e=>{let s="";void 0!==e.validator&&(s=C.jr(e.validator,t[e.field])),""!==s&&i.messageResultDetails.push({keyFields:["ShipmentCompDetail_CompSeqInVehicle",e.displayName],keyValues:[t.CompartmentSeqNoInVehicle,t[e.field]],isSuccess:!1,errorMessage:s})})),null!==t.AttributesforUI&&void 0!==t.AttributesforUI&&t.AttributesforUI.forEach((e=>{let s=C.I5(e,e.AttributeValue);""!==s&&(this.props.userDetails.EntityResult.IsEnterpriseNode?i.messageResultDetails.push({keyFields:["CompAttributeComp","CompAttributeTerminal",e.AttributeName],keyValues:[t.CompartmentSeqNoInVehicle,e.TerminalCode,e.AttributeValue],isSuccess:!1,errorMessage:s}):i.messageResultDetails.push({keyFields:["CompAttributeComp",e.AttributeName],keyValues:[t.CompartmentSeqNoInVehicle,e.AttributeValue],isSuccess:!1,errorMessage:s}))})),this.attributeToggleExpand(t,!0,!0)})):i.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"Shipment_Compartment_Association_Require"})}else if(Array.isArray(e.ShipmentDetailsInfo)&&e.ShipmentDetailsInfo.length>0){let t=1;e.ShipmentDetailsInfo.forEach((s=>{if(e.CreatedFromEntity===p.U6.Order){let e="";if(Array.isArray(s.AssociatedOrderItems)&&s.AssociatedOrderItems.length>0){let t=s.AssociatedOrderItems[0];null!==t&&void 0!==t.OrderCode&&null!==t.OrderCode&&""!==t.OrderCode||(e="ORDER_EMPTY")}else e="ORDER_EMPTY";""!==e&&(this.setState({isValidationPassed:!1}),i.messageResultDetails.push({keyFields:["CompAttributeComp"],keyValues:[t],isSuccess:!1,errorMessage:e}))}else if(e.CreatedFromEntity===p.U6.Contract){let e="";if(Array.isArray(s.AssociatedContractItems)&&s.AssociatedContractItems.length>0){let t=s.AssociatedContractItems[0];null!==t&&void 0!==t.ContractCode&&null!==t.ContractCode&&""!==t.ContractCode||(e="Contract_Code_Empty")}else e="Contract_Code_Empty";""!==e&&(this.setState({isValidationPassed:!1}),i.messageResultDetails.push({keyFields:["CompAttributeComp"],keyValues:[t],isSuccess:!1,errorMessage:e}))}D._A.forEach((e=>{let a="";void 0!==e.validator&&(a=C.jr(e.validator,s[e.field])),""!==a&&(this.setState({isValidationPassed:!1}),i.messageResultDetails.push({keyFields:["CompAttributeComp",e.displayName],keyValues:[t,s[e.field]],isSuccess:!1,errorMessage:a}))}));let a=[];null!==s.AttributesforUI&&void 0!==s.AttributesforUI&&(a=s.AttributesforUI.filter((function(e){return s.Attributes.some((function(t){let s=t.ListOfAttributeData.findIndex((t=>t.AttributeCode===e.AttributeCode))>=0;return e.TerminalCode===t.TerminalCode&&s}))}))),a.forEach((e=>{let t=C.I5(e,e.AttributeValue);""!==t&&(this.setState({isValidationPassed:!1}),this.props.userDetails.EntityResult.IsEnterpriseNode?i.messageResultDetails.push({keyFields:["CompAttributeComp","CompAttributeTerminal",e.AttributeName],keyValues:[e.compSequenceNo,e.TerminalCode,e.AttributeValue],isSuccess:!1,errorMessage:t}):i.messageResultDetails.push({keyFields:["CompAttributeComp",e.AttributeName],keyValues:[e.compSequenceNo,e.AttributeValue],isSuccess:!1,errorMessage:t}))})),this.attributeToggleExpand(s,!0,!0),t+=1}))}else this.setState({isValidationPassed:!1}),i.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"Shipment_Compartment_Association_Require"});return i.messageResultDetails.length>0?(this.props.onSaved(this.state.modShipment,"update",i),!1):o}updateShipment(e){e.ShipmentCompartments=null;let t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:0,KeyCodes:null,Entity:e},s={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[e.ShipmentCode],isSuccess:!1,errorMessage:""}]};N()(V.Wh1,C.tW(t,this.props.tokenDetails.tokenInfo)).then((t=>{let i=t.data;s.messageType=i.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess?(this.setState({saveEnabled:!0,showShipmentAuthenticationLayout:!1}),this.props.ShipmentType.toLowerCase()===c.yu&&2===this.state.activeTab&&this.state.isLoadingDetailsChanged&&"FALSE"===this.state.modCustomValues.DisableLoadingDetails||this.props.ShipmentType.toLowerCase()===c.de&&1===this.state.activeTab&&this.state.isLoadingDetailsChanged&&"FALSE"===this.state.modCustomValues.DisableLoadingDetails?this.handleTopUpDecantApproval("SaveCompartment"):this.getShipment({Common_Code:e.ShipmentCode,isValidationPassed:!0})):(s.messageResultDetails[0].errorMessage=i.ErrorList[0],this.setState({saveEnabled:!0,showShipmentAuthenticationLayout:!1}),console.log("Error in UpdateShipment:",i.ErrorList)),this.props.onSaved(e,"update",s)})).catch((t=>{this.setState({saveEnabled:!0,showShipmentAuthenticationLayout:!1}),s.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"modify",s)}))}createShipment(e){let t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:0,KeyCodes:null,Entity:e},s={messageType:"critical",message:"ShipmentCompDetail_SavedStatus",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[e.ShipmentCode],isSuccess:!1,errorMessage:""}]};N()(V.byF,C.tW(t,this.props.tokenDetails.tokenInfo)).then((t=>{let i=t.data;s.messageType=i.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess?(this.setState({showShipmentAuthenticationLayout:!1}),this.getShipment({Common_Code:e.ShipmentCode,isValidationPassed:!0})):(s.messageResultDetails[0].errorMessage=i.ErrorList[0],this.setState({saveEnabled:!0,showShipmentAuthenticationLayout:!1}),console.log("Error in CreateShipment:",i.ErrorList)),this.props.onSaved(e,"add",s)})).catch((t=>{this.setState({saveEnabled:!0,showShipmentAuthenticationLayout:!1}),s.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"add",s)}))}componentDidMount(){try{C.pJ(this.props.userDetails.EntityResult.IsArchived),this.props.userDetails.EntityResult.IsArchived&&this.setState({isDisableSubmitForApproval:!0}),this.GetViewAllShipmentCustomData(),this.IsBonded(),this.getAttributes(this.props.selectedRow),this.GetUOMList(),this.getVehicleCodes(this.props.selectedShareholder),this.getDriverCodes(this.props.selectedShareholder),this.getFinishedProductCodes(this.props.selectedShareholder),this.getcustomerDestinationList(this.props.selectedShareholder),this.getContractCodes(this.props.selectedShareholder),this.getOrderCodes(this.props.selectedShareholder),this.getTarnsloadingDetails()}catch(e){console.log(this.props.ShipmentType+":Error occured on componentDidMount",e)}}getAttributes(e){try{N()(V.fKH,C.tW([_.EY,_.U7,_.AU,_.go,_.wY,_.$7,_.ZN],this.props.tokenDetails.tokenInfo)).then((t=>{var s=t.data;!0===s.IsSuccess?this.setState({attributeMetaDataList:f().cloneDeep(s.EntityResult),attributeValidationErrors:C.Fl(s.EntityResult.SHIPMENT),compAttributeValidationErrors:C.Fl(s.EntityResult.SHIPMENTDESTINATIONCOMPARTMENT),prodCompAttributeValidationErrors:C.Fl(s.EntityResult.SHIPMENTDETAILS)},(()=>this.getShipment(e))):console.log("Failed to get Attributes")}))}catch(t){console.log("Error while getting Attributes:",t)}}GetVehicleTrCmptDetailsForShipment(e){let t=f().cloneDeep(this.state.modShipment),s=[{key:w.ok,value:e}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.ok,KeyCodes:s};N()(V.c5D,C.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{let s=e.data;if(s.IsSuccess&&s.EntityResult&&Array.isArray(s.EntityResult.Table)){let e=!!s.EntityResult.Table[0].EnforceSequencing;t.IsBonded=!!s.EntityResult.Table[0].IsBonded||this.state.shipment.IsBonded;let i=s.EntityResult.Table[0].BondExpiryDate;this.setState({isEnforcingEnabled:e,modShipment:t,bondExpiryDate:i,isVehicleBonded:!!s.EntityResult.Table[0].IsBonded})}})).catch((e=>{this.setState({isEnforcingEnabled:!1,modShipment:t,bondExpiryDate:null,isVehicleBonded:!1}),console.log("Error while getting VehicleTrailer Comp Details:",e)}))}getVehicle(e,t){let s=f().cloneDeep(this.state.modShipment),i=f().cloneDeep(this.state.modVehicleDetails);s.VehicleCode=e;let a=[{key:w.ok,value:e}],o={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.ok,KeyCodes:a};N()(V.jvS,C.tW(o,this.props.tokenDetails.tokenInfo)).then((a=>{let o=a.data;if(!0===o.IsSuccess){if(null!==o.EntityResult){s.CarrierCode=o.EntityResult.CarrierCompanyCode,i.carrierCode=o.EntityResult.CarrierCompanyCode,i.vehicleCompartments=this.getCompartmentDetailsFromVehicle(o.EntityResult);let a=[];if(i.vehicleCompartments.forEach((e=>a.push({text:e.vehCompSeq.toString(),value:e.vehCompSeq.toString()}))),t){let e=this.getShipmentCompartmentFromVehicleCompartment(i.vehicleCompartments);e=C.Q3(e),this.setState({modCompartmentPlans:e},(()=>{this.props.userDetails.EntityResult.IsEnterpriseNode?this.terminalSelectionChange(s.TerminalCodes):this.localNodeAttribute()}))}if(this.setState({isVehicleChanged:t,modShipment:s,modVehicleDetails:i,compSeqOptions:a,vehicleForRecordWeight:o.EntityResult},(()=>{this.state.isBonded&&this.GetVehicleTrCmptDetailsForShipment(e)})),this.state.shipment.VehicleCode===s.VehicleCode){let e=f().cloneDeep(i);this.setState({vehicleDetails:e})}}}else this.setState({modShipment:s}),console.log("Error in GetVehicle:",o.ErrorList)})).catch((e=>{this.setState({modShipment:s}),console.log("Error while getting Vehicle:",e)}))}getShipmentCompartmentFromShipment(e){let t=[];return Array.isArray(e.ShipmentDestinationCompartmentsInfo)&&e.ShipmentDestinationCompartmentsInfo.forEach((s=>t.push({ShipmentCode:e.ShipmentCode,CompartmentCode:s.CompartmentCode,CompartmentSeqNoInVehicle:s.CompartmentSeqNoInVehicle,TrailerCode:s.TrailerCode,CompartmentSeqNoInTrailer:s.trailerCompSeq,Quantity:null!==s.Quantity&&""!==s.Quantity?s.Quantity.toLocaleString():null,UOM:s.QuantityUOM,OrderCode:null!=s.AssociatedOrderItems?s.AssociatedOrderItems[0].OrderCode:null,ContractCode:null!=s.AssociatedContractItems?s.AssociatedContractItems[0].ContractCode:null,CustomerCode:s.CustomerCode,DestinationCode:s.DestinationCode,FinishedProductCode:s.FinishedProductCode,ShareholderCode:this.props.selectedShareholder,Attributes:s.Attributes,TransReceiptCode:s.TransReceiptCode,TransCompSequenceNumber:s.TransCompSequenceNumber}))),t=C.Q3(t),t.sort(((e,t)=>e.CompartmentSeqNoInVehicle>t.CompartmentSeqNoInVehicle?1:e.CompartmentSeqNoInVehicle<t.CompartmentSeqNoInVehicle?-1:0))}getShipmentDetailsFromShipment(e){let t=[];return Array.isArray(e.ShipmentDetailsInfo)&&e.ShipmentDetailsInfo.forEach((e=>{null!==e.AssociatedOrderItems&&e.AssociatedOrderItems.length>0?e.AssociatedOrderItems.forEach((s=>{t.push({Quantity:null!==s.OrderItemQuantity&&""!==s.OrderItemQuantity?s.OrderItemQuantity.toLocaleString():null,UOM:e.QuantityUOM,OrderCode:s.OrderCode,ContractCode:null,CustomerCode:e.CustomerCode,DestinationCode:e.DestinationCode,FinishedProductCode:e.FinishedProductCode,ShareholderCode:this.props.selectedShareholder,Attributes:e.Attributes})})):null!==e.AssociatedContractItems&&e.AssociatedContractItems.length>0?e.AssociatedContractItems.forEach((s=>{t.push({Quantity:null!==s.ContractItemQuantity&&""!==s.ContractItemQuantity?s.ContractItemQuantity.toLocaleString():null,UOM:e.QuantityUOM,OrderCode:null,ContractCode:s.ContractCode,CustomerCode:e.CustomerCode,DestinationCode:e.DestinationCode,FinishedProductCode:e.FinishedProductCode,ShareholderCode:this.props.selectedShareholder,Attributes:e.Attributes})})):t.push({Quantity:null!==e.Quantity&&""!==e.Quantity?e.Quantity.toLocaleString():null,UOM:e.QuantityUOM,OrderCode:null,ContractCode:null,CustomerCode:e.CustomerCode,DestinationCode:e.DestinationCode,FinishedProductCode:e.FinishedProductCode,ShareholderCode:this.props.selectedShareholder,Attributes:e.Attributes})})),t=C.Q3(t),t.sort(((e,t)=>e.CompartmentSeqNoInVehicle>t.CompartmentSeqNoInVehicle?1:e.CompartmentSeqNoInVehicle<t.CompartmentSeqNoInVehicle?-1:0))}getShipmentCompartmentFromVehicleCompartment(e){let t=[];if(void 0===this.props.shipmentSource||this.props.shipmentSourceFromSummary){if(void 0!==this.props.shipmentSource&&this.props.shipmentSourceFromSummary){let s=f().cloneDeep(this.state.otherSourceData);if(Array.isArray(s)){let i=0;s.forEach((s=>{let a=this.props.shipmentSource===p.U6.Contract?s.ContractItems:s.OrderItems,o=s.CustomerCode;for(let n=0;n<a.length;n++){let l={},r={},d=a[n];if(null!==d.RemainingQuantity&&d.RemainingQuantity>0){if(this.props.ShipmentType.toLowerCase()===c.de&&(r=e[i],void 0===r))break;l=this.props.ShipmentType.toLowerCase()===c.de?{ShipmentCode:"",CompartmentCode:r.compCode,CompartmentSeqNoInVehicle:r.vehCompSeq,TrailerCode:r.trailerCode,CompartmentSeqNoInTrailer:r.trailerCompSeq,Quantity:null!==d.RemainingQuantity&&""!==d.RemainingQuantity?d.RemainingQuantity.toLocaleString():null,QuantityUOM:d.QuantityUOM,OrderCode:this.props.shipmentSource===p.U6.Order?s.OrderCode:null,ContractCode:this.props.shipmentSource===p.U6.Contract?s.ContractCode:null,CustomerCode:o,DestinationCode:this.props.shipmentSource===p.U6.Contract?d.DestinationCode:null,FinishedProductCode:d.FinishedProductCode,ShareholderCode:this.props.selectedShareholder,TransCompSequenceNumber:null,TransReceiptCode:null}:{Quantity:null!==d.RemainingQuantity&&""!==d.RemainingQuantity?d.RemainingQuantity.toLocaleString():null,UOM:d.QuantityUOM,OrderCode:this.props.shipmentSource===p.U6.Order?s.OrderCode:null,ContractCode:this.props.shipmentSource===p.U6.Contract?s.ContractCode:null,CustomerCode:o,DestinationCode:this.props.shipmentSource===p.U6.Contract?d.DestinationCode:null,FinishedProductCode:d.FinishedProductCode,ShareholderCode:this.props.selectedShareholder},t.push(l),i++}}}))}this.props.ShipmentType.toLowerCase()===c.yu&&this.setState({modProductPlans:t})}else if(Array.isArray(e))for(let s=0;s<e.length;s++){let i=e[s],a={};a=this.props.ShipmentType.toLowerCase()===c.de?{ShipmentCode:"",CompartmentCode:i.compCode,CompartmentSeqNoInVehicle:i.vehCompSeq,TrailerCode:i.trailerCode,CompartmentSeqNoInTrailer:i.trailerCompSeq,Quantity:null!==i.SFL&&""!==i.SFL?i.SFL.toLocaleString():null,QuantityUOM:i.UOM,OrderCode:null,ContractCode:null,CustomerCode:null,DestinationCode:null,FinishedProductCode:null,ShareholderCode:this.props.selectedShareholder,TransCompSequenceNumber:null,TransReceiptCode:null}:{CompartmentCode:i.compCode,CompartmentSeqNoInVehicle:i.vehCompSeq,TrailerCode:i.trailerCode,Quantity:null!==i.SFL&&""!==i.SFL?i.SFL.toLocaleString():null,UOM:i.UOM,OrderCode:"",ContractCode:"",CustomerCode:"",DestinationCode:"",FinishedProductCode:"",ShareholderCode:this.props.selectedShareholder},t.push(a)}}else{let s=this.props.shipmentSourceDetails.CustomerCode;if(Array.isArray(this.props.shipmentSourceCompartmentItems))for(let i=0;i<this.props.shipmentSourceCompartmentItems.length;i++){let a={},o={},n=this.props.shipmentSourceCompartmentItems[i];if(null!==n.RemainingQuantity&&n.RemainingQuantity>0){if(this.props.ShipmentType.toLowerCase()===c.de&&(o=e[i],void 0===o))break;a=this.props.ShipmentType.toLowerCase()===c.de?{ShipmentCode:"",CompartmentCode:o.compCode,CompartmentSeqNoInVehicle:o.vehCompSeq,TrailerCode:o.trailerCode,CompartmentSeqNoInTrailer:o.trailerCompSeq,Quantity:null!==n.RemainingQuantity&&""!==n.RemainingQuantity?n.RemainingQuantity.toLocaleString():null,QuantityUOM:n.QuantityUOM,OrderCode:this.props.shipmentSource===p.U6.Order?this.props.shipmentSourceDetails.OrderCode:null,ContractCode:this.props.shipmentSource===p.U6.Contract?this.props.shipmentSourceDetails.ContractCode:null,CustomerCode:s,DestinationCode:this.props.shipmentSource===p.U6.Contract?n.DestinationCode:"",FinishedProductCode:n.FinishedProductCode,ShareholderCode:this.props.selectedShareholder,TransCompSequenceNumber:null,TransReceiptCode:null}:{Quantity:null!==n.RemainingQuantity&&""!==n.RemainingQuantity?n.RemainingQuantity.toLocaleString():null,UOM:n.QuantityUOM,OrderCode:this.props.shipmentSource===p.U6.Order?this.props.shipmentSourceDetails.OrderCode:null,ContractCode:this.props.shipmentSource===p.U6.Contract?this.props.shipmentSourceDetails.ContractCode:null,CustomerCode:s,DestinationCode:this.props.shipmentSource===p.U6.Contract?n.DestinationCode:"",FinishedProductCode:n.FinishedProductCode,ShareholderCode:this.props.selectedShareholder},t.push(a)}}}return t}getCompartmentDetailsFromVehicle(e){let t=[],s=1;return e.VehicleTrailers.sort(((e,t)=>e.TrailerSeq-t.TrailerSeq)),e.VehicleTrailers.forEach((e=>{if(Array.isArray(e.Trailer.Compartments)){e.Trailer.Compartments.sort(((e,t)=>e.CompartmentSeqNoInTrailer-t.CompartmentSeqNoInTrailer));for(let i=0;i<e.Trailer.Compartments.length;i++){let a=e.Trailer.Compartments[i],o={compCode:a.Code,vehCompSeq:s,trailerCode:a.TrailerCode,trailerCompSeq:a.CompartmentSeqNoInTrailer,SFL:a.Capacity,UOM:a.UOM};t.push(o),s+=1}}})),t}getLoadingDetails(e){var t=[{key:w.yz,value:e.ShipmentCode}],s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.yz,KeyCodes:t};N()(V.MUl,C.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{e.data.IsSuccess?this.setState({modLoadingDetails:this.formLoadingCompartments(e.data.EntityResult),staticLoadingDetails:e.data.EntityResult}):this.setState({modLoadingDetails:[],staticLoadingDetails:[]})})).catch((t=>{console.log("Error while getting Shipment Loading Details:",t,e)}))}getLadenWeightData(e,t,s,i,a,o){let n={};try{N()(V.htF+"?shipmentCode="+this.state.modShipment.ShipmentCode+"&shCode="+this.props.selectedShareholder+"&vehicleTareWeight="+e+"&vehicleWeightUOM="+t+"&weightUOM="+s+"&maxLoadableWeight="+i+"&weight="+a,C.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{e.data.IsSuccess&&(n=e.data.EntityResult,this.ValidateLadenWeight(n,o))})).catch((e=>{console.log("Error while getting Shipment trailer weigh data Details:",e,this.state.modShipment)}))}catch(l){console.log("Error in getLadenWeightData:",l)}}GetViewAllShipmentCustomData(e){try{var t=[];void 0!==e&&(t=[{key:w.yz,value:e.ShipmentCode},{key:w.Bw,value:e.Status},{key:w.ok,value:e.VehicleCode},{key:w.Wb,value:e.ActualTerminalCode}]);var s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.yz,KeyCodes:t};N()(V.QhJ,C.tW(s,this.props.tokenDetails.tokenInfo)).then((t=>{if(t.data.IsSuccess){var s=t.data.EntityResult;void 0!==e?this.setState({saveEnabled:"TRUE"!==s.IsLocalConnected&&(!("TRUE"!==s.ShipmentUpdateAllow||!C.ab(this.props.userDetails.EntityResult.FunctionsList,c.i.modify,this.props.ShipmentType.toLowerCase()))||(this.state.isPlanned?"TRUE"!==s.DisableLoadingDetails:"TRUE"===s.ShipmentUpdateAllow&&C.ab(this.props.userDetails.EntityResult.FunctionsList,c.i.modify,this.props.ShipmentType.toLowerCase()))),modCustomValues:t.data.EntityResult},(()=>{"TRUE"===t.data.EntityResult.CustomerInventory&&void 0!==e&&this.getCustomerInventory(e)})):this.setState({modCustomValues:t.data.EntityResult,saveEnabled:C.ab(this.props.userDetails.EntityResult.FunctionsList,""===this.state.shipment.ShipmentCode?c.i.add:c.i.modify,this.props.ShipmentType.toLowerCase())},(()=>{"TRUE"===t.data.EntityResult.CustomerInventory&&void 0!==e&&this.getCustomerInventory(e)}))}else this.setState({modCustomValues:{},customerInventory:[]})})).catch((t=>{console.log("Error while getting shipment custom details:",t,e)}))}catch(i){console.log("Error in Custom Data retrieve",i)}}getCustomerInventory(e){var t=[{key:w.KJ,value:e.ShipmentCode}],s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.KJ,KeyCodes:t};N()(V.hqV,C.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{if(e.data.IsSuccess){let t=e.data.EntityResult;t&&Array.isArray(t)&&t.length>0&&t.forEach((e=>{e.GrossActualQuantity=e.GrossActualQuantity.toString()+" "+e.QuantityUOM,e.PlannedQuantity=e.PlannedQuantity.toString()+" "+e.QuantityUOM})),this.setState({customerInventory:e.data.EntityResult})}else this.setState({customerInventory:[]})})).catch((t=>{console.log("Error while getting shipment custom details:",t,e)}))}getTrailerDetails(e){try{var t=[{key:w.yz,value:e.ShipmentCode}],s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.yz,KeyCodes:t,Entity:this.state.trailers};N()(V.i4k,C.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{let t=[];if(e.data.IsSuccess){t=e.data.EntityResult;let s=f().cloneDeep(this.state.attributeMetaDataList.SHIPMENTTRAILER),i=f().cloneDeep(this.state.attributeMetaDataList.SHIPMENTTRAILERWEIGHBRIDGE);t.forEach((e=>{if(this.formReadOnlyAttributes(e.shipmentTrailerInfo.Attributes,s),null!==e.shipmentTrailerTWInfoList&&void 0!==e.shipmentTrailerTWInfoList&&e.shipmentTrailerTWInfoList.length>0)e.shipmentTrailerTWInfoList.AttributesforUI=this.formReadonlyCompAttributes(e.shipmentTrailerTWInfoList.Attributes,i);else{let t=this.formReadonlyCompAttributes([],i);e.shipmentTrailerTWInfoList=[],this.setState({selectedCompAttributes:t})}null!==e.shipmentTrailerWBInfoList&&void 0!==e.shipmentTrailerWBInfoList&&e.shipmentTrailerWBInfoList.length>0?e.shipmentTrailerWBInfoList.AttributesforUI=this.formReadonlyCompAttributes(e.shipmentTrailerWBInfoList.Attributes,i):e.shipmentTrailerWBInfoList=[]}))}this.setState({trailerDetails:t,isViewTrailerDetails:!0})})).catch((e=>{console.log("Error while getting Trailer details:",e)}))}catch(i){console.log("Error in get Trailer Details",i)}}formReadOnlyAttributes(e,t){var s=[];t.forEach((function(t){var i=e.find((e=>e.TerminalCode===t.TerminalCode));void 0!==i&&t.attributeMetaDataList.forEach((function(e){var t=i.ListOfAttributeData.find((t=>t.AttributeCode===e.Code));void 0!==t&&(e.DefaultValue=t.AttributeValue)})),s.push(t)})),this.setState({selectedShipTrailerAttributeList:s})}formReadonlyCompAttributes(e,t){let s=[];return null!==t&&void 0!==t&&t.length>0&&t.forEach((e=>{e.attributeMetaDataList.forEach((e=>{s.push({AttributeCode:e.Code,AttributeName:e.DisplayName?e.DisplayName:e.Code,AttributeValue:e.DefaultValue,TerminalCode:e.TerminalCode,IsMandatory:e.IsMandatory,DataType:e.DataType,IsReadonly:e.IsReadonly,MinValue:e.MinValue,MaxValue:e.MaxValue,ValidationFormat:e.ValidationFormat,compSequenceNo:""})}))})),null!==e&&void 0!==e&&e.length>0&&e.forEach((e=>{s.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.ListOfAttributeData.forEach((e=>{t.AttributeCode===e.AttributeCode&&(t.AttributeValue=e.AttributeValue)}))}))})),s}formLoadingCompartments(e){let t=0,s=f().cloneDeep(this.state.modCustomValues);null!==s&&null!==s.NumberOfSignificantDigits&&void 0!==s.NumberOfSignificantDigits&&""!==s.NumberOfSignificantDigits&&(t=C.bo(s.NumberOfSignificantDigits));let i=[];Array.isArray(e.Table1)&&e.Table1.forEach((e=>{e.TotalQuantity=this.state.isVolumeBased?(e.loadedquantity+e.adjustedquantity).toString()+" "+e.compartmentuom:(e.loadedquantity+e.adjustedquantity).toString()+" "+e.compartmentuom+"\n( "+(e.loadedquantity_volume+e.adjustedquantity_volume).toString()+e.volumeuom+" )",e.LeftQuantity=e.revisedplannedquantity-(e.loadedquantity+e.adjustedquantity)<0?"0 "+e.compartmentuom:(e.revisedplannedquantity-(e.loadedquantity+e.adjustedquantity)).toString()+" "+e.compartmentuom,e.plannedquantity=(null===e.plannedquantity?"0":e.plannedquantity.toString())+" "+e.compartmentuom,e.revisedplannedquantity=(null===e.revisedplannedquantity?"0":e.revisedplannedquantity.toString())+" "+e.compartmentuom,e.loadedquantity=this.state.isVolumeBased?null===e.loadedquantity?"0":e.loadedquantity.toString()+" "+e.compartmentuom:null===e.loadedquantity?"0":e.loadedquantity.toString()+" "+e.compartmentuom+"\n( "+e.loadedquantity_volume+e.volumeuom+" )",e.adjustedquantity=this.state.isVolumeBased?null===e.adjustedquantity?"0":e.adjustedquantity.toString()+" "+e.compartmentuom:null===e.adjustedquantity?"0":e.adjustedquantity.toString()+" "+e.compartmentuom+"\n( "+e.adjustedquantity_volume+e.volumeuom+" )"})),Array.isArray(e.Table2)&&e.Table2.forEach((e=>{e.TotalQuantity=this.state.isVolumeBased?(e.loadedquantity+e.adjustedquantity).toString()+" "+e.compartmentuom:(e.loadedquantity+e.adjustedquantity).toString()+" "+e.compartmentuom+"\n( "+(e.loadedquantity_volume+e.adjustedquantity_volume).toString()+e.volumeuom+" )",e.LeftQuantity=e.revisedplannedquantity-(e.loadedquantity+e.adjustedquantity)<0?"0 "+e.compartmentuom:(e.revisedplannedquantity-(e.loadedquantity+e.adjustedquantity)).toString()+" "+e.compartmentuom,e.plannedquantity=null===e.plannedquantity?"0":e.plannedquantity.toString()+" "+e.compartmentuom,e.revisedplannedquantity=null===e.revisedplannedquantity?"0":e.revisedplannedquantity.toString()+" "+e.compartmentuom,e.loadedquantity=this.state.isVolumeBased?null===e.loadedquantity?"0":e.loadedquantity.toString()+" "+e.compartmentuom:null===e.loadedquantity?"0":e.loadedquantity.toString()+" "+e.compartmentuom+"\n( "+e.loadedquantity_volume+e.volumeuom+" )",e.adjustedquantity=this.state.isVolumeBased?null===e.adjustedquantity?"0":e.adjustedquantity.toString()+" "+e.compartmentuom:null===e.adjustedquantity?"0":e.adjustedquantity.toString()+" "+e.compartmentuom+"\n( "+e.adjustedquantity_volume+e.volumeuom+" )"}));let a=[];return Array.isArray(e.Table)&&e.Table.forEach((s=>{let o=[];if(a.findIndex((e=>e===s.trailercode))<0&&a.push(s.trailercode),Array.isArray(e.Table1)){let t=e.Table1.filter((e=>e.finishedproductid===s.FinishedProductID&&e.shipmentcompartmentid===s.shipmentcompartmentid));t.forEach((t=>{t.AdditiveProductDetails=e.Table2.filter((e=>t.baseproductid===e.baseproductid&&t.shipmentcompartmentid===e.shipmentcompartmentid))})),o=t}i.push({Trailer_Code:s.trailercode,Compartment_Code:s.compartmentcode,Compartment_Status:s.compartmentstatus,Finished_Product:s.finishedproductcode,Planned_Quantity:(null===s.PlannedQuantity?"0":s.PlannedQuantity.toString())+" "+s.compartmentuom,Revised_Planned_Quantity:(null===s.revisedplannedquantity?"0":s.revisedplannedquantity.toString())+" "+s.compartmentuom,Loaded_Quantity:this.state.isVolumeBased?Math.round(s.loadedquantity+s.adjustedquantity,t).toString()+" "+s.compartmentuom:Math.round(s.loadedquantity+s.adjustedquantity,t).toString()+" "+s.compartmentuom+"\n( "+Math.round(s.loadedquantity_volume+s.adjustedquantity_volume,t).toString()+s.volumeuom+" )",Left_Quantity:s.revisedplannedquantity-(s.loadedquantity+s.adjustedquantity)<0?"0 "+s.compartmentuom:Math.round(s.revisedplannedquantity-(s.loadedquantity+s.adjustedquantity),t).toString()+" "+s.compartmentuom,Adjust_Plan:null===s.AdjustmentToPlannedQuantity?"":s.AdjustmentToPlannedQuantity,Top_Up_Decant_Quantity:null===s.TopUpDecantQuantity?"":s.TopUpDecantQuantity,Top_Up_Decant_Quantity_Status:s.TopUpDecantStatus,Compartment_UOM:s.compartmentuom,Notes:s.Notes?"":s.Notes,BaseProductDetails:o,ShipmentID:s.ShipmentID,CompartmentID:s.CompartmentID,FinishedProductID:s.FinishedProductID,ShipmentCompID:s.shipmentcompartmentid,SeqNo:s.seqno,Force_Complete:p.bw[s.compartmentstatus]===p.bw.FORCE_COMPLETED,BlendState:s.blendstate})})),this.setState({trailers:a}),i=C.Q3(i),i}getRecordWeightList(){N()(V.IP6,C.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;this.setState({isRecordWeight:!0,recordWeightList:t.EntityResult})})).catch((e=>{console.log("Error while getting RecordWeightList:",e)}))}getWeighBridge(e){try{var t=[{key:w.bW,value:this.state.weighBridgeCode}],s={keyDataCode:w.bW,KeyCodes:t};N()(V.Swg,C.tW(s,this.props.tokenDetails.tokenInfo)).then((t=>{var s=t.data;if(!0===s.IsSuccess){let t=s.EntityResult;this.getLadenWeightData(this.state.vehicleForRecordWeight.TareWeight,this.state.vehicleForRecordWeight.WeightUOM,t.WeightUOM,this.state.vehicleForRecordWeight.MaxLoadableWeight,this.state.scadaValue,e)}else console.log("Error in GetWeighBridge:",s.ErrorList)})).catch((e=>{console.log("Error while GetWeighBridge:",e)}))}catch(i){console.log("Error in get GetWeighBridge",i)}}ValidateLadenWeight(e,t){let s={messageType:"critical",message:"ViewAllShipment_Record_Weight",messageResultDetails:[]};var i=!0;try{let l=t.MinLadenweightQuantityTolerance,r=t.MaxLadenweightQuantityTolerance;var a="",o=0,n=0;if(isNaN(parseFloat(this.state.scadaValue))?(a="MesuredWeight_Improper",i=!1):isNaN(parseFloat(e.ConvertedRegisteredTareWeight))?(a="Improper_Tare_Weight",i=!1):isNaN(parseFloat(e.ConvertedMaxLoadableWeight))?(a="Improper_Max_Weight",i=!1):isNaN(parseFloat(e.ConvertedMeasuredTareWeight))&&(a="TareWeight_Not_Captured",i=!1),!0===i)o=(parseFloat(e.ConvertedMeasuredTareWeight)+parseFloat(e.ConvertedLoadedQty))*parseFloat(l)/100,n=(parseFloat(e.ConvertedMeasuredTareWeight)+parseFloat(e.ConvertedLoadedQty))*parseFloat(r)/100,parseFloat(e.ConvertedLoadedQty)>parseFloat(e.ConvertedMaxLoadableWeight)|parseFloat(this.state.scadaValue)>parseFloat(e.ConvertedMaxLoadableWeight)+parseFloat(e.ConvertedRegisteredTareWeight)?a="ShipmentWeight_GreaterThan_MaxLoadableWeight":parseFloat(this.state.scadaValue)<parseFloat(e.ConvertedMeasuredTareWeight)+parseFloat(e.ConvertedLoadedQty)-o?a="MeasuredWeight_LessThan_ExpectedLoadedWeight":parseFloat(this.state.scadaValue)>parseFloat(e.ConvertedMeasuredTareWeight)+parseFloat(e.ConvertedLoadedQty)+n&&(a="MeasuredWeight_MoreThan_ExpectedLoadedWeight");else if(""!==a&&(s.messageResultDetails.push({keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[this.state.shipment.ShipmentCode],isSuccess:!1,errorMessage:a}),this.setState({isLadenWeightValid:!1})),s.messageResultDetails.length>0)return this.props.onSaved(this.state.modShipment,"update",s),!1;""!==a?this.setState({isLadenWeightValid:!0,ladenWeightError:a}):this.RecordLadenWeight()}catch(a){console.log("Error while validating laden weight : ",a)}return i}RecordLadenWeight(){try{var e=[{key:w.bW,value:this.state.weighBridgeCode},{key:w.VA,value:this.state.scadaValue},{key:w.ok,value:this.state.shipment.VehicleCode},{key:w.yz,value:this.state.shipment.ShipmentCode},{key:w.Rb,value:this.state.allowOutofRangeTW}];let s={messageType:"critical",message:"ViewAllShipment_Record_Weight",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[this.state.shipment.ShipmentCode],isSuccess:!1,errorMessage:""}]};var t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.bW,KeyCodes:e};N()(V.eib,C.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{s.messageType=e.data.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=e.data.IsSuccess,e.data.IsSuccess?this.setState({isRecordWeight:!1},(()=>{this.getShipment({Common_Code:this.state.modShipment.ShipmentCode},null,null,s)})):(s.messageResultDetails[0].errorMessage=e.data.ErrorList[0],this.props.onSaved(this.state.modShipment,"update",s))})).catch((e=>{console.log("Error while recording laden weight:",e)}))}catch(s){console.log("Error in GetScadaValue")}}AllocateBay(e,t,s){var i=[{key:w.yz,value:e},{key:w.Kz,value:t},{key:w.EW,value:s}],a={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.yz,KeyCodes:i};let o={messageType:"critical",message:"BayAllocation_SaveStatus",messageResultDetails:[{keyFields:["BayCode"],keyValues:[t],isSuccess:!1,errorMessage:""}]};N()(V.AiH,C.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;o.messageType=t.IsSuccess?"success":"critical",o.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?(this.getShipment({Common_Code:this.state.shipment.ShipmentCode},null,null,o),this.setState({isAllocateBay:!1})):(o.messageResultDetails[0].errorMessage=t.ResultDataList[0].ErrorList[0],this.props.onSaved(this.state.modShipment,"update",o))})).catch((e=>{console.log("Error while AllocateBay:",e)}))}GetBayByTrnsaction(e,t,s){var i={ShareHolderCode:s,KeyCodes:[{key:w.yz,value:e},{key:w.D_,value:t}]};N()(V.nfn,C.tW(i,this.props.tokenDetails.tokenInfo),C.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;t.IsSuccess&&this.setState({ShipmentBay:t.EntityResult.BayCode})})).catch((e=>{console.log("Error while GetBayByTrnsaction:",e)}))}DeAllocateBay(e,t,s){var i=[{key:w.yz,value:e},{key:w.EW,value:t}],a={ShareHolderCode:this.props.selectedShareholder,KeyCodes:i};let o={messageType:"critical",message:"BayDeAllocation_SavedStatus",messageResultDetails:[{keyFields:["BayCode"],keyValues:[s],isSuccess:!1,errorMessage:""}]};N()(V.viJ,C.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;o.messageType=t.IsSuccess?"success":"critical",o.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getShipment({Common_Code:this.state.shipment.ShipmentCode},null,null,o):(o.messageResultDetails[0].errorMessage=t.ErrorList[0],this.props.onSaved(this.state.modShipment,"update",o))})).catch((e=>{console.log("Error while DeAllocateBay:",e)}))}UpdateShipmentCompartmentInfo(){let e=this.formCompartmentDetailsRequest(),t={messageType:"critical",message:"ViewAllShipment_ShipmentCompartmentUpdate",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[this.state.shipment.ShipmentCode],isSuccess:!1,errorMessage:""}]};var s=[{key:w.FR,value:this.props.selectedShareholder},{key:w.yz,value:this.state.modShipment.ShipmentCode},{key:"ScheduledDate",value:this.state.modShipment.ScheduledDate},{key:"ShipmentUOM",value:this.state.modShipment.ShipmentQuantityUOM},{key:w._n,value:this.state.modShipment.CarrierCode}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.yz,KeyCodes:s,Entity:e};N()(V.AjM,C.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{var s=e.data;t.messageType=s.IsSuccess?"success":"critical",t.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?this.getShipment({Common_Code:this.state.shipment.ShipmentCode}):t.messageResultDetails[0].errorMessage=s.ErrorList[0],(0,v.toast)((0,S.jsx)(u.A,{children:(0,S.jsx)(x.A,{notificationMessage:t})}),{autoClose:"success"===t.messageType&&1e4})})).catch((e=>{console.log("Error while updating shipment compartments : ",e)}))}ApproveTopUpDecant(e){let t={topUpDecantApprovalStatus:"",topUpDecantEnabled:"",Remarks:"",listShipmentCompartmentInfo:[],listShipmentLoadingCompData:[]};t.Remarks=e;let s={messageType:"critical",message:"ViewAllShipment_ApproveTopUpDecant",messageResultDetails:[{keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[this.state.shipment.ShipmentCode],isSuccess:!1,errorMessage:""}]},i=this.ValidateTopUpDecant();if(i.isValid){if("ViewShipmentTopUpDecant_SubmitForApproved"===e){let e=this.formTopUpDecantRequest(p.Bw.SUBMITTED,null);t.listShipmentCompartmentInfo=e.listShipmentCompartmentInfo}else if("ViewShipmentTopUpDecant_AutoApproved"===e){let e=this.formTopUpDecantRequest(p.Bw.AUTO_APPROVED,null);t.listShipmentCompartmentInfo=e.listShipmentCompartmentInfo}var a=[{key:w.FR,value:this.props.selectedShareholder},{key:w.yz,value:this.state.modShipment.ShipmentCode}],o={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.yz,KeyCodes:a,Entity:t};N()(V.hol,C.tW(o,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess&&this.getShipment({Common_Code:this.state.modShipment.ShipmentCode}),s.messageType=t.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=t.IsSuccess,s.messageResultDetails[0].errorMessage=t.ErrorList[0],(0,v.toast)((0,S.jsx)(u.A,{children:(0,S.jsx)(x.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4})})).catch((e=>{console.log("Error while aproving top up decant : ",e)}))}else s.messageResultDetails[0].isSuccess=!1,s.messageResultDetails[0].errorMessage=i.errorMessage,(0,v.toast)((0,S.jsx)(u.A,{children:(0,S.jsx)(x.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4})}ValidateTopUpDecant(){let e={isValid:!0,errorMessage:""},t=f().cloneDeep(this.state.modLoadingDetails),s=0,i=0,a=0,o=""===this.state.modCustomValues.TopUpDecantMTQ?0:C.bo(this.state.modCustomValues.TopUpDecantMTQ);return t.forEach((t=>{if(null!==t.Left_Quantity&&""!==t.Left_Quantity&&void 0!==t.Left_Quantity&&null!==t.Top_Up_Decant_Quantity&&""!==t.Top_Up_Decant_Quantity&&void 0!==t.Top_Up_Decant_Quantity&&null!==t.Loaded_Quantity&&""!==t.Loaded_Quantity&&void 0!==t.Loaded_Quantity){let n="",l="";if(null!==t.Left_Quantity&&""!==t.Left_Quantity&&void 0!==t.Left_Quantity){n=t.Left_Quantity;let e=n.split(" ");n=e[0].trim(),i=C.bo(n)}if(null!==t.Loaded_Quantity&&""!==t.Loaded_Quantity&&void 0!==t.Loaded_Quantity){l=t.Loaded_Quantity;let e=l.split(" ");l=e[0].trim(),s=C.bo(t.Top_Up_Decant_Quantity),a=C.bo(l)}s>0?Math.round(s,2)>Math.round(o,2)?(e.isValid=!1,e.errorMessage="ViewShipment_TopUpDecant_GreaterThanMTQ"):Math.round(i,2)>Math.round(o,2)&&(e.isValid=!1,e.errorMessage="ViewShipment_TopUpDecant_LessQtyGreaterThanMTQ"):Math.abs(s)>Math.round(a,2)&&(e.isValid=!1,e.errorMessage="ViewShipment_TopUpDecant_DecantGreaterThanLoadedQty")}})),e}formCompartmentDetailsRequest(){let e={topUpDecantApprovalStatus:"",topUpDecantEnabled:"",Remarks:"",listShipmentCompartmentInfo:[],listShipmentLoadingCompData:[],ddlTopUpDecantApprovalStatus:null,isAdjustedFP:0};try{let t=f().cloneDeep(this.state.modLoadingDetails),s=f().cloneDeep(this.state.ddlTopUpDecantStatus);e.topUpDecantApprovalStatus=this.state.modCustomValues.TopUpDecantStatusText,e.topUpDecantEnabled=this.state.modCustomValues.EnableTopUpDecant,e.Remarks=this.state.reasonForClosure;let i=0;if(null===s){let s=!1;if(e.ddlTopUpDecantApprovalStatus=null,t.forEach((t=>{let a={AdjustQuantity:0,ForceCompleted:!1,TrailerCode:"",CompartmentCode:"",AdjustmentToPlannedQuantity:0,Density:0,DensityUOM:""},o=!1;""!==t.Adjust_Plan&&(a.AdjustmentToPlannedQuantity=C.bo(t.Adjust_Plan),i+=1,o=!0),t.Force_Complete&&(a.ForceCompleted=!0,o=!0,s=!0),a.ShipmentCompartmentID=t.ShipmentCompID,a.FinishedProductID=t.FinishedProductID,a.TrailerCode=t.Trailer_Code,a.CompartmentCode=t.Compartment_Code,o&&e.listShipmentLoadingCompData.push(a)})),i>0&&(e.isAdjustedFP=i),"TRUE"===e.topUpDecantEnabled&&!0===s&&(e.topUpDecantApprovalStatus!==p.Bw.NONE||e.topUpDecantApprovalStatus!==p.Bw.COMPLETED||e.topUpDecantApprovalStatus!==p.Bw.FORCE_COMPLETED)){let t=this.formTopUpDecantRequest(p.Bw.FORCE_COMPLETED,p.Bw.FORCE_COMPLETED);e.listShipmentCompartmentInfo=t.listShipmentCompartmentInfo}}else if("TRUE"===e.topUpDecantEnabled){let t=f().cloneDeep(this.state.modCustomValues);if(t.TopUpDecantStatusDropDownVisible="FALSE",this.setState({modCustomValues:t}),s===p.Bw.REQUEST_APPROVE){let t=this.formTopUpDecantRequest(p.Bw.APPROVED,null);e.listShipmentCompartmentInfo=t.listShipmentCompartmentInfo,this.setState({ddlTopUpDecantStatus:null})}else if(s===p.Bw.REQUEST_REJECT){let t=this.formTopUpDecantRequest(p.Bw.REJECTED,null);e.listShipmentCompartmentInfo=t.listShipmentCompartmentInfo,this.setState({ddlTopUpDecantStatus:null})}}}catch(t){console.log("Error while forming top up decant details:",t)}return e}formTopUpDecantRequest(e,t){let s={topUpDecantApprovalStatus:"",topUpDecantEnabled:"",Remarks:"",listShipmentCompartmentInfo:[],listShipmentLoadingCompData:[]};try{let i=f().cloneDeep(this.state.staticLoadingDetails),a=f().cloneDeep(this.state.modLoadingDetails);s.topUpDecantApprovalStatus=this.state.modCustomValues.TopUpDecantStatusText,s.topUpDecantEnabled=this.state.modCustomValues.EnableTopUpDecant,s.Remarks=this.state.reasonForClosure;let o=this.props.userDetails.EntityResult.Firstname+" "+this.props.userDetails.EntityResult.LastName;a.forEach((a=>{let n="TRUE"===this.state.modCustomValues.f_ViewShipTopUpDecantApprovalAccess?"ViewShipmentTopUpDecant_AutoApproved":"ViewShipmentTopUpDecant_SubmitForApproved";"TRUE"===this.state.modCustomValues.TopUpDecantApprovalEnabled&&(n="ViewShipmentTopUpDecant_AutoApproved");let l="",r={TopUpDecantQuantity:null,QuantityUOM:"",Comments:"",Status:"",CreatedBy:"",CreatedTime:"",LastUpdatedBy:"",LastUpdatedTime:""},d={TrailerCode:"",ShipmentCompartmentStatus:"",CompartmentCode:"",ShipmentCompartmentTopUpDecantingInfo:""};if(null!==a.Top_Up_Decant_Quantity&&void 0!==a.Top_Up_Decant_Quantity&&""!==a.Top_Up_Decant_Quantity)if(l=null!==a.Top_Up_Decant_Quantity_Status&&void 0!==a.Top_Up_Decant_Quantity_Status&&""!==a.Top_Up_Decant_Quantity_Status?a.Top_Up_Decant_Quantity_Status:p.Bw.NONE,l===p.Bw.NONE&&e!==p.Bw.FORCE_COMPLETED)r.TopUpDecantQuantity=C.bo(a.Top_Up_Decant_Quantity),d.TrailerCode=a.Trailer_Code,d.ShipmentCompartmentStatus=p.bw[a.Compartment_Status],d.CompartmentCode=a.Compartment_Code,r.Status=e,r.QuantityUOM=a.Compartment_UOM,null!==a.Notes&&void 0!==a.Notes&&""!==a.Notes?r.Comments=a.Notes:r.Comments="",r.LastUpdatedBy=o,d.ShipmentCompartmentTopUpDecantingInfo=r,s.listShipmentCompartmentInfo.push(d);else if(l!==p.Bw.NONE&&e===p.Bw.FORCE_COMPLETED)i.Table.forEach((i=>{i.compartmentcode===a.Compartment_Code&&("FORCECLOSE"===t||t===p.Bw.FORCE_COMPLETED&&a.Force_Complete)&&(r.TopUpDecantQuantity=C.bo(i.TopUpDecantQuantity),r.Comments=i.Notes,r.Status=e,r.LastUpdatedBy=o,d.TrailerCode=i.trailercode,d.ShipmentCompartmentStatus=p.bw[i.compartmentstatus],d.CompartmentCode=i.compartmentcode,r.QuantityUOM=i.compartmentuom,d.ShipmentCompartmentTopUpDecantingInfo=r,s.listShipmentCompartmentInfo.push(d))}));else{let t=0;if(t=C.bo(a.Top_Up_Decant_Quantity),t>0||t<0){let l="";null!==a.Notes&&void 0!==a.Notes&&""!==a.Notes&&(l=a.Notes),i.Table.forEach((i=>{if(i.compartmentcode===a.Compartment_Code){let h=null!==i.TopUpDecantQuantity&&void 0!==i.TopUpDecantQuantity&&""!==i.TopUpDecantQuantity?C.bo(i.TopUpDecantQuantity):0;t===h&&l===i.Notes&&"ViewShipmentTopUpDecant_AutoApproved"!==n||(r.TopUpDecantQuantity=t,d.TrailerCode=a.Trailer_Code,d.ShipmentCompartmentStatus=p.bw[a.Compartment_Status],d.CompartmentCode=a.Compartment_Code,r.Status=e,r.QuantityUOM=a.Compartment_UOM,r.Comments=l,r.LastUpdatedBy=o,d.ShipmentCompartmentTopUpDecantingInfo=r,s.listShipmentCompartmentInfo.push(d))}}))}}}))}catch(i){console.log("Error while forming top up decant details:",i)}return s}GetAutoGeneratedShipmentCode(e){let t=e;return N()(V.CRg,C.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var s=e.data;!0===s.IsSuccess&&(null!==s.EntityResult&&void 0!==s.EntityResult&&""!==s.EntityResult?(t.ShipmentCode=s.EntityResult,this.setState({isAutoGeneratedShipmentCode:!0,autoGeneratedCode:s.EntityResult})):this.setState({isAutoGeneratedShipmentCode:!1,autoGeneratedCode:""}))})).catch((e=>{console.log("Error while getting AutoGeneratedShipmentCode:",e)})),t}getShipment(e,t,s,i){let a=null;t=void 0===t||null===t?this.props.ShipmentType.toLowerCase():t,I.cj.ShareholderCode=this.props.selectedShareholder,t&&t.toLowerCase()===c.de?I.cj.ShipmentType=0:I.cj.ShipmentType=2,I.cj.ShipmentQuantityUOM=this.props.userDetails.EntityResult.PageAttibutes.DefaultQtyUOMForTransactionUI.ROAD,I.cj.ScheduledDate=new Date,I.cj.TerminalCodes=1===this.props.terminalCodes.length?[...this.props.terminalCodes]:[];let o=t&&t.toLowerCase()===c.de?c.de:c.yu;if(this.handleResetAttributeValidationError(),void 0===e.Common_Code){void 0!==this.props.shipmentSource?I.cj.CreatedFromEntity=this.props.shipmentSource:I.cj.CreatedFromEntity=0;let e=[];return void 0===this.props.shipmentSource||this.props.ShipmentType.toLowerCase()!==c.yu||this.props.shipmentSourceFromSummary||(e=this.getShipmentCompartmentFromVehicleCompartment()),void 0!==this.props.shipmentSource&&this.props.shipmentSourceFromSummary&&this.getCompartmentFromOtherSource(this.props.selectedSourceCode),void this.setState({shipment:f().cloneDeep(I.cj),modShipment:t&&t.toLowerCase()===c.de?this.GetAutoGeneratedShipmentCode(f().cloneDeep(I.cj)):f().cloneDeep(I.cj),isReadyToRender:!0,modLoadingDetails:[],staticLoadingDetails:[],modCompartmentPlans:[],modProductPlans:e,selectedAttributeList:[],isPlanned:!1,saveEnabled:C.ab(this.props.userDetails.EntityResult.FunctionsList,c.i.add,o),activeTab:s,isValidationPassed:!1,isDisableSubmitForApproval:!0,productAllocationList:[],productShareholderAllocationList:[],ProdAllocEntity:"",expandedRows:[],isEnforcingEnabled:!1,truckShipmentKPIList:[]},(()=>{!1===this.props.userDetails.EntityResult.IsEnterpriseNode&&this.localNodeAttribute()}))}var n=[{key:w.yz,value:e.Common_Code}],l={ShareHolderCode:this.props.selectedShareholder,keyDataCode:w.yz,KeyCodes:n};N()(V.TJ4,C.tW(l,this.props.tokenDetails.tokenInfo)).then((e=>{var s=e.data;if(!0===s.IsSuccess){let e=s.EntityResult;a=s.EntityResult;let i=f().cloneDeep(this.state.isPlanned);i=!0,this.setState({isReadyToRender:!0,shipment:s.EntityResult,modShipment:f().cloneDeep(s.EntityResult),modCompartmentPlans:this.getShipmentCompartmentFromShipment(s.EntityResult),modProductPlans:this.props.ShipmentType.toLowerCase()===c.yu?this.getShipmentDetailsFromShipment(s.EntityResult):[],isPlanned:i,isValidationPassed:!0,isVolumeBased:s.EntityResult.IsVolumeBased,activeTab:i&&t.toLowerCase()===c.de?1:i&&t.toLowerCase()===c.yu?null===e.ShipmentDestinationCompartmentsInfo||void 0===e.ShipmentDestinationCompartmentsInfo||0===e.ShipmentDestinationCompartmentsInfo.length?1:2:0,isDisableSubmitForApproval:s.EntityResult.Status!==p.Mw.READY&&null===s.EntityResult.ActualTerminalCode,expandedRows:[]},(()=>{this.GetViewAllShipmentCustomData(s.EntityResult),this.getVehicle(s.EntityResult.VehicleCode,!1),this.getLoadingDetails(s.EntityResult),this.getKPIList(this.props.selectedShareholder,s.EntityResult.ShipmentCode),this.props.userDetails.EntityResult.IsEnterpriseNode?this.terminalSelectionChange(s.EntityResult.TerminalCodes):this.localNodeAttribute(),this.getShipmentStatusOperations(s.EntityResult),this.getShipmentStatuses(s.EntityResult),this.getLookUpData(s.EntityResult.ShipmentCode),null!==s.EntityResult.TransloadSourceType&&void 0!==s.EntityResult.TransloadSourceType&&"MARINE"===s.EntityResult.TransloadSourceType&&this.getMarineTransloadableReceipts(),this.GetBayByTrnsaction(s.EntityResult.ShipmentCode,"SHIPMENT",s.EntityResult.ShareholderCode)}))}else this.setState({shipment:f().cloneDeep(I.cj),modShipment:f().cloneDeep(I.cj),modLoadingDetails:[],staticLoadingDetails:[],modCustomValues:{},modCompartmentPlans:[],selectedAttributeList:[],modProductPlans:[],isReadyToRender:!0,isPlanned:!1,activeTab:this.props.ShipmentType.toLowerCase()===c.de?1:0,isValidationPassed:!1,isDisableSubmitForApproval:!0,productAllocationList:[],ProdAllocEntity:"",productShareholderAllocationList:[]}),console.log("Error in GetShiment:",s.ErrorList);void 0!==i&&null!==i&&null!==a&&this.props.onSaved(a,"update",i)})).catch((t=>{console.log("Error while getting Shipment:",t,e)}))}getCompartmentFromOtherSource(e){var t=[],s=this.props.selectedShareholder;this.props.shipmentSource===p.U6.Contract?(e.forEach((e=>{var i={keyDataCode:0,ShareHolderCode:s,KeyCodes:[{Key:w.GT,Value:e}]};t.push(i)})),N()(V.RYr,C.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;!0===t.IsSuccess?this.setState({otherSourceData:t.EntityResult},(()=>{this.props.ShipmentType.toLowerCase()===c.yu&&this.getShipmentCompartmentFromVehicleCompartment()})):this.setState({otherSourceData:[]})}))):this.props.shipmentSource===p.U6.Order&&(e.forEach((e=>{var i={keyDataCode:0,ShareHolderCode:s,KeyCodes:[{Key:w.SP,Value:e}]};t.push(i)})),N()(V.rfJ,C.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;!0===t.IsSuccess?this.setState({otherSourceData:t.EntityResult},(()=>{this.props.ShipmentType.toLowerCase()===c.yu&&this.getShipmentCompartmentFromVehicleCompartment()})):this.setState({otherSourceData:[]})})))}handleResetAttributeValidationError(){try{var e=f().cloneDeep(this.state.attributeMetaDataList.SHIPMENT);this.setState({attributeValidationErrors:C.Fl(e)})}catch(t){console.log("TrailerDetailsComposite:Error occured on handleResetAttributeValidationError",t)}}GetUOMList(){N()(V.WFM,C.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){let e=[];if(Array.isArray(t.EntityResult.VOLUME)&&(e=C.Zj(t.EntityResult.VOLUME)),Array.isArray(t.EntityResult.MASS)){C.Zj(t.EntityResult.MASS).forEach((t=>e.push(t)))}this.setState({quantityUOMOptions:e})}}else console.log("Error in GetUOMList:",t.ErrorList)})).catch((e=>{console.log("Error while getting GetUOMList:",e)}))}getVehicleCodes(e){N()(V.FKP+"?Transportationtype="+p.LY.ROAD+"&ShareholderCode="+e,C.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){let e=C.Zj(t.EntityResult),s=f().cloneDeep(e);s.length>p.bM&&(s=s.slice(0,p.bM)),this.setState({vehicleOptions:e,vehicleSearchOptions:s})}}else console.log("Error in getVehicleCodes:",t.ErrorList)})).catch((e=>{console.log("Error while getting getVehicleCodes:",e)}))}getFinishedProductCodes(e){N()(V.w43+"?ShareholderCode="+e,C.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){let e=C.Zj(t.EntityResult);this.setState({finishedProductOptions:e})}}else console.log("Error in getFinishedProductCodes:",t.ErrorList)})).catch((e=>{console.log("Error while getting getFinishedProductCodes:",e)}))}getcustomerDestinationList(e){N()(V.E6k+"?ShareholderCode="+e+"&TransportationType="+p.LY.ROAD,C.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var s=t.data;if(!0===s.IsSuccess)if(Array.isArray(s.EntityResult)){let t=s.EntityResult.filter((t=>t.ShareholderCode===e));if(t.length>0){let e=t[0].CustomerDestinationsList;this.setState({customerDestinationOptions:e})}else console.log("no customers identified for shareholder")}else console.log("customerdestinations not identified for shareholder")})).catch((e=>{console.log("Error while getting Customer List:",e)}))}getDriverCodes(e){N()(V.bHU+"?ShareholderCode="+e,C.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){let e=C.Zj(t.EntityResult),s=f().cloneDeep(e);s.length>p.bM&&(s=s.slice(0,p.bM)),this.setState({driverOptions:e,driverSearchOptions:s})}}else console.log("Error in getDriverCodes:",t.ErrorList)})).catch((e=>{console.log("Error while getting getDriverCodes:",e)}))}getDriverSearchOptions(){let e=f().cloneDeep(this.state.driverSearchOptions),t=this.state.modShipment.DriverCode;if(null!==t&&""!==t&&void 0!==t){void 0===e.find((e=>e.value.toLowerCase()===t.toLowerCase()))&&e.push({text:t,value:t})}return e}getContractCodes(e){N()(V.jFl+"?ShareholderCode="+e+"&TransportationType="+p.LY.ROAD,C.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;!0===t.IsSuccess||Array.isArray(t.EntityResult)?this.setState({contractCodeOptions:C.Zj(t.EntityResult)}):console.log("Error in getContractCodes: ",t.ErrorList)})).catch((e=>{console.log("Error while getContractCodes: ",e)}))}getOrderCodes(e){N()(V.xwe+"?ShareholderCode="+e+"&TransportationType="+p.LY.ROAD,C.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;!0===t.IsSuccess||Array.isArray(t.EntityResult)?this.setState({orderCodeOptions:C.Zj(t.EntityResult)}):console.log("Error in getOrderCodes: ",t.ErrorList)})).catch((e=>{console.log("Error while getOrderCodes: ",e)}))}getVehicleSearchOptions(){let e=f().cloneDeep(this.state.vehicleSearchOptions),t=this.state.modShipment.VehicleCode;if(null!==t&&""!==t&&void 0!==t){void 0===e.find((e=>e.value.toLowerCase()===t.toLowerCase()))&&e.push({text:t,value:t})}return e}getKPIList(e,t){if(!0===C.ab(this.props.userDetails.EntityResult.FunctionsList,c.i.view,c.bL)){let s={PageName:U.lT,TransportationType:p.LY.ROAD,InputParameters:[{key:"ShareholderCode",value:e},{key:"ShipmentCode",value:t}]};N()(V.dxq,C.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({truckShipmentKPIList:t.EntityResult.ListKPIDetails}):(this.setState({truckShipmentKPIList:[]}),console.log("Error in truck shipment KPIList:",t.ErrorList))})).catch((e=>{console.log("Error while getting truck shipment KPIList:",e)}))}}getFunctionGroupName(){return this.state.showShipmentAuthenticationLayout&&this.props.ShipmentType.toLowerCase()===c.yu?c.yu:this.state.showShipmentAuthenticationLayout&&this.props.ShipmentType.toLowerCase()===c.de?c.de:this.state.showCloseShipmentAuthenticationLayout?c.d4:this.state.showAllowToLoadAuthenticationLayout||this.state.showAuthorizeToLoadAuthenticationLayout?c.Nm:this.state.showViewBOLAuthenticationLayout||this.state.showPrintBOLAuthenticationLayout?c.PD:this.state.showFANAuthenticationLayout?c.tM:void 0}getAddorEditMode(){return this.state.showShipmentAuthenticationLayout&&""===this.state.shipment.ShipmentCode?c.i.add:c.i.modify}handleOperation(){return this.state.showShipmentAuthenticationLayout?this.handleSaveShipment:this.state.showAuthorizeToLoadAuthenticationLayout?this.authorizeToLoad:this.state.showAllowToLoadAuthenticationLayout?this.handleAllowToLoad:this.state.showCloseShipmentAuthenticationLayout?this.handleShipmentClose:this.state.showFANAuthenticationLayout?this.handlePrintFAN:this.state.showViewBOLAuthenticationLayout?this.viewBOL:this.state.showPrintBOLAuthenticationLayout?this.handlePrintBOL:void 0}render(){const e=[{fieldName:"DriverInfo_LastUpdated",fieldValue:new Date(this.state.modShipment.LastUpdatedTime).toLocaleDateString()+" "+new Date(this.state.modShipment.LastUpdatedTime).toLocaleTimeString()},{fieldName:"DriverInfo_LastActive",fieldValue:void 0!==this.state.modShipment.LastActiveTime&&null!==this.state.modShipment.LastActiveTime?new Date(this.state.modShipment.LastActiveTime).toLocaleDateString()+" "+new Date(this.state.modShipment.LastActiveTime).toLocaleTimeString():""},{fieldName:"DriverInfo_CreatedTime",fieldValue:new Date(this.state.modShipment.CreatedTime).toLocaleDateString()+" "+new Date(this.state.modShipment.CreatedTime).toLocaleTimeString()}];let t=[],s=f().cloneDeep(this.state.modCustomValues),i=this.props.ShipmentType.toLowerCase()===c.yu?s.ShipProdCreateShipmentFromNone:s.ShipCompCreateShipmentFromNone,a=s.orderEnabled,n=s.contractEnabled;if(Object.keys(p.U6).forEach((e=>{"All"!==e&&t.push({text:e,value:p.U6[e]})})),"0"===a){let e=t.findIndex((e=>p.U6[e.text]===p.U6.Order));e>=0&&t.splice(e,1)}if("0"===n){let e=t.findIndex((e=>p.U6[e.text]===p.U6.Contract));e>=0&&t.splice(e,1)}if("0"===i&&("1"===a||"1"===n)){let e=t.findIndex((e=>p.U6[e.text]===p.U6.None));e>=0&&t.splice(e,1)}let r=[];return this.state.isMarineTransLoading&&r.push("MARINE"),this.state.isRailTransloading&&r.push("RAIL"),this.state.isReadyToRender?(0,S.jsxs)("div",{children:[(0,S.jsx)(l.TranslationConsumer,{children:t=>(0,S.jsx)(u.A,{children:(0,S.jsx)(T.A,{entityCode:this.state.isManualEntry?this.state.shipment.ShipmentCode+" - "+t("LoadingDetailsEntry_Title"):this.state.shipment.ShipmentCode,newEntityName:this.props.ShipmentType.toLowerCase()===c.de?"ShipmentCompDetail_NewShipmentByCompartment":"ShipmentProdDetail_NewShipmentByCompartment",popUpContents:e})})}),this.state.isViewAuditTrail?(0,S.jsx)(u.A,{children:(0,S.jsx)(j.I,{ShipmentCode:this.state.shipment.ShipmentCode,auditTrailList:this.state.auditTrailList,modAuditTrailList:this.state.modAuditTrailList,Attributes:void 0!==this.state.auditTrailList&&this.state.auditTrailList.length>0?this.state.auditTrailList[0].AttributesforUI:[],handleBack:this.onBack})}):this.state.isViewLoadingDetails?(0,S.jsx)(u.A,{children:(0,S.jsx)(O.f,{ShipmentCode:this.state.shipment.ShipmentCode,modLoadingDetails:this.state.modViewLoadingDetails,handleBack:this.onBack,expandedRows:this.state.loadingExpandedRows,toggleExpand:this.loadingToggleExpand,nonConfigColumns:this.state.nonConfigColumns})}):this.state.isViewTrailerDetails?(0,S.jsx)(u.A,{children:(0,S.jsx)(P,{ShipmentCode:this.state.shipment.ShipmentCode,trailerDetails:this.state.trailerDetails,selectedAttributeList:this.state.selectedShipTrailerAttributeList,handleBack:this.onBack,compAttributes:void 0!==this.state.trailerDetails&&this.state.trailerDetails.length>0&&this.state.trailerDetails[0].shipmentTrailerTWInfoList&&this.state.trailerDetails[0].shipmentTrailerTWInfoList.length>0?this.state.trailerDetails[0].shipmentTrailerTWInfoList[0].AttributesforUI:this.state.selectedCompAttributes})}):this.state.isManualEntry?(0,S.jsx)("div",{children:(0,S.jsx)(u.A,{children:(0,S.jsx)(o.default,{shipment:this.state.modShipment,handleBack:this.onBack,selectedShareholder:this.props.selectedShareholder})})}):(0,S.jsxs)("div",{children:[(0,S.jsx)(M.A,{KPIList:this.state.truckShipmentKPIList}),(0,S.jsxs)("div",{className:this.state.isPlanned&&Array.isArray(this.state.shipment.ShipmentCompartments)&&this.state.shipment.ShipmentCompartments.length>0?this.state.drawerStatus?"drawerClose":"showShipmentStatusRightPane":"",children:[(0,S.jsx)(u.A,{children:(0,S.jsx)(g,{shipment:this.state.shipment,modShipment:this.state.modShipment,modCustomValues:this.state.modCustomValues,modCompartmentPlans:this.state.modCompartmentPlans,modProductPlans:this.state.modProductPlans,modLoadingDetails:this.state.modLoadingDetails,loadingDetails:this.state.staticLoadingDetails,validationErrors:this.state.validationErrors,listOptions:{terminalCodes:this.props.terminalCodes,quantityUOMOptions:this.state.quantityUOMOptions,vehicleOptions:this.getVehicleSearchOptions(),driverOptions:this.getDriverSearchOptions(),finishedProductOptions:this.state.finishedProductOptions,contractCodeOptions:this.state.contractCodeOptions,orderCodeOptions:this.state.orderCodeOptions,customerDestinationOptions:this.state.customerDestinationOptions,shipmentFromOptions:t,compSeqOptions:this.state.compSeqOptions,topUpDecantOptions:this.state.topUpDecantOptions,transloadingOptions:r,marineReceiptCodes:this.state.marineReceiptCodes,marineReceiptCompCodes:this.state.marineReceiptCompCodes},searchResults:{vehicleOptions:this.state.vehicleSearchOptions,driverOptions:this.state.driverSearchOptions},selectedProductPlans:this.state.selectedProductPlans,selectedCompartmentPlans:this.state.selectedCompartmentPlans,handleCompartmentPlansSelectionChange:this.handleCompartmentPlansSelectionChange,handleProductPlansSelectionChange:this.handleProductPlansSelectionChange,onFieldChange:this.handleChange,onAllTerminalsChange:this.handleAllTerminalsChange,handleAddCompartmentPlan:this.handleAddCompartmentPlan,handleDeleteCompartmentPlan:this.handleDeleteCompartmentPlan,handleAddProductPlan:this.handleAddProductPlan,handleDeleteProductPlan:this.handleDeleteProductPlan,handleCompartmentPlanCellDataEdit:this.handleCompartmentPlanCellDataEdit,handleProductPlanCellDataEdit:this.handleProductPlanCellDataEdit,onDateTextChange:this.handleDateTextChange,onActiveStatusChange:this.handleActiveStatusChange,onVehicleChange:this.handleVehicleChange,onVehicleSearchChange:this.handleVehicleSearchChange,onDriverSearchChange:this.handleDriverSearchChange,isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,shipmentType:this.props.ShipmentType.toLowerCase(),prodTypeTab:this.props.ShipmentType.toLowerCase()===c.yu?[this.props.ShipmentType.toLowerCase()]:[],compTypeTab:this.props.ShipmentType.toLowerCase()!==c.yu||!1!==this.state.isValidationPassed&&null!==this.state.shipment.ShipmentDetailsInfo&&void 0!==this.state.shipment.ShipmentDetailsInfo&&0!==this.state.shipment.ShipmentDetailsInfo.length?[this.props.ShipmentType.toLowerCase()]:[],LoadTypeTab:!1===this.state.isPlanned||""===this.state.shipment.ShipmentCode||void 0===this.state.shipment.ShipmentCode||null===this.state.shipment.ShipmentCode||null===this.state.shipment.ShipmentDestinationCompartmentsInfo||void 0===this.state.shipment.ShipmentDestinationCompartmentsInfo||0===this.state.shipment.ShipmentDestinationCompartmentsInfo.length?[]:[""],customerInventoryTab:!1===this.state.isPlanned||""===this.state.shipment.ShipmentCode||void 0===this.state.shipment.ShipmentCode||null===this.state.shipment.ShipmentCode||"FALSE"===this.state.modCustomValues.CustomerInventory||void 0===this.state.modCustomValues.CustomerInventory||this.props.userDetails.EntityResult.isEnterpriseNode?[]:[""],productAllocationTab:this.props.userDetails.EntityResult.IsEnterpriseNode||""===this.state.shipment.ShipmentCode?[]:[""],toggleExpand:this.toggleExpand,attributeToggleExpand:this.attributeToggleExpand,expandedRows:this.state.expandedRows,attributeValidationErrors:this.state.attributeValidationErrors,handleAttributeCellDataEdit:this.handleAttributeDataEdit,handleCompAttributeCellDataEdit:this.handleCompAttributeCellDataEdit,handleProdPlanAttributeCellDataEdit:this.handleProdPlanAttributeCellDataEdit,selectedAttributeList:this.state.selectedAttributeList,compartmentDetailsPageSize:this.props.userDetails.EntityResult.PageAttibutes.WebPortalListPageSize,customerInventory:this.state.customerInventory,activeTab:this.state.activeTab,onTabChange:this.handleTabChange,IsWebPortalUser:this.props.userDetails.EntityResult.IsWebPortalUser,isDisableSubmitForApproval:this.state.isDisableSubmitForApproval,isSlotbookinginUI:this.props.userDetails.EntityResult.ShowSlotBookedInUI,productAllocationList:this.state.productAllocationList,productShareholderAllocationList:this.state.productShareholderAllocationList,ProdAllocEntity:this.state.ProdAllocEntity,handleCellCheck:this.handleCellCheck,handleLoadingDetailsChange:this.handleLoadingDetailsChange,handleTopUpDecantApproval:this.handleTopUpDecantApproval,ddlTopUpDecantStatus:this.state.ddlTopUpDecantStatus,isMarineTransloading:this.state.isMarineTransLoading,isRailTransloading:this.state.isRailTransloading,isPlanned:this.state.isPlanned,updateTransloadingInfo:this.handleUpdateShipmentTransloading,handleTransLoadCompSeq:this.getMarineReceipt,shipmentSource:this.props.shipmentSource,isAutoGeneratedShipmentCode:this.state.isAutoGeneratedShipmentCode,isEnforcingEnabled:this.state.isEnforcingEnabled,isBonded:this.state.isBonded,overrideSequence:this.handleOverrideShipmentSequence,isOverrideSequenceButtonEnabled:!this.props.userDetails.EntityResult.IsArchived&&(!this.state.isVehicleChanged&&C.ab(this.props.userDetails.EntityResult.FunctionsList,c.i.modify,c.c2)),updateShipmentBondNo:this.UpdateShipmentBondNo,isBondButtonenabled:!this.props.userDetails.EntityResult.IsArchived,updateShipmentAllowed:"TRUE"===this.state.modCustomValues.ShipmentUpdateAllow&&C.ab(this.props.userDetails.EntityResult.FunctionsList,c.i.modify,this.props.ShipmentType.toLowerCase()),ShipmentBay:this.state.ShipmentBay,UpdateShipmentDriver:this.UpdateShipmentDriver,isWebportalCarrierRoleUser:"carriercompany"===this.props.userDetails.EntityResult.RoleName.toLowerCase()&&this.props.userDetails.EntityResult.IsWebPortalUser})}),(0,S.jsx)(u.A,{children:(0,S.jsx)(b.q,{handleBack:this.props.onBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.saveEnabled})})]}),this.state.isPlanned&&Array.isArray(this.state.shipment.ShipmentCompartments)&&this.state.shipment.ShipmentCompartments.length>0?(0,S.jsx)("div",{className:this.state.drawerStatus?"marineStatusLeftPane":"",children:(0,S.jsx)(R.A,{title:"ViewAllShipment_Details",selectedItem:[{Common_Code:this.state.modShipment.ShipmentCode}],shipmentNextOperations:this.state.shipmentNextOperations,handleOperationButtonClick:this.handleOperationClick,currentStatuses:this.state.currentShipmentStatuses,unAllowedOperations:["ManualEntry","ViewShipment_AuthorizeLoad","ViewShipment_AllowToLoad","ViewShipment_RecordWeight","ViewAllocateBay_AllocateBay","ViewAllocateBay_DeallocateBay","ViewShipment_CloseShipment","ViewShipmentStatus_PrintFAN","ViewAllShipment_SendBOL"],webPortalAllowedOperations:["ViewShipment_ViewLoadingDetails","ViewShipmentStatus_ViewBOL","ViewShipment_ViewAuditTrail"],isDetails:!0,isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,isWebPortalUser:this.props.userDetails.EntityResult.IsWebPortalUser,handleDrawer:this.handleDrawer})}):""]}),this.state.isRecordWeight?this.handleRecordWeight():null,this.state.isCloseShipment?this.handleCloseShipmentModal():null,this.state.isSealCompartments?(0,S.jsx)(u.A,{children:(0,S.jsx)(k.default,{transactionCode:this.state.shipment.ShipmentCode,selectedShareholder:this.props.selectedShareholder,sealCompartments:this.state.sealCompartments,handleSealClose:this.handleSealClose})}):null,this.state.isNotRevised?this.confirmAllowToLoad():null,this.state.vehicleBondPopUp?this.confirmVehicleBond():null,this.state.vehicleBondExpiryPopUp?this.confirmVehicleBondExpiryDate():null,this.state.stockProducts?this.confirmBondedStockProducts():null,this.state.isLadenWeightValid?this.confirmRecordLadenWeight():null,this.state.showShipmentAuthenticationLayout||this.state.showAllowToLoadAuthenticationLayout||this.state.showAuthorizeToLoadAuthenticationLayout||this.state.showCloseShipmentAuthenticationLayout||this.state.showViewBOLAuthenticationLayout||this.state.showPrintBOLAuthenticationLayout||this.state.showFANAuthenticationLayout?(0,S.jsx)(Q.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:this.getAddorEditMode(),functionGroup:this.getFunctionGroupName(),handleOperation:this.handleOperation(),handleClose:this.handleAuthenticationClose}):null,this.state.isAllocateBay?this.confirmAllocateBay():null,this.state.isDeAllocateBay?this.confirmDeAllocateBay():null]}):(0,S.jsx)(A.A,{message:"Loading"})}}const B=(0,a.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(F)},56507:(e,t,s)=>{s.r(t),s.d(t,{default:()=>T});var i=s(65043),a=s(97508),o=s(69062),n=s(28882),l=s(65187),r=s(53536),d=s.n(r),h=s(40854),c=s.n(h),m=s(93779),p=s(72067),u=s(11981),C=s(14159),S=s(67907),g=s(72711),y=s(78374),D=s(70579);class b extends i.Component{constructor(){super(...arguments),this.state={sealCompartments:this.props.sealCompartments},this.updateSealCompartments=()=>{let e=d().cloneDeep(this.state.sealCompartments),t=[],s={messageType:"critical",message:"ViewAllShipment_SealCompUpdate",messageResultDetails:[]};if(e.forEach((e=>{t.push({SealNo:e.SealNo,CompNo:e.CompNo,ShareholderCode:this.props.selectedShareholder,ShipmentCode:this.props.transactionCode}),n.F1.forEach((t=>{let i="";void 0!==t.validator&&(i=o.jr(t.validator,e[t.field])),""!==i&&s.messageResultDetails.push({keyFields:["ShipmentCompDetail_CompSeqInVehicle",t.displayName],keyValues:[e.CompNo,e[t.field]],isSuccess:!1,errorMessage:i})}))})),s.messageResultDetails.length>0)(0,C.toast)((0,D.jsx)(l.A,{children:(0,D.jsx)(u.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4});else{s.messageResultDetails.push({keyFields:["ShipmentCompDetail_ShipmentNumber"],keyValues:[this.props.transactionCode],isSuccess:!1,errorMessage:""});var i=[{key:m.FR,value:this.props.selectedShareholder},{key:m.yz,value:this.props.transactionCode}],a={ShareHolderCode:this.props.selectedShareholder,keyDataCode:m.yz,KeyCodes:i,Entity:t};c()(p.AXO,o.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;s.messageType=t.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=t.IsSuccess,s.messageResultDetails[0].errorMessage=t.ErrorList[0],(0,C.toast)((0,D.jsx)(l.A,{children:(0,D.jsx)(u.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4})})).catch((e=>{console.log("Error while update Shipment Seal Info:",e)}))}},this.handleSealNoInput=e=>{let t=e.rowData;return(0,D.jsx)(g.Input,{fluid:!0,value:t.SealNo,disabled:!1,onChange:e=>{let s=d().cloneDeep(this.state.sealCompartments),i=s.findIndex((e=>e.CompNo===t.CompNo));i>=0&&(s[i].SealNo=e),this.setState({sealCompartments:s})},reserveSpace:!1})}}isNodeEnterpriseOrWebortal(){return!(!this.props.userDetails.EntityResult.IsEnterpriseNode&&!this.props.userDetails.EntityResult.IsWebPortalUser)}render(){return(0,D.jsx)("div",{children:(0,D.jsx)(S.TranslationConsumer,{children:e=>(0,D.jsxs)(g.Modal,{open:!0,size:"large",className:"sealCompartmentsPopUp",children:[(0,D.jsxs)(g.Modal.Content,{children:[(0,D.jsx)("div",{className:"col col-lg-12",children:(0,D.jsx)("h3",{children:e("ViewAllShipment_SealCompartment")+" : "+this.props.transactionCode})}),(0,D.jsx)("div",{className:"col-12 detailsTable",children:(0,D.jsxs)(y.bQ,{data:this.state.sealCompartments,children:[(0,D.jsx)(y.bQ.Column,{className:"compColHeight",field:"CompNo",header:e("ViewShipment_CompartmentSeq"),editable:!1}),(0,D.jsx)(y.bQ.Column,{className:"compColHeight",field:"FinishedProductCode",header:e("ViewShipment_FinishedProductCode"),editable:!1}),(0,D.jsx)(y.bQ.Column,{className:"compColHeight",field:"ShipmentCompartmentStatus",header:e("ViewShipment_Status"),editable:!1}),(0,D.jsx)(y.bQ.Column,{className:"compColHeight",field:"LoadedQuantityUOM",header:e("ViewShipmentStatus_LoadedQuantity"),editable:!1}),(0,D.jsx)(y.bQ.Column,{className:"compColHeight",header:e("SealMaster_SealNo"),renderer:e=>this.handleSealNoInput(e)})]})})]}),(0,D.jsxs)(g.Modal.Footer,{children:[(0,D.jsx)(g.Button,{content:e("MarineEOD_Close"),className:"cancelButton",onClick:this.props.handleSealClose}),(0,D.jsx)(g.Button,{type:"primary",content:e("SealMaster_Save"),disabled:this.isNodeEnterpriseOrWebortal(),onClick:this.updateSealCompartments})]})]})})})}}const T=(0,a.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(b)},24904:(e,t,s)=>{s.d(t,{y:()=>l});s(65043);var i=s(67907),a=s(72711),o=s(69062),n=s(70579);function l(e){let{terminalList:t,selectedTerminal:s,validationError:l,onFieldChange:r,onCheckChange:d}=e;return null===s&&(s=[]),(0,n.jsx)(i.TranslationConsumer,{children:e=>(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,n.jsx)("div",{style:{width:"80%"},children:(0,n.jsx)(a.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("TerminalCodes"),value:s,multiple:!0,options:o.Zj(t),onChange:e=>r("TerminalCodes",e),error:e(l),disabled:0===t.length,reserveSpace:!1})}),(0,n.jsx)("div",{className:"ddlSelectAll",children:(0,n.jsx)(a.Checkbox,{label:e("Common_All"),checked:Array.isArray(s)&&s.length===t.length,onChange:e=>d(e)})})]})})}l.defaultProps={terminalList:[],selectedTerminal:[],validationError:""}},82501:(e,t,s)=>{s.d(t,{I:()=>c});var i=s(65043),a=s(67907),o=s(72711),n=s(7523),l=s(78374),r=s(45127),d=s(728),h=s(70579);function c(e){let{ShipmentCode:t,auditTrailList:s,handleBack:d,modAuditTrailList:c,Attributes:m}=e;const p=null!==s&&void 0!==s&&s.length>0&&null!==s[0].DRIVERNAME&&void 0!==s[0].DRIVERNAME&&""!==s[0].DRIVERNAME?s[0].DRIVERNAME:"",u=null!==s&&void 0!==s&&s.length>0&&null!==s[0].DRIVERCODE&&void 0!==s[0].DRIVERCODE&&""!==s[0].DRIVERCODE?s[0].DRIVERCODE:"",C=e=>e===n.bw.EMPTY?"EMPTY":e===n.bw.LOADING?"LOADING":e===n.bw.PART_FILLED?"PART_FILLED":e===n.bw.OVER_FILLED?"OVER_FILLED":e===n.bw.FORCE_COMPLETED?"FORCE_COMPLETED":e===n.bw.COMPLETED?"COMPLETED":e===n.bw.INTERRUPTED?"INTERRUPTED":"",[S,g]=(0,i.useState)(!1),y=e=>{const t=e.rowData.AttributesforUI.filter((t=>t.AttributeName===e.name))[0];return t.DataType.toLowerCase()===n.pe.STRING.toLowerCase()||t.DataType.toLowerCase()===n.pe.INT.toLowerCase()||t.DataType.toLowerCase()===n.pe.LONG.toLowerCase()||t.DataType.toLowerCase()===n.pe.FLOAT.toLowerCase()?(0,h.jsx)("label",{children:t.AttributeValue}):t.DataType.toLowerCase()===n.pe.BOOL.toLowerCase()?(0,h.jsx)(o.Checkbox,{checked:"true"===t.AttributeValue.toString().toLowerCase(),disabled:!0}):(0,h.jsx)("label",{children:new Date(t.AttributeValue).toLocaleDateString()})},D=(e,t)=>{try{if(t.cls=null,e.fontSize="7px",t.val===n.g5.AUTO_LOADED)t.text=n.Mw.AUTO_LOADED;else if(t.val===n.g5.CHECKED_IN)t.text=n.Mw.CHECKED_IN;else if(t.val===n.g5.CLOSED)t.text=n.Mw.CLOSED;else if(t.val===n.g5.INTERRUPTED)t.text=n.Mw.INTERRUPTED;else if(t.val===n.g5.LOADING)t.text=n.Mw.LOADING;else if(t.val===n.g5.MANUALLY_LOADED)t.text=n.Mw.MANUALLY_LOADED;else if(t.val===n.g5.PARTIALLY_LOADED)t.text=n.Mw.PARTIALLY_LOADED;else if(t.val===n.g5.QUEUED)t.text=n.Mw.QUEUED;else if(t.val===n.g5.READY)t.text=n.Mw.READY;else if(t.val===n.g5.DE_QUEUED)t.text=n.Mw.DE_QUEUED;else if(t.val===n.g5.WEIGHED_IN)t.text=n.Mw.WEIGHED_IN;else if(t.val===n.g5.WEIGHED_OUT)t.text=n.Mw.WEIGHED_OUT;else if(t.val===n.g5.USER_DEFINED){let e=c.findIndex((e=>e.ShipmentStatus===t.val));t.text=-1!==e?c[e].Status:n.Mw.USER_DEFINED}else t.val===n.g5.ASSIGNED?t.text=n.Mw.ASSIGNED:t.val===n.g5.CANCELLED?t.text=n.Mw.CANCELLED:t.val===n.g5.EXPIRED?t.text=n.Mw.EXPIRED:t.val===n.g5.REJECTED&&(t.text=n.Mw.REJECTED)}catch(s){console.log("Error in formatter",s)}return t};return(0,h.jsxs)("div",{children:[(0,h.jsx)(a.TranslationConsumer,{children:e=>(0,h.jsx)("div",{children:(0,h.jsxs)("div",{className:"detailsContainer",children:[(0,h.jsxs)("div",{id:"printTable",children:[(0,h.jsx)("div",{className:"row",children:(0,h.jsx)("div",{className:"col-12",children:(0,h.jsx)("h3",{children:e("ViewAuditTrail_ViewAuditTrailForShipment")+" : "+t})})}),(0,h.jsx)("div",{className:" row marginRightZero tableScroll",children:(0,h.jsx)("div",{className:"col-12 container-fluid",children:(0,h.jsxs)(r.IO,{itemsSource:c,chartType:"Line",bindingX:"UpdatedTime",palette:["red"],style:{width:"100%",minWidth:"800px",height:"450px"},children:[(0,h.jsx)(r.tN,{position:"Bottom"}),(0,h.jsx)(r.vc,{wjProperty:"axisY",majorUnit:1,max:16,min:0,itemFormatter:D,axisLine:!0}),(0,h.jsx)(r.t3,{binding:"ShipmentStatus",name:"ShipmentStatus"})]})})}),(0,h.jsxs)("div",{className:"row marginRightZero",children:[(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)("label",{children:e("ViewAuditTrail_DriverCode")+" : "+u})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)("label",{children:e("DriverInfo_DriverName")+" : "+p})})]}),(0,h.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,h.jsx)("div",{className:"col-12 detailsTable ",children:(0,h.jsxs)(l.bQ,{data:s,scrollable:!0,children:[(0,h.jsx)(l.bQ.Column,{className:"compColHeight colminWidth",field:"Status",header:e("ViewAuditTrail_ShipmentStatus"),editable:!1,editFieldType:"text"},"Status"),(0,h.jsx)(l.bQ.Column,{className:"compColHeight colminWidth",field:"UpdatedTime",header:e("ViewAuditTrail_UpdatedTime"),editable:!1,editFieldType:"text"},"UpdatedTime"),(0,h.jsx)(l.bQ.Column,{className:"compColHeight colminWidth",header:e("ViewAuditTrail_ShipmentCompartmentSeq"),field:"CompartmentSeqNoInVehicle",editable:!1,editFieldType:"text"}),(0,h.jsx)(l.bQ.Column,{className:"compColHeight colminWidth",field:"ShipmentCompartmentStatus",header:e("ViewAuditTrail_ShipmentCompartmentStatus"),editable:!1,renderer:e=>C(e.rowData.ShipmentCompartmentStatus),editFieldType:"text"},"ShipmentCompartmentStatus"),(0,h.jsx)(l.bQ.Column,{className:"compColHeight colminWidth",header:e("ViewAuditTrail_DriverPIN"),editable:!1,field:"DriverPin",editFieldType:"text"}),m.map((t=>(0,h.jsx)(l.bQ.Column,{className:"compColHeight colminWidth",header:e(t.AttributeName),editable:!1,renderer:y})))]})})})]}),(0,h.jsxs)("div",{className:"row",children:[(0,h.jsx)("div",{className:"col-12 col-sm-6 col-lg-8",children:(0,h.jsx)(o.Button,{className:"backButton",onClick:d,content:e("Back")})}),(0,h.jsx)("div",{className:"col-12 col-sm-6 col-lg-4",style:{textAlign:"right"},children:(0,h.jsx)(o.Button,{className:"printButton",onClick:()=>{g(!0)},content:e("ViewAuditTrail_PrintAuditTrail")})})]})]})})}),(0,h.jsx)(a.TranslationConsumer,{children:e=>(0,h.jsx)(o.Modal,{open:S,className:"marineModalPrint",children:(0,h.jsxs)(o.Modal.Content,{children:[(0,h.jsxs)("div",{style:{display:"flex",flexWrap:"wrap"},children:[(0,h.jsx)("div",{className:"col col-lg-8",children:(0,h.jsx)("h3",{children:e("Transaction_AuditTrail_Heading")+" : "+t})}),(0,h.jsx)("div",{className:"col col-lg-4",style:{textAlign:"right"},children:(0,h.jsx)("div",{onClick:()=>{g(!1)},children:(0,h.jsx)(o.Icon,{root:"common",name:"close"})})})]}),(0,h.jsx)("div",{className:"col-md-10 container-fluid",children:(0,h.jsxs)(r.IO,{itemsSource:c,chartType:"Line",bindingX:"UpdatedTime",palette:["red"],style:{width:"100%",height:"450px"},children:[(0,h.jsx)(r.tN,{position:"Bottom"}),(0,h.jsx)(r.vc,{wjProperty:"axisY",majorUnit:1,max:16,min:0,itemFormatter:D,axisLine:!0}),(0,h.jsx)(r.t3,{binding:"ShipmentStatus",name:"ShipmentStatus"})]})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)("label",{children:e("ViewAuditTrail_DriverCode")+" : "+u})}),(0,h.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,h.jsx)("label",{children:e("DriverInfo_DriverName")+" : "+p})}),(0,h.jsx)("div",{className:"col-12 detailsTable",children:(0,h.jsxs)(l.bQ,{data:s,children:[(0,h.jsx)(l.bQ.Column,{className:"compColHeight",field:"Status",header:e("ViewAuditTrail_ShipmentStatus"),editable:!1,editFieldType:"text"},"Status"),(0,h.jsx)(l.bQ.Column,{className:"compColHeight",field:"UpdatedTime",header:e("ViewAuditTrail_UpdatedTime"),editable:!1,editFieldType:"text"},"UpdatedTime"),(0,h.jsx)(l.bQ.Column,{className:"compColHeight",header:e("ViewAuditTrail_ShipmentCompartmentSeq"),field:"CompartmentSeqNoInVehicle",editable:!1,editFieldType:"text"}),(0,h.jsx)(l.bQ.Column,{className:"compColHeight",field:"ShipmentCompartmentStatus",header:e("ViewAuditTrail_ShipmentCompartmentStatus"),editable:!1,renderer:e=>C(e.rowData.ShipmentCompartmentStatus),editFieldType:"text"},"ShipmentCompartmentStatus"),(0,h.jsx)(l.bQ.Column,{className:"compColHeight",header:e("ViewAuditTrail_DriverPIN"),editable:!1,field:"DriverPin",editFieldType:"text"}),m.map((t=>(0,h.jsx)(l.bQ.Column,{className:"compColHeight",header:e(t.AttributeName),editable:!1,renderer:y})))]})}),(0,h.jsxs)(o.Modal.Footer,{children:[(0,h.jsx)(o.Button,{type:"primary",size:"small",content:e("ViewAuditTrail_Print"),onClick:()=>{let e=window.document.getElementById("printTable").innerHTML;const t=window.document.createElement("IFRAME");let s=null;window.document.body.appendChild(t),s=t.contentWindow.document;const i=e.substring(0,e.indexOf("<table")+6),a=e.substring(e.indexOf("<table")+6,e.length);e=i+' border="1" cellspacing="1"'+a,s.write(e),s.close(),t.contentWindow.focus(),t.contentWindow.print(),setTimeout((()=>{window.document.body.removeChild(t)}),2e3)}}),(0,h.jsx)(o.Button,{type:"primary",size:"small",content:e("MarineEOD_Close"),onClick:()=>{g(!1)}})]})]})})})]})}d.setLicenseKey(n.yQ),c.defaultProps={}},2070:(e,t,s)=>{s.d(t,{f:()=>l});s(65043);var i=s(72711),a=s(78374),o=s(67907),n=s(70579);function l(e){let{ShipmentCode:t,modLoadingDetails:s,handleBack:l,expandedRows:r,toggleExpand:d,nonConfigColumns:h}=e;const[c]=(0,o.useTranslation)();return(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:"detailsContainer",children:[(0,n.jsx)("div",{className:"row",children:(0,n.jsx)("div",{className:"col col-md-8 col-lg-9 col col-xl-9",children:(0,n.jsx)("h3",{children:c("ViewShipment_ViewLoadingDetails")+" : "+t})})}),(0,n.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,n.jsx)("div",{className:"col-12 detailsTable",children:(0,n.jsxs)(a.bQ,{data:s.Table,scrollable:!0,rowExpansionTemplate:function(e){let t=[e],s=[];return h.includes("CalculatedGross","CalculatedNet","CalculatedValueUOM","FlowRate","NetStartTotalizer","NetEndTotalizer","LeakageTotalizer","DriverCode","VapourGrossQuantity","VapourNetQuantity","LoadingArmCode","PresetQuantity","ResetQuantity","Remarks")||(s=[e]),Array.isArray(t)&&t.length>0?(0,n.jsxs)("div",{className:"childTable ChildGridViewAllShipmentLoadingDetails",children:[(0,n.jsxs)(a.bQ,{data:t,children:[h.includes("productdensity")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"productdensity",header:c("LoadingDetails_ProductDensity"),editable:!1},"productdensity"),h.includes("weightinair")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"weightinair",header:c("LoadingDetails_WeightInAir"),editable:!1},"weightinair"),h.includes("weightinvacuum")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"weightinvacuum",header:c("LoadingDetails_WeightInVacuum"),editable:!1},"weightinvacuum"),h.includes("metercode")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"metercode",header:c("LoadingDetails_MeterCode"),editable:!1},"metercode"),h.includes("starttotalizer")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"starttotalizer",header:c("LoadingDetails_StartTotalizer"),editable:!1},"starttotalizer"),h.includes("endtotalizer")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"endtotalizer",header:c("LoadingDetails_EndTotalizer"),editable:!1},"endtotalizer"),h.includes("starttime")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"starttime",header:c("LoadingDetails_StartTime"),editable:!1},"starttime"),h.includes("endtime")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"endtime",header:c("LoadingDetails_EndTime"),editable:!1},"endtime"),h.includes("temperature")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"temperature",header:c("LoadingDetails_Temperature"),editable:!1},"temperature"),h.includes("pressure")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"pressure",header:c("LoadingDetails_Pressure"),editable:!1},"pressure")]}),s.map((e=>(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(a.bQ,{data:e,children:[h.includes("CalculatedGross")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"CalculatedGross",header:c("LoadingDetails_CalculatedGross"),editable:!1},"CalculatedGross"),h.includes("CalculatedNet")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"CalculatedNet",header:c("LoadingDetails_CalculatedNet"),editable:!1},"CalculatedNet"),h.includes("CalculatedValueUOM")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"CalculatedValueUOM",header:c("LoadingDetails_CalculatedValueUOM"),editable:!1},"CalculatedValueUOM"),h.includes("FlowRate")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"FlowRate",header:c("LoadingDetails_FlowRate"),editable:!1},"FlowRate"),h.includes("NetStartTotalizer")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"NetStartTotalizer",header:c("LoadingDetails_NetStartTotalizer"),editable:!1},"NetStartTotalizer"),h.includes("NetEndTotalizer")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"NetEndTotalizer",header:c("LoadingDetails_NetEndTotalizer"),editable:!1},"NetEndTotalizer"),h.includes("LeakageTotalizer")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"LeakageTotalizer",header:c("LoadingDetails_LeakageTotalizer"),editable:!1},"LeakageTotalizer"),h.includes("DriverCode")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"DriverCode",header:c("LoadingDetails_DriverCode"),editable:!1},"DriverCode"),h.includes("VapourGrossQuantity")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight",field:"VapourGrossQuantity",header:c("LoadingDetails_VapourGrossQuantity"),editable:!1},"VapourGrossQuantity")]})})))]}):(0,n.jsx)("div",{className:"compartmentIcon",children:(0,n.jsx)("div",{className:"gridButtonAlignLeft",children:c("CustomerInventory_NoRecordsFound")})})},scrollHeight:"320px",expandedRows:r,children:[h.includes("trailercode")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"trailercode",header:c("TrailerList_Code"),editable:!1,editFieldType:"text"},"trailercode"),h.includes("compartmentcode")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"compartmentcode",header:c("ShipmentCompDetail_wcCompartmentCode"),editable:!1},"compartmentcode"),h.includes("CompartmentSeqNoInVehicle")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",header:c("LoadingDetailsEntry_CompSeqNo"),field:"CompartmentSeqNoInVehicle",editable:!1},"CompartmentSeqNoInVehicle"),h.includes("productcode")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",field:"productcode",header:c("ProductAllocation_Product_Code"),editable:!1},"productcode"),h.includes("loadingdetailstype")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",header:c("LoadingDetails_LoadingDetailsType"),editable:!1,field:"loadingdetailstype"},"loadingdetailstype"),h.includes("tankcode")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",header:c("LoadingDetails_TankCode"),editable:!1,field:"tankcode"}),h.includes("baycode")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",header:c("LoadingDetails_BayCode"),editable:!1,field:"baycode"}),h.includes("bcucode")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",header:c("LoadingDetails_BCUCode"),editable:!1,field:"bcucode"}),h.includes("grossquantity")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",header:c("LoadingDetails_GrossQuantity"),editable:!1,field:"grossquantity"},"grossquantity"),h.includes("netquantity")?null:(0,n.jsx)(a.bQ.Column,{className:"compColHeight colminWidth",header:c("LoadingDetails_NetQuantity"),editable:!1,field:"netquantity"},"netquantity"),(0,n.jsx)(a.bQ.Column,{className:"expandedColumn",initialWidth:"50px",renderer:e=>{const t=r.findIndex((t=>t.seqNo===e.rowData.seqNo))>=0;return(0,n.jsx)("div",{onClick:()=>d(e.rowData,t),className:"compartmentIcon gridButtonFontColor",children:(0,n.jsx)(i.Icon,{root:"common",name:t?"slidercontrols-minus":"ellipsis-horizontal",className:"margin_l10"})})}})]})})}),(0,n.jsx)("div",{className:"row",children:(0,n.jsx)("div",{className:"col col-lg-8",children:(0,n.jsx)(i.Button,{className:"backButton",onClick:l,content:c("Back")})})})]})})}l.defaultProps={}}}]);
//# sourceMappingURL=4149.374160b7.chunk.js.map