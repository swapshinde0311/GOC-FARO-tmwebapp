"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[6826,1765],{76826:(e,t,s)=>{s.r(t),s.d(t,{default:()=>W});var i=s(65043),a=s(97508),o=s(72711),l=s(67907),r=s(78374),n=s(24904),c=s(35861),d=s(69062),h=s(7523),p=s(85800),u=s(65187),m=s(70579);function C(e){let{receipt:t,modReceipt:s,modAssociations:a,validationErrors:C,listOptions:g,searchResults:R,onFieldChange:S,onDateTextChange:y,onAllTerminalsChange:D,selectedAssociations:E,handleRowSelectionChange:A,handleCustomerSelectionChange:v,selectedCustomerInventory:b,handleCellDataEdit:x,handleCellCompartmentDataEdit:T,handleCustomerInventory:I,handleAddCustomerInventory:f,handleAddAssociation:w,handleDeleteAssociation:N,handleDeleteCustomerInventory:j,onActiveStatusChange:L,onVehicleChange:k,onSupplierChange:O,onVehicleSearchChange:V,onDriverChange:U,onDriverSearchChange:_,onVehicleResultsClear:B,onDriverResultsClear:P,isEnterpriseNode:M,IsWebPortalUser:W,onTabChange:F,activeTab:Q,expandedRows:q,toggleExpand:H,attributeToggleExpand:$,modCompartments:z,customerInventoryTab:G,modCustomerInventory:Y,compartmentTab:K,recordweightTab:J,selectedAttributeList:Z,attributeValidationErrors:X,handleAttributeCellDataEdit:ee,handleCompAttributeCellDataEdit:te,handleCellCheck:se,compartmentDetailsSave:ie,saveEnabled:ae,IsPastDisable:oe,SupplierEnable:le,isHSEInspectionEnable:re,isSlotbookinginUI:ne,compartmentDetailsPageSize:ce,isBonded:de,UpdateReceiptBondNo:he,modRecordWeight:pe,modCustomValues:ue,ReceiptBay:me,UpdateReceiptDriver:Ce,isWebportalCarrierRoleUser:ge}=e;const[Re]=(0,l.useTranslation)(),[Se,ye]=(0,i.useState)(!1),[De,Ee]=(0,i.useState)({}),Ae=(e,t)=>(0,m.jsx)(o.Select,{className:"selectDropwdown",value:a[e.rowIndex][e.field],fluid:!0,options:t,onChange:t=>x(t,e),indicator:"required",reserveSpace:!1,search:!0,noResultsMessage:Re("noResultsMessage")}),ve=e=>(0,m.jsx)(o.Input,{fluid:!0,value:a[e.rowIndex][e.field],onChange:t=>x(t,e),reserveSpace:!1}),be=(e,t)=>(0,m.jsx)(o.Select,{className:"selectDropwdown",value:Y[e.rowIndex][e.field],fluid:!0,options:t,onChange:t=>I(t,e),indicator:"required",reserveSpace:!1,search:!0,noResultsMessage:Re("noResultsMessage")}),xe=e=>{const{value:t}=e;return"number"===typeof t?t.toLocaleString():t};const Te=e=>{let t=e.field;return(0,m.jsx)(o.Input,{fluid:!0,disabled:s.ReceiptStatus===h.a$.CLOSED||s.ReceiptStatus===h.a$.READY||s.ReceiptStatus===h.a$.MANUALLY_UNLOADED,value:e.rowData[t],onChange:t=>T(t,e),reserveSpace:!1})};const Ie=e=>{const t=e.rowData,s=e=>{var t=e.split("-");return new Date(t[0],t[1]-1,t[2])},i=(e,t)=>{var s=new Date(t);t=s.getFullYear()+"-"+("0"+(s.getMonth()+1)).slice(-2)+"-"+("0"+s.getDate()).slice(-2),te(e,t)};try{return t.DataType.toLowerCase()===h.pe.STRING.toLowerCase()||t.DataType.toLowerCase()===h.pe.INT.toLowerCase()?(0,m.jsx)(o.Input,{fluid:!0,value:t.AttributeValue,disabled:t.IsReadonly,onChange:t=>te(e,t),reserveSpace:!1}):t.DataType.toLowerCase()===h.pe.FLOAT.toLowerCase()||t.DataType.toLowerCase()===h.pe.LONG.toLowerCase()||t.DataType.toLowerCase()===h.pe.DOUBLE.toLowerCase()?(0,m.jsx)(o.Input,{fluid:!0,value:null===t.AttributeValue||void 0===t.AttributeValue||""===t.AttributeValue?"":t.AttributeValue.toLocaleString(),disabled:t.IsReadonly,onChange:t=>te(e,t),reserveSpace:!1}):t.DataType.toLowerCase()===h.pe.BOOL.toLowerCase()?(0,m.jsx)(o.Checkbox,{checked:"true"===t.AttributeValue.toString().toLowerCase(),disabled:t.IsReadonly,onChange:t=>te(e,t)}):t.DataType.toLowerCase()===h.pe.DATETIME.toLowerCase()?(0,m.jsx)(o.DatePicker,{fluid:!0,value:null===t.AttributeValue||void 0===t.AttributeValue||""===t.AttributeValue?"":s(t.AttributeValue),disabled:t.IsReadonly,showYearSelector:"true",onChange:t=>i(e,t),onTextChange:t=>{i(e,t)},minuteStep:1,reserveSpace:!1}):null}catch(a){console.log("OrderDetails:Error occured on handleAttributeType",a)}},fe=e=>e.rowData.IsMandatory?(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{children:e.rowData.AttributeName}),(0,m.jsx)("div",{className:"ui red circular empty label badge  circle-padding"})]}):(0,m.jsx)("div",{children:(0,m.jsx)("span",{children:e.rowData.AttributeName})});const we=(e,t)=>{let s=[];return s=e.find((e=>e.TerminalCode===t)),s.attributeValidationErrors};return(0,m.jsxs)("div",{className:"detailsContainer",children:[(0,m.jsxs)("div",{className:"row",children:[(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Input,{fluid:!0,value:s.ReceiptCode,label:Re("Receipt_Code"),indicator:"required",disabled:""!==t.ReceiptCode,onChange:e=>S("ReceiptCode",e),error:Re(C.ReceiptCode),reserveSpace:!1})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4 planneddate",children:(0,m.jsx)(o.DatePicker,{fluid:!0,value:new Date(s.ScheduledDate),initialWidth:"160px",label:Re("Receipt_ArrivalDateTime"),displayFormat:(0,c.F1)(),type:"datetime",showYearSelector:"true",disablePast:!0!==oe,indicator:"required",minuteStep:1,onChange:e=>S("ScheduledDate",e),onTextChange:(e,t)=>{y("ScheduledDate",e,t)},error:Re(C.ScheduledDate),reserveSpace:!1,disabled:""!==t.ReceiptCode&&"TRUE"!==ue.ReceiptUpdateAllow})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Input,{fluid:!0,value:null===s.ReceiptStatus?"":s.ReceiptStatus,label:Re("Receipt_ReceiptStatus"),disabled:!0})}),t.ReceiptStatus===h.a$.READY&&""===t.ReceiptCode||M||!re?"":(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Input,{fluid:!0,value:s.HSEInspectionStatus,label:Re("Marine_ShipmentCompDetail_InspectionStatus"),reserveSpace:!1,disabled:!0})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Select,{fluid:!0,placeholder:Re("FinishedProductInfo_Select"),label:Re("Receipt_Vehicle"),value:null===s.VehicleCode?"":s.VehicleCode,options:g.vehicleOptions,onChange:e=>{k(e)},indicator:"required",search:!0,noResultsMessage:Re("noResultsMessage"),error:Re(C.VehicleCode),onSearch:V,reserveSpace:!1,disabled:""!==t.ReceiptCode&&"TRUE"!==ue.ReceiptUpdateAllow})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Input,{fluid:!0,value:null===s.CarrierCode?"":s.CarrierCode,label:Re("Receipt_CarrierCompany"),disabled:!0,error:Re(C.CarrierCode),reserveSpace:!1})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,m.jsx)(o.Select,{className:ge?"pr-2":"",fluid:!0,placeholder:Re("FinishedProductInfo_Select"),label:Re("Receipt_Driver"),value:null===s.DriverCode?"":s.DriverCode,options:(0,c.r4)(g.driverOptions,Re("Common_Select")),onChange:e=>{S("DriverCode",e)},search:!0,noResultsMessage:Re("noResultsMessage"),disabled:(!ge||"TRUE"!==ue.ReceiptUpdateAllow)&&(""!==t.ReceiptCode&&"TRUE"!==ue.ReceiptUpdateAllow),onSearch:_}),ge?(0,m.jsx)(o.Tooltip,{content:Re("ShipmentCompDetail_BtnSave"),element:(0,m.jsx)(o.Button,{className:"iconBtn mt-auto",type:"primary",onClick:()=>{Ce()},disabled:t.ReceiptStatus!==h.a$.READY,children:(0,m.jsx)(o.Icon,{root:"building",name:"save",size:"large",className:"mt-auto"})}),position:"left center",event:"hover",hoverable:!0}):""]})}),le?"":(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Select,{fluid:!0,placeholder:Re("FinishedProductInfo_Select"),label:Re("Receipt_Supplier"),value:s.SupplierCode,options:g.supplierOptions,onChange:e=>{O(e)},indicator:"required",search:!0,noResultsMessage:Re("noResultsMessage"),error:Re(C.SupplierCode),reserveSpace:!1,disabled:""!==t.ReceiptCode&&"TRUE"!==ue.ReceiptUpdateAllow})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Select,{fluid:!0,placeholder:Re("FinishedProductInfo_Select"),label:Re("Receipt_QuantityUOM"),value:null===s.ReceiptQuantityUOM?"":s.ReceiptQuantityUOM,options:g.quantityUOMOptions,onChange:e=>S("ReceiptQuantityUOM",e),indicator:"required",error:Re(C.ReceiptQuantityUOM),reserveSpace:!1,disabled:""!==t.ReceiptCode&&"TRUE"!==ue.ReceiptUpdateAllow,search:!0,noResultsMessage:Re("noResultsMessage")})}),""!==t.ReceiptCode&&t.ReceiptStatus!==h.a$.READY?(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Input,{fluid:!0,value:s.ActualTerminalCode,label:Re("Shipment_LoadedTerminal"),options:d.Zj([s.ActualTerminalCode]),reserveSpace:!1,disabled:!0,multiple:!0})}):"",(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Input,{fluid:!0,value:null===s.Description?"":s.Description,onChange:e=>S("Description",e),label:Re("Receipt_Desc"),error:Re(C.Description),reserveSpace:!1,disabled:""!==t.ReceiptCode&&"TRUE"!==ue.ReceiptUpdateAllow})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Select,{fluid:!0,placeholder:Re("FinishedProductInfo_Select"),label:Re("Receipt_Status"),value:s.Active,options:[{text:Re("Receipt_Active"),value:!0},{text:Re("Receipt_InActive"),value:!1}],onChange:e=>L(e),disabled:"READY"!==t.ReceiptStatus})}),(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Input,{fluid:!0,value:null===s.Remarks?"":s.Remarks,label:Re("Receipt_Remarks"),onChange:e=>S("Remarks",e),indicator:s.Active!==t.Active?"required":"",error:Re(C.Remarks),reserveSpace:!1,disabled:""!==t.ReceiptCode&&"TRUE"!==ue.ReceiptUpdateAllow})}),""!==t.ReceiptCode&&ne?(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4 ddlSelectAll",children:(0,m.jsxs)("div",{className:"ui single-input fluid disabled",children:[(0,m.jsx)("div",{className:"ui input-label",children:(0,m.jsx)("span",{className:"input-label-message",children:Re("ViewShipment_IsSlotBooked")})}),(0,m.jsx)("div",{className:"input-wrap",children:(0,m.jsx)("label",{style:{fontWeight:"bold"},children:s.SlotBooked?"Booked":"Not Booked"})})]})}):"",""!==t.ReceiptCode&&"READY"!==t.ReceiptStatus&&"CLOSE"!==t.ReceiptStatus&&null!==me&&""!==me&&void 0!==me?(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4 ddlSelectAll",children:(0,m.jsxs)("div",{className:"ui single-input fluid disabled",children:[(0,m.jsx)("div",{className:"ui input-label",children:(0,m.jsxs)("span",{className:"input-label-message",children:[Re("ViewAllocateBay_AllocateBay"),":"]})}),(0,m.jsx)("div",{className:"input-wrap",children:(0,m.jsx)("label",{style:{fontWeight:"bold"},children:me})})]})}):"",de?(0,m.jsxs)("div",{className:"col-12 col-md-6 col-lg-4",children:[(0,m.jsxs)("div",{className:"ui single-input fluid disabled",style:{width:"30%",float:"left"},children:[(0,m.jsx)("div",{class:"ui input-label",children:(0,m.jsx)("span",{className:"input-label-message",children:Re("VehicleInfo_Bonded")})}),(0,m.jsx)("div",{className:"input-wrap",children:(0,m.jsx)(o.Checkbox,{onChange:e=>S("IsBonded",e),checked:s.IsBonded,disabled:"READY"!==t.ReceiptStatus})})]}),s.IsBonded?(0,m.jsx)("div",{style:{width:"70%",float:"right"},children:(0,m.jsx)(o.Input,{fluid:!0,value:null===s.BondNo?"":s.BondNo,onChange:e=>S("BondNo",e),label:Re("RailDispatchPlanDetail_BondedNumber"),reserveSpace:!1})}):""]}):"",""!==t.ReceiptCode&&s.IsBonded&&de?(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(o.Button,{content:Re("ReceiptViewDetail_SaveReceiptBondNo"),onClick:he})}):"",M?(0,m.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,m.jsx)(n.y,{terminalList:g.terminalCodes,selectedTerminal:s.TerminalCodes,error:Re(C.TerminalCodes),onFieldChange:S,onCheckChange:D})}):""]}),Z.length>0?Z.map((e=>(0,m.jsx)(u.A,{children:(0,m.jsx)(o.Accordion,{children:(0,m.jsx)(o.Accordion.Content,{className:"attributeAccordian",title:M?e.TerminalCode+" - "+Re("Attributes_Header"):Re("Attributes_Header"),children:(0,m.jsx)(p.n,{selectedAttributeList:e.attributeMetaDataList,handleCellDataEdit:ee,attributeValidationErrors:we(X,e.TerminalCode)})})})}))):null,(0,m.jsx)("div",{className:"shipmentTabAlignment",children:(0,m.jsxs)(o.Tab,{activeIndex:Q,onTabChange:e=>{F(e)},children:[(0,m.jsxs)(o.Tab.Pane,{title:Re("Receipt_PlanHeader"),children:[(0,m.jsx)("div",{className:"row compartmentRow",children:(0,m.jsx)("div",{className:"col ",children:(0,m.jsxs)("div",{className:"compartmentIconContainer",children:[(0,m.jsxs)("div",{onClick:w,className:"compartmentIcon",children:[(0,m.jsx)("div",{children:(0,m.jsx)(o.Icon,{root:"common",name:"badge-plus",size:"medium"})}),(0,m.jsx)("div",{className:"margin_l10",children:(0,m.jsx)("h5",{className:"font14",children:Re("TrailerInfo_Add")})})]}),(0,m.jsxs)("div",{onClick:N,className:"compartmentIcon margin_l30",children:[(0,m.jsx)("div",{children:(0,m.jsx)(o.Icon,{root:"common",name:"delete",size:"medium"})}),(0,m.jsx)("div",{className:"margin_l10",children:(0,m.jsx)("h5",{className:"font14",children:Re("TrailerInfo_Delete")})})]})]})})}),(0,m.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,m.jsx)("div",{className:"col-12 detailsTable",children:(0,m.jsxs)(r.bQ,{data:a,selectionMode:"multiple",selection:E,onSelectionChange:A,scrollable:!0,scrollHeight:"320px",expandedRows:q,rowExpansionTemplate:function(e){return[].push("rowExpansionAtributeTemplate",e),Array.isArray(e.AttributesforUI)&&e.AttributesforUI.length>0?(0,m.jsx)("div",{className:"childTable ChildGridViewAllShipmentLoadingDetails",children:(0,m.jsxs)(r.bQ,{data:e.AttributesforUI,rows:ce,children:[M?(0,m.jsx)(r.bQ.Column,{className:"compColHeight",field:"TerminalCode",header:Re("CompartmentTerminal"),editable:!1},"TerminalCode"):"",(0,m.jsx)(r.bQ.Column,{className:"compColHeight",header:Re("CompartmentAttributeName"),renderer:fe,editable:!1},"AttributeName"),(0,m.jsx)(r.bQ.Column,{className:"compColHeight",header:Re("CompartmentAttributeValue"),renderer:Ie}),Array.isArray(e.AttributesforUI)&&e.AttributesforUI.length>ce?(0,m.jsx)(r.bQ.Pagination,{}):""]})}):(0,m.jsx)("div",{className:"compartmentIcon",children:(0,m.jsx)("div",{className:"gridButtonAlignLeft",children:Re("CustomerInventory_NoRecordsFound")})})},children:[(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"CompartmentSeqNoInVehicle",header:Re("Receipt_CompSeqInVehicle"),editable:""!==t.ReceiptCode&&"TRUE"===ue.ReceiptUpdateAllow,editFieldType:"text",customEditRenderer:e=>Ae(e,g.compSeqOptions)},"CompartmentSeqNoInVehicle"),(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"CompartmentCode",header:Re("Receipt_CompartmentCode"),editable:s.ReceiptStatus===h.a$.READY||"TRUE"===ue.ReceiptUpdateAllow,editFieldType:"text",customEditRenderer:e=>Ae(e,g.compSeqOptions)},"CompartmentCode"),(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"FinishedProductCode",header:Re("Receipt_Product"),editable:s.ReceiptStatus===h.a$.READY||"TRUE"===ue.ReceiptUpdateAllow,editFieldType:"text",customEditRenderer:e=>Ae(e,g.finishedProductOptions)},"FinishedProductCode"),le?(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"SupplierCode",header:Re("Receipt_Supplier"),editable:s.ReceiptStatus===h.a$.READY||"TRUE"===ue.ReceiptUpdateAllow,editFieldType:"text",customEditRenderer:e=>Ae(e,g.supplierOptions)},"SupplierCode"):"",le?(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"OriginTerminalCode",header:Re("OriginTerminal"),editable:s.ReceiptStatus===h.a$.READY||"TRUE"===ue.ReceiptUpdateAllow,editFieldType:"text",customEditRenderer:e=>(e=>{let t=[];return void 0!==g.supplierOriginOptions&&null!==g.supplierOriginOptions&&void 0!==g.supplierOriginOptions[e.rowData.SupplierCode]&&Array.isArray(g.supplierOriginOptions[e.rowData.SupplierCode])&&g.supplierOriginOptions[e.rowData.SupplierCode].forEach((e=>t.push({text:e,value:e}))),Ae(e,t)})(e,g.originalterminalOptions)},"OriginTerminalCode"):(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"OriginTerminalCode",header:Re("OriginTerminal"),editable:s.ReceiptStatus===h.a$.READY||"TRUE"===ue.ReceiptUpdateAllow,editFieldType:"text",customEditRenderer:e=>(e=>{let t=[];return void 0!==g.supplierOriginOptions&&null!==g.supplierOriginOptions&&void 0!==g.supplierOriginOptions[s.SupplierCode]&&Array.isArray(g.supplierOriginOptions[s.SupplierCode])&&g.supplierOriginOptions[s.SupplierCode].forEach((e=>t.push({text:e,value:e}))),Ae(e,t)})(e,g.originalterminalOptions)},"OriginTerminalCode"),(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"Quantity",header:Re("Receipt_Quantity"),editable:s.ReceiptStatus===h.a$.READY||"TRUE"===ue.ReceiptUpdateAllow,editFieldType:"text",renderer:e=>xe(e),customEditRenderer:ve},"Quantity"),(0,m.jsx)(r.bQ.Column,{className:"expandedColumn",initialWidth:"200px",renderer:e=>{const t=q.findIndex((t=>t.CompartmentSeqNoInTrailer===e.rowData.CompartmentSeqNoInTrailer))>=0;return(0,m.jsxs)("div",{onClick:()=>$(e.rowData,t),className:"compartmentIcon gridButtonFontColor",children:[(0,m.jsx)("span",{children:Re(t?"Hide_Attributes":"View_Attributes")}),(0,m.jsx)(o.Icon,{root:"common",name:t?"caret-up":"caret-down",className:"margin_l10"})]})}})]})})})]}),K?(0,m.jsxs)(o.Tab.Pane,{title:Re("ViewReceiptList_CompartmentDetails"),children:[" ",(0,m.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,m.jsx)("div",{className:"col-12 detailsTable",children:(0,m.jsxs)(r.bQ,{data:z,rowExpansionTemplate:function(e){let t=[];return t.push(e),Array.isArray(t)&&t.length>0?(0,m.jsx)("div",{className:"ChildGridViewAllShipmentLoadingDetails",children:(0,m.jsxs)(r.bQ,{data:t,children:[(0,m.jsx)(r.bQ.Column,{className:"compColHeight",field:"revisedplannedquantity",header:Re("ViewReceiptList_AdjustPlannedQuantity"),editable:!1,renderer:e=>xe(e),customEditRenderer:ve},"revisedplannedquantity"),(0,m.jsx)(r.bQ.Column,{className:"compColHeight",field:"AdjustedQuantity",header:Re("ViewShipment_AdjustmentToPlannedQuantity"),renderer:Te},"AdjustedQuantity"),(0,m.jsx)(r.bQ.Column,{className:"compColHeight",field:"UnLoadedQuantity",header:Re("ViewMarineReceiptList_UnloadedQuantity"),editable:!1,editFieldType:"text",renderer:e=>xe(e),customEditRenderer:ve},"UnLoadedQuantity")]})}):""},scrollable:!0,scrollHeight:"320px",expandedRows:q,children:[(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"TrailerCode",header:Re("ViewReceipt_TrailerCode"),editable:!0,editFieldType:"text"},"TrailerCode"),(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"CompartmentCode",header:Re("Receipt_CompartmentCode"),editable:s.ReceiptStatus===h.a$.READY,editFieldType:"text",customEditRenderer:e=>Ae(e,g.compSeqOptions)},"CompartmentCode"),(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"FinishedProductCode",header:Re("Receipt_Product"),editable:s.ReceiptStatus===h.a$.READY,editFieldType:"text"},"FinishedProductCode"),(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"Quantity",header:Re("ViewReceipt_Quantity"),editable:s.ReceiptStatus===h.a$.READY,editFieldType:"text",renderer:e=>xe(e),customEditRenderer:ve},"Quantity"),(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"CompartmentStaus",header:Re("ViewCompartment_Status"),editable:!1,renderer:e=>{return(t=e.rowData.CompartmentStaus)===h.gB.EMPTY?"EMPTY":t===h.gB.UNLOADING?"UNLOADING":t===h.gB.PART_UNLOADED?"PART_UNLOADED":t===h.gB.OVER_UNLOADED?"OVER_UNLOADED":t===h.gB.FORCE_COMPLETED?"FORCE_COMPLETED":t===h.gB.COMPLETED?"COMPLETED":t===h.gB.UNLOAD_NOTSTARTED?"UNLOAD_NOTSTARTED":"";var t},customEditRenderer:ve},"CompartmentStaus"),(0,m.jsx)(r.bQ.Column,{className:"compColHeight",initialWidth:"100px",header:Re("ViewShipment_ForceComplete"),renderer:e=>{let t=!1;return null===e.rowData.CompartmentStaus&&void 0===e.rowData.CompartmentStaus||(t=h.a$[s.ReceiptStatus]===h.a$.CLOSED||h.gB[e.rowData.CompartmentStaus]===h.gB.COMPLETED||h.gB[e.rowData.CompartmentStaus]===h.gB.UNLOADING||h.gB[e.rowData.CompartmentStaus]===h.gB.FORCE_COMPLETED),(0,m.jsx)("div",{style:{textAlign:"center"},children:(0,m.jsx)(o.Checkbox,{className:"forceCompleteChkBox",checked:e.rowData.ForceCompleted,disabled:(null!==e.rowData.CompartmentStaus||void 0!==e.rowData.CompartmentStaus)&&t,onChange:t=>{Ee(e),t?ye(!0):se(e,t)}})})}}),(0,m.jsx)(r.bQ.Column,{className:"expandedColumn",initialWidth:"50px",renderer:e=>{const t=q.findIndex((t=>t.SeqNumber===e.rowData.SeqNumber))>=0;return(0,m.jsx)("div",{onClick:()=>H(e.rowData,t),className:"compartmentIcon gridButtonFontColor",children:(0,m.jsx)(o.Icon,{root:"common",name:t?"slidercontrols-minus":"ellipsis-horizontal",className:"margin_l10"})})}})]})})}),(0,m.jsx)("div",{className:"row",children:(0,m.jsx)("div",{className:"col col-lg-4"})})]}):[],G?(0,m.jsx)(o.Tab.Pane,{title:Re("CustomerInventory_Plan"),children:(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{className:"row compartmentRow",children:(0,m.jsx)("div",{className:"col ",children:(0,m.jsxs)("div",{className:"compartmentIconContainer",children:[(0,m.jsxs)("div",{onClick:f,className:"compartmentIcon",children:[(0,m.jsx)("div",{children:(0,m.jsx)(o.Icon,{root:"common",name:"badge-plus",size:"medium"})}),(0,m.jsx)("div",{className:"margin_l10",children:(0,m.jsx)("h5",{className:"font14",children:Re("TrailerInfo_Add")})})]}),(0,m.jsxs)("div",{onClick:j,className:"compartmentIcon margin_l30",children:[(0,m.jsx)("div",{children:(0,m.jsx)(o.Icon,{root:"common",name:"delete",size:"medium"})}),(0,m.jsx)("div",{className:"margin_l10",children:(0,m.jsx)("h5",{className:"font14",children:Re("TrailerInfo_Delete")})})]})]})})}),(0,m.jsx)("div",{className:"row marginRightZero",children:(0,m.jsx)("div",{className:"col-12 detailsTable",children:(0,m.jsxs)(r.bQ,{data:Y,scrollable:!0,scrollHeight:"320px",selectionMode:"multiple",selection:b,onSelectionChange:v,children:[(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"CustomerCode",header:Re("Customer_Code"),editable:s.ReceiptStatus===h.a$.READY||"TRUE"===ue.ReceiptUpdateAllow,editFieldType:"text",renderer:e=>xe(e),customEditRenderer:e=>be(e,g.customerOptions)},"CustomerCode"),(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"FinishedProductCode",header:Re("Receipt_Product"),editable:s.ReceiptStatus===h.a$.READY||"TRUE"===ue.ReceiptUpdateAllow,editFieldType:"text",renderer:e=>xe(e),customEditRenderer:e=>be(e,g.finishedProductOptions)},"FinishedProductCode"),(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"PlannedQuantity",editable:s.ReceiptStatus===h.a$.READY||"TRUE"===ue.ReceiptUpdateAllow,editFieldType:"text",renderer:e=>xe(e),customEditRenderer:e=>(0,m.jsx)(o.Input,{fluid:!0,value:Y[e.rowIndex][e.field],onChange:t=>I(t,e),reserveSpace:!1}),header:Re("ViewShipmentCompartment_PlannedQuantity")},"PlannedQuantity")]})})})]})}):[],J?(0,m.jsxs)(o.Tab.Pane,{title:Re("ViewReceiptList_RecordWeight"),children:[" ",(0,m.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,m.jsx)("div",{className:"col-12 detailsTable",children:(0,m.jsxs)(r.bQ,{data:pe,scrollable:!0,scrollHeight:"320px",children:[(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"WeighbridgeCode",header:Re("ReceiptByCompartmentList_WeightBridgeCode"),editable:!1,editFieldType:"text"},"WeighbridgeCode"),(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"MeasuredWeight",header:Re("ReceiptByCompartmentList_Weight"),editable:!1},"MeasuredWeight"),(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"weight",header:Re("ReceiptByCompartmentList_WeightType"),editable:!1},"weight"),(0,m.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"MeasuredWeightTime",header:Re("ReceiptByCompartmentList_WeightDatetime"),editable:!1},"MeasuredWeightTime")]})})}),(0,m.jsx)("div",{className:"row",children:(0,m.jsx)("div",{className:"col col-lg-4"})})]}):[]]})}),(0,m.jsxs)(o.Modal,{open:Se,size:"small",children:[(0,m.jsx)(o.Modal.Content,{children:(0,m.jsx)("div",{children:(0,m.jsx)("b",{children:Re("ForceToComplete")})})}),(0,m.jsxs)(o.Modal.Footer,{children:[(0,m.jsx)(o.Button,{type:"secondary",content:Re("Cancel"),onClick:()=>{ye(!1),se(De,!1)}}),(0,m.jsx)(o.Button,{type:"primary",content:Re("Confirm"),onClick:()=>{ye(!1),se(De,!0)}})]})]})]})}C.defaultProps={listOptions:{quantityUOMOptions:[],vehicleOptions:[],terminalCodes:[],driverOptions:[],supplierOriginOptions:[],originalterminalOptions:[],compSeqOptions:[],finishedProductOptions:[],baseProductCode:[],supplierOptions:[],customerCode:[],baseProductOptions:[],customerOptions:[]},isEnterpriseNode:!1,IsWebPortalUser:!1,isSlotbookinginUI:!1,isBonded:!1,ReceiptBay:""};var g=s(61227),R=s(44192),S=s(28882),y=s(9256),D=s(43503),E=s(40252),A=s(53536),v=s.n(A),b=s(80312),x=s(46100),T=s(40854),I=s.n(T),f=s(93779),w=s(72067),N=s(11981),j=s(14159),L=s(67271),k=s(67982),O=s(80221),V=s(15417),U=s(40510),_=s(39424),B=s(61765),P=s(62900);class M extends i.Component{constructor(){var e;super(...arguments),e=this,this.state={receipt:{},modReceipt:{},modAssociations:[],modCompartments:[],modCustomerInventory:[],vehicleDetails:{carrierCode:"",vehicleCompartments:[]},modVehicleDetails:{carrierCode:"",vehicleCompartments:[]},validationErrors:d.Th(R.rW),isReadyToRender:!1,saveEnabled:!1,selectedAssociations:[],selectedCustomerInventory:[],vehicleOptions:[],driverOptions:[],quantityUOMOptions:[],finishedProductOptions:[],baseProductCodeOptions:[],compSeqOptions:[],supplierOriginTerminalsList:[],vehicleSearchOptions:[],driverSearchOptions:[],isPlanned:!1,activeTab:0,shipmentNextOperations:[],currentReceiptStatus:[],isManualEntry:!1,expandedRows:[],customerInventoryTab:!1,customerptions:[],customerInventory:[],customerCode:[],baseProductOptions:[],customerOptions:[],compartmentTab:!1,auditTrailList:[],modAuditTrailList:[],ModViewUnloadDetails:[],attributeMetaDataList:[],attributeValidationErrors:[],selectedAttributeList:[],supplierOptions:[],receiptCompartmentDetails:[],forceCompleteIsDisable:!1,IsPastDisable:!1,SupplierEnable:!1,isHSEInspectionEnable:!1,drawerStatus:!0===this.props.userDetails.EntityResult.IsWebPortalUser,compartmentAttributeMetaDataList:[],isRecordWeight:!1,isSealCompartments:!1,sealCompartments:[],recordWeightList:[],weighBridgeCode:"",scadaValue:"",allowOutofRangeTW:!1,isBonded:!1,bondExpiryDate:null,isVehicleBonded:!1,vehicleBondPopUp:!1,vehicleBondExpiryPopUp:!1,stockProducts:!1,loadingExpandedRows:[],recordweightTab:!1,customerinventoryChange:!1,compartmentChange:!1,modRecordWeight:[],isCloseReceipt:!1,reasonForClosure:"",modCustomValues:{},truckReceiptKPIList:[],showReceiptAuthenticationLayout:!1,showAuthorizeToUnLoadAuthenticationLayout:!1,showAllowToUnLoadAuthenticationLayout:!1,showCloseReceiptAuthenticationLayout:!1,showViewBODAuthenticationLayout:!1,showPrintBODAuthenticationLayout:!1,showRANAuthenticationLayout:!1,tempReceipt:{},isAllocateBay:!1,bayData:[],selectBay:[],isDeAllocateBay:!1,ReceiptBay:""},this.handleSaveReceipt=()=>{try{this.setState({saveEnabled:!1});let e=v().cloneDeep(this.state.tempReceipt);""===this.state.receipt.ReceiptCode?this.createReceipt(e):this.updateReceipt(e)}catch(e){console.log("Receipt Details Composite : Error in handleSaveReceipt")}},this.saveReceipt=()=>{let e=v().cloneDeep(this.state.modReceipt);e.ReceiptOriginTerminalCompartmentsInfo=this.fillDetails(this.state.modAssociations),e.CustomerInventoryPlanList=this.fillCustomerInvetoryDetails(this.state.modCustomerInventory);let t=d.pI(this.state.selectedAttributeList);if(this.validateSave(e,t)){e=this.convertStringtoDecimal(e,t);let s=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,i=v().cloneDeep(e);this.setState({showReceiptAuthenticationLayout:s,tempReceipt:i},(()=>{!1===s&&this.handleSaveReceipt()}))}else this.setState({saveEnabled:!0})},this.handleSave=()=>{try{const e=this.handleSaveCompartmentDetailsEnabled();let t=v().cloneDeep(this.state.receipt);if(1===v().cloneDeep(this.state.activeTab)&&t.ReceiptStatus!==h.a$.READY&&""!==t.ReceiptCode&&e)this.compartmentDetailsSave();else{v().cloneDeep(this.state.modReceipt).IsBonded?this.state.isVehicleBonded?""!==this.state.bondExpiryDate&&null!==this.state.bondExpiryDate&&void 0!==this.state.bondExpiryDate&&this.setState({vehicleBondExpiryPopUp:!0}):this.setState({vehicleBondPopUp:!0}):this.saveReceipt()}}catch(e){console.log("TruckReceiptDetailsComposite:Error occured on handleSave",e)}},this.handleDriverChange=e=>{try{let t=v().cloneDeep(this.state.modReceipt);t.DriverCode=e;let s=v().cloneDeep(this.state.validationErrors);s.DriverCode="",this.setState({validationErrors:s,modReceipt:t})}catch(t){console.log("TruckReceiptDetailsComposite:Error occured on handleDriverChange",t)}},this.handleSealClose=()=>{this.setState({isSealCompartments:!1,sealCompartments:[]})},this.handleDriverSearchChange=e=>{let t=v().cloneDeep(this.state.driverOptions);try{let s=t.filter((t=>t.value.toLowerCase().includes(e.toLowerCase())));s.length>h.bM&&(s=s.slice(0,h.bM)),this.setState({driverSearchOptions:s})}catch(s){console.log(":Error occured on handleDriverSearchChange",s)}},this.handleVehicleChange=e=>{try{this.getVehicle(e,!0);let t=v().cloneDeep(this.state.validationErrors);t.VehicleCode="",this.setState({validationErrors:t})}catch(t){console.log("TruckReceiptDetailsComposite::Error occured on handleVehicleChange",t)}},this.handleDriverResultsClear=()=>{try{let e=v().cloneDeep(this.state.modReceipt),t=v().cloneDeep(this.state.validationErrors);t.DriverCode="",e.DriverCode="",this.setState({validationErrors:t,modReceipt:e})}catch(e){console.log("TruckReceiptDetailsComposite:Error occured on handleDriverResultsClear",e)}},this.handleVehicleSearchChange=e=>{try{let t=this.state.vehicleOptions.filter((t=>t.value.toLowerCase().includes(e.toLowerCase())));t.length>h.bM&&(t=t.slice(0,h.bM)),this.setState({vehicleSearchOptions:t})}catch(t){console.log(this.props.ShipmentType+":Error occured on handleVehicleSearchChange",t)}},this.handleVehicleResultsClear=()=>{try{let e=v().cloneDeep(this.state.modReceipt),t=v().cloneDeep(this.state.validationErrors),s=[],i=[],a={carrierCode:"",vehicleCompartments:[]};t.VehicleCode="ShipmentCompDetail_MandatoryVehicle",e.VehicleCode=null,e.CarrierCode=null,this.setState({validationErrors:t,modReceipt:e,modAssociations:s,compSeqOptions:i,modVehicleDetails:a})}catch(e){console.log("ShipmentByCompartmentComposite:Error occured on handleVehicleResultsClear",e)}},this.handleActiveStatusChange=e=>{try{let t=v().cloneDeep(this.state.modReceipt);t.Active=e,t.Active!==this.state.receipt.Active&&(t.Remarks=""),this.setState({modReceipt:t})}catch(t){console.log(t)}},this.handleAddAssociation=()=>{let e=v().cloneDeep(this.state.modReceipt);if(!this.props.userDetails.EntityResult.IsArchived&&"READY"===e.ReceiptStatus)try{if(this.state.modAssociations.length<this.state.modVehicleDetails.vehicleCompartments.length){let t=v().cloneDeep(this.state.modAssociations),s={CompartmentCode:null,CompartmentSeqNoInVehicle:null,CompartmentSeqNoInTrailer:null,Quantity:null,QuantityUOM:"",FinishedProductCode:"",ShareholderCode:this.props.selectedShareholder,Attributes:[],OriginTerminalCode:"",SupplierCode:"",TrailerCode:""};s.SeqNumber=d.Mz(t),t.push(s),this.setState({modAssociations:t,selectedAssociations:[]},(()=>{if(!1===this.props.userDetails.EntityResult.IsEnterpriseNode){var t=v().cloneDeep(this.state.compartmentAttributeMetaDataList);t.length>0&&this.formCompartmentAttributes([t[0].TerminalCode])}else this.formCompartmentAttributes(e.TerminalCodes)}))}}catch(t){console.log("TruckReceiptDetailsComposite:Error occured on handleAddCompartment",t)}},this.handleDeleteAssociation=()=>{if(!this.props.userDetails.EntityResult.IsArchived)try{if(null!=this.state.selectedAssociations&&this.state.selectedAssociations.length>0&&this.state.modAssociations.length>0){let e=v().cloneDeep(this.state.modAssociations);this.state.selectedAssociations.forEach(((t,s)=>{e=e.filter(((e,s)=>e.SeqNumber!==t.SeqNumber))})),this.setState({modAssociations:e,selectedAssociations:[]})}}catch(e){console.log("RigidtruckDetailsComposite:Error occured on handleDeleteCompartment",e)}},this.handleReset=()=>{try{let t=v().cloneDeep(this.state.vehicleDetails);var e=v().cloneDeep(this.state.receipt);let s=[],i=[],a=[],o=[];""===this.state.receipt.ReceiptCode?(s=[],i=[],a=[]):(s=this.getReceiptCompartmentFromReceipt(this.state.receipt),a=this.getReceiptCustomerInventory(this.state.receipt),o=this.getReceiptCompartmentDetails(this.state.receipt),t.vehicleCompartments.forEach((e=>i.push({text:e.vehCompSeq,value:e.vehCompSeq})))),this.setState({modReceipt:v().cloneDeep(this.state.receipt),validationErrors:[],modVehicleDetails:v().cloneDeep(this.state.vehicleDetails),modAssociations:s,compSeqOptions:i,modCompartments:o,modCustomerInventory:a},(()=>{this.props.userDetails.EntityResult.IsEnterpriseNode?(this.terminalSelectionChange(e.TerminalCodes),this.handleResetAttributeValidationError()):(this.localNodeAttribute(),this.handleResetAttributeValidationError())}))}catch(t){console.log("TruckReceiptDetailsComposite:Error occured on handleReset",t)}},this.handleAllTerminalsChange=e=>{try{var t=[...this.props.terminalCodes],s=v().cloneDeep(this.state.modReceipt);s.TerminalCodes=e?[...t]:[],this.setState({modReceipt:s}),this.terminalSelectionChange(s.TerminalCodes)}catch(i){console.log("TruckReceiptDetailsComposite:Error occured on handleAllTerminasChange",i)}},this.handleAssociationSelectionChange=e=>{this.setState({selectedAssociations:e})},this.handleSupplierChange=e=>{const t=v().cloneDeep(this.state.modReceipt);t.SupplierCode=e;let s=v().cloneDeep(this.state.validationErrors);s.SupplierCode="",this.setState({validationErrors:s});const i=v().cloneDeep(this.state.modAssociations);let a=this.state.supplierOriginTerminalsList;void 0!==a&&null!==a&&(void 0!==a[e]&&Array.isArray(a[e])&&1===a[e].length?i.forEach((t=>{t.OriginTerminalCode=a[e][0]})):i.forEach((e=>{e.OriginTerminalCode=""}))),this.setState({modReceipt:t,modAssociations:i})},this.UpdateReceiptBondNo=()=>{try{var e=[{key:f.ml,value:this.state.receipt.ReceiptCode},{key:f.zL,value:this.state.modReceipt.BondNo}],t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:f.ml,KeyCodes:e};let s={messageType:"critical",message:"ReceiptBondUpdate_Status",messageResultDetails:[{keyFields:["ReceiptCode"],keyValues:[this.state.modReceipt.ReceiptCode],isSuccess:!1,errorMessage:""}]};I()(w.PZS,d.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;s.messageType=t.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getReceipt({Common_Code:this.state.modReceipt.ReceiptCode}):(s.messageResultDetails[0].errorMessage=t.ErrorList[0],console.log("Error in UpdateReceipt:",t.ErrorList)),(0,j.toast)((0,m.jsx)(u.A,{children:(0,m.jsx)(N.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4})})).catch((e=>{console.log("Error while OverrideShipmentSequence:",e)}))}catch(s){console.log("Error while Updating ShipmentSequence:",s)}},this.UpdateReceiptDriver=()=>{try{var e=[{key:f.ml,value:this.state.receipt.ReceiptCode},{key:f.qF,value:this.state.modReceipt.DriverCode}],t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:f.ml,KeyCodes:e};let s={messageType:"critical",message:"DriverCode_UpdateStatus",messageResultDetails:[{keyFields:["ReceiptCode"],keyValues:[this.state.receipt.ReceiptCode],isSuccess:!1,errorMessage:""}]};I()(w.Sr4,d.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;s.messageType=t.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getReceipt({Common_Code:this.state.receipt.ReceiptCode},0,s):(s.messageResultDetails[0].errorMessage=t.ErrorList[0],(0,j.toast)((0,m.jsx)(u.A,{children:(0,m.jsx)(N.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4}),console.log("Error Receipt Driver Update:",t.ErrorList))})).catch((e=>{console.log("Error while Receipt Driver Update:",e)}))}catch(s){console.log("Error while Receipt Driver Update:",s)}},this.handleChange=(e,t)=>{try{const i=v().cloneDeep(this.state.modReceipt);if(i[e]=t,this.setState({modReceipt:i}),void 0!==R.rW[e]){var s={...this.state.validationErrors};s[e]=d.jr(R.rW[e],t),this.setState({validationErrors:s})}"IsBonded"===e&&(i.BondNo=""),"TerminalCodes"===e&&this.terminalSelectionChange(t)}catch(i){console.log("TruckReceiptDetailsComposite:Error occured on handleChange",i)}},this.handleDateTextChange=(e,t,s)=>{try{var i={...this.state.validationErrors},a=v().cloneDeep(this.state.modReceipt);i[e]=s,a[e]=t,this.setState({validationErrors:i,modReceipt:a})}catch(s){console.log("TruckReceiptDetailsComposite:Error occured on handleDateTextChange",s)}},this.handleCellCheck=(e,t)=>{let s=v().cloneDeep(this.state.modCompartments),i=v().cloneDeep(this.state.expandedRows);const a=s.findIndex((t=>t.SeqNumber===e.rowData.SeqNumber));a>-1&&(s[a].ForceCompleted=t);let o=i.findIndex((t=>t.SeqNumber===e.rowData.SeqNumber));o>=0&&i.splice(o,1),this.setState({modCompartments:s}),this.toggleExpand(s[e.rowIndex],!1)},this.handleCellDataEdit=(e,t)=>{let s=v().cloneDeep(this.state.modAssociations);if(s[t.rowIndex][t.field]=e,"CompartmentSeqNoInVehicle"===t.field){let i=this.state.modVehicleDetails.vehicleCompartments.filter((t=>t.vehCompSeq.toString()===e.toString())),a=v().cloneDeep(this.state.supplierOriginTerminalsList),o=v().clone(this.state.supplierOptions);i.length>0&&(s[t.rowIndex].Quantity=null!==i[0].SFL&&""!==i[0].SFL?i[0].SFL.toLocaleString():null,s[t.rowIndex].TrailerCode=i[0].trailerCode,s[t.rowIndex].CompartmentCode=i[0].compCode,s[t.rowIndex].QuantityUOM=i[0].UOM,s[t.rowIndex].OriginTerminalCode=Array.isArray(a[this.state.modReceipt.SupplierCode])&&1===a[this.state.modReceipt.SupplierCode].length?a[this.state.modReceipt.SupplierCode][0]:"",s[t.rowIndex].SupplierCode=Array.isArray(o[this.state.modReceipt.SupplierCode])&&1===o[this.state.modReceipt.SupplierCode].length?o[this.state.modReceipt.SupplierCode]:""),this.attributeToggleExpand(s[t.rowIndex],!0,!0)}this.setState({modAssociations:s})},this.handleCellCompartmentDataEdit=(e,t)=>{let s=v().cloneDeep(this.state.modCompartments);const i=s.findIndex((e=>e.SeqNumber===t.rowData.SeqNumber));if(i>-1){s[i][t.field]=e,this.setState({modCompartments:s});let a=v().cloneDeep(this.state.expandedRows),o=a.findIndex((e=>e.SeqNumber===t.rowData.SeqNumber));o>=0&&(a.splice(o,1),this.setState({expandedRows:a})),this.toggleExpand(s[i],!1)}},this.handleCustomerInventory=(e,t)=>{let s=v().cloneDeep(this.state.modCustomerInventory);s[t.rowIndex][t.field]=e,this.setState({modCustomerInventory:s})},this.handleCustomerSelectionChange=e=>{this.setState({selectedCustomerInventory:e})},this.handleAddCustomerInventory=()=>{let e=v().cloneDeep(this.state.modReceipt);if(!this.props.userDetails.EntityResult.IsArchived&&"READY"===e.ReceiptStatus)try{if(this.state.modCustomerInventory.length<this.state.customerOptions.length){let e=v().cloneDeep(this.state.modCustomerInventory),t={ShareholderCode:this.props.selectedShareholder,CustomerCode:"",FinishedProductCode:"",PlannedQuantity:""};t.SeqNumber=d.Mz(e),1===this.state.customerOptions.length&&(t.CustomerCode=this.state.customerOptions[0].value),e.push(t),this.setState({modCustomerInventory:e,selectedCustomerInventory:[]})}}catch(t){console.log("TruckReceiptDetailsComposite:Error occured on handleAddCustomerinventory",t)}},this.handleDeleteCustomerInventory=()=>{if(!this.props.userDetails.EntityResult.IsArchived)try{if(null!=this.state.selectedCustomerInventory&&this.state.selectedCustomerInventory.length>0&&this.state.modCustomerInventory.length>0){let e=v().cloneDeep(this.state.modCustomerInventory);this.state.selectedCustomerInventory.forEach(((t,s)=>{e=e.filter(((e,s)=>e.CustomerCode!==t.CustomerCode))})),this.setState({modCustomerInventory:e,selectedCustomerInventory:[]})}this.setState({selectedCustomerInventory:[]})}catch(e){console.log("TruckReceiptDetailsComposite:Error occured on handleDeleteCCustomerinventory",e)}},this.handleSaveCompartmentDetailsEnabled=()=>{const{modReceipt:e}=this.state;return e.ReceiptStatus===h.a$.PARTIALLY_UNLOADED||e.ReceiptStatus===h.a$.INTERRUPTED||e.ReceiptStatus===h.a$.AUTO_UNLOADED||e.ReceiptStatus===h.a$.QUEUED||e.ReceiptStatus===h.a$.CHECKED_IN},this.compartmentDetailsSave=()=>{let e=v().cloneDeep(this.state.modCompartments),t=v().cloneDeep(this.state.modReceipt),s=v().cloneDeep(this.state.modCompartments),i=v().cloneDeep(this.state.expandedRows);var a={messageType:"critical",message:"ViewMarineShipmentList_CompartmentDetailsStatus",messageResultDetails:[{keyFields:["ReceiptByCompartmentList_ReceiptCode"],keyValues:[t.ReceiptCode],isSuccess:!1,errorMessage:""}]},o=[{key:f.ml,value:t.ReceiptCode}],l={ShareHolderCode:this.props.selectedShareholder,keyDataCode:f.ml,KeyCodes:o,Entity:s};I()(w.ggc,d.tW(l,this.props.tokenDetails.tokenInfo)).then((s=>{var i=s.data;a.messageType=i.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=i.IsSuccess,!0===i.IsSuccess?this.setState({modCompartments:e},(()=>{this.getReceipt({Common_Code:t.ReceiptCode},this.state.activeTab)})):a.messageResultDetails[0].errorMessage=i.ErrorList[0],(0,j.toast)((0,m.jsx)(u.A,{children:(0,m.jsx)(N.A,{notificationMessage:a})}),{autoClose:"success"===a.messageType&&1e4})})).catch((e=>{a.messageResultDetails[0].errorMessage=e,this.props.onSaved(this.state.modMarineDispatch,"UpdateCompartmentDetails",a),console.log("Error while compartmentDetailsSave:",e)}));let r=i.findIndex((t=>t.SeqNumber===e.SeqNumber));r>=0&&i.splice(r,1),this.toggleExpand(e,!1),this.setState({modCompartments:this.state.modCompartments})},this.handleAttributeCellDataEdit=(e,t)=>{try{e.DefaultValue=t,this.setState({attribute:e});const s=v().cloneDeep(this.state.attributeValidationErrors);s.forEach((s=>{s.TerminalCode===e.TerminalCode&&(s.attributeValidationErrors[e.Code]=d.I5(e,t))})),this.setState({attributeValidationErrors:s})}catch(s){console.log("TrailerDetailsComposite:Error occured on handleAttributeCellDataEdit",s)}},this.handleCompAttributeCellDataEdit=(e,t)=>{let s=v().cloneDeep(this.state.modAssociations),i=v().cloneDeep(this.state.expandedRows),a=s.findIndex((t=>t.SeqNumber===e.rowData.compSequenceNo));a>=0&&(s[a].AttributesforUI[e.rowData.SeqNumber-1].AttributeValue=t,this.setState({modAssociations:s}),i.splice(a,1),this.attributeToggleExpand(s[a],!0,!0))},this.confirmVehicleBond=()=>(0,m.jsx)(l.TranslationConsumer,{children:e=>(0,m.jsxs)(o.Modal,{open:this.state.vehicleBondPopUp,size:"small",children:[(0,m.jsx)(o.Modal.Content,{children:(0,m.jsx)("div",{className:"col col-lg-12",children:(0,m.jsx)("h5",{children:e("ReceiptBonded_VehicleNonBonded")})})}),(0,m.jsxs)(o.Modal.Footer,{children:[(0,m.jsx)(o.Button,{type:"primary",content:e("AccessCardInfo_Ok"),onClick:()=>{this.setState({vehicleBondPopUp:!1,stockProducts:!0})}}),(0,m.jsx)(o.Button,{type:"primary",content:e("Cancel"),onClick:()=>{this.setState({vehicleBondPopUp:!1})}})]})]})}),this.confirmBondedStockProducts=()=>(0,m.jsx)(l.TranslationConsumer,{children:e=>(0,m.jsxs)(o.Modal,{open:this.state.stockProducts,size:"small",children:[(0,m.jsx)(o.Modal.Content,{children:(0,m.jsx)("div",{className:"col col-lg-12",children:(0,m.jsx)("h5",{children:e("ReceiptBonded_StockProducts")})})}),(0,m.jsx)(o.Modal.Footer,{children:(0,m.jsx)(o.Button,{type:"primary",content:e("AccessCardInfo_Ok"),onClick:()=>{this.setState({stockProducts:!1},(()=>{this.saveReceipt()}))}})})]})}),this.confirmVehicleBondExpiryDate=()=>(0,m.jsx)(l.TranslationConsumer,{children:e=>(0,m.jsxs)(o.Modal,{open:this.state.vehicleBondExpiryPopUp,size:"small",children:[(0,m.jsx)(o.Modal.Content,{children:(0,m.jsx)("div",{className:"col col-lg-12",children:(0,m.jsx)("h5",{children:e("ReceiptBonded_VehicleBondExpiryDate")})})}),(0,m.jsxs)(o.Modal.Footer,{children:[(0,m.jsx)(o.Button,{type:"primary",content:e("AccessCardInfo_Ok"),onClick:()=>{this.setState({vehicleBondExpiryPopUp:!1,stockProducts:!0})}}),(0,m.jsx)(o.Button,{type:"primary",content:e("Cancel"),onClick:()=>{this.setState({vehicleBondExpiryPopUp:!1})}})]})]})}),this.handleRecordWeight=()=>(0,m.jsx)(l.TranslationConsumer,{children:e=>(0,m.jsxs)(o.Modal,{open:this.state.isRecordWeight,size:"small",children:[(0,m.jsxs)(o.Modal.Content,{children:[(0,m.jsx)("div",{className:"col col-lg-12",children:(0,m.jsx)("h3",{children:e("ViewReceipt_RecordWeightReceipt")+" : "+this.state.receipt.ReceiptCode})}),(0,m.jsxs)("div",{style:{display:"flex",flexWrap:"wrap"},children:[(0,m.jsx)("div",{className:"col col-lg-9",children:(0,m.jsx)(o.Select,{fluid:!0,placeholder:e("Select_WB"),label:e("ViewShipment_WeighBridgeCode"),value:this.state.weighBridgeCode,options:d.Zj(this.state.recordWeightList),onChange:e=>{this.setState({weighBridgeCode:e},(()=>this.getScadaValue()))}})}),(0,m.jsx)("div",{className:"shipmentRecordWeightButtonDiv",children:(0,m.jsx)(o.Button,{type:"primary",size:"small",className:"shipmentRecordWeightButton",content:e("ViewShipment_ReadWeight"),onClick:()=>this.getScadaValue(),disabled:null===this.state.weighBridgeCode||""===this.state.weighBridgeCode||void 0===this.state.weighBridgeCode})})]}),(0,m.jsx)("div",{style:{display:"flex",flexWrap:"wrap"},children:(0,m.jsx)("div",{className:"col col-lg-12",children:(0,m.jsx)(o.Input,{fluid:!0,value:this.state.scadaValue,label:e("ViewShipment_Weight"),reserveSpace:!1,disabled:!0})})}),(0,m.jsx)("div",{style:{display:"flex",flexWrap:"wrap"},children:(0,m.jsx)("div",{className:"col col-lg-12",children:(0,m.jsx)(o.Checkbox,{className:"LabelEnabled",label:e("Allow_Out_of_Tolerance_for_TW"),checked:this.state.allowOutofRangeTW,onChange:e=>{this.setState({allowOutofRangeTW:e})},disabled:!1})})})]}),(0,m.jsxs)(o.Modal.Footer,{children:[(0,m.jsx)(o.Button,{type:"primary",className:"shipmentRecordWeightOtherbuttons",content:e("ViewShipment_RecordTareWeight"),onClick:()=>this.RecordTareWeight(),disabled:null===this.state.scadaValue||""===this.state.scadaValue||void 0===this.state.scadaValue}),(0,m.jsx)(o.Button,{type:"primary",content:e("ViewShipment_RecordLadenWeight"),className:"shipmentRecordWeightOtherbuttons",onClick:()=>this.RecordLadenWeight(),disabled:null===this.state.scadaValue||""===this.state.scadaValue||void 0===this.state.scadaValue}),(0,m.jsx)(o.Button,{type:"primary",content:e("Cancel"),className:"shipmentRecordWeightOtherbuttons",onClick:()=>{this.setState({isRecordWeight:!1,weighBridgeCode:"",scadaValue:""})}})]})]})}),this.RecordLadenWeight=()=>{try{var e=[{key:f.bW,value:this.state.weighBridgeCode},{key:f.VA,value:this.state.scadaValue},{key:f.ok,value:this.state.receipt.VehicleCode},{key:f.ml,value:this.state.receipt.ReceiptCode},{key:f.Rb,value:this.state.allowOutofRangeTW}];let s={messageType:"critical",message:"ViewAllShipment_Record_Weight",messageResultDetails:[{keyFields:["ReceiptCode"],keyValues:[this.state.receipt.ReceiptCode],isSuccess:!1,errorMessage:""}]};var t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:f.bW,KeyCodes:e};I()(w.Q5$,d.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{s.messageType=e.data.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=e.data.IsSuccess,e.data.IsSuccess?this.setState({isRecordWeight:!1},(()=>{this.getReceipt({Common_Code:this.state.modReceipt.ReceiptCode},0,s)})):(s.messageResultDetails[0].errorMessage=e.data.ErrorList[0],this.props.onSaved(this.state.modReceipt,"update",s))})).catch((e=>{console.log("Error while recording laden weight:",e)}))}catch(s){console.log("Error in GetScadaValue")}},this.RecordTareWeight=()=>{try{var e=[{key:f.bW,value:this.state.weighBridgeCode},{key:f.VA,value:this.state.scadaValue},{key:f.ok,value:this.state.receipt.VehicleCode},{key:f.ml,value:this.state.receipt.ReceiptCode},{key:f.Rb,value:this.state.allowOutofRangeTW}];let s={messageType:"critical",message:"ViewAllShipment_Record_Weight",messageResultDetails:[{keyFields:["ReceiptCode"],keyValues:[this.state.receipt.ReceiptCode],isSuccess:!1,errorMessage:""}]};var t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:f.bW,KeyCodes:e};I()(w.A$X,d.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{s.messageType=e.data.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=e.data.IsSuccess,e.data.IsSuccess?this.setState({isRecordWeight:!1},(()=>{this.getReceipt({Common_Code:this.state.modReceipt.ReceiptCode},0,s)})):(s.messageResultDetails[0].errorMessage=e.data.ErrorList[0],this.props.onSaved(this.state.modReceipt,"update",s))})).catch((e=>{console.log("Error while recording tare weight:",e)}))}catch(s){console.log("Error in GetScadaValue")}},this.getScadaValue=()=>{try{var e=[{key:f.bW,value:this.state.weighBridgeCode}],t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:f.bW,KeyCodes:e};I()(w.$E2,d.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{let t={messageType:"critical",message:"ViewAllShipment_Record_Weight",messageResultDetails:[{keyFields:["ReceiptCode"],keyValues:[this.state.receipt.ReceiptCode],isSuccess:!1,errorMessage:""}]};t.messageType=e.data.IsSuccess?"success":"critical",t.messageResultDetails[0].isSuccess=e.data.IsSuccess,e.data.IsSuccess?this.setState({scadaValue:e.data.EntityResult}):(t.messageResultDetails[0].errorMessage=e.data.ErrorList[0],(0,j.toast)((0,m.jsx)(u.A,{children:(0,m.jsx)(N.A,{notificationMessage:t})}),{autoClose:"success"===t.messageType&&1e4}))})).catch((e=>{console.log("Error while getting weigh brdige Scada value:",e)}))}catch(s){console.log("Error in GetScadaValue")}},this.getAllRecordWeight=e=>{var t=[{key:f.ml,value:e.ReceiptCode}],s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:f.ml,KeyCodes:t};I()(w.glh,d.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{e.data.IsSuccess?this.setState({modRecordWeight:this.fillRecorWeightDetails(e.data.EntityResult),recordweightTab:e.data.EntityResult.length>0}):this.setState({modRecordWeight:{},recordweightTab:!1})})).catch((e=>{console.log("Error while getting receipt compartment details:",e)}))},this.authorizeToUnLoad=()=>{this.handleAuthenticationClose();let e={messageType:"critical",message:"ViewReceipt_AuthorizeUnLoad_status",messageResultDetails:[{keyFields:["ReceiptDetail_ReceiptNumber"],keyValues:[v().cloneDeep(this.state.receipt).ReceiptCode],isSuccess:!1,errorMessage:""}]},t=v().cloneDeep(this.state.modReceipt);this.props.handleAuthorizeToUnLoad(t,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(s=>{e.messageType=s.IsSuccess?"success":"critical",e.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?this.getReceipt({Common_Code:t.ReceiptCode},1,e):(e.messageResultDetails[0].errorMessage=s.ErrorList[0],this.props.onSaved(t,"update",e))}))},this.allowToUnLoadOnClick=()=>{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showAllowToUnLoadAuthenticationLayout:e},(()=>{!1===e&&this.allowToUnLoad()}))},this.allowToUnLoad=()=>{this.handleAuthenticationClose();let e={messageType:"critical",message:"ViewReceipt_AllowUnLoad_status",messageResultDetails:[{keyFields:["ReceiptDetail_ReceiptNumber"],keyValues:[v().cloneDeep(this.state.receipt).ReceiptCode],isSuccess:!1,errorMessage:""}]},t=v().cloneDeep(this.state.modReceipt);this.props.handleAllowToLoad(t,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(s=>{e.messageType=s.IsSuccess?"success":"critical",e.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?this.getReceipt({Common_Code:t.ReceiptCode},1,e):(e.messageResultDetails[0].errorMessage=s.ErrorList[0],this.props.onSaved(t,"update",e))}))},this.printRANClick=()=>{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showRANAuthenticationLayout:e},(()=>{!1===e&&this.printRAN()}))},this.printRAN=()=>{this.handleAuthenticationClose();let e={messageType:"critical",message:"ViewReceiptStatus_PrintRAN_status",messageResultDetails:[{keyFields:["ReceiptDetail_ReceiptNumber"],keyValues:[v().cloneDeep(this.state.receipt).ReceiptCode],isSuccess:!1,errorMessage:""}]},t=v().cloneDeep(this.state.modReceipt);this.props.handlePrintRAN(t,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(s=>{e.messageType=s.IsSuccess?"success":"critical",e.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?this.getReceipt({Common_Code:t.ReceiptCode}):e.messageResultDetails[0].errorMessage=s.ErrorList[0],(0,j.toast)((0,m.jsx)(u.A,{children:(0,m.jsx)(N.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})}))},this.viewBOD=()=>{this.props.handleViewBOD(),this.handleAuthenticationClose()},this.printBODClick=()=>{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showPrintBODAuthenticationLayout:e},(()=>{!1===e&&this.printBOD()}))},this.printBOD=()=>{this.handleAuthenticationClose();let e={messageType:"critical",message:"ViewReceiptStatus_PrintBOD_status",messageResultDetails:[{keyFields:["ReceiptDetail_ReceiptNumber"],keyValues:[v().cloneDeep(this.state.receipt).ReceiptCode],isSuccess:!1,errorMessage:""}]},t=v().cloneDeep(this.state.modReceipt);this.props.handlePrintBOD(t,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(s=>{e.messageType=s.IsSuccess?"success":"critical",e.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?this.getReceipt({Common_Code:t.ReceiptCode}):e.messageResultDetails[0].errorMessage=s.ErrorList[0],(0,j.toast)((0,m.jsx)(u.A,{children:(0,m.jsx)(N.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})}))},this.handleOperationClick=e=>{let t=v().cloneDeep(this.state.receipt),s=v().cloneDeep(this.state.modReceipt),i={messageType:"critical",message:e+"_status",messageResultDetails:[{keyFields:["ReceiptDetail_ReceiptNumber"],keyValues:[t.ReceiptCode],isSuccess:!1,errorMessage:""}]};switch(e){case h.wJ.ViewReceipt_AuthorizeUnLoad:let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showAuthorizeToUnLoadAuthenticationLayout:e},(()=>{!1===e&&this.authorizeToUnLoad()}));break;case h.wJ.ViewReceipt_AllowUnLoad:this.allowToUnLoadOnClick();break;case h.wJ.ViewReceipt_ManualEntry:this.setState({isManualEntry:!0});break;case h.wJ.ViewReceipt_RecordWeight:break;case h.wJ.ViewReceipt_CloseReceipt:this.setState({isCloseReceipt:!0});break;case h.wJ.ViewReceipt_PrintRAN:this.printRANClick();break;case h.wJ.ViewReceipt_ViewUnloading:this.props.handleViewUnLoading(s,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{if(!0===e.IsSuccess){let t=e.EntityResult;if(null!==t&&null!==t.Table&&t.Table.length>0){let e=0;t.Table.forEach((t=>{t.seqNo=e,t.endtime=new Date(t.endtime).toLocaleDateString()+" "+new Date(t.endtime).toLocaleTimeString(),t.starttime=new Date(t.starttime).toLocaleDateString()+" "+new Date(t.starttime).toLocaleTimeString(),e++,t.grossquantity=t.grossquantity.split(".").join("."),t.netquantity=t.netquantity.split(".").join(".")}))}this.setState({ModViewUnloadDetails:e.EntityResult.Table,isViewUnloading:!0}),this.getReceipt({Common_Code:s.ReceiptCode})}else i.messageType=e.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=e.IsSuccess,i.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,j.toast)((0,m.jsx)(u.A,{children:(0,m.jsx)(N.A,{notificationMessage:i})}),{autoClose:"success"===i.messageType&&1e4})}));break;case h.wJ.ViewReceipt_ViewBOD:let t=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showViewBODAuthenticationLayout:t},(()=>{!1===t&&this.viewBOD()}));break;case h.wJ.ViewReceipt_ViewAuditTrail:this.props.handleViewAuditTrail(s,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{if(!0===e.IsSuccess){let t=e.EntityResult;for(let e=0;e<t.length;e++){let s=t[e].ReceiptStatus;s=s===h.a$.AUTO_UNLOADED?h.PH.AUTO_UNLOADED:s===h.a$.CHECKED_IN?h.PH.CHECKED_IN:s===h.a$.CLOSED?h.PH.CLOSED:s===h.a$.INTERRUPTED?h.PH.INTERRUPTED:s===h.a$.UNLOADING?h.PH.UNLOADING:s===h.a$.MANUALLY_UNLOADED?h.PH.MANUALLY_UNLOADED:s===h.a$.PARTIALLY_UNLOADED?h.PH.PARTIALLY_UNLOADED:s===h.a$.QUEUED?h.PH.QUEUED:s===h.a$.READY?h.PH.READY:s===h.a$.DE_QUEUED?h.PH.DE_QUEUED:s===h.a$.WEIGHED_IN?h.PH.WEIGHED_IN:s===h.a$.WEIGHED_OUT?h.PH.WEIGHED_OUT:s===h.a$.ASSIGNED?h.PH.ASSIGNED:s===h.a$.CANCELLED?h.PH.CANCELLED:s===h.a$.EXPIRED?h.PH.EXPIRED:s===h.a$.REJECTED?h.PH.REJECTED:h.PH.USER_DEFINED,t[e].Receipt_Status=s,t[e].UpdatedTime=new Date(t[e].UpdatedTime).toLocaleDateString()+" "+new Date(t[e].UpdatedTime).toLocaleTimeString()}this.setState({auditTrailList:e.EntityResult,modAuditTrailList:t,isViewAuditTrail:!0}),this.getReceipt({Common_Code:s.ReceiptCode})}else i.messageType=e.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=e.IsSuccess,i.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,j.toast)((0,m.jsx)(u.A,{children:(0,m.jsx)(N.A,{notificationMessage:i})}),{autoClose:"success"===i.messageType&&1e4})}));break;case h.wJ.ViewReceipt_RecordWeight:this.getRecordWeightList();break;case h.wJ.ViewReceipt_PrintBOD:this.printBODClick();break;case h.wJ.ViewReceipt_SendBOD:this.props.handleSendBOD(s,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{i.messageType=e.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=e.IsSuccess,!0===e.IsSuccess?this.getReceipt({Common_Code:s.ReceiptCode}):i.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,j.toast)((0,m.jsx)(u.A,{children:(0,m.jsx)(N.A,{notificationMessage:i})}),{autoClose:"success"===i.messageType&&1e4})}));break;case h.wJ.viewReceipt_BSIOutbound:this.props.handleBSIOutbound(s,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{i.messageType=e.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=e.IsSuccess,!0===e.IsSuccess?this.getReceipt({Common_Code:s.ReceiptCode}):i.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,j.toast)((0,m.jsx)(u.A,{children:(0,m.jsx)(N.A,{notificationMessage:i})}),{autoClose:"success"===i.messageType&&1e4})}));break;case h.wJ.viewReceipt_SealCompartments:this.handleSealCompartments(this.state.modReceipt.ReceiptCode,this.props.selectedShareholder,this.props.tokenDetails.tokenInfo,(e=>{i.messageType=e.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=e.IsSuccess,!0===e.IsSuccess?this.setState({isSealCompartments:!0,sealCompartments:e.EntityResult}):(i.messageResultDetails[0].errorMessage=e.ErrorList[0],(0,j.toast)((0,m.jsx)(u.A,{children:(0,m.jsx)(N.A,{notificationMessage:i})}),{autoClose:"success"===i.messageType&&1e4}))}));break;case"ViewAllocateBay_AllocateBay":this.getBays();break;case"ViewAllocateBay_DeallocateBay":this.setState({isDeAllocateBay:!0});break;default:return}},this.getBays=()=>{let e=v().cloneDeep(this.state.receipt),t=[];e.ReceiptCompartmentsInfo.forEach((e=>{t.push(e.FinishedProductCode)}));const s={ShareHolderCode:this.props.selectedShareholder,KeyCodes:[{key:"TransactionType",value:"RECEIPT"},{key:"TransportationType",value:"ROAD"},{key:"TerminalCode",value:this.state.receipt.ActualTerminalCode},{key:"FinishedProductCode",value:t.toString()}]};I()(w.Fkg,d.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){let e=t.EntityResult;e.forEach((e=>{e.SupportedProducts.forEach((t=>{""===e.AssociatedProduct||void 0===e.AssociatedProduct?e.AssociatedProduct=t.Code:e.AssociatedProduct+=","+t.Code}))})),this.setState({bayData:e,isAllocateBay:!0})}else this.setState({bayData:[],isAllocateBay:!0}),console.log("Error in getBays:",t.ErrorList)})).catch((e=>{this.setState({bayData:[],isReadyToRender:!0}),console.log("Error while getBays:",e)}))},this.handleTabChange=e=>{try{this.setState({activeTab:e,expandedRows:[]}),1===e?this.setState({saveEnabled:d.ab(this.props.userDetails.EntityResult.FunctionsList,b.i.modify,b.m0)}):this.setState({saveEnabled:d.ab(this.props.userDetails.EntityResult.FunctionsList,b.i.modify,b.m0)&&"TRUE"===this.state.modCustomValues.ReceiptUpdateAllow})}catch(t){console.log("RailDispatchDetailsComposite: Error occurred on handleTabChange",t)}},this.onBack=()=>{this.setState({isManualEntry:!1,isPlanned:!0,saveEnabled:!1,isViewAuditTrail:!1,isViewUnloading:!1,drawerStatus:!1,expandedRows:[],loadingExpandedRows:[]}),this.getReceipt({Common_Code:this.state.modReceipt.ReceiptCode})},this.toggleExpand=(e,t)=>{let s=this.state.expandedRows,i=s.findIndex((t=>t.SeqNumber===e.SeqNumber));t?s.splice(i,1):s.push(e),this.setState({expandedRows:s})},this.loadingToggleExpand=(e,t)=>{let s=this.state.loadingExpandedRows,i=s.findIndex((t=>t.SeqNumber===e.SeqNumber));t?s.splice(i,1):s.push(e),this.setState({loadingExpandedRows:s})},this.attributeToggleExpand=function(t,s){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.state.expandedRows,o=a.findIndex((e=>e.SeqNumber===t.SeqNumber));s?i&&o>=0?(a.splice(o,1),a.push(t)):o>=0&&a.splice(o,1):o>=0?a=a.filter((e=>e.Code!==t.Code&&e.SeqNumber!==t.SeqNumber)):a.push(t),e.setState({expandedRows:a})},this.handleDrawer=()=>{var e=v().cloneDeep(this.state.drawerStatus);this.setState({drawerStatus:!e})},this.closeReceipt=()=>{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showCloseReceiptAuthenticationLayout:e},(()=>{!1===e&&this.handleReceiptClose()}))},this.handleReceiptClose=()=>{this.handleAuthenticationClose();try{let s={messageType:"critical",message:"ViewReceipt_CloseSuccess",messageResultDetails:[{keyFields:["ReceiptCode"],keyValues:[this.state.receipt.ReceiptCode],isSuccess:!1,errorMessage:""}]};var e=[{key:f.FR,value:this.props.selectedShareholder},{key:f.nB,value:this.state.modReceipt.ReceiptStatus},{key:f.ml,value:this.state.modReceipt.ReceiptCode},{key:f.qF,value:this.state.modReceipt.DriverCode}],t={ShareHolderCode:this.props.selectedShareholder,keyDataCode:f.ml,KeyCodes:e};I()(w.Vkk,d.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;s.messageType=t.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getReceipt({Common_Code:this.state.receipt.ReceiptCode},0,s):(s.messageResultDetails[0].errorMessage=t.ErrorList[0],this.props.onSaved(this.state.modReceipt,"update",s))})).catch((e=>{console.log("Error while ReceiptClose:",e)}))}catch(s){console.log("Error while closing the shipment:",s)}},this.handleCloseReceipttModal=()=>(0,m.jsx)(l.TranslationConsumer,{children:e=>(0,m.jsxs)(o.Modal,{open:this.state.isCloseReceipt,size:"mini",children:[(0,m.jsxs)(o.Modal.Content,{children:[(0,m.jsx)("div",{className:"col col-lg-12",children:(0,m.jsx)("h3",{children:e("Receipt_ForceCloseHeader")+" : "+this.state.receipt.ReceiptCode})}),(0,m.jsx)("div",{style:{display:"flex",flexWrap:"wrap"},children:(0,m.jsx)("div",{className:"col col-lg-12",children:(0,m.jsx)(o.Input,{fluid:!0,value:this.state.reasonForClosure,label:e("ViewReceipt_Reason"),reserveSpace:!1,onChange:e=>{this.setState({reasonForClosure:e})}})})})]}),(0,m.jsxs)(o.Modal.Footer,{children:[(0,m.jsx)(o.Button,{type:"primary",content:e("AccessCardInfo_Ok"),onClick:()=>{if(""===this.state.reasonForClosure){let e={messageType:"critical",message:"ViewReceipt_CloseSuccess",messageResultDetails:[{keyFields:["ReceiptCode"],keyValues:[this.state.receipt.ReceiptCode],isSuccess:!1,errorMessage:"Enter_Receipt_ReasonForCloseure"}]};(0,j.toast)((0,m.jsx)(u.A,{children:(0,m.jsx)(N.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})}else this.setState({isCloseReceipt:!1},(()=>{this.closeReceipt()}))}}),(0,m.jsx)(o.Button,{type:"primary",content:e("Cancel"),onClick:()=>{this.setState({isCloseReceipt:!1,reasonForClosure:""})}})]})]})}),this.confirmAllocateBay=()=>{let e=v().cloneDeep(this.state.bayData);return(0,m.jsx)(l.TranslationConsumer,{children:t=>(0,m.jsxs)(o.Modal,{open:this.state.isAllocateBay,size:"small",children:[(0,m.jsxs)(o.Modal.Content,{children:[(0,m.jsx)("div",{className:"col col-lg-12",children:(0,m.jsxs)("h3",{children:[t("ViewAllocateBay_AllocateBay")," -"," ",this.state.receipt.ReceiptCode]})}),(0,m.jsx)("div",{className:"col-12 detailsTable",children:(0,m.jsxs)(r.bQ,{className:"iconblock",data:e,selection:this.state.selectBay,selectionMode:"single",showHeader:!0,onSelectionChange:e=>this.setState({selectBay:e}),rows:this.props.userDetails.EntityResult.PageAttibutes.WebPortalListPageSize,resizableColumns:!0,children:[(0,m.jsx)(r.bQ.Column,{className:"compColHeight compColmiddle",field:"BayCode",header:t("ViewAllocateBay_BayCode"),editable:!1}),(0,m.jsx)(r.bQ.Column,{className:"compColHeight compColmiddle",field:"AssociatedProduct",header:t("ViewAllocateBay_FinishProduct"),editable:!1}),(0,m.jsx)(r.bQ.Column,{className:"compColHeight compColmiddle",field:"CurrentQueue",header:t("ViewAllocateBay_CurrentQueue"),editable:!1}),(0,m.jsx)(r.bQ.Column,{className:"compColHeight compColmiddle",field:"MaximumQueue",header:t("ViewAllocateBay_MaximumQueue"),editable:!1}),Array.isArray(e)&&e.length>this.props.userDetails.EntityResult.PageAttibutes.WebPortalListPageSize?(0,m.jsx)(r.bQ.Pagination,{}):""]})})]}),(0,m.jsxs)(o.Modal.Footer,{children:[(0,m.jsx)(o.Button,{type:"primary",content:t("MarineEOD_Close"),className:"cancelButton",onClick:()=>this.setState({isAllocateBay:!1})}),(0,m.jsx)(o.Button,{type:"primary",content:t("ViewAllocateBay_Allocate"),onClick:()=>{if(null===this.state.selectBay||void 0===this.state.selectBay||0===this.state.selectBay.length){let e={messageType:"critical",message:"ViewAllocateBay_Allocate",messageResultDetails:[{keyFields:["BayCode"],keyValues:[],isSuccess:!1,errorMessage:"ViewAllocateBay_bayrequired"}]};(0,j.toast)((0,m.jsx)(u.A,{children:(0,m.jsx)(N.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})}else this.AllocateBay(this.state.receipt.ReceiptCode,this.state.selectBay[0].BayCode,"RECEIPT")}})]})]})})},this.confirmDeAllocateBay=()=>(0,m.jsx)(l.TranslationConsumer,{children:e=>(0,m.jsxs)(o.Modal,{open:this.state.isDeAllocateBay,size:"small",children:[(0,m.jsx)(o.Modal.Content,{children:(0,m.jsx)("div",{className:"col col-lg-12",children:(0,m.jsx)("h5",{children:e("ViewAllocateBay_ConfirmDeallocateBay",[this.state.ReceiptBay,"Receipt"])})})}),(0,m.jsxs)(o.Modal.Footer,{children:[(0,m.jsx)(o.Button,{type:"primary",className:"cancelButton",content:e("Cancel"),onClick:()=>{this.setState({isDeAllocateBay:!1})}}),(0,m.jsx)(o.Button,{type:"primary",content:e("ViewAllocateBay_Deallocate"),onClick:()=>{this.setState({isDeAllocateBay:!1},(()=>{this.DeAllocateBay(this.state.receipt.ReceiptCode,"RECEIPT",this.state.ReceiptBay)}))}})]})]})}),this.handleAuthenticationClose=()=>{this.setState({showReceiptAuthenticationLayout:!1,showAuthorizeToUnLoadAuthenticationLayout:!1,showAllowToUnLoadAuthenticationLayout:!1,showCloseReceiptAuthenticationLayout:!1,showViewBODAuthenticationLayout:!1,showPrintBODAuthenticationLayout:!1,showRANAuthenticationLayout:!1})}}componentDidMount(){try{d.pJ(this.props.userDetails.EntityResult.IsArchived),this.GetUOMList(),this.getVehicleCodes(this.props.selectedShareholder),this.getDriverCodes(this.props.selectedShareholder),this.getFinishedProductCodes(this.props.selectedShareholder),this.GetSupplierOriginTerminals(this.props.selectedShareholder),this.getLookUpData(),this.getcustomerList(this.props.selectedShareholder),this.GetViewAllReceiptCustomData(),this.getBaseProducts(""),this.getAttributes(this.props.selectedRow),this.getReceiptConfigLookUpTypeName(),this.getReceiptBYCompartmentLookUpData(),this.getLookUpHsEInSpectionEnableData(),this.IsBonded()}catch(e){console.log("TruckReceiptDetailsComposite:Error occured on componentDidMount",e)}}componentWillReceiveProps(e){try{""!==this.state.receipt.receiptCode&&void 0===e.selectedRow.Common_Code&&this.props.tokenDetails.tokenInfo===e.tokenDetails.tokenInfo&&(this.setState({isPlanned:!1,activeTab:0,isManualEntry:!1}),this.getReceipt(e.selectedRow,0))}catch(t){console.log("TruckReceiptDetailsComposite:Error occured on componentWillReceiveProps",t)}}updateReceipt(e){let t=[{key:f.ml,value:e.ReceiptCode}],s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:f.ml,KeyCodes:t,Entity:e},i={messageType:"critical",message:"Receipt_SavedStatus",messageResultDetails:[{keyFields:["Receipt_Code"],keyValues:[e.ReceiptCode],isSuccess:!1,errorMessage:""}]};I()(w.o$q,d.tW(s,this.props.tokenDetails.tokenInfo)).then((t=>{this.handleAuthenticationClose();let s=t.data;i.messageType=s.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?this.setState({saveEnabled:d.ab(this.props.userDetails.EntityResult.FunctionsList,b.i.modify,b.m0)},(()=>this.getReceipt({Common_Code:e.ReceiptCode}))):(this.handleAuthenticationClose(),i.messageResultDetails[0].errorMessage=s.ErrorList[0],this.setState({saveEnabled:d.ab(this.props.userDetails.EntityResult.FunctionsList,b.i.add,b.m0)}),console.log("Error in UpdateReceipt:",s.ErrorList)),this.props.onSaved(e,"add",i)})).catch((t=>{this.handleAuthenticationClose(),this.setState({saveEnabled:d.ab(this.props.userDetails.EntityResult.FunctionsList,b.i.add,b.m0)}),i.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"add",i)}))}createReceipt(e){let t=[{key:f.ml,value:e.ReceiptCode}],s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:f.ml,KeyCodes:t,Entity:e},i={messageType:"critical",message:"Receipt_SavedStatus",messageResultDetails:[{keyFields:["Receipt_Code"],keyValues:[e.ReceiptCode],isSuccess:!1,errorMessage:""}]};I()(w.hpJ,d.tW(s,this.props.tokenDetails.tokenInfo)).then((t=>{this.handleAuthenticationClose();let s=t.data;i.messageType=s.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?this.setState({},(()=>this.getReceipt({Common_Code:e.ReceiptCode}))):(this.handleAuthenticationClose(),i.messageResultDetails[0].errorMessage=s.ErrorList[0],this.setState({saveEnabled:!0}),console.log("Error in CreateReceipt:",s.ErrorList)),this.props.onSaved(e,"add",i)})).catch((t=>{this.setState({saveEnabled:!0}),this.handleAuthenticationClose(),i.messageResultDetails[0].errorMessage=t,this.props.onSaved(e,"add",i)}))}validateSave(e,t){try{var s=v().cloneDeep(this.state.validationErrors);Object.keys(R.rW).forEach((function(t){s[t]=d.jr(R.rW[t],e[t])})),e.Active!==this.state.receipt.Active&&(null!==e.Remarks&&""!==e.Remarks||(s.Remarks="Receipt_RemarksRequired"));let a={messageType:"critical",message:"Receipt_SavedStatus",messageResultDetails:[]};if([...new Set(e.ReceiptOriginTerminalCompartmentsInfo.map((e=>e.CompartmentSeqNoInVehicle)))].length!==e.ReceiptOriginTerminalCompartmentsInfo.length)return a.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"Duplicate_Compartment_Details"}),this.props.onSaved(this.state.modReceipt,"update",a),!1;Array.isArray(e.ReceiptOriginTerminalCompartmentsInfo)&&e.ReceiptOriginTerminalCompartmentsInfo.length>0?e.ReceiptOriginTerminalCompartmentsInfo.forEach((e=>{S.$r.forEach((t=>{let s="";void 0!==t.validator&&(s=d.jr(t.validator,e[t.field])),""!==s&&a.messageResultDetails.push({keyFields:["Receipt_CompSeqInVehicle",t.displayName],keyValues:[e.CompartmentSeqNoInVehicle,e[t.field]],isSuccess:!1,errorMessage:s})}))})):a.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"Shipment_Compartment_Association_Require"});var i=v().cloneDeep(this.state.attributeValidationErrors);t.forEach((e=>{i.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.attributeMetaDataList.forEach((e=>{t.attributeValidationErrors[e.Code]=d.I5(e,e.DefaultValue)}))}))})),e.ReceiptOriginTerminalCompartmentsInfo.length>0&&e.ReceiptOriginTerminalCompartmentsInfo.forEach((e=>{S.$r.forEach((t=>{let s="";void 0!==t.validator&&(s=d.jr(t.validator,e[t.field])),""!==s&&a.messageResultDetails.push({keyFields:[t.displayName],keyValues:[e[t.field]],isSuccess:!1,errorMessage:s})})),null!==e.AttributesforUI&&void 0!==e.AttributesforUI&&e.AttributesforUI.forEach((t=>{let s=d.I5(t,t.AttributeValue);""!==s&&(this.props.userDetails.EntityResult.IsEnterpriseNode?a.messageResultDetails.push({keyFields:["CompAttributeTerminal",t.AttributeName],keyValues:[e.CompartmentSeqNoInVehicle,t.TerminalCode,t.AttributeValue],isSuccess:!1,errorMessage:s}):a.messageResultDetails.push({keyFields:[t.AttributeName],keyValues:[e.CompartmentSeqNoInVehicle,t.AttributeValue],isSuccess:!1,errorMessage:s}))})),this.attributeToggleExpand(e,!0,!0)})),this.setState({validationErrors:s,attributeValidationErrors:i});let o=!0;return o&&(o=Object.values(s).every((function(e){return""===e}))),i.forEach((e=>{if(!o)return o;o=Object.values(e.attributeValidationErrors).every((function(e){return""===e}))})),a.messageResultDetails.length>0?(this.props.onSaved(this.state.modReceipt,"update",a),!1):o}catch(a){console.log("TruckReceiptDetailsComposite:Error occured on ValidateSave",a)}}convertStringtoDecimal(e,t){try{return e.ReceiptOriginTerminalCompartmentsInfo.forEach((e=>{e.Quantity=d.bo(e.Quantity)})),e=this.fillAttributeDetails(e,t)}catch(s){console.log("convertStringtoDecimal on trailer details",s)}}fillDetails(e){let t=[];try{if(Array.isArray(e)){let s=v().cloneDeep(this.state.modReceipt);e.forEach((e=>{(null!==e.CompartmentSeqNoInVehicle&&""!==e.CompartmentSeqNoInVehicle||null!==e.CompartmentCode&&""!==e.CompartmentCode||null!==e.TrailerCode&&""!==e.TrailerCode||null!==e.FinishedProductCode&&""!==e.FinishedProductCode||null===e.Quantity||""===e.Quantity)&&void 0!==e.AttributesforUI&&null!=e.AttributesforUI&&(e.AttributesforUI=d.BZ(e.AttributesforUI)),t.push({CompartmentCode:e.CompartmentCode,CompartmentSeqNoInVehicle:e.CompartmentSeqNoInVehicle,TrailerCode:e.TrailerCode,CompartmentSeqNoInTrailer:e.CompartmentSeqNoInTrailer,Quantity:e.Quantity.toLocaleString(),QuantityUOM:this.state.modReceipt.ReceiptQuantityUOM,FinishedProductCode:e.FinishedProductCode,OriginTerminalCode:e.OriginTerminalCode,ShareholderCode:this.props.selectedShareholder,SupplierCode:!1===this.state.SupplierEnable?s.SupplierCode:e.SupplierCode,ReceiptCode:s.ReceiptCode,AttributesforUI:e.AttributesforUI})}))}}catch(s){console.log("Error while making receipt body:",s)}return t}fillCustomerInvetoryDetails(e){let t=v().cloneDeep(this.state.customerInventory);try{Array.isArray(e)&&e.forEach((e=>{(null!==e.CustomerCode&&""!==e.CustomerCode||null===e.FinishedProductCode||""===e.FinishedProductCode||null===e.PlannedQuantity||""===e.PlannedQuantity)&&t.push({CustomerCode:e.CustomerCode,FinishedProductCode:e.FinishedProductCode,BaseProductCode:e.BaseProductCode,PlannedQuantity:e.PlannedQuantity.toLocaleString(),ShareholderCode:this.props.selectedShareholder,QuantityUOM:this.state.modReceipt.ReceiptQuantityUOM})}))}catch(s){console.log("Error while making receipt body:",s)}return t}fillCompartmentPlanDetails(e){console.log("modLoadingDetails",e);let t=[];return Array.isArray(e.Table)&&e.Table.forEach((e=>{e.adjustedquantity=0,t.push({TrailerCode:e.trailercode,CompartmentCode:e.compartmentcode,CompartmentStaus:e.CompartmentStatus,FinishedProductCode:e.finishedproductcode,AdjustedQuantity:"",Quantity:null!==e.Quantity?e.Quantity.toString():"",revisedplannedquantity:e.revisedplannedquantity-e.adjustedquantity<0?e.revisedplannedquantity:(e.revisedplannedquantity-e.adjustedquantity).toString()+" "+e.compartmentuom,UnLoadedQuantity:Math.round(e.loadedquantity)+" "+e.compartmentuom,CompSeqNoInVehicle:e.compartmentseqnoinvehicle,ForceCompleted:e.CompartmentStatus===h.gB.FORCE_COMPLETED})})),t=d.Q3(t),t}fillRecorWeightDetails(e){let t=[];return Array.isArray(e)&&e.forEach((e=>{t.push({TrailerCode:e.trailercode,WeighbridgeCode:e.WeighbridgeCode,MeasuredWeight:e.MeasuredWeight+" "+e.WeightUOM,MeasuredWeightTime:new Date(e.MeasuredWeightTime).toLocaleDateString()+" "+new Date(e.MeasuredWeightTime).toLocaleTimeString(),weight:!0===e.IsTareWeight?"Tare Weight":"Laden Weight"})})),t=d.Q3(t),t}handleSealCompartments(e,t,s,i){var a=[{key:f.FR,value:t},{key:f.ml,value:e}],o={ShareHolderCode:t,keyDataCode:f.yz,KeyCodes:a};I()(w.SXw,d.tW(o,s)).then((e=>{var t=e.data;i(t)})).catch((e=>{console.log("Error while handleBSIOutbound:",e)}))}getVehicle(e,t){let s=v().cloneDeep(this.state.modReceipt),i=v().cloneDeep(this.state.modVehicleDetails);s.VehicleCode=e;let a=[{key:f.ok,value:e}],o={ShareHolderCode:this.props.selectedShareholder,keyDataCode:f.ok,KeyCodes:a};I()(w.jvS,d.tW(o,this.props.tokenDetails.tokenInfo)).then((a=>{let o=a.data;if(!0===o.IsSuccess){if(null!==o.EntityResult){s.CarrierCode=o.EntityResult.CarrierCompanyCode,i.carrierCode=o.EntityResult.CarrierCompanyCode,i.vehicleCompartments=this.getCompartmentDetailsFromVehicle(o.EntityResult);let a=[];if(i.vehicleCompartments.forEach((e=>a.push({text:e.vehCompSeq,value:e.vehCompSeq}))),t){let t=this.getReceiptCompartmentFromVehicleCompartment(i.vehicleCompartments);t=d.Q3(t),this.setState({modAssociations:t},(()=>{this.props.userDetails.EntityResult.IsEnterpriseNode?this.terminalSelectionChange(s.TerminalCodes):this.localNodeAttribute()})),this.state.receipt.VehicleCode!==e&&(t=d.Q3(t))}s.IsBonded=!!this.state.isBonded&&(!!o.EntityResult.IsBonded||s.IsBonded);let l=o.EntityResult.BondExpiryDate;if(this.setState({modReceipt:s,modVehicleDetails:i,compSeqOptions:a,bondExpiryDate:l,isVehicleBonded:!!o.EntityResult.IsBonded}),this.state.receipt.VehicleCode===s.VehicleCode){let e=v().cloneDeep(i);this.setState({vehicleDetails:e})}}}else this.setState({modReceipt:s}),console.log("TruckReceiptDetailsComposite:Error in GetVehicle:",o.ErrorList)})).catch((e=>{this.setState({modReceipt:s}),console.log("TruckReceiptDetailsComposite:Error while getting Vehicle:",e)}))}getReceiptCompartmentFromVehicleCompartment(e){let t=[];if(Array.isArray(e))for(let s=0;s<e.length;s++){let i=e[s],a={CompartmentCode:i.compCode,CompartmentSeqNoInVehicle:i.vehCompSeq,TrailerCode:i.trailerCode,CompartmentSeqNoInTrailer:i.trailerCompSeq,Quantity:null!==i.SFL&&""!==i.SFL?i.SFL.toLocaleString():null,QuantityUOM:i.UOM,FinishedProductCode:"",ShareholderCode:this.props.selectedShareholder,SupplierCode:"",OriginTerminalCode:"",ReceiptCode:""};t.push(a)}return t}GetViewAllReceiptCustomData(e,t){try{var s=[];void 0!==e&&(s=[{key:f.ml,value:e.ReceiptCode},{key:f.nB,value:e.ReceiptStatus},{key:f.ok,value:e.VehicleCode},{key:f.Wb,value:e.ActualTerminalCode}]);var i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:f.ml,KeyCodes:s};I()(w.C0_,d.tW(i,this.props.tokenDetails.tokenInfo)).then((s=>{if(s.data.IsSuccess){var i=s.data.EntityResult;void 0!==e?this.setState({saveEnabled:1===t?d.ab(this.props.userDetails.EntityResult.FunctionsList,b.i.modify,b.m0):!("TRUE"!==i.ReceiptUpdateAllow||!d.ab(this.props.userDetails.EntityResult.FunctionsList,b.i.modify,b.m0)),modCustomValues:s.data.EntityResult}):this.setState({modCustomValues:s.data.EntityResult,saveEnabled:d.ab(this.props.userDetails.EntityResult.FunctionsList,b.i.modify,b.m0)})}else this.setState({modCustomValues:{},customerInventory:[]})})).catch((t=>{console.log("Error while getting shipment custom details:",t,e)}))}catch(a){console.log("Error in Custom Data retrieve",a)}}handleResetAttributeValidationError(){try{var e=v().cloneDeep(this.state.attributeMetaDataList);this.setState({attributeValidationErrors:d.Fl(e)})}catch(t){console.log("TrailerDetailsComposite:Error occured on handleResetAttributeValidationError",t)}}getcustomerList(e){I()(w.E6k+"?ShareholderCode="+e+"&TransportationType=",d.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var s=t.data;if(!0===s.IsSuccess)if(Array.isArray(s.EntityResult)){let t=s.EntityResult.filter((t=>t.ShareholderCode===e));if(t.length>0){let e=Object.keys(t[0].CustomerDestinationsList),s=d.Zj(e);this.setState({customerOptions:s})}else console.log("no customers identified for shareholder")}else console.log("customerdestinations not identified for shareholder")})).catch((e=>{console.log("Error while getting Customer List:",e)}))}getCompartmentDetailsFromVehicle(e){let t=[],s=1;return e.VehicleTrailers.sort(((e,t)=>e.TrailerSeq-t.TrailerSeq)),e.VehicleTrailers.forEach((e=>{if(Array.isArray(e.Trailer.Compartments)){e.Trailer.Compartments.sort(((e,t)=>e.CompartmentSeqNoInTrailer-t.CompartmentSeqNoInTrailer));for(let i=0;i<e.Trailer.Compartments.length;i++){let a=e.Trailer.Compartments[i],o={compCode:a.Code,vehCompSeq:s,trailerCode:a.TrailerCode,trailerCompSeq:a.CompartmentSeqNoInTrailer,SFL:a.Capacity,UOM:a.UOM};t.push(o),s+=1}}})),t}getDriverCodes(e){I()(w.bHU+"?ShareholderCode="+e,d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){let e=d.Zj(t.EntityResult),s=v().cloneDeep(e);s.length>h.bM&&(s=s.slice(0,h.bM)),this.setState({driverOptions:e,driverSearchOptions:s})}}else console.log("Error in getDriverCodes:",t.ErrorList)})).catch((e=>{console.log("Error while getting getDriverCodes:",e)}))}getFinishedProductCodes(e){I()(w.w43+"?ShareholderCode="+e,d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){let e=d.Zj(t.EntityResult);this.setState({finishedProductOptions:e})}}else console.log("Error in getFinishedProductCodes:",t.ErrorList)})).catch((e=>{console.log("Error while getting getFinishedProductCodes:",e)}))}getCompartmentFromReceipt(e){let t=[];return Array.isArray(e.ReceiptCompartmentsInfo)&&e.ReceiptCompartmentsInfo.forEach((e=>t.push({ReceiptCode:e.ReceiptCode,CompartmentCode:e.CompartmentCode,CompartmentSeqNoInVehicle:e.CompartmentSeqNoInVehicle,TrailerCode:e.TrailerCode,CompartmentSeqNoInTrailer:e.trailerCompSeq,Quantity:null!==e.Quantity&&""!==e.Quantity?e.Quantity.toLocaleString():null,QuantityUOM:e.QuantityUOM,SupplierCode:e.SupplierCode,DestinationCode:e.DestinationCode,OriginTerminalCode:e.OriginTerminalCode,ShareholderCode:this.props.selectedShareholder,FinishedProductCode:e.FinishedProductCode,CompartmentStaus:e.ReceiptCompartment_Status,Adjust_Plan:null!==e.AdjustedQuantity&&""!==e.AdjustedQuantity?e.AdjustedQuantity:null,ForceCompleted:h.gB[e.CompartmentStaus]===h.gB.FORCE_COMPLETED}))),t=d.Q3(t),t.sort(((e,t)=>e.CompartmentSeqNoInVehicle>t.CompartmentSeqNoInVehicle?1:e.CompartmentSeqNoInVehicle<t.CompartmentSeqNoInVehicle?-1:0))}getSaveEnabled(){var e=this.handleSaveCompartmentDetailsEnabled(),t=v().cloneDeep(this.state.saveEnabled),s=v().cloneDeep(this.state.activeTab),i=v().cloneDeep(this.state.compartmentTab);return 1===s&&!0===i?e:t}getReceiptCompartmentDetails(e){var t=[{key:f.ml,value:e.ReceiptCode}],s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:f.ml,KeyCodes:t};I()(w.bo$,d.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{e.data.IsSuccess?this.setState({modCompartments:this.fillCompartmentPlanDetails(e.data.EntityResult)}):this.setState({modCompartments:{}})})).catch((e=>{console.log("Error while getting receipt compartment details:",e)}))}getReceiptCompartmentFromReceipt(e){let t=[];return Array.isArray(e.ReceiptOriginTerminalCompartmentsInfo)&&e.ReceiptOriginTerminalCompartmentsInfo.forEach((e=>t.push({ReceiptCode:e.ReceiptCode,CompartmentCode:e.CompartmentCode,CompartmentSeqNoInVehicle:e.CompartmentSeqNoInVehicle,TrailerCode:e.TrailerCode,CompartmentSeqNoInTrailer:e.trailerCompSeq,Quantity:null!==e.Quantity&&""!==e.Quantity?e.Quantity.toLocaleString():null,QuantityUOM:e.QuantityUOM,SupplierCode:e.SupplierCode,DestinationCode:e.DestinationCode,OriginTerminalCode:e.OriginTerminalCode,ShareholderCode:this.props.selectedShareholder,FinishedProductCode:e.FinishedProductCode,CompartmentStaus:e.ReceiptCompartment_Status,Attributes:e.Attributes}))),t=d.Q3(t),t.sort(((e,t)=>e.CompartmentSeqNoInVehicle>t.CompartmentSeqNoInVehicle?1:e.CompartmentSeqNoInVehicle<t.CompartmentSeqNoInVehicle?-1:0))}getReceiptCustomerInventory(e){let t=[];return Array.isArray(e.CustomerInventoryPlanList)&&e.CustomerInventoryPlanList.forEach((e=>t.push({ShareholderCode:this.props.selectedShareholder,CustomerCode:e.CustomerCode,BaseProductCode:e.BaseProductCode,FinishedProductCode:e.FinishedProductCode,PlannedQuantity:e.PlannedQuantity,GrossActualQuantity:e.GrossActualQuantity,NetActualQuantity:e.NetActualQuantity}))),t=d.Q3(t),t.sort(((e,t)=>e.CompartmentSeqNoInVehicle>t.CompartmentSeqNoInVehicle?1:e.CompartmentSeqNoInVehicle<t.CompartmentSeqNoInVehicle?-1:0))}localNodeAttribute(){try{var e=v().cloneDeep(this.state.attributeMetaDataList);if(Array.isArray(e)&&e.length>0)this.terminalSelectionChange([e[0].TerminalCode]);else{var t=v().cloneDeep(this.state.compartmentAttributeMetaDataList);Array.isArray(t)&&t.length>0&&this.formCompartmentAttributes([t[0].TerminalCode])}}catch(s){console.log("TrailerDetailsComposite:Error occured on localNodeAttribute",s)}}formCompartmentAttributes(e){try{let t=v().cloneDeep(this.state.compartmentAttributeMetaDataList);t=t.filter((function(t){return e.some((function(e){return t.TerminalCode===e}))}));let s=v().cloneDeep(this.state.modAssociations);s.forEach((s=>{let i=[];t.forEach((e=>{e.attributeMetaDataList.forEach((e=>{i.push({AttributeCode:e.Code,AttributeName:e.DisplayName,AttributeValue:e.DefaultValue,TerminalCode:e.TerminalCode,IsMandatory:e.IsMandatory,DataType:e.DataType,IsReadonly:e.IsReadonly,MinValue:e.MinValue,MaxValue:e.MaxValue,ValidationFormat:e.ValidationFormat,compSequenceNo:""})}))}));let a=v().cloneDeep(i);if(null!==s.FinishedProductCode&&void 0!==s.FinishedProductCode&&""!==s.FinishedProductCode||null!==s.AttributesforUI&&void 0!==s.AttributesforUI){null!==s.AttributesforUI&&void 0!==s.AttributesforUI?(s.AttributesforUI=s.AttributesforUI.filter((function(t){return e.some((function(e){return t.TerminalCode===e}))})),i=i.filter((function(e){return!s.AttributesforUI.some((function(t){return e.TerminalCode===t.TerminalCode}))}))):s.AttributesforUI=[];let t=v().cloneDeep(i);if(Array.isArray(s.Attributes)&&null!==s.Attributes&&void 0!==s.Attributes&&s.Attributes.length>0){s.Attributes.filter((function(t){return e.some((function(e){return t.TerminalCode===e}))})).forEach((e=>{e.ListOfAttributeData.forEach((s=>{let i=t.findIndex((t=>t.TerminalCode===e.TerminalCode&&t.AttributeCode===s.AttributeCode));i>=0&&(t[i].AttributeValue=s.AttributeValue)}))})),t.forEach((e=>{e.compSequenceNo=s.SeqNumber,s.AttributesforUI.push(e)}))}else i.forEach((e=>{e.compSequenceNo=s.SeqNumber,s.AttributesforUI.push(e)}))}else s.AttributesforUI=[],a.forEach((e=>{e.compSequenceNo=s.SeqNumber,s.AttributesforUI.push(e)}));this.attributeToggleExpand(s,!0,!0),void 0!==s.AttributesforUI&&null!=s.AttributesforUI&&(s.AttributesforUI=d.vt(s.AttributesforUI)),s.AttributesforUI=d.Q3(s.AttributesforUI),console.log("comp.AttributesforUI",s.AttributesforUI)})),this.setState({modAssociations:s})}catch(t){console.log("ContractDetailsComposite:Error in forming Compartment Attributes",t)}}fillAttributeDetails(e,t){try{return t=d.SC(t),e.Attributes=[],t.forEach((t=>{let s={ListOfAttributeData:[]};s.TerminalCode=t.TerminalCode,t.attributeMetaDataList.forEach((e=>{s.ListOfAttributeData.push({AttributeCode:e.Code,AttributeValue:e.DefaultValue})})),e.Attributes.push(s)})),e.ReceiptOriginTerminalCompartmentsInfo.forEach((t=>{void 0!==t.AttributesforUI&&null!=t.AttributesforUI&&(t.AttributesforUI=d.mr(t.AttributesforUI));let s=[];if(this.props.userDetails.EntityResult.IsEnterpriseNode)s=v().cloneDeep(e.TerminalCodes);else{var i=v().cloneDeep(this.state.compartmentAttributeMetaDataList);i.length>0&&(s=[i[0].TerminalCode])}let a=[];t.Attributes=[],s.forEach((e=>{null!==t.AttributesforUI&&void 0!==t.AttributesforUI&&(a=t.AttributesforUI.filter((function(t){return t.TerminalCode===e})));let s={ListOfAttributeData:[]};s.TerminalCode=e,a.forEach((e=>{""===e.AttributeValue&&!0!==e.IsMandatory||s.ListOfAttributeData.push({AttributeCode:e.AttributeCode,AttributeValue:e.AttributeValue})})),null!==s.ListOfAttributeData&&void 0!==s.ListOfAttributeData&&s.ListOfAttributeData.length>0&&t.Attributes.push(s)}))})),this.setState({modReceipt:e}),e}catch(s){console.log("TrailerDetailsComposite:Error occured on fillAttributeDetails",s)}}getAttributes(e){try{I()(w.fKH,d.tW([V.GF,V.Jx],this.props.tokenDetails.tokenInfo)).then((t=>{var s=t.data;!0===s.IsSuccess?this.setState({attributeMetaDataList:v().cloneDeep(s.EntityResult.RECEIPT),attributeValidationErrors:d.Fl(s.EntityResult.RECEIPT),compartmentAttributeMetaDataList:v().cloneDeep(s.EntityResult.RECEIPTORIGINTERMINALCOMPARTMENT)},(()=>this.getReceipt(e))):console.log("Failed to get Attributes")}))}catch(t){console.log("Error while getting Attributes:",t)}}terminalSelectionChange(e){try{let a=[];var t=[],s=[];t=v().cloneDeep(this.state.attributeMetaDataList),s=v().cloneDeep(this.state.selectedAttributeList);const o=v().cloneDeep(this.state.attributeValidationErrors);var i=v().cloneDeep(this.state.modReceipt);e.forEach((e=>{var o=s.find((t=>t.TerminalCode===e));void 0===o?t.forEach((function(t){if(t.TerminalCode===e){var s=i.Attributes.find((t=>t.TerminalCode===e));void 0!==s&&t.attributeMetaDataList.forEach((function(e){var t=s.ListOfAttributeData.find((t=>t.AttributeCode===e.Code));void 0!==t&&(e.DefaultValue=t.AttributeValue)})),a.push(t)}})):a.push(o)})),s=[],s=a,s=d.nQ(s),o.forEach((t=>{void 0===e.find((e=>t.TerminalCode===e))&&Object.keys(t.attributeValidationErrors).forEach((e=>t.attributeValidationErrors[e]=""))})),this.formCompartmentAttributes(e),this.setState({selectedAttributeList:s,attributeValidationErrors:o})}catch(a){console.log("TrailerDetailsComposite:Error occured on terminalSelectionChange",a)}}getReceipt(e,t,s){let i=null;if(x.Q0.ShareholderCode=this.props.selectedShareholder,x.Q0.ReceiptQuantityUOM=this.props.userDetails.EntityResult.PageAttibutes.DefaultQtyUOMForTransactionUI.ROAD,x.Q0.TerminalCodes=1===this.props.terminalCodes.length?[...this.props.terminalCodes]:[],this.handleResetAttributeValidationError(),void 0!==e.Common_Code){var a=[{key:f.ml,value:e.Common_Code}],o={ShareHolderCode:this.props.selectedShareholder,keyDataCode:f.ml,KeyCodes:a};I()(w.r$n,d.tW(o,this.props.tokenDetails.tokenInfo)).then((a=>{var o=a.data;if(!0===o.IsSuccess){let s=o.EntityResult;i=o.EntityResult,s.SupplierCode=o.EntityResult.ReceiptOriginTerminalCompartmentsInfo[0].SupplierCode;let a=v().cloneDeep(this.state.isPlanned);a=null!==s.ReceiptOriginTerminalCompartmentsInfo&&void 0!==s.ReceiptOriginTerminalCompartmentsInfo&&0!==s.ReceiptOriginTerminalCompartmentsInfo.length,s.HSEInspectionStatus=d.cd(h.sL,s.HSEInspectionStatus),this.setState({isReadyToRender:!0,receipt:o.EntityResult,modAssociations:this.getReceiptCompartmentFromReceipt(o.EntityResult),modCustomerInventory:this.getReceiptCustomerInventory(o.EntityResult),modReceipt:s,isPlanned:a,activeTab:t,expandedRows:[]},(()=>{this.getVehicle(o.EntityResult.VehicleCode,!1),this.getReciptStatuses(e),this.getReceiptCompartmentDetails(o.EntityResult),this.GetViewAllReceiptCustomData(o.EntityResult,t),this.getAllRecordWeight(o.EntityResult),this.getKPIList(this.props.selectedShareholder,o.EntityResult.ReceiptCode),this.props.userDetails.EntityResult.IsEnterpriseNode?this.terminalSelectionChange(o.EntityResult.TerminalCodes):this.localNodeAttribute(),this.GetBayByTrnsaction(o.EntityResult.ReceiptCode,"RECEIPT",o.EntityResult.ShareholderCode,(()=>{this.getReciptsStatusOperations(o.EntityResult)}))}))}else this.setState({modReceipt:v().cloneDeep(x.Q0),receipt:v().cloneDeep(x.Q0),modAssociations:[],modCustomerInventory:[],isReadyToRender:!0,isPlanned:!1,selectedAttributeList:[],activeTab:this.props.ReceiptType.toLowerCase()===b.m0?1:0}),console.log("Error in GetReceipt:",o.ErrorList);void 0!==s&&null!==s&&null!==i&&this.props.onSaved(i,"update",s)})).catch((t=>{console.log("Error while getting Receipt:",t,e)}))}else this.setState({receipt:v().cloneDeep(x.Q0),modReceipt:v().cloneDeep(x.Q0),isReadyToRender:!0,modAssociations:[],modCustomerInventory:[],selectedAttributeList:[],isPlanned:!1,recordweightTab:!1,modCompartments:[],activeTab:t,modRecordWeight:[],expandedRows:[],truckReceiptKPIList:[],saveEnabled:d.ab(this.props.userDetails.EntityResult.FunctionsList,b.i.add,b.m0)},(()=>{this.props.userDetails.EntityResult.IsEnterpriseNode?1===this.props.terminalCodes.length?this.terminalSelectionChange(this.props.terminalCodes):this.terminalSelectionChange([]):this.localNodeAttribute([])}))}GetUOMList(){I()(w.WFM,d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult){let e=[];if(Array.isArray(t.EntityResult.VOLUME)&&(e=d.Zj(t.EntityResult.VOLUME)),Array.isArray(t.EntityResult.MASS)){d.Zj(t.EntityResult.MASS).forEach((t=>e.push(t)))}this.setState({quantityUOMOptions:e})}}else console.log("Error in GetUOMList:",t.ErrorList)})).catch((e=>{console.log("Error while getting GetUOMList:",e)}))}getVehicleCodes(e){I()(w.FKP+"?Transportationtype="+h.LY.ROAD+"&ShareholderCode="+e,d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){let e=d.Zj(t.EntityResult),s=v().cloneDeep(e);s.length>h.bM&&(s=s.slice(0,h.bM)),this.setState({vehicleOptions:e,vehicleSearchOptions:s})}}else console.log("Error in getVehicleCodes:",t.ErrorList)})).catch((e=>{console.log("Error while getting getVehicleCodes:",e)}))}getVehicleSearchOptions(){let e=v().cloneDeep(this.state.vehicleSearchOptions),t=this.state.modReceipt.VehicleCode;if(null!==t&&""!==t&&void 0!==t){void 0===e.find((e=>e.value.toLowerCase()===t.toLowerCase()))&&e.push({text:t,value:t})}return e}getDriverSearchOptions(){let e=v().cloneDeep(this.state.driverSearchOptions),t=this.state.modReceipt.DriverCode;if(null!==t&&""!==t&&void 0!==t){void 0===e.find((e=>e.value.toLowerCase()===t.toLowerCase()))&&e.push({text:t,value:t})}return e}GetSupplierOriginTerminals(e){I()(w._fS+"?Transportationtype="+h.LY.ROAD+"&ShareholderCode="+e,d.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var s=t.data;if(!0===s.IsSuccess)if(Array.isArray(s.EntityResult)){let t=s.EntityResult.filter((t=>t.ShareholderCode===e));if(t.length>0){let e=t[0].SupplierOriginTerminalsList,s=Object.keys(e);if(null!==e||void 0!==e){let e=d.Zj(s);this.setState({supplierOptions:e})}this.setState({supplierOriginTerminalsList:e}),""!==e&&null!==e||this.setState({supplierOptions:[]})}else console.log("No supplierOriginTerminalList identified for shareholder")}else console.log("No supplierOriginTerminalList identified for shareholder")})).catch((e=>{console.log("Error in GetSupplierOriginTerminals: ",e)}))}getRecordWeightList(){I()(w.IP6,d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;this.setState({isRecordWeight:!0,recordWeightList:t.EntityResult})})).catch((e=>{console.log("Error while getting RecordWeightList:",e)}))}getReciptStatuses(e){try{I()(w.WX8+"?shareholderCode="+this.props.selectedShareholder+"&receiptCode="+e.Common_Code,d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;console.log("result.EntityResult",t.EntityResult),this.setState({currentReceiptStatus:t.EntityResult})})).catch((e=>{console.log("Error while getting getReceiptStatuses:",e)}))}catch(t){console.log(t)}}getReciptsStatusOperations(e){try{var t=e.ReceiptStatus,s=e.IsVolumeBased,i=this.props.selectedShareholder;I()(w.rOC+"?receiptStatus="+t+"&IsVolumneBased="+s+"&shareholder="+i,d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{console.log(e.data);var t=e.data;!0===t.EntityResult.ViewAllocateBay_DeallocateBay&&null!==this.state.ReceiptBay&&void 0!==this.state.ReceiptBay&&""!==this.state.ReceiptBay?t.EntityResult.ViewAllocateBay_DeallocateBay=!0:!0!==t.EntityResult.ViewAllocateBay_DeallocateBay||null!==this.state.ReceiptBay&&void 0!==this.state.ReceiptBay&&""!==this.state.ReceiptBay||(t.EntityResult.ViewAllocateBay_DeallocateBay=!1);let s=[];Object.keys(t.EntityResult).forEach((e=>{console.log(e),t.EntityResult[e]&&s.push(e)})),this.setState({shipmentNextOperations:s}),console.log("Operations of receipt",s)})).catch((e=>{console.log("Error while getting getReceiptStatusOperations:",e)}))}catch(a){console.log(a)}}getLookUpData(){I()(w.xAA+"?LookUpTypeCode=CustomerInventory",d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(console.log(t),!0===t.IsSuccess){let e=!0;"False"===t.EntityResult.Enabled&&(e=!1),this.setState({lookUpData:t.EntityResult,customerInventoryTab:e})}else console.log("Error in getLookUpData: ",t.ErrorList)})).catch((e=>{console.log("SealMasterDetailsComposite: Error occurred on getLookUpData",e)}))}getReceiptConfigLookUpTypeName(){I()(w.xAA+"?LookUpTypeCode=RECEIPTCONFIGURATION",d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(console.log(t),!0===t.IsSuccess){let e=!1;t.EntityResult.NoOfDaysBeforeOldReceiptsCreationIsAllowed&&(e=!0),this.setState({lookUpData:t.EntityResult,IsPastDisable:e})}else console.log("Error in getLookUpData: ",t.ErrorList)})).catch((e=>{console.log("SealMasterDetailsComposite: Error occurred on getLookUpData",e)}))}getReceiptBYCompartmentLookUpData(){I()(w.xAA+"?LookUpTypeCode=ReceiptByCompartment",d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(console.log(t),!0===t.IsSuccess){let e=!1;"0"===t.EntityResult.ReceiptWithSingleSupplier&&(e=!0),this.setState({lookUpData:t.EntityResult,SupplierEnable:e})}else console.log("Error in getLookUpData: ",t.ErrorList)})).catch((e=>{console.log("SealMasterDetailsComposite: Error occurred on getLookUpData",e)}))}getLookUpHsEInSpectionEnableData(){I()(w.xAA+"?LookUpTypeCode=HSEInspection",d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(console.log(t),!0===t.IsSuccess){let e=!1;"True"===t.EntityResult.EnableRoad&&(e=!0),this.setState({isHSEInspectionEnable:e})}else console.log("Error in getLookUpData: ",t.ErrorList)})).catch((e=>{console.log("SealMasterDetailsComposite: Error occurred on getLookUpData",e)}))}IsBonded(){I()(w.xAA+"?LookUpTypeCode=Bonding",d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{const t=e.data;if(!0===t.IsSuccess){let e=t.EntityResult["EnableBondingNon-Bonding"];this.setState({isBonded:"TRUE"===e.toUpperCase()})}else this.setState({isBonded:!1}),console.log("Error in get IsBonded: ",t.ErrorList)})).catch((e=>{this.setState({isBonded:!1}),console.log("SealMasterDetailsComposite: Error occurred on get IsBonded",e)}))}getBaseProducts(e){I()(w.Odh+"?TerminalCode="+e,d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){let e=d.Zj(t.EntityResult);this.setState({baseProductOptions:e})}}else console.log("Error in getBaseProducts:",t.ErrorList)})).catch((e=>{console.log("Error while getting BaseProducts:",e)}))}getCustomerInventory(e){var t=[{key:f.ml,value:e.ReceiptCode},{key:f.Ln,value:h.LY.ROAD}],s={ShareHolderCode:this.props.selectedShareholder,keyDataCode:f.ml,KeyCodes:t};I()(w.R$o,d.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{if(e.data.IsSuccess){let t=e.data.EntityResult;console.log("customerr",t),this.setState({modCustomerInventory:t})}else this.setState({modCustomerInventory:[]})})).catch((e=>{console.log("Error while getting shipment custom details:",e)}))}GetBayByTrnsaction(e,t,s,i){var a={ShareHolderCode:s,KeyCodes:[{key:f.yz,value:e},{key:f.D_,value:t}]};I()(w.nfn,d.tW(a,this.props.tokenDetails.tokenInfo),d.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;t.IsSuccess&&this.setState({ReceiptBay:t.EntityResult.BayCode},i)})).catch((e=>{console.log("Error while GetBayByTrnsaction:",e)}))}AllocateBay(e,t,s){var i=[{key:f.yz,value:e},{key:f.Kz,value:t},{key:f.EW,value:s}],a={ShareHolderCode:this.props.selectedShareholder,keyDataCode:f.ml,KeyCodes:i};let o={messageType:"critical",message:"BayAllocation_SaveStatus",messageResultDetails:[{keyFields:["BayCode"],keyValues:[t],isSuccess:!1,errorMessage:""}]};I()(w.AiH,d.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;o.messageType=t.IsSuccess?"success":"critical",o.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?(this.getReceipt({Common_Code:this.state.modReceipt.ReceiptCode},0,o),this.setState({isAllocateBay:!1})):(o.messageResultDetails[0].errorMessage=t.ResultDataList[0].ErrorList[0],this.props.onSaved(this.state.modReceipt,"update",o))})).catch((e=>{console.log("Error while AllocateBay:",e)}))}DeAllocateBay(e,t,s){var i=[{key:f.yz,value:e},{key:f.EW,value:t}],a={ShareHolderCode:this.props.selectedShareholder,KeyCodes:i};let o={messageType:"critical",message:"BayDeAllocation_SavedStatus",messageResultDetails:[{keyFields:["BayCode"],keyValues:[s],isSuccess:!1,errorMessage:""}]};I()(w.viJ,d.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;o.messageType=t.IsSuccess?"success":"critical",o.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getReceipt({Common_Code:this.state.modReceipt.ReceiptCode},0,o):(o.messageResultDetails[0].errorMessage=t.ErrorList[0],this.props.onSaved(this.state.modReceipt,"update",o))})).catch((e=>{console.log("Error while DeAllocateBay:",e)}))}getKPIList(e,t){if(!0===d.ab(this.props.userDetails.EntityResult.FunctionsList,b.i.view,b.bL)){let s={PageName:_.rj,TransportationType:h.LY.ROAD,InputParameters:[{key:"ShareholderCode",value:e},{key:"ReceiptCode",value:t}]};I()(w.dxq,d.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({truckReceiptKPIList:t.EntityResult.ListKPIDetails}):(this.setState({truckReceiptKPIList:[]}),console.log("Error in truck Receipt KPIList:",t.ErrorList))})).catch((e=>{console.log("Error while getting truck Receipt KPIList:",e)}))}}getFunctionGroupName(){return this.state.showReceiptAuthenticationLayout?b.m0:this.state.showCloseReceiptAuthenticationLayout?b.Fy:this.state.showAllowToUnLoadAuthenticationLayout||this.state.showAuthorizeToUnLoadAuthenticationLayout?b.yx:this.state.showViewBODAuthenticationLayout||this.state.showPrintBODAuthenticationLayout?b.Pb:this.state.showRANAuthenticationLayout?b.By:void 0}getDeleteorEditMode(){return this.state.showReceiptAuthenticationLayout&&""===this.state.receipt.ReceiptCode?b.i.add:b.i.modify}handleOperation(){return this.state.showReceiptAuthenticationLayout?this.handleSaveReceipt:this.state.showAuthorizeToUnLoadAuthenticationLayout?this.authorizeToUnLoad:this.state.showAllowToUnLoadAuthenticationLayout?this.allowToUnLoad:this.state.showCloseReceiptAuthenticationLayout?this.handleReceiptClose:this.state.showRANAuthenticationLayout?this.printRAN:this.state.showViewBODAuthenticationLayout?this.viewBOD:this.state.showPrintBODAuthenticationLayout?this.printBOD:void 0}render(){const e=[{fieldName:"Receipt_LastUpdated",fieldValue:new Date(this.state.modReceipt.LastUpdatedTime).toLocaleDateString()+" "+new Date(this.state.modReceipt.LastUpdatedTime).toLocaleTimeString()},{fieldName:"Receipt_LastActiveTime",fieldValue:void 0!==this.state.modReceipt.LastActiveTime&&null!==this.state.modReceipt.LastActiveTime?new Date(this.state.modReceipt.LastActiveTime).toLocaleDateString()+" "+new Date(this.state.modReceipt.LastActiveTime).toLocaleTimeString():""},{fieldName:"Receipt_CreatedTime",fieldValue:new Date(this.state.modReceipt.CreatedTime).toLocaleDateString()+" "+new Date(this.state.modReceipt.CreatedTime).toLocaleTimeString()}];return this.state.isReadyToRender?(0,m.jsxs)("div",{children:[(0,m.jsx)(l.TranslationConsumer,{children:t=>(0,m.jsx)(u.A,{children:(0,m.jsx)(D.A,{entityCode:this.state.isManualEntry?this.state.receipt.ReceiptCode+"\xa0-\xa0"+t("LoadingDetailsEntry_Title"):this.state.receipt.ReceiptCode,newEntityName:"Receipt_NewReceiptByCompartment",popUpContents:e})})}),this.state.isViewUnloading?(0,m.jsxs)(u.A,{children:[(0,m.jsx)(l.TranslationConsumer,{children:t=>(0,m.jsx)(D.A,{newEntityName:"ViewReceiptList_ViewTransactions",popUpContents:e})}),(0,m.jsx)(O.S,{ModViewUnloadDetails:this.state.ModViewUnloadDetails,handleBack:this.onBack,expandedRows:this.state.loadingExpandedRows,toggleExpand:this.loadingToggleExpand})]}):this.state.isViewAuditTrail?(0,m.jsx)(u.A,{children:(0,m.jsx)(k._,{ReceiptCode:this.state.modReceipt.ReceiptCode,selectedRow:this.state.selectedRow,auditTrailList:this.state.auditTrailList,modAuditTrailList:this.state.modAuditTrailList,handleBack:this.onBack})}):this.state.isManualEntry?(0,m.jsx)("div",{children:(0,m.jsx)(u.A,{children:(0,m.jsx)(L.default,{receipt:this.state.modReceipt,handleBack:this.onBack,selectedShareholder:this.props.selectedShareholder})})}):(0,m.jsxs)("div",{children:[(0,m.jsx)(U.A,{KPIList:this.state.truckReceiptKPIList,children:" "}),(0,m.jsxs)("div",{className:this.state.isPlanned?this.state.drawerStatus?"drawerClose":"showShipmentStatusRightPane":"",children:[(0,m.jsx)(u.A,{children:(0,m.jsx)(C,{receipt:this.state.receipt,modReceipt:this.state.modReceipt,modAssociations:this.state.modAssociations,validationErrors:this.state.validationErrors,modCompartments:this.state.modCompartments,modCustomerInventory:this.state.modCustomerInventory,IsPastDisable:this.state.IsPastDisable,SupplierEnable:this.state.SupplierEnable,isBonded:this.state.isBonded,listOptions:{terminalCodes:this.props.terminalCodes,quantityUOMOptions:this.state.quantityUOMOptions,vehicleOptions:this.getVehicleSearchOptions(),driverOptions:this.getDriverSearchOptions(),supplierOriginOptions:this.state.supplierOriginTerminalsList,compSeqOptions:this.state.compSeqOptions,finishedProductOptions:this.state.finishedProductOptions,baseProductOptions:this.state.baseProductOptions,customerCode:this.state.customerCode,customerptions:this.state.customerptions,customerOptions:this.state.customerOptions,supplierOptions:this.state.supplierOptions},selectedAssociations:this.state.selectedAssociations,searchResults:{vehicleOptions:this.state.vehicleSearchOptions,driverOptions:this.state.driverSearchOptions},handleRowSelectionChange:this.handleAssociationSelectionChange,onFieldChange:this.handleChange,onAllTerminalsChange:this.handleAllTerminalsChange,handleAddAssociation:this.handleAddAssociation,handleDeleteAssociation:this.handleDeleteAssociation,handleCellDataEdit:this.handleCellDataEdit,handleCellCompartmentDataEdit:this.handleCellCompartmentDataEdit,isHSEInspectionEnable:this.state.isHSEInspectionEnable,handleCustomerInventory:this.handleCustomerInventory,selectedCustomerInventory:this.state.selectedCustomerInventory,selectedAttributeList:this.state.selectedAttributeList,attributeValidationErrors:this.state.attributeValidationErrors,handleAttributeCellDataEdit:this.handleAttributeCellDataEdit,handleCompAttributeCellDataEdit:this.handleCompAttributeCellDataEdit,handleAddCustomerInventory:this.handleAddCustomerInventory,handleDeleteCustomerInventory:this.handleDeleteCustomerInventory,handleCustomerSelectionChange:this.handleCustomerSelectionChange,onDateTextChange:this.handleDateTextChange,onActiveStatusChange:this.handleActiveStatusChange,onVehicleChange:this.handleVehicleChange,onSupplierChange:this.handleSupplierChange,onVehicleSearchChange:this.handleVehicleSearchChange,onDriverChange:this.handleDriverChange,onDriverSearchChange:this.handleDriverSearchChange,onDriverResultsClear:this.handleDriverResultsClear,onVehicleResultsClear:this.handleVehicleResultsClear,isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,IsWebPortalUser:this.props.userDetails.EntityResult.IsWebPortalUser,isSlotbookinginUI:this.props.userDetails.EntityResult.ShowSlotBookedInUI,compartmentDetailsPageSize:this.props.userDetails.EntityResult.PageAttibutes.WebPortalListPageSize,customerInventoryTab:this.state.customerInventoryTab,compartmentTab:!1!==this.state.isPlanned,recordweightTab:this.state.recordweightTab,expandedRows:this.state.expandedRows,toggleExpand:this.toggleExpand,attributeToggleExpand:this.attributeToggleExpand,compartmentDetailsSave:this.compartmentDetailsSave,handleCellCheck:this.handleCellCheck,activeTab:this.state.activeTab,onTabChange:this.handleTabChange,UpdateReceiptBondNo:this.UpdateReceiptBondNo,modRecordWeight:this.state.modRecordWeight,modCustomValues:this.state.modCustomValues,ReceiptBay:this.state.ReceiptBay,UpdateReceiptDriver:this.UpdateReceiptDriver,isWebportalCarrierRoleUser:"carriercompany"===this.props.userDetails.EntityResult.RoleName.toLowerCase()&&this.props.userDetails.EntityResult.IsWebPortalUser})}),(0,m.jsx)(u.A,{children:(0,m.jsx)(y.q,{handleBack:this.props.onBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.saveEnabled})})]}),(0,m.jsxs)("div",{children:[this.state.isPlanned?(0,m.jsx)("div",{className:this.state.drawerStatus?"marineStatusLeftPane":"",children:(0,m.jsx)(l.TranslationConsumer,{children:e=>(0,m.jsx)(g.A,{selectedItem:[{Common_Code:this.state.modReceipt.ReceiptCode}],shipmentNextOperations:this.state.shipmentNextOperations,handleDetailsPageClick:this.handleRowClick,handleOperationButtonClick:this.handleOperationClick,currentStatuses:this.state.currentReceiptStatus,isDetails:!0,isWebPortalUser:this.props.userDetails.EntityResult.IsWebPortalUser,webPortalAllowedOperations:["ViewReceipt_ViewUnloading","ViewReceipt_ViewBOD","ViewReceipt_ViewAuditTrail"],handleDrawer:this.handleDrawer,isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,unAllowedOperations:["ViewReceipt_ManualEntry","ViewReceipt_AuthorizeUnLoad","ViewReceipt_AllowUnLoad","ViewAllocateBay_AllocateBay","ViewAllocateBay_DeallocateBay","ViewReceipt_PrintRAN","ViewReceipt_RecordWeight","ViewReceipt_PrintBOD","ViewReceipt_SendBOD"]})})}):"",this.state.showReceiptAuthenticationLayout||this.state.showAllowToUnLoadAuthenticationLayout||this.state.showAuthorizeToUnLoadAuthenticationLayout||this.state.showCloseReceiptAuthenticationLayout||this.state.showViewBODAuthenticationLayout||this.state.showPrintBODAuthenticationLayout||this.state.showRANAuthenticationLayout?(0,m.jsx)(P.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:this.getDeleteorEditMode(),functionGroup:this.getFunctionGroupName(),handleClose:this.handleAuthenticationClose,handleOperation:this.handleOperation()}):null]})]}),this.state.isRecordWeight?this.handleRecordWeight():null,this.state.vehicleBondPopUp?this.confirmVehicleBond():null,this.state.vehicleBondExpiryPopUp?this.confirmVehicleBondExpiryDate():null,this.state.isSealCompartments?(0,m.jsx)(u.A,{children:(0,m.jsx)(B.default,{transactionCode:this.state.receipt.ReceiptCode,selectedShareholder:this.props.selectedShareholder,sealCompartments:this.state.sealCompartments,handleSealClose:this.handleSealClose})}):null,this.state.stockProducts?this.confirmBondedStockProducts():null,this.state.isCloseReceipt?this.handleCloseReceipttModal():null,this.state.isAllocateBay?this.confirmAllocateBay():null,this.state.isDeAllocateBay?this.confirmDeAllocateBay():null]}):(0,m.jsx)(E.A,{message:"Loading"})}}const W=(0,a.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(M)},61765:(e,t,s)=>{s.r(t),s.d(t,{default:()=>E});var i=s(65043),a=s(97508),o=s(69062),l=s(28882),r=s(65187),n=s(53536),c=s.n(n),d=s(40854),h=s.n(d),p=s(93779),u=s(72067),m=s(11981),C=s(14159),g=s(67907),R=s(72711),S=s(78374),y=s(70579);class D extends i.Component{constructor(){super(...arguments),this.state={sealCompartments:this.props.sealCompartments},this.updateSealCompartments=()=>{let e=c().cloneDeep(this.state.sealCompartments),t={messageType:"critical",message:"ViewAllReceipt_SealCompUpdate",messageResultDetails:[]};if(e.forEach((e=>{l.F1.forEach((s=>{let i="";void 0!==s.validator&&(i=o.jr(s.validator,e[s.field])),""!==i&&t.messageResultDetails.push({keyFields:["ShipmentCompDetail_CompSeqInVehicle",s.displayName],keyValues:[e.CompartmentSeqNoInVehicle,e[s.field]],isSuccess:!1,errorMessage:i})}))})),t.messageResultDetails.length>0)(0,C.toast)((0,y.jsx)(r.A,{children:(0,y.jsx)(m.A,{notificationMessage:t})}),{autoClose:"success"===t.messageType&&1e4});else{t.messageResultDetails.push({keyFields:["Receipt_Code"],keyValues:[this.props.transactionCode],isSuccess:!1,errorMessage:""});var s=[{key:p.FR,value:this.props.selectedShareholder},{key:p.ml,value:this.props.transactionCode}],i={ShareHolderCode:this.props.selectedShareholder,keyDataCode:p.ml,KeyCodes:s,Entity:this.state.sealCompartments};h()(u.yIB,o.tW(i,this.props.tokenDetails.tokenInfo)).then((e=>{var s=e.data;t.messageType=s.IsSuccess?"success":"critical",t.messageResultDetails[0].isSuccess=s.IsSuccess,t.messageResultDetails[0].errorMessage=s.ErrorList[0],(0,C.toast)((0,y.jsx)(r.A,{children:(0,y.jsx)(m.A,{notificationMessage:t})}),{autoClose:"success"===t.messageType&&1e4})})).catch((e=>{console.log("Error while update Receipt Seal Info:",e)}))}},this.handleSealNoInput=e=>{let t=e.rowData;return(0,y.jsx)(R.Input,{fluid:!0,value:t.SealNo,disabled:!1,onChange:e=>{let s=c().cloneDeep(this.state.sealCompartments),i=s.findIndex((e=>e.CompartmentSeqNoInVehicle===t.CompartmentSeqNoInVehicle));i>=0&&(s[i].SealNo=e),this.setState({sealCompartments:s})},reserveSpace:!1})}}getCustomtableData(e){const t=[];return e.forEach((e=>{t.push({SealNo:null===e.SealNo?"":e.SealNo,CompartmentSeqNoInVehicle:e.CompartmentSeqNoInVehicle,FinishedProductCode:null===e.FinishedProductCode?"":e.FinishedProductCode,ReceiptCompartmentStatus:null===e.ReceiptCompartmentStatus?"":e.ReceiptCompartmentStatus,UnLoadedQty:null===e.UnLoadedQuantity?"":e.UnLoadedQuantity+" "+e.UnLoadedQuantityUOM})})),t}isNodeEnterpriseOrWebortal(){return!(!this.props.userDetails.EntityResult.IsEnterpriseNode&&!this.props.userDetails.EntityResult.IsWebPortalUser)}render(){return(0,y.jsx)("div",{children:(0,y.jsx)(g.TranslationConsumer,{children:e=>(0,y.jsxs)(R.Modal,{open:!0,size:"large",className:"sealCompartmentsPopUp",children:[(0,y.jsxs)(R.Modal.Content,{children:[(0,y.jsx)("div",{className:"col col-lg-12",children:(0,y.jsx)("h3",{children:e("ViewAllReceipt_SealCompartment")+" : "+this.props.transactionCode})}),(0,y.jsx)("div",{className:"col-12 detailsTable",children:(0,y.jsxs)(S.bQ,{data:this.getCustomtableData(this.state.sealCompartments),children:[(0,y.jsx)(S.bQ.Column,{className:"compColHeight",field:"CompartmentSeqNoInVehicle",header:e("ViewShipment_CompartmentSeq"),editable:!1}),(0,y.jsx)(S.bQ.Column,{className:"compColHeight",field:"FinishedProductCode",header:e("ViewShipment_FinishedProductCode"),editable:!1}),(0,y.jsx)(S.bQ.Column,{className:"compColHeight",field:"ReceiptCompartmentStatus",header:e("ViewShipment_Status"),editable:!1}),(0,y.jsx)(S.bQ.Column,{className:"compColHeight",field:"UnLoadedQty",header:e("ViewReceiptList_LoadedQuantity"),editable:!1}),(0,y.jsx)(S.bQ.Column,{className:"compColHeight",field:"SealNo",header:e("SealMaster_SealNo"),renderer:e=>this.handleSealNoInput(e)})]})})]}),(0,y.jsxs)(R.Modal.Footer,{children:[(0,y.jsx)(R.Button,{content:e("MarineEOD_Close"),className:"cancelButton",onClick:this.props.handleSealClose}),(0,y.jsx)(R.Button,{type:"primary",content:e("SealMaster_Save"),disabled:this.isNodeEnterpriseOrWebortal(),onClick:this.updateSealCompartments})]})]})})})}}const E=(0,a.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(D)},24904:(e,t,s)=>{s.d(t,{y:()=>r});s(65043);var i=s(67907),a=s(72711),o=s(69062),l=s(70579);function r(e){let{terminalList:t,selectedTerminal:s,validationError:r,onFieldChange:n,onCheckChange:c}=e;return null===s&&(s=[]),(0,l.jsx)(i.TranslationConsumer,{children:e=>(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,l.jsx)("div",{style:{width:"80%"},children:(0,l.jsx)(a.Select,{fluid:!0,placeholder:e("Common_Select"),label:e("TerminalCodes"),value:s,multiple:!0,options:o.Zj(t),onChange:e=>n("TerminalCodes",e),error:e(r),disabled:0===t.length,reserveSpace:!1})}),(0,l.jsx)("div",{className:"ddlSelectAll",children:(0,l.jsx)(a.Checkbox,{label:e("Common_All"),checked:Array.isArray(s)&&s.length===t.length,onChange:e=>c(e)})})]})})}r.defaultProps={terminalList:[],selectedTerminal:[],validationError:""}},67982:(e,t,s)=>{s.d(t,{_:()=>h});var i=s(65043),a=s(67907),o=s(72711),l=s(7523),r=s(78374),n=s(45127),c=s(728),d=s(70579);function h(e){let{ReceiptCode:t,auditTrailList:s,handleBack:c,modAuditTrailList:h}=e;const p=null!==s&&void 0!==s&&s.length>0&&null!==s[0].DRIVERNAME&&void 0!==s[0].DRIVERNAME&&""!==s[0].DRIVERNAME?s[0].DRIVERNAME:"",u=null!==s&&void 0!==s&&s.length>0&&null!==s[0].DRIVERCODE&&void 0!==s[0].DRIVERCODE&&""!==s[0].DRIVERCODE?s[0].DRIVERCODE:"",m=e=>e===l.gB.EMPTY?"EMPTY":e===l.gB.UNLOADING?"UNLOADING":e===l.gB.PART_UNLOADED?"PART_UNLOADED":e===l.gB.OVER_UNLOADED?"OVER_UNLOADED":e===l.gB.FORCE_COMPLETED?"FORCE_COMPLETED":e===l.gB.COMPLETED?"COMPLETED":e===l.gB.INTERRUPTED?"INTERRUPTED":e===l.gB.UNLOAD_NOTSTARTED?"UNLOAD_NOTSTARTED":"",[C,g]=(0,i.useState)(!1),R=(e,t)=>{try{if(t.cls=null,e.fontSize="7px",t.val===l.PH.AUTO_LOADED)t.text=l.a$.AUTO_UNLOADED;else if(t.val===l.PH.CHECKED_IN)t.text=l.a$.CHECKED_IN;else if(t.val===l.PH.CLOSED)t.text=l.a$.CLOSED;else if(t.val===l.PH.INTERRUPTED)t.text=l.a$.INTERRUPTED;else if(t.val===l.PH.UNLOADING)t.text=l.a$.UNLOADING;else if(t.val===l.PH.MANUALLY_UNLOADED)t.text=l.a$.MANUALLY_UNLOADED;else if(t.val===l.PH.PARTIALLY_UNLOADED)t.text=l.a$.PARTIALLY_UNLOADED;else if(t.val===l.PH.QUEUED)t.text=l.a$.QUEUED;else if(t.val===l.PH.READY)t.text=l.a$.READY;else if(t.val===l.PH.DE_QUEUED)t.text=l.a$.DE_QUEUED;else if(t.val===l.PH.WEIGHED_IN)t.text=l.a$.WEIGHED_IN;else if(t.val===l.PH.WEIGHED_OUT)t.text=l.a$.WEIGHED_OUT;else if(t.val===l.PH.USER_DEFINED){let e=h.findIndex((e=>e.Receipt_Status===t.val));t.text=-1!==e?h[e].ReceiptStatus:l.a$.USER_DEFINED}else t.val===l.PH.ASSIGNED?t.text=l.a$.ASSIGNED:t.val===l.PH.CANCELLED?t.text=l.a$.CANCELLED:t.val===l.PH.EXPIRED?t.text=l.a$.EXPIRED:t.val===l.PH.REJECTED&&(t.text=l.a$.REJECTED)}catch(s){console.log("Error in formatter",s)}return t};return(0,d.jsxs)("div",{children:[(0,d.jsx)(a.TranslationConsumer,{children:e=>(0,d.jsx)("div",{children:(0,d.jsxs)("div",{className:"detailsContainer",children:[(0,d.jsxs)("div",{id:"printTable",children:[(0,d.jsx)("div",{className:"row",children:(0,d.jsx)("div",{className:"col-12",children:(0,d.jsx)("h3",{children:e("ViewAuditTrail_ViewAuditTrailForReceipt")+" : "+t})})}),(0,d.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,d.jsx)("div",{className:"col-12 container-fluid",children:(0,d.jsxs)(n.IO,{itemsSource:h,chartType:"Line",bindingX:"UpdatedTime",palette:["red"],style:{width:"100%",minWidth:"800px",height:"450px"},children:[(0,d.jsx)(n.tN,{position:"Bottom"}),(0,d.jsx)(n.vc,{wjProperty:"axisY",majorUnit:1,max:16,min:0,itemFormatter:R,axisLine:!0}),(0,d.jsx)(n.t3,{binding:"Receipt_Status",name:"Receipt_Status"})]})})}),(0,d.jsxs)("div",{className:"row marginRightZero",children:[(0,d.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,d.jsx)("label",{children:e("ViewAuditTrail_DriverCode")+" : "+u})}),(0,d.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,d.jsx)("label",{children:e("DriverInfo_DriverName")+" : "+p})})]}),(0,d.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,d.jsx)("div",{className:"col-12 detailsTable",children:(0,d.jsxs)(r.bQ,{data:s,scrollable:!0,children:[(0,d.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"ReceiptStatus",header:e("ViewReceiptAuditTrail_ReceiptStatus"),editable:!1,editFieldType:"text"},"ReceiptStatus"),(0,d.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"UpdatedTime",header:e("ViewAuditTrail_UpdatedTime"),editable:!1,editFieldType:"text"},"UpdatedTime"),(0,d.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",header:e("ViewAuditTrail_ShipmentCompartmentSeq"),field:"CompartmentSeqNoInVehicle",editable:!1,editFieldType:"text"}),(0,d.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",field:"ReceiptCompartmentStatus",header:e("ViewAuditTrail_ShipmentCompartmentStatus"),editable:!1,renderer:e=>m(e.rowData.ReceiptCompartmentStatus),editFieldType:"text"},"ReceiptCompartmentStatus"),(0,d.jsx)(r.bQ.Column,{className:"compColHeight colminWidth",header:e("ViewAuditTrail_DriverPIN"),editable:!1,field:"DriverPin",editFieldType:"text"})]})})})]}),(0,d.jsxs)("div",{className:"row",children:[(0,d.jsx)("div",{className:"col-12 col-sm-6 col-lg-8",children:(0,d.jsx)(o.Button,{className:"backButton",onClick:c,content:e("Back")})}),(0,d.jsx)("div",{className:"col-12 col-sm-6 col-lg-4",style:{textAlign:"right"},children:(0,d.jsx)(o.Button,{className:"printButton",onClick:()=>{g(!0)},content:e("ViewAuditTrail_PrintAuditTrail")})})]})]})})}),(0,d.jsx)(a.TranslationConsumer,{children:e=>(0,d.jsx)(o.Modal,{open:C,className:"marineModalPrint",children:(0,d.jsxs)(o.Modal.Content,{children:[(0,d.jsxs)("div",{style:{display:"flex",flexWrap:"wrap"},children:[(0,d.jsx)("div",{className:"col col-lg-8",children:(0,d.jsx)("h3",{children:e("Transaction_AuditTrail_Heading")+" : "+t})}),(0,d.jsx)("div",{className:"col col-lg-4",style:{textAlign:"right"},children:(0,d.jsx)("div",{onClick:()=>{g(!1)},children:(0,d.jsx)(o.Icon,{root:"common",name:"close"})})})]}),(0,d.jsx)("div",{className:"col-md-10 container-fluid",children:(0,d.jsxs)(n.IO,{itemsSource:h,chartType:"Line",bindingX:"UpdatedTime",palette:["red"],style:{width:"100%",height:"450px"},children:[(0,d.jsx)(n.tN,{position:"Bottom"}),(0,d.jsx)(n.vc,{wjProperty:"axisY",majorUnit:1,max:16,min:0,itemFormatter:R,axisLine:!0}),(0,d.jsx)(n.t3,{binding:"Receipt_Status",name:"Receipt_Status"})]})}),(0,d.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,d.jsx)("label",{children:e("ViewAuditTrail_DriverCode")+" : "+u})}),(0,d.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,d.jsx)("label",{children:e("DriverInfo_DriverName")+" : "+p})}),(0,d.jsx)("div",{className:"col-12 detailsTable",children:(0,d.jsxs)(r.bQ,{data:s,children:[(0,d.jsx)(r.bQ.Column,{className:"compColHeight",field:"ReceiptStatus",header:e("ViewReceiptAuditTrail_ReceiptStatus"),editable:!1,editFieldType:"text"},"ReceiptStatus"),(0,d.jsx)(r.bQ.Column,{className:"compColHeight",field:"UpdatedTime",header:e("ViewAuditTrail_UpdatedTime"),editable:!1,editFieldType:"text"},"UpdatedTime"),(0,d.jsx)(r.bQ.Column,{className:"compColHeight",header:e("ViewAuditTrail_ShipmentCompartmentSeq"),field:"CompartmentSeqNoInVehicle",editable:!1,editFieldType:"text"}),(0,d.jsx)(r.bQ.Column,{className:"compColHeight",field:"ReceiptCompartmentStatus",header:e("ViewAuditTrail_ShipmentCompartmentStatus"),editable:!1,renderer:e=>m(e.rowData.ReceiptCompartmentStatus),editFieldType:"text"},"ReceiptCompartmentStatus"),(0,d.jsx)(r.bQ.Column,{className:"compColHeight",header:e("ViewAuditTrail_DriverPIN"),editable:!1,field:"DriverPin",editFieldType:"text"})]})}),(0,d.jsxs)(o.Modal.Footer,{children:[(0,d.jsx)(o.Button,{type:"primary",size:"small",content:e("ViewAuditTrail_Print"),onClick:()=>{let e=window.document.getElementById("printTable").innerHTML;const t=window.document.createElement("IFRAME");let s=null;window.document.body.appendChild(t),s=t.contentWindow.document;const i=e.substring(0,e.indexOf("<table")+6),a=e.substring(e.indexOf("<table")+6,e.length);e=i+' border="1" cellspacing="1"'+a,s.write(e),s.close(),t.contentWindow.focus(),t.contentWindow.print(),setTimeout((()=>{window.document.body.removeChild(t)}),2e3)}}),(0,d.jsx)(o.Button,{type:"primary",size:"small",content:e("MarineEOD_Close"),onClick:()=>{g(!1)}})]})]})})})]})}c.setLicenseKey(l.yQ),h.defaultProps={}},80221:(e,t,s)=>{s.d(t,{S:()=>r});s(65043);var i=s(78374),a=s(67907),o=s(72711),l=s(70579);function r(e){let{ModViewUnloadDetails:t,handleBack:s,toggleExpand:r,expandedRows:n}=e;const[c]=(0,a.useTranslation)();return(0,l.jsxs)("div",{className:"detailsContainer",children:[(0,l.jsx)("div",{className:"row marginRightZero tableScroll",children:(0,l.jsx)("div",{className:"detailsTable loadingTable",children:(0,l.jsxs)(i.bQ,{data:t,scrollable:!0,bAutoWidth:!0,scrollHeight:"450px",resizableColumns:!0,rowExpansionTemplate:function(e){let t=[e],s=[e];return Array.isArray(t)&&t.length>0?(0,l.jsxs)("div",{className:"childTable ChildGridViewAllShipmentLoadingDetails",children:[(0,l.jsxs)(i.bQ,{data:t,children:[(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"baycode",header:c("LoadingDetails_BayCode"),initialWidth:"107px",editable:!1},"baycode"),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"bcucode",header:c("BCU_Code"),initialWidth:"107px",editable:!1},"bcucode"),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"grossquantity",header:c("LoadingDetails_GrossQuantity"),initialWidth:"107px",editable:!1},"grossquantity"),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"netquantity",header:c("LoadingDetails_NetQuantity"),initialWidth:"107px",editable:!1},"netquantity"),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"starttime",header:c("LoadingDetails_StartTime"),editable:!1},"starttime"),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"endtime",header:c("LoadingDetails_EndTime"),editable:!1},"endtime"),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"productdensity",header:c("LoadingDetails_ProductDensity"),editable:!1,initialWidth:"95px"},"productdensity"),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"metercode",header:c("LoadingDetails_MeterCode"),editable:!1,initialWidth:"77px"},"metercode")]}),(0,l.jsxs)(i.bQ,{data:s,children:[(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"starttotalizer",header:c("StartTotalizer"),editable:!1,initialWidth:"90px"},"starttotalizer"),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"endtotalizer",header:c("EndTotalizer"),editable:!1,initialWidth:"90px"},"endtotalizer"),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"weightinvacuum",header:c("UnloadingDetails_WeightInVacuum"),editable:!1,initialWidth:"98px"},"weightinvacuum"),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"weightinair",header:c("UnloadingDetails_WeightInAir"),editable:!1,initialWidth:"84px"},"weightinair"),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"temperature",header:c("LoadingDetails_Temperature"),editable:!1,initialWidth:"116px"},"temperature"),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"pressure",header:c("LoadingDetails_Pressure"),editable:!1,initialWidth:"93px"},"pressure")]})]}):(0,l.jsx)("div",{className:"compartmentIcon",children:(0,l.jsx)("div",{className:"gridButtonAlignLeft",children:c("CustomerInventory_NoRecordsFound")})})},expandedRows:n,children:[(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"trailercode",initialWidth:"125px",header:c("ViewReceipt_TrailerCode")},"trailercode "),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"CompartmentSeqNoInVehicle",initialWidth:"146px",header:c("Receipt_CompSeqInVehicle")},"CompartmentSeqNoInVehicle"),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"compartmentcode",initialWidth:"165px",header:c("Receipt_CompartmentCode")},"compartmentcode"),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"FinishedProductcode",initialWidth:"130px",header:c("Report_ProductCode")},"FinishedProductcode"),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"baseProductcode",initialWidth:"155px",header:c("BaseProductCode")},"baseProductcode"),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"Unloadingdetailstype",initialWidth:"190px",header:c("UnloadingDetails_UnloadingDetailsType")},"Unloadingdetailstype"),(0,l.jsx)(i.bQ.Column,{className:"compColHeight",field:"TankCode",initialWidth:"105px",header:c("TankList_Code")},"TankCode"),(0,l.jsx)(i.bQ.Column,{className:"expandedColumn",initialWidth:"22px",renderer:e=>{const t=n.findIndex((t=>t.seqNo===e.rowData.seqNo))>=0;return(0,l.jsx)("div",{onClick:()=>r(e.rowData,t),className:"compartmentIcon gridButtonFontColor",children:(0,l.jsx)(o.Icon,{root:"common",name:t?"slidercontrols-minus":"ellipsis-horizontal",className:"margin_l10"})})}})]})})}),(0,l.jsx)("div",{className:"col col-lg-8",children:(0,l.jsx)(o.Button,{className:"backButton",onClick:s,content:c("Back")})})]})}r.defaultProps={}}}]);
//# sourceMappingURL=6826.c44ccd5f.chunk.js.map