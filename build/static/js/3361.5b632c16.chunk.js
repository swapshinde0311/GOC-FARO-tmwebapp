"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[3361],{40510:(t,e,s)=>{s.d(e,{A:()=>l});var a=s(65043),o=s(80297),n=s(65187),i=s(67907),r=s(70579);function l(t){let{KPIList:e,pageName:s,rowHeight:l,widgetHeight:u,isDraggable:d,isResizable:c,kpiDisplayTopBreakpoint:h}=t;const[T,E]=(0,a.useState)(1),p=a.useRef(null),m=()=>{let t=window.pageYOffset,e=T;if(p.current&&p.current.getBoundingClientRect().top<h)e=0;else{if(0!==t)return;e=1}E(e)};return(0,a.useEffect)((()=>{"undefined"!==typeof window&&window.addEventListener("scroll",m)})),(0,a.useEffect)((()=>()=>{window.removeEventListener("scroll",m)}),[]),(0,r.jsx)("div",{ref:p,children:1===T?(0,r.jsx)(i.TranslationConsumer,{children:t=>(0,r.jsx)("div",{style:{marginTop:"6px"},children:(0,r.jsx)(n.A,{children:(0,r.jsx)(o.A,{kpiList:e,isDraggable:d,isResizable:c,rowHeight:l,widgetHeight:u,pageName:s})})})}):""})}l.defaultProps={kpiDisplayTopBreakpoint:100}},33361:(t,e,s)=>{s.r(e),s.d(e,{default:()=>v});var a=s(65043),o=s(69062),n=s(40854),i=s.n(n),r=s(72067),l=s(53658),u=s(9256),d=s(97508),c=s(46100),h=s(44192),T=(s(38726),s(65187)),E=s(43503),p=s(93779),m=s(40252),I=s(53536),A=s.n(I),k=s(80312),C=s(14159),D=s(11981),g=s(15417),S=s(67907),R=s(72711),y=s(40510),M=s(39424),L=s(62900),N=s(70579);class O extends a.Component{constructor(){super(...arguments),this.state={tank:A().cloneDeep(c.KT),modTank:{},validationErrors:o.Th(h.Js),isReadyToRender:!1,saveEnabled:!1,terminalOptions:[],tankModeOptions:[],tankGroupOptions:[],attributeMetaDataList:[],modAttributeMetaDataList:[],attributeValidationErrors:[],tankGroupBaseProduts:{},volumeUOMOptions:[],weightUOMOptions:[],lengthUOMOptions:[],densityUOMOptions:[],massUOMOptions:[],temperatureUOMOptions:[],pressureUOMOptions:[],isEnableATGButton:!1,isEnableATGConfigButton:!1,isBondingEnable:!1,isATGEnabled:!1,atgInfoDisable:A().cloneDeep(o.ld),isChangeBondedStatus:!1,tankKPIList:[],showAuthenticationLayout:!1,tempTank:{}},this.handleChange=(t,e)=>{try{const s=A().cloneDeep(this.state.modTank),a=A().cloneDeep(this.state.tank);"IsBonded"===t&&(""!==a.Code?a.IsBonded!==e&&this.setState({isChangeBondedStatus:!0}):this.setState({isChangeBondedStatus:!0})),s[t]=e,this.setState({modTank:s});const n=A().cloneDeep(this.state.validationErrors);void 0!==h.Js[t]&&(n[t]=o.jr(h.Js[t],e),this.setState({validationErrors:n}))}catch(s){console.log("TankDetailsComposite:Error occured on handleChange",s)}},this.handleTerminalChange=t=>{try{const e=A().cloneDeep(this.state.modTank),s={...this.state.validationErrors};e.TerminalCode=t,e.BPDensityUOM="",e.BPMinDensity="",e.BPMaxDensity="",s.TerminalCode="",this.terminalSelectionChange([t]),this.setState({modTank:e,validationErrors:s},(()=>this.getTankGroup(t)))}catch(e){console.log("TankGroupDetailsComposite:Error occured on handleTerminalChange",e)}},this.handleTankGroupChange=t=>{try{const e=A().cloneDeep(this.state.modTank),s=A().cloneDeep(this.state.tankGroupBaseProduts),a={...this.state.validationErrors};e.TankGroupCode=t,e.BaseProductCode=s[t],e.BPDensityUOM="",e.BPMinDensity="",e.BPMaxDensity="",a.TankGroupCode="",this.setState({modTank:e,validationErrors:a},(()=>this.GetProductData(t)))}catch(e){console.log("TankDetailsComposite:Error occured on handleTankGroupChange",e)}},this.handleReset=()=>{try{const{validationErrors:t}={...this.state},e=A().cloneDeep(this.state.tank);Object.keys(t).forEach((function(e){t[e]=""})),this.setState({modTank:{...e},selectedCompRow:[],validationErrors:t,modAttributeMetaDataList:[]},(()=>{this.props.userDetails.EntityResult.IsEnterpriseNode?(this.terminalSelectionChange([e.TerminalCode]),this.handleResetAttributeValidationError()):(this.localNodeAttribute(),this.handleResetAttributeValidationError())}))}catch(t){console.log("TankDetailsComposite:Error occured on handleReset",t)}},this.handleAuthenticationClose=()=>{this.setState({showAuthenticationLayout:!1})},this.handleSave=()=>{try{let t=this.fillDetails(),e=o.pI(this.state.modAttributeMetaDataList);if(this.validateSave(t,e)){let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,s=A().cloneDeep(t);this.setState({showAuthenticationLayout:e,tempTank:s},(()=>{!1===e&&this.saveTank()}))}}catch(t){console.log("TankDetailsComposite:Error occured on handleSave",t)}},this.saveTank=()=>{try{this.setState({saveEnabled:!1});let t=A().cloneDeep(this.state.tempTank),e=o.pI(this.state.modAttributeMetaDataList);t=this.convertStringtoDecimal(t,e),""===this.state.tank.Code?this.createTank(t):this.updateTank(t)}catch(t){console.log("TankDetailsComposite : Error in saveTank")}},this.handleAttributeDataChange=(t,e)=>{try{let s=[],a=A().cloneDeep(this.state.modAttributeMetaDataList),n=a.filter((e=>e.TerminalCode===t.TerminalCode));n.length>0&&Array.isArray(n[0].attributeMetaDataList)&&(s=n[0].attributeMetaDataList.filter((e=>e.Code===t.Code))),s.length>0&&(s[0].DefaultValue=e);const i=A().cloneDeep(this.state.attributeValidationErrors);i.forEach((s=>{s.TerminalCode===t.TerminalCode&&(s.attributeValidationErrors[t.Code]=o.I5(t,e))})),this.setState({attributeValidationErrors:i,modAttributeMetaDataList:a})}catch(s){console.log("TankDetailsComposite:Error occured on handleAttributeDataChange",s)}},this.handleReadATGData=()=>{try{let t=A().cloneDeep(this.state.modTank),e={messageType:"critical",message:"TankInfo_ATGDataUpdateSuccess",messageResultDetails:[{keyFields:["TankTransaction_TankCode"],keyValues:[t.Code],isSuccess:!1,errorMessage:""}]};i()(r.J7_+"?TankCode="+t.Code,o.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var s=t.data;e.messageType=s.IsSuccess?"success":"critical",e.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?this.setState({modTank:A().cloneDeep(s.EntityResult)},(()=>{this.handleUOMValues()})):(null!==s.EntityResult&&this.setState({modTank:A().cloneDeep(s.EntityResult)},(()=>{this.handleUOMValues()})),e.messageResultDetails[0].errorMessage=s.ErrorList[0]),(0,C.toast)((0,N.jsx)(T.A,{children:(0,N.jsx)(D.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})}))}catch(t){console.log("TankDetailsComposite:Error occured on handleReadATGData",t)}},this.handleSaveATGData=()=>{try{let t=A().cloneDeep(this.state.modTank),e={keyDataCode:p.E7,Entity:t},s={messageType:"critical",message:"TankInfo_ReadATGDataSuccess",messageResultDetails:[{keyFields:["TankTransaction_TankCode"],keyValues:[t.Code],isSuccess:!1,errorMessage:""}]};i()(r.QW0,o.tW(e,this.props.tokenDetails.tokenInfo)).then((t=>{let e=t.data;s.messageType=e.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=e.IsSuccess,!0===e.IsSuccess||(s.messageResultDetails[0].errorMessage=e.ErrorList[0]),(0,C.toast)((0,N.jsx)(T.A,{children:(0,N.jsx)(D.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4})}))}catch(t){console.log("TankDetailsComposite:Error occured on handleSaveATGData",t)}},this.handleActiveStatusChange=t=>{try{let e=A().cloneDeep(this.state.modTank);e.Active=t,e.Active!==this.state.tank.Active&&(e.Remarks=""),this.setState({modTank:e})}catch(e){console.log(e)}},this.handleATGConfig=()=>{try{let t=A().cloneDeep(this.state.modTank);this.props.handleATGConfiguration(t,this.props.selectedRow)}catch(t){console.log(t)}},this.confirmChangeBondedStatus=()=>(0,N.jsx)(S.TranslationConsumer,{children:t=>(0,N.jsxs)(R.Modal,{open:this.state.isChangeBondedStatus,size:"small",children:[(0,N.jsx)(R.Modal.Content,{children:(0,N.jsx)("div",{className:"col col-lg-12",children:(0,N.jsx)("h5",{children:t("Tank_ChangeBondedStatus")})})}),(0,N.jsxs)(R.Modal.Footer,{children:[(0,N.jsx)(R.Button,{type:"primary",content:t("AccessCardInfo_Ok"),onClick:()=>{this.setState({isChangeBondedStatus:!1},(()=>{this.bondedStatusChanged()}))}}),(0,N.jsx)(R.Button,{type:"primary",content:t("Cancel"),onClick:()=>{this.setState({isChangeBondedStatus:!1})}})]})]})}),this.bondedStatusChanged=()=>{try{let t=A().cloneDeep(this.state.modTank);t.Remarks="",this.setState({modTank:t})}catch(t){console.log(t)}}}componentDidMount(){try{o.pJ(this.props.userDetails.EntityResult.IsArchived),this.getAttributes(this.props.selectedRow),this.GetTankMode(),this.props.userDetails.EntityResult.IsEnterpriseNode?this.getTerminal():this.getLocalNodeTankGroup(),this.getUOMList(),this.getLookUpData()}catch(t){console.log("TankDetailsCompositeComposite:Error occured on componentDidMount",t)}}componentWillReceiveProps(t){try{if(""!==this.state.tank.Code&&void 0===t.selectedRow.Common_Code&&this.props.tokenDetails.tokenInfo===t.tokenDetails.tokenInfo){this.getAttributes(t.selectedRow);let e={...this.state.validationErrors};Object.keys(e).forEach((t=>{e[t]=""})),this.setState({validationErrors:e})}}catch(e){console.log("TankDetailsComposite:Error occured on componentWillReceiveProps",e)}}getAttributes(t){try{i()(r.fKH,o.tW([g.dU],this.props.tokenDetails.tokenInfo)).then((e=>{var s=e.data;!0===s.IsSuccess?this.setState({attributeMetaDataList:A().cloneDeep(s.EntityResult),attributeValidationErrors:o.Fl(s.EntityResult.tank)},(()=>this.getTank(t))):console.log("Error in getAttributes:")}))}catch(e){console.log("Error while getAttributes:",e)}}getTank(t){if(void 0!==t.Common_Code){var e=[{key:p.E7,value:t.Common_Code},{key:p.uw,value:""!==t.TerminalCode?t.TerminalCode:null}],s={keyDataCode:p.E7,KeyCodes:e};i()(r.vQz,o.tW(s,this.props.tokenDetails.tokenInfo)).then((t=>{var e=t.data;!0===e.IsSuccess?(null===e.EntityResult.GrossVolume&&(e.EntityResult.GrossVolumeUOM=null),null===e.EntityResult.NetVolume&&(e.EntityResult.NetVolumeUOM=null),this.setState({isReadyToRender:!0,tank:A().cloneDeep(e.EntityResult),modTank:A().cloneDeep(e.EntityResult),saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,k.i.modify,k.VQ)},(()=>{this.handleTankGroupChange(e.EntityResult.TankGroupCode),this.getKPIList(e.EntityResult.Code),this.props.userDetails.EntityResult.IsEnterpriseNode?(this.handleTerminalChange(e.EntityResult.TerminalCode),this.terminalSelectionChange([e.EntityResult.TerminalCode])):this.localNodeAttribute(),this.GetTankATGConfiguration(e.EntityResult.Code)}))):(this.setState({tank:A().cloneDeep(c.KT),modTank:A().cloneDeep(c.KT),isReadyToRender:!0}),console.log("Error in getTank:",e.ErrorList))})).catch((e=>{console.log("Error while getting Tank:",e,t)}))}else this.setState({tank:A().cloneDeep(c.KT),modTank:A().cloneDeep(c.KT),isReadyToRender:!0,modAttributeMetaDataList:[],tankKPIList:[],saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,k.i.add,k.VQ),atgInfoDisable:A().cloneDeep(o.ld),isEnableATGButton:!1,isEnableATGConfigButton:!1},(()=>{this.props.userDetails.EntityResult.IsEnterpriseNode?this.terminalSelectionChange([]):this.localNodeAttribute()}))}GetTankATGConfiguration(t){const e=A().cloneDeep(this.state.atgInfoDisable),s=A().cloneDeep(this.state.isATGEnabled);try{i()(r.Zz9+"?TankCode="+t,o.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var a=t.data;!0===a.IsSuccess?(a.EntityResult.EnableTankScan&&!0===s&&a.EntityResult.AtgAttributeConfigurationData.forEach((t=>{!0===t.EnableScan&&("TankMode"===t.TankAttributeCode?e.TankMode=!0:"Density"===t.TankAttributeCode?e.Density=!0:"AvailableRoom"===t.TankAttributeCode?e.AvailableRoom=!0:"Temperature"===t.TankAttributeCode?e.Temperature=!0:"TankLevel"===t.TankAttributeCode?e.TankLevel=!0:"GrossVolume"===t.TankAttributeCode?e.GrossVolume=!0:"NetVolume"===t.TankAttributeCode?e.NetVolume=!0:"VapourGrossQuantity"===t.TankAttributeCode?e.VapourGrossQuantity=!0:"VapourNetQuantity"===t.TankAttributeCode?e.VapourNetQuantity=!0:"Pressure"===t.TankAttributeCode?e.Pressure=!0:"WaterLevel"===t.TankAttributeCode?e.WaterLevel=!0:"WaterVolume"===t.TankAttributeCode?e.WaterVolume=!0:"Mass"===t.TankAttributeCode?e.Mass=!0:"NetMass"===t.TankAttributeCode&&(e.NetMass=!0))})),this.setState({isEnableATGButton:a.EntityResult.EnableTankScan,atgInfoDisable:e})):console.log("Error in GetTankATGConfiguration:",a.ErrorList)})).catch((t=>{console.log("Error while getting GetTankATGConfiguration:",t)}))}catch(a){console.log("Error while getting GetTankATGConfiguration:",a)}}getTerminal(){i()(r.Oqv,o.tW(this.props.tokenDetails.tokenInfo)).then((t=>{var e=t.data;if(!0===e.IsSuccess){if(null!==e.EntityResult&&Array.isArray(e.EntityResult)){let t=o.Zj(e.EntityResult);this.setState({terminalOptions:t})}}else console.log("Error in getTerminal:",e.ErrorList)})).catch((t=>{console.log("Error while getting Terminal:",t)}))}GetTankMode(){i()(r.ULi,o.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var e=t.data;if(!0===e.IsSuccess){if(null!==e.EntityResult&&Array.isArray(e.EntityResult)){let t=o.Zj(e.EntityResult);this.setState({tankModeOptions:t})}}else console.log("Error in GetTankMode:",e.ErrorList)})).catch((t=>{console.log("Error while getting TankMode:",t)}))}GetProductData(t){try{const e=A().cloneDeep(this.state.modTank);i()(r.kuB+"?TankGroupCode="+t,o.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var s=t.data;!0===s.IsSuccess?null!==s.EntityResult&&void 0!==s.EntityResult&&(e.BPDensityUOM=s.EntityResult.DensityUOM,null!==s.EntityResult.MinDensity&&""!==s.EntityResult.MinDensity&&(e.BPMinDensity=parseFloat(s.EntityResult.MinDensity)),null!==s.EntityResult.MaxDensity&&""!==s.EntityResult.MaxDensity&&(e.BPMaxDensity=parseFloat(s.EntityResult.MaxDensity)),this.setState({modTank:e})):console.log("Error in GetProductData:",s.ErrorList)})).catch((t=>{console.log("Error while getting ProductData:",t)}))}catch(e){console.log("TankDetailsComposite:Error occured on GetProductData",e)}}getTankGroup(t){i()(r.oCZ+"?terminalcode="+t,o.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var e=t.data;let s=[];!0===e.IsSuccess?(null!==e.EntityResult&&void 0!==e.EntityResult&&Object.keys(e.EntityResult).forEach((t=>{s.push({text:t,value:t})})),this.setState({tankGroupOptions:s,tankGroupBaseProduts:e.EntityResult})):console.log("Error in getTankGroup:",e.ErrorList)})).catch((t=>{console.log("Error while getting TankGroup:",t)}))}getLocalNodeTankGroup(){i()(r.oCZ,o.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var e=t.data;let s=[];!0===e.IsSuccess?(null!==e.EntityResult&&void 0!==e.EntityResult&&Object.keys(e.EntityResult).forEach((t=>{s.push({text:t,value:t})})),this.setState({tankGroupOptions:s,tankGroupBaseProduts:e.EntityResult})):console.log("Error in getLocalNodeTankGroup:",e.ErrorList)})).catch((t=>{console.log("Error while getting LocalNodeTankGroup:",t)}))}getUOMList(){i()(r.WFM,o.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var e=t.data;if(!0===e.IsSuccess){if(null!==e.EntityResult){let t=e.EntityResult.MASS,s=[],a=[];t.forEach((t=>{a.push({text:t,value:t})})),e.EntityResult.VOLUME.forEach((t=>{s.push({text:t,value:t})}));let o=e.EntityResult.LENGTH,n=[];o.forEach((t=>{n.push({text:t,value:t})}));let i=e.EntityResult.DENSITY,r=[];i.forEach((t=>{r.push({text:t,value:t})}));let l=e.EntityResult.TEMPERATURE,u=[];l.forEach((t=>{u.push({text:t,value:t})}));let d=e.EntityResult.PRESSURE,c=[];d.forEach((t=>{c.push({text:t,value:t})})),this.setState({volumeUOMOptions:s,lengthUOMOptions:n,densityUOMOptions:r,massUOMOptions:a,temperatureUOMOptions:u,pressureUOMOptions:c})}}else console.log("Error in getUOM:",e.ErrorList)})).catch((t=>{console.log("Error while getting getUOM:",t)}))}fillDetails(){try{let t=A().cloneDeep(this.state.modTank);return t.Capacity=null!==t.Capacity&&""!==t.Capacity?t.Capacity.toLocaleString():null,t.AvailableRoom=null!==t.AvailableRoom&&""!==t.AvailableRoom?t.AvailableRoom.toLocaleString():null,t.Density=null!==t.Density&&""!==t.Density?t.Density.toLocaleString():null,t.GrossMass=null!==t.GrossMass&&""!==t.GrossMass?t.GrossMass.toLocaleString():null,t.GrossVolume=null!==t.GrossVolume&&""!==t.GrossVolume?t.GrossVolume.toLocaleString():null,t.NetVolume=null!==t.NetVolume&&""!==t.NetVolume?t.NetVolume.toLocaleString():null,t.WaterVolume=null!==t.WaterVolume&&""!==t.WaterVolume?t.WaterVolume.toLocaleString():null,t.TankLevel=null!==t.TankLevel&&""!==t.TankLevel?t.TankLevel.toLocaleString():null,t.WaterLevel=null!==t.WaterLevel&&""!==t.WaterLevel?t.WaterLevel.toLocaleString():null,t.Temperature=null!==t.Temperature&&""!==t.Temperature?t.Temperature.toLocaleString():null,t.Pressure=null!==t.Pressure&&""!==t.Pressure?t.Pressure.toLocaleString():null,t.VapourGrossQuantity=null!==t.VapourGrossQuantity&&""!==t.VapourGrossQuantity?t.VapourGrossQuantity.toLocaleString():null,t.VapourNetQuantity=null!==t.VapourNetQuantity&&""!==t.VapourNetQuantity?t.VapourNetQuantity.toLocaleString():null,null!==t.GrossMass&&""!==t.GrossMass||(t.GrossMassUOM=""),null!==t.GrossVolume&&""!==t.GrossVolume||(t.GrossVolumeUOM=""),null!==t.NetVolume&&""!==t.NetVolume||(t.NetVolumeUOM=""),null!==t.WaterVolume&&""!==t.WaterVolume||(t.WaterVolumeUOM=""),null!==t.Pressure&&""!==t.Pressure||(t.PressureUOM=""),t}catch(t){console.log("TankDetailsComposite:Error occured on fillDetails",t)}}validateSave(t,e){const s={...this.state.validationErrors};Object.keys(h.Js).forEach((function(e){void 0!==t[e]&&(s[e]=o.jr(h.Js[e],t[e]))})),t.Active!==this.state.tank.Active&&(null!==t.Remarks&&""!==t.Remarks||(s.Remarks="BaseProductInfo_EnterRemarks")),null===t.GrossMass||null!==t.GrossMassUOM&&""!==t.GrossMassUOM||(s.GrossMassUOM="TankInfo_UOMRequired"),null===t.GrossVolume||null!==t.GrossVolumeUOM&&""!==t.GrossVolumeUOM||(s.GrossVolumeUOM="TankInfo_UOMRequired"),null===t.NetVolume||null!==t.NetVolumeUOM&&""!==t.NetVolumeUOM||(s.NetVolumeUOM="TankInfo_UOMRequired"),null===t.WaterVolume||null!==t.WaterVolumeUOM&&""!==t.WaterVolumeUOM||(s.WaterVolumeUOM="TankInfo_UOMRequired"),null===t.TankLevel&&null===t.WaterLevel||null!==t.LevelUOM&&""!==t.LevelUOM||(s.LevelUOM="TankInfo_UOMRequired"),null===t.Temperature||null!==t.TemperatureUOM&&""!==t.TemperatureUOM||(s.TemperatureUOM="TankInfo_UOMRequired"),null===t.Pressure||null!==t.PressureUOM&&""!==t.PressureUOM||(s.PressureUOM="TankInfo_UOMRequired"),null===t.VapourGrossQuantity&&null===t.VapourNetQuantity||null!==t.VapourUOM&&""!==t.VapourUOM||(s.VapourUOM="TankInfo_UOMRequired"),this.props.userDetails.EntityResult.IsEnterpriseNode&&(null===t.TerminalCode||""===t.TerminalCode?s.TerminalCode="TankGroupInfo_TerminalRequired":s.TerminalCode="");var a=A().cloneDeep(this.state.attributeValidationErrors);e.forEach((t=>{a.forEach((e=>{e.TerminalCode===t.TerminalCode&&t.attributeMetaDataList.forEach((t=>{e.attributeValidationErrors[t.Code]=o.I5(t,t.DefaultValue)}))}))})),this.setState({validationErrors:s,attributeValidationErrors:a});var n=!0;return a.forEach((t=>{if(!n)return n;n=Object.values(t.attributeValidationErrors).every((function(t){return""===t}))})),n&&(n=Object.values(s).every((function(t){return""===t}))),n}convertStringtoDecimal(t,e){try{return null!==t.Capacity&&""!==t.Capacity&&(t.Capacity=o.bo(t.Capacity)),null!==t.AvailableRoom&&""!==t.AvailableRoom&&(t.AvailableRoom=o.bo(t.AvailableRoom)),null!==t.Density&&""!==t.Density&&(t.Density=o.bo(t.Density)),null!==t.GrossMass&&""!==t.GrossMass&&(t.GrossMass=o.bo(t.GrossMass)),null!==t.GrossVolume&&""!==t.GrossVolume&&(t.GrossVolume=o.bo(t.GrossVolume)),null!==t.NetVolume&&""!==t.NetVolume&&(t.NetVolume=o.bo(t.NetVolume)),null!==t.WaterVolume&&""!==t.WaterVolume&&(t.WaterVolume=o.bo(t.WaterVolume)),null!==t.TankLevel&&""!==t.TankLevel&&(t.TankLevel=o.bo(t.TankLevel)),null!==t.WaterLevel&&""!==t.WaterLevel&&(t.WaterLevel=o.bo(t.WaterLevel)),null!==t.Temperature&&""!==t.Temperature&&(t.Temperature=o.bo(t.Temperature)),null!==t.Pressure&&""!==t.Pressure&&(t.Pressure=o.bo(t.Pressure)),null!==t.VapourGrossQuantity&&""!==t.VapourGrossQuantity&&(t.VapourGrossQuantity=o.bo(t.VapourGrossQuantity)),null!==t.VapourNetQuantity&&""!==t.VapourNetQuantity&&(t.VapourNetQuantity=o.bo(t.VapourNetQuantity)),e=o.SC(e),t.Attributes=o.Gh(e),t}catch(s){console.log("convertStringtoDecimal error Tank Details",s)}}createTank(t){let e=[{key:p.E7,value:t.Code}],s={keyDataCode:p.E7,KeyCodes:e,Entity:t},a={messageType:"critical",message:"TankInfo_SavedStatus",messageResultDetails:[{keyFields:["TankTransaction_TankCode"],keyValues:[t.Code],isSuccess:!1,errorMessage:""}]};i()(r.Zyr,o.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{let s=e.data;a.messageType=s.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?this.setState({saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,k.i.modify,k.VQ),showAuthenticationLayout:!1},(()=>this.getTank({Common_Code:t.Code,TerminalCode:t.TerminalCode}))):(a.messageResultDetails[0].errorMessage=s.ErrorList[0],this.setState({saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,k.i.add,k.VQ),showAuthenticationLayout:!1}),console.log("Error in createTank:",s.ErrorList)),this.props.onSaved(this.state.modTank,"add",a)})).catch((t=>{this.setState({saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,k.i.add,k.VQ),showAuthenticationLayout:!1}),a.messageResultDetails[0].errorMessage=t,this.props.onSaved(this.state.modTank,"add",a)}))}updateTank(t){let e=[{key:p.E7,value:t.Code},{key:p.uw,value:t.TerminalCode}],s={keyDataCode:p.E7,KeyCodes:e,Entity:t},a={messageType:"critical",message:"TankInfo_SavedStatus",messageResultDetails:[{keyFields:["TankTransaction_TankCode"],keyValues:[t.Code],isSuccess:!1,errorMessage:""}]};i()(r.aAZ,o.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{let s=e.data;a.messageType=s.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?this.setState({saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,k.i.modify,k.VQ),showAuthenticationLayout:!1},(()=>this.getTank({Common_Code:t.Code,TerminalCode:t.TerminalCode}))):(a.messageResultDetails[0].errorMessage=s.ErrorList[0],this.setState({saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,k.i.modify,k.VQ),showAuthenticationLayout:!1}),console.log("Error in update Tank:",s.ErrorList)),this.props.onSaved(this.state.modTank,"update",a)})).catch((t=>{this.setState({saveEnabled:o.ab(this.props.userDetails.EntityResult.FunctionsList,k.i.modify,k.VQ),showAuthenticationLayout:!1}),a.messageResultDetails[0].errorMessage=t,this.props.onSaved(this.state.modTank,"modify",a)}))}terminalSelectionChange(t){try{if(void 0!==t&&null!==t){let n=[];var e=[],s=[];e=A().cloneDeep(this.state.attributeMetaDataList),s=A().cloneDeep(this.state.modAttributeMetaDataList);const i=A().cloneDeep(this.state.attributeValidationErrors);var a=A().cloneDeep(this.state.modTank);t.forEach((t=>{var o=s.find((e=>e.TerminalCode===t));void 0===o?e.tank.forEach((function(e){if(e.TerminalCode===t){var s=a.Attributes.find((e=>e.TerminalCode===t));void 0!==s&&e.attributeMetaDataList.forEach((function(t){var e=s.ListOfAttributeData.find((e=>e.AttributeCode===t.Code));void 0!==e&&(t.DefaultValue=e.AttributeValue)})),n.push(e)}})):n.push(o)})),s=[],s=n,s=o.nQ(s),i.forEach((e=>{void 0===t.find((t=>e.TerminalCode===t))&&Object.keys(e.attributeValidationErrors).forEach((t=>e.attributeValidationErrors[t]=""))})),this.setState({modAttributeMetaDataList:s,attributeValidationErrors:i})}}catch(n){console.log("TankDetailsComposite:Error occured on terminalSelectionChange",n)}}localNodeAttribute(){try{var t=A().cloneDeep(this.state.attributeMetaDataList);Array.isArray(t.tank)&&t.tank.length>0&&this.terminalSelectionChange([t.tank[0].TerminalCode])}catch(e){console.log("TankDetailsComposite:Error occured on localNodeAttribute",e)}}handleResetAttributeValidationError(){try{var t=A().cloneDeep(this.state.attributeMetaDataList);this.setState({attributeValidationErrors:o.Fl(t.tank)})}catch(e){console.log("handleAttributeValidationError:Error occured on handleReset",e)}}handleUOMValues(){const t=A().cloneDeep(this.state.modTank);null!==t.GrossMass&&""!==t.GrossMass||(t.GrossMassUOM=""),null!==t.GrossVolume&&""!==t.GrossVolume||(t.GrossVolumeUOM=""),null!==t.NetVolume&&""!==t.NetVolume||(t.NetVolumeUOM=""),null!==t.WaterVolume&&""!==t.WaterVolume||(t.WaterVolumeUOM=""),null!==t.Pressure&&""!==t.Pressure||(t.PressureUOM=""),null!==t.Temperature&&""!==t.Temperature||(t.TemperatureUOM=""),null!==t.VapourGrossQuantity&&""!==t.VapourGrossQuantity||null!==t.VapourNetQuantity&&""!==t.VapourNetQuantity||(t.VapourUOM=""),null!==t.WaterLevel&&""!==t.WaterLevel||null!==t.TankLevel&&""!==t.TankLevel||(t.LevelUOM=""),this.setState({modTank:t})}getLookUpData(){try{i()(r.xAA+"?LookUpTypeCode=Bonding",o.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var e=t.data;!0===e.IsSuccess&&this.setState({isBondingEnable:"True"===e.EntityResult["EnableBondingNon-Bonding"]})})),this.props.userDetails.EntityResult.IsEnterpriseNode||i()(r.xAA+"?LookUpTypeCode=ATG",o.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var e=t.data;!0===e.IsSuccess&&(this.setState({isATGEnabled:"True"===e.EntityResult.ATGEnabled}),"True"===e.EntityResult.ATGEnabled&&void 0!==this.props.selectedRow.TankList_ATGConfiguration&&null!==this.props.selectedRow.TankList_ATGConfiguration&&this.setState({isEnableATGConfigButton:!0}))}))}catch(t){console.log("TankDetailsComposite:Error occured on getLookUpData",t)}}getKPIList(t){if(!0===o.ab(this.props.userDetails.EntityResult.FunctionsList,k.i.view,k.bL)){let e={PageName:M.G0,InputParameters:[{key:"TankCode",value:t}]};i()(r.dxq,o.tW(e,this.props.tokenDetails.tokenInfo)).then((t=>{var e=t.data;!0===e.IsSuccess?this.setState({tankKPIList:e.EntityResult.ListKPIDetails}):(this.setState({tankKPIList:[]}),console.log("Error in tank KPIList:",e.ErrorList))})).catch((t=>{console.log("Error while getting Tank KPIList:",t)}))}}render(){const t={terminalCode:this.state.terminalOptions,tankMode:this.state.tankModeOptions,tankGroup:this.state.tankGroupOptions,volumeUOM:this.state.volumeUOMOptions,densityUOM:this.state.densityUOMOptions,massUOM:this.state.massUOMOptions,lengthUOM:this.state.lengthUOMOptions,temperatureUOM:this.state.temperatureUOMOptions,pressureUOM:this.state.pressureUOMOptions},e=[{fieldName:"BaseProductInfo_LastUpdated",fieldValue:new Date(this.state.modTank.UpdatedTime).toLocaleDateString()+" "+new Date(this.state.modTank.UpdatedTime).toLocaleTimeString()},{fieldName:"BaseProductInfo_LastActivatedTime",fieldValue:void 0!==this.state.modTank.LastActive&&null!==this.state.modTank.LastActive?new Date(this.state.modTank.LastActive).toLocaleDateString()+" "+new Date(this.state.modTank.LastActive).toLocaleTimeString():""},{fieldName:"BaseProductInfo_Created",fieldValue:new Date(this.state.modTank.CreatedTime).toLocaleDateString()+" "+new Date(this.state.modTank.CreatedTime).toLocaleTimeString()},{fieldName:"TankInfo_ATGLastUpdatedTime",fieldValue:void 0!==this.state.modTank.AtgLastUpdatedTime&&null!==this.state.modTank.AtgLastUpdatedTime?new Date(this.state.modTank.AtgLastUpdatedTime).toLocaleDateString()+" "+new Date(this.state.modTank.AtgLastUpdatedTime).toLocaleTimeString():""}];return this.state.isReadyToRender?(0,N.jsxs)("div",{children:[(0,N.jsx)(T.A,{children:(0,N.jsx)(E.A,{entityCode:this.state.tank.Code,newEntityName:"TankInfo_NewTank",popUpContents:e})}),(0,N.jsx)(y.A,{KPIList:this.state.tankKPIList,children:" "}),(0,N.jsx)(T.A,{children:(0,N.jsx)(l.D,{tank:this.state.tank,modTank:this.state.modTank,listOptions:t,validationErrors:this.state.validationErrors,onFieldChange:this.handleChange,isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,attributeValidationErrors:this.state.attributeValidationErrors,modAttributeMetaDataList:this.state.modAttributeMetaDataList,onAttributeDataChange:this.handleAttributeDataChange,onTerminalChange:this.handleTerminalChange,onTankGroupChange:this.handleTankGroupChange,isEnableATGButton:this.state.isEnableATGButton,atgInfoDisable:this.state.atgInfoDisable,handleReadATGData:this.handleReadATGData,handleSaveATGData:this.handleSaveATGData,isBondingEnable:this.state.isBondingEnable,isATGEnabled:this.state.isATGEnabled,onActiveStatusChange:this.handleActiveStatusChange,handleATGConfiguration:this.handleATGConfig,isEnableATGConfigButton:this.state.isEnableATGConfigButton})}),(0,N.jsx)(T.A,{children:(0,N.jsx)(u.q,{handleBack:this.props.onBack,handleSave:this.handleSave,handleReset:this.handleReset,saveEnabled:this.state.saveEnabled})}),this.state.isChangeBondedStatus?this.confirmChangeBondedStatus():null,this.state.showAuthenticationLayout?(0,N.jsx)(L.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:""===this.state.tank.Code?k.i.add:k.i.modify,functionGroup:k.VQ,handleOperation:this.saveTank,handleClose:this.handleAuthenticationClose}):null]}):(0,N.jsx)(m.A,{message:"Loading"})}}const v=(0,d.Ng)((t=>({userDetails:t.getUserDetails.userDetails,tokenDetails:t.getUserDetails.TokenAuth})))(O)},15417:(t,e,s)=>{s.d(e,{$7:()=>v,AN:()=>st,AU:()=>L,Ak:()=>Qt,Ao:()=>a,B6:()=>q,C4:()=>wt,CG:()=>Y,Ct:()=>K,Cw:()=>V,EY:()=>y,G$:()=>qt,G6:()=>$t,GF:()=>Tt,GJ:()=>f,Gj:()=>ct,Gl:()=>nt,H9:()=>Jt,HB:()=>Mt,HP:()=>R,Hr:()=>yt,II:()=>oe,IQ:()=>C,Jr:()=>_,Jx:()=>kt,Ki:()=>et,LP:()=>ot,Lv:()=>n,MK:()=>I,MX:()=>tt,Mx:()=>F,N4:()=>Pt,NH:()=>At,OF:()=>zt,Ps:()=>H,Q7:()=>Kt,QY:()=>w,SF:()=>i,Sq:()=>St,Sw:()=>rt,TQ:()=>X,U7:()=>M,UH:()=>m,UO:()=>it,V_:()=>Ot,Vy:()=>Bt,W9:()=>ut,WN:()=>k,Wr:()=>o,Ww:()=>$,XP:()=>Nt,Xk:()=>J,Yb:()=>gt,Yy:()=>E,Z2:()=>ft,ZN:()=>G,ZO:()=>Dt,Zu:()=>_t,_G:()=>j,_N:()=>c,_u:()=>dt,ad:()=>lt,al:()=>Ct,ao:()=>B,bK:()=>Q,bN:()=>A,cf:()=>b,dO:()=>vt,dU:()=>T,dv:()=>r,eE:()=>Z,g:()=>S,gG:()=>l,gS:()=>Lt,gT:()=>se,gW:()=>z,gZ:()=>Xt,go:()=>N,gp:()=>W,hq:()=>bt,i6:()=>te,ip:()=>ht,k9:()=>p,kI:()=>D,l4:()=>Vt,l5:()=>g,lA:()=>P,lU:()=>Yt,mD:()=>Wt,mY:()=>U,mq:()=>u,n$:()=>ae,n7:()=>h,nZ:()=>Gt,rA:()=>Ut,s$:()=>Ht,s8:()=>xt,se:()=>It,tA:()=>Rt,vK:()=>ee,vs:()=>mt,w2:()=>Zt,w4:()=>pt,wT:()=>d,wY:()=>O,wf:()=>Et,wk:()=>at,xW:()=>x,yM:()=>jt,yO:()=>Ft});const a="driver",o="carriercompany",n="shareholder",i="baseProduct",r="TRAILER",l="TRAILERCOMPARTMENT",u="terminal",d="customer",c="destination",h="finishedproduct",T="tank",E="marine_vessel",p="marine_trailercompartment",m="supplier",I="vehicle",A="vehicletrailer",k="originterminal",C="bay",D="loadingArm",g="cardreader",S="vehicleprimemover",R="meter",y="SHIPMENT",M="SHIPMENTCOMPARTMENT",L="SHIPMENTDESTINATIONCOMPARTMENT",N="SHIPMENTDETAILS",O="SHIPMENTTRAILERWEIGHBRIDGE",v="SHIPMENTTRAILER",G="SHIPMENTSTATUSTIME",b="MARINEDISPATCH",P="MARINEDISPATCHCOMPARTMENTDETAIL",f="railwagon",V="primemover",U="bcu",w="RAILRECEIPTPLAN",H="RAILRECEIPTWAGONDETAILPLAN",B="RAILUNLOADINGDETAILSFP",W="RAILUNLOADINGDETAILSBP",x="RAILUNLOADINGDETAILSADDITIVE",_="RAILDISPATCHPLAN",Q="RAILDISPATCHITEM",j="RAILDISPATCHSTATUSCHANGE",F="RAILDISPATCHWAGON",K="RAILDISPATCHWAGONDETAILPLAN",J="RAILDISPATCHWAGONWEIGHBRIDGE",q="RAILDISPATCHWAGONCOMPARTMENT",Z="RAILLOADINGDETAILSFP",Y="RAILLOADINGDETAILSBP",z="RAILLOADINGDETAILSADDITIVE",$="marineReceipt",X="UNACCOUNTEDMETERTRANSACTION",tt="UNACCOUNTEDTANKTRANSACTION",et="marineLoadingDetailsFP",st="marineLoadingDetailsAdditive",at="marineLoadingDetailsBP",ot="marineReceiptCompartmentDetail",nt="marineUnloadingDetailsFP",it="marineUnloadingDetailsBP",rt="accessCard",lt="LOADINGDETAILSFP",ut="LOADINGDETAILSBP",dt="LOADINGDETAILSADDITIVE",ct="MARINERECEIPTSTATUSTIME",ht="MARINEDISPATCHSTATUSTIME",Tt="RECEIPT",Et="UNLOADINGTRANSACTIONS",pt="ORDER",mt="ORDERITEM",It="CONTRACT",At="CONTRACT_ITEM",kt="RECEIPTORIGINTERMINALCOMPARTMENT",Ct="GeneralTMUser_CAPTAIN",Dt="weighbridge",gt="deu",St="GeneralTMUser_STAFF",Rt="GeneralTMUser_VISITOR",yt="PIPELINEHEADER",Mt="SEALMASTER",Lt="PIPELINERECEIPT",Nt="ROADSHIPMENTSLOTINFO",Ot="ROADRECEIPTSLOTINFO",vt="MARINESHIPMENTSLOTINFO",Gt="MARINERECEIPTSLOTINFO",bt="PIPELINEDISPATCH",Pt="PIPELINETRANSACTIONS",ft="PIPELINEDISPATCHSTATUSTIME",Vt="PIPELINERECEIPTSTATUSTIME",Ut="PROCESSCONFIG",wt="PRODUCTALLOCATIONITEM",Ht="HSEINSPECTIONSHIPMENTRIGIDTRUCK",Bt="HSEINSPECTIONSHIPMENTTRAILER",Wt="HSEINSPECTIONSHIPMENTPRIMEMOVER",xt="HSEINSPECTIONSHIPMENTNONFILLINGVEHICLE",_t="HSEINSPECTIONMARINESHIPMENTBARGE",Qt="HSEINSPECTIONMARINESHIPMENTSHIP",jt="HSEINSPECTIONSHIPMENTRAILWAGON",Ft="HSEINSPECTIONSHIPMENTPIPELINE",Kt="HSEINSPECTIONRECEIPTRIGIDTRUCK",Jt="HSEINSPECTIONRECEIPTTRAILER",qt="HSEINSPECTIONRECEIPTPRIMEMOVER",Zt="HSEINSPECTIONRECEIPTNONFILLINGVEHICLE",Yt="HSEINSPECTIONMARINERECEIPTBARGE",zt="HSEINSPECTIONMARINERECEIPTSHIP",$t="HSEINSPECTIONRECEIPTRAILWAGON",Xt="HSEINSPECTIONRECEIPTPIPELINE",te="SHAREHOLDERAGREEMENT",ee="COATEMPLATE",se="COAMANAGEMENT",ae="COACUSTOMER",oe="COAASSIGNMENT"}}]);
//# sourceMappingURL=3361.5b632c16.chunk.js.map