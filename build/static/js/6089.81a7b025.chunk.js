"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[6089],{979:(e,t,s)=>{s.d(t,{A:()=>A});var a=s(65043),l=s(16432),o=s(65187),i=s(72711),n=s(67907),c=s(97508),r=s(40854),d=s.n(r),h=s(72067),y=s(69062),p=s(53536),u=s.n(p),g=s(7523),m=s(70579);class S extends a.Component{constructor(){super(...arguments),this.state={searchBayResult:"",pageIndex:1,pageSize:1},this.onBaySearchChange=e=>{this.setState({searchBayResult:e})},this.onCheckboxChange=(e,t)=>{try{this.props.onBaySelect(e,t)}catch(s){console.log("BayQueueComposite:Error occured on onCheckboxChange",s)}}}componentDidMount(){this.getLookUpData()}getLookUpData(){try{d()(h.xAA+"?LookUpTypeCode=BayAllocation",y.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess&&(isNaN(parseInt(t.EntityResult.PageSize))||this.setState({pageSize:parseInt(t.EntityResult.PageSize)}))}))}catch(e){console.log("BayAllocationDetailsComposite:Error occured on getLookUpData",e)}}getBayTooltip(e){return(0,m.jsx)(n.TranslationConsumer,{children:t=>(0,m.jsxs)("div",{children:[t("BayGroupList_BayCode")," : ",e.BayCode," ",(0,m.jsx)("br",{}),t("BayGroupList_LoadingType")," : ",e.LoadingType,(0,m.jsx)("br",{}),t("BayTooltip_QueueSize")," : ",e.MaximumQueue,(0,m.jsx)("br",{}),t("BaySearch_BayMode")," : ",e.IsManual?"Manual Bay":"Auto",(0,m.jsx)("br",{}),t("TankGroupInfo_Active")," : ",e.Active?"true":"false"]})})}getBayShipmentTooltip(e){return(0,m.jsx)(n.TranslationConsumer,{children:t=>(0,m.jsxs)("div",{children:[null===e.ShipmentCode?t("Receipt_Code"):t("ViewShipmentStatus_ShipmentCode")," ",": ",e.Code," ",(0,m.jsx)("br",{}),t("Receipt_Shareholder")," : ",e.ShareholderCode,(0,m.jsx)("br",{}),t("ViewReceipt_CarrierCompany")," : ",e.CarrierCode,(0,m.jsx)("br",{}),t("ViewReceipt_Vehicle")," : ",e.VehicleCode,(0,m.jsx)("br",{}),t("DriverInfo_Driver")," : ",e.DriverCode,(0,m.jsx)("br",{}),t("ScheduledDate")," :"," ",new Date(e.ScheduledDate).toLocaleDateString()]})})}getBayTypeTooltip(e){return(0,m.jsx)(n.TranslationConsumer,{children:t=>(0,m.jsxs)("div",{children:[t("BayType_Title")," :"," ","BOTH"===e.BayType?t("BayType_Both"):e.BayType]})})}getTransactionIdentifier(e,t){return e+g.uV+t}render(){let{searchBayResult:e}=this.state,t=this.props.bayData.filter((t=>t.BayCode.toLowerCase().includes(e.toLowerCase())||t.ShipmentReceiptItem.some((function(t){return t.Code.toLowerCase().includes(e.toLowerCase())})))),s=[],a=u().cloneDeep(this.state.pageIndex);this.state.pageSize>=t.length&&(a=1);let c=(a-1)*this.state.pageSize,r=c+this.state.pageSize;return r>=t.length&&(r=t.length),s=t.slice(c,r),(0,m.jsx)(n.TranslationConsumer,{children:e=>(0,m.jsxs)("div",{className:"detailsContainer",children:[(0,m.jsxs)("div",{className:"row",children:[(0,m.jsx)("div",{className:"col-4",children:(0,m.jsx)(i.Input,{className:"input-example",placeholder:e("BayAllocation_SearchBay"),search:!0,onChange:e=>this.onBaySearchChange(e)})}),(0,m.jsx)("div",{className:"col-4",children:t.length>this.state.pageSize?(0,m.jsx)(i.Pagination,{totalItems:t.length,itemsPerPage:this.state.pageSize,activePage:this.state.pageIndex,onPageChange:e=>{this.setState({pageIndex:e})}}):""}),(0,m.jsx)("div",{className:"col-4",style:{marginTop:"1rem"},children:(0,m.jsxs)("div",{style:{float:"right"},children:[e("Common_LastUpdated")+" : "+this.props.updatedTime,(0,m.jsx)("span",{style:{marginLeft:"1rem",cursor:"pointer"},onClick:()=>this.props.onRefresh(),children:(0,m.jsx)("img",{style:{width:"6%"},src:"/Refresh.png",alt:""})})]})})]}),(0,m.jsx)(o.A,{children:s.length>0?s.map(((e,t)=>(0,m.jsx)("div",{style:{overflowX:"auto"},children:(0,m.jsxs)(i.Table,{children:[(0,m.jsx)(i.Table.Header,{children:(0,m.jsx)(i.Table.HeaderCell,{colSpan:e.MaximumQueue+2,content:e.BayCode,children:(0,m.jsx)("div",{className:"row",style:{marginBottom:"-1rem"},children:(0,m.jsxs)("div",{style:{display:"flex"},children:[(0,m.jsx)("div",{children:e.MaximumQueue>0&&!0===e.Active&&!0===this.props.isBayAllocation?(0,m.jsx)(i.Checkbox,{label:e.BayCode,checked:!0===e.SelectedBay,onChange:t=>this.onCheckboxChange(e.BayCode,t)}):(0,m.jsx)("div",{style:{whiteSpace:"pre"},children:(0,m.jsx)(i.InputLabel,{label:e.BayCode+"   "})})}),(0,m.jsx)("div",{children:(0,m.jsx)(o.A,{children:(0,m.jsx)(i.Tooltip,{element:(0,m.jsx)(i.Icon,{style:{paddingBottom:"5px"},name:"badge-info",root:"common"}),content:this.getBayTooltip(e),size:"mini",position:"right center"})})}),(0,m.jsx)(o.A,{children:(0,m.jsx)(i.Tooltip,{element:(0,m.jsx)("span",{className:"bayTypeIconPosition",children:(0,m.jsx)("icon",{style:{fontSize:"25px"},className:"BOTH"===e.BayType?"icon-Loading-Unloading":"LOADING"===e.BayType?"icon-Loading":"icon-Unloading"})}),content:this.getBayTypeTooltip(e),size:"mini",position:"right center"})}),!1===this.props.isManualMode?(0,m.jsx)("div",{style:{position:"absolute",right:"18px"},children:(0,m.jsx)("span",{style:{marginTop:"-0.3rem"},children:(0,m.jsx)(i.Icon,{name:"locked",root:"Building"})})}):""]})})})}),(0,m.jsx)(i.Table.Body,{children:(0,m.jsx)(i.Table.Row,{children:(0,m.jsx)(l.gL,{droppableId:e.BayCode,type:"Type1",children:t=>(0,m.jsxs)("div",{ref:t.innerRef,...t.droppableProps,children:[e.ShipmentReceiptItem.length>0?e.ShipmentReceiptItem.map(((t,s)=>(0,m.jsx)(i.Table.Cell,{className:this.props.selectedShipmentReceiptItem.Code===t.Code?"bayAllocationtd tdSelected":"bayAllocationtd",onClick:()=>this.props.isBayAllocation?this.props.onCellClick(s,e.BayCode):"",children:(0,m.jsx)(o.A,{children:(0,m.jsx)(l.sx,{draggableId:this.getTransactionIdentifier(t.Code,t.ShareholderCode),isDragDisabled:!1===this.props.isBayAllocation,children:(e,a)=>(0,m.jsxs)("div",{ref:e.innerRef,...e.draggableProps,...e.dragHandleProps,children:[(0,m.jsxs)("div",{className:"bayAllocationFontSize",children:[t.Code,(0,m.jsx)(o.A,{children:(0,m.jsx)(i.Tooltip,{element:(0,m.jsx)("span",{className:"bayAllocationInfoIcon",children:(0,m.jsx)(i.Icon,{name:"badge-info",root:"common"})}),content:this.getBayShipmentTooltip(t),size:"mini",position:"right center"})})]}),(0,m.jsx)("div",{className:"bayAllocationFontSize",children:t.VehicleCode}),s>0?(0,m.jsx)("div",{children:(0,m.jsx)("img",{className:"bayAllocationImagePosition",src:"/Vehicle.png",alt:"",title:"Vehicle"})}):(0,m.jsx)("div",{children:(0,m.jsx)("img",{className:"bayAllocationImagePosition",src:"/VehiclewithBay.png",alt:"",title:"Vehicle"})})]})})})}))):(0,m.jsx)(i.Table.Cell,{className:"bayAllocationtd",children:(0,m.jsx)("img",{className:"bayAllocationImagePosition",src:"/BayEmpty.png",alt:"",title:"Bay"})}),e.MaximumQueue>0?[...Array.from(Array(e.MaximumQueue-(0===e.ShipmentReceiptItem.length?1:e.ShipmentReceiptItem.length)).keys())].map(((e,t)=>(0,m.jsx)(i.Table.Cell,{className:"bayAllocationtd"}))):"",(0,m.jsx)(i.Table.Cell,{})]})})})})]})}))):e("BaySearch_NoResult")})]})})}}const A=(0,c.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(S)},76089:(e,t,s)=>{s.r(t),s.d(t,{default:()=>D});var a=s(65043),l=s(97508),o=s(40854),i=s.n(o),n=s(72067),c=s(69062),r=s(65187),d=s(72711),h=s(67907),y=s(16432),p=s(93779),u=s(53536),g=s.n(u),m=s(7523),S=s(14159),A=s(11981),C=s(979),x=s(70579);class B extends a.Component{constructor(){super(...arguments),this.state={bayData:[],unAllocatedData:[],selectedUnallocatedData:"",selectedUnallocatedDataType:"",selectedUnallocatedShareholder:"",selectedShipmentReceiptItem:{},selectedShipmentReceiptBay:"",isSuggestBayModal:!1,suggestBays:[],isManualMode:!0,isSwitchBayTypeModal:!1,isAutoAllocateModal:!1,searchUnAllocatedDataResult:"",searchUnAllocatedReceiptResult:"",isReadyToRender:!1,pageIndex:1,lastUpdatedTime:"",pageSize:1},this.getBays=()=>{i()(n.ytI,c.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{let t=(new Date).toLocaleDateString()+" "+(new Date).toLocaleTimeString();var s=e.data;if(!0===s.IsSuccess){let e=[];Array.isArray(s.EntityResult.BayData.Table)&&s.EntityResult.BayData.Table.forEach((t=>{t.ShipmentReceiptItem=[];let a=[];Array.isArray(s.EntityResult.lstBayAllocationQueue)&&(a=s.EntityResult.lstBayAllocationQueue.filter((e=>e.BayCode===t.BayCode))),a.length>0&&a[0].AllocationItems.sort(((e,t)=>e.QueueNumber>t.QueueNumber?1:-1)).forEach((e=>{let a=s.EntityResult.BayData.Table2.filter((t=>null!==e.ShipmentCode&&e.ShipmentCode===t.ShipmentCode||null!==e.ReceiptCode&&e.ReceiptCode===t.Code));t.ShipmentReceiptItem.push(a[0])})),e.push(t)})),this.setState({bayData:e,isReadyToRender:!0,selectedUnallocatedData:"",selectedUnallocatedDataType:"",selectedShipmentReceiptItem:{},selectedShipmentReceiptBay:"",lastUpdatedTime:t,selectedUnallocatedShareholder:""})}else this.setState({bayData:[],isReadyToRender:!0,lastUpdatedTime:t}),console.log("Error in getBays:",s.ErrorList)})).catch((e=>{this.setState({bayData:[],isReadyToRender:!0}),console.log("Error while getBays:",e)}))},this.handleSuggestBayModal=()=>(0,x.jsx)(h.TranslationConsumer,{children:e=>(0,x.jsxs)(d.Modal,{open:this.state.isSuggestBayModal,size:"small",children:[(0,x.jsxs)(d.Modal.Content,{children:[(0,x.jsxs)("div",{className:"col col-lg-12",children:[(0,x.jsx)("h3",{children:e("Suggested_Bays")}),(this.state.selectedUnallocatedDataType===m.I8.SHIPMENT?e("BayAllocationShipmentSearch_ShipmentCode"):e("Receipt_Code"))+" : "+this.state.selectedUnallocatedData]}),(0,x.jsxs)("div",{style:{display:"flex",flexWrap:"wrap"},children:[(0,x.jsx)("h4",{children:e("BayAllocation_SuggestedBayList")}),(0,x.jsx)("div",{className:"col col-lg-12",children:Array.isArray(this.state.suggestBays)?this.state.suggestBays.map((e=>(0,x.jsx)("div",{children:e.BayCode}))):""})]})]}),(0,x.jsx)(d.Modal.Footer,{children:(0,x.jsx)(d.Button,{type:"primary",content:e("ReportConfiguration_btnClose"),className:"shipmentRecordWeightOtherbuttons",onClick:()=>{this.setState({isSuggestBayModal:!1})}})})]})}),this.handleDragEnd=e=>{try{let o=this.splitTransactionIdentifier(e.draggableId);if(this.state.isManualMode){if(null!==e.source&&null!==e.destination){var t=m.I8.SHIPMENT;if("UnAllocatedShipment"!==e.source.droppableId&&"UnAllocatedShipment"===e.destination.droppableId){this.setState({isReadyToRender:!1});var s=g().cloneDeep(this.state.bayData).filter((t=>t.BayCode===e.source.droppableId));if(s.length>0){var a=s[0].ShipmentReceiptItem.filter((e=>e.Code===o.code&&e.ShareholderCode===o.shareholder));a.length>0&&null===a[0].ShipmentCode&&(t=m.I8.RECEIPT)}this.DeAllocateBay(o.code,t,e.source.droppableId,o.shareholder)}else if("UnAllocatedShipment"!==e.destination.droppableId&&"UnAllocatedShipment"===e.source.droppableId){this.setState({isReadyToRender:!1});var l=g().cloneDeep(this.state.unAllocatedData).filter((e=>e.Code===o.code&&e.ShareholderCode===o.shareholder));l.length>0&&null===l[0].ShipmentCode&&(t=m.I8.RECEIPT),this.AllocateBay(o.code,e.destination.droppableId,t,o.shareholder)}}}else{let e={messageType:"critical",message:"BayAllocation_SaveStatus",messageResultDetails:[{keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"BayAllocation_ManualAllocation_NotAllowed"}]};(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})}}catch(o){console.log("ManualBayAllocationComposite:Error occured on handleDragEnd",o)}},this.handleItemClick=(e,t)=>{try{var s=m.I8.SHIPMENT;var a=g().cloneDeep(this.state.unAllocatedData).filter((s=>s.Code===e&&s.ShareholderCode===t));a.length>0&&null===a[0].ShipmentCode&&(s=m.I8.RECEIPT),this.setState({selectedUnallocatedData:e,selectedUnallocatedDataType:s,selectedUnallocatedShareholder:t})}catch(l){console.log("ManualBayAllocationComposite:Error occured on handleItemClick",l)}},this.handleBaySelect=(e,t)=>{try{let s=g().cloneDeep(this.state.bayData),a=s.filter((t=>t.BayCode===e));a.length>0&&(a[0].SelectedBay=t),this.setState({bayData:s})}catch(s){console.log("ManualBayAllocationComposite:Error occured on onCheckboxChange",s)}},this.displaySwitchBayTypeModal=()=>(0,x.jsx)(h.TranslationConsumer,{children:e=>(0,x.jsxs)(d.Modal,{open:this.state.isSwitchBayTypeModal,size:"small",children:[(0,x.jsx)(d.Modal.Content,{children:(0,x.jsx)("div",{children:(0,x.jsx)("b",{children:this.state.isManualMode?e("BayAllocation_AutoMode_Confirmation"):e("BayAllocation_ManualMode_Confirmation")})})}),(0,x.jsxs)(d.Modal.Footer,{children:[(0,x.jsx)(d.Button,{type:"secondary",content:e("Cancel"),onClick:()=>{this.setState({isSwitchBayTypeModal:!1})}}),(0,x.jsx)(d.Button,{type:"primary",content:e("AccessCardInfo_Ok"),onClick:()=>{this.setState({isSwitchBayTypeModal:!1}),this.switchBayType()}})]})]})}),this.displayAutoAllocateModal=()=>(0,x.jsx)(h.TranslationConsumer,{children:e=>(0,x.jsxs)(d.Modal,{open:this.state.isAutoAllocateModal,size:"small",children:[(0,x.jsx)(d.Modal.Content,{children:(0,x.jsx)("div",{children:(0,x.jsx)("b",{children:e("BayAllocation_AutoAllocation_Confirmation")})})}),(0,x.jsxs)(d.Modal.Footer,{children:[(0,x.jsx)(d.Button,{type:"secondary",content:e("Cancel"),onClick:()=>{this.setState({isAutoAllocateModal:!1})}}),(0,x.jsx)(d.Button,{type:"primary",content:e("AccessCardInfo_Ok"),onClick:()=>{this.setState({isAutoAllocateModal:!1}),this.AutoAllocate()}})]})]})}),this.onUnAllocatedDataSearchChange=e=>{this.setState({searchUnAllocatedDataResult:e})},this.handleRefresh=()=>{this.setState({isReadyToRender:!1},(()=>{this.getUnallocatedShipmentsandReceipts()}))},this.handleCellClick=(e,t)=>{try{let a=g().cloneDeep(this.state.bayData).filter((e=>e.BayCode===t));if(a.length>0){var s=a[0].ShipmentReceiptItem[e];this.setState({selectedShipmentReceiptItem:s,selectedShipmentReceiptBay:t})}}catch(a){console.log("BayAllocationDetailsComposite:Error occured on handleCellClick",a)}}}componentDidMount(){try{this.getUnallocatedShipmentsandReceipts(),this.getBayAllocationType()}catch(e){console.log("ManualBayAllocationComposite:Error occured on ComponentDidMount",e)}}getUnallocatedShipmentsandReceipts(){i()(n.MF5,c.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({unAllocatedData:t.EntityResult.Table1},(()=>{this.getBays()})):(this.setState({unAllocatedData:[],isReadyToRender:!0}),console.log("Error in getUnallocatedShipmentsandReceipts:",t.ErrorList))})).catch((e=>{this.setState({unAllocatedData:[],isReadyToRender:!0}),console.log("Error while getUnallocatedShipmentsandReceipts:",e)}))}getBayAllocationType(){i()(n.NJd,c.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data,s=!0;!0===t.IsSuccess&&"false"===t.EntityResult&&(s=!1),this.setState({isManualMode:s})})).catch((e=>{console.log("Error while getBayAllocationType:",e)}))}handleSuggestBay(){try{let s={messageType:"critical",message:"BayAllocation_SuggestStatus",messageResultDetails:[]};if(""!==this.state.selectedUnallocatedData&&null!==this.state.selectedUnallocatedData&&""!==this.state.selectedUnallocatedShareholder){this.setState({isReadyToRender:!1});var e=[{key:p.yz,value:this.state.selectedUnallocatedData},{key:p.EW,value:this.state.selectedUnallocatedDataType}],t={ShareHolderCode:this.state.selectedUnallocatedShareholder,keyDataCode:p._C,KeyCodes:e};let s={messageType:"critical",message:"BayAllocation_SaveStatus",messageResultDetails:[{isSuccess:!1,errorMessage:""}]};i()(n.QZQ,c.tW(t,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;s.messageType=t.IsSuccess?"success":"critical",s.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.setState({isSuggestBayModal:!0,suggestBays:t.EntityResult,isReadyToRender:!0}):(s.messageResultDetails[0].errorMessage=t.ResultDataList[0].ErrorList[0],(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4}))}))}else s.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"SuggestBay_UnselectItem"}),(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:s})}),{autoClose:"success"===s.messageType&&1e4})}catch(s){console.log("ManualBayAllocationComposite:Error occured on handleSuggestBay",s)}}handleAllocate(){try{let t={messageType:"critical",message:"BayAllocation_SaveStatus",messageResultDetails:[]};if(""!==this.state.selectedUnallocatedData&&null!==this.state.selectedUnallocatedData&&""!==this.state.selectedUnallocatedShareholder){var e=g().cloneDeep(this.state.bayData).filter((e=>!0===e.SelectedBay));1!==e.length?(t.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:0===e.length?"BayAllocation_BayUnselect":"BayAllocation_BayMultiselect"}),(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:t})}),{autoClose:"success"===t.messageType&&1e4})):(this.setState({isReadyToRender:!1}),this.AllocateBay(this.state.selectedUnallocatedData,e[0].BayCode,this.state.selectedUnallocatedDataType,this.state.selectedUnallocatedShareholder))}else t.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"AllocateBay_UnselectItem"}),(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:t})}),{autoClose:"success"===t.messageType&&1e4})}catch(t){console.log("ManualBayAllocationComposite:Error occured on handleAllocate",t)}}AllocateBay(e,t,s,a){var l=[{key:p.yz,value:e},{key:p.Kz,value:t},{key:p.EW,value:s}],o={ShareHolderCode:a,keyDataCode:p._C,KeyCodes:l};let d={messageType:"critical",message:"BayAllocation_SaveStatus",messageResultDetails:[{keyFields:["BayCode"],keyValues:[t],isSuccess:!1,errorMessage:""}]};i()(n.AiH,c.tW(o,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;d.messageType=t.IsSuccess?"success":"critical",d.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getUnallocatedShipmentsandReceipts():(this.setState({isReadyToRender:!0}),d.messageResultDetails[0].errorMessage=t.ResultDataList[0].ErrorList[0]),(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:d})}),{autoClose:"success"===d.messageType&&1e4})})).catch((e=>{console.log("Error while AllocateBay:",e)}))}handleDeAllocate(){try{var e=g().cloneDeep(this.state.selectedShipmentReceiptItem);if(0===Object.keys(e).length){let e={messageType:"critical",message:"BayDeAllocation_SavedStatus",messageResultDetails:[]};e.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"BayAllocation_DeAllocate_Unselect"}),(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})}else{var t=m.I8.SHIPMENT;null===e.ShipmentCode&&(t=m.I8.RECEIPT),this.setState({isReadyToRender:!1}),this.DeAllocateBay(e.Code,t,this.state.selectedShipmentReceiptBay,e.ShareholderCode)}}catch(s){console.log("ManualBayAllocationComposite:Error occured on handleDeAllocate",s)}}DeAllocateBay(e,t,s,a){var l={ShareHolderCode:a,KeyCodes:[{key:p.yz,value:e},{key:p.EW,value:t}]};let o={messageType:"critical",message:"BayDeAllocation_SavedStatus",messageResultDetails:[{keyFields:["BayCode"],keyValues:[s],isSuccess:!1,errorMessage:""}]};i()(n.viJ,c.tW(l,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;o.messageType=t.IsSuccess?"success":"critical",o.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getUnallocatedShipmentsandReceipts():(this.setState({isReadyToRender:!0}),o.messageResultDetails[0].errorMessage=t.ResultDataList[0].ErrorList[0]),(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:o})}),{autoClose:"success"===o.messageType&&1e4})})).catch((e=>{console.log("Error while DeAllocateBay:",e)}))}handleClearBay(){try{let t={messageType:"critical",message:"BayAllocation_ClearStatus",messageResultDetails:[]};var e=g().cloneDeep(this.state.bayData).filter((e=>!0===e.SelectedBay));0===e.length||e.length>1?(t.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:0===e.length?"BayAllocation_ClearBay_BayUnselect":"BayAllocation_ClearBay_BayMultiselect"}),(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:t})}),{autoClose:"success"===t.messageType&&1e4})):1===e.length&&(e[0].ShipmentReceiptItem.length>0?(this.setState({isReadyToRender:!1}),this.clearBay(e[0].BayCode)):(t.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"BayAllocation_ClearBay_EmptyBay"}),(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:t})}),{autoClose:"success"===t.messageType&&1e4})))}catch(t){console.log("ManualBayAllocationComposite:Error occured on handleClearBay",t)}}clearBay(e){var t=[{key:p.Kz,value:e}],s={ShareHolderCode:this.props.userDetails.EntityResult.PrimaryShareholder,keyDataCode:p._C,KeyCodes:t};let a={messageType:"critical",message:"BayAllocation_ClearStatus",messageResultDetails:[{keyFields:["BayCode"],keyValues:[e],isSuccess:!1,errorMessage:""}]};i()(n.ubV,c.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;a.messageType=t.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getUnallocatedShipmentsandReceipts():a.messageResultDetails[0].errorMessage=t.ResultDataList[0].ErrorList[0],(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:a})}),{autoClose:"success"===a.messageType&&1e4})})).catch((e=>{console.log("Error while clearBay:",e)}))}handleMoveStart(){try{var e=g().cloneDeep(this.state.selectedShipmentReceiptItem);if(0===Object.keys(e).length){let e={messageType:"critical",message:"BayAllocation_StartOperationStatus",messageResultDetails:[]};e.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"BayAllocation_Select_AllocateShipment"}),(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})}else{var t=m.I8.SHIPMENT;null===e.ShipmentCode&&(t=m.I8.RECEIPT),this.setState({isReadyToRender:!1}),this.changeAllocatedItemPosition(e.Code,this.state.selectedShipmentReceiptBay,t,m.bF.Start,e.ShareholderCode)}}catch(s){console.log("ManualBayAllocationComposite:Error occured on handleMoveStart",s)}}handleMovePrevious(){try{var e=g().cloneDeep(this.state.selectedShipmentReceiptItem);if(0===Object.keys(e).length){let e={messageType:"critical",message:"BayAllocation_PreviousOperationStatus",messageResultDetails:[]};e.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"BayAllocation_Select_AllocateShipment"}),(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})}else{var t=m.I8.SHIPMENT;null===e.ShipmentCode&&(t=m.I8.RECEIPT),this.setState({isReadyToRender:!1}),this.changeAllocatedItemPosition(e.Code,this.state.selectedShipmentReceiptBay,t,m.bF.MovePrevious,e.ShareholderCode)}}catch(s){console.log("ManualBayAllocationComposite:Error occured on handleMovePrevious",s)}}handleMoveNext(){try{var e=g().cloneDeep(this.state.selectedShipmentReceiptItem);if(0===Object.keys(e).length){let e={messageType:"critical",message:"BayAllocation_NextOperationStatus",messageResultDetails:[]};e.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"BayAllocation_Select_AllocateShipment"}),(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})}else{var t=m.I8.SHIPMENT;null===e.ShipmentCode&&(t=m.I8.RECEIPT),this.setState({isReadyToRender:!1}),this.changeAllocatedItemPosition(e.Code,this.state.selectedShipmentReceiptBay,t,m.bF.MoveNext,e.ShareholderCode)}}catch(s){console.log("ManualBayAllocationComposite:Error occured on handleMoveNext",s)}}handleMoveEnd(){try{var e=g().cloneDeep(this.state.selectedShipmentReceiptItem);if(0===Object.keys(e).length){let e={messageType:"critical",message:"BayAllocation_EndOperationStatus",messageResultDetails:[]};e.messageResultDetails.push({keyFields:[],keyValues:[],isSuccess:!1,errorMessage:"BayAllocation_Select_AllocateShipment"}),(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})}else{var t=m.I8.SHIPMENT;null===e.ShipmentCode&&(t=m.I8.RECEIPT),this.setState({isReadyToRender:!1}),this.changeAllocatedItemPosition(e.Code,this.state.selectedShipmentReceiptBay,t,m.bF.End,e.ShareholderCode)}}catch(s){console.log("ManualBayAllocationComposite:Error occured on handleMoveEnd",s)}}changeAllocatedItemPosition(e,t,s,a,l){var o={ShareHolderCode:l,KeyCodes:[{key:p.yz,value:e},{key:p.Kz,value:t},{key:p.EW,value:s},{key:p.oG,value:a}]};let d={messageType:"critical",message:a===m.bF.Start?"BayAllocation_StartOperationStatus":a===m.bF.MovePrevious?"BayAllocation_PreviousOperationStatus":a===m.bF.MoveNext?"BayAllocation_NextOperationStatus":"BayAllocation_EndOperationStatus",messageResultDetails:[{keyFields:["BayCode"],keyValues:[t],isSuccess:!1,errorMessage:""}]};i()(n.KZu,c.tW(o,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;d.messageType=t.IsSuccess?"success":"critical",d.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?this.getUnallocatedShipmentsandReceipts():(this.setState({isReadyToRender:!0}),d.messageResultDetails[0].errorMessage=t.ResultDataList[0].ErrorList[0]),(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:d})}),{autoClose:"success"===d.messageType&&1e4})})).catch((e=>{console.log("Error while ChangeAllocatedItemPosition:",e)}))}handleSwitchMode(){this.setState({isSwitchBayTypeModal:!0})}switchBayType(){let e={messageType:"critical",message:"BayAllocation_SwitchedStatus",messageResultDetails:[{keyFields:[],keyValues:[],isSuccess:!1,errorMessage:""}]};i()(n.p7h+"?isManual="+this.state.isManualMode,c.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var s=t.data;e.messageType=s.IsSuccess?"success":"critical",e.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?this.getBayAllocationType():e.messageResultDetails[0].errorMessage=s.ResultDataList[0].ErrorList[0],(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})})).catch((e=>{console.log("Error while switchBayType:",e)}))}handleAutoAllocate(){this.setState({isAutoAllocateModal:!0})}AutoAllocate(){this.setState({isReadyToRender:!1});let e={messageType:"critical",message:"BayAllocation_AutoAllocation_Status",messageResultDetails:[{keyFields:[],keyValues:[],isSuccess:!1,errorMessage:""}]};i()(n.NQ3+"?associatedShareHolders="+this.props.userDetails.EntityResult.PrimaryShareholder,c.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{var s=t.data;e.messageType=s.IsSuccess?"success":"critical",e.messageResultDetails[0].isSuccess=s.IsSuccess,!0===s.IsSuccess?this.getUnallocatedShipmentsandReceipts():(this.setState({isReadyToRender:!0}),e.messageResultDetails[0].errorMessage=s.ResultDataList[0].ErrorList[0]),(0,S.toast)((0,x.jsx)(r.A,{children:(0,x.jsx)(A.A,{notificationMessage:e})}),{autoClose:"success"===e.messageType&&1e4})})).catch((e=>{console.log("Error while handleAutoAllocate:",e)}))}getShipmentTooltip(e){return(0,x.jsx)(h.TranslationConsumer,{children:t=>(0,x.jsxs)("div",{children:[null===e.ShipmentCode?t("Receipt_Code"):t("ViewShipmentStatus_ShipmentCode")," ",": ",e.Code," ",(0,x.jsx)("br",{}),t("Receipt_Shareholder")," : ",e.ShareholderCode,(0,x.jsx)("br",{}),t("ViewReceipt_CarrierCompany")," : ",e.CarrierCode,(0,x.jsx)("br",{}),t("ViewReceipt_Vehicle")," : ",e.VehicleCode,(0,x.jsx)("br",{}),t("DriverInfo_Driver")," : ",e.DriverCode,(0,x.jsx)("br",{}),t("ScheduledDate")," :"," ",new Date(e.ScheduledDate).toLocaleDateString()]})})}getLookUpData(){try{i()(n.xAA+"?LookUpTypeCode=BayAllocation",c.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess&&(isNaN(parseInt(t.EntityResult.PageSize))||this.setState({pageSize:parseInt(t.EntityResult.PageSize)}))}))}catch(e){console.log("BayAllocationDetailsComposite:Error occured on getLookUpData",e)}}getTransactionIdentifier(e,t){return e+m.uV+t}splitTransactionIdentifier(e){try{const t=e.split(m.uV);return{code:t[0],shareholder:t[1]}}catch(t){console.log("BayAllocationDetailsComposite:Error occured on splitTransactionIdentifier",e,t)}}render(){let{searchUnAllocatedDataResult:e,unAllocatedData:t}=this.state,s=t.filter((t=>t.Code.toLowerCase().includes(e.toLowerCase())||t.VehicleCode.toLowerCase().includes(e.toLowerCase())||(null!==t.DriverCode?t.DriverCode.toLowerCase().includes(e.toLowerCase()):"")));return(0,x.jsx)(h.TranslationConsumer,{children:e=>(0,x.jsxs)("div",{children:[this.state.isReadyToRender?"":(0,x.jsx)("div",{className:"authLoading parameterLoader",children:(0,x.jsx)(d.Loader,{text:" ",className:"globalLoaderPositionPosition"})}),(0,x.jsxs)("div",{className:"bayAllocationContainer",children:[(0,x.jsxs)(y.JY,{onDragEnd:this.handleDragEnd,children:[(0,x.jsx)("div",{className:"bayAllocationUnAllocatedDiv",children:(0,x.jsx)("div",{children:(0,x.jsx)(y.gL,{droppableId:"UnAllocatedShipment",type:"Type1",children:t=>(0,x.jsx)("div",{ref:t.innerRef,...t.droppableProps,children:(0,x.jsxs)("div",{className:"bayAllocationUnAllocatedDataDiv detailsContainer",children:[(0,x.jsx)(d.Input,{className:"input-example",placeholder:e("LoadingDetailsView_SearchGrid"),search:!0,onChange:e=>this.onUnAllocatedDataSearchChange(e)}),(0,x.jsx)(d.VerticalMenu,{children:s.length>0?s.map(((e,t)=>(0,x.jsx)(r.A,{children:(0,x.jsx)(y.sx,{draggableId:this.getTransactionIdentifier(e.Code,e.ShareholderCode),index:t,shareholder:e.ShareholderCode,code:e.Code,children:t=>(0,x.jsx)("div",{ref:t.innerRef,...t.draggableProps,...t.dragHandleProps,children:(0,x.jsx)(d.VerticalMenu.Item,{style:{zIndex:"999"},className:this.state.selectedUnallocatedData===e.Code?"selectedUnalloctedShipment":"box",onClick:()=>this.handleItemClick(e.Code,e.ShareholderCode),icon:"multiple-devices",children:(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{style:{float:"right",display:"flex"},children:[(0,x.jsx)("icon",{style:{fontSize:"25px",marginRight:"4px"},className:null===e.ShipmentCode?"icon-Unloading":"icon-Loading"}),e.Code]}),(0,x.jsx)("div",{style:{position:"absolute",float:"left",paddingLeft:"11rem"},children:(0,x.jsx)(r.A,{children:(0,x.jsx)(d.Tooltip,{element:(0,x.jsx)("span",{className:"unallocatedShipmentInfoIcon",children:(0,x.jsx)(d.Icon,{name:"badge-info",root:"common"})}),content:this.getShipmentTooltip(e),size:"mini",position:"right center"})})})]})})})})}))):e("BayAllocation_NoDataFound")})]})})})})}),(0,x.jsx)("div",{className:"bayAllocationDiv",children:(0,x.jsx)("div",{bayAllocationDivContainer:!0,children:(0,x.jsx)(C.A,{bayData:this.state.bayData,onBaySelect:this.handleBaySelect,isManualMode:this.state.isManualMode,onRefresh:this.handleRefresh,updatedTime:this.state.lastUpdatedTime,onCellClick:this.handleCellClick,selectedShipmentReceiptItem:this.state.selectedShipmentReceiptItem,isBayAllocation:!0})})})]}),this.state.isSuggestBayModal?this.handleSuggestBayModal():null,this.state.isSwitchBayTypeModal?this.displaySwitchBayTypeModal():null,this.state.isAutoAllocateModal?this.displayAutoAllocateModal():null]}),(0,x.jsx)("div",{className:"bayButtonPosition",children:(0,x.jsxs)("div",{className:"row bayAllocationButtonRow",children:[(0,x.jsx)("div",{className:this.state.isManualMode?"bayAllocationButton":"bayAllocationButtonDisable",style:{padding:"0 0.5% 0 0.5%",height:"22px",border:"1px solid #c5c5c5"},onClick:()=>this.handleSuggestBay(),children:(0,x.jsx)("div",{children:e("SuggestBay")})}),(0,x.jsx)("div",{className:this.state.isManualMode?"bayAllocationButton":"bayAllocationButtonDisable",style:{padding:"0 0.5% 0 0.5%",height:"22px",border:"1px solid #c5c5c5"},onClick:()=>this.handleAllocate(),children:(0,x.jsx)("div",{children:e("BayAllocation_btnAllocate")})}),(0,x.jsx)("div",{className:this.state.isManualMode?"bayAllocationButton":"bayAllocationButtonDisable",style:{padding:"0 0.5% 0 0.5%",height:"22px",border:"1px solid #c5c5c5"},onClick:()=>this.handleDeAllocate(),children:(0,x.jsx)("div",{children:e("BayAllocation_btnDeAllocate")})}),(0,x.jsx)("div",{className:this.state.isManualMode?"bayAllocationButton":"bayAllocationButtonDisable",style:{padding:"0 1% 0 1%",height:"22px",border:"1px solid #c5c5c5"},onClick:()=>this.handleClearBay(),children:(0,x.jsx)("div",{children:e("ClearBay")})}),(0,x.jsx)("div",{className:this.state.isManualMode?"bayAllocationButton":"bayAllocationButtonDisable",style:{padding:"0 1% 0 1%",height:"22px",border:"1px solid #c5c5c5"},onClick:()=>this.handleMoveStart(),children:(0,x.jsx)("div",{children:e("BayAllocation_btnMoveToStart")})}),(0,x.jsx)("div",{className:this.state.isManualMode?"bayAllocationButton":"bayAllocationButtonDisable",style:{padding:"0 0.5% 0 0.5%",height:"22px",border:"1px solid #c5c5c5"},onClick:()=>this.handleMovePrevious(),children:(0,x.jsx)("div",{children:e("BayAllocation_btnMovePrevious")})}),(0,x.jsx)("div",{className:this.state.isManualMode?"bayAllocationButton":"bayAllocationButtonDisable",style:{padding:"0 1% 0 1%",height:"22px",border:"1px solid #c5c5c5"},onClick:()=>this.handleMoveNext(),children:(0,x.jsx)("div",{children:e("BayAllocation_btnMoveNext")})}),(0,x.jsx)("div",{className:this.state.isManualMode?"bayAllocationButton":"bayAllocationButtonDisable",style:{padding:"0 1% 0 1%",height:"22px",border:"1px solid #c5c5c5"},onClick:()=>this.handleMoveEnd(),children:(0,x.jsx)("div",{children:e("BayAllocation_btnMoveToEnd")})}),(0,x.jsx)("div",{className:this.state.isManualMode?"bayAllocationLargeButtonDisable":"bayAllocationLargeButton",style:{height:"22px",border:"1px solid #c5c5c5"},onClick:()=>this.handleAutoAllocate(),children:(0,x.jsx)("div",{children:e("BayAllocation_btnAutoBayAllocation")})}),(0,x.jsx)("div",{className:"bayAllocationLargeButton",style:{height:"22px",border:"1px solid #c5c5c5"},onClick:()=>this.handleSwitchMode(),children:(0,x.jsx)("div",{children:!0===this.state.isManualMode?e("BayAllocation_btnSwitchToAuto"):e("BayAllocation_btnSwitchToManual")})})]})})]})})}}const D=(0,l.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(B)}}]);
//# sourceMappingURL=6089.81a7b025.chunk.js.map