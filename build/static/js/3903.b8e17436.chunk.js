"use strict";(self.webpackChunktmwebapp=self.webpackChunktmwebapp||[]).push([[3903],{83903:(e,t,s)=>{s.r(t),s.d(t,{default:()=>R});var a=s(65043),o=s(46100),i=s(80432),l=s(40854),n=s.n(l),c=s(97508),r=s(53536),d=s.n(r),h=s(69062),u=s(93779),p=s(72067),y=s(7523),m=s(65187),v=s(40252),D=s(43503),L=s(44192),C=s(80312),g=s(72711),b=s(67907),E=s(78374),T=s(85800),A=s(70579);function S(e){let{location:t,modLocation:s,bay:a,modBay:o,modAvailableDevices:i,modAssociatedDevices:l,selectedLocationType:n,validationErrors:c,checkBoxChanged:r,onFieldChange:d,listOptions:h,handleCellDataEdit:u,onActiveStatusChange:p,attributeValidationErrors:y,modAttributeMetaDataList:v,onAttributeDataChange:D}=e;const L=(e,t)=>{let s=[];return s=e.find((e=>e.TerminalCode===t)),s.attributeValidationErrors},[C]=(0,b.useTranslation)(),S=e=>(0,A.jsx)(g.Input,{fluid:!0,value:l[e.rowIndex][e.field],onChange:t=>u(t,e),reserveSpace:!1});return(0,A.jsxs)("div",{className:"detailsContainer",children:[(0,A.jsxs)("div",{className:"row",children:[(0,A.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,A.jsx)(g.Input,{fluid:!0,value:s.LocationCode,label:C("Bay"===n||"Cluster"===n?n+" Code":"LocationInfo_BerthCode"),indicator:"required",disabled:""!==t.LocationCode,onChange:e=>d("LocationCode",e),error:C(c.LocationCode),reserveSpace:!1})}),(0,A.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,A.jsx)(g.Input,{fluid:!0,value:s.LocationName,label:C("Bay"===n||"Cluster"===n?n+"  Name":"LocationInfo_BerthName"),indicator:"required",onChange:e=>d("LocationName",e),error:C(c.LocationName),reserveSpace:!1})}),(0,A.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,A.jsx)(g.Select,{fluid:!0,placeholder:C("Common_Select"),label:C("Bay"===n?"BayGroupList_BayType":"Cluster"===n?"LocationInfo_ClusterType":"LocationInfo_BerthType"),value:o.BayType,options:h.bayTypeOptions,disabled:""!==t.LocationCode,onChange:e=>d("BayType",e),indicator:"required",reserveSpace:!1,search:!1,noResultsMessage:C("noResultsMessage")})}),"Bay"===n?(0,A.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,A.jsx)(g.Input,{fluid:!0,value:n,disabled:"true",label:C("LocationType"),onChange:e=>d("LocationType",e),reserveSpace:!1})}):"","Bay"===n||"Cluster"===n?(0,A.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,A.jsx)(g.Input,{fluid:!0,value:o.MaximumQueue,label:C("Bay_MaxQue"),onChange:e=>d("MaximumQueue",e),error:C(c.MaximumQueue),reserveSpace:!1})}):"",(0,A.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,A.jsx)(g.Input,{fluid:!0,value:o.BayPriority,label:C("Bay"===n?"Bay_Priority":"Cluster"===n?"LocationInfo_ClusterPriority":"LocationInfo_BerthPriority"),onChange:e=>d("BayPriority",e),error:C(c.BayPriority),reserveSpace:!1})}),"Bay"===n||"Cluster"===n?(0,A.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,A.jsx)(g.Input,{fluid:!0,value:o.IslandCode,label:C("Bay"===n?"Bay_Island":"Cluster"===n?"Spur_Code":"Bay_Island"),disabled:!0,onChange:e=>d("IslandCode",e),reserveSpace:!1})}):"","Bay"===n?(0,A.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,A.jsx)(g.Select,{fluid:!0,placeholder:C("Common_Select"),label:C("Bay_VehicleSpecificType"),value:o.VehicleSpecificType,options:[{text:"DEFENCE",value:"DEFENCE"},{text:"AEROVEHICLES",value:"AEROVEHICLES"},{text:"AGENTTRUCK",value:"AGENTTRUCK"}],onChange:e=>d("VehicleSpecificType",e),reserveSpace:!1,search:!1,noResultsMessage:C("noResultsMessage")})}):"",(0,A.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,A.jsx)(g.Select,{fluid:!0,placeholder:C("Common_Select"),label:C("BayGroupList_LoadingType"),value:o.LoadingType,options:h.loadingTypeOptions,disabled:""!==t.LocationCode,onChange:e=>d("LoadingType",e),reserveSpace:!1,search:!1,noResultsMessage:C("noResultsMessage")})}),(0,A.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,A.jsx)(g.Input,{fluid:!0,value:null===s.Description?"":s.Description,label:C("FinishedProductList_Description"),onChange:e=>d("Description",e),error:C(c.Description),reserveSpace:!1})}),(0,A.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,A.jsx)(g.Select,{fluid:!0,placeholder:C("FinishedProductInfo_Select"),label:C("Cust_Status"),value:s.Active,options:[{text:C("ViewShipment_Ok"),value:!0},{text:C("ViewShipmentStatus_Inactive"),value:!1}],onChange:e=>p(e)})}),(0,A.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,A.jsx)(g.Input,{fluid:!0,value:null===s.Remarks?"":s.Remarks,label:C("Cust_Remarks"),onChange:e=>d("Remarks",e),indicator:s.Active!==t.Active?"required":"",error:C(c.Remarks),reserveSpace:!1})}),"Bay"===n?(0,A.jsxs)("div",{className:"col-12 col-md-6 col-lg-4 ",children:[(0,A.jsx)(g.Checkbox,{className:"deviceCheckBox",label:C("Bay_VolumeBased"),checked:o.IsVolumeBased,onChange:e=>d("IsVolumeBased",e)}),(0,A.jsx)(g.Checkbox,{className:"deviceCheckBox",label:C("Bay_IsEnableInBayAllocation"),checked:o.EnabledForBayAllocation,onChange:e=>d("EnabledForBayAllocation",e)})]}):"","Cluster"===n?(0,A.jsx)("div",{className:"col-12 col-md-6 col-lg-4 ",children:(0,A.jsx)(g.Checkbox,{className:"deviceCheckBox",label:C("Bay_VolumeBased"),checked:o.IsVolumeBased,onChange:e=>d("IsVolumeBased",e)})}):""]}),v.length>0?v.map((e=>(0,A.jsx)("div",{className:"bayAccordian",children:(0,A.jsx)(m.A,{children:(0,A.jsx)(g.Accordion,{className:"",children:(0,A.jsx)(g.Accordion.Content,{title:C("Attributes_Header"),children:(0,A.jsx)(T.n,{selectedAttributeList:e.attributeMetaDataList,handleCellDataEdit:D,attributeValidationErrors:L(y,e.TerminalCode)})})})})}))):null,(0,A.jsxs)("div",{className:"row pt-3",children:[(0,A.jsxs)("div",{className:"col-3 pr-1 pb-0",children:[(0,A.jsx)("h5",{children:C("Loc_AvailableDevices")}),(0,A.jsx)(g.Accordion,{children:i.map((e=>(0,A.jsx)(g.Accordion.Content,{title:e.DeviceType,arrowPosition:"left",children:e.DeviceList.map((t=>(0,A.jsx)("div",{children:(0,A.jsx)(g.Checkbox,{label:t.DeviceCode,checked:t.IsAssociated,onChange:s=>r(t.DeviceCode,e.DeviceType,s)})})))})))})]}),(0,A.jsxs)("div",{className:"col-9 pb-0",children:[(0,A.jsx)("h5",{children:C("Loc_AssociatedDevices")}),(0,A.jsxs)(E.bQ,{data:l,children:[(0,A.jsx)(E.bQ.Column,{className:"compColHeight",field:"DeviceCode",header:C("Loc_DeviceCode"),editable:!0,sortable:!0,editFieldType:"text",customEditRenderer:S},"DeviceCode"),(0,A.jsx)(E.bQ.Column,{className:"compColHeight",field:"DeviceType",header:C("Loc_DeviceType"),editable:!0,sortable:!0,editFieldType:"text",customEditRenderer:S},"DeviceType"),(0,A.jsx)(E.bQ.Column,{className:"compColHeight",field:"DeviceModel",header:C("Loc_DeviceModel"),editable:!0,sortable:!0,editFieldType:"text",customEditRenderer:S},"DeviceModel")]})]})]})]})}var B=s(15417),f=s(62900);class k extends a.Component{constructor(){super(...arguments),this.state={location:{},modLocation:{},bay:{},modBay:{},modAssociatedDevices:[],modAvailableDevices:[],isReadyToRender:!1,saveEnabled:!1,isDeleteEnabled:!1,selectedLocationType:"",checkedDevices:[],loadingTypeOptions:[],bayTypeOptions:[],validationErrors:h.Th(L.OA),attributeMetaDataList:[],modAttributeMetaDataList:[],attributeValidationErrors:[],showDeleteAuthenticationLayout:!1,showSaveAuthenticationLayout:!1,tempBay:{},tempLocation:{}},this.handleCellDataEdit=(e,t)=>{try{let s=d().cloneDeep(this.state.modAssociatedDevices);s[t.rowIndex][t.field]=e,this.setState({modAssociatedDevices:s})}catch(s){console.log("BayDetailsComposite:Error occured on handleCellDataEdit",s)}},this.handleAttributeDataChange=(e,t)=>{try{let s=[],a=d().cloneDeep(this.state.modAttributeMetaDataList),o=a.filter((t=>t.TerminalCode===e.TerminalCode));o.length>0&&Array.isArray(o[0].attributeMetaDataList)&&(s=o[0].attributeMetaDataList.filter((t=>t.Code===e.Code))),s.length>0&&(s[0].DefaultValue=t);const i=d().cloneDeep(this.state.attributeValidationErrors);i.forEach((s=>{s.TerminalCode===e.TerminalCode&&(s.attributeValidationErrors[e.Code]=h.I5(e,t))})),this.setState({attributeValidationErrors:i,modAttributeMetaDataList:a})}catch(s){console.log("BayDetailsComposite:Error occured on handleAttributeDataChange",s)}},this.handleChange=(e,t)=>{try{let s=d().cloneDeep(this.state.modLocation);s[e]=t;let a=d().cloneDeep(this.state.modBay);a[e]=t;const o={...this.state.validationErrors};s.Active===this.state.location.Active&&(this.state.location.Remarks!==s.Remarks&&""!==s.Remarks||(o.Remarks=""),""===s.Remarks&&(s.Remarks=this.state.location.Remarks)),"Active"===e&&s.Active!==this.state.location.Active&&(s.Remarks=""),void 0!==L.OA[e]&&(o[e]=h.jr(L.OA[e],t)),this.setState({validationErrors:o,modLocation:s,modBay:a})}catch(s){console.log("BayDetailsComposite:Error occured on handleChange",s)}},this.handleCheckboxChanged=(e,t,s)=>{try{let i=d().cloneDeep(this.state.modAvailableDevices);var a=i.findIndex((e=>e.DeviceType===t));if(void 0!==a)var o=i[a].DeviceList.findIndex((t=>t.DeviceCode===e));void 0!==o&&(i[a].DeviceList[o].IsAssociated=s),this.setState({modAvailableDevices:i});let l={DeviceType:t,DeviceCode:e,DeviceModel:null},n=d().cloneDeep(this.state.checkedDevices);!0===s&&0===n.filter((t=>t.DeviceCode===e)).length?(n.push(l),this.setState({checkedDevices:n})):!1===s&&this.state.checkedDevices.filter((t=>t.DeviceCode===e)).length>0&&(n=n.filter((t=>t.DeviceCode!==e)),this.setState({checkedDevices:n})),console.log("checkeddevices",this.state.checkedDevices)}catch(i){console.log("BayDetailsComposite:Error occured on handleCheckboxChanged",i)}},this.handleActiveStatusChange=e=>{try{let t=d().cloneDeep(this.state.modLocation);t.Active=e,t.Active!==this.state.location.Active&&(t.Remarks=""),this.setState({modLocation:t})}catch(t){console.log("BayDetailsComposite:Error occured on handleActiveStatusChange",t)}},this.saveBay=()=>{try{this.setState({saveEnabled:!1});let e=d().cloneDeep(this.state.tempBay),t=d().cloneDeep(this.state.tempLocation);""===this.state.location.LocationCode?this.createLocation(t,e):this.updateLocation(t,e)}catch(e){console.log("BayCompositeDetails : Error in saveBay")}},this.handleSave=()=>{try{let e=this.fillDetails(),t=this.fillBayDetails(),s=h.pI(this.state.modAttributeMetaDataList);if(this.validateSave(e,s)){s=h.SC(s),t.Attributes=h.Gh(s);let a=!0!==this.props.userDetails.EntityResult.IsWebPortalUser,o=d().cloneDeep(t),i=d().cloneDeep(e);this.setState({showSaveAuthenticationLayout:a,tempBay:o,tempLocation:i},(()=>{!1===a&&this.saveBay()}))}else this.setState({saveEnabled:!0})}catch(e){console.log("BayDetailsComposite:Error occured on handleSave",e)}},this.handleDelete=()=>{try{var e=[],t=this.state.modLocation.LocationCode,s={keyDataCode:0,ShareHolderCode:"",KeyCodes:[{Key:u.Kz,Value:t},{Key:u.uw,Value:this.props.selectedTerminal},{Key:u.c4,Value:this.props.locationtype}]};e.push(s),n()(p._L0,h.tW(e,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data,s=t.IsSuccess;null!==t.ResultDataList&&void 0!==t.ResultDataList&&(s=t.ResultDataList.filter((function(e){return!e.IsSuccess})).length!==t.ResultDataList.length);var a=h.Cy(t,[("Bay"===this.state.selectedLocationType||"Cluster"===this.state.selectedLocationType?this.state.selectedLocationType:"Berth  ")+" DeletionStatus"],["LocationCode","BayCode"]);s?(this.getLocation({selectedlocation:this.state.modLocation.LocationCode,selectedTerminal:this.props.selectedTerminal,isClone:!0}),this.setState({isDeleteEnabled:!1,showDeleteAuthenticationLayout:!1})):this.setState({isDeleteEnabled:!0,showDeleteAuthenticationLayout:!1}),a.messageResultDetails.forEach((e=>{e.keyFields.length>0&&(e.keyFields[0]=["Bay"===this.state.selectedLocationType||"Cluster"===this.state.selectedLocationType?this.state.selectedLocationType+"Code":"LocationInfo_BerthCode"])})),this.props.onDelete(this.state.modLocation,"delete",a)}))}catch(a){console.log("BayDetailsComposite:Error occured on handleDelete",a)}},this.authenticateDelete=()=>{try{let e=!0!==this.props.userDetails.EntityResult.IsWebPortalUser;this.setState({showDeleteAuthenticationLayout:e}),!1===e&&this.handleDelete()}catch(e){console.log("BayDetailsComposite : Error in authenticateDelete")}},this.handleAuthenticationClose=()=>{this.setState({showSaveAuthenticationLayout:!1,showDeleteAuthenticationLayout:!1})}}componentDidMount(){try{h.pJ(this.props.userDetails.EntityResult.IsArchived),this.getLoadingTypes(),this.getBayTypes(),this.getAttributes(this.props)}catch(e){console.log("BayDetailsComposite:Error occured on componentDidMount",e)}}componentWillReceiveProps(e){try{if(void 0===e.LocationCode&&this.props.tokenDetails.tokenInfo===e.tokenDetails.tokenInfo){this.getAttributes(e);let t={...this.state.validationErrors};Object.keys(t).forEach((e=>{t[e]=""})),this.setState({validationErrors:t})}}catch(t){console.log("BayDetailsComposite:Error occured on componentWillReceiveProps",t)}}getAttributes(e){try{n()(p.fKH,h.tW([B.IQ],this.props.tokenDetails.tokenInfo)).then((t=>{var s=t.data;!0===s.IsSuccess?this.setState({attributeMetaDataList:d().cloneDeep(s.EntityResult),attributeValidationErrors:h.Fl(s.EntityResult.bay)},(()=>this.getDeviceList(e))):console.log("Error in getAttributes:")}))}catch(t){console.log("Error while getAttributes:",t)}}getDeviceList(e){let t=e.locationtype;t="Bay"===t?y.uA.BAY:"Cluster"===t?y.uA.CLUSTER:y.uA.BERTH;var s=this.props.selectedTerminal;try{n()(p.X3N+"?locationType="+t+"&locationInfo=&terminalCode="+s,h.Jm(this.props.tokenDetails.tokenInfo)).then((t=>{let s=t.data;!0===s.IsSuccess&&Array.isArray(s.EntityResult)&&s.EntityResult.length>0?this.setState({modAvailableDevices:s.EntityResult},(()=>{this.getLocation(e)})):this.getLocation(e)}))}catch(a){console.log("BayDetailsComposite:Error occured on getDeviceList",a)}}getLocation(e){try{let a=e.selectedlocation,i=this.props.selectedTerminal;if("MarineBay"===e.locationtype&&(this.setState({selectedLocationType:y.uA.BERTH}),o.F4.LocationType=y.uA.BERTH,o._7.IslandCode="",o.F4.AvailableDevices=this.state.modAvailableDevices),"Bay"===e.locationtype&&(this.setState({selectedLocationType:y.uA.BAY}),o.F4.LocationType=y.uA.BAY,o._7.IslandCode=this.props.parentCode,o.F4.AvailableDevices=this.state.modAvailableDevices),"Cluster"===e.locationtype&&(this.setState({selectedLocationType:y.uA.CLUSTER}),o.F4.LocationType=y.uA.CLUSTER,o._7.IslandCode=this.props.parentCode,o.F4.AvailableDevices=this.state.modAvailableDevices),!0===e.isClone)return void this.setState({modAttributeMetaDataList:[],selectedLocationType:o.F4.LocationType,location:d().cloneDeep(o.F4),modLocation:d().cloneDeep(o.F4),bay:d().cloneDeep(o._7),modBay:d().cloneDeep(o._7),isReadyToRender:!0,modAssociatedDevices:[],modAvailableDevices:d().cloneDeep(this.state.modAvailableDevices),checkedDevices:[],isDeleteEnabled:!1,saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,C.i.add,h.k5(this.props.transportationtype))},(()=>{this.localNodeAttribute()}));if(void 0===a||""===a)return void this.setState({modAttributeMetaDataList:[],location:d().cloneDeep(o.F4),modLocation:d().cloneDeep(o.F4),bay:d().cloneDeep(o._7),modBay:d().cloneDeep(o._7),selectedLocationType:o.F4.LocationType,modAssociatedDevices:[],modAvailableDevices:d().cloneDeep(o.F4.AvailableDevices),checkedDevices:[],isDeleteEnabled:!1,isReadyToRender:!0,saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,C.i.add,h.k5(this.props.transportationtype))},(()=>{this.localNodeAttribute()}));var t=[{key:u.$A,value:a},{key:u.uw,value:i},{Key:u.c4,Value:this.props.locationtype}],s={ShareHolderCode:"",keyDataCode:u.$A,KeyCodes:t};n()(p.Q8r,h.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){let e=d().cloneDeep(t.EntityResult.AssociatedDevices);e.forEach((e=>{e.DeviceType=(0,h.cd)(y.k6,e.DeviceType)})),this.setState({selectedLocationType:d().cloneDeep(t.EntityResult.LocationType),isReadyToRender:!0,location:t.EntityResult,modLocation:d().cloneDeep(t.EntityResult),modAssociatedDevices:e,modAvailableDevices:d().cloneDeep(t.EntityResult.AvailableDevices),checkedDevices:d().cloneDeep(t.EntityResult.AssociatedDevices),isDeleteEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,C.i.remove,h.k5(this.props.transportationtype)),saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,C.i.modify,h.k5(this.props.transportationtype))}),this.getBay(a)}else this.setState({selectedLocationType:o.F4.LocationType,location:d().cloneDeep(o.F4),modLocation:d().cloneDeep(o.F4),bay:d().cloneDeep(o._7),modBay:d().cloneDeep(o._7),isReadyToRender:!0,modAssociatedDevices:[],modAvailableDevices:[],checkedDevices:[],isDeleteEnabled:!1})}))}catch(a){console.log("BayDetailsComposite:Error occured on getLocation",a)}}terminalSelectionChange(e){try{let o=[];var t=[],s=[];t=d().cloneDeep(this.state.attributeMetaDataList),s=d().cloneDeep(this.state.modAttributeMetaDataList);const i=d().cloneDeep(this.state.attributeValidationErrors);var a=d().cloneDeep(this.state.modBay);e.forEach((e=>{var i=s.find((t=>t.TerminalCode===e));void 0===i?t.bay.forEach((function(t){if(t.TerminalCode===e){var s=a.Attributes.find((t=>t.TerminalCode===e));void 0!==s&&t.attributeMetaDataList.forEach((function(e){var t=s.ListOfAttributeData.find((t=>t.AttributeCode===e.Code));void 0!==t&&(e.DefaultValue=t.AttributeValue)})),o.push(t)}})):o.push(i)})),s=[],s=o,s=h.nQ(s),i.forEach((t=>{void 0===e.find((e=>t.TerminalCode===e))&&Object.keys(t.attributeValidationErrors).forEach((e=>t.attributeValidationErrors[e]=""))})),this.setState({modAttributeMetaDataList:s,attributeValidationErrors:i})}catch(o){console.log("BayDetailsComposite:Error occured on terminalSelectionChange",o)}}localNodeAttribute(){try{this.terminalSelectionChange([this.props.selectedTerminal])}catch(e){console.log("BayDetailsComposite:Error occured on localNodeAttribute",e)}}getBay(e){let t=this.props.selectedTerminal;try{var s=[{key:u.Kz,value:e},{key:u.uw,value:t},{Key:u.c4,Value:this.props.locationtype}],a={ShareHolderCode:"",keyDataCode:u.Kz,KeyCodes:s};n()(p.Vw0,h.tW(a,this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;!0===t.IsSuccess?this.setState({modAttributeMetaDataList:[],isReadyToRender:!0,bay:d().cloneDeep(t.EntityResult),modBay:d().cloneDeep(t.EntityResult),isDeleteEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,C.i.remove,h.k5(this.props.transportationtype)),saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,C.i.modify,h.k5(this.props.transportationtype))},(()=>{this.terminalSelectionChange([t.EntityResult.TerminalCode])})):this.setState({isReadyToRender:!0,bay:d().cloneDeep(o._7),modBay:d().cloneDeep(o._7),isDeleteEnabled:!1,saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,C.i.modify,h.k5(this.props.transportationtype))})}))}catch(i){console.log("BayDetailsComposite:Error occured on getBay",i)}}getLoadingTypes(){n()(p.zVP,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){var s=h.Zj(t.EntityResult);this.setState({loadingTypeOptions:s})}}else console.log("Error in getLoadingTypes:",t.ErrorList)})).catch((e=>{console.log("Error while getting getLoadingTypes:",e)}))}getBayTypes(){n()(p.IyQ,h.Jm(this.props.tokenDetails.tokenInfo)).then((e=>{var t=e.data;if(!0===t.IsSuccess){if(null!==t.EntityResult&&Array.isArray(t.EntityResult)){var s=h.Zj(t.EntityResult);this.setState({bayTypeOptions:s})}}else console.log("Error in getBayTypes:",t.ErrorList)})).catch((e=>{console.log("Error while getting getBayTypes:",e)}))}createLocation(e,t){try{let s=[{key:u.$A,value:e.LocationCode}],a={LocationInfo:e,BayInfo:t,isBayRequest:!0},o={ShareHolderCode:"",keyDataCode:u.$A,KeyCodes:s,Entity:a},i={messageType:"critical",message:["Bay"===this.state.selectedLocationType||"Cluster"===this.state.selectedLocationType?this.state.selectedLocationType+"SavedSuccess":"LocationInfo_BerthSaveSuccess"],messageResultDetails:[{keyFields:[this.state.selectedLocationType+"Code"],keyValues:[e.LocationCode],isSuccess:!1,errorMessage:""}]};n()(p.Kbi,h.tW(o,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;i.messageType=t.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?(this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,C.i.add,h.k5(this.props.transportationtype)),showSaveAuthenticationLayout:!1}),this.getLocation({selectedlocation:this.state.modLocation.LocationCode,selectedTerminal:this.props.selectedTerminal,isClone:!1})):(i.messageResultDetails[0].errorMessage=t.ErrorList[0],this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,C.i.add,h.k5(this.props.transportationtype)),showSaveAuthenticationLayout:!1})),this.props.onSaved(this.state.modLocation,"add",i)}))}catch(s){console.log("BayDetailsComposite:Error occured on createLocation",s)}}createBay(e){try{let t=[{key:u.Kz,value:e.BayCode}],s={ShareHolderCode:"",keyDataCode:u.Kz,KeyCodes:t,Entity:e},a={messageType:"critical",message:["Bay"===this.state.selectedLocationType||"Cluster"===this.state.selectedLocationType?this.state.selectedLocationType+"SavedSuccess":"LocationInfo_BerthSaveSuccess"],messageResultDetails:[{keyFields:["Bay"===this.state.selectedLocationType||"Cluster"===this.state.selectedLocationType?this.state.selectedLocationType+"Code":"LocationInfo_BerthCode"],keyValues:[e.BayCode],isSuccess:!1,errorMessage:""}]};n()(p.vqy,h.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;a.messageType=t.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?(this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,C.i.add,h.k5(this.props.transportationtype)),showSaveAuthenticationLayout:!1}),this.getLocation({selectedlocation:this.state.modLocation.LocationCode,selectedTerminal:this.props.selectedTerminal,isClone:!1})):(a.messageResultDetails[0].errorMessage=t.ErrorList[0],this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,C.i.add,h.k5(this.props.transportationtype)),showSaveAuthenticationLayout:!1})),this.props.onSaved(this.state.modLocation,"add",a)}))}catch(t){console.log("BayDetailsComposite:Error occured on createBay",t)}}updateLocation(e,t){try{let s=[{key:u.$A,value:e.LocationCode}],a={LocationInfo:e,BayInfo:t,isBayRequest:!0},o={ShareHolderCode:"",keyDataCode:u.$A,KeyCodes:s,Entity:a},i={messageType:"critical",message:[this.state.selectedLocationType+"SavedSuccess"],messageResultDetails:[{keyFields:[this.state.selectedLocationType+"Code"],keyValues:[e.LocationCode],isSuccess:!1,errorMessage:""}]};n()(p.Xe1,h.tW(o,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;i.messageType=t.IsSuccess?"success":"critical",i.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?(this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,C.i.add,h.k5(this.props.transportationtype)),showSaveAuthenticationLayout:!1}),this.getLocation({selectedlocation:this.state.modLocation.LocationCode,selectedTerminal:this.props.selectedTerminal,isClone:!1})):(i.messageResultDetails[0].errorMessage=t.ErrorList[0],this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,C.i.add,h.k5(this.props.transportationtype)),showSaveAuthenticationLayout:!1})),this.props.onSaved(this.state.modLocation,"update",i)}))}catch(s){console.log("BayDetailsComposite:Error occured on updateLocation",s)}}updateBay(e){try{let t=[{key:u.Kz,value:e.BayCode}],s={ShareHolderCode:"",keyDataCode:u.Kz,KeyCodes:t,Entity:e},a={messageType:"critical",message:["Bay"===this.state.selectedLocationType||"Cluster"===this.state.selectedLocationType?this.state.selectedLocationType+"SavedSuccess":"LocationInfo_BerthSaveSuccess"],messageResultDetails:[{keyFields:["Bay"===this.state.selectedLocationType||"Cluster"===this.state.selectedLocationType?this.state.selectedLocationType+"Code":"LocationInfo_BerthCode"],keyValues:[e.BayCode],isSuccess:!1,errorMessage:""}]};n()(p.qGc,h.tW(s,this.props.tokenDetails.tokenInfo)).then((e=>{let t=e.data;a.messageType=t.IsSuccess?"success":"critical",a.messageResultDetails[0].isSuccess=t.IsSuccess,!0===t.IsSuccess?(this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,C.i.add,h.k5(this.props.transportationtype)),showSaveAuthenticationLayout:!1}),this.getLocation({selectedlocation:this.state.modLocation.LocationCode,selectedTerminal:this.props.selectedTerminal,isClone:!1})):(a.messageResultDetails[0].errorMessage=t.ErrorList[0],this.setState({saveEnabled:h.ab(this.props.userDetails.EntityResult.FunctionsList,C.i.add,h.k5(this.props.transportationtype)),showSaveAuthenticationLayout:!1})),this.props.onSaved(this.state.modLocation,"update",a)}))}catch(t){console.log("BayDetailsComposite:Error occured on updateBay",t)}}fillDetails(){try{let e=d().cloneDeep(this.state.modLocation),t=d().cloneDeep(this.state.checkedDevices);return t.forEach((e=>{e.TerminalCode=this.props.selectedTerminal})),e.LocationType=this.state.selectedLocationType,e.TerminalCode=this.props.selectedTerminal,e.AssociatedDevices=t,e}catch(e){console.log("BayDetailsComposite:Error occured on filldetails",e)}}fillBayDetails(){try{let e=d().cloneDeep(this.state.modLocation),t=d().cloneDeep(this.state.modBay);return t.BayCode=e.LocationCode,t.Name=e.LocationName,t.TerminalCode=this.props.selectedTerminal,t}catch(e){console.log("BayDetailsComposite:Error occured on filldetails",e)}}validateSave(e,t){const s={...this.state.validationErrors};Object.keys(L.OA).forEach((function(t){void 0!==e[t]&&(s[t]=h.jr(L.OA[t],e[t]))})),e.Active!==this.state.location.Active&&(null!==e.Remarks&&""!==e.Remarks||(s.Remarks="OriginTerminal_RemarksRequired"));let a={messageType:"critical",message:[this.state.selectedLocationType+"SavedSuccess"],messageResultDetails:[]};0===e.AssociatedDevices.length&&a.messageResultDetails.push({keyFields:[this.state.selectedLocationType+"Code"],keyValues:[e.LocationCode],isSuccess:!1,errorMessage:"LocationInfo_DeviceRequired"});var o=d().cloneDeep(this.state.attributeValidationErrors);t.forEach((e=>{o.forEach((t=>{t.TerminalCode===e.TerminalCode&&e.attributeMetaDataList.forEach((e=>{t.attributeValidationErrors[e.Code]=h.I5(e,e.DefaultValue)}))}))})),this.setState({validationErrors:s,attributeValidationErrors:o});var i=!0;return o.forEach((e=>{if(!i)return i;i=Object.values(e.attributeValidationErrors).every((function(e){return""===e}))})),i&&(i=Object.values(s).every((function(e){return""===e}))),a.messageResultDetails.length>0?(this.props.onSaved(this.state.modLocation,"update",a),!1):i}handleOperation(){return this.state.showDeleteAuthenticationLayout?this.handleDelete:this.saveBay}getFunctionGroupName(){return this.state.selectedLocationType===y.uA.CLUSTER?C.Z9:this.state.selectedLocationType===y.uA.BERTH?C.PP:C.x5}getFunctionName(){return this.state.showDeleteAuthenticationLayout?C.i.remove:""===this.state.bay.Code?C.i.add:C.i.modify}render(){const e=[{fieldName:"DriverInfo_LastUpdated",fieldValue:new Date(this.state.modLocation.LastUpdatedTime).toLocaleDateString()+" "+new Date(this.state.modLocation.LastUpdatedTime).toLocaleTimeString()},{fieldName:"DriverInfo_LastActive",fieldValue:void 0!==this.state.modLocation.LastActiveTime&&null!==this.state.modLocation.LastActiveTime?new Date(this.state.modLocation.LastActiveTime).toLocaleDateString()+" "+new Date(this.state.modLocation.LastActiveTime).toLocaleTimeString():""},{fieldName:"DriverInfo_CreatedTime",fieldValue:new Date(this.state.modLocation.CreatedTime).toLocaleDateString()+" "+new Date(this.state.modLocation.CreatedTime).toLocaleTimeString()}];return this.state.isReadyToRender?(0,A.jsxs)("div",{children:[(0,A.jsx)(m.A,{children:(0,A.jsx)(b.TranslationConsumer,{children:t=>(0,A.jsx)(D.A,{entityCode:this.state.location.LocationCode,newEntityName:"Bay"===this.state.selectedLocationType||"Cluster"===this.state.selectedLocationType?"New"+this.state.selectedLocationType:t("LocationInfo_NewBerth"),popUpContents:e})})}),(0,A.jsx)(m.A,{children:(0,A.jsx)(S,{location:this.state.location,modLocation:this.state.modLocation,bay:this.state.bay,modBay:this.state.modBay,selectedLocationType:this.state.selectedLocationType,modAvailableDevices:this.state.modAvailableDevices,modAssociatedDevices:this.state.modAssociatedDevices,listOptions:{loadingTypeOptions:this.state.loadingTypeOptions,bayTypeOptions:this.state.bayTypeOptions},validationErrors:this.state.validationErrors,modAttributeMetaDataList:this.state.modAttributeMetaDataList,attributeValidationErrors:this.state.attributeValidationErrors,attributeMetaDataList:this.state.attributeMetaDataList,onAttributeDataChange:this.handleAttributeDataChange,onFieldChange:this.handleChange,checkBoxChanged:this.handleCheckboxChanged,handleCellDataEdit:this.handleCellDataEdit,onActiveStatusChange:this.handleActiveStatusChange})}),(0,A.jsx)(m.A,{children:(0,A.jsx)(i.E,{isEnterpriseNode:this.props.userDetails.EntityResult.IsEnterpriseNode,handleSave:this.handleSave,handleDelete:this.authenticateDelete,saveEnabled:this.state.saveEnabled,isDeleteEnabled:this.state.isDeleteEnabled})}),this.state.showDeleteAuthenticationLayout||this.state.showSaveAuthenticationLayout?(0,A.jsx)(f.A,{Username:this.props.userDetails.EntityResult.UserName,functionName:this.getFunctionName(),functionGroup:this.getFunctionGroupName(),handleClose:this.handleAuthenticationClose,handleOperation:this.handleOperation()}):null]}):(0,A.jsx)(v.A,{message:"Loading"})}}const R=(0,c.Ng)((e=>({userDetails:e.getUserDetails.userDetails,tokenDetails:e.getUserDetails.TokenAuth})))(k)}}]);
//# sourceMappingURL=3903.b8e17436.chunk.js.map